import{F as pe,p as oe,G as ge,f as D,e as he,r as w,J as te,K as ae,s as g,t as se,b as P,g as e,M as me,N as _e,x as ke,c as d,d as n,O as Te,n as le,v as ne,D as be,h as Ee,i as De,Q as ye,j,k as xe,u as we,o as re,m as C,l as m,a as Oe,I as Ce,q as X,w as q,B as Y,y as Z,L as Le,S as Ae}from"./BtknKrKR.js";import{N as $e}from"./BirarD0x.js";import"./ByfqNd-4.js";const Se=_=>{const s=Math.floor(Date.now()/1e3),r={};_.forEach(t=>{if(!t)return;const o=t.data.tags||["Imported"];if(o.length===0){r.ROOT||(r.ROOT=[]),r.ROOT.push(t);return}o.forEach(a=>{r[a]||(r[a]=[]),r[a].push(t)})});let i=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(r).forEach(t=>{t!=="ROOT"&&t!=="other"&&(i+=`
    <DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}">${t}</H3>
    <DL><p>`,r[t].forEach(o=>{const a=o.data.name.replace(/"/g,"&quot;");i+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||s}">${a}</A>`}),i+=`
    </DL><p>`)}),r.ROOT&&r.ROOT.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||s}">${o}</A>`}),i+=`
</DL><p>`,r.other&&r.other.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||s}">${o}</A>`}),i+="</DL><p>",i},Re=async(_,s="")=>{const r=`${s}.json`,i=JSON.stringify({notes:_}),t=new Blob([i],{type:"application/json"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=r,document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(o)},0)},Ie=(_,s,r)=>{s(_.target.value),r.onChange(s())};var He=D('<input type="radio"/> <label> </label>',1),Me=D('<div class="wrapper svelte-yu87bd"><fieldset class="switcher svelte-yu87bd"><!> <div class="wrapSwitcherStatus svelte-yu87bd"><div class="switcherStatus svelte-yu87bd"></div></div></fieldset></div>');function Be(_,s){const r=pe();oe(s,!0);let i=ge(s,"value",7);const t=`switcher-${r}`;var o=Me(),a=d(o),L=d(a);he(L,17,()=>s.items,T=>T.title,(T,f)=>{var z=He(),b=w(z);te(b,1,ae(["vh","input"]),"svelte-yu87bd"),b.__change=[Ie,i,s];var $=g(b,2);te($,1,ae(["switcherButton"]),"svelte-yu87bd");var W=d($);se(()=>{P(b,"id",`${e(f).title}-${r}`),P(b,"name",t),me(b,e(f).value),_e(b,e(f).value===i()),P(b,"aria-label",e(f).title),P($,"for",`${e(f).title}-${r}`),P($,"title",e(f).title),P($,"aria-label",e(f).title),ke(W,e(f).title)}),n(T,z)});var k=g(L,2),A=d(k);se(T=>Te(A,T),[()=>`transform: translateX(${s.items.findIndex(T=>T.value===i())*100}%)`]),n(_,o),le()}ne(["change"]);var Fe=(_,s)=>m(s,!e(s)),Pe=D('<p class="message message__tags svelte-1rr554k">Exclude other tags</p> <div class="exclude-switcher svelte-1rr554k"><!></div>',1),je=D('<!> <p class="message message__tags svelte-1rr554k">Filter tags:</p> <!>',1),Ne=D('<div class="buttonContainer svelte-1rr554k"><!></div>'),Ue=D('<div class="top svelte-1rr554k"><h4 class="message svelte-1rr554k">Export data</h4> <div class="format-switcher svelte-1rr554k"><!> <p class="format-description svelte-1rr554k"><!></p></div></div> <div><div class="settings svelte-1rr554k"><button class="link svelte-1rr554k"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),qe=D('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Exporting data...</p> <!></div>'),ze=D('<div class="top svelte-1rr554k"><p class="message error svelte-1rr554k">Something went wrong</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),We=D('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Data exported successfully!</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),Ge=D('<div class="block svelte-1rr554k"><!></div>');function Ve(_,s){oe(s,!0);const{getGetNotes:r}=be(),{clearStackPages:i}=Ee(),{blockDialog:t}=De(),{checkMobileSize:o}=ye();let a=j("idle"),L=j("sync"),k=j(xe([])),A=j(!1),T=j(!1),f=j(!1);const z=()=>{i()};we(()=>{t(e(a)==="loading")}),re(()=>()=>{t(!1)});const b=async()=>{m(a,"loading"),setTimeout(async()=>{let E=(r()()||[]).filter(c=>c.data).filter(c=>e(k).length===0?!0:e(k).every(p=>c.data.tags.includes(p)));if(e(f)&&(E=E.map(c=>{const p={...c};return p.data={...p.data,tags:p.data.tags.filter(y=>e(k).includes(y))},p})),e(L)==="sync")await Re(E,[...e(k),"notes"].join("_")).finally(async()=>{await new Promise(c=>setTimeout(c,500)),m(a,"success")});else try{const c=Se(E),p=new Blob([c],{type:"text/html"}),y=URL.createObjectURL(p),u=document.createElement("a");u.href=y,u.download=`${[...e(k),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(y),m(a,"success")}catch(c){console.error("Error exporting as HTML:",c),m(a,"error")}},0)},$=v=>{m(k,v,!0)},W=v=>{v.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(A)&&m(A,!1),document.activeElement.blur(),v.preventDefault(),v.stopPropagation())},ie=v=>{m(f,v,!0)};re(()=>(document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)));var ee=Ge(),ce=d(ee);{var de=v=>{var E=Ue(),c=w(E),p=g(d(c),2),y=d(p);Be(y,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(L)},onChange:l=>{m(L,l,!0)}});var u=g(y,2),S=d(u);{var N=l=>{var h=q("App format for sync or backup");n(l,h)},K=l=>{var h=q("Browser bookmarks format (exports only bookmarks, not notes)");n(l,h)};C(S,l=>{e(L)==="sync"?l(N):l(K,!1)})}var V=g(c,2),x=d(V),O=d(x);O.__click=[Fe,T];var I=d(O);Oe(I,()=>({"--rotate":"30deg","--size":"20px"})),Ce(I.lastChild,{name:"settings"});var H=g(x,2);{var R=l=>{var h=je(),B=w(h);{var J=F=>{var Q=Pe(),ue=g(w(Q),2),fe=d(ue);Ae(fe,{get checked(){return e(f)},onChange:ie}),n(F,Q)};C(B,F=>{e(k).length>0&&F(J)})}var U=g(B,4);$e(U,{mode:"exit",get selectedTags(){return e(k)},onChangeTags:$,get shownTagInput(){return e(A)},set shownTagInput(F){m(A,F,!0)}}),n(l,h)};C(H,l=>{e(T)&&l(R)})}var M=g(H,2);{var G=l=>{var h=Ne(),B=d(h);{let J=Z(o);Y(B,{get fullWidth(){return e(J)},onClick:b,children:(U,F)=>{var Q=q("Export");n(U,Q)},$$slots:{default:!0}})}n(l,h)};C(M,l=>{e(A)||l(G)})}n(v,E)},ve=v=>{var E=X(),c=w(E);{var p=u=>{var S=qe(),N=g(d(S),2);Le(N,{}),n(u,S)},y=u=>{var S=X(),N=w(S);{var K=x=>{var O=ze(),I=g(w(O),2),H=d(I);{let R=Z(o);Y(H,{get fullWidth(){return e(R)},onClick:()=>{m(a,"idle")},children:(M,G)=>{var l=q("Try Again");n(M,l)},$$slots:{default:!0}})}n(x,O)},V=x=>{var O=X(),I=w(O);{var H=R=>{var M=We(),G=g(w(M),2),l=d(G);{let h=Z(o);Y(l,{get fullWidth(){return e(h)},onClick:z,children:(B,J)=>{var U=q("Close");n(B,U)},$$slots:{default:!0}})}n(R,M)};C(I,R=>{e(a)==="success"&&R(H)},!0)}n(x,O)};C(N,x=>{e(a)==="error"?x(K):x(V,!1)},!0)}n(u,S)};C(c,u=>{e(a)==="loading"?u(p):u(y,!1)},!0)}n(v,E)};C(ce,v=>{e(a)==="idle"?v(de):v(ve,!1)})}n(_,ee),le()}ne(["click"]);export{Ve as default};
