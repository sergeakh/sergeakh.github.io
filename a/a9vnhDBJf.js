import{p as U,D as Y,J as Z,u as $,g as t,h as p,k as c,o as ee,f as P,e as O,W as h,x as T,t as L,m as N,d,c as g,s as f,i as w,y as V,T as te,j as se,v as ae,l as re,a as le,I as ne,V as oe,E as ie,X as de,w as ce}from"./aC1xpSvD-.js";import{I as ue}from"./aDq3vB9Uh.js";var fe=P('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),ve=(D,s,x,C)=>{t(s)!==""&&x(t(s)),C(!1),c(s,"")},ge=P('<form class="formNewTag svelte-1dwadiy"><div class="inputWrapper svelte-1dwadiy"><!></div> <button type="button" class="buttonDone svelte-1dwadiy">Done</button></form>'),me=P('<div class="block"><div class="tags svelte-1dwadiy"><!> <!> <!> <!></div> <!></div>');function Te(D,s){U(s,!0);const{isInitedNotes:x,getGetMapTags:C,getGetNotes:W}=Y();let v=p(null),r=p(""),m=p(null);const j=V(x);let i=Z(s,"shownTagInput",15);const z=()=>t(j)?s.mode==="exit"?de(new Set(s.selectedTags),W()()||[]):[...C()().keys()]:[];let k=V(()=>z().filter(e=>s.selectedTags.some(a=>e===a)||e==="inbox"?!1:t(r)===""||e.toLowerCase().indexOf(t(r).toLowerCase())===0));const _=e=>{if(!s.selectedTags.includes(e)){if(s.mode!=="exit"||t(k).includes(e)){e!=="inbox"&&s.onChangeTags([...s.selectedTags,e]),c(r,"");return}t(v)?.focus()}},F=e=>{const a=s.selectedTags.filter(o=>o!==e);a.length===0?s.onChangeTags([]):s.onChangeTags(a)},H=e=>{e.preventDefault(),t(r)!==""?_(t(r)):i(!1)};$(()=>{t(v)&&i()&&t(v).focus(),i()||c(r,"")});const I=e=>{e.target&&t(m)&&!t(m).contains(e.target)&&(i(!1),c(r,""))};ee(()=>(document.addEventListener("click",I,{capture:!0}),()=>{document.removeEventListener("click",I,{capture:!0})}));var b=me(),S=g(b),E=g(S);O(E,16,()=>s.selectedTags,e=>e,(e,a)=>{h(e,{onClick:()=>F(a),type:"button",style:"selected",children:(o,l)=>{var n=T();L(()=>N(n,a)),d(o,n)},$$slots:{default:!0}})});var M=f(E,2);{var J=e=>{var a=ae(),o=re(a);O(o,16,()=>t(k).filter(l=>l.toLowerCase()!==t(r).toLowerCase()).slice(0,Math.max(3,3-s.selectedTags.length)),l=>l,(l,n)=>{h(l,{onClick:()=>_(n),children:(u,G)=>{var y=T();L(()=>N(y,n)),d(u,y)},$$slots:{default:!0}})}),d(e,a)};w(M,e=>{(t(r)!==""||s.selectedTags.length>0&&i()&&s.mode==="exit")&&e(J)})}var R=f(M,2);{var X=e=>{h(e,{onClick:()=>{_(t(r)),c(r,"")},children:(a,o)=>{var l=T();L(()=>N(l,t(r))),d(a,l)},$$slots:{default:!0}})};w(R,e=>{t(r)!==""&&(s.mode!=="exit"||t(k).find(a=>a.toLowerCase()===t(r).toLowerCase()))&&e(X)})}var q=f(R,2);{var A=e=>{h(e,{mode:"empty",onClick:()=>i(!0),children:(a,o)=>{var l=fe(),n=g(l);le(n,()=>({"--size":"12px"})),ne(n.lastChild,{name:"plus"});var u=f(n,2);oe(u,{children:(G,y)=>{var Q=T("add tag");d(G,Q)}}),d(a,l)},$$slots:{default:!0}})};w(q,e=>{i()||e(A)})}var B=f(S,2);{var K=e=>{var a=ge(),o=g(a),l=g(o);ue(l,{placeholder:"tag",get ref(){return t(v)},set ref(u){c(v,u,!0)},get value(){return t(r)},set value(u){c(r,u,!0)}});var n=f(o,2);n.__click=[ve,r,_,i],ie("submit",a,H),d(e,a)};w(B,e=>{i()&&e(K)})}te(b,e=>c(m,e),()=>t(m)),d(D,b),se()}ce(["click"]);export{Te as N};
