const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/aCRCt8xdH.js","a/aCeYg3FOS.css","a/aD9YYAxYB.js","a/a9q_jSmK4.js","a/abA9hIFUQ.js","a/aBrkJtqMH.css","a/aCU_GEGp-.js","a/aDB02xhFr.css","a/aDCcTRoSj.js","a/a54d_SC5m.css","a/aD8nvEudi.js","a/aCpa8lgv9.js","a/afGUkjeV7.css","a/aBizVjyCg.js","a/aY1d2PU1k.css","a/aCnuDGvTj.js","a/asQV_WFy9.js","a/aCpd7MTd8.css","a/aB8ANSsM9.js","a/aenMKNzfI.css","a/aC969LWc5.css","a/aBoQpnbIE.js","a/aCeh8XjKC.css","a/aBDsfRuul.js","a/aCBPoPn5g.css","a/aB-8VPf_g.js","a/aK1a0NeEW.css","a/aB2cso0kj.js","a/aBem4Ctjp.css","a/aBF2E0LoX.js","a/aBdnakgrk.css","a/aDpn_HOSt.js","a/aDzsMVVo5.css","a/aaWz7CB7_.js","a/aCH18nfIo.css","a/aDJ-I7z2N.js","a/a94WR-L0A.js","a/aCb6DfA6m.css","a/aDFoezELl.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var kl=Object.defineProperty;var gs=t=>{throw TypeError(t)};var xl=(t,e,a)=>e in t?kl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var Bt=(t,e,a)=>xl(t,typeof e!="symbol"?e+"":e,a),yo=(t,e,a)=>e.has(t)||gs("Cannot "+a);var j=(t,e,a)=>(yo(t,e,"read from private field"),a?a.call(t):e.get(t)),Ge=(t,e,a)=>e.has(t)?gs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),Ke=(t,e,a,r)=>(yo(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),ct=(t,e,a)=>(yo(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const Tl=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};Tl(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const El=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};El();const xo=!1;var $o=Array.isArray,Pl=Array.prototype.indexOf,no=Array.from,Nl=Object.defineProperty,aa=Object.getOwnPropertyDescriptor,Us=Object.getOwnPropertyDescriptors,Ws=Object.prototype,Al=Array.prototype,ao=Object.getPrototypeOf,hs=Object.isExtensible;function sr(t){return typeof t=="function"}const Je=()=>{};function Dl(t){return typeof t?.then=="function"}function Ml(t){return t()}function To(t){for(var e=0;e<t.length;e++)t[e]()}function Vs(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function Il(t,e,a=!1){return t===void 0?a?e():e:t}const Nt=2,es=4,ro=8,Ll=1<<24,Wn=16,Vn=32,Na=64,oo=128,fn=512,It=1024,Kt=2048,Sn=4096,Jt=8192,Ln=16384,ts=32768,da=65536,ps=1<<17,qs=1<<18,nr=1<<19,Ks=1<<20,In=1<<25,Ea=32768,Eo=1<<21,ns=1<<22,ra=1<<23,oa=Symbol("$state"),Ys=Symbol("legacy props"),Rl=Symbol(""),Ba=new class extends Error{constructor(){super(...arguments);Bt(this,"name","StaleReactionError");Bt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Gs(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Fl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function zl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ol(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Bl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function jl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Hl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ul(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Wl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Vl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function ql(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Kl=1,Yl=2,Xs=4,Gl=8,Xl=16,Jl=1,Zl=2,Ql=4,$l=8,ec=16,tc=1,nc=2,Et=Symbol(),ac="http://www.w3.org/1999/xhtml";function rc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Js(t){return t===this.v}function oc(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Zs(t){return!oc(t,this.v)}let ar=!1,sc=!1;function ic(){ar=!0}const lc=[];function _n(t,e=!1,a=!1){return Br(t,new Map,"",lc,null,a)}function Br(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if($o(t)){var l=Array(t.length);e.set(t,l),o!==null&&e.set(o,l);for(var u=0;u<t.length;u+=1){var c=t[u];u in t&&(l[u]=Br(c,e,a,r,null,s))}return l}if(ao(t)===Ws){l={},e.set(t,l),o!==null&&e.set(o,l);for(var d in t)l[d]=Br(t[d],e,a,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return Br(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let it=null;function Xa(t){it=t}function gt(t){return Qs().get(t)}function ht(t,e){return Qs().set(t,e),e}function Ce(t,e=!1,a){it={p:it,i:!1,c:null,e:null,s:t,x:null,l:ar&&!e?{s:null,u:null,$:[]}:null}}function Se(t){var e=it,a=e.e;if(a!==null){e.e=null;for(var r of a)_i(r)}return t!==void 0&&(e.x=t),e.i=!0,it=e.p,t??{}}function rr(){return!ar||it!==null&&it.l===null}function Qs(t){return it===null&&Gs(),it.c??(it.c=new Map(cc(it)||void 0))}function cc(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let _a=[];function $s(){var t=_a;_a=[],To(t)}function Aa(t){if(_a.length===0&&!Ua){var e=_a;queueMicrotask(()=>{e===_a&&$s()})}_a.push(t)}function dc(){for(;_a.length>0;)$s()}function ei(t){var e=Ze;if(e===null)return Xe.f|=ra,t;if((e.f&ts)===0){if((e.f&oo)===0)throw t;e.b.error(t)}else Ja(t,e)}function Ja(t,e){for(;e!==null;){if((e.f&oo)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Rr=new Set;let Qe=null,jr=null,cn=null,on=[],so=null,Po=!1,Ua=!1;var Va,qa,wa,ya,Sr,Ka,Ya,Pt,No,lr,Ao,ti,ni;const Zr=class Zr{constructor(){Ge(this,Pt);Bt(this,"committed",!1);Bt(this,"current",new Map);Bt(this,"previous",new Map);Ge(this,Va,new Set);Ge(this,qa,new Set);Ge(this,wa,0);Ge(this,ya,0);Ge(this,Sr,null);Ge(this,Ka,new Set);Ge(this,Ya,new Set);Bt(this,"skipped_effects",new Set);Bt(this,"is_fork",!1)}is_deferred(){return this.is_fork||j(this,ya)>0}process(e){on=[],jr=null,this.apply();var a={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)ct(this,Pt,No).call(this,r,a);this.is_fork||ct(this,Pt,ti).call(this),this.is_deferred()?(ct(this,Pt,lr).call(this,a.effects),ct(this,Pt,lr).call(this,a.render_effects)):(jr=this,Qe=null,ms(a.render_effects),ms(a.effects),jr=null,j(this,Sr)?.resolve()),cn=null}capture(e,a){this.previous.has(e)||this.previous.set(e,a),(e.f&ra)===0&&(this.current.set(e,e.v),cn?.set(e,e.v))}activate(){Qe=this,this.apply()}deactivate(){Qe===this&&(Qe=null,cn=null)}flush(){if(this.activate(),on.length>0){if(ri(),Qe!==null&&Qe!==this)return}else j(this,wa)===0&&this.process([]);this.deactivate()}discard(){for(const e of j(this,qa))e(this);j(this,qa).clear()}increment(e){Ke(this,wa,j(this,wa)+1),e&&Ke(this,ya,j(this,ya)+1)}decrement(e){Ke(this,wa,j(this,wa)-1),e&&Ke(this,ya,j(this,ya)-1),this.revive()}revive(){for(const e of j(this,Ka))j(this,Ya).delete(e),Rt(e,Kt),Pa(e);for(const e of j(this,Ya))Rt(e,Sn),Pa(e);this.flush()}oncommit(e){j(this,Va).add(e)}ondiscard(e){j(this,qa).add(e)}settled(){return(j(this,Sr)??Ke(this,Sr,Vs())).promise}static ensure(){if(Qe===null){const e=Qe=new Zr;Rr.add(Qe),Ua||Zr.enqueue(()=>{Qe===e&&e.flush()})}return Qe}static enqueue(e){Aa(e)}apply(){}};Va=new WeakMap,qa=new WeakMap,wa=new WeakMap,ya=new WeakMap,Sr=new WeakMap,Ka=new WeakMap,Ya=new WeakMap,Pt=new WeakSet,No=function(e,a){e.f^=It;for(var r=e.first;r!==null;){var o=r.f,s=(o&(Vn|Na))!==0,i=s&&(o&It)!==0,l=i||(o&Jt)!==0||this.skipped_effects.has(r);if((r.f&oo)!==0&&r.b?.is_pending()&&(a={parent:a,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=It:(o&es)!==0?a.effects.push(r):Nr(r)&&((r.f&Wn)!==0&&j(this,Ka).add(r),_r(r));var u=r.first;if(u!==null){r=u;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===a.effect&&(ct(this,Pt,lr).call(this,a.effects),ct(this,Pt,lr).call(this,a.render_effects),a=a.parent),r=c.next,c=c.parent}},lr=function(e){for(const a of e)(a.f&Kt)!==0?j(this,Ka).add(a):(a.f&Sn)!==0&&j(this,Ya).add(a),ct(this,Pt,Ao).call(this,a.deps),Rt(a,It)},Ao=function(e){if(e!==null)for(const a of e)(a.f&Nt)===0||(a.f&Ea)===0||(a.f^=Ea,ct(this,Pt,Ao).call(this,a.deps))},ti=function(){if(j(this,ya)===0){for(const e of j(this,Va))e();j(this,Va).clear()}j(this,wa)===0&&ct(this,Pt,ni).call(this)},ni=function(){var s;if(Rr.size>1){this.previous.clear();var e=cn,a=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Rr){if(i===this){a=!1;continue}const l=[];for(const[c,d]of this.current){if(i.current.has(c))if(a&&d!==i.current.get(c))i.current.set(c,d);else continue;l.push(c)}if(l.length===0)continue;const u=[...i.current.keys()].filter(c=>!this.current.has(c));if(u.length>0){var o=on;on=[];const c=new Set,d=new Map;for(const v of l)oi(v,u,c,d);if(on.length>0){Qe=i,i.apply();for(const v of on)ct(s=i,Pt,No).call(s,v,r);i.deactivate()}on=o}}Qe=null,cn=e}this.committed=!0,Rr.delete(this)};let yn=Zr;function ai(t){var e=Ua;Ua=!0;try{for(var a;;){if(dc(),on.length===0&&(Qe?.flush(),on.length===0))return so=null,a;ri()}}finally{Ua=e}}function ri(){var t=Ta;Po=!0;var e=null;try{var a=0;for(Kr(!0);on.length>0;){var r=yn.ensure();if(a++>1e3){var o,s;uc()}r.process(on),sa.clear()}}finally{Po=!1,Kr(t),so=null}}function uc(){try{jl()}catch(t){Ja(t,so)}}let An=null;function ms(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Ln|Jt))===0&&Nr(r)&&(An=new Set,_r(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?bi(r):r.fn=null),An?.size>0)){sa.clear();for(const o of An){if((o.f&(Ln|Jt))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)An.has(i)&&(An.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const u=s[l];(u.f&(Ln|Jt))===0&&_r(u)}}An.clear()}}An=null}}function oi(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&Nt)!==0?oi(o,e,a,r):(s&(ns|Wn))!==0&&(s&Kt)===0&&si(o,e,r)&&(Rt(o,Kt),Pa(o))}}function si(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(e.includes(o))return!0;if((o.f&Nt)!==0&&si(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function Pa(t){for(var e=so=t;e.parent!==null;){e=e.parent;var a=e.f;if(Po&&e===Ze&&(a&Wn)!==0&&(a&qs)===0)return;if((a&(Na|Vn))!==0){if((a&It)===0)return;e.f^=It}}on.push(e)}function fc(t){let e=0,a=kn(0),r;return()=>{pr()&&(n(a),lo(()=>(e===0&&(r=Ft(()=>t(()=>ia(a)))),e+=1,()=>{Aa(()=>{e-=1,e===0&&(r?.(),r=void 0,ia(a))})})))}}var vc=da|nr|oo;function gc(t,e,a){new hc(t,e,a)}var nn,an,Qo,gn,ba,hn,rn,Wt,pn,Mn,Qn,Ca,$n,Sa,ea,Qr,xt,pc,mc,Do,Hr,Ur,Mo;class hc{constructor(e,a,r){Ge(this,xt);Bt(this,"parent");Ge(this,nn,!1);Ge(this,an);Ge(this,Qo,null);Ge(this,gn);Ge(this,ba);Ge(this,hn);Ge(this,rn,null);Ge(this,Wt,null);Ge(this,pn,null);Ge(this,Mn,null);Ge(this,Qn,null);Ge(this,Ca,0);Ge(this,$n,0);Ge(this,Sa,!1);Ge(this,ea,null);Ge(this,Qr,fc(()=>(Ke(this,ea,kn(j(this,Ca))),()=>{Ke(this,ea,null)})));Ke(this,an,e),Ke(this,gn,a),Ke(this,ba,r),this.parent=Ze.b,Ke(this,nn,!!j(this,gn).pending),Ke(this,hn,or(()=>{Ze.b=this;{var o=ct(this,xt,Do).call(this);try{Ke(this,rn,sn(()=>r(o)))}catch(s){this.error(s)}j(this,$n)>0?ct(this,xt,Ur).call(this):Ke(this,nn,!1)}return()=>{j(this,Qn)?.remove()}},vc))}is_pending(){return j(this,nn)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!j(this,gn).pending}update_pending_count(e){ct(this,xt,Mo).call(this,e),Ke(this,Ca,j(this,Ca)+e),j(this,ea)&&Rn(j(this,ea),j(this,Ca))}get_effect_pending(){return j(this,Qr).call(this),n(j(this,ea))}error(e){var a=j(this,gn).onerror;let r=j(this,gn).failed;if(j(this,Sa)||!a&&!r)throw e;j(this,rn)&&(qt(j(this,rn)),Ke(this,rn,null)),j(this,Wt)&&(qt(j(this,Wt)),Ke(this,Wt,null)),j(this,pn)&&(qt(j(this,pn)),Ke(this,pn,null));var o=!1,s=!1;const i=()=>{if(o){rc();return}o=!0,s&&ql(),yn.ensure(),Ke(this,Ca,0),j(this,pn)!==null&&xa(j(this,pn),()=>{Ke(this,pn,null)}),Ke(this,nn,this.has_pending_snippet()),Ke(this,rn,ct(this,xt,Hr).call(this,()=>(Ke(this,Sa,!1),sn(()=>j(this,ba).call(this,j(this,an)))))),j(this,$n)>0?ct(this,xt,Ur).call(this):Ke(this,nn,!1)};var l=Xe;try{Vt(null),s=!0,a?.(e,i),s=!1}catch(u){Ja(u,j(this,hn)&&j(this,hn).parent)}finally{Vt(l)}r&&Aa(()=>{Ke(this,pn,ct(this,xt,Hr).call(this,()=>{yn.ensure(),Ke(this,Sa,!0);try{return sn(()=>{r(j(this,an),()=>e,()=>i)})}catch(u){return Ja(u,j(this,hn).parent),null}finally{Ke(this,Sa,!1)}}))})}}nn=new WeakMap,an=new WeakMap,Qo=new WeakMap,gn=new WeakMap,ba=new WeakMap,hn=new WeakMap,rn=new WeakMap,Wt=new WeakMap,pn=new WeakMap,Mn=new WeakMap,Qn=new WeakMap,Ca=new WeakMap,$n=new WeakMap,Sa=new WeakMap,ea=new WeakMap,Qr=new WeakMap,xt=new WeakSet,pc=function(){try{Ke(this,rn,sn(()=>j(this,ba).call(this,j(this,an))))}catch(e){this.error(e)}Ke(this,nn,!1)},mc=function(){const e=j(this,gn).pending;e&&(Ke(this,Wt,sn(()=>e(j(this,an)))),yn.enqueue(()=>{var a=ct(this,xt,Do).call(this);Ke(this,rn,ct(this,xt,Hr).call(this,()=>(yn.ensure(),sn(()=>j(this,ba).call(this,a))))),j(this,$n)>0?ct(this,xt,Ur).call(this):(xa(j(this,Wt),()=>{Ke(this,Wt,null)}),Ke(this,nn,!1))}))},Do=function(){var e=j(this,an);return j(this,nn)&&(Ke(this,Qn,Fn()),j(this,an).before(j(this,Qn)),e=j(this,Qn)),e},Hr=function(e){var a=Ze,r=Xe,o=it;xn(j(this,hn)),Vt(j(this,hn)),Xa(j(this,hn).ctx);try{return e()}catch(s){return ei(s),null}finally{xn(a),Vt(r),Xa(o)}},Ur=function(){const e=j(this,gn).pending;j(this,rn)!==null&&(Ke(this,Mn,document.createDocumentFragment()),j(this,Mn).append(j(this,Qn)),ki(j(this,rn),j(this,Mn))),j(this,Wt)===null&&Ke(this,Wt,sn(()=>e(j(this,an))))},Mo=function(e){var a;if(!this.has_pending_snippet()){this.parent&&ct(a=this.parent,xt,Mo).call(a,e);return}Ke(this,$n,j(this,$n)+e),j(this,$n)===0&&(Ke(this,nn,!1),j(this,Wt)&&xa(j(this,Wt),()=>{Ke(this,Wt,null)}),j(this,Mn)&&(j(this,an).before(j(this,Mn)),Ke(this,Mn,null)))};function _c(t,e,a,r){const o=rr()?Tr:Er;if(a.length===0&&t.length===0){r(e.map(o));return}var s=Qe,i=Ze,l=ii();function u(){Promise.all(a.map(c=>wc(c))).then(c=>{l();try{r([...e.map(o),...c])}catch(d){(i.f&Ln)===0&&Ja(d,i)}s?.deactivate(),hr()}).catch(c=>{Ja(c,i)})}t.length>0?Promise.all(t).then(()=>{l();try{return u()}finally{s?.deactivate(),hr()}}):u()}function ii(){var t=Ze,e=Xe,a=it,r=Qe;return function(s=!0){xn(t),Vt(e),Xa(a),s&&r?.activate()}}function hr(){xn(null),Vt(null),Xa(null)}function Tr(t){var e=Nt|Kt,a=Xe!==null&&(Xe.f&Nt)!==0?Xe:null;return Ze!==null&&(Ze.f|=nr),{ctx:it,deps:null,effects:null,equals:Js,f:e,fn:t,reactions:null,rv:0,v:Et,wv:0,parent:a??Ze,ac:null}}function wc(t,e){let a=Ze;a===null&&Fl();var r=a.b,o=void 0,s=kn(Et),i=!Xe,l=new Map;return Ac(()=>{var u=Vs();o=u.promise;try{Promise.resolve(t()).then(u.resolve,u.reject).then(()=>{c===Qe&&c.committed&&c.deactivate(),hr()})}catch(h){u.reject(h),hr()}var c=Qe;if(i){var d=!r.is_pending();r.update_pending_count(1),c.increment(d),l.get(c)?.reject(Ba),l.delete(c),l.set(c,u)}const v=(h,p=void 0)=>{if(c.activate(),p)p!==Ba&&(s.f|=ra,Rn(s,p));else{(s.f&ra)!==0&&(s.f^=ra),Rn(s,h);for(const[m,k]of l){if(l.delete(m),m===c)break;k.reject(Ba)}}i&&(r.update_pending_count(-1),c.decrement(d))};u.promise.then(v,h=>v(null,h||"unknown"))}),mi(()=>{for(const u of l.values())u.reject(Ba)}),new Promise(u=>{function c(d){function v(){d===o?u(s):c(o)}d.then(v,v)}c(o)})}function T(t){const e=Tr(t);return xi(e),e}function Er(t){const e=Tr(t);return e.equals=Zs,e}function li(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)qt(e[a])}}function yc(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&Ln)===0?e:null;e=e.parent}return null}function as(t){var e,a=Ze;xn(yc(t));try{t.f&=~Ea,li(t),e=Ni(t)}finally{xn(a)}return e}function ci(t){var e=as(t);if(t.equals(e)||(Qe?.is_fork||(t.v=e),t.wv=Ei()),!Da)if(cn!==null)(pr()||Qe?.is_fork)&&cn.set(t,e);else{var a=(t.f&fn)===0?Sn:It;Rt(t,a)}}let Io=new Set;const sa=new Map;let di=!1;function kn(t,e){var a={f:0,v:t,reactions:null,equals:Js,rv:0,wv:0};return a}function D(t,e){const a=kn(t);return xi(a),a}function Lo(t,e=!1,a=!0){var o;const r=kn(t);return e||(r.equals=Zs),ar&&a&&it!==null&&it.l!==null&&((o=it.l).s??(o.s=[])).push(r),r}function f(t,e,a=!1){Xe!==null&&(!bn||(Xe.f&ps)!==0)&&rr()&&(Xe.f&(Nt|Wn|ns|ps))!==0&&!zn?.includes(t)&&Vl();let r=a?ft(e):e;return Rn(t,r)}function Rn(t,e){if(!t.equals(e)){var a=t.v;Da?sa.set(t,e):sa.set(t,a),t.v=e;var r=yn.ensure();r.capture(t,a),(t.f&Nt)!==0&&((t.f&Kt)!==0&&as(t),Rt(t,(t.f&fn)!==0?It:Sn)),t.wv=Ei(),ui(t,Kt),rr()&&Ze!==null&&(Ze.f&It)!==0&&(Ze.f&(Vn|Na))===0&&(en===null?Ic([t]):en.push(t)),!r.is_fork&&Io.size>0&&!di&&bc()}return e}function bc(){di=!1;var t=Ta;Kr(!0);const e=Array.from(Io);try{for(const a of e)(a.f&It)!==0&&Rt(a,Sn),Nr(a)&&_r(a)}finally{Kr(t)}Io.clear()}function ia(t){f(t,t.v+1)}function ui(t,e){var a=t.reactions;if(a!==null)for(var r=rr(),o=a.length,s=0;s<o;s++){var i=a[s],l=i.f;if(!(!r&&i===Ze)){var u=(l&Kt)===0;if(u&&Rt(i,e),(l&Nt)!==0){var c=i;cn?.delete(c),(l&Ea)===0&&(l&fn&&(i.f|=Ea),ui(c,Sn))}else u&&((l&Wn)!==0&&An!==null&&An.add(i),Pa(i))}}}function ft(t){if(typeof t!="object"||t===null||oa in t)return t;const e=ao(t);if(e!==Ws&&e!==Al)return t;var a=new Map,r=$o(t),o=D(0),s=On,i=l=>{if(On===s)return l();var u=Xe,c=On;Vt(null),bs(s);var d=l();return Vt(u),bs(c),d};return r&&a.set("length",D(t.length)),new Proxy(t,{defineProperty(l,u,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Ul();var d=a.get(u);return d===void 0?d=i(()=>{var v=D(c.value);return a.set(u,v),v}):f(d,c.value,!0),!0},deleteProperty(l,u){var c=a.get(u);if(c===void 0){if(u in l){const d=i(()=>D(Et));a.set(u,d),ia(o)}}else f(c,Et),ia(o);return!0},get(l,u,c){if(u===oa)return t;var d=a.get(u),v=u in l;if(d===void 0&&(!v||aa(l,u)?.writable)&&(d=i(()=>{var p=ft(v?l[u]:Et),m=D(p);return m}),a.set(u,d)),d!==void 0){var h=n(d);return h===Et?void 0:h}return Reflect.get(l,u,c)},getOwnPropertyDescriptor(l,u){var c=Reflect.getOwnPropertyDescriptor(l,u);if(c&&"value"in c){var d=a.get(u);d&&(c.value=n(d))}else if(c===void 0){var v=a.get(u),h=v?.v;if(v!==void 0&&h!==Et)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(l,u){if(u===oa)return!0;var c=a.get(u),d=c!==void 0&&c.v!==Et||Reflect.has(l,u);if(c!==void 0||Ze!==null&&(!d||aa(l,u)?.writable)){c===void 0&&(c=i(()=>{var h=d?ft(l[u]):Et,p=D(h);return p}),a.set(u,c));var v=n(c);if(v===Et)return!1}return d},set(l,u,c,d){var v=a.get(u),h=u in l;if(r&&u==="length")for(var p=c;p<v.v;p+=1){var m=a.get(p+"");m!==void 0?f(m,Et):p in l&&(m=i(()=>D(Et)),a.set(p+"",m))}if(v===void 0)(!h||aa(l,u)?.writable)&&(v=i(()=>D(void 0)),f(v,ft(c)),a.set(u,v));else{h=v.v!==Et;var k=i(()=>ft(c));f(v,k)}var _=Reflect.getOwnPropertyDescriptor(l,u);if(_?.set&&_.set.call(d,c),!h){if(r&&typeof u=="string"){var y=a.get("length"),E=Number(u);Number.isInteger(E)&&E>=y.v&&f(y,E+1)}ia(o)}return!0},ownKeys(l){n(o);var u=Reflect.ownKeys(l).filter(v=>{var h=a.get(v);return h===void 0||h.v!==Et});for(var[c,d]of a)d.v!==Et&&!(c in l)&&u.push(c);return u},setPrototypeOf(){Wl()}})}var _s,fi,vi,gi;function Cc(){if(_s===void 0){_s=window,fi=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;vi=aa(e,"firstChild").get,gi=aa(e,"nextSibling").get,hs(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),hs(a)&&(a.__t=void 0)}}function Fn(t=""){return document.createTextNode(t)}function Za(t){return vi.call(t)}function Pr(t){return gi.call(t)}function b(t,e){return Za(t)}function P(t,e=!1){{var a=Za(t);return a instanceof Comment&&a.data===""?Pr(a):a}}function A(t,e=1,a=!1){let r=t;for(;e--;)r=Pr(r);return r}function Sc(t){t.textContent=""}function hi(){return!1}let ws=!1;function kc(){ws||(ws=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function io(t){var e=Xe,a=Ze;Vt(null),xn(null);try{return t()}finally{Vt(e),xn(a)}}function xc(t,e,a,r=a){t.addEventListener(e,()=>io(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),kc()}function pi(t){Ze===null&&(Xe===null&&Bl(),Ol()),Da&&zl()}function Tc(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function En(t,e,a){var r=Ze;r!==null&&(r.f&Jt)!==0&&(t|=Jt);var o={ctx:it,deps:null,nodes:null,f:t|Kt|fn,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{_r(o),o.f|=ts}catch(l){throw qt(o),l}else e!==null&&Pa(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&nr)===0&&(s=s.first,(t&Wn)!==0&&(t&da)!==0&&s!==null&&(s.f|=da)),s!==null&&(s.parent=r,r!==null&&Tc(s,r),Xe!==null&&(Xe.f&Nt)!==0&&(t&Na)===0)){var i=Xe;(i.effects??(i.effects=[])).push(s)}return o}function pr(){return Xe!==null&&!bn}function mi(t){const e=En(ro,null,!1);return Rt(e,It),e.teardown=t,e}function Ue(t){pi();var e=Ze.f,a=!Xe&&(e&Vn)!==0&&(e&ts)===0;if(a){var r=it;(r.e??(r.e=[])).push(t)}else return _i(t)}function _i(t){return En(es|Ks,t,!1)}function Ec(t){return pi(),En(ro|Ks,t,!0)}function Pc(t){yn.ensure();const e=En(Na|nr,t,!0);return(a={})=>new Promise(r=>{a.outro?xa(e,()=>{qt(e),r(void 0)}):(qt(e),r(void 0))})}function Nc(t){return En(es,t,!1)}function Ac(t){return En(ns|nr,t,!0)}function lo(t,e=0){return En(ro|e,t,!0)}function Ie(t,e=[],a=[],r=[]){_c(r,e,a,o=>{En(ro,()=>t(...o.map(n)),!0)})}function or(t,e=0){var a=En(Wn|e,t,!0);return a}function sn(t){return En(Vn|nr,t,!0)}function wi(t){var e=t.teardown;if(e!==null){const a=Da,r=Xe;ys(!0),Vt(null);try{e.call(null)}finally{ys(a),Vt(r)}}}function yi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&io(()=>{o.abort(Ba)});var r=a.next;(a.f&Na)!==0?a.parent=null:qt(a,e),a=r}}function Dc(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&Vn)===0&&qt(e),e=a}}function qt(t,e=!0){var a=!1;(e||(t.f&qs)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Mc(t.nodes.start,t.nodes.end),a=!0),yi(t,e&&!a),Yr(t,0),Rt(t,Ln);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();wi(t);var o=t.parent;o!==null&&o.first!==null&&bi(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Mc(t,e){for(;t!==null;){var a=t===e?null:Pr(t);t.remove(),t=a}}function bi(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function xa(t,e,a=!0){var r=[];Ci(t,r,!0);var o=()=>{a&&qt(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var l of r)l.out(i)}else o()}function Ci(t,e,a){if((t.f&Jt)===0){t.f^=Jt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||a)&&e.push(l);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&da)!==0||(o.f&Vn)!==0&&(t.f&Wn)!==0;Ci(o,e,i?a:!1),o=s}}}function rs(t){Si(t,!0)}function Si(t,e){if((t.f&Jt)!==0){t.f^=Jt,(t.f&It)===0&&(Rt(t,Kt),Pa(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&da)!==0||(a.f&Vn)!==0;Si(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function ki(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Pr(a);e.append(a),a=o}}let Ta=!1;function Kr(t){Ta=t}let Da=!1;function ys(t){Da=t}let Xe=null,bn=!1;function Vt(t){Xe=t}let Ze=null;function xn(t){Ze=t}let zn=null;function xi(t){Xe!==null&&(zn===null?zn=[t]:zn.push(t))}let jt=null,Yt=0,en=null;function Ic(t){en=t}let Ti=1,mr=0,On=mr;function bs(t){On=t}function Ei(){return++Ti}function Nr(t){var e=t.f;if((e&Kt)!==0)return!0;if(e&Nt&&(t.f&=~Ea),(e&Sn)!==0){var a=t.deps;if(a!==null)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(Nr(s)&&ci(s),s.wv>t.wv)return!0}(e&fn)!==0&&cn===null&&Rt(t,It)}return!1}function Pi(t,e,a=!0){var r=t.reactions;if(r!==null&&!zn?.includes(t))for(var o=0;o<r.length;o++){var s=r[o];(s.f&Nt)!==0?Pi(s,e,!1):e===s&&(a?Rt(s,Kt):(s.f&It)!==0&&Rt(s,Sn),Pa(s))}}function Ni(t){var m;var e=jt,a=Yt,r=en,o=Xe,s=zn,i=it,l=bn,u=On,c=t.f;jt=null,Yt=0,en=null,Xe=(c&(Vn|Na))===0?t:null,zn=null,Xa(t.ctx),bn=!1,On=++mr,t.ac!==null&&(io(()=>{t.ac.abort(Ba)}),t.ac=null);try{t.f|=Eo;var d=t.fn,v=d(),h=t.deps;if(jt!==null){var p;if(Yr(t,Yt),h!==null&&Yt>0)for(h.length=Yt+jt.length,p=0;p<jt.length;p++)h[Yt+p]=jt[p];else t.deps=h=jt;if(pr()&&(t.f&fn)!==0)for(p=Yt;p<h.length;p++)((m=h[p]).reactions??(m.reactions=[])).push(t)}else h!==null&&Yt<h.length&&(Yr(t,Yt),h.length=Yt);if(rr()&&en!==null&&!bn&&h!==null&&(t.f&(Nt|Sn|Kt))===0)for(p=0;p<en.length;p++)Pi(en[p],t);return o!==null&&o!==t&&(mr++,en!==null&&(r===null?r=en:r.push(...en))),(t.f&ra)!==0&&(t.f^=ra),v}catch(k){return ei(k)}finally{t.f^=Eo,jt=e,Yt=a,en=r,Xe=o,zn=s,Xa(i),bn=l,On=u}}function Lc(t,e){let a=e.reactions;if(a!==null){var r=Pl.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}a===null&&(e.f&Nt)!==0&&(jt===null||!jt.includes(e))&&(Rt(e,Sn),(e.f&fn)!==0&&(e.f^=fn,e.f&=~Ea),li(e),Yr(e,0))}function Yr(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Lc(t,a[r])}function _r(t){var e=t.f;if((e&Ln)===0){Rt(t,It);var a=Ze,r=Ta;Ze=t,Ta=!0;try{(e&(Wn|Ll))!==0?Dc(t):yi(t),wi(t);var o=Ni(t);t.teardown=typeof o=="function"?o:null,t.wv=Ti;var s;xo&&sc&&(t.f&Kt)!==0&&t.deps}finally{Ta=r,Ze=a}}}async function Ai(){await Promise.resolve(),ai()}function n(t){var e=t.f,a=(e&Nt)!==0;if(Xe!==null&&!bn){var r=Ze!==null&&(Ze.f&Ln)!==0;if(!r&&!zn?.includes(t)){var o=Xe.deps;if((Xe.f&Eo)!==0)t.rv<mr&&(t.rv=mr,jt===null&&o!==null&&o[Yt]===t?Yt++:jt===null?jt=[t]:jt.includes(t)||jt.push(t));else{(Xe.deps??(Xe.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[Xe]:s.includes(Xe)||s.push(Xe)}}}if(Da){if(sa.has(t))return sa.get(t);if(a){var i=t,l=i.v;return((i.f&It)===0&&i.reactions!==null||Mi(i))&&(l=as(i)),sa.set(i,l),l}}else a&&(!cn?.has(t)||Qe?.is_fork&&!pr())&&(i=t,Nr(i)&&ci(i),Ta&&pr()&&(i.f&fn)===0&&Di(i));if(cn?.has(t))return cn.get(t);if((t.f&ra)!==0)throw t.v;return t.v}function Di(t){if(t.deps!==null){t.f^=fn;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&fn)===0&&Di(e)}}function Mi(t){if(t.v===Et)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(sa.has(e)||(e.f&Nt)!==0&&Mi(e))return!0;return!1}function Ft(t){var e=bn;try{return bn=!0,t()}finally{bn=e}}const Rc=-7169;function Rt(t,e){t.f=t.f&Rc|e}function Fc(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(oa in t)Ro(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&oa in a&&Ro(a)}}}function Ro(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Ro(t[r],e)}catch{}const a=ao(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Us(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const zc=["touchstart","touchmove"];function Oc(t){return zc.includes(t)}const Ii=new Set,Fo=new Set;function Bc(t,e,a,r={}){function o(s){if(r.capture||cr.call(e,s),!s.cancelBubble)return io(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Aa(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function Zt(t,e,a,r,o){var s={capture:r,passive:o},i=Bc(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&mi(()=>{e.removeEventListener(t,i,s)})}function pt(t){for(var e=0;e<t.length;e++)Ii.add(t[e]);for(var a of Fo)a(t)}let Cs=null;function cr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;Cs=t;var i=0,l=Cs===t&&t.__root;if(l){var u=o.indexOf(l);if(u!==-1&&(e===document||e===window)){t.__root=e;return}var c=o.indexOf(e);if(c===-1)return;u<=c&&(i=u)}if(s=o[i]||t.target,s!==e){Nl(t,"currentTarget",{configurable:!0,get(){return s||a}});var d=Xe,v=Ze;Vt(null),xn(null);try{for(var h,p=[];s!==null;){var m=s.assignedSlot||s.parentNode||s.host||null;try{var k=s["__"+r];k!=null&&(!s.disabled||t.target===s)&&k.call(s,t)}catch(_){h?p.push(_):h=_}if(t.cancelBubble||m===e||m===null)break;s=m}if(h){for(let _ of p)queueMicrotask(()=>{throw _});throw h}}finally{t.__root=e,delete t.currentTarget,Vt(d),xn(v)}}}function Li(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function wr(t,e){var a=Ze;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function S(t,e){var a=(e&tc)!==0,r=(e&nc)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=Li(s?t:"<!>"+t),a||(o=Za(o)));var i=r||fi?document.importNode(o,!0):o.cloneNode(!0);if(a){var l=Za(i),u=i.lastChild;wr(l,u)}else wr(i,i);return i}}function jc(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=Li(o),l=Za(i);s=Za(l)}var u=s.cloneNode(!0);return wr(u,u),u}}function Hc(t,e){return jc(t,e,"svg")}function Ye(t=""){{var e=Fn(t+"");return wr(e,e),e}}function ye(){var t=document.createDocumentFragment(),e=document.createComment(""),a=Fn();return t.append(e,a),wr(e,a),t}function g(t,e){t!==null&&t.before(e)}function np(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function vt(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Uc(t,e){return Wc(t,e)}const za=new Map;function Wc(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){Cc();var l=new Set,u=v=>{for(var h=0;h<v.length;h++){var p=v[h];if(!l.has(p)){l.add(p);var m=Oc(p);e.addEventListener(p,cr,{passive:m});var k=za.get(p);k===void 0?(document.addEventListener(p,cr,{passive:m}),za.set(p,1)):za.set(p,k+1)}}};u(no(Ii)),Fo.add(u);var c=void 0,d=Pc(()=>{var v=a??e.appendChild(Fn());return gc(v,{pending:()=>{}},h=>{if(s){Ce({});var p=it;p.c=s}o&&(r.$$events=o),c=t(h,r)||{},s&&Se()}),()=>{for(var h of l){e.removeEventListener(h,cr);var p=za.get(h);--p===0?(document.removeEventListener(h,cr),za.delete(h)):za.set(h,p)}Fo.delete(u),v!==a&&v.parentNode?.removeChild(v)}});return Vc.set(c,d),c}let Vc=new WeakMap;var dn,mn,Xt,ka,kr,xr,$r;class co{constructor(e,a=!0){Bt(this,"anchor");Ge(this,dn,new Map);Ge(this,mn,new Map);Ge(this,Xt,new Map);Ge(this,ka,new Set);Ge(this,kr,!0);Ge(this,xr,()=>{var e=Qe;if(j(this,dn).has(e)){var a=j(this,dn).get(e),r=j(this,mn).get(a);if(r)rs(r),j(this,ka).delete(a);else{var o=j(this,Xt).get(a);o&&(j(this,mn).set(a,o.effect),j(this,Xt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of j(this,dn)){if(j(this,dn).delete(s),s===e)break;const l=j(this,Xt).get(i);l&&(qt(l.effect),j(this,Xt).delete(i))}for(const[s,i]of j(this,mn)){if(s===a||j(this,ka).has(s))continue;const l=()=>{if(Array.from(j(this,dn).values()).includes(s)){var c=document.createDocumentFragment();ki(i,c),c.append(Fn()),j(this,Xt).set(s,{effect:i,fragment:c})}else qt(i);j(this,ka).delete(s),j(this,mn).delete(s)};j(this,kr)||!r?(j(this,ka).add(s),xa(i,l,!1)):l()}}});Ge(this,$r,e=>{j(this,dn).delete(e);const a=Array.from(j(this,dn).values());for(const[r,o]of j(this,Xt))a.includes(r)||(qt(o.effect),j(this,Xt).delete(r))});this.anchor=e,Ke(this,kr,a)}ensure(e,a){var r=Qe,o=hi();if(a&&!j(this,mn).has(e)&&!j(this,Xt).has(e))if(o){var s=document.createDocumentFragment(),i=Fn();s.append(i),j(this,Xt).set(e,{effect:sn(()=>a(i)),fragment:s})}else j(this,mn).set(e,sn(()=>a(this.anchor)));if(j(this,dn).set(r,e),o){for(const[l,u]of j(this,mn))l===e?r.skipped_effects.delete(u):r.skipped_effects.add(u);for(const[l,u]of j(this,Xt))l===e?r.skipped_effects.delete(u.effect):r.skipped_effects.add(u.effect);r.oncommit(j(this,xr)),r.ondiscard(j(this,$r))}else j(this,xr).call(this)}}dn=new WeakMap,mn=new WeakMap,Xt=new WeakMap,ka=new WeakMap,kr=new WeakMap,xr=new WeakMap,$r=new WeakMap;const qc=0,bo=1;function Kc(t,e,a,r,o){var s=rr(),i=Et,l=s?kn(i):Lo(i,!1,!1),u=s?kn(i):Lo(i,!1,!1),c=new co(t);or(()=>{var d=e(),v=!1;if(Dl(d)){var h=ii(),p=!1;const m=k=>{if(!v){p=!0,h(!1),yn.ensure();try{k()}finally{hr(),Ua||ai()}}};d.then(k=>{m(()=>{Rn(l,k),c.ensure(bo,r&&(_=>r(_,l)))})},k=>{m(()=>{if(Rn(u,k),c.ensure(bo,o&&(_=>o(_,u))),!o)throw u.v})}),Aa(()=>{p||m(()=>{c.ensure(qc,a)})})}else Rn(l,d),c.ensure(bo,r&&(m=>r(m,l)));return()=>{v=!0}})}function B(t,e,a=!1){var r=new co(t),o=a?da:0;function s(i,l){r.ensure(i,l)}or(()=>{var i=!1;e((l,u=!0)=>{i=!0,s(u,l)}),i||s(!1,null)},o)}function ge(t,e){lo(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Yc(t,e,a){for(var r=[],o=e.length,s,i=e.length,l=0;l<o;l++){let v=e[l];xa(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var h=t.outrogroups;zo(no(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var u=r.length===0&&a!==null;if(u){var c=a,d=c.parentNode;Sc(d),d.append(c),t.items.clear()}zo(e,!u)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function zo(t,e=!0){for(var a=0;a<t.length;a++)qt(t[a],e)}var Ss;function Bn(t,e,a,r,o,s=null){var i=t,l=new Map,u=(e&Xs)!==0;if(u){var c=t;i=c.appendChild(Fn())}var d=null,v=Er(()=>{var y=a();return $o(y)?y:y==null?[]:no(y)}),h,p=!0;function m(){_.fallback=d,Gc(_,h,i,e,r),d!==null&&(h.length===0?(d.f&In)===0?rs(d):(d.f^=In,dr(d,null,i)):xa(d,()=>{d=null}))}var k=or(()=>{h=n(v);for(var y=h.length,E=new Set,w=Qe,C=hi(),N=0;N<y;N+=1){var Y=h[N],z=r(Y,N),U=p?null:l.get(z);U?(U.v&&Rn(U.v,Y),U.i&&Rn(U.i,N),C&&w.skipped_effects.delete(U.e)):(U=Xc(l,p?i:Ss??(Ss=Fn()),Y,z,N,o,e,a),p||(U.e.f|=In),l.set(z,U)),E.add(z)}if(y===0&&s&&!d&&(p?d=sn(()=>s(i)):(d=sn(()=>s(Ss??(Ss=Fn()))),d.f|=In)),!p)if(C){for(const[R,G]of l)E.has(R)||w.skipped_effects.add(G.e);w.oncommit(m),w.ondiscard(()=>{})}else m();n(v)}),_={effect:k,items:l,outrogroups:null,fallback:d};p=!1}function Gc(t,e,a,r,o){var s=(r&Gl)!==0,i=e.length,l=t.items,u=t.effect.first,c,d=null,v,h=[],p=[],m,k,_,y;if(s)for(y=0;y<i;y+=1)m=e[y],k=o(m,y),_=l.get(k).e,(_.f&In)===0&&(_.nodes?.a?.measure(),(v??(v=new Set)).add(_));for(y=0;y<i;y+=1){if(m=e[y],k=o(m,y),_=l.get(k).e,t.outrogroups!==null)for(const G of t.outrogroups)G.pending.delete(_),G.done.delete(_);if((_.f&In)!==0)if(_.f^=In,_===u)dr(_,null,a);else{var E=d?d.next:u;_===t.effect.last&&(t.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),Yn(t,d,_),Yn(t,_,E),dr(_,E,a),d=_,h=[],p=[],u=d.next;continue}if((_.f&Jt)!==0&&(rs(_),s&&(_.nodes?.a?.unfix(),(v??(v=new Set)).delete(_))),_!==u){if(c!==void 0&&c.has(_)){if(h.length<p.length){var w=p[0],C;d=w.prev;var N=h[0],Y=h[h.length-1];for(C=0;C<h.length;C+=1)dr(h[C],w,a);for(C=0;C<p.length;C+=1)c.delete(p[C]);Yn(t,N.prev,Y.next),Yn(t,d,N),Yn(t,Y,w),u=w,d=Y,y-=1,h=[],p=[]}else c.delete(_),dr(_,u,a),Yn(t,_.prev,_.next),Yn(t,_,d===null?t.effect.first:d.next),Yn(t,d,_),d=_;continue}for(h=[],p=[];u!==null&&u!==_;)(c??(c=new Set)).add(u),p.push(u),u=u.next;if(u===null)continue}(_.f&In)===0&&h.push(_),d=_,u=_.next}if(t.outrogroups!==null){for(const G of t.outrogroups)G.pending.size===0&&(zo(no(G.done)),t.outrogroups?.delete(G));t.outrogroups.size===0&&(t.outrogroups=null)}if(u!==null||c!==void 0){var z=[];if(c!==void 0)for(_ of c)(_.f&Jt)===0&&z.push(_);for(;u!==null;)(u.f&Jt)===0&&u!==t.fallback&&z.push(u),u=u.next;var U=z.length;if(U>0){var R=(r&Xs)!==0&&i===0?a:null;if(s){for(y=0;y<U;y+=1)z[y].nodes?.a?.measure();for(y=0;y<U;y+=1)z[y].nodes?.a?.fix()}Yc(t,z,R)}}s&&Aa(()=>{if(v!==void 0)for(_ of v)_.nodes?.a?.apply()})}function Xc(t,e,a,r,o,s,i,l){var u=(i&Kl)!==0?(i&Xl)===0?Lo(a,!1,!1):kn(a):null,c=(i&Yl)!==0?kn(o):null;return{v:u,i:c,e:sn(()=>(s(e,u??a,c??o,l),()=>{t.delete(r)}))}}function dr(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&In)===0?e.nodes.start:a;r!==null;){var i=Pr(r);if(s.before(r),r===o)return;r=i}}function Yn(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function We(t,e,...a){var r=new co(t);or(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},da)}function Jc(t,e,a){var r=new co(t);or(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},da)}function Ri(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=Ri(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function Zc(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=Ri(t))&&(r&&(r+=" "),r+=e);return r}function nt(t){return typeof t=="object"?Zc(t):t??""}const ks=[...` 	
\r\fÂ \v\uFEFF`];function Qc(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||ks.includes(r[i-1]))&&(l===r.length||ks.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function $c(t,e){return t==null?null:String(t)}function et(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var l=Qc(a,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=a}else if(s&&o!==s)for(var u in s){var c=!!s[u];(o==null||c!==!!o[u])&&t.classList.toggle(u,c)}return s}function Qa(t,e,a,r){var o=t.__style;if(o!==e){var s=$c(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const ed=Symbol("is custom element"),td=Symbol("is html");function ap(t,e){var a=os(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function rp(t,e){var a=os(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function dt(t,e,a,r){var o=os(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Rl]=a),a==null?t.removeAttribute(e):typeof a!="string"&&nd(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function os(t){return t.__attributes??(t.__attributes={[ed]:t.nodeName.includes("-"),[td]:t.namespaceURI===ac})}var xs=new Map;function nd(t){var e=t.getAttribute("is")||t.nodeName,a=xs.get(e);if(a)return a;xs.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=Us(o);for(var i in r)r[i].set&&a.push(i);o=ao(o)}return a}function Fi(t,e,a=e){var r=new WeakSet;xc(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=Co(t)?So(s):s,a(s),Qe!==null&&r.add(Qe),await Ai(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,u=t.value.length;if(t.value=s??"",l!==null){var c=t.value.length;i===l&&l===u&&c>u?(t.selectionStart=c,t.selectionEnd=c):(t.selectionStart=i,t.selectionEnd=Math.min(l,c))}}}),Ft(e)==null&&t.value&&(a(Co(t)?So(t.value):t.value),Qe!==null&&r.add(Qe)),lo(()=>{var o=e();if(t===document.activeElement){var s=jr??Qe;if(r.has(s))return}Co(t)&&o===So(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function Co(t){var e=t.type;return e==="number"||e==="range"}function So(t){return t===""?null:+t}function Ts(t,e){return t===e||t?.[oa]===e}function $e(t={},e,a,r){return Nc(()=>{var o,s;return lo(()=>{o=s,s=[],Ft(()=>{t!==a(...s)&&(e(t,...s),o&&Ts(a(...o),t)&&e(null,...o))})}),()=>{Aa(()=>{s&&Ts(a(...s),t)&&e(null,...s)})}}),t}function ss(t=!1){const e=it,a=e.l.u;if(!a)return;let r=()=>Fc(e.s);if(t){let o=0,s={};const i=Tr(()=>{let l=!1;const u=e.s;for(const c in u)u[c]!==s[c]&&(s[c]=u[c],l=!0);return l&&o++,o});r=()=>n(i)}a.b.length&&Ec(()=>{Es(e,r),To(a.b)}),Ue(()=>{const o=Ft(()=>a.m.map(Ml));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&Ue(()=>{Es(e,r),To(a.a)})}function Es(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let Fr=!1;function ad(t){var e=Fr;try{return Fr=!1,[t(),Fr]}finally{Fr=e}}const rd={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];sr(o)&&(o=o());const s=aa(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=aa(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===oa||e===Ys)return!1;for(let a of t.props)if(sr(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(sr(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function Oo(...t){return new Proxy({props:t},rd)}function Oe(t,e,a,r){var o=!ar||(a&Zl)!==0,s=(a&$l)!==0,i=(a&ec)!==0,l=r,u=!0,c=()=>(u&&(u=!1,l=i?Ft(r):r),l),d;if(s){var v=oa in t||Ys in t;d=aa(t,e)?.set??(v&&e in t?w=>t[e]=w:void 0)}var h,p=!1;s?[h,p]=ad(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=c(),d&&(o&&Hl(),d(h)));var m;if(o?m=()=>{var w=t[e];return w===void 0?c():(u=!0,w)}:m=()=>{var w=t[e];return w!==void 0&&(l=void 0),w===void 0?l:w},o&&(a&Ql)===0)return m;if(d){var k=t.$$legacy;return(function(w,C){return arguments.length>0?((!o||!C||k||p)&&d(C?m():w),w):m()})}var _=!1,y=((a&Jl)!==0?Tr:Er)(()=>(_=!1,m()));s&&n(y);var E=Ze;return(function(w,C){if(arguments.length>0){const N=C?n(y):o&&s?ft(w):w;return f(y,N),_=!0,l!==void 0&&(l=N),w}return Da&&_||(E.f&Ln)!==0?y.v:n(y)})}function Ne(t){it===null&&Gs(),ar&&it.l!==null?od(it).m.push(t):Ue(()=>{const e=Ft(t);if(typeof e=="function")return e})}function od(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const sd="5";var Hs;typeof window<"u"&&((Hs=window.__svelte??(window.__svelte={})).v??(Hs.v=new Set)).add(sd);ic();const zi={};function id(t){ht(zi,t)}function $a(){const t=gt(zi);if(!t)throw new Error("No FeedSearchContext found");return t}const Oi={};function ld(t){ht(Oi,t)}function Ht(){const t=gt(Oi);if(!t)throw new Error("No SearchParamsContext found");return t}function cd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Ht(),s="feedSearch",i=T(()=>o().get(s)||""),l=T(()=>n(i));id({getFeedSearch:()=>n(l),setFeedSearch:d=>{d===""?r(s):a(s,d)}});var u=ye(),c=P(u);We(c,()=>e.children??Je),g(t,u),Se()}const Bi={};function dd(t){ht(Bi,t)}function ud(){const t=gt(Bi);if(!t)throw new Error("No TagsSearchContext found");return t}function fd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Ht(),s="tagsSearch",i=T(()=>o().get(s)||""),l=T(()=>n(i));dd({getTagsSearch:()=>n(l),setTagsSearch:d=>{d===""?r(s):a(s,d)}});var u=ye(),c=P(u);We(c,()=>e.children??Je),g(t,u),Se()}const ji={};function vd(t){ht(ji,t)}function Hi(){const t=gt(ji);if(!t)throw new Error("No FeedOrderContext found");return t}function gd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Ht(),s="feedOrder",i=T(()=>o().get(s)||"newest"),l=T(()=>n(i));let u=["newest","oldest","AtoZ","ZtoA","updatedNewest"];vd({getFeedOrder:()=>n(l),setFeedOrder:v=>{v==="newest"||!u.includes(v)?r(s):a(s,v)}});var c=ye(),d=P(c);We(d,()=>e.children??Je),g(t,c),Se()}const Ui={};function hd(t){ht(Ui,t)}function Ar(){const t=gt(Ui);if(!t)throw new Error("No SidebarContext found");return t}function pd(t,e){Ce(e,!0);let a=D("closed");hd({sidebarOpen:()=>{f(a,"preOpening")},sidebarClose:()=>{f(a,"closing")},getSidebarState:()=>n(a),setSidebarState:c=>{f(a,c,!0)}});var l=ye(),u=P(l);We(u,()=>e.children??Je),g(t,l),Se()}const Wi={};function md(t){ht(Wi,t)}function qn(){const t=gt(Wi);if(!t)throw new Error("No SelectedTagsContext found");return t}function _d(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Ht(),s=T(a),i="selectedTags";let l=T(()=>n(s).get(i)||""),u=T(()=>new Set(n(l).split(",").map(_=>decodeURIComponent(_)).filter(_=>_!=="")));md({getSelectedTags:()=>n(u),addTag:_=>{n(u).has(_)||r(i,[...n(u),_].map(y=>encodeURIComponent(y)).join(","))},removeTag:_=>{n(u).has(_)&&n(u).size===1?o(i):n(u).has(_)&&r(i,[...n(u)].filter(y=>y!==_).map(y=>encodeURIComponent(y)).join(","))},clearTags:()=>{o(i)},setSelectedTags:_=>{_.size===0?o(i):r(i,[..._].map(y=>encodeURIComponent(y)).join(","))}});var m=ye(),k=P(m);We(k,()=>e.children??Je),g(t,m),Se()}const Vi={};function wd(t){ht(Vi,t)}function fa(){const t=gt(Vi);if(!t)throw new Error("No SelectedNotesContext found");return t}var yd=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],bd=["difference","intersection","symmetricDifference","union"],Ps=!1,Ga,un,ta,eo,er,qi,Ki;const to=class to extends Set{constructor(a){super();Ge(this,er);Ge(this,Ga,new Map);Ge(this,un,D(0));Ge(this,ta,D(0));Ge(this,eo,On||-1);if(a){for(var r of a)super.add(r);j(this,ta).v=super.size}Ps||ct(this,er,Ki).call(this)}has(a){var r=super.has(a),o=j(this,Ga),s=o.get(a);if(s===void 0){if(!r)return n(j(this,un)),!1;s=ct(this,er,qi).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),f(j(this,ta),super.size),ia(j(this,un))),this}delete(a){var r=super.delete(a),o=j(this,Ga),s=o.get(a);return s!==void 0&&(o.delete(a),f(s,!1)),r&&(f(j(this,ta),super.size),ia(j(this,un))),r}clear(){if(super.size!==0){super.clear();var a=j(this,Ga);for(var r of a.values())f(r,!1);a.clear(),f(j(this,ta),0),ia(j(this,un))}}keys(){return this.values()}values(){return n(j(this,un)),super.values()}entries(){return n(j(this,un)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(j(this,ta))}};Ga=new WeakMap,un=new WeakMap,ta=new WeakMap,eo=new WeakMap,er=new WeakSet,qi=function(a){return On===j(this,eo)?D(a):kn(a)},Ki=function(){Ps=!0;var a=to.prototype,r=Set.prototype;for(const o of yd)a[o]=function(...s){return n(j(this,un)),r[o].apply(this,s)};for(const o of bd)a[o]=function(...s){n(j(this,un));var i=r[o].apply(this,s);return new to(i)}};let Bo=to;function Cd(t,e){Ce(e,!0);let a=new Bo,r=D("single");const o=()=>a,s=p=>{a.clear(),p.forEach(m=>a.add(m))},i=p=>{a.add(p)},l=p=>{a.delete(p)},u=()=>{a.clear()};wd({getSelectedNotes:o,setSelectedNotes:s,addNote:i,removeNote:l,clearNotes:u,getMode:()=>n(r),changeMode:p=>{f(r,p,!0),p==="single"&&u()}});var v=ye(),h=P(v);We(h,()=>e.children??Je),g(t,v),Se()}const Yi={};function Sd(t){ht(Yi,t)}function is(){const t=gt(Yi);if(!t)throw new Error("No LocalDBContext found");return t}const Gi={};function kd(t){ht(Gi,t)}function ua(){const t=gt(Gi);if(!t)throw new Error("No SettingsContext found");return t}const Xi={};function xd(t){ht(Xi,t)}function uo(){const t=gt(Xi);if(!t)throw new Error("No BroadcastContext found");return t}const Td="AppStorage",Ed=1,ur="account",Xn="settings",rt="notes",Ut="tags",Pd="syncLog",va="success",Hn="error",kt=(t,e,a)=>{t?.addEventListener(e,a)},Ns=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();kt(s,va,()=>{const i=s?.result||[];a(i)}),kt(s,Hn,i=>{r(i)})}),Gr=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);kt(i,va,()=>{const l=i?.result?.data;r(l)}),kt(i,Hn,l=>{o(l)})}),wn=(t,e,a,r)=>new Promise((o,s)=>{const u=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});kt(u,va,()=>{o()}),kt(u,Hn,c=>{s(c)})}),yt=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((l,u)=>{kt(i,va,()=>{l()}),kt(i,Hn,c=>{u(c)})})}))},ko=(t,e,a)=>new Promise((r,o)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);kt(l,va,()=>{r()}),kt(l,Hn,u=>{o(u)})}),ir=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((l,u)=>{kt(i,va,()=>{l()}),kt(i,Hn,c=>{u(c)})})}))},ja=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();kt(i,va,()=>{a()}),kt(i,Hn,l=>{r(l)})}),tn="dialogPages",Ji={};function Nd(t){ht(Ji,t)}function zt(){const t=gt(Ji);if(!t)throw new Error("No DialogPagesContext found");return t}var Pe=(t=>(t.NewNote="newNote",t.Note="note",t.Settings="settings",t.ImportData="importData",t.ExportData="exportData",t.Account="account",t.Sync="sync",t.AccountSetup="accountSetup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="accessKeys",t.ConfirmAccessKey="confirmAccessKey",t.Subscription="subscription",t.Exit="exit",t.NotFound="notFound",t.About="about",t.Install="install",t.InstallSuccess="installSuccess",t.Extension="extension",t))(Pe||{});const As={settings:"Settings",importData:"Import",exportData:"Export",account:"Account",sync:"Sync",accountSetup:"",auth:"Auth",signin:"Sign in",signup:"Sign up",confirmAccessKey:"Confirm access key",accessKeys:"Access keys",subscription:"Subscription",exit:"Exit",notFound:"",about:"About",install:"Install app",installSuccess:"Install success",extension:"Extension"},Ds=()=>chrome,Zi=()=>LanguageModel;function Ad(t,e){Ce(e,!0);const{deleteSearchParam:a,replaceSearchParams:r}=Ht(),{clearDialogPages:o,getDialogPages:s,replaceDialogPage:i}=zt(),l="viewMode";let c=ft((()=>{const M=new URLSearchParams(window.location.search).get(l)||"tab";return M==="popup"||M==="window"||M==="tab"||M==="sidebar"?M:"tab"})());Ne(()=>{a(l)});let d=D(!1),v=D(ft({showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:h}=is(),{createBroadcastChannel:p,tabId:m}=uo(),k=p(),_=T(h),y=async()=>{const ue=await Gr(n(_),Xn,"default");ue&&f(v,ue,!0)},E=async()=>{await y();const M=s().at(-1)||"";M.startsWith(Pe.NewNote+"?id=")&&i(M.replace(Pe.NewNote,Pe.Note)),f(d,!0)};Ne(()=>{});const w=async ue=>{const M=JSON.parse(ue.data),I=M;if(M.tabId&&M.tabId===m){I.type==="exit"&&(f(v,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),ja(n(_),Xn));return}I.type==="updateSettings"?y():I.type==="exit"&&f(v,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},C=()=>n(v).showFavicon,N=()=>n(v).recordMode,Y=async ue=>{n(v).showFavicon=ue,await wn(n(_),Xn,"default",_n(n(v))),k.postMessage({type:"updateSettings"})},z=async ue=>{n(v).recordMode=ue,await wn(n(_),Xn,"default",_n(n(v))),k.postMessage({type:"updateSettings"})},U=async ue=>{n(v).tags.prev=ue,await wn(n(_),Xn,"default",_n(n(v))),k.postMessage({type:"updateSettings"})},R=()=>n(v).tags.prev||[],G=async ue=>{n(v).tags.llm=ue,await wn(n(_),Xn,"default",_n(n(v))),k.postMessage({type:"updateSettings"})},Q=()=>n(v).tags.llm,se=()=>n(v).tags.pageData,H=async ue=>{n(v).tags.pageData=ue,await wn(n(_),Xn,"default",_n(n(v))),k.postMessage({type:"updateSettings"})};Ne(()=>(E(),k.addEventListener(w),()=>{k.removeEventListener(w)})),kd({getFaviconEnabled:C,getRecordMode:N,setRecordMode:z,setFaviconShown:Y,isInitedSettings:()=>n(d),getViewMode:()=>c,setLlmTagsEnabled:G,getLlmTagsEnabled:Q,setPrevTags:U,getPrevTags:R,getPageDataForTagsEnabled:se,setPageDataForTagsEnabled:H});var O=ye(),we=P(O);We(we,()=>e.children??Je),g(t,O),Se()}const Qi={};function Dd(t){ht(Qi,t)}function ls(){const t=gt(Qi);if(!t)throw new Error("No AccountContext found");return t}function Md(t,e){Ce(e,!0);let a=D(void 0);const{getDB:r}=is(),{createBroadcastChannel:o,tabId:s}=uo(),i=T(r),l=o(),u=async()=>{const w=await Gr(n(i),ur,"default");f(a,w,!0)},c=w=>wn(n(i),ur,"default",w),d=async w=>{const C=await Gr(n(i),ur,"default");C!==void 0&&f(a,C,!0),w(C)},v=async w=>{const C=JSON.parse(w.data);if(C.tabId&&C.tabId===s)return;const N=C;N.type==="initLocalAccount"?f(a,null):N.type==="initCloudAccount"?u():N.type==="disconnectCloudAccount"?f(a,null):N.type==="exit"?f(a,void 0):N.type==="updateAccount"&&u()};Ne(()=>(l.addEventListener(v),()=>{l.removeEventListener(v)})),Dd({init:d,getAccount:()=>n(a),initLocalAccount:async()=>{f(a,null),await c(null),l.postMessage({type:"initLocalAccount"})},initCloudAccount:async w=>{const C={encryptedClientKey:w.encryptedClientKey||"",subscriptionExpires:w.subscriptionExpires||-1,lastSync:-1};await c(C),f(a,C,!0),l.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{f(a,null),await c(null),l.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async w=>{if(!n(a))throw new Error("No account to update subscription for");const C={...n(a),subscriptionExpires:w};await c(C),l.postMessage({type:"updateAccount"})},exitApp:async()=>{f(a,void 0),l.postMessage({type:"exit"}),await ja(n(i),ur)}});var y=ye(),E=P(y);We(E,()=>e.children??Je),g(t,y),Se()}const $i={};function Id(t){ht($i,t)}function Ot(){const t=gt($i);if(!t)throw new Error("No NotesContext found");return t}const Jn=()=>crypto.randomUUID(),Ld=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},el=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}};async function op(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{console.error("")}}const ut=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t));function Rd(t,e){Ce(e,!0);const{getDB:a}=is(),{createBroadcastChannel:r,tabId:o}=uo(),s=T(a),i=r(),l=720*60*60*1e3;let u=D(!1),c=D(()=>new Map),d=D(()=>[]),v=D(()=>new Map),h=D(ft(new Map));const p=()=>n(u),m=()=>n(d)().some(x=>x.data&&!x.data.deletedAt&&!x.data.archivedAt),k=()=>n(d)().some(x=>x.data&&x.data.deletedAt),_=()=>n(d)().some(x=>x.data&&x.data.archivedAt&&!x.data.deletedAt),y=(x,L)=>{n(h).has(x)||n(h).set(x,new Set),n(h).get(x)?.add(L)},E=(x,L)=>{n(h).has(x)&&(n(h).get(x)?.delete(L),n(h).get(x)?.size===0&&n(h).delete(x))},w=x=>{if(!x)return!1;const L=n(v)().get(x);if(!L||!L.data?.link?.url)return!1;const F=n(h).get(L.data.link.url),V=[];return F?.forEach(q=>{if(q===x)return;const X=n(v)().get(q);(L.data?.archivedAt||0)==(X?.data?.archivedAt||0)&&(L.data?.deletedAt||0)==(X?.data?.deletedAt||0)&&V.push(q)}),V.length>0},C=x=>{const L=n(d)(),F=n(v)(),V=F.get(x.id);if(V){const q=V.data?.link?.url;V.data=x.data,q!==x.data?.link?.url&&(q&&E(q,x.id),x.data?.link?.url&&y(x.data.link.url,x.id))}else L.push(x),F.set(x.id,x),x.data?.link?.url&&y(x.data.link.url,x.id);f(d,()=>L),f(v,()=>F)},N=x=>{const L=n(d)(),F=n(v)(),V=F.get(x);F.has(x)&&F.delete(x),V&&V.data?.link?.url&&E(V.data.link.url,x),V&&(V.data=void 0),f(d,()=>L),f(v,()=>F)},Y=x=>{const L=n(d)(),F=n(v)();for(const V of x){const q=F.get(V);F.has(V)&&F.delete(V),q&&q.data?.link?.url&&E(q.data.link.url,V),q&&(q.data=void 0)}f(d,()=>L),f(v,()=>F)},z=()=>{f(d,()=>[]),f(h,new Map,!0),f(c,()=>new Map),f(v,()=>new Map)},U=()=>n(d),R=x=>{const L=n(c)();for(const F of x)L.get(F)||L.set(F,{name:F});f(c,()=>L)},G=async()=>{const[x,L]=await Promise.all([Ns(n(s),rt),Ns(n(s),Ut).then(ne=>ne.reduce((K,ie)=>K.set(ie.id,ie.data),new Map))]),F=[],V=[],q=new Map;for(const ne of x)ne.data.deletedAt&&Date.now()-ne.data.deletedAt>l?F.push(ne.id):(V.push(ne),q.set(ne.id,ne),ne.data.link?.url&&y(ne.data.link?.url,ne.id));const X=Ld(V),$=[],J=new Map(L);[...X.values()].forEach(ne=>{J.set(ne,{name:ne,pinned:L.get(ne)?.pinned||!1}),L.has(ne)||$.push(ne)});const le=[];[...L.keys()].forEach(ne=>{X.has(ne)||le.push(ne)}),await ir(n(s),rt,F),await ir(n(s),Ut,le),await yt(n(s),Ut,$.map(ne=>({id:ne,data:{pinned:J.get(ne)?.pinned||!1}}))),f(d,()=>V),f(v,()=>q),f(c,()=>J),f(u,!0)},Q=async x=>{const L=n(c)(),F=x.data.tags.filter(V=>!L.has(V))||[];return await wn(n(s),rt,x.id,{...x.data}),F.length>0&&(await yt(n(s),Ut,F.map(V=>({id:V,data:{pinned:!1}}))||[]),R(F)),C(x),i.postMessage({type:"putNote",data:{id:x.id}}),x.id},se=async({link:x,text:L,tags:F})=>{const V={id:Jn(),data:{link:ut(x),text:L,tags:ut(F),history:[],createdAt:Date.now(),updatedAt:Date.now()}};return await Q(V),V.id},H=async(x,{link:L,text:F,tags:V})=>{const q=I(x);if(!q||!q.data)return;const X={id:x,data:{...q.data,link:ut(L),text:F,tags:ut(V),updatedAt:Date.now()}};await Q(X)},O=async(x,{link:L,text:F,tags:V})=>{const q=I(x);if(!q||!q.data)return;const X=Jn(),$={id:x,data:{...q.data,link:L,text:F,tags:V,updatedAt:Date.now(),history:[...(q.data.history||[]).slice(-49),{id:X,link:ut(q.data.link),text:q.data.text,tags:ut(q.data.tags),updatedAt:q.data.updatedAt}]}};return await Q($),X},we=async(x,L)=>{const F=I(x);if(!F||!F.data)return;const V=F.data.history?.find?.(X=>X.id===L);if(!V)return;const q={id:x,data:{...F.data,link:ut(V.link),text:V.text,tags:ut(V.tags),updatedAt:V.updatedAt,history:F.data.history?.filter?.(X=>X.id!==L)||[]}};await Q(q)},ue=async x=>{const F=n(v)().get(x);!F||!F.data||(N(x),await ko(n(s),rt,x),i.postMessage({type:"deleteNote",data:{id:x}}))},M=async()=>{await ja(n(s),rt),await ja(n(s),Ut),z(),i.postMessage({type:"clearNotes"})},I=x=>n(v)().get(x),Z=async(x,L)=>{const V=n(v)().get(x);if(!V||!V.data)return;const q={id:x,data:{...V.data,pinned:L}};Q(q)},oe=async x=>{const F=n(v)().get(x);if(!F||!F.data)return;const V={id:x,data:{...F.data,deletedAt:Date.now()}};await Q(V)},de=async x=>{const F=n(v)().get(x);if(!F||!F.data)return;const V={id:x,data:{...F.data,archivedAt:Date.now()}};await Q(V)},ce=async({noteIds:x})=>{const L=n(v)(),F=n(d)();for(const q of x){const X=L.get(q);X?.data&&(X.data.deletedAt=Date.now())}return await yt(n(s),rt,x.map(q=>{const X=L.get(q);return{id:q,data:X?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F),{cancel:async()=>{for(const q of x){const X=L.get(q);X?.data&&(X.data.deletedAt=0)}await yt(n(s),rt,x.map(q=>{const X=L.get(q);return{id:q,data:X?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F)}}},Ae=async({noteIds:x})=>{const L=n(v)(),F=n(d)();for(const q of x){const X=L.get(q);X?.data&&(X.data.archivedAt=Date.now())}return await yt(n(s),rt,x.map(q=>{const X=L.get(q);return{id:q,data:X?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F),{cancel:async()=>{for(const q of x){const X=L.get(q);X?.data&&(X.data.archivedAt=0)}await yt(n(s),rt,x.map(q=>{const X=L.get(q);return{id:q,data:X?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F)}}},Fe=async({noteIds:x})=>{const L=n(v)(),F=n(d)(),V=[];for(const X of x){const $=L.get(X);$?.data&&(V.push({id:X,data:ut($.data)}),$.data.archivedAt=0)}return await yt(n(s),rt,x.map(X=>{const $=L.get(X);return{id:X,data:$?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F),{cancel:async()=>{for(const X of V){const $=L.get(X.id);$?.data&&($.data=X.data)}await yt(n(s),rt,x.map(X=>{const $=L.get(X);return{id:X,data:$?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F)}}},he=async({noteIds:x})=>{const L=n(v)(),F=n(d)(),V=[];for(const X of x){const $=L.get(X);$?.data&&(V.push({id:X,data:ut($.data)}),$.data.deletedAt=0)}return await yt(n(s),rt,x.map(X=>{const $=L.get(X);return{id:X,data:$?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F),{cancel:async()=>{for(const X of V){const $=L.get(X.id);$?.data&&($.data=X.data)}await yt(n(s),rt,x.map(X=>{const $=L.get(X);return{id:X,data:$?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(d,()=>F)}}},ve=async x=>{const F=n(v)().get(x);if(!F||!F.data)return;const V={id:x,data:{...F.data,deletedAt:0}};await Q(V)},ze=async x=>{const F=n(v)().get(x);if(!F||!F.data)return;const V={id:x,data:{...F.data,archivedAt:0}};await Q(V)},W=async(x,L)=>{const F=n(c)();F.set(x,{name:x,pinned:L}),await wn(n(s),Ut,x,{pinned:L}),i.postMessage({type:"pinTag",data:{tag:x,pinned:L}}),f(c,()=>F)},te=async({noteIds:x})=>{const L=n(c)(),F=n(d)();Y(x),await ir(n(s),rt,x),i.postMessage({type:"reloadNotes"}),f(d,()=>F),f(c,()=>L)},be=async x=>{const L=n(v)(),F={};x.forEach(V=>{const q=L.get(V.id),X=[];if(q&&q.data){let $=0,J=0;for(;$<V.data.history.length&&J<q.data.history.length;){const le=V.data.history[$],ne=q.data.history[J];le.id===ne.id?(le.updatedAt>ne.updatedAt?X.push(le):X.push(ne),$+=1,J+=1):le.updatedAt<ne.updatedAt?(X.push(le),$+=1):le.updatedAt>ne.updatedAt?(X.push(ne),J+=1):(X.push(ne),$+=1,J+=1)}q.data.updatedAt>V.data.updatedAt?F[q.id]={id:q.id,data:{...q.data,history:X}}:F[V.id]={id:V.id,data:{...V.data,history:X}}}else F[V.id]=V}),await yt(n(s),rt,Object.values(F)),await G(),i.postMessage({type:"reloadNotes"})},Ee=async()=>{const x=[];n(d)().forEach(F=>{F&&F.data&&F.data.deletedAt&&x.push(F.id)}),await ir(n(s),rt,x),await G(),i.postMessage({type:"emptyBin"})},fe=async(x,L)=>{const F=n(v)(),V=n(d)(),q=[],X=[];for(const J of L){const le=F.get(J);le?.data&&(q.push({id:J,data:ut(le.data)}),X.push({id:J,data:{...le.data,tags:le.data.tags.filter(ne=>ne!==x),history:[...le.data.history||[],{id:Jn(),link:ut(le.data.link),text:le.data.text,tags:le.data.tags,updatedAt:Date.now()}]}}))}for(const J of X){const le=F.get(J.id);le?.data&&(le.data=J.data)}return await yt(n(s),rt,X.map(J=>({id:J.id,data:J.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>F),f(d,()=>V),{cancel:async()=>{for(const J of q){const le=F.get(J.id);le?.data&&(le.data=J.data)}await yt(n(s),rt,q.map(J=>({id:J.id,data:J.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>F),f(d,()=>V)}}},re=async(x,L,F)=>{const V=n(v)(),q=n(d)(),X=n(c)(),$=[],J=[];for(const K of F){const ie=V.get(K);ie?.data&&($.push({id:K,data:ut(ie.data)}),J.push({id:K,data:{...ie.data,tags:ie.data.tags.map(ae=>ae!==x?ae:L),history:[...ie.data.history||[],{id:Jn(),link:ut(ie.data.link),text:ie.data.text,tags:ie.data.tags,updatedAt:Date.now()}]}}))}for(const K of J){const ie=V.get(K.id);ie?.data&&(ie.data=K.data)}const le=X.has(L);return await Promise.all([(async()=>{if(!le){const K=X.get(x)?.pinned||!1;X.set(L,{name:L,pinned:K}),await wn(n(s),Ut,L,{pinned:K})}})(),yt(n(s),rt,J.map(K=>({id:K.id,data:K.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>q),f(c,()=>X),{cancel:async()=>{for(const K of $){const ie=V.get(K.id);ie?.data&&(ie.data=K.data)}await Promise.all([(async()=>{le||(X.delete(L),await ko(n(s),Ut,L))})(),yt(n(s),rt,$.map(K=>({id:K.id,data:K.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>q),f(c,()=>X)}}},ke=async(x,L)=>{const F=n(v)(),V=n(d)(),q=n(c)(),X=[],$=[];for(const ne of L){const K=F.get(ne);K?.data&&(X.push({id:ne,data:ut(K.data)}),$.push({id:ne,data:{...K.data,tags:[...new Set([...K.data.tags,x])],history:[...K.data.history||[],{id:Jn(),link:ut(K.data.link),text:K.data.text,tags:K.data.tags,updatedAt:Date.now()}]}}))}for(const ne of $){const K=F.get(ne.id);K?.data&&(K.data=ne.data)}const J=q.has(x);return await Promise.all([(async()=>{J||(q.set(x,{name:x,pinned:!1}),await wn(n(s),Ut,x,{pinned:!1}))})(),yt(n(s),rt,$.map(ne=>({id:ne.id,data:ne.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>F),f(d,()=>V),f(c,()=>q),{cancel:async()=>{for(const ne of X){const K=F.get(ne.id);K?.data&&(K.data=ne.data)}await Promise.all([(async()=>{J||(q.delete(x),await ko(n(s),Ut,x))})(),yt(n(s),rt,X.map(ne=>({id:ne.id,data:ne.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>F),f(d,()=>V),f(c,()=>q)}}},ee=async(x,L,F)=>{const V=n(v)(),q=n(d)(),X=n(c)(),$=[],J=[];for(const ie of F){const ae=V.get(ie);ae?.data&&($.push({id:ie,data:ut(ae.data)}),J.push({id:ie,data:{...ae.data,tags:[...new Set([...ae.data.tags.filter(me=>!x.includes(me)),...L])],history:[...ae.data.history||[],{id:Jn(),link:ut(ae.data.link),text:ae.data.text,tags:ae.data.tags,updatedAt:Date.now()}]}}))}for(const ie of J){const ae=V.get(ie.id);ae?.data&&(ae.data=ie.data)}const le=n(c)(),ne=L.filter(ie=>!le.has(ie));return await Promise.all([(async()=>{if(ne.length>0)return yt(n(s),Ut,ne.map(ie=>({id:ie,data:{pinned:!1}})))})(),yt(n(s),rt,J.map(ie=>({id:ie.id,data:ie.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>q),f(c,()=>X),{cancel:async()=>{for(const ie of $){const ae=V.get(ie.id);ae?.data&&(ae.data=ie.data)}await Promise.all([(async()=>{if(ne.length>0){for(const ie of ne)X.delete(ie);return ir(n(s),Ut,ne)}})(),yt(n(s),rt,$.map(ie=>({id:ie.id,data:ie.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>q),f(c,()=>X)}}},De=async x=>{const L=JSON.parse(x.data),F=L;if(L.tabId&&L.tabId===o){F.type==="exit"&&(z(),await ja(n(s),rt),await ja(n(s),Ut));return}if(F.type==="putNote"){const q=F.data.id;if(!q)return;const X=await Gr(n(s),rt,q);if(!X)return;C({id:q,data:X})}else if(F.type==="deleteNote"){const V=F.data.id;if(!V)return;N(V)}else if(F.type==="pinTag"){const V=F.data.tag,q=F.data.pinned,X=n(c)();X.set(V,{name:V,pinned:q}),f(c,()=>X)}else F.type==="clearNotes"?z():F.type==="reloadNotes"||F.type==="emptyBin"?G():F.type==="exit"&&z()};Ne(()=>(G(),i.addEventListener(De),()=>{i.removeEventListener(De)})),Id({isInitedNotes:p,createNote:se,updateNote:H,deleteNote:ue,saveNote:O,revertNote:we,pinNote:Z,moveNoteToBin:oe,moveNoteToArchive:de,getGetNotes:U,importNotes:be,clearNotes:M,getNoteById:I,getGetMapTags:()=>n(c),pinTag:W,restoreNoteFromBin:ve,moveNoteFromArchive:ze,checkNotes:m,checkNotesInBin:k,checkNotesInArchive:_,emptyBin:Ee,moveNotesToBin:ce,moveNotesToArchive:Ae,moveNotesFromArchive:Fe,deleteNotes:te,restoreNotesFromBin:he,deleteTag:fe,renameTag:re,addTag:ke,changeTags:ee,checkDuplicatesExist:w});var pe=ye(),xe=P(pe);We(xe,()=>e.children??Je),g(t,pe),Se()}const tl={};function Fd(t){ht(tl,t)}function Ma(){const t=gt(tl);if(!t)throw new Error("No FeedContext found");return t}const nl={};var ot=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(ot||{});function zd(t){ht(nl,t)}function fo(){const t=gt(nl);if(!t)throw new Error("No SelectedMetaTagsContext found");return t}function Od(t,e){Ce(e,!0);const a=$a(),{getSelectedTags:r}=qn(),{getSelectedMetaTags:o}=fo(),{getGetNotes:s}=Ot();let i=T(r),l=T(o),u=D(0),c=[],d=D(0),v=T(()=>n(l).has(ot.ARCHIVED)),h=T(()=>n(l).has(ot.BIN));Ue(()=>{const k=s()()||[],_=[],y=Array.from(n(i).values());for(let E=k.length-1;E>=0;E--){if(!k[E]||!k[E].data)continue;const w=k[E];if(!n(v)&&!n(h)&&(w?.data.deletedAt||w?.data.archivedAt)||n(v)&&(w?.data.deletedAt||!w?.data.archivedAt)||n(h)&&!w?.data.deletedAt)continue;const C=a?.getFeedSearch().toLowerCase()||"";if(!(a&&!(w.data.link?.title.toLowerCase().includes(C)||w.data.link?.url.toLowerCase().includes(C)||w.data.text.toLowerCase().includes(C)||w.data.tags.map(N=>N.toLowerCase()).join(" ").includes(C)))){if(n(l).has(ot.INBOX)){if(w.data.tags.length>0)continue}else if(n(i).size&&y.some(N=>!w.data.tags.includes(N)))continue;_.push(w)}}f(u,_.length,!0),c=_,f(d,Date.now(),!0)}),Fd({getFiltredNotesLength:()=>n(u),getFiltredNotes:()=>(n(d),c),getUpdatedFiltredNotesTimestamp:()=>n(d)});var p=ye(),m=P(p);We(m,()=>e.children??Je),g(t,p),Se()}function Bd(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Ht(),s=T(a),i="selectedMetaTags";let l=T(()=>n(s).get(i)||""),u=T(()=>new Set(n(l).split(",").map(_=>decodeURIComponent(_)).filter(_=>_!=="")));zd({getSelectedMetaTags:()=>n(u),addMetaTag:_=>{n(u).has(_)||r(i,[...n(u),_].map(y=>encodeURIComponent(y)).join(","))},removeMetaTag:_=>{n(u).has(_)&&n(u).size===1?o(i):n(u).has(_)&&r(i,[...n(u)].filter(y=>y!==_).map(y=>encodeURIComponent(y)).join(","))},clearSelectedMetaTags:()=>{o(i)},setSelectedMetaTags:_=>{_.size===0?o(i):r(i,[..._].map(y=>encodeURIComponent(y)).join(","))}});var m=ye(),k=P(m);We(k,()=>e.children??Je),g(t,m),Se()}const al={},la=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function jd(t){ht(al,t)}function Kn(){const t=gt(al);if(!t)throw new Error("No AnimationSettingsContext found");return t}function Hd(t,e){Ce(e,!0);let a=ft(la());jd(a);var r=ye(),o=P(r);We(o,()=>e.children??Je),g(t,r),Se()}const rl={};function Ud(t){ht(rl,t)}function cs(){const t=gt(rl);if(!t)throw new Error("No ScrollingContext found");return t}function Wd(t,e){Ce(e,!0);let a=D(!1);const r=()=>n(a),o=el(()=>{f(a,!1)},100);Ud({isScrolling:r,enable:()=>{f(a,!0),o()}});var i=ye(),l=P(i);We(l,()=>e.children??Je),g(t,i),Se()}const ol={};function Vd(t){ht(ol,t)}function ga(){const t=gt(ol);if(!t)throw new Error("No MobileSizeContext found");return t}function qd(t,e){Ce(e,!0);const a=()=>window.matchMedia("(max-width: 767px)").matches;let r=D(ft(a())),o=Kn();const s=el(()=>{o.working=!0},16),i=()=>{o.working=!1,s(),requestAnimationFrame(()=>{f(r,a(),!0)})};Vd({checkMobileSize:()=>n(r)}),Ne(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)));var u=ye(),c=P(u);We(c,()=>e.children??Je),g(t,u),Se()}const sl={};function Kd(t){ht(sl,t)}function Qt(){const t=gt(sl);if(!t)throw new Error("No DialogContext found");return t}function Yd(t,e){Ce(e,!0);let a=D(0),r=D(!1),o=D(!0),s=D(!1),i=D(!1);Kd({checkExistedDialog:()=>n(a)>0,dialogInc:()=>{f(a,n(a)+1)},dialogDec:()=>{f(a,n(a)-1)},blockDialog:N=>{f(r,N,!0)},checkBlockedDialog:()=>n(r),setClosableDialog:N=>{f(o,N,!0)},checkClosableDialog:()=>n(o),checkLeftStart:()=>n(s),checkLeftEnd:()=>n(i),setLeftStart:N=>{f(s,N,!0)},setLeftEnd:N=>{f(i,N,!0)},getCountDialog:()=>n(a)});var w=ye(),C=P(w);We(C,()=>e.children??Je),g(t,w),Se()}const il={};function Gd(t){ht(il,t)}function vo(){const t=gt(il);if(!t)throw new Error("No ScrollContainerContext found");return t}function Xd(t,e){Ce(e,!0);let a=D(null);Gd({setScrollContainer:l=>{f(a,l,!0)},getScrollContainer:()=>n(a)});var s=ye(),i=P(s);We(i,()=>e.children??Je),g(t,s),Se()}const ll={};function Jd(t){ht(ll,t)}function ds(){const t=gt(ll);if(!t)throw new Error("No DialogPageHeightContext found");return t}function Zd(t,e){Ce(e,!0);let a=D(200);Jd({setDialogPageHeight:l=>{f(a,l,!0)},getDialogPageHeight:()=>n(a)});var s=ye(),i=P(s);We(i,()=>e.children??Je),g(t,s),Se()}const Qd=[ur,Xn,rt,Ut,Pd];function $d(){return new Promise((t,e)=>{const a=indexedDB.open(Td,Ed);kt(a,"upgradeneeded",()=>{const r=a.result;for(const o of Qd)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),kt(a,va,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),kt(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),kt(a,Hn,()=>{e(),console.error(Hn,a.error)})})}function eu(t,e){Ce(e,!0);let a=D(null);Ne(()=>{$d().then(l=>{f(a,l,!0)}).catch(l=>{console.error("Failed to initialize LocalDB:",l)})}),Sd({getDB:()=>n(a)});var o=ye(),s=P(o);{var i=l=>{var u=ye(),c=P(u);We(c,()=>e.children??Je),g(l,u)};B(s,l=>{n(a)&&l(i)})}g(t,o),Se()}function tu(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Ht(),s=T(a);let i=T(()=>n(s).get(tn)||""),l=T(()=>n(i).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!==""));const u=()=>n(l),c=w=>{if(w.length===0){o(tn);return}r(tn,w.map(C=>encodeURIComponent(C)).join(","))},d=w=>{r(tn,[...n(l),w].map(C=>encodeURIComponent(C)).join(","))};Nd({setDialogPages:c,getDialogPages:u,pushDialogPage:d,popDialogPage:()=>{const w=n(l)[n(l).length-1];return n(l).length<=1?(o(tn),w):(r(tn,n(l).slice(0,-1).map(C=>encodeURIComponent(C)).join(",")),w)},replaceDialogPage:w=>{r(tn,[...n(l).slice(0,-1),w].map(C=>encodeURIComponent(C)).join(","))},hasDialogPage:w=>n(l).find(C=>{const[N]=C.split("?");return N===w})!==void 0,clearDialogPages:()=>{o(tn)},createDialogPageHref:w=>{const C=new URLSearchParams(n(s).toString());return C.set(tn,[...u(),w].map(N=>encodeURIComponent(N)).join(",")),`${window.location.pathname}?${C.toString()}`},createHandleClickDialogPage:w=>C=>{C.preventDefault(),d(w)}});var y=ye(),E=P(y);We(E,()=>e.children??Je),g(t,y),Se()}function nu(t,e){Ce(e,!0);let a=D(ft(new URLSearchParams(window.location.search)));const r=v=>{const h=window.location.pathname;f(a,v,!0),window.history.replaceState(null,"",`${h}${v.size>0?`?${v.toString()}`:""}`)};ld({getSearchParams:()=>n(a),replaceSearchParams:v=>{const h=new URLSearchParams(v);r(h)},setSearchParam:(v,h)=>{const p=new URLSearchParams(n(a));p.set(v,h),r(p)},deleteSearchParam:v=>{const h=new URLSearchParams(n(a));h.delete(v),r(h)},getHref:(v=n(a))=>{const h=new URLSearchParams(v);return`${window.location.pathname}${h.toString().length>0?`?${h.toString()}`:""}`},clearSearchParams:()=>{r(new URLSearchParams)}});var c=ye(),d=P(c);We(d,()=>e.children??Je),g(t,c),Se()}const cl={};function au(t){ht(cl,t)}function ru(){const t=gt(cl);if(!t)throw new Error("No KeyboardVisibleContext found");return t}function ou(t,e){Ce(e,!0);let a=ft({value:!1});const r=()=>a.value,o=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";Ne(()=>{const l=()=>{setTimeout(()=>{o()?a.value=!0:a.value=!1},0)};return l(),document.addEventListener("focusin",l),document.addEventListener("focusout",l),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",l)}}),au({getIsKeyboardVisible:r});var s=ye(),i=P(s);We(i,()=>e.children??Je),g(t,s),Se()}function su(t,e){Ce(e,!0);const a=crypto.randomUUID(),r=(i,l)=>{i.postMessage(JSON.stringify({...l,tabId:a}))};xd({tabId:a,createBroadcastChannel:()=>{const i=new BroadcastChannel("app");return{postMessage:l=>r(i,l),addEventListener:l=>{i.addEventListener("message",l)},removeEventListener:l=>{i.removeEventListener("message",l)}}}});var o=ye(),s=P(o);We(s,()=>e.children??Je),g(t,o),Se()}function iu(t,e){eu(t,{children:(a,r)=>{su(a,{children:(o,s)=>{Hd(o,{children:(i,l)=>{Wd(i,{children:(u,c)=>{qd(u,{children:(d,v)=>{Yd(d,{children:(h,p)=>{Xd(h,{children:(m,k)=>{Zd(m,{children:(_,y)=>{ou(_,{children:(E,w)=>{nu(E,{children:(C,N)=>{tu(C,{children:(Y,z)=>{var U=ye(),R=P(U);We(R,()=>e.children??Je),g(Y,U)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function lu(t,e){iu(t,{children:(a,r)=>{fd(a,{children:(o,s)=>{cd(o,{children:(i,l)=>{gd(i,{children:(u,c)=>{pd(u,{children:(d,v)=>{Bd(d,{children:(h,p)=>{_d(h,{children:(m,k)=>{Cd(m,{children:(_,y)=>{Ad(_,{children:(E,w)=>{Md(E,{children:(C,N)=>{Rd(C,{children:(Y,z)=>{Od(Y,{children:(U,R)=>{var G=ye(),Q=P(G);We(Q,()=>e.children??Je),g(U,G)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}const cu=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),bt=t=>{const e=cu(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let Mt=D(""),Nn=D(null),Ha=D(null),Dn=D(null),Gn=D(ft([])),zr=D(null),Zn=null;function tt(t,e){f(Mt,""),Zn=null,f(Ha,null),f(Dn,null),setTimeout(()=>{f(Mt,t,!0),e?.onFinish&&f(Ha,e.onFinish,!0),e?.cancel&&(f(Dn,e.cancel.onCancel,!0),Zn=e.cancel.nextFocusRef)},16)}var du=S('<button type="button" class="c p-137gtcu">undo</button>'),uu=S('<div class="a p-137gtcu"><div class="b p-137gtcu"><span> </span> <!></div></div>'),fu=S("<div><!></div>");function go(t,e){Ce(e,!0);let a=Oe(e,"ref",15,null);const r=Jn();Ue(()=>{a(n(Nn))}),Ne(()=>(f(Gn,[...n(Gn),r],!0),()=>{const c=n(Gn).indexOf(r);c!==-1&&f(Gn,n(Gn).filter((d,v)=>v!==c),!0)}));const o=c=>{if(c.key==="Tab"&&c.shiftKey){if(Zn&&n(Mt)){c.preventDefault();const{prev:d}=bt(Zn);d?.focus(),f(Mt,"")}}else if(c.key==="Tab"&&!c.shiftKey)Zn&&n(Mt)&&(c.preventDefault(),f(Mt,""),Zn?.focus());else if(c.key==="Escape"&&n(Mt)){if(c.preventDefault(),Zn){const{prev:d}=bt(Zn);d?.focus()}f(Mt,"")}};Ne(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)})),Ue(()=>{n(Mt);const c=n(Dn)?2e3:800;n(Mt)&&(n(Nn)?.getBoundingClientRect(),n(Nn)?.style.setProperty("opacity","1"));const d=setTimeout(()=>{n(Nn)?.style.removeProperty("opacity")},c),v=setTimeout(()=>{f(Mt,""),n(Ha)&&n(Ha)(),f(Ha,null),f(Dn,null),n(Nn)?.style.removeProperty("opacity")},c+400);return()=>{clearTimeout(d),clearTimeout(v)}});const s=c=>{c.preventDefault(),n(Dn)&&(f(Ha,null),n(Dn)(),f(Dn,null)),f(Mt,""),n(Nn)?.style.removeProperty("opacity")};Ue(()=>{n(Mt)&&n(Dn)&&n(zr)&&setTimeout(()=>{n(zr)?.focus()},151)}),Ue(()=>{n(Gn),Ft(()=>{f(Mt,""),n(Nn)?.style.removeProperty("opacity")})});var i=fu(),l=b(i);{var u=c=>{var d=uu(),v=b(d),h=b(v),p=b(h),m=A(h,2);{var k=_=>{var y=du();y.__click=s,$e(y,E=>f(zr,E),()=>n(zr)),g(_,y)};B(m,_=>{n(Dn)&&_(k)})}$e(v,_=>f(Nn,_),()=>n(Nn)),Ie(()=>vt(p,n(Mt))),g(c,d)};B(l,c=>{n(Mt)&&n(Gn)[n(Gn).length-1]===r&&c(u)})}g(t,i),Se()}pt(["click"]);var vu=S('<span class="a p-lxk90o"><!></span>');function _t(t,e){var a=vu(),r=b(a);We(r,()=>e.children),g(t,a)}var gu=Hc('<svg class="p-1yv1ibq"><use></use></svg>');function _e(t,e){let a=Oe(e,"name",8,"");var r=gu(),o=b(r);Ie(()=>dt(o,"href",`#icon-${a()??""}`)),g(t,r)}var hu=S('<button class="a p-1cnj0y3"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function dl(t,e){Ce(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Ar(),{getDialogPages:s}=zt(),{checkExistedDialog:i}=Qt();let l=T(()=>s().length>0||i());const u=h=>{if(h.preventDefault(),n(l))return;const p=r();p==="closed"?a():p==="opened"&&o()};var c=hu();c.__click=u;var d=b(c);ge(d,()=>({"--size":"28px"})),_e(d.lastChild,{name:"sidebarMenu"});var v=A(d,2);_t(v,{children:(h,p)=>{var m=Ye("Menu");g(h,m)}}),g(t,c),Se()}pt(["click"]);var pu=S('<button class="b p-3z9gmw"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),mu=S('<div class="a p-3z9gmw"><input class="p-3z9gmw"/> <!></div>');function jo(t,e){Ce(e,!0);let a=Oe(e,"value",15,""),r=Oe(e,"ref",15,null);const o=c=>{c.key==="Escape"&&(c.stopPropagation(),r()&&(e.onEscape?.(),r().blur()))};Ne(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=mu(),i=b(s);i.__input=c=>e.onChange?.(c.target?.value||""),$e(i,c=>r(c),()=>r());var l=A(i,2);{var u=c=>{var d=pu();d.__click=()=>{a(""),e.onChange?.("")};var v=b(d);ge(v,()=>({"--size":"20px"})),_e(v.lastChild,{name:"close"});var h=A(v,2);_t(h,{children:(p,m)=>{var k=Ye("Clear");g(p,k)}}),g(c,d)};B(l,c=>{a()&&c(u)})}Ie(()=>dt(i,"placeholder",e.placeholder)),Zt("focus",i,function(...c){e.onFocus?.apply(this,c)}),Zt("blur",i,function(...c){e.onBlur?.apply(this,c)}),Fi(i,a),g(t,s),Se()}pt(["input","click"]);function us(t,e){Ce(e,!0);let a=Oe(e,"notificationRef",11,null);Ne(()=>{const r=o=>{o.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==o.target&&!e.dialogInner.contains(o.target)&&a()!==o.target&&!a()?.contains(o.target)&&e.onClose()};return document.addEventListener("mousedown",r,{capture:!0}),()=>{document.removeEventListener("mousedown",r,{capture:!0})}}),Se()}function _u(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const Tn=_u(),wu=()=>{const t=navigator.userAgent;return/android/i.test(t)},Un=wu(),sp=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},ip=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},yr=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))};let Oa=D(ft([]));var yu=S("<dialog><div><!></div></dialog> <!>",1);function Dr(t,e){Ce(e,!0);const a=Jn(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;Ne(()=>(f(Oa,[...n(Oa),a],!0),()=>{const w=n(Oa).indexOf(a);w!==-1&&f(Oa,n(Oa).filter((C,N)=>N!==w),!0)}));let o=Oe(e,"onClosed",3,()=>{}),s=Oe(e,"blocked",3,!1),i=D(null),l=D(null),u=D(!1),{dialogInc:c,dialogDec:d}=Qt();const v=()=>{const w=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(w),o()()},{once:!0}),f(u,!1)};Ue(()=>{e.startClose&&v()}),Ne(()=>{n(i)?.showModal(),n(i)?.getClientRects(),f(u,!0);const w=C=>{C?.preventDefault(),s()||v()};return n(i)?.addEventListener("cancel",w),n(i)?.addEventListener("close",w),()=>{n(i)?.removeEventListener("cancel",w),n(i)?.removeEventListener("close",w)}}),Ne(()=>(c(),()=>{d()})),Ne(()=>{const w=C=>{C.key==="Escape"&&s()&&C.preventDefault()};return window.addEventListener("keydown",w),()=>{window.removeEventListener("keydown",w)}});function h(){setTimeout(()=>{if(Tn||!n(i)||!n(l))return;const w=window.visualViewport;if(w)if(w.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},0)}Ne(()=>(h(),window.visualViewport?.addEventListener("resize",h),window.visualViewport?.addEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h),()=>{window.visualViewport?.removeEventListener("resize",h),window.visualViewport?.removeEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h)}));var p=yu(),m=P(p),k=b(m),_=b(k);We(_,()=>e.children),$e(k,w=>f(l,w),()=>n(l)),$e(m,w=>f(i,w),()=>n(i));var y=A(m,2);{var E=w=>{us(w,{get dialog(){return n(i)},get dialogInner(){return n(l)},onClose:v})};B(y,w=>{n(i)&&n(l)&&!s()&&w(E)})}Ie(()=>{et(m,1,nt({a:!0,b:n(u),c:n(Oa).length>1}),"p-1x14yml"),et(k,1,nt({d:!0,b:n(u)}),"p-1x14yml")}),g(t,p),Se()}var bu=S("<div><!></div>");function Cu(t,e){Ce(e,!0);let a=D(!1),r=D(null);const o=()=>{const d=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(d),e.onClosed()},{once:!0}),f(a,!1)},s=d=>{d.target!==n(r)&&!n(r)?.contains(d.target)&&o()},i=d=>{d.target!==n(r)&&!n(r)?.contains(d.target)&&o()},l=d=>{d.key==="Escape"&&o()};Ne(()=>{n(r)?.getClientRects(),f(a,!0);const d=setTimeout(()=>{document.addEventListener("focusin",s),document.addEventListener("click",i),document.addEventListener("keydown",l)},0);return()=>{clearTimeout(d),document.removeEventListener("focusin",s),document.removeEventListener("click",i),document.removeEventListener("keydown",l)}}),Ue(()=>{e.startClose&&o()});var u=bu(),c=b(u);We(c,()=>e.children),$e(u,d=>f(r,d),()=>n(r)),Ie(()=>et(u,1,nt({a:!0,b:n(a)}),"p-1unpq18")),g(t,u),Se()}var Su=S("<ul><!></ul>"),ku=S("<ul><!></ul>");function Mr(t,e){Ce(e,!0);let a=Oe(e,"ref",15);var r=ye(),o=P(r);{var s=l=>{Dr(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(u,c)=>{var d=Su(),v=b(d);We(v,()=>e.children),$e(d,h=>a(h),()=>a()),Ie(()=>et(d,1,nt({a:!0,b:e.isMobile}),"p-6pddb9")),g(u,d)},$$slots:{default:!0}})},i=l=>{Cu(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(u,c)=>{var d=ku(),v=b(d);We(v,()=>e.children),$e(d,h=>a(h),()=>a()),Ie(()=>et(d,1,nt({a:!0,b:e.isMobile}),"p-6pddb9")),g(u,d)},$$slots:{default:!0}})};B(o,l=>{e.isMobile?l(s):l(i,!1)})}g(t,r),Se()}var xu=S("<button><!></button>"),Tu=S("<a><!></a>");function Ve(t,e){let a=Oe(e,"dangerous",3,!1),r=Oe(e,"type",3,"button"),o=Oe(e,"href",3,"");var s=ye(),i=P(s);{var l=c=>{var d=xu();d.__click=function(...h){e.onClick?.apply(this,h)},d.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=b(d);We(v,()=>e.children??Je),Ie(()=>et(d,1,nt({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")),g(c,d)},u=c=>{var d=Tu();d.__click=function(...h){e.onClick?.apply(this,h)},d.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=b(d);We(v,()=>e.children??Je),Ie(()=>{dt(d,"href",o()),et(d,1,nt({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")}),g(c,d)};B(i,c=>{r()==="button"?c(l):c(u,!1)})}g(t,s)}pt(["click","keydown"]);var Eu=S('<li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li>',1),Pu=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Nu=S('<div class="a p-108u1na"><button><!> <!></button> <!></div>');function Au(t,e){Ce(e,!0);let a=D(!1),r=D(!1);const{getFeedOrder:o,setFeedOrder:s}=Hi();let i=Tn||Un,l=T(o);const u=()=>{n(a)||f(a,!0)},c=y=>{f(r,!0),s(y)},d=()=>{f(a,!1),f(r,!1)};Ne(()=>{const y=E=>{E.key==="Escape"&&f(r,!0)};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)});var v=Nu(),h=b(v);h.__click=u,et(h,1,nt({b:!0,c:!0}),"p-108u1na");var p=b(h);_e(p,{name:"filter"});var m=A(p,2);_t(m,{children:(y,E)=>{var w=Ye("show feed order menu");g(y,w)}});var k=A(h,2);{var _=y=>{var E=Pu(),w=P(E);ge(w,()=>({"--right":"0px","--top":"44px"})),Mr(w.lastChild,{get startClose(){return n(r)},onClosed:d,get isMobile(){return i},children:(C,N)=>{var Y=Eu(),z=P(Y),U=b(z);{let M=T(()=>n(l)==="newest");Ve(U,{get active(){return n(M)},get dialogMode(){return i},onClick:()=>c("newest"),children:(I,Z)=>{var oe=Ye("Newest");g(I,oe)},$$slots:{default:!0}})}var R=A(z,2),G=b(R);{let M=T(()=>n(l)==="oldest");Ve(G,{get active(){return n(M)},get dialogMode(){return i},onClick:()=>c("oldest"),children:(I,Z)=>{var oe=Ye("Oldest");g(I,oe)},$$slots:{default:!0}})}var Q=A(R,2),se=b(Q);{let M=T(()=>n(l)==="AtoZ");Ve(se,{get active(){return n(M)},get dialogMode(){return i},onClick:()=>c("AtoZ"),children:(I,Z)=>{var oe=Ye("A to Z");g(I,oe)},$$slots:{default:!0}})}var H=A(Q,2),O=b(H);{let M=T(()=>n(l)==="ZtoA");Ve(O,{get active(){return n(M)},get dialogMode(){return i},onClick:()=>c("ZtoA"),children:(I,Z)=>{var oe=Ye("Z to A");g(I,oe)},$$slots:{default:!0}})}var we=A(H,2),ue=b(we);{let M=T(()=>n(l)==="updatedNewest");Ve(ue,{get active(){return n(M)},get dialogMode(){return i},onClick:()=>c("updatedNewest"),children:(I,Z)=>{var oe=Ye("Updated");g(I,oe)},$$slots:{default:!0}})}g(C,Y)},$$slots:{default:!0}}),g(y,E)};B(k,y=>{n(a)&&y(_)})}g(t,v),Se()}pt(["click"]);var Du=S('<div><!> <div class="a p-y3zt6o"></div></div>');function Ia(t,e){Ce(e,!0);let a=D(!1);Ne(()=>{const s=setTimeout(()=>{f(a,!0)},200);return()=>{clearTimeout(s)}});var r=Du(),o=b(r);We(o,()=>e.children??Je),Ie(()=>et(r,1,nt({b:!0,c:n(a)}),"p-y3zt6o")),g(t,r),Se()}var Mu=S("<a><!></a>"),Iu=S("<button><!></button>");function Lt(t,e){let a=Oe(e,"type",3,"standard"),r=Oe(e,"typeButton",3,"button"),o=Oe(e,"element",3,"button"),s=Oe(e,"href",3,""),i=Oe(e,"fullWidth",3,!1),l=Oe(e,"withoutMinWidth",3,!1);var u=ye(),c=P(u);{var d=h=>{var p=Mu();p.__click=function(...k){e.onClick?.apply(this,k)};var m=b(p);We(m,()=>e.children??Je),Ie(()=>{dt(p,"target",e.target),dt(p,"rel",e.rel),dt(p,"href",s()),et(p,1,nt({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,p)},v=h=>{var p=Iu();p.__click=function(...k){e.onClick?.apply(this,k)};var m=b(p);We(m,()=>e.children??Je),Ie(()=>{dt(p,"type",r()),et(p,1,nt({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,p)};B(c,h=>{o()==="a"?h(d):h(v,!1)})}g(t,u)}pt(["click"]);let Ho=D(!1),Or=D(!1),Uo=D(""),Wo=D("Cancel"),Vo=D("Confirm"),qo,Wr=D(void 0),Ko,Yo=D("dangerous");function Wa(t){f(Ho,!0),f(Uo,t.title,!0),t.buttonCancelTitle&&f(Wo,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&f(Vo,t.buttonConfirmTitle,!0),qo=t.onConfirm,f(Wr,t.onCancel,!0),Ko=t.onClosed,t.type?f(Yo,t.type,!0):f(Yo,"dangerous")}var Lu=S('<span class="b p-1jg69ok"> </span> <div class="c p-1jg69ok"><!> <!></div>',1),Ru=S('<div class="a p-1jg69ok"><!></div>');function Fu(t,e){Ce(e,!0);let a=D(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{f(a,!0)},250)};Ne(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(Wr)?.(),f(Or,!0)},l=async()=>{s(),await qo?.(),f(Or,!0),o=!0},u=()=>{clearTimeout(r),f(a,!1),f(Ho,!1),f(Or,!1),f(Uo,""),f(Wo,"Cancel"),f(Vo,"Confirm"),f(Wr,void 0),qo=void 0,Ko&&Ko(o),o=!1};var c=ye(),d=P(c);{var v=h=>{Dr(h,{get blocked(){return n(a)},get startClose(){return n(Or)},onClosed:u,children:(p,m)=>{var k=Ru(),_=b(k);{var y=w=>{Ia(w,{})},E=w=>{var C=Lu(),N=P(C),Y=b(N),z=A(N,2),U=b(z);{var R=Q=>{Lt(Q,{size:"small",onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(se,H)=>{var O=Ye();Ie(()=>vt(O,n(Wo))),g(se,O)},$$slots:{default:!0}})};B(U,Q=>{n(Wr)&&Q(R)})}var G=A(U,2);Lt(G,{size:"small",onClick:l,fullWidth:!0,withoutMinWidth:!0,get type(){return n(Yo)},children:(Q,se)=>{var H=Ye();Ie(()=>vt(H,n(Vo))),g(Q,H)},$$slots:{default:!0}}),Ie(()=>vt(Y,n(Uo))),g(w,C)};B(_,w=>{n(a)?w(y):w(E,!1)})}g(p,k)},$$slots:{default:!0}})};B(d,h=>{n(Ho)&&h(v)})}g(t,c),Se()}const br=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,l=a.ctrlKey,u=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!l&&!!t.shift==!!u){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var zu=S('<div class="a p-6qmscy"><a class="b p-6qmscy"><span class="c p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function Ou(t,e){Ce(e,!1);const{createDialogPageHref:a,createHandleClickDialogPage:r,getDialogPages:o,pushDialogPage:s}=zt(),{checkExistedDialog:i}=Qt(),l=()=>{o.length===0&&!i()&&s(Pe.NewNote)};Ne(()=>br({key:"n",action:l})),ss();var u=zu(),c=b(u),d=T(()=>r(Pe.NewNote));c.__click=function(..._){n(d)?.apply(this,_)};var v=b(c),h=b(v);ge(h,()=>({"--size":"28px","--color":"#b0b0b0"})),_e(h.lastChild,{name:"add"});var p=A(h,2);_t(p,{children:(_,y)=>{var E=Ye("Add note");g(_,E)}});var m=A(v,2),k=b(m);ge(k,()=>({"--size":"16px","--color":"#b0b0b0"})),_e(k.lastChild,{name:"plus"}),Ie(_=>dt(c,"href",_),[()=>a(Pe.NewNote)]),g(t,u),Se()}pt(["click"]);var Bu=S("<button><!></button>");function ha(t,e){Ce(e,!0);let a=Oe(e,"type",3,"button"),r=!1,o=D(null);Ue(()=>{e.onRef&&e.onRef(n(o))});const s=d=>{(d.key==="Enter"||d.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},l=d=>{(d.pointerType==="mouse"&&d.button===0||d.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(d)};var u=Bu();u.__keydown=s,u.__click=i,u.__pointerdown=l,u.__touchstart=function(...d){e.onTouchStart?.apply(this,d)};var c=b(u);We(c,()=>e.children??Je),$e(u,d=>f(o,d),()=>n(o)),Ie(()=>{dt(u,"type",a()),u.disabled=e.disabled,et(u,1,nt({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty"}),"p-19nhjik")}),g(t,u),Se()}pt(["keydown","click","pointerdown","touchstart"]);var ju=S('<div class="b p-1pt17hy"> </div>'),Hu=S('<div class="a p-1pt17hy"><input/> <!></div>');function Cr(t,e){Ce(e,!0);let a=Oe(e,"value",15,""),r=Oe(e,"error",3,""),o=Oe(e,"ref",15,null);var s=Hu(),i=b(s);i.__input=function(...d){e.onInput?.apply(this,d)};let l;$e(i,d=>o(d),()=>o());var u=A(i,2);{var c=d=>{var v=ju(),h=b(v);Ie(()=>vt(h,r())),g(d,v)};B(u,d=>{r()&&d(c)})}Ie(()=>{dt(i,"placeholder",e.placeholder),l=et(i,1,"p-1pt17hy",null,l,{error:!!r()})}),Zt("blur",i,function(...d){e.onBlur?.apply(this,d)}),Zt("focus",i,function(...d){e.onFocus?.apply(this,d)}),Fi(i,a),g(t,s),Se()}pt(["input"]);var Uu=S('<div class="b p-z67y1l"> </div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Wu=S('<form class="a p-z67y1l"><!></form>');function Vu(t,e){Ce(e,!0);const{renameTag:a}=Ot(),{getSelectedTags:r,setSelectedTags:o}=qn(),{getSelectedNotes:s,setSelectedNotes:i,clearNotes:l}=fa(),{getFiltredNotes:u}=Ma();let c=D(!1),d=D(!1),v,h=!1,p=D(null),m=D(ft(e.tag)),k=e.nextFocusRef;Ne(()=>(n(p)&&n(p).focus(),()=>{v&&clearTimeout(v)}));const _=()=>{v=setTimeout(()=>{f(d,!0)},250)},y=()=>{f(c,!0)},E=async()=>{if(n(m).trim()===e.tag){y();return}if(n(m).trim()!=="")try{_();const N=r(),Y=[...N].map(Q=>Q===e.tag?n(m).trim():Q),z=new Set(s()),U=u(),R=z.size?[...z]:U.map(Q=>Q.id),{cancel:G}=await a(e.tag,n(m).trim(),R);l(),o(new Set(Y)),tt("Tag renamed",{cancel:{nextFocusRef:k,onCancel:async()=>{await G(),o(N),i(z),setTimeout(()=>{const{prev:Q}=bt(k);Q?.focus()},16)}}}),h=!0}finally{f(c,!0)}},w=()=>{e.onClosed?.(h)},C=N=>{N.preventDefault(),E()};Dr(t,{get blocked(){return n(d)},get startClose(){return n(c)},onClosed:w,children:(N,Y)=>{var z=Wu(),U=b(z);{var R=Q=>{Ia(Q,{})},G=Q=>{var se=Uu(),H=P(se),O=b(H),we=A(H,2);Cr(we,{placeholder:"Enter new tag name",get ref(){return n(p)},set ref(Z){f(p,Z,!0)},get value(){return n(m)},set value(Z){f(m,Z,!0)}});var ue=A(we,2),M=b(ue);Lt(M,{size:"small",onClick:y,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Z,oe)=>{var de=Ye("Cancel");g(Z,de)},$$slots:{default:!0}});var I=A(M,2);Lt(I,{size:"small",onClick:E,fullWidth:!0,withoutMinWidth:!0,children:(Z,oe)=>{var de=Ye("OK");g(Z,de)},$$slots:{default:!0}}),Ie(()=>vt(O,`Rename "${e.tag??""}" for selected notes`)),g(Q,se)};B(U,Q=>{n(d)?Q(R):Q(G,!1)})}Zt("submit",z,C),g(N,z)},$$slots:{default:!0}}),Se()}let na=D(!1),pa=D(!1),Gt=D(""),ma=D(0),fr=D(0),vr=D(0),Vr,Xr=()=>({bottom:0,right:0,height:0}),$t=D(null),Go=D(null);function qu(t){if(n(na)){f(pa,!0),n(Gt)!==t.tag&&(Vr=()=>{const a=t.getRect();f(na,!0),f(Gt,t.tag,!0),f(ma,a.bottom,!0),f(fr,a.right,!0),f(vr,a.height,!0),Xr=t.getRect,f($t,t.focusRef,!0)});return}const e=t.getRect();f(na,!0),f(Gt,t.tag,!0),f(ma,e.bottom,!0),f(fr,e.right,!0),f(vr,e.height,!0),Xr=t.getRect,f($t,t.focusRef,!0)}const Ku=()=>n(na),Yu=()=>n(Go);var Gu=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),Xu=S('<li class="p-16hbyw2"><!></li>'),Ju=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),Zu=S('<li class="p-16hbyw2"><!></li>'),Qu=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),$u=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),ef=S('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),tf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),nf=S("<!> <!>",1);function af(t,e){Ce(e,!0);const{getScrollContainer:a}=vo(),{pinTag:r,getGetMapTags:o,deleteTag:s}=Ot(),{checkMobileSize:i}=ga(),{getSelectedTags:l,removeTag:u,setSelectedTags:c}=qn(),{getSelectedNotes:d,setSelectedNotes:v,clearNotes:h}=fa(),{getFiltredNotes:p}=Ma();let m=D(!1);Ue(()=>{n(na),Ft(()=>{f(m,o()().get(n(Gt))?.pinned||!1,!0)})});let k=D(!1);const _=()=>{r(n(Gt),!0),f(pa,!0);let M=n($t),I=bt(M)?.next;tt("Tag pinned",{cancel:{nextFocusRef:I,onCancel:async()=>{r(n(Gt),!1),setTimeout(()=>{const{prev:Z}=bt(I);Z?.focus()},16)}}})},y=()=>{r(n(Gt),!1),f(pa,!0);let M=n($t),I=bt(M)?.next;tt("Tag unpinned",{cancel:{nextFocusRef:I,onCancel:async()=>{r(n(Gt),!0),setTimeout(()=>{const{prev:Z}=bt(I);Z?.focus()},16)}}})},E=()=>{f(na,!1),f(pa,!1),f(ma,0),f(fr,0),f(vr,0),Xr=()=>({bottom:0,right:0,height:0}),f($t,null),Vr&&setTimeout(()=>{Vr?.(),Vr=void 0})};let w=T(()=>window.innerHeight-n(ma)<100?n(ma)-n(vr)-98+"px":n(ma)+5+"px"),C=T(a);const N=M=>{M.key==="Tab"&&M.shiftKey&&(M.preventDefault(),n($t)?.focus())},Y=M=>{M.key==="Tab"&&!M.shiftKey&&n($t)&&(M.preventDefault(),bt(n($t))?.next?.focus())};Ne(()=>{const M=I=>{I.key==="Escape"&&n(na)&&n($t)?.focus()};return window.addEventListener("keydown",M),()=>{window.removeEventListener("keydown",M)}});const z=()=>{f(pa,!0);let M=n($t),I=bt(M)?.next;Wa({title:`Are you sure to delete "${n(Gt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const Z=Array.from(n(G)),oe=new Set(d()),de=p(),ce=oe.size?[...oe]:de.map(Fe=>Fe.id);n(G).has(n(Gt))&&(oe.size===0||de.length===oe.size)&&u(n(Gt)),h();const{cancel:Ae}=await s(n(Gt),ce);tt("Tag deleted",{cancel:{nextFocusRef:I,onCancel:async()=>{await Ae(),c(new Set(Z)),v(new Set(oe)),setTimeout(()=>{const{prev:Fe}=bt(I);Fe?.focus()},16)}}})},onCancel:async()=>{},onClosed:Z=>{setTimeout(()=>{Z||M?.focus()},16)}})};let U=()=>{};const R=()=>{f(pa,!0),f(k,!0);let M=n($t);U=()=>{f(k,!1),setTimeout(()=>{M?.focus()},16)}};Ue(()=>{const M=()=>{const I=Xr();f(ma,I.bottom,!0),f(fr,I.right,!0),f(vr,I.height,!0)};return n(C)?.addEventListener("scroll",M),window.addEventListener("resize",M),()=>{n(C)?.removeEventListener("scroll",M),window.removeEventListener("resize",M)}});let G=T(l),Q=T(i);var se=nf(),H=P(se);{var O=M=>{var I=tf(),Z=P(I);ge(Z,()=>({"--left":n(fr)-36+"px","--top":n(w),"--transform-origin":"top left"})),Mr(Z.lastChild,{get startClose(){return n(pa)},onClosed:E,get isMobile(){return n(Q)},get ref(){return n(Go)},set ref(oe){f(Go,oe,!0)},children:(oe,de)=>{var ce=ef(),Ae=P(ce);{var Fe=be=>{var Ee=Xu(),fe=b(Ee);Ve(fe,{onClick:_,onKeydown:N,get dialogMode(){return n(Q)},children:(re,ke)=>{var ee=Gu(),De=P(ee);ge(De,()=>({"--size":"20px"})),_e(De.lastChild,{name:"pin"}),g(re,ee)},$$slots:{default:!0}}),g(be,Ee)},he=be=>{var Ee=Zu(),fe=b(Ee);Ve(fe,{onClick:y,onKeydown:N,get dialogMode(){return n(Q)},children:(re,ke)=>{var ee=Ju(),De=P(ee);ge(De,()=>({"--size":"20px"})),_e(De.lastChild,{name:"pin-cancel"}),g(re,ee)},$$slots:{default:!0}}),g(be,Ee)};B(Ae,be=>{n(m)?be(he,!1):be(Fe)})}var ve=A(Ae,2),ze=b(ve);Ve(ze,{onClick:R,get dialogMode(){return n(Q)},children:(be,Ee)=>{var fe=Qu(),re=P(fe);ge(re,()=>({"--size":"20px","--scale":"0.9"})),_e(re.lastChild,{name:"pen"}),g(be,fe)},$$slots:{default:!0}});var W=A(ve,2),te=b(W);Ve(te,{onClick:z,onKeydown:Y,get dialogMode(){return n(Q)},children:(be,Ee)=>{var fe=$u(),re=P(fe);ge(re,()=>({"--size":"20px"})),_e(re.lastChild,{name:"bin"}),g(be,fe)},$$slots:{default:!0}}),g(oe,ce)},$$slots:{default:!0}}),g(M,I)};B(H,M=>{n(na)&&M(O)})}var we=A(H,2);{var ue=M=>{{let I=T(()=>bt(n($t))?.next||null);Vu(M,{get tag(){return n(Gt)},get nextFocusRef(){return n(I)},onClosed:Z=>{U(Z)}})}};B(we,M=>{n(k)&&M(ue)})}g(t,se),Se()}var rf=S('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),of=S('<button><span class="b p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),sf=S("<!> <span> </span> <!>",1),lf=S('<div class="a p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function gr(t,e){Ce(e,!0);let{getGetMapTags:a}=Ot(),r=D(null),o=T(Ku);const s=()=>{if(n(r)){const v=n(r).getBoundingClientRect();return{bottom:v.bottom,right:v.right,height:v.height}}return{bottom:0,right:0,height:0}},i=v=>{v.stopPropagation(),v.preventDefault(),qu({tag:e.tag,getRect:s,focusRef:n(r)})},l=v=>{v.key==="Tab"&&!v.shiftKey&&n(o)&&(v.preventDefault(),Yu()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let u=T(()=>a()().get(e.tag)?.pinned||!1);var c=lf(),d=b(c);ge(d,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),ha(d.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(v,h)=>{var p=sf(),m=P(p);{var k=C=>{var N=rf(),Y=b(N);ge(Y,()=>({"--size":"18px"})),_e(Y.lastChild,{name:"pin"}),g(C,N)};B(m,C=>{n(u)&&C(k)})}var _=A(m,2),y=b(_),E=A(_,2);{var w=C=>{var N=of();N.__click=i,N.__keydown=l;var Y=b(N),z=b(Y);ge(z,()=>({"--size":"16px"})),_e(z.lastChild,{name:"menu"});var U=A(z,2);_t(U,{children:(R,G)=>{var Q=Ye("Tag options");g(R,Q)}}),$e(N,R=>f(r,R),()=>n(r)),Ie(()=>et(N,1,nt({c:!0,d:e.type==="selected"}),"p-9jjlcl")),g(C,N)};B(E,C=>{e.hideMenu||C(w)})}Ie(()=>vt(y,e.tag)),g(v,p)},$$slots:{default:!0}}),g(t,c),Se()}pt(["click","keydown"]);var cf=S('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function Ms(t,e){Ce(e,!0);let a=Oe(e,"mobile",3,!1);const{getGetMapTags:r}=Ot();let s=T(()=>{const p=r()();return[...e.tags].sort((m,k)=>p.get(m)?.pinned?-1:p.get(k)?.pinned?1:m.localeCompare(k))}),i=T(()=>n(s).filter(p=>r()().get(p)?.pinned)),l=T(()=>n(s).filter(p=>!r()().get(p)?.pinned));var u=cf(),c=b(u),d=b(c);Bn(d,16,()=>n(i),p=>p,(p,m)=>{gr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return m},onClick:()=>{e.handleTagClick(m)}})});var v=A(d,2);Bn(v,17,()=>e.metaTags,p=>"meta"+p,(p,m)=>{gr(p,{hideMenu:!0,get tag(){return n(m)},onClick:()=>{e.handleMetaTagClick(n(m))}})});var h=A(v,2);Bn(h,16,()=>n(l),p=>p,(p,m)=>{gr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return m},onClick:()=>{e.handleTagClick(m)}})}),Ie(()=>et(c,1,nt({b:!0,c:a()}),"p-lawyrs")),g(t,u),Se()}var df=S('<div class="b c p-32813r"><div class="d p-32813r"><button class="e p-32813r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),uf=S('<div class="a p-32813r"><!></div>');function Is(t,e){Ce(e,!0);let a=D(null);const r=u=>{f(a,u,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};Ue(()=>{n(a)&&n(a).focus()});var s=uf(),i=b(s);{var l=u=>{var c=df(),d=b(c),v=b(d);v.__click=o;var h=b(v);ge(h,()=>({"--size":"20px"})),_e(h.lastChild,{name:"close"});var p=A(h,2);_t(p,{children:(_,y)=>{var E=Ye("Clear");g(_,E)}});var m=A(d,2);Bn(m,19,()=>e.metaTags,_=>"meta_"+_,(_,y,E)=>{{let w=T(()=>n(E)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);gr(_,{hideMenu:!0,type:"selected",get tag(){return n(y)},onClick:()=>{e.handleMetaTagClick(n(y))},get onRef(){return n(w)}})}});var k=A(m,2);Bn(k,18,()=>e.selectedTags,_=>_,(_,y,E)=>{{let w=T(()=>n(E)===e.selectedTags.size-1?r:void 0);gr(_,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return y},onClick:()=>{e.handleSelectedTagClick(y)},get onRef(){return n(w)}})}}),g(u,c)};B(i,u=>{e.selectedTags.size+e.metaTags.size>0&&u(l)})}g(t,s),Se()}pt(["click"]);const Xo=(t,e,a,r)=>{if(t.has(ot.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const l of i?.data?.tags||[])o.includes(l)||o.push(l);continue}if(i.data&&s.every(l=>i.data?.tags.includes(l)))for(const l of i.data.tags||[])!e.has(l)&&!o.includes(l)&&o.push(l)}return o},jn=200,ff=t=>t<.5?2*t*t:-1+(4-2*t)*t,ul=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,ff(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},vf=t=>{const{getIsKeyboardVisible:a}=ru();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},l=v=>({x:v.clientX,y:v.clientY,time:performance.now()}),u=v=>{r=[l(v.touches[0])],o=!0},c=v=>{if(!o||s)return;r.push(l(v.touches[0]));const h=performance.now()-150;r=r.filter(z=>z.time>=h);const p=r.at(-1),m=r[0];if(!p||!m)return;const k=m.x,_=m.y,y=p.x,E=p.y,w=y-k,C=E-_,N=Math.abs(w)>Math.abs(C),Y=Math.abs(w)>3;N&&Y&&!a()&&(s=!0,v.preventDefault(),t([...r]),i())},d=()=>{i()};Ne(()=>(document.addEventListener("touchstart",u,{passive:!0}),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",d,{passive:!0}),document.addEventListener("touchcancel",d,{passive:!0}),()=>{document.removeEventListener("touchstart",u),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d),document.removeEventListener("touchcancel",d)}))},Ls=5,Rs=.6,ca=.3;function fl(t,e){Ce(e,!0);let a=[],r=0,o=!1,s=0,i=0,l=0,u=0,c=0,d=null,v=null;const h=()=>{a=[],r=0,o=!1,s=0,i=0,l=0,u=0,c=0,d!==null&&(cancelAnimationFrame(d),d=null),v&&(clearTimeout(v),v=null)},p=()=>{e.onCancel(),h()},m=()=>{v&&clearTimeout(v),v=setTimeout(p,5e3)};vf(async Y=>{if(!o)try{const z=Y.at(-1);if(!z)throw new Error("No points available for swipe initialization");const U=await e.onInit();if(!U)return;s=U.initialPosition,i=U.currentPosition,l=U.minPosition,u=U.maxPosition,c=U.width,r=z.x,a=Y,o=!0,m()}catch(z){console.error("Error during swipe initialization:",z),h()}});const _=Y=>Math.max(l,Math.min(u,Y)),y=()=>{if(d=null,!o){h();return}const Y=a.at(-1),z=a[0];if(!Y||!z)return;let U=Y.x-r;r=Y.x;const R=_(i+U);R!==i&&(i=R,e.onUpdate({initialPosition:s,newPosition:R,width:c,minPosition:l,maxPosition:u}))},E=Y=>{if(!o){h();return}a.push({x:Y.touches[0].clientX,y:Y.touches[0].clientY,time:performance.now()});const z=performance.now()-150;a=a.filter(Q=>Q.time>=z),d===null&&(d=requestAnimationFrame(y)),m();const U=Y.touches[0].clientX-a[0].x,R=Y.touches[0].clientY-a[0].y;Math.abs(U)>Math.abs(R)&&Y.cancelable&&Y.preventDefault()},w=Y=>{const z=Math.abs(Y);if(z>=Rs)return Ls;if(z>=ca){const U=(z-ca)/(Rs-ca);return e.baseActionThreshold-U*(e.baseActionThreshold-Ls)}else return e.baseActionThreshold},C=Y=>{if(!o){h();return}let z=0;a.push({x:Y.changedTouches[0].clientX,y:Y.changedTouches[0].clientY,time:performance.now()}),y(),d!==null&&(cancelAnimationFrame(d),d=null);const U=a[0],R=a[a.length-1],G=R.x-U.x,Q=R.time-U.time;Q>0&&(z=G/Q);const se=w(z);e.onFinish({swipeVelocity:z,currentPosition:i,minPosition:l,maxPosition:u,initialPosition:s,width:c,actionThreshold:se}),h()},N=()=>{p()};Ne(()=>(document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("touchend",C,{passive:!0}),document.addEventListener("touchcancel",N,{passive:!0}),()=>{document.removeEventListener("touchmove",E),document.removeEventListener("touchend",C),document.removeEventListener("touchcancel",N),d!==null&&cancelAnimationFrame(d),v&&clearTimeout(v)})),Se()}function gf(t,e){Ce(e,!0);const a=Kn();let r=Oe(e,"animationRef",7),o=Oe(e,"dialog",7);fl(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const c=-e.dialogWidth*.7,d=0;let v=e.sidebarState==="closed"?c:d,h=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let k=()=>1;if(r().current){r().current.pause();let _=Number(r().current.currentTime);yr()&&(_=Number(_)+50,r().current.currentTime=Math.min(Math.max(jn-1,_),_));const y=r().current.effect?.getComputedTiming().progress||0;k=()=>y,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(_=>requestAnimationFrame(_)),h=Math.abs(1-k())}h=e.sidebarState==="closed"?h:1-h,o().style.setProperty("--backdrop-bg",`${h*.1}`),o()&&!o().open&&(o().showModal(),yr()&&o().getBoundingClientRect()),a.isSwiping=!0,a.duration=0,a.swipingRatio=h*-25;const p=h*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let m=e.sidebarState==="closed"?c:d;return e.sidebarState==="opened"||e.sidebarState==="closed"||(m=p),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:v,currentPosition:m,minPosition:c,maxPosition:d,width:e.dialogWidth}},onCancel:()=>{a.isSwiping=!1,e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:c,width:d})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const v=1-Math.abs(c/d)/7*10;o().style.transform=`translate3d(${c}px, 0, 0)`,a.swipingRatio=v*-25,o().style.setProperty("--backdrop-bg",`${v*.1}`)},onFinish:({swipeVelocity:c,currentPosition:d,initialPosition:v,width:h,actionThreshold:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let m="close";const k=Math.abs(d-v)/h*100/7*10;if(k===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(k===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?m=Math.abs(k)>p||c>ca?"open":"close":e.sidebarState==="swipingClose"&&(m=Math.abs(k)>p&&c<=ca||c<-ca?"close":"open");let _=ul(Math.abs(k)/100);e.sidebarState==="swipingClose"&&m==="close"&&(_=1-_);const y=(m==="open"?1-_:_)*jn;a.duration=y/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),o().style.setProperty("--backdrop-bg",`${m==="open"?.1:0}`),m==="open"?e.onOpen():m==="close"&&e.onClose()}}),Se()}var hf=S("<dialog><div><!> <!></div></dialog> <!> <!>",1);function pf(t,e){Ce(e,!0);const{getSidebarState:a,setSidebarState:r}=Ar();let o=D(0);Ne(()=>{const O=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",O),O(),()=>{window.removeEventListener("resize",O)}});const s=Kn(),{isScrolling:i}=cs();let l=D(null),u=D(null),c={},d=T(a);const v=()=>{e.blocked||r("closing")},h=O=>{r(O==="open"?"swipingOpen":"swipingClose")},p=()=>{r("opened")},m=()=>{r("preOpening")},k=()=>{n(l)?.close(),r("closed")},_=O=>{O.preventDefault(),v()};Ne(()=>(n(l)?.addEventListener("close",k),n(l)?.addEventListener("cancel",_),()=>{n(l)?.removeEventListener("close",k),n(l)?.removeEventListener("cancel",_)}));const y=T(i);let E=T(()=>s.working);const w=O=>{O?(r("opened"),s.swipingRatio=-25):(r("closed"),s.swipingRatio=0,n(l)?.close()),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=la().duration};Ue(()=>{n(d)==="opening"?Ft(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=-25,n(l).style.removeProperty("--backdrop-bg");const O=n(l).style.transform||"translate3d(-100%, 0, 0)";n(l).style.transform="";const we=n(l)?.animate([{transform:O},{transform:"translate3d(0, 0, 0)"}],{duration:s.duration*1e3||jn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});c.current=we,we&&(we.onfinish=()=>{p(),s.swipingRatio=-25,n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=la().duration,we.cancel(),c.current=void 0})})}):n(d)==="closing"&&Ft(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=0,n(l).style.removeProperty("--backdrop-bg");const O=n(l).style.transform||"translate3d(0, 0, 0)";n(l).style.transform="";const we=n(l)?.animate([{transform:O},{transform:"translate3d(-100%, 0, 0)"}],{duration:s.duration*1e3||jn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});c.current=we,we&&(we.onfinish=()=>{k(),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=la().duration,we.cancel(),c.current=void 0})})})}),Ue(()=>{n(d)==="preOpening"&&(n(l)?.open||(n(l)?.showModal(),yr()&&n(l)?.getBoundingClientRect()),r("opening"))}),Ne(()=>{n(d)==="opened"&&r("preOpening")});var C=hf(),N=P(C),Y=b(N),z=b(Y);We(z,()=>e.children);var U=A(z,2);{var R=O=>{go(O,{})};B(U,O=>{n(d)==="opened"&&O(R)})}$e(Y,O=>f(u,O),()=>n(u)),$e(N,O=>f(l,O),()=>n(l));var G=A(N,2);{var Q=O=>{us(O,{get dialog(){return n(l)},get dialogInner(){return n(u)},onClose:v})};B(G,O=>{n(u)&&n(d)==="opened"&&!e.blocked&&O(Q)})}var se=A(G,2);{var H=O=>{gf(O,{onCancelSwipe:w,onOpen:m,onClose:v,onSwipe:h,get dialogWidth(){return n(o)},get animationRef(){return c},get dialog(){return n(l)},get sidebarState(){return n(d)}})};B(se,O=>{!n(y)&&!e.blocked&&O(H)})}Ie(()=>{et(N,1,nt({a:!0,b:n(E),c:n(d)==="opened"||n(d)==="opening"||n(d)==="closing"||n(d)==="swipingClose",d:n(d)==="opened"||n(d)==="opening"||n(d)==="swipingOpen"}),"p-1gucilc"),et(Y,1,nt({e:!0,f:n(d)==="swipingOpen",g:n(d)!=="opened"}),"p-1gucilc")}),g(t,C),Se()}var mf=S('<div class="a p-1lsyiiu"><div class="b p-1lsyiiu"><!> <div class="c p-1lsyiiu"><a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <div class="e p-1lsyiiu"><!></div> <!></div> <!>',1),_f=S('<div class="f p-1lsyiiu"><div class="e p-1lsyiiu"><!></div> <div class="g p-1lsyiiu"><div class="a p-1lsyiiu"><!></div> <!></div></div>');function wf(t,e){Ce(e,!0);const{checkMobileSize:a}=ga(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Ar(),{getDialogPages:i,createDialogPageHref:l,createHandleClickDialogPage:u}=zt(),{getTagsSearch:c,setTagsSearch:d}=ud(),{getSelectedTags:v,addTag:h,removeTag:p,clearTags:m}=qn(),{getSelectedMetaTags:k,addMetaTag:_,removeMetaTag:y,clearSelectedMetaTags:E}=fo();let w=T(v),C=T(k);const{getGetNotes:N,checkNotesInArchive:Y,checkNotesInBin:z}=Ot(),U=T(N),R=he=>{h(he)},G=he=>{_(he)},Q=he=>{p(he)},se=he=>{y(he)};let H=T(()=>n(w).size===0&&!n(C).has(ot.INBOX)&&(n(U)()||[]).some(he=>(!n(C).has(ot.ARCHIVED)&&!n(C).has(ot.BIN)&&he?.data&&!he.data.deletedAt&&!he.data.archivedAt||n(C).has(ot.ARCHIVED)&&he?.data&&!he.data.deletedAt&&he.data.archivedAt||n(C).has(ot.BIN)&&he?.data&&he.data.deletedAt)&&he?.data?.tags.length===0)),O=T(()=>Xo(n(C),n(w),n(U)()||[],he=>!(he?.data&&(he.data.deletedAt||he.data.archivedAt)&&!n(C).has(ot.ARCHIVED)&&!n(C).has(ot.BIN)||he?.data&&(he.data.deletedAt||!he.data.archivedAt)&&n(C).has(ot.ARCHIVED)||he?.data&&!he.data.deletedAt&&n(C).has(ot.BIN)))),we=T(()=>n(O).filter(he=>c()===""||he.toLowerCase().indexOf(c().toLowerCase())!==-1)),ue=T(a);const{checkExistedDialog:M}=Qt();let I=T(()=>i().length>0||M());const Z=()=>{if(n(ue)){if(n(I))return;o()==="opened"?r():o()==="closed"&&s()}};Ne(()=>br({key:"b",meta:!0,action:Z})),Ne(()=>br({key:"b",ctrl:!0,action:Z}));let oe=T(()=>[...n(H)&&n(C).size===0?[ot.INBOX]:[],...n(C).size===0?[...Y()&&n(w).size===0?[ot.ARCHIVED]:[],...z()&&n(w).size===0?[ot.BIN]:[]]:[]].filter(he=>c()===""||he.toLowerCase().indexOf(c().toLowerCase())!==-1).sort((he,ve)=>he===ot.INBOX?-1:ve===ot.INBOX?1:he.localeCompare(ve)));var de=ye(),ce=P(de);{var Ae=he=>{pf(he,{get blocked(){return n(I)},children:(ve,ze)=>{var W=mf(),te=P(W),be=b(te),Ee=b(be);dl(Ee,{});var fe=A(Ee,2),re=b(fe),ke=T(()=>u(Pe.Settings));re.__click=function(...$){n(ke)?.apply(this,$)};var ee=b(re);ge(ee,()=>({"--size":"24px"})),_e(ee.lastChild,{name:"settings"});var De=A(ee,2);_t(De,{children:($,J)=>{var le=Ye("Settings");g($,le)}});var pe=A(re,2),xe=T(()=>u(Pe.Sync));pe.__click=function(...$){n(xe)?.apply(this,$)};var x=b(pe);ge(x,()=>({"--size":"24px"})),_e(x.lastChild,{name:"sync"});var L=A(x,2);_t(L,{children:($,J)=>{var le=Ye("Sync");g($,le)}});var F=A(be,2),V=b(F);{let $=T(c);jo(V,{placeholder:"Search tag",get value(){return n($)},onChange:J=>{d(J)}})}var q=A(F,2);{let $=T(()=>n(C).has(ot.BIN));Is(q,{get clearTags(){return m},get clearMetaTags(){return E},get hideTagMenu(){return n($)},handleMetaTagClick:se,get metaTags(){return n(C)},get selectedTags(){return n(w)},handleSelectedTagClick:Q})}var X=A(te,2);{let $=T(()=>n(C).has(ot.BIN));Ms(X,{get hideTagMenu(){return n($)},get metaTags(){return n(oe)},get tags(){return n(we)},handleMetaTagClick:G,handleTagClick:R,mobile:!0})}Ie(($,J)=>{dt(re,"href",$),dt(pe,"href",J)},[()=>l(Pe.Settings),()=>l(Pe.Sync)]),g(ve,W)},$$slots:{default:!0}})},Fe=he=>{var ve=_f(),ze=b(ve),W=b(ze);{let re=T(c);jo(W,{placeholder:"Search tag",get value(){return n(re)},onChange:ke=>{d(ke)}})}var te=A(ze,2),be=b(te),Ee=b(be);{let re=T(()=>n(C).has(ot.BIN));Is(Ee,{get metaTags(){return n(C)},get clearTags(){return m},get clearMetaTags(){return E},get hideTagMenu(){return n(re)},get selectedTags(){return n(w)},handleMetaTagClick:se,handleSelectedTagClick:Q})}var fe=A(be,2);{let re=T(()=>n(C).has(ot.BIN));Ms(fe,{get metaTags(){return n(oe)},get hideTagMenu(){return n(re)},get tags(){return n(we)},handleMetaTagClick:G,handleTagClick:R})}g(he,ve)};B(ce,he=>{n(ue)?he(Ae):he(Fe,!1)})}g(t,de),Se()}pt(["click"]);var yf=S('<button class="a p-tddkdb"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function bf(t,e){Ce(e,!0);let a=Oe(e,"ref",15);var r=yf();r.__click=function(...i){e.onClick?.apply(this,i)};var o=b(r);ge(o,()=>({"--rotate":"-90deg"})),_e(o.lastChild,{name:"menu"});var s=A(o,2);_t(s,{children:(i,l)=>{var u=Ye();Ie(()=>vt(u,e.title)),g(i,u)}}),$e(r,i=>a(i),()=>a()),g(t,r),Se()}pt(["click"]);const Jo=t=>{try{new URL(t)}catch{return!1}return!0};var Cf=S('<div class="b p-z67y1l">Add tag for selected notes</div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Sf=S('<form class="a p-z67y1l"><!></form>');function kf(t,e){Ce(e,!0);const{addTag:a}=Ot(),{getSelectedTags:r}=qn(),{getSelectedNotes:o}=fa(),{getFiltredNotes:s}=Ma();let i=D(!1),l=D(!1),u,c=!1,d=D(null),v=D(""),h=e.nextFocusRef;Ne(()=>(n(d)&&n(d).focus(),()=>{u&&clearTimeout(u)}));const p=()=>{u=setTimeout(()=>{f(l,!0)},250)},m=()=>{f(i,!0)},k=async()=>{if(r().has(n(v).trim())){m();return}if(n(v).trim()!=="")try{p();const w=new Set(o()),C=w.size?[...w]:s().map(Y=>Y.id),{cancel:N}=await a(n(v).trim(),C);tt("Tag added",{cancel:{nextFocusRef:h,onCancel:async()=>{await N(),setTimeout(()=>{const{prev:Y}=bt(h);Y?.focus()},16)}}}),c=!0}finally{f(i,!0)}},_=()=>{e.onClosed?.(c)},y=E=>{E.preventDefault(),k()};Dr(t,{get blocked(){return n(l)},get startClose(){return n(i)},onClosed:_,children:(E,w)=>{var C=Sf(),N=b(C);{var Y=U=>{Ia(U,{})},z=U=>{var R=Cf(),G=A(P(R),2);Cr(G,{placeholder:"Enter new tag name",get ref(){return n(d)},set ref(O){f(d,O,!0)},get value(){return n(v)},set value(O){f(v,O,!0)}});var Q=A(G,2),se=b(Q);Lt(se,{size:"small",onClick:m,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(O,we)=>{var ue=Ye("Cancel");g(O,ue)},$$slots:{default:!0}});var H=A(se,2);Lt(H,{size:"small",onClick:k,fullWidth:!0,withoutMinWidth:!0,children:(O,we)=>{var ue=Ye("OK");g(O,ue)},$$slots:{default:!0}}),g(U,R)};B(N,U=>{n(l)?U(Y):U(z,!1)})}Zt("submit",C,y),g(E,C)},$$slots:{default:!0}}),Se()}var xf=S('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Tf=S('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Ef=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Pf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),Nf=S("<div><!></div>"),Af=S('<form class="c p-r3if1j"><div class="d p-r3if1j"><!></div> <button type="button" class="e p-r3if1j">Done</button></form>'),Df=S('<div class="a"><div class="b p-r3if1j"><!> <!> <!> <!> <!> <!></div> <!></div>');function vl(t,e){Ce(e,!0);const{isInitedNotes:a,getGetMapTags:r,getGetNotes:o}=Ot(),{getSelectedTags:s}=qn();let i=D(null),l=D(""),u=D(null);const c=T(a);let d=Oe(e,"shownTagInput",15);const v=()=>n(c)?e.mode==="exit"?Xo(new Set,new Set(e.selectedTags),o()()||[]):[...r()().keys()]:[];let p=T(()=>{const I=s(),Z=new Set(Xo(new Set,new Set(e.selectedTags.length>0?e.selectedTags:I),o()()||[]));return v().filter(de=>e.selectedTags.some(ce=>de===ce)?!1:n(l)===""||de.toLowerCase().indexOf(n(l).toLowerCase())===0).sort((de,ce)=>I.has(de)&&I.has(ce)?de.localeCompare(ce):I.has(de)?-1:I.has(ce)?1:Z.has(de)&&Z.has(ce)?de.localeCompare(ce):Z.has(de)?-1:Z.has(ce)?1:0)});const m=I=>{if(!e.selectedTags.includes(I)){if(e.mode!=="exit"||n(p).includes(I)){e.onChangeTags([...e.selectedTags,I]),f(l,"");return}n(i)?.focus()}},k=I=>{const Z=e.selectedTags.filter(oe=>oe!==I);e.onRejectedTag&&e.onRejectedTag(I),Z.length===0?e.onChangeTags([]):e.onChangeTags(Z)},_=I=>{I.preventDefault(),n(l)!==""?m(n(l)):d(!1)};Ue(()=>{n(i)&&d()&&n(i).focus(),d()||f(l,"")});const y=I=>{I.preventDefault()},E=I=>{I.preventDefault(),I.stopPropagation(),I.stopImmediatePropagation()};var w=Df(),C=b(w),N=b(C);Bn(N,17,()=>e.selectedTags,I=>I+"-tags_selected",(I,Z)=>{ha(I,{onPointerDown:y,onTouchStart:E,onClick:()=>{k(n(Z))},type:"button",style:"selected",children:(oe,de)=>{var ce=Ye();Ie(()=>vt(ce,n(Z))),g(oe,ce)},$$slots:{default:!0}})});var Y=A(N,2);{var z=I=>{var Z=ye(),oe=P(Z);Bn(oe,17,()=>n(p).filter(de=>de.toLowerCase()!==n(l).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),de=>de+"-tags_suggested",(de,ce)=>{ha(de,{onPointerDown:y,onTouchStart:E,onClick:()=>{m(n(ce))},children:(Ae,Fe)=>{var he=Ye();Ie(()=>vt(he,n(ce))),g(Ae,he)},$$slots:{default:!0}})}),g(I,Z)};B(Y,I=>{d()&&I(z)})}var U=A(Y,2);{var R=I=>{ha(I,{onPointerDown:y,onTouchStart:E,onClick:()=>{m(n(l)),f(l,"")},children:(Z,oe)=>{var de=Ye();Ie(()=>vt(de,n(l))),g(Z,de)},$$slots:{default:!0}})};B(U,I=>{n(l)!==""&&(e.mode!=="exit"||n(p).find(Z=>Z.toLowerCase()===n(l).toLowerCase()))&&I(R)})}var G=A(U,2);{var Q=I=>{ha(I,{mode:"empty",onPointerDown:y,onTouchStart:E,onClick:()=>{d(!0)},children:(Z,oe)=>{var de=xf(),ce=b(de);ge(ce,()=>({"--size":"12px"})),_e(ce.lastChild,{name:"plus"});var Ae=A(ce,2);_t(Ae,{children:(Fe,he)=>{var ve=Ye("add tag");g(Fe,ve)}}),g(Z,de)},$$slots:{default:!0}})};B(G,I=>{d()||I(Q)})}var se=A(G,2);{var H=I=>{ha(I,{mode:"empty",onPointerDown:y,onTouchStart:E,get onClick(){return e.onUsePreviousTags},children:(Z,oe)=>{var de=Tf(),ce=b(de);ge(ce,()=>({"--size":"12px"})),_e(ce.lastChild,{name:"back"});var Ae=A(ce,2);_t(Ae,{children:(Fe,he)=>{var ve=Ye("use previous tags");g(Fe,ve)}}),g(Z,de)},$$slots:{default:!0}})};B(se,I=>{e.previousTagsEnabled&&e.onUsePreviousTags&&I(H)})}var O=A(se,2);{var we=I=>{ha(I,{mode:"empty",onPointerDown:y,onTouchStart:E,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:(Z,oe)=>{var de=Nf(),ce=b(de);{var Ae=he=>{var ve=Ef(),ze=P(ve);ge(ze,()=>({"--size":"12px"})),Ia(ze.lastChild,{}),g(he,ve)},Fe=he=>{var ve=Pf(),ze=P(ve);ge(ze,()=>({"--size":"12px","--rotate":"180deg"})),_e(ze.lastChild,{name:"stars"});var W=A(ze,2);_t(W,{children:(te,be)=>{var Ee=Ye("gen tags");g(te,Ee)}}),g(he,ve)};B(ce,he=>{e.generatingTags?he(Ae):he(Fe,!1)})}g(Z,de)},$$slots:{default:!0}})};B(O,I=>{e.genTagsEnabled&&e.onGenTags&&I(we)})}var ue=A(C,2);{var M=I=>{var Z=Af(),oe=b(Z),de=b(oe);Cr(de,{placeholder:"tag",get ref(){return n(i)},set ref(Ae){f(i,Ae,!0)},get value(){return n(l)},set value(Ae){f(l,Ae,!0)}});var ce=A(oe,2);ce.__pointerdown=y,ce.__touchstart=E,ce.__click=()=>{n(i)?.blur(),n(l)!==""&&m(n(l)),d(!1),f(l,"")},Zt("submit",Z,_),g(I,Z)};B(ue,I=>{d()&&I(M)})}$e(w,I=>f(u,I),()=>n(u)),g(t,w),Se()}pt(["pointerdown","touchstart","click"]);var Mf=S('<div class="c p-z67y1l"><!> <!></div>'),If=S('<div class="b p-z67y1l">Change tags for selected notes</div> <!> <!>',1),Lf=S('<form class="a p-z67y1l"><!></form>');function Rf(t,e){Ce(e,!0);const{changeTags:a,getNoteById:r}=Ot(),{getSelectedTags:o}=qn(),{getSelectedNotes:s}=fa(),{getFiltredNotes:i}=Ma();let l=D(!1),u=D(!1),c,d=!1,v=D(!1),h=e.nextFocusRef,m=(()=>{const z=[...o()],U=s();if(U.size===0)return z;const R=Array.from(U);let G=new Set(r(R[0])?.data.tags||[]);for(let Q=1;Q<R.length;Q++){const se=new Set(r(R[Q])?.data.tags||[]),H=new Set([]);se.forEach(O=>{G.has(O)&&H.add(O)}),G=H}return Array.from(G)})(),k=D(ft(m));Ne(()=>()=>{c&&clearTimeout(c)});const _=()=>{c=setTimeout(()=>{f(u,!0)},250)},y=()=>{f(l,!0)},E=async()=>{const z=m,U=new Set(s()),R=U.size?[...U]:i().map(G=>G.id);try{_();const{cancel:G}=await a([...z],n(k),R);tt("Tags changed",{cancel:{nextFocusRef:h,onCancel:async()=>{await G(),setTimeout(()=>{const{prev:Q}=bt(h);Q?.focus()},16)}}}),d=!0}finally{f(l,!0)}},w=z=>{z.key==="Escape"&&n(v)&&(f(v,!1),z.preventDefault(),z.stopPropagation())};Ne(()=>(document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)));const C=()=>{e.onClosed?.(d)},N=z=>{f(k,z,!0)},Y=z=>{z.preventDefault(),E()};Dr(t,{get blocked(){return n(u)},get startClose(){return n(l)},onClosed:C,children:(z,U)=>{var R=Lf(),G=b(R);{var Q=H=>{Ia(H,{})},se=H=>{var O=If(),we=A(P(O),2);vl(we,{get selectedTags(){return n(k)},onChangeTags:N,get shownTagInput(){return n(v)},set shownTagInput(I){f(v,I,!0)}});var ue=A(we,2);{var M=I=>{var Z=Mf(),oe=b(Z);Lt(oe,{size:"small",onClick:y,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(ce,Ae)=>{var Fe=Ye("Cancel");g(ce,Fe)},$$slots:{default:!0}});var de=A(oe,2);Lt(de,{size:"small",onClick:E,fullWidth:!0,withoutMinWidth:!0,children:(ce,Ae)=>{var Fe=Ye("OK");g(ce,Fe)},$$slots:{default:!0}}),g(I,Z)};B(ue,I=>{n(v)||I(M)})}g(H,O)};B(G,H=>{n(u)?H(Q):H(se,!1)})}Zt("submit",R,Y),g(z,R)},$$slots:{default:!0}}),Se()}var Ff=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),zf=S('<li class="p-66dk2x"><!></li>'),Of=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),Bf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),jf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Hf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),Uf=S('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),Wf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Vf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),qf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),Kf=S('<li class="p-66dk2x"><!></li>'),Yf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),Gf=S('<li class="p-66dk2x"><!></li>'),Xf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),Jf=S('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <li class="p-66dk2x"><!></li>',1),Zf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),Qf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),$f=S('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),ev=S('<!> <!> <li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <!> <!>',1),tv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),nv=S('<div class="a p-66dk2x"><!></div> <!> <!> <!>',1);function av(t,e){Ce(e,!0);const{getSelectedTags:a,setSelectedTags:r,clearTags:o}=qn(),{moveNotesToBin:s,moveNotesToArchive:i,moveNotesFromArchive:l,restoreNotesFromBin:u,deleteNotes:c}=Ot(),{getFiltredNotes:d}=Ma(),{getSelectedNotes:v,setSelectedNotes:h,clearNotes:p}=fa();let m=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),k=T(a),_=D(!1),y=D(!1),E=D(!1),w=D(!1),C=D(null),N=D(null);const Y=()=>{n(_)||f(_,!0)},z=()=>{f(_,!1),f(y,!1)};Ue(()=>{!n(_)&&!n(E)&&!n(w)&&f(C,bt(n(N)).next,!0)}),Ne(()=>{const fe=re=>{re.key==="Escape"&&n(_)&&n(N)?.focus()};return window.addEventListener("keydown",fe),()=>{window.removeEventListener("keydown",fe)}});let U=()=>{};const R=()=>{f(y,!0),f(E,!0);let fe=n(N);U=()=>{f(E,!1),setTimeout(()=>{fe?.focus()},16)}};let G=()=>{};const Q=()=>{f(y,!0),f(w,!0);let fe=n(N);G=()=>{f(w,!1),setTimeout(()=>{fe?.focus()},16)}},se=async()=>{const fe=Array.from(n(k)),re=new Set(v()),ke=re.size?[...re]:d().map(De=>De.id),{cancel:ee}=await s({noteIds:ke});o(),p(),tt("Notes moved to bin",{cancel:{nextFocusRef:n(C),onCancel:async()=>{await ee(),r(new Set(fe)),h(re),setTimeout(()=>{const{prev:De}=bt(n(C));De?.focus()},16)}}}),f(y,!0)},H=async()=>{const fe=Array.from(n(k)),re=new Set(v()),ke=re.size?[...re]:d().map(De=>De.id),{cancel:ee}=await i({noteIds:ke});o(),p(),tt("Notes moved to archive",{cancel:{nextFocusRef:n(C),onCancel:async()=>{await ee(),r(new Set(fe)),h(re),setTimeout(()=>{const{prev:De}=bt(n(C));De?.focus()},16)}}}),f(y,!0)},O=async()=>{const fe=Array.from(n(k)),re=new Set(v()),ke=re.size?[...re]:d().map(De=>De.id),{cancel:ee}=await l({noteIds:ke});o(),p(),tt("Notes moved from archive",{cancel:{nextFocusRef:n(C),onCancel:async()=>{await ee(),r(new Set(fe)),h(re),setTimeout(()=>{const{prev:De}=bt(n(C));De?.focus()},16)}}}),f(y,!0)},we=async()=>{const fe=Array.from(n(k)),re=new Set(v()),ke=re.size?[...re]:d().map(De=>De.id),{cancel:ee}=await u({noteIds:ke});o(),p(),tt("Notes restored",{cancel:{nextFocusRef:n(C),onCancel:async()=>{await ee(),r(new Set(fe)),h(re),setTimeout(()=>{const{prev:De}=bt(n(C));De?.focus()},16)}}}),f(y,!0)},ue=()=>{const fe=new Set(v()),re=fe.size?[...fe]:d().map(ke=>ke.id);f(y,!0),Wa({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{f(y,!0),o(),p(),await c({noteIds:re})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(N)?.focus()},16)}})},M=()=>{const fe=d(),re=Array.from(v()),ke=[];for(const De of fe)De.data&&De.data?.link&&Jo(De.data?.link.url)&&(re.includes(De.id)||re.length===0)&&ke.push(De.data?.link.url);const ee=()=>{for(const De of ke)if(!window.open(De,"_blank")){Wa({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(N)?.focus()},16)}});break}};ke.length<=10?ee():Wa({title:`Are you sure to open ${ke.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{ee()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(N)?.focus()},16)}}),f(y,!0)},I=()=>{const fe=d(),re=Array.from(v());let ke="";for(const ee of fe)ee.data&&ee.data?.link&&Jo(ee.data?.link.url)&&(re.includes(ee.id)||re.length===0)&&(ke+=ee.data?.link.url+`
`);navigator.clipboard.writeText(ke),tt("Copied links"),f(y,!0)},Z=()=>{const fe=d(),re=Array.from(v());let ke="";for(const ee of fe)ee.data&&(re.includes(ee.id)||re.length===0)&&(ee.data?.link?.url&&(ke+=ee.data?.link.url+`
`),ee.data?.text&&(ke+=`
`+ee.data?.text+`
`),ke+=`---------------------

`);navigator.clipboard.writeText(ke),tt("Copied notes"),f(y,!0)},oe=()=>{const fe=d(),re=Array.from(v());let ke="";for(const ee of fe)ee.data&&(re.includes(ee.id)||re.length===0)&&ee.data?.link?.url&&(ke+=ee.data?.link.url+`

`);navigator.share({text:ke}).catch(ee=>{ee.name!=="AbortError"&&console.error("Error sharing",ee)}),f(y,!0)},de=()=>{const fe=d(),re=Array.from(v());let ke="";for(const ee of fe)ee.data&&(re.includes(ee.id)||re.length===0)&&(ee.data?.link?.url&&(ke+=ee.data?.link.url+`
`),ee.data?.text&&(ke+=`
`+ee.data?.text+`
`),ke+=`---------------------

`);navigator.share({text:ke}).catch(ee=>{ee.name!=="AbortError"&&console.error("Error sharing",ee)}),f(y,!0)};let ce=Tn||Un;var Ae=nv(),Fe=P(Ae),he=b(Fe);bf(he,{title:"notes menu",onClick:Y,get ref(){return n(N)},set ref(fe){f(N,fe,!0)}});var ve=A(Fe,2);{var ze=fe=>{var re=tv(),ke=P(re);ge(ke,()=>({"--right":"0","--top":"44px"})),Mr(ke.lastChild,{get startClose(){return n(y)},onClosed:z,get isMobile(){return ce},children:(ee,De)=>{var pe=ev(),xe=P(pe);{var x=ae=>{var me=zf(),Le=b(me);Ve(Le,{onClick:M,get dialogMode(){return ce},children:(Te,Me)=>{var qe=Ff(),Re=P(qe);ge(Re,()=>({"--size":"20px","--scale":"0.9"})),_e(Re.lastChild,{name:"open"}),g(Te,qe)},$$slots:{default:!0}}),g(ae,me)};B(xe,ae=>{Tn||Un||ae(x)})}var L=A(xe,2);B(L,ae=>{});var F=A(L,2),V=b(F);Ve(V,{onClick:Z,get dialogMode(){return ce},children:(ae,me)=>{var Le=Of(),Te=P(Le);ge(Te,()=>({"--size":"20px"})),_e(Te.lastChild,{name:"copy"}),g(ae,Le)},$$slots:{default:!0}});var q=A(F,2),X=b(q);Ve(X,{onClick:I,get dialogMode(){return ce},children:(ae,me)=>{var Le=Bf(),Te=P(Le);ge(Te,()=>({"--size":"20px"})),_e(Te.lastChild,{name:""}),g(ae,Le)},$$slots:{default:!0}});var $=A(q,2);{var J=ae=>{var me=Uf(),Le=P(me),Te=b(Le);Ve(Te,{onClick:de,get dialogMode(){return ce},children:(Re,Be)=>{var je=jf(),He=P(je);ge(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"share"}),g(Re,je)},$$slots:{default:!0}});var Me=A(Le,2),qe=b(Me);Ve(qe,{onClick:oe,get dialogMode(){return ce},children:(Re,Be)=>{var je=Hf(),He=P(je);ge(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:""}),g(Re,je)},$$slots:{default:!0}}),g(ae,me)};B($,ae=>{m&&ae(J)})}var le=A($,2);{var ne=ae=>{var me=Jf(),Le=P(me),Te=b(Le);Ve(Te,{onClick:R,get dialogMode(){return ce},children:(at,st)=>{var lt=Wf(),mt=P(lt);ge(mt,()=>({"--size":"20px"})),_e(mt.lastChild,{name:"add"}),g(at,lt)},$$slots:{default:!0}});var Me=A(Le,2),qe=b(Me);Ve(qe,{onClick:Q,get dialogMode(){return ce},children:(at,st)=>{var lt=Vf(),mt=P(lt);ge(mt,()=>({"--size":"20px"})),_e(mt.lastChild,{name:""}),g(at,lt)},$$slots:{default:!0}});var Re=A(Me,2);{var Be=at=>{var st=Kf(),lt=b(st);Ve(lt,{onClick:H,get dialogMode(){return ce},children:(mt,Pn)=>{var Tt=qf(),At=P(Tt);ge(At,()=>({"--size":"20px","--scale":"0.9"})),_e(At.lastChild,{name:"archive"}),g(mt,Tt)},$$slots:{default:!0}}),g(at,st)},je=at=>{var st=Gf(),lt=b(st);Ve(lt,{onClick:O,get dialogMode(){return ce},children:(mt,Pn)=>{var Tt=Yf(),At=P(Tt);ge(At,()=>({"--size":"20px","--scale":"0.9"})),_e(At.lastChild,{name:"archive-cancel"}),g(mt,Tt)},$$slots:{default:!0}}),g(at,st)};B(Re,at=>{e.mode==="notes"?at(Be):at(je,!1)})}var He=A(Re,2),wt=b(He);Ve(wt,{onClick:se,get dialogMode(){return ce},children:(at,st)=>{var lt=Xf(),mt=P(lt);ge(mt,()=>({"--size":"20px"})),_e(mt.lastChild,{name:"bin"}),g(at,lt)},$$slots:{default:!0}}),g(ae,me)};B(le,ae=>{(e.mode==="notes"||e.mode==="archive")&&ae(ne)})}var K=A(le,2);{var ie=ae=>{var me=$f(),Le=P(me),Te=b(Le);Ve(Te,{onClick:we,get dialogMode(){return ce},children:(Re,Be)=>{var je=Zf(),He=P(je);ge(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"bin-cancel"}),g(Re,je)},$$slots:{default:!0}});var Me=A(Le,2),qe=b(Me);Ve(qe,{onClick:ue,get dialogMode(){return ce},dangerous:!0,children:(Re,Be)=>{var je=Qf(),He=P(je);ge(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"bin"}),g(Re,je)},$$slots:{default:!0}}),g(ae,me)};B(K,ae=>{e.mode==="bin"&&ae(ie)})}g(ee,pe)},$$slots:{default:!0}}),g(fe,re)};B(ve,fe=>{n(_)&&fe(ze)})}var W=A(ve,2);{var te=fe=>{kf(fe,{get nextFocusRef(){return n(C)},onClosed:re=>{U(re)}})};B(W,fe=>{n(E)&&fe(te)})}var be=A(W,2);{var Ee=fe=>{Rf(fe,{get nextFocusRef(){return n(C)},onClosed:re=>{G(re)}})};B(be,fe=>{n(w)&&fe(Ee)})}g(t,Ae),Se()}var rv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),ov=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),sv=S('<li class="p-1ljon4s"><!></li>'),iv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),lv=S('<li class="p-1ljon4s"><!></li>'),cv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),dv=S('<li class="p-1ljon4s"><!></li>'),uv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),fv=S('<li class="p-1ljon4s"><!></li>'),vv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),gv=S('<li class="p-1ljon4s"><!></li>'),hv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),pv=S('<li class="p-1ljon4s"><!></li>'),mv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),_v=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),wv=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),yv=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),bv=S(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Cv=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Sv=S('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!> <!>',1),kv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function xv(t,e){Ce(e,!0);const{checkMobileSize:a}=ga(),{getMode:r,getSelectedNotes:o,changeMode:s,addNote:i}=fa(),{clearDialogPages:l}=zt(),{setFeedSearch:u}=$a(),{moveNoteToBin:c,moveNoteFromArchive:d,moveNoteToArchive:v,deleteNote:h,pinNote:p,restoreNoteFromBin:m,checkDuplicatesExist:k}=Ot();let _=Oe(e,"mode",3,"notes"),y=Oe(e,"shownMenu",15),E=D(!1),w=D(!1),C=D(!1),N=D(!1),Y=D(!1),z=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const U=async()=>{c(e.noteId),tt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{m(e.noteId)}}})},R=async()=>{v(e.noteId),tt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(e.noteId)}}})},G=async()=>{d(e.noteId),tt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{v(e.noteId)}}})},Q=()=>{m(e.noteId),tt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{c(e.noteId)}}})},se=()=>{e.noteData.pinned?(p(e.noteId,!1),tt("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!0)}}})):(p(e.noteId,!0),tt("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!1)}}})),f(E,!0)},H=()=>{n(w)?(f(w,!1),U()):n(Y)?(f(Y,!1),Q()):n(C)?(f(C,!1),R()):n(N)&&(f(N,!1),G()),y(!1),f(E,!1)},O=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),tt("Copied link"),f(E,!0))},we=()=>{let ve="";e.noteData.link?.url&&(ve+=e.noteData.link.url+`
`),e.noteData.text&&(ve+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(ve),tt("Copied"),f(E,!0)},ue=()=>{f(E,!0),Wa({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await h(e.noteId)},onCancel:async()=>{}})},M=()=>{if(navigator.share){const ve={};let ze="";e.noteData.link?.url&&(ze+=e.noteData.link.url+`
`),e.noteData.text&&(ze+=`
`+e.noteData.text+`
`),ve.text=ze,navigator.share(ve).catch(W=>{W.name!=="AbortError"&&console.error("Error sharing",W)})}f(E,!0)},I=()=>{if(navigator.share){const ve={};e.noteData.link?.url&&(ve.url=e.noteData.link.url),e.noteData.link?.title&&(ve.title=e.noteData.link.title),navigator.share(ve).catch(ze=>{ze.name!=="AbortError"&&console.error("Error sharing",ze)})}f(E,!0)},Z=()=>{f(E,!0),e.noteData.link?.url&&(l(),u(e.noteData.link?.url))};let oe=Tn||Un,de=T(a),ce=T(()=>r()==="multiple"&&o().has(e.noteId));var Ae=ye(),Fe=P(Ae);{var he=ve=>{var ze=kv(),W=P(ze);ge(W,()=>({"--bottom":e.showMenuUp?"calc(100%)":"auto","--top":e.showMenuUp?"auto":"calc(100%)","--right":"10px"})),Mr(W.lastChild,{get startClose(){return n(E)},onClosed:H,get isMobile(){return oe},children:(te,be)=>{var Ee=Sv(),fe=P(Ee),re=b(fe);Ve(re,{onClick:se,get dialogMode(){return oe},children:(K,ie)=>{var ae=rv(),me=P(ae);{let Te=T(()=>e.noteData.pinned?"pin-cancel":"pin");ge(me,()=>({"--size":"20px"})),_e(me.lastChild,{get name(){return n(Te)}})}var Le=A(me);Ie(()=>vt(Le,` ${e.noteData.pinned?"Unpin":"Pin"}`)),g(K,ae)},$$slots:{default:!0}});var ke=A(fe,2);{var ee=K=>{var ie=sv(),ae=b(ie);Ve(ae,{onClick:we,get dialogMode(){return oe},children:(me,Le)=>{var Te=ov(),Me=P(Te);ge(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:"copy"}),g(me,Te)},$$slots:{default:!0}}),g(K,ie)};B(ke,K=>{e.noteData.text&&K(ee)})}var De=A(ke,2);{var pe=K=>{var ie=lv(),ae=b(ie);Ve(ae,{onClick:O,get dialogMode(){return oe},children:(me,Le)=>{var Te=iv(),Me=P(Te);ge(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:""}),g(me,Te)},$$slots:{default:!0}}),g(K,ie)};B(De,K=>{n(de)&&e.noteData.link?.url&&K(pe)})}var xe=A(De,2);{var x=K=>{var ie=dv(),ae=b(ie);Ve(ae,{onClick:M,get dialogMode(){return oe},children:(me,Le)=>{var Te=cv(),Me=P(Te);ge(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:"share"}),g(me,Te)},$$slots:{default:!0}}),g(K,ie)};B(xe,K=>{z&&e.noteData.text&&K(x)})}var L=A(xe,2);{var F=K=>{var ie=fv(),ae=b(ie);Ve(ae,{onClick:I,get dialogMode(){return oe},children:(me,Le)=>{var Te=uv(),Me=P(Te);{let qe=T(()=>e.noteData.text?"":"share");ge(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{get name(){return n(qe)}})}g(me,Te)},$$slots:{default:!0}}),g(K,ie)};B(L,K=>{z&&e.noteData.link?.url&&K(F)})}var V=A(L,2);{var q=K=>{var ie=gv(),ae=b(ie);Ve(ae,{onClick:()=>{f(E,!0),r()!=="multiple"&&s("multiple"),i(e.noteId)},get dialogMode(){return oe},children:(me,Le)=>{var Te=vv(),Me=P(Te);ge(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:"check"}),g(me,Te)},$$slots:{default:!0}}),g(K,ie)};B(V,K=>{n(ce)||K(q)})}var X=A(V,2);{var $=K=>{var ie=pv(),ae=b(ie);Ve(ae,{onClick:Z,get dialogMode(){return oe},children:(me,Le)=>{var Te=hv(),Me=P(Te);ge(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:""}),g(me,Te)},$$slots:{default:!0}}),g(K,ie)};B(X,K=>{e.noteData.link?.url&&k(e.noteId)&&K($)})}var J=A(X,2);{var le=K=>{var ie=wv(),ae=P(ie),me=b(ae);Ve(me,{onClick:()=>{f(C,_()==="notes"),f(N,_()==="archive"),f(E,!0)},get dialogMode(){return oe},children:(Me,qe)=>{var Re=mv(),Be=P(Re);{let He=T(()=>_()==="archive"?"archive-cancel":"archive");ge(Be,()=>({"--size":"20px","--scale":"0.9"})),_e(Be.lastChild,{get name(){return n(He)}})}var je=A(Be);Ie(()=>vt(je,` ${_()==="archive"?"Unarchive":"Archive"}`)),g(Me,Re)},$$slots:{default:!0}});var Le=A(ae,2),Te=b(Le);Ve(Te,{onClick:()=>{f(w,!0),f(E,!0)},get dialogMode(){return oe},children:(Me,qe)=>{var Re=_v(),Be=P(Re),je=b(Be);ge(je,()=>({"--size":"20px"})),_e(je.lastChild,{name:"bin"}),g(Me,Re)},$$slots:{default:!0}}),g(K,ie)},ne=K=>{var ie=Cv(),ae=P(ie),me=b(ae);Ve(me,{onClick:()=>{f(Y,!0),f(E,!0)},get dialogMode(){return oe},children:(Me,qe)=>{var Re=yv(),Be=P(Re),je=b(Be);ge(je,()=>({"--size":"20px"})),_e(je.lastChild,{name:"bin-cancel"}),g(Me,Re)},$$slots:{default:!0}});var Le=A(ae,2),Te=b(Le);Ve(Te,{onClick:ue,get dialogMode(){return oe},dangerous:!0,children:(Me,qe)=>{var Re=bv(),Be=P(Re),je=b(Be);ge(je,()=>({"--size":"20px"})),_e(je.lastChild,{name:"bin"}),g(Me,Re)},$$slots:{default:!0}}),g(K,ie)};B(J,K=>{_()==="notes"||_()==="archive"?K(le):K(ne,!1)})}g(te,Ee)},$$slots:{default:!0}}),g(ve,ze)};B(Fe,ve=>{y()&&ve(he)})}g(t,Ae),Se()}var Tv=S('<div class="a p-1hg9kpf"></div>'),Ev=S('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function gl(t,e){Ce(e,!0);const a=c=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(c).host}.ico`}catch{return""}};let r=D(!1),o=T(()=>a(e.url));var s=ye(),i=P(s);{var l=c=>{var d=Tv();g(c,d)},u=c=>{var d=Ev();Ie(v=>dt(d,"src",v),[()=>a(e.url)]),Zt("error",d,()=>{f(r,!0)}),g(c,d)};B(i,c=>{n(r)||!n(o)?c(l):c(u,!1)})}g(t,s),Se()}var Pv=S('<a target="_blank" rel="noopener noreferrer"><!> <!></a>'),Nv=S("<button><!> <!></button>");function ln(t,e){Ce(e,!0);let a=Oe(e,"tabindex",3,0),r=Oe(e,"onclick",3,()=>{}),o=Oe(e,"ref",15),s=Oe(e,"disabled",3,!1);var i=ye(),l=P(i);{var u=d=>{var v=Pv();v.__click=function(...m){r()?.apply(this,m)};var h=b(v);We(h,()=>e.children);var p=A(h,2);_t(p,{children:(m,k)=>{var _=Ye();Ie(()=>vt(_,e.title)),g(m,_)}}),$e(v,m=>o(m),()=>o()),Ie(()=>{dt(v,"href",e.href),dt(v,"tabindex",s()?-1:a()),et(v,1,nt({a:!0,b:s()}),"p-62et9t")}),g(d,v)},c=d=>{var v=ye(),h=P(v);{var p=m=>{var k=Nv();k.__click=function(...E){r()?.apply(this,E)};var _=b(k);We(_,()=>e.children);var y=A(_,2);_t(y,{children:(E,w)=>{var C=Ye();Ie(()=>vt(C,e.title)),g(E,C)}}),$e(k,E=>o(E),()=>o()),Ie(()=>{dt(k,"tabindex",s()?-1:a()),et(k,1,nt({a:!0,b:s()}),"p-62et9t"),k.disabled=s()}),g(m,k)};B(h,m=>{e.elem==="button"&&m(p)},!0)}g(d,v)};B(l,d=>{e.elem==="a"?d(u):d(c,!1)})}g(t,i),Se()}pt(["click"]);let ho=D(!1),po=D(!1),Cn=D(void 0),Jr={};const Av=()=>{Tn||Un||f(po,!0)},Dv=()=>{f(po,!1)},Zo=()=>{Tn||Un||f(ho,!0)},Mv=()=>{f(ho,!1)},Iv=()=>n(po),hl=()=>n(ho),vn=t=>{Tn||Un||f(Cn,t,!0)},qr=()=>n(Cn),Fs=()=>{const t=Jr[n(Cn)||""]?.next;if(t)return f(Cn,t,!0),t},zs=()=>{const t=Jr[n(Cn)||""]?.prev;if(t)return f(Cn,t,!0),t};var Lv=S('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),Rv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Fv=S('<div class="b p-rxwzp0"><!></div>'),zv=S('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Ov=S('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Bv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),jv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Hv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Uv=S("<!> <!>",1),Wv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Vv=S("<li><!> <!> <!> <div><!> <!> <!></div> <!></li>");function qv(t,e){Ce(e,!0);const{pushDialogPage:a}=zt(),{getFaviconEnabled:r,getRecordMode:o}=ua(),{getMode:s,getSelectedNotes:i,addNote:l,removeNote:u}=fa(),{getSearchParams:c,getHref:d}=Ht();let v=Oe(e,"mode",3,"notes"),h="unknown";Ue(()=>(Jr[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete Jr[e.noteId]}));let p=D(!1),m=D(!1),k=T(r),_=T(o),y=D(null),E=D(null),w=D(null);const{checkMobileSize:C}=ga(),N=()=>{f(p,!0)},Y=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),tt("Copied link"))};Ue(()=>{n(Cn)===e.noteId?f(m,!0):f(m,!1)});const z=W=>{W.preventDefault(),a(`${Pe.Note}?id=${encodeURIComponent(e.noteId)}`)},U=T(()=>e.noteData.link?.url||"");let R=T(()=>n(p)&&n(y)?bt(n(y)).next:null);const G=W=>{W?l(e.noteId):u(e.noteId)},Q=()=>{const W=new URLSearchParams(c());return W.set(tn,`${Pe.Note}?id=${encodeURIComponent(e.noteId)}`),d(W)};let se=T(()=>s()==="multiple"&&i().has(e.noteId));Ne(()=>{const W=te=>{if(h="keyboard",n(Cn)===e.noteId&&(te.key==="Enter"&&n(po)&&(n(_)==="note"?(te.preventDefault(),setTimeout(()=>{a(`${Pe.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(_)==="bookmark"&&n(U)&&window.open(n(U),"_blank","noopener")),te.key==="Tab"&&n(ho)&&(Mv(),n(w)))){const be=bt(n(w));te.shiftKey?be.prev?.focus():be?.next?.focus()}};return document.addEventListener("keydown",W),()=>{document.removeEventListener("keydown",W)}});var H=Vv();H.__focusin=()=>{h==="keyboard"&&f(Cn,e.noteId,!0)};var O=b(H);{var we=W=>{var te=Lv(),be=b(te);ge(be,()=>({"--size":"18px"})),_e(be.lastChild,{name:"pin"}),g(W,te)};B(O,W=>{e.noteData.pinned&&W(we)})}var ue=A(O,2);{var M=W=>{var te=Fv(),be=b(te);{var Ee=re=>{gl(re,{get url(){return n(U)}})},fe=re=>{var ke=Rv(),ee=P(ke);ge(ee,()=>({"--size":"16px"})),_e(ee.lastChild,{name:"note"}),g(re,ke)};B(be,re=>{n(U)?re(Ee):re(fe,!1)})}g(W,te)};B(ue,W=>{n(k)&&W(M)})}var I=A(ue,2);{var Z=W=>{var te=zv();te.__keydown=Ee=>{Ee.key==="Enter"&&(h="keyboard")},te.__mousedown=()=>{h="mouse"},te.__click=Ee=>{h==="mouse"&&vn(void 0),Ee.preventDefault(),s()==="multiple"?G(!n(se)):z(Ee)};var be=b(te);$e(te,Ee=>f(w,Ee),()=>n(w)),Ie((Ee,fe)=>{dt(te,"tabindex",e.focusHidden?-1:0),dt(te,"href",Ee),vt(be,fe)},[Q,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Zt("focus",te,()=>{}),g(W,te)},oe=W=>{var te=Ov();te.__keydown=Ee=>{Ee.key==="Enter"&&(h="keyboard")},te.__mousedown=()=>{h="mouse"},te.__click=Ee=>{s()==="multiple"&&(Ee.preventDefault(),G(!n(se)))};var be=b(te);$e(te,Ee=>f(w,Ee),()=>n(w)),Ie(Ee=>{dt(te,"tabindex",e.focusHidden?-1:0),dt(te,"href",n(U)),vt(be,Ee)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Zt("focus",te,()=>{}),g(W,te)};B(I,W=>{n(_)==="note"||!n(U)?W(Z):W(oe,!1)})}var de=A(I,2),ce=b(de);{var Ae=W=>{{let te=T(Q),be=T(()=>e.focusHidden?-1:0);ln(W,{title:"edit",elem:"a",get href(){return n(te)},get tabindex(){return n(be)},onclick:z,children:(Ee,fe)=>{var re=Bv(),ke=P(re);ge(ke,()=>({"--size":"18px"})),_e(ke.lastChild,{name:"pen"}),g(Ee,re)},$$slots:{default:!0}})}};B(ce,W=>{(n(_)==="bookmark"||s()==="multiple")&&W(Ae)})}var Fe=A(ce,2);{var he=W=>{var te=Uv(),be=P(te);{var Ee=ke=>{{let ee=T(()=>e.focusHidden?-1:0),De=T(()=>e.noteData.link?.title||"unknown");ln(ke,{elem:"a",get href(){return n(U)},get tabindex(){return n(ee)},get title(){return n(De)},children:(pe,xe)=>{var x=jv(),L=P(x);ge(L,()=>({"--size":"18px"})),_e(L.lastChild,{name:"open"}),g(pe,x)},$$slots:{default:!0}})}};B(be,ke=>{(n(_)==="note"||s()==="multiple")&&ke(Ee)})}var fe=A(be,2);{var re=ke=>{{let ee=T(()=>e.focusHidden?-1:0);ln(ke,{elem:"button",onclick:Y,get tabindex(){return n(ee)},title:"copy link",children:(De,pe)=>{var xe=Hv(),x=P(xe);ge(x,()=>({"--size":"20px"})),_e(x.lastChild,{name:"copy"}),g(De,xe)},$$slots:{default:!0}})}};B(fe,ke=>{C()||ke(re)})}g(W,te)};B(Fe,W=>{n(U)&&W(he)})}var ve=A(Fe,2);{let W=T(()=>e.focusHidden?-1:0);ln(ve,{title:"show menu",elem:"button",get tabindex(){return n(W)},onclick:N,get ref(){return n(y)},set ref(te){f(y,te,!0)},children:(te,be)=>{var Ee=Wv(),fe=P(Ee);ge(fe,()=>({"--size":"18px","--rotate":"90deg"})),_e(fe.lastChild,{name:"menu"}),g(te,Ee)},$$slots:{default:!0}})}var ze=A(de,2);xv(ze,{get nextFocusRef(){return n(R)},get mode(){return v()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(p)},set shownMenu(W){f(p,W,!0)}}),$e(H,W=>f(E,W),()=>n(E)),Ie(()=>{et(H,1,nt({d:!0,e:n(m),f:n(se)||n(Cn)===e.noteId}),"p-rxwzp0"),et(de,1,nt({g:!0,h:n(m)}),"p-rxwzp0")}),g(t,H),Se()}pt(["focusin","keydown","mousedown","click"]);var Kv=S('<div class="g e p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),Yv=S('<div class="g p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),Gv=S('<a class="i j p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),Xv=S('<div class="h p-12ns0yc"><!> <!></div>'),Jv=S('<!> <div class="q p-12ns0yc"><!></div>',1),Zv=S('<button class="u p-12ns0yc">All</button>'),Qv=S('<button class="u p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),$v=S('<div class="s p-12ns0yc"><div class="t p-12ns0yc"><!> <span> </span> <!></div> <button class="u v p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),eg=S('<div class="a p-12ns0yc"><div class="b p-12ns0yc"><div class="c p-12ns0yc"><a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-12ns0yc"><!></div> <div class="f p-12ns0yc"><!></div></div> <div class="k p-12ns0yc"><div class="l p-12ns0yc"><!></div> <div class="m p-12ns0yc"><div class="n p-12ns0yc"><div class="o p-12ns0yc"><!></div> <div class="p p-12ns0yc"><!></div></div> <div class="r p-12ns0yc"><!></div></div></div></div>');function tg(t,e){Ce(e,!0);const{getFeedSearch:a,setFeedSearch:r}=$a(),{getScrollContainer:o}=vo();let s=T(o);const{emptyBin:i,checkNotesInBin:l,checkNotesInArchive:u,checkNotes:c}=Ot(),{replaceSearchParams:d}=Ht(),{createDialogPageHref:v,createHandleClickDialogPage:h,getDialogPages:p}=zt(),{checkExistedDialog:m}=Qt(),{getMode:k,clearNotes:_,setSelectedNotes:y,getSelectedNotes:E,changeMode:w}=fa(),{checkMobileSize:C}=ga(),{getFiltredNotes:N}=Ma(),{getSelectedMetaTags:Y}=fo(),{getViewMode:z}=ua();let U=T(Y),R=D(null);const G=T(l);let se=T(()=>{const $=N()||[],J=E();return $.every(le=>J.has(le.id))});const H=()=>{Wa({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await i(),d("")},onCancel:async()=>{}})};let O=T(()=>p().length===0);Ue(()=>{n(O)});const we=()=>{p().length===0&&!m()&&n(R)?.focus()};Ne(()=>br({key:"k",meta:!0,action:we})),Ne(()=>br({key:"k",ctrl:!0,action:we})),Ne(()=>{}),Ue(()=>{const $=N()||[];Ft(()=>{const J=E();y(new Set($.filter(le=>J.has(le.id)).map(le=>le.id)))})});let ue=T(()=>n(U).has(ot.ARCHIVED)?"archive":n(U).has(ot.BIN)?"bin":"notes");Ne(()=>{n(R)&&n(R).addEventListener("keydown",$=>{$.key==="Tab"&&qr()&&$.preventDefault()})}),Ue(()=>{hl()&&setTimeout(()=>{n(R)?.focus(),n(R)?.setSelectionRange(n(R).value.length,n(R).value.length)},0)}),Ne(()=>{});var M=eg(),I=b(M),Z=b(I),oe=b(Z),de=T(()=>h(Pe.Settings));oe.__click=function(...$){n(de)?.apply(this,$)};var ce=b(oe);ge(ce,()=>({"--rotate":"30deg","--size":"20px"})),_e(ce.lastChild,{name:"settings"});var Ae=A(oe,2),Fe=T(()=>h(Pe.Sync));Ae.__click=function(...$){n(Fe)?.apply(this,$)};var he=b(Ae);ge(he,()=>({"--size":"20px"})),_e(he.lastChild,{name:"sync"});var ve=A(Z,2),ze=b(ve);dl(ze,{});var W=A(ve,2),te=b(W);{var be=$=>{var J=ye(),le=P(J);{var ne=K=>{var ie=ye(),ae=P(ie);{var me=Te=>{var Me=Kv(),qe=b(Me);qe.__click=H;var Re=b(qe);ge(Re,()=>({"--scale":"1.2","--size":"20px"})),_e(Re.lastChild,{name:"clear"});var Be=A(Re);_t(Be,{children:(je,He)=>{var wt=Ye("Empty bin");g(je,wt)}}),g(Te,Me)},Le=Te=>{var Me=Yv(),qe=b(Me);qe.__click=H;var Re=b(qe);ge(Re,()=>({"--scale":"0.9","--size":"20px"})),_e(Re.lastChild,{name:"clear"}),g(Te,Me)};B(ae,Te=>{C()?Te(me):Te(Le,!1)})}g(K,ie)};B(le,K=>{n(G)&&K(ne)})}g($,J)},Ee=$=>{var J=ye(),le=P(J);{var ne=K=>{var ie=Xv(),ae=b(ie);{var me=Te=>{var Me=Gv();Me.__click=function(...Be){e.onOpenWindow?.apply(this,Be)};var qe=b(Me);ge(qe,()=>({"--scale":"0.7","--size":"26px"})),_e(qe.lastChild,{name:"open-window"});var Re=A(qe,2);_t(Re,{children:(Be,je)=>{var He=Ye("open window");g(Be,He)}}),Ie(()=>dt(Me,"href",e.openWindowHref)),g(Te,Me)};B(ae,Te=>{e.onOpenWindow&&Te(me)})}var Le=A(ae,2);Ou(Le,{}),g(K,ie)};B(le,K=>{n(ue)==="notes"&&K(ne)},!0)}g($,J)};B(te,$=>{n(ue)==="bin"?$(be):$(Ee,!1)})}var fe=A(I,2),re=b(fe),ke=b(re);wf(ke,{});var ee=A(re,2),De=b(ee),pe=b(De),xe=b(pe);{let $=T(a);jo(xe,{placeholder:"Search",onFocus:()=>{Tn||Un||(Av(),Zo(),n(R)?.setSelectionRange(n(R).value.length,n(R).value.length))},onBlur:()=>{Dv()},get value(){return n($)},onChange:J=>{vn(void 0),n(s)&&n(s).scrollTo({top:0}),r(J)},onEscape:()=>{vn(void 0)},get ref(){return n(R)},set ref(J){f(R,J,!0)}})}var x=A(pe,2),L=b(x);{var F=$=>{var J=Jv(),le=P(J);Au(le,{});var ne=A(le,2),K=b(ne);av(K,{get mode(){return n(ue)}}),g($,J)};B(L,$=>{(n(ue)==="notes"&&c()||n(ue)==="bin"&&l()||n(ue)==="archive"&&u())&&$(F)})}var V=A(De,2),q=b(V);{var X=$=>{var J=ye(),le=P(J);{var ne=K=>{var ie=$v(),ae=b(ie),me=b(ae);{var Le=He=>{var wt=Zv();wt.__click=at=>{at.preventDefault();const st=N()||[];y(new Set(st.map(lt=>lt.id)))},g(He,wt)};B(me,He=>{n(se)||He(Le)})}var Te=A(me,2),Me=b(Te),qe=A(Te,2);{var Re=He=>{var wt=Qv();wt.__click=st=>{st.preventDefault(),_()};var at=b(wt);ge(at,()=>({"--size":"16px"})),_e(at.lastChild,{name:"close"}),g(He,wt)};B(qe,He=>{E().size>0&&He(Re)})}var Be=A(ae,2);Be.__click=He=>{He.preventDefault(),w("single")};var je=b(Be);ge(je,()=>({"--size":"16px"})),_e(je.lastChild,{name:"close"}),Ie(He=>vt(Me,`Selected ${He??""}`),[()=>E().size]),g(K,ie)};B(le,K=>{k()==="multiple"&&K(ne)})}g($,J)};B(q,$=>{(n(ue)==="notes"&&c()||n(ue)==="bin"&&l()||n(ue)==="archive"&&u())&&$(X)})}Ie(($,J)=>{dt(oe,"href",$),dt(Ae,"href",J)},[()=>v(Pe.Settings),()=>v(Pe.Sync)]),g(t,M),Se()}pt(["click"]);var ng=S('<div class="a p-11shdp8"><!></div>');function Ct(t,e){Ce(e,!0);const{setDialogPageHeight:a}=ds();let r=D(null);Ne(()=>{n(r);const i=new ResizeObserver(l=>{for(let u of l){const c=u.contentRect.height;a(c)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=ng(),s=b(o);We(s,()=>e.children),$e(o,i=>f(r,i),()=>n(r)),g(t,o),Se()}var ag=S('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function rg(t,e){Ce(e,!1);const{replaceSearchParams:a,getHref:r}=Ht(),o=l=>{l.preventDefault(),a("")};ss();var s=ag(),i=A(b(s),2);{let l=Er(()=>r(""));Lt(i,{element:"a",get href(){return n(l)},onClick:o,children:(u,c)=>{var d=Ye("close");g(u,d)},$$slots:{default:!0}})}g(t,s),Se()}var og=S('<h1 class="p-1n0ziuh"><!></h1>');function sg(t,e){var a=og(),r=b(a);We(r,()=>e.children),g(t,a)}var ig=S('<!> <div class="b p-193tby9"><!> <!></div>',1),lg=S('<div class="a p-193tby9"><!></div>');function cg(t,e){Ce(e,!0);const{blockDialog:a,setLeftEnd:r}=Qt(),{pushDialogPage:o}=zt(),{initLocalAccount:s}=ls(),{replaceSearchParams:i}=Ht(),l=Kn(),u=()=>{o(Pe.Auth)},c=async()=>{l.duration=0,l.swipingRatio=-25,requestAnimationFrame(()=>{l.duration=la().duration,l.swipingRatio=la().swipingRatio,s(),a(!1),r(!0),i("")})};var d=lg(),v=b(d);{var h=p=>{var m=ig(),k=P(m);sg(k,{children:(w,C)=>{var N=Ye("Welcome");g(w,N)}});var _=A(k,2),y=b(_);Lt(y,{onClick:u,fullWidth:!0,children:(w,C)=>{var N=Ye("Cloud account");g(w,N)},$$slots:{default:!0}});var E=A(y,2);Lt(E,{onClick:c,fullWidth:!0,type:"secondary",children:(w,C)=>{var N=Ye("Local account");g(w,N)},$$slots:{default:!0}}),g(p,m)};B(v,p=>{p(h)})}g(t,d),Se()}var dg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ug=S('<form class="b p-10m9vsg"><!> <!> <div class="c p-10m9vsg"><div class="d p-10m9vsg"><button type="button" class="p-10m9vsg">Cancel</button> <button type="submit" class="p-10m9vsg">Done</button></div> <!></div></form>'),fg=S('<div class="f p-10m9vsg"><!></div>'),vg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gg=S('<div class="e p-10m9vsg"><div><!> <a class="g p-10m9vsg" target="_blank" rel="noopener noreferrer"> </a> <div><!></div></div></div>'),hg=S('<div class="a p-10m9vsg"><!></div>');function pg(t,e){Ce(e,!0);let a=Oe(e,"shownUrlInput",15);const{getFaviconEnabled:r}=ua();let o=T(r),s=D(null),i=D(null),l=D(null),u=D(ft(e.url)),c=D(ft(e.title)),d=D(null);const v=w=>{f(u,w.target.value||"",!0)},h=w=>{f(c,w.target.value||"",!0)};Ue(()=>{a()&&n(s)?.focus()});const p=()=>{e.url&&(navigator.clipboard.writeText(e.url),tt("Copied link"))},m=()=>{f(c,""),f(u,""),e.onDeleteUrl(),a(!1)};var k=hg(),_=b(k);{var y=w=>{var C=ug(),N=b(C);Cr(N,{get value(){return n(u)},onInput:v,placeholder:"url",get ref(){return n(s)},set ref(se){f(s,se,!0)}});var Y=A(N,2);Cr(Y,{get value(){return n(c)},onInput:h,placeholder:"title",get ref(){return n(i)},set ref(se){f(i,se,!0)}});var z=A(Y,2),U=b(z),R=b(U);R.__click=()=>{f(u,e.url,!0),f(c,e.title,!0),a(!1)};var G=A(U,2);{var Q=se=>{ln(se,{title:"delete link",elem:"button",onclick:m,children:(H,O)=>{var we=dg(),ue=P(we);ge(ue,()=>({"--size":"20px"})),_e(ue.lastChild,{name:"bin"}),g(H,we)},$$slots:{default:!0}})};B(G,se=>{(e.url||e.title)&&se(Q)})}Zt("submit",C,se=>{if(se.preventDefault(),document.activeElement===n(s)){n(i)?.focus();return}let H=n(u).trim();H!==""&&/^[[a-zA-Z]+?:\/\//.test(H)===!1&&(H="https://"+H,f(u,H,!0)),e.onChangeUrl(H,n(c)),a(!1)}),g(w,C)},E=w=>{var C=ye(),N=P(C);{var Y=z=>{var U=gg(),R=b(U);et(R,1,nt({h:!0}),"p-10m9vsg");var G=b(R);{var Q=ue=>{var M=fg(),I=b(M);gl(I,{get url(){return e.url}}),g(ue,M)};B(G,ue=>{n(o)&&ue(Q)})}var se=A(G,2),H=b(se),O=A(se,2);et(O,1,nt({i:!0}),"p-10m9vsg");var we=b(O);ln(we,{title:"copy link",elem:"button",onclick:p,children:(ue,M)=>{var I=vg(),Z=P(I);ge(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{name:"copy"}),g(ue,I)},$$slots:{default:!0}}),$e(R,ue=>f(d,ue),()=>n(d)),Ie(()=>{dt(se,"href",e.url),vt(H,e.title||"unknown")}),g(z,U)};B(N,z=>{e.url&&z(Y)},!0)}g(w,C)};B(_,w=>{a()?w(y):w(E,!1)})}$e(k,w=>f(l,w),()=>n(l)),g(t,k),Se()}pt(["click"]);const mg=t=>{let e="",a=!0;function r(o){for(let s=0;s<o.length;s++){const i=o[s];if(i.nodeName==="BR"){e+=`
`,a=!0;continue}i.nodeName==="DIV"&&a===!1&&(e+=`
`),a=!1,i.nodeType===3&&i.textContent&&(e+=i.textContent),r(i.childNodes)}}return r(t),e===`
`&&(e=e.slice(0,-1)),e},_g=()=>{const t=()=>{const a=new Set(["script","style","noscript","iframe","svg","canvas","meta","link","input","button","form"]),r=u=>{if(u.childNodes.length===0)return!1;for(const c of u.childNodes)if(c.nodeType===Node.TEXT_NODE&&c.textContent?.trim())return!0;return!1},o=Array.from({length:10},()=>({priority:0,text:""})),s=(u,c)=>({main:u.main||c.tagName.toLowerCase()==="main",article:u.article||c.tagName.toLowerCase()==="article",h1:u.h1||c.tagName.toLowerCase()==="h1",h2:u.h2||c.tagName.toLowerCase()==="h2",h3:u.h3||c.tagName.toLowerCase()==="h3"}),i=u=>{let c=0;return u.main&&(c+=1e3),u.article&&(c+=1e4),u.h1&&(c+=10),u.h2&&(c+=5),u.h3&&(c+=1),c},l=(u=document.body,c={main:!1,article:!1,h1:!1,h2:!1,h3:!1})=>{for(const d of u.childNodes)if(d.nodeType===Node.ELEMENT_NODE){if(a.has(d.tagName.toLowerCase()))continue;if(r(d)){const v=d.textContent;if(!v)continue;for(let h=0;h<o.length&&!o[h].text.includes(v||"");h++)if(v&&i(s(c,d))+v.length>o[h].priority){o.splice(h,0,{priority:i(s(c,d))+v.length,text:v.trim()}),o.pop();break}}else l(d,s(c,d))}};return l(),o};return{title:document.title||"",desctiption:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",topTextContents:t()}},wg=async()=>await Zi().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),yg=async()=>typeof LanguageModel>"u"?"unavailable":await Zi().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),bg=t=>new Promise(e=>{Ds().tabs.query({active:!0,currentWindow:!0},async a=>{const r=a[0];if(!r||!r.id){e(void 0);return}if(r.url!==t){e(void 0);return}const s=(await Ds().scripting.executeScript({target:{tabId:r.id},world:"MAIN",func:_g}))[0]?.result;e(s)})}),Cg=async({llmSession:t,rejectedTags:e,accessPageData:a,text:r,link:o,tags:s})=>{const i=a&&o?.url?await bg(o.url):void 0,l={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},u=`
			Page information:
			Title: ${o?.title||"N/A"}.
			URL: ${o?.url||"N/A"}.
			Description: ${i?.desctiption||"N/A"}.
			Note content: ${r||"N/A"}.
			Dont return tags: ${[...e.length>0?e:[],...s.length>0?s:[]].join(", ")||"N/A"}.
			Page contents: ${i?.topTextContents?i.topTextContents.slice(0,5).map(({priority:v,text:h})=>`priority: ${v}; text: ${h}

`).join(""):"N/A"}.
		`.slice(0,5e3),c=await t.prompt(u,{responseConstraint:l});return Array.from(new Set([...s,...(JSON.parse(c)?.tags||[]).map(v=>v.trim().toLowerCase()).filter(v=>v!=="")]))};var Sg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Add link',1),kg=S('<li class="p-1ljon4s"><!></li>'),xg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Edit link',1),Tg=S('<li class="p-1ljon4s"><!></li>'),Eg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),Pg=S('<li class="p-1ljon4s"><!></li>'),Ng=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),Ag=S('<li class="p-1ljon4s"><!></li>'),Dg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Mg=S('<li class="p-1ljon4s"><!></li>'),Ig=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Make copy',1),Lg=S('<li class="p-1ljon4s"><!></li>'),Rg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),Fg=S('<li class="p-1ljon4s"><!></li>'),zg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Og=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),Bg=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),jg=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),Hg=S(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Ug=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Wg=S("<!> <!> <!> <!> <!> <!> <!>",1),Vg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Os(t,e){Ce(e,!0);const{moveNoteToBin:a,moveNoteFromArchive:r,moveNoteToArchive:o,deleteNote:s,restoreNoteFromBin:i,checkDuplicatesExist:l,createNote:u}=Ot(),{clearDialogPages:c,replaceDialogPage:d,pushDialogPage:v}=zt(),{setFeedSearch:h}=$a(),{checkMobileSize:p}=ga();let m=Oe(e,"mode",3,"notes"),k=Oe(e,"shownMenu",15),_=D(!1),y=D(!1),E=D(!1),w=D(!1),C=D(!1),N=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const Y=async()=>{requestAnimationFrame(()=>{c(),setTimeout(()=>{a(e.noteId),tt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i(e.noteId),v(`${Pe.Note}?id=${e.noteId}`)}}})},300)})},z=async()=>{o(e.noteId),tt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{r(e.noteId)}}})},U=async()=>{r(e.noteId),tt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{o(e.noteId)}}})},R=()=>{i(e.noteId),tt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a(e.noteId)}}})},G=()=>{n(y)?(f(y,!1),Y()):n(C)?(f(C,!1),R()):n(E)?(f(E,!1),z()):n(w)&&(f(w,!1),U()),k(!1),f(_,!1)},Q=()=>{let de="";e.link?.url&&(de+=e.link.url+`
`),e.text&&(de+=`
`+e.text+`
`),navigator.clipboard.writeText(de),tt("Copied"),f(_,!0)},se=async()=>{f(_,!0),requestAnimationFrame(()=>{c(),setTimeout(()=>{s(e.noteId)},100)})},H=()=>{if(navigator.share){const de={};let ce="";e.link?.url&&(ce+=e.link.url+`
`),e.text&&(ce+=`
`+e.text+`
`),de.text=ce,navigator.share(de).catch(Ae=>{Ae.name!=="AbortError"&&console.error("Error sharing",Ae)})}f(_,!0)},O=()=>{if(navigator.share){const de={};e.link?.url&&(de.url=e.link.url),e.link?.title&&(de.title=e.link.title),navigator.share(de).catch(ce=>{ce.name!=="AbortError"&&console.error("Error sharing",ce)})}f(_,!0)},we=async()=>{f(_,!0);const de=e.noteId,ce=await u({link:ut(e.link),text:e.text||"",tags:e.tags?ut(e.tags):[]});d(`${Pe.Note}?id=${ce}`),tt("copy made",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(`${Pe.Note}?id=${de}`),setTimeout(()=>{s(ce)})}}})},ue=()=>{f(_,!0),e.link?.url&&(c(),h(e.link?.url))};let M=!1;var I=ye(),Z=P(I);{var oe=de=>{var ce=Vg(),Ae=P(ce);{let Fe=T(()=>`calc(100% - ${p()?"0px":"16px"})`),he=T(()=>p()?"auto":"10px"),ve=T(()=>p()?"10px":"auto");ge(Ae,()=>({"--bottom":"auto","--top":n(Fe),"--left":n(he),"--right":n(ve)})),Mr(Ae.lastChild,{get startClose(){return n(_)},onClosed:G,isMobile:M,children:(ze,W)=>{var te=Wg(),be=P(te);{var Ee=J=>{var le=kg(),ne=b(le);Ve(ne,{onClick:K=>{e.onAddLinkClick(K),f(_,!0)},dialogMode:M,children:(K,ie)=>{var ae=Sg(),me=P(ae);ge(me,()=>({"--size":"20px"})),_e(me.lastChild,{name:"add"}),g(K,ae)},$$slots:{default:!0}}),g(J,le)},fe=J=>{var le=Tg(),ne=b(le);Ve(ne,{onClick:K=>{e.onEditLinkClick(K),f(_,!0)},dialogMode:M,children:(K,ie)=>{var ae=xg(),me=P(ae);ge(me,()=>({"--size":"20px","--scale":"0.9"})),_e(me.lastChild,{name:"pen"}),g(K,ae)},$$slots:{default:!0}}),g(J,le)};B(be,J=>{e.link?.url?J(fe,!1):J(Ee)})}var re=A(be,2);{var ke=J=>{var le=Pg(),ne=b(le);Ve(ne,{onClick:Q,dialogMode:M,children:(K,ie)=>{var ae=Eg(),me=P(ae);ge(me,()=>({"--size":"20px"})),_e(me.lastChild,{name:"copy"}),g(K,ae)},$$slots:{default:!0}}),g(J,le)};B(re,J=>{e.text&&J(ke)})}var ee=A(re,2);{var De=J=>{var le=Ag(),ne=b(le);Ve(ne,{onClick:O,dialogMode:M,children:(K,ie)=>{var ae=Ng(),me=P(ae);{let Le=T(()=>e.text?"":"share");ge(me,()=>({"--size":"20px"})),_e(me.lastChild,{get name(){return n(Le)}})}g(K,ae)},$$slots:{default:!0}}),g(J,le)};B(ee,J=>{N&&e.link?.url&&J(De)})}var pe=A(ee,2);{var xe=J=>{var le=Mg(),ne=b(le);Ve(ne,{onClick:H,dialogMode:M,children:(K,ie)=>{var ae=Dg(),me=P(ae);ge(me,()=>({"--size":"20px"})),_e(me.lastChild,{name:"share"}),g(K,ae)},$$slots:{default:!0}}),g(J,le)};B(pe,J=>{N&&e.text&&J(xe)})}var x=A(pe,2);{var L=J=>{var le=Lg(),ne=b(le);Ve(ne,{onClick:we,dialogMode:M,children:(K,ie)=>{var ae=Ig(),me=P(ae);ge(me,()=>({"--size":"20px","--scale":"0.8"})),_e(me.lastChild,{name:"note"}),g(K,ae)},$$slots:{default:!0}}),g(J,le)};B(x,J=>{e.formMode==="edit"&&(e.text||e.link?.url)&&J(L)})}var F=A(x,2);{var V=J=>{var le=Fg(),ne=b(le);Ve(ne,{onClick:ue,dialogMode:M,children:(K,ie)=>{var ae=Rg(),me=P(ae);ge(me,()=>({"--size":"20px"})),_e(me.lastChild,{name:""}),g(K,ae)},$$slots:{default:!0}}),g(J,le)};B(F,J=>{e.link?.url&&l(e.noteId)&&J(V)})}var q=A(F,2);{var X=J=>{var le=ye(),ne=P(le);{var K=ie=>{var ae=Bg(),me=P(ae),Le=b(me);Ve(Le,{onClick:()=>{f(E,m()==="notes"),f(w,m()==="archive"),f(_,!0)},dialogMode:M,children:(qe,Re)=>{var Be=zg(),je=P(Be);{let wt=T(()=>m()==="archive"?"archive-cancel":"archive");ge(je,()=>({"--size":"20px","--scale":"0.9"})),_e(je.lastChild,{get name(){return n(wt)}})}var He=A(je);Ie(()=>vt(He,` ${m()==="archive"?"Unarchive":"Archive"}`)),g(qe,Be)},$$slots:{default:!0}});var Te=A(me,2),Me=b(Te);Ve(Me,{onClick:()=>{f(y,!0),f(_,!0)},dialogMode:M,children:(qe,Re)=>{var Be=Og(),je=P(Be),He=b(je);ge(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"bin"}),g(qe,Be)},$$slots:{default:!0}}),g(ie,ae)};B(ne,ie=>{(e.text||e.link?.url)&&ie(K)})}g(J,le)},$=J=>{var le=Ug(),ne=P(le),K=b(ne);Ve(K,{onClick:()=>{f(C,!0),f(_,!0)},dialogMode:M,children:(me,Le)=>{var Te=jg(),Me=P(Te),qe=b(Me);ge(qe,()=>({"--size":"20px"})),_e(qe.lastChild,{name:"bin-cancel"}),g(me,Te)},$$slots:{default:!0}});var ie=A(ne,2),ae=b(ie);Ve(ae,{onClick:se,dialogMode:M,dangerous:!0,children:(me,Le)=>{var Te=Hg(),Me=P(Te),qe=b(Me);ge(qe,()=>({"--size":"20px"})),_e(qe.lastChild,{name:"bin"}),g(me,Te)},$$slots:{default:!0}}),g(J,le)};B(q,J=>{m()==="notes"||m()==="archive"?J(X):J($,!1)})}g(ze,te)},$$slots:{default:!0}})}g(de,ce)};B(Z,de=>{k()&&de(oe)})}g(t,I),Se()}var qg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Kg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Yg=S("<!> <!> <!> <!>",1),Gg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Xg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Jg=S("<!> <!> <!>",1),Zg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Qg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),$g=S('<div class="a p-5sjfv5"><div class="b p-5sjfv5"><!></div> <div class="c p-5sjfv5"><!> <!></div></div>');function eh(t,e){Ce(e,!0);let a=Oe(e,"pinned",15,!1);const{checkMobileSize:r}=ga(),{getSearchParams:o,getHref:s}=Ht(),{getViewMode:i}=ua();let l=D(!1);const u=()=>!e.deletedAt&&!e.archivedAt?"notes":e.archivedAt?"archive":"bin";var c=$g(),d=b(c),v=b(d);{var h=y=>{var E=Yg(),w=P(E);{let z=T(()=>a()?"unpin":"pin");ln(w,{get title(){return n(z)},elem:"button",onclick:()=>{a(!a())},children:(U,R)=>{var G=qg(),Q=P(G);{let se=T(()=>a()?"pin-cancel":"pin");ge(Q,()=>({"--size":"20px"})),_e(Q.lastChild,{get name(){return n(se)}})}g(U,G)},$$slots:{default:!0}})}var C=A(w,2);ln(C,{title:"menu",elem:"button",onclick:()=>{f(l,!0)},children:(z,U)=>{var R=Kg(),G=P(R);ge(G,()=>({"--size":"20px","--rotate":"90deg"})),_e(G.lastChild,{name:"menu"}),g(z,R)},$$slots:{default:!0}});var N=A(C,2);{let z=T(u);Os(N,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(z)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(l)},set shownMenu(U){f(l,U,!0)}})}var Y=A(N,2);B(Y,z=>{}),g(y,E)},p=y=>{var E=Jg(),w=P(E);ln(w,{title:"menu",elem:"button",onclick:()=>{f(l,!0)},children:(Y,z)=>{var U=Gg(),R=P(U);ge(R,()=>({"--size":"24px","--rotate":"90deg"})),_e(R.lastChild,{name:"menu"}),g(Y,U)},$$slots:{default:!0}});var C=A(w,2);{let Y=T(u);Os(C,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(Y)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(l)},set shownMenu(z){f(l,z,!0)}})}var N=A(C,2);{let Y=T(()=>a()?"unpin":"pin");ln(N,{get title(){return n(Y)},elem:"button",onclick:()=>{a(!a())},children:(z,U)=>{var R=Xg(),G=P(R);{let Q=T(()=>a()?"pin-cancel":"pin");ge(G,()=>({"--size":"24px"})),_e(G.lastChild,{get name(){return n(Q)}})}g(z,R)},$$slots:{default:!0}})}g(y,E)};B(v,y=>{r()?y(h):y(p,!1)})}var m=A(d,2),k=b(m);{let y=T(()=>!e.canPrev);ln(k,{title:"previous",elem:"button",get disabled(){return n(y)},onclick:E=>{E.preventDefault(),e.onPrev&&e.onPrev()},children:(E,w)=>{var C=Zg(),N=P(C);ge(N,()=>({"--size":"20px"})),_e(N.lastChild,{name:"prev"}),g(E,C)},$$slots:{default:!0}})}var _=A(k,2);{let y=T(()=>!e.canNext);ln(_,{title:"next",elem:"button",get disabled(){return n(y)},onclick:E=>{E.preventDefault(),e.onNext&&e.onNext()},children:(E,w)=>{var C=Qg(),N=P(C);ge(N,()=>({"--size":"20px"})),_e(N.lastChild,{name:"next"}),g(E,C)},$$slots:{default:!0}})}g(t,c),Se()}var th=S('<div class="e p-vlmfrv">Note</div>'),nh=S("<span> </span>"),ah=S('<div class="i p-vlmfrv"><!></div>'),rh=S('<!> <!> <div class="a p-vlmfrv"><div class="b"><div class="c"><div class="d p-vlmfrv"><!> <div class="f p-vlmfrv" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"></div></div></div></div> <div class="g h p-vlmfrv"><!> <div class="j p-vlmfrv"><!></div></div></div>',1);function oh(t,e){Ce(e,!0);const{getLlmTagsEnabled:a,getPrevTags:r,getPageDataForTagsEnabled:o}=ua(),{pushDialogPage:s}=zt();let i=Oe(e,"link",15,void 0),l=Oe(e,"text",15,""),u=Oe(e,"tags",31,()=>ft([])),c=Oe(e,"pinned",11,!1),d=D(null),v=D(!1),h=D(!1),p=D(ft(new Set)),m=D(""),k=D(!1);const _=W=>{const te=mg(W.currentTarget.childNodes);l(te),f(m,te,!0)},y=W=>{W.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(v)&&(f(v,!1),W.preventDefault(),W.stopPropagation()),n(h)&&(f(h,!1),W.preventDefault(),W.stopPropagation()))};Ne(()=>(document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)));const E=(W,te)=>{i({url:W,title:te})},w=()=>{i(void 0)},C=W=>{u(W)},N=r(),Y=()=>{u([...new Set([...u(),...N])])};Ue(()=>{n(d)&&n(m)!==l()&&(n(d).textContent=l(),f(m,l(),!0))}),Ne(()=>{if(n(d)){if((Tn||Un)&&(e.mode==="edit"||navigator.userActivation.isActive===!1))return;n(d).focus();const W=document.createRange();W.selectNodeContents(n(d)),W.collapse(!1);const te=window.getSelection();te?.removeAllRanges(),te?.addRange(W)}});let z=D("unknown");Ne(()=>{(async()=>f(z,await yg(),!0))()});let U=T(a),R=null;const G=async()=>R||(R=await wg(),R),Q=async()=>{if(n(z)==="downloadable"||n(z)==="downloading"){s(Pe.Extension);return}f(k,!0);const W=await G();u(await Cg({llmSession:W,text:l(),link:i(),accessPageData:o(),rejectedTags:Array.from(n(p)),tags:u()})),f(k,!1)};Ne(()=>{const W=te=>{if(te.preventDefault(),!te.clipboardData)return;l(te.clipboardData.getData("text/plain"));const be=window.getSelection();if(be&&be.rangeCount>0){const Ee=be.getRangeAt(0);Ee.deleteContents(),Ee.insertNode(document.createTextNode(l())),Ee.collapse(!1),be.removeAllRanges(),be.addRange(Ee)}};return document.addEventListener("paste",W),()=>{document.removeEventListener("paste",W)}});var se=rh(),H=P(se);eh(H,{get noteId(){return e.noteId},get link(){return i()},get pinned(){return c()},get text(){return l()},get tags(){return u()},get deletedAt(){return e.deletedAt},get archivedAt(){return e.archivedAt},onAddLinkClick:()=>{f(h,!0)},onEditLinkClick:()=>{f(h,!0)},get canNext(){return e.canNext},get canPrev(){return e.canPrev},get onNext(){return e.onNext},get onPrev(){return e.onPrev},get formMode(){return e.mode}});var O=A(H,2);{var we=W=>{{let te=T(()=>i()?.url||""),be=T(()=>i()?.title||"");pg(W,{get url(){return n(te)},get title(){return n(be)},onChangeUrl:E,onDeleteUrl:w,get shownUrlInput(){return n(h)},set shownUrlInput(Ee){f(h,Ee,!0)}})}};B(O,W=>{(n(h)||i()?.url)&&W(we)})}var ue=A(O,2),M=b(ue),I=b(M),Z=b(I),oe=b(Z);{var de=W=>{var te=th();g(W,te)};B(oe,W=>{l()||W(de)})}var ce=A(oe,2);ce.__input=_,$e(ce,W=>f(d,W),()=>n(d));var Ae=A(M,2),Fe=b(Ae);{var he=W=>{var te=ah(),be=b(te);{var Ee=fe=>{var re=nh(),ke=b(re);Ie(ee=>vt(ke,`updated: ${ee??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),g(fe,re)};B(be,fe=>{e.updatedAt&&fe(Ee)})}g(W,te)};B(Fe,W=>{e.mode==="edit"&&W(he)})}var ve=A(Fe,2),ze=b(ve);{let W=T(()=>n(U)&&n(z)!=="unknown"&&n(z)!=="unavailable"),te=T(()=>e.mode==="add"&&N.length>0);vl(ze,{get selectedTags(){return u()},onRejectedTag:be=>{f(p,new Set([...n(p),be]),!0)},onChangeTags:C,get genTagsEnabled(){return n(W)},onGenTags:Q,get generatingTags(){return n(k)},onUsePreviousTags:Y,get previousTagsEnabled(){return n(te)},get shownTagInput(){return n(v)},set shownTagInput(be){f(v,be,!0)}})}g(t,se),Se()}pt(["input"]);function sh(t,e){Ce(e,!0);const{isInitedNotes:a,createNote:r,updateNote:o,deleteNote:s,getNoteById:i,pinNote:l}=Ot(),{getViewMode:u,setPrevTags:c}=ua(),{deleteSearchParam:d,getSearchParams:v}=Ht(),{replaceDialogPage:h}=zt();let p=D("loading"),m=D("idle"),k=D(""),_=D(!1),y=D(void 0),E=D(""),w=D(ft([])),C=D(-1),N=D(ft([]));const Y=()=>{{const M=v().get("url"),I=v().get("title"),Z=v().get("text");M&&f(y,{url:M,title:I||""},!0),Z&&(!M&&Jo(Z)?f(y,{url:Z,title:I||new URL(Z).hostname},!0):f(E,Z,!0)),d("url"),d("title"),d("text"),R();return}},z=T(()=>a()&&n(p)==="finish"),U=async()=>{if(n(y)?.title||n(y)?.url||n(E)||n(w).length>0){if(n(k)){const M=i(n(k));if(!M?.data)return;if((M.data.link?.url!==n(y)?.url||M.data.link?.title!==n(y)?.title||M.data.text!==n(E)||JSON.stringify(M.data.tags)!==JSON.stringify(n(w)))&&n(m)==="idle"){f(m,"loading");try{await o(n(k),{link:_n(n(y)),text:n(E),tags:n(w).slice()})}finally{f(m,"idle")}}}else if(n(m)==="idle"){f(m,"loading");try{f(k,await r({link:_n(n(y)),text:n(E),tags:n(w).slice()}),!0),h(`${Pe.NewNote}?id=${n(k)}`)}catch(M){console.error("Error creating note:",M)}finally{f(m,"idle")}}}else if(n(k)&&n(m)==="idle"){f(m,"loading");try{await s(n(k)),f(k,""),h(`${Pe.NewNote}`)}finally{f(m,"idle")}}};Ue(()=>{n(z)&&n(m)!=="loading"&&U()});const R=()=>{n(N).push({link:_n(n(y)),text:n(E),tags:n(w).slice()}),f(C,0),f(p,"finish")};Ue(()=>{n(z)&&n(m)!=="loading"&&n(p)==="finish"&&(n(E),n(y),n(w),Ft(()=>{const M=n(N)[0];M.link?.url!==n(y)?.url||M.link?.title!==n(y)?.title||M.text!==n(E)||JSON.stringify(M.tags)!==JSON.stringify(n(w))?(n(N)[1]={link:_n(n(y)),text:n(E),tags:n(w).slice()},f(C,1)):n(C)===1&&(f(N,n(N).slice(0,1),!0),f(C,0))}))}),Ue(()=>{n(z)&&n(m)!=="loading"&&n(k)&&(n(_),Ft(()=>{i(n(k))?.data.pinned!==n(_)&&l(n(k),n(_))}))}),Ne(()=>{Y()}),Ne(()=>()=>{n(w).length>0&&c([...n(w)])});let G=T(()=>n(C)>0),Q=T(()=>n(C)<n(N).length-1);const se=()=>{f(C,0);const M=n(N)[0];f(y,ut(M.link),!0),f(E,M.text,!0),f(w,ut(M.tags),!0)},H=()=>{if(n(C)>=n(N).length-1)return;f(C,1);const M=n(N)[n(C)];f(y,ut(M.link),!0),f(E,M.text,!0),f(w,ut(M.tags),!0)};Ue(()=>{console.log("historyIndex",n(C)),console.log("history",_n(n(N)))});var O=ye(),we=P(O);{var ue=M=>{{let I=T(()=>i(n(k))?.data.deletedAt),Z=T(()=>i(n(k))?.data.archivedAt);oh(M,{get deletedAt(){return n(I)},get archivedAt(){return n(Z)},get noteId(){return n(k)},get canNext(){return n(Q)},get canPrev(){return n(G)},onPrev:se,onNext:H,mode:"add",get link(){return n(y)},set link(oe){f(y,oe,!0)},get text(){return n(E)},set text(oe){f(E,oe,!0)},get tags(){return n(w)},set tags(oe){f(w,oe,!0)},get pinned(){return n(_)},set pinned(oe){f(_,oe,!0)}})}};B(we,M=>{n(z)&&M(ue)})}g(t,O),Se()}const ih="modulepreload",lh=function(t){return"/"+t},Bs={},St=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let u=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");o=u(a.map(c=>{if(c=lh(c),c in Bs)return;Bs[c]=!0;const d=c.endsWith(".css"),v=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${v}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":ih,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var ch=S('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function dh(t){var e=ch(),a=A(b(e),2);Lt(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=Ye("Reload");g(r,s)},$$slots:{default:!0}}),g(t,e)}var uh=S('<div class="p-uzefkz"><!></div>');function fh(t,e){Ce(e,!0);let a=D(!1);const{getDialogPageHeight:r}=ds(),o=T(r);Ne(()=>{const u=setTimeout(()=>{f(a,!0)},250);return()=>{clearTimeout(u)}});var s=uh(),i=b(s);{var l=u=>{Ia(u,{})};B(i,u=>{n(a)&&u(l)})}Ie(()=>Qa(s,`min-height: ${n(o)??""}px;`)),g(t,s),Se()}function Dt(t,e){Ce(e,!0);const a={},r=Object.assign({"./Pages/About.svelte":()=>St(()=>import("./aCRCt8xdH.js"),__vite__mapDeps([0,1])),"./Pages/AccessKeys.svelte":()=>St(()=>import("./aD9YYAxYB.js"),__vite__mapDeps([2,3,4,5])),"./Pages/Account.svelte":()=>St(()=>import("./aCU_GEGp-.js"),__vite__mapDeps([6,3,7])),"./Pages/Auth.svelte":()=>St(()=>import("./aDCcTRoSj.js"),__vite__mapDeps([8,9])),"./Pages/ChangeTags.svelte":()=>St(()=>import("./aC61IQfRU.js"),[]),"./Pages/ConfirmAccessKey.svelte":()=>St(()=>import("./aD8nvEudi.js"),__vite__mapDeps([10,4,3,11,12])),"./Pages/Exit.svelte":()=>St(()=>import("./aBizVjyCg.js"),__vite__mapDeps([13,14])),"./Pages/ExportData.svelte":()=>St(()=>import("./aCnuDGvTj.js"),__vite__mapDeps([15,16,17,18,19,20])),"./Pages/Extension.svelte":()=>St(()=>import("./aBoQpnbIE.js"),__vite__mapDeps([21,18,19,22])),"./Pages/ImportData.svelte":()=>St(()=>import("./aBDsfRuul.js"),__vite__mapDeps([23,24])),"./Pages/Install.svelte":()=>St(()=>import("./aB-8VPf_g.js"),__vite__mapDeps([25,26])),"./Pages/InstallSuccess.svelte":()=>St(()=>import("./aB2cso0kj.js"),__vite__mapDeps([27,28])),"./Pages/Note.svelte":()=>St(()=>import("./aBF2E0LoX.js"),__vite__mapDeps([29,30])),"./Pages/Settings.svelte":()=>St(()=>import("./aDpn_HOSt.js"),__vite__mapDeps([31,18,19,16,17,32])),"./Pages/Signin.svelte":()=>St(()=>import("./aaWz7CB7_.js"),__vite__mapDeps([33,4,3,11,34])),"./Pages/Signup.svelte":()=>St(()=>import("./aDJ-I7z2N.js"),__vite__mapDeps([35,11,4,3,34])),"./Pages/Subscription.svelte":()=>St(()=>import("./a94WR-L0A.js"),__vite__mapDeps([36,37])),"./Pages/Sync.svelte":()=>St(()=>import("./aDFoezELl.js"),__vite__mapDeps([38,39]))}),o=async l=>{const u=`./Pages/${l[0].toUpperCase()+l.slice(1)}.svelte`;if(!a[l]){if(r[u]){const c=r[u]();return a[l]={promise:c},a[l].module=await c,a[l].module}throw new Error(`Page ${l} not found`)}return a[l].module||await a[l].promise};var s=ye(),i=P(s);Kc(i,()=>o(e.page),l=>{fh(l,{})},(l,u)=>{const c=T(()=>n(u).default);var d=ye(),v=P(d);Jc(v,()=>n(c),(h,p)=>{p(h,{get params(){return e.params},get hidden(){return e.hidden}})}),g(l,d)},l=>{dh(l)}),g(t,s),Se()}var tr,pl,ml;class vh{constructor(e){Ge(this,tr);Bt(this,"data");Bt(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),ct(this,tr,pl).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,ct(this,tr,ml).call(this)),e}isEmpty(){return this.data.length===0}}tr=new WeakSet,pl=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},ml=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class gh{constructor(e,a){Bt(this,"heap");Bt(this,"done");Bt(this,"cache",[]);this.heap=new vh(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var hh=S("<span>Back to notes</span>"),ph=S('<div class="c p-130fajz">No notes in bin</div> <div class="d p-130fajz"><!></div>',1),mh=S("<span>Back to notes</span>"),_h=S('<div class="c p-130fajz">No notes in archive</div> <div class="d p-130fajz"><!></div>',1),wh=S('<p class="f">No notes in bin</p>'),yh=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),bh=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Ch=S('<div class="g p-130fajz"><div class="d p-130fajz"><!></div> <div>or</div> <div class="d p-130fajz"><!></div></div>'),Sh=S('<div class="e p-130fajz"><!></div>'),kh=S('<div class="h"><div class="c p-130fajz">No notes found</div></div>'),xh=S('<div class="i p-130fajz"><ul class="p-130fajz"></ul></div>'),Th=S('<div class="a p-130fajz"><div class="b p-130fajz"><!></div></div>');function Eh(t,e){Ce(e,!0);const{getCountDialog:a}=Qt(),{getScrollContainer:r}=vo(),{createHandleClickDialogPage:o,createDialogPageHref:s}=zt(),{getSelectedTags:i}=qn(),{getFeedOrder:l}=Hi(),{checkNotesInArchive:u,checkNotesInBin:c,checkNotes:d,isInitedNotes:v}=Ot(),{getSelectedMetaTags:h}=fo(),{replaceSearchParams:p,getHref:m}=Ht();$a();const{getFiltredNotesLength:k,getFiltredNotes:_,getUpdatedFiltredNotesTimestamp:y}=Ma(),{getFeedSearch:E}=$a();let w="keyboard",C=T(h),N=T(k),Y=T(_),z=T(y),U=T(v),R=54,G=D(0),Q=D(0),se=D(0),H=D(null),O=T(r),we=null,ue=null,M=T(()=>n(C).has(ot.ARCHIVED)?"archive":n(C).has(ot.BIN)?"bin":"notes");const I=T(i);Ue(()=>{n(I),n(Ae),n(O)?.scrollTo(0,0)});const{enable:Z}=cs(),oe=()=>{Z(),we||(we=requestAnimationFrame(()=>{const pe=n(O)?.scrollTop||0;f(se,pe,!0);const xe=Math.ceil(n(G)/R);f(Q,Math.floor(pe/(R*xe))*(R*xe)),we=null}))},de=()=>{ue||(ue=requestAnimationFrame(()=>{f(G,window.innerHeight-180||0,!0);const pe=n(O)?.scrollTop||0;f(se,pe,!0);const xe=Math.ceil(n(G)/R);f(Q,Math.floor(pe/(R*xe))*(R*xe)),ue=null}))};Ne(()=>{const pe=xe=>{if(!(!Iv()&&qr()===void 0)&&!(a()>0)&&(xe.key==="ArrowDown"||xe.key==="ArrowUp")){if(xe.preventDefault(),xe.key==="ArrowDown"){const x=qr(),L=n(ve).findIndex(q=>q.id===x),F=be(),V=Ee();if(!x||L===-1)vn(F?.id);else if(L<=V.index&&L>=F.index)Fs()&&L!==-1&&te(L+1)&&n(O)&&(n(O).scrollTop=Math.floor(n(O).scrollTop/R)*R+R);else if(L>V.index&&!te(L-1)&&te(L)){n(O)&&(n(O).scrollTop=Math.ceil(n(O).scrollTop/R)*R+R);const q=Fs();vn(q)}else vn(F?.id)}else if(xe.key==="ArrowUp"){const x=qr(),L=n(ve).findIndex(q=>q.id===x),F=be(),V=Ee();if(!x||L===-1)vn(V?.id);else if(L<=V.index&&L>=F.index)zs()&&L!==-1&&te(L-1)&&n(O)&&(n(O).scrollTop=Math.ceil(n(O).scrollTop/R)*R-R);else if(L<F.index&&!te(L+1)&&te(L)){n(O)&&(n(O).scrollTop=n(W)+L*R-R);const q=zs();vn(q)}else vn(V?.id)}hl()||Zo()}};return document.addEventListener("keydown",pe),()=>{document.removeEventListener("keydown",pe)}}),Ne(()=>{de(),oe()});const ce=()=>{oe()};Ue(()=>{E()!==""&&w==="keyboard"&&(vn(be().id),Zo())}),Ue(()=>(n(O)?.addEventListener("scroll",ce),window.addEventListener("resize",de),()=>{n(O)?.removeEventListener("scroll",ce),window.removeEventListener("resize",de)}));const Ae=T(l);Ue(()=>{n(Ae),n(z),f(H,new gh(n(Y),(pe,xe)=>{if(!pe||!xe||!pe.data||!xe.data)return 0;if(pe.data.pinned&&!xe.data.pinned)return-1;if(!pe.data.pinned&&xe.data.pinned)return 1;if(pe.data.pinned&&xe.data.pinned){if(pe.data.pinned<xe.data.pinned)return 1;if(pe.data.pinned>xe.data.pinned)return-1}const x=(L,F)=>L.data.text||F.data.text?(L.data.text||"").localeCompare(F.data.text||""):(L.data.link?.title||"").localeCompare(F.data.link?.title||"");switch(n(Ae)){case"newest":return pe.data.createdAt<xe.data.createdAt?1:pe.data.createdAt>xe.data.createdAt?-1:x(pe,xe);case"oldest":return pe.data.createdAt>xe.data.createdAt?1:pe.data.createdAt<xe.data.createdAt?-1:x(pe,xe);case"AtoZ":return x(pe,xe);case"ZtoA":return x(xe,pe);case"updatedNewest":return pe.data.updatedAt<xe.data.updatedAt?1:pe.data.updatedAt>xe.data.updatedAt?-1:x(pe,xe);default:return 0}}),!0)});const Fe=T(()=>n(N)*R);let ve=T(()=>{n(z);const pe=Math.ceil(n(G)/R);let xe=Math.floor(n(Q)/R);return xe=xe-Math.min(xe,pe),n(H)?.get(xe,xe+pe*3)||[]}),ze=T(()=>R*Math.ceil(n(G)/R));const W=T(()=>n(Q)-Math.min(n(Q),n(ze))),te=pe=>pe*R<n(se)-n(W)-R/2||pe*R>n(se)-n(W)+Math.floor(n(G)/R)*R,be=()=>{for(let pe=0;pe<n(ve).length;pe++)if(!te(pe))return{index:pe,id:n(ve)[pe].id};return{index:-1,id:void 0}},Ee=()=>{for(let pe=n(ve).length-1;pe>=0;pe--)if(!te(pe))return{index:pe,id:n(ve)[pe].id};return{index:-1,id:void 0}};Ne(()=>{document.addEventListener("mousemove",()=>{w="mouse"}),document.addEventListener("keydown",()=>{w="keyboard"})});var fe=Th(),re=b(fe),ke=b(re);{var ee=pe=>{Ia(pe,{})},De=pe=>{var xe=ye(),x=P(xe);{var L=V=>{var q=ph(),X=A(P(q),2),$=b(X);{let J=T(()=>m(""));Lt($,{element:"a",get href(){return n(J)},onClick:le=>{le.preventDefault(),p("")},children:(le,ne)=>{var K=hh();g(le,K)},$$slots:{default:!0}})}g(V,q)},F=V=>{var q=ye(),X=P(q);{var $=le=>{var ne=_h(),K=A(P(ne),2),ie=b(K);{let ae=T(()=>m(""));Lt(ie,{element:"a",get href(){return n(ae)},onClick:me=>{me.preventDefault(),p("")},children:(me,Le)=>{var Te=mh();g(me,Te)},$$slots:{default:!0}})}g(le,ne)},J=le=>{var ne=ye(),K=P(ne);{var ie=me=>{var Le=Sh(),Te=b(Le);{var Me=Re=>{var Be=wh();g(Re,Be)},qe=Re=>{var Be=Ch(),je=b(Be),He=b(je);{let st=T(()=>s(Pe.NewNote)),lt=T(()=>o(Pe.NewNote));Lt(He,{element:"a",get href(){return n(st)},get onClick(){return n(lt)},children:(mt,Pn)=>{var Tt=yh(),At=P(Tt);ge(At,()=>({"--size":"18px","--color":"#b0b0b0"})),_e(At.lastChild,{name:"plus"}),g(mt,Tt)},$$slots:{default:!0}})}var wt=A(je,4),at=b(wt);{let st=T(()=>s(Pe.ImportData)),lt=T(()=>o(Pe.ImportData));Lt(at,{element:"a",get href(){return n(st)},get onClick(){return n(lt)},children:(mt,Pn)=>{var Tt=bh(),At=P(Tt);ge(At,()=>({"--size":"18px","--color":"#b0b0b0"})),_e(At.lastChild,{name:"import"}),g(mt,Tt)},$$slots:{default:!0}})}g(Re,Be)};B(Te,Re=>{n(M)==="bin"?Re(Me):Re(qe,!1)})}g(me,Le)},ae=me=>{var Le=ye(),Te=P(Le);{var Me=Re=>{var Be=kh();g(Re,Be)},qe=Re=>{var Be=xh(),je=b(Be);Bn(je,23,()=>n(ve),He=>He.data,(He,wt,at)=>{var st=ye(),lt=P(st);{var mt=Pn=>{{let Tt=T(()=>n(ve)[n(at)+1]?.id),At=T(()=>n(ve)[n(at)-1]?.id),mo=T(()=>te(n(at))),_o=T(()=>(n(at)+5)*R<n(se)-n(W)-R/2||(n(at)+5)*R>n(se)-n(W)+Math.floor(n(G)/R)*R);qv(Pn,{get nextNoteId(){return n(Tt)},get prevNoteId(){return n(At)},get mode(){return n(M)},get focusHidden(){return n(mo)},get showMenuUp(){return n(_o)},get noteId(){return n(wt).id},get noteData(){return n(wt).data}})}};B(lt,Pn=>{n(wt).data&&Pn(mt)})}g(He,st)}),Ie(He=>{Qa(Be,He),Qa(je,`transform: translateY(${n(W)??""}px);`)},[()=>`--minHeight: ${Math.max((n(Fe)>n(G),n(Fe)),0)}px`]),g(Re,Be)};B(Te,Re=>{n(ve).length===0?Re(Me):Re(qe,!1)},!0)}g(me,Le)};B(K,me=>{!c()&&!u()&&!d()?me(ie):me(ae,!1)},!0)}g(le,ne)};B(X,le=>{n(M)==="archive"&&!u()?le($):le(J,!1)},!0)}g(V,q)};B(x,V=>{n(M)==="bin"&&!c()?V(L):V(F,!1)},!0)}g(pe,xe)};B(ke,pe=>{n(U)?pe(De,!1):pe(ee)})}g(t,fe),Se()}var Ph=S('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Nh(t){var e=Ph(),a=A(P(e),2),r=b(a);Eh(r,{}),g(t,e)}function Ah(t,e){Ce(e,!0);const a=Kn();let r=Oe(e,"animationRef",7),o=Oe(e,"dialog",7);fl(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let c=0,d=0,v=()=>1;if(r().current){r().current.pause();let p=Number(r().current.currentTime);yr()&&(p=Number(p)+50,r().current.currentTime=Math.min(Math.max(jn-1,p),p));const m=r().current.effect?.getComputedTiming().progress||0;v=()=>m,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(p=>requestAnimationFrame(p)),d=1-v();const h=d*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-d)*.1}`),a.swipingRatio=Math.abs(1-d)*25,a.isSwiping=!0,a.duration=0,o().style.transform=`translate3d(${h}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:c,currentPosition:h,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:c,width:d})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-c/d)*.1}`),o().style.transform=`translate3d(${c}px, 0, 0)`,a.swipingRatio=Math.abs(1-c/d)*25)},onFinish:({swipeVelocity:c,currentPosition:d,width:v,actionThreshold:h,initialPosition:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const m=()=>Math.abs(p+d)/v*100;let k=null;if(c<=-ca?k="open":c>=ca?k="close":k=Math.abs(m())>h?"close":"open",r().progress=ul(m()/100),k==="close"){const _=(1-(r().progress||0))*jn;a.duration=_/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=0,e.onClose()}else{const _=(r().progress||1)*jn;a.duration=_/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=25,e.onOpen()}}}),Se()}var Dh=S('<div class="d p-8xr118"> </div>'),Mh=S('<button class="e f p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Ih=S('<a class="e g p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),Lh=S('<div><div class="a p-8xr118"><div class="b p-8xr118"><div class="c p-8xr118"><!> <!> <!></div></div></div> <!> <!></div>'),Rh=S("<dialog><!></dialog> <!>",1);function Fh(t,e){Ce(e,!0);const{isScrolling:a,enable:r}=cs();let o=D(null),s=D(null),i={};const l=Kn(),{checkLeftEnd:u,checkLeftStart:c,setLeftEnd:d,setLeftStart:v,getCountDialog:h}=Qt(),p=T(c),m=T(u);let k=T(()=>l.working);const _=()=>{e.dialogState!=="opened"&&e.onStartOpening()},y=()=>{e.onClose()},E=()=>{e.onSwipe()},w=se=>{se.preventDefault(),y()};Ne(()=>(n(o)?.addEventListener("close",y),n(o)?.addEventListener("cancel",w),()=>{n(o)?.removeEventListener("close",y),n(o)?.removeEventListener("cancel",w)})),Ue(()=>{h()>0&&(l.swipingRatio=25)}),Ue(()=>{e.dialogState==="opening"?Ft(()=>{requestAnimationFrame(()=>{if(!n(o))return;const se=(i.progress||1)*jn,H=n(o).style.transform||`translate3d(${n(p)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const O=n(o)?.animate([{transform:H},{transform:"translate3d(0, 0, 0)"}],{duration:se,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=O,O&&(O.onfinish=()=>{e.onOpened(),l.swipingRatio=25,n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=la().duration,O.cancel(),i.current=void 0,i.progress=void 0,n(p)&&v(!1)})})}):e.dialogState==="closing"&&Ft(()=>{requestAnimationFrame(()=>{if(!n(o))return;l.swipingRatio=0;const se=(1-(i.progress||0))*jn,H=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const O=n(o)?.animate([{transform:H},{transform:`translate3d(${n(m)?"-100%":"100%"}, 0, 0)`}],{duration:se,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=O,O&&(O.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=la().duration,O.cancel(),i.current=void 0,i.progress=void 0,n(m)&&d(!1)})})})});const C=()=>{r()},N=T(a);Ne(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),yr()&&n(o).getBoundingClientRect(),!n(k)){e.onOpened();return}e.onStartOpening()}});var Y=Rh(),z=P(Y),U=b(z);{var R=se=>{var H=Lh(),O=b(H),we=b(O),ue=b(we),M=b(ue);{var I=ve=>{var ze=Dh(),W=b(ze);Ie(()=>vt(W,e.title)),g(ve,ze)};B(M,ve=>{e.title&&ve(I)})}var Z=A(M,2);{var oe=ve=>{var ze=Mh();ze.__click=y;var W=b(ze);ge(W,()=>({"--size":"28px"})),_e(W.lastChild,{name:"back"});var te=A(W,2);_t(te,{children:(be,Ee)=>{var fe=Ye("back");g(be,fe)}}),g(ve,ze)};B(Z,ve=>{e.blocked||ve(oe)})}var de=A(Z,2);{var ce=ve=>{var ze=Ih();ze.__click=function(...be){e.onOpenWindow?.apply(this,be)};var W=b(ze);ge(W,()=>({"--scale":"0.7","--size":"28px"})),_e(W.lastChild,{name:"open-window"});var te=A(W,2);_t(te,{children:(be,Ee)=>{var fe=Ye("open window");g(be,fe)}}),Ie(()=>dt(ze,"href",e.openWindowHref)),g(ve,ze)};B(de,ve=>{e.onOpenWindow&&ve(ce)})}var Ae=A(O,2);We(Ae,()=>e.children);var Fe=A(Ae,2);{var he=ve=>{go(ve,{})};B(Fe,ve=>{e.dialogState==="opened"&&ve(he)})}$e(H,ve=>f(s,ve),()=>n(s)),Ie(()=>et(H,1,nt({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-8xr118")),Zt("scroll",H,C),g(se,H)};B(U,se=>{e.dialogState!=="preOpening"&&se(R)})}$e(z,se=>f(o,se),()=>n(o));var G=A(z,2);{var Q=se=>{Ah(se,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:_,onClose:y,onSwipe:E,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};B(G,se=>{n(s)&&!n(N)&&!e.blocked&&!e.hidden&&se(Q)})}Ie(()=>et(z,1,nt({h:!0,i:n(k),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(p),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-8xr118")),g(t,Y),Se()}pt(["click"]);function zh(t,e){Ce(e,!0);let a=Oe(e,"hidden",3,!1),r=Oe(e,"onClosed",3,()=>{}),o=D(0);Ne(()=>{const y=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",y),y(),()=>{window.removeEventListener("resize",y)}});const{dialogDec:s,dialogInc:i}=Qt(),l=Kn();Ne(()=>(i(),()=>{s()}));let u=D("closed");const c=()=>{f(u,"opening")},d=()=>{f(u,"swiping")},v=()=>{f(u,"opened")},h=()=>{e.onClose(),f(u,"closing")},p=()=>{f(u,"closed"),r()()};Ue(()=>{e.shown&&n(u)==="closed"?f(u,"preOpening"):!e.shown&&n(u)==="opened"&&f(u,"closing")}),Ue(()=>{n(u)==="closed"?(l.swipingRatio=0,l.duration=.2):(n(u)==="opened"||n(u)==="opening")&&(l.duration=.2,l.swipingRatio=25)});var m=ye(),k=P(m);{var _=y=>{Fh(y,{get dialogWidth(){return n(o)},get dialogState(){return n(u)},get title(){return e.title},onStartOpening:c,onOpened:v,onClose:h,onClosed:p,onSwipe:d,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(E,w)=>{var C=ye(),N=P(C);We(N,()=>e.children),g(E,C)},$$slots:{default:!0}})};B(k,y=>{n(u)!=="closed"&&y(_)})}g(t,m),Se()}const Oh=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};Ne(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),Ne(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var Bh=S('<button class="c d p-zlbg3d"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),jh=S('<div class="e p-zlbg3d"> </div>'),Hh=S('<button class="c f p-zlbg3d"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Uh=S('<dialog><div><div class="a p-zlbg3d"><div class="b p-zlbg3d"><div><!></div> <!> <div><!></div></div></div> <div class="g p-zlbg3d"><!></div></div> <!></dialog> <!>',1);function Wh(t,e){Ce(e,!0);let a=Oe(e,"blockedDialog",3,!1),r=Oe(e,"hiddenDialog",3,!1),o=Oe(e,"isDesktopAnimationOff",3,!1),s=D(null),i=D(null),l=D(!1),u=D(null);Oh({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const c=Kn();Ue(()=>{e.stateDialog==="closing"&&(c.working?n(i)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const{getDialogPageHeight:d}=ds(),v=T(d);Ne(()=>{setTimeout(()=>{f(l,!0)},50)});var h=Uh(),p=P(h),m=b(p),k=b(m),_=b(k),y=b(_),E=b(y);{var w=H=>{var O=Bh();O.__click=()=>{e.onStartBack()};var we=b(O);ge(we,()=>({"--size":"24px"})),_e(we.lastChild,{name:"back"});var ue=A(we,2);_t(ue,{children:(M,I)=>{var Z=Ye("back");g(M,Z)}}),g(H,O)};B(E,H=>{(!(a()||r())||a())&&e.onStartBack&&H(w)})}var C=A(y,2);{var N=H=>{var O=jh(),we=b(O);Ie(()=>vt(we,e.title)),g(H,O)};B(C,H=>{e.title&&H(N)})}var Y=A(C,2),z=b(Y);{var U=H=>{var O=Hh();O.__click=()=>{e.onStartClose()};var we=b(O);ge(we,()=>({"--size":"24px"})),_e(we.lastChild,{name:"close"});var ue=A(we,2);_t(ue,{children:(M,I)=>{var Z=Ye("close");g(M,Z)}}),g(H,O)};B(z,H=>{a()||r()||H(U)})}var R=A(k,2),G=b(R);We(G,()=>e.children),$e(m,H=>f(i,H),()=>n(i));var Q=A(m,2);go(Q,{get ref(){return n(u)},set ref(H){f(u,H,!0)}}),$e(p,H=>f(s,H),()=>n(s));var se=A(p,2);us(se,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose},get notificationRef(){return n(u)},set notificationRef(H){f(u,H,!0)}}),Ie(()=>{et(p,1,nt({h:!0,i:e.stateDialog==="open",j:n(l),k:c.working,l:o(),m:r()}),"p-zlbg3d"),Qa(m,`height: ${n(v)+74}px`),et(m,1,nt({n:!0,i:e.stateDialog==="open",j:n(l),k:c.working,l:o()}),"p-zlbg3d")}),g(t,h),Se()}pt(["click"]);const Vh=({onStartClose:t,onClosed:e})=>{let a=D("close");return{get state(){return n(a)},set state(i){f(a,i,!0)},handleStartClose:(i=!1)=>{i||(f(a,"closing"),t?.())},handleOpen:()=>{f(a,"open")},handleClose:()=>{f(a,"close"),e?.()}}};function qh(t,e){Ce(e,!0);let a=Oe(e,"blockedDialog",3,!1),r=Oe(e,"hiddenDialog",3,!1),o=Oe(e,"onStartClose",3,()=>{}),s=Oe(e,"onClosed",3,()=>{}),i=Vh({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:l,dialogInc:u}=Qt();Ne(()=>(u(),()=>{l()})),Ue(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const c=p=>{p.key==="Escape"&&a()&&(p.preventDefault(),p.stopPropagation())};Ne(()=>(document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}));var d=ye(),v=P(d);{var h=p=>{Wh(p,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(m,k)=>{var _=ye(),y=P(_);We(y,()=>e.children),g(m,_)},$$slots:{default:!0}})};B(v,p=>{i.state!=="close"&&p(h)})}g(t,d),Se()}const js=(t,e=Je,a=Je,r)=>{let o=Er(()=>Il(r?.(),!1));var s=ye(),i=P(s);{var l=c=>{Ct(c,{children:(d,v)=>{Dt(d,{get hidden(){return n(o)},get page(){return Pe.Settings}})},$$slots:{default:!0}})},u=c=>{var d=ye(),v=P(d);{var h=m=>{Ct(m,{children:(k,_)=>{sh(k,{})},$$slots:{default:!0}})},p=m=>{var k=ye(),_=P(k);{var y=w=>{Ct(w,{children:(C,N)=>{Dt(C,{get params(){return a()},get hidden(){return n(o)},get page(){return Pe.Note}})},$$slots:{default:!0}})},E=w=>{var C=ye(),N=P(C);{var Y=U=>{Ct(U,{children:(R,G)=>{Dt(R,{get hidden(){return n(o)},get page(){return Pe.ImportData}})},$$slots:{default:!0}})},z=U=>{var R=ye(),G=P(R);{var Q=H=>{Ct(H,{children:(O,we)=>{Dt(O,{get hidden(){return n(o)},get page(){return Pe.ExportData}})},$$slots:{default:!0}})},se=H=>{var O=ye(),we=P(O);{var ue=I=>{Ct(I,{children:(Z,oe)=>{cg(Z,{})},$$slots:{default:!0}})},M=I=>{var Z=ye(),oe=P(Z);{var de=Ae=>{Ct(Ae,{children:(Fe,he)=>{Dt(Fe,{get hidden(){return n(o)},get page(){return Pe.Install}})},$$slots:{default:!0}})},ce=Ae=>{var Fe=ye(),he=P(Fe);{var ve=W=>{Ct(W,{children:(te,be)=>{Dt(te,{get hidden(){return n(o)},get page(){return Pe.InstallSuccess}})},$$slots:{default:!0}})},ze=W=>{var te=ye(),be=P(te);{var Ee=re=>{Ct(re,{children:(ke,ee)=>{Dt(ke,{get hidden(){return n(o)},get page(){return Pe.Auth}})},$$slots:{default:!0}})},fe=re=>{var ke=ye(),ee=P(ke);{var De=xe=>{Ct(xe,{children:(x,L)=>{Dt(x,{get hidden(){return n(o)},get page(){return Pe.Signup}})},$$slots:{default:!0}})},pe=xe=>{var x=ye(),L=P(x);{var F=q=>{Ct(q,{children:(X,$)=>{Dt(X,{get hidden(){return n(o)},get page(){return Pe.Signin}})},$$slots:{default:!0}})},V=q=>{var X=ye(),$=P(X);{var J=ne=>{Ct(ne,{children:(K,ie)=>{Dt(K,{get hidden(){return n(o)},get page(){return Pe.AccessKeys}})},$$slots:{default:!0}})},le=ne=>{var K=ye(),ie=P(K);{var ae=Le=>{Ct(Le,{children:(Te,Me)=>{Dt(Te,{get hidden(){return n(o)},get page(){return Pe.Account}})},$$slots:{default:!0}})},me=Le=>{var Te=ye(),Me=P(Te);{var qe=Be=>{Ct(Be,{children:(je,He)=>{Dt(je,{get hidden(){return n(o)},get page(){return Pe.ConfirmAccessKey}})},$$slots:{default:!0}})},Re=Be=>{var je=ye(),He=P(je);{var wt=st=>{Ct(st,{children:(lt,mt)=>{Dt(lt,{get hidden(){return n(o)},get page(){return Pe.Exit}})},$$slots:{default:!0}})},at=st=>{var lt=ye(),mt=P(lt);{var Pn=Tt=>{var At=ye(),mo=P(At);{var _o=La=>{Ct(La,{children:(Ir,fs)=>{Dt(Ir,{get hidden(){return n(o)},get page(){return Pe.Sync}})},$$slots:{default:!0}})},_l=La=>{var Ir=ye(),fs=P(Ir);{var wl=Ra=>{Ct(Ra,{children:(Lr,vs)=>{Dt(Lr,{get hidden(){return n(o)},get page(){return Pe.Subscription}})},$$slots:{default:!0}})},yl=Ra=>{var Lr=ye(),vs=P(Lr);{var bl=Fa=>{Ct(Fa,{children:(wo,Sl)=>{Dt(wo,{get hidden(){return n(o)},get page(){return Pe.About}})},$$slots:{default:!0}})},Cl=Fa=>{Ct(Fa,{children:(wo,Sl)=>{rg(wo,{})},$$slots:{default:!0}})};B(vs,Fa=>{e()===Pe.About?Fa(bl):Fa(Cl,!1)},!0)}g(Ra,Lr)};B(fs,Ra=>{e()===Pe.Subscription?Ra(wl):Ra(yl,!1)},!0)}g(La,Ir)};B(mo,La=>{e()===Pe.Sync?La(_o):La(_l,!1)},!0)}g(Tt,At)};B(mt,Tt=>{e(),Pe.Extension,Tt(Pn,!1)},!0)}g(st,lt)};B(He,st=>{e()===Pe.Exit?st(wt):st(at,!1)},!0)}g(Be,je)};B(Me,Be=>{e()===Pe.ConfirmAccessKey?Be(qe):Be(Re,!1)},!0)}g(Le,Te)};B(ie,Le=>{e()===Pe.Account?Le(ae):Le(me,!1)},!0)}g(ne,K)};B($,ne=>{e()===Pe.AccessKeys?ne(J):ne(le,!1)},!0)}g(q,X)};B(L,q=>{e()===Pe.Signin?q(F):q(V,!1)},!0)}g(xe,x)};B(ee,xe=>{e()===Pe.Signup?xe(De):xe(pe,!1)},!0)}g(re,ke)};B(be,re=>{e()===Pe.Auth?re(Ee):re(fe,!1)},!0)}g(W,te)};B(he,W=>{e()===Pe.InstallSuccess?W(ve):W(ze,!1)},!0)}g(Ae,Fe)};B(oe,Ae=>{e()===Pe.Install?Ae(de):Ae(ce,!1)},!0)}g(I,Z)};B(we,I=>{e()===Pe.AccountSetup?I(ue):I(M,!1)},!0)}g(H,O)};B(G,H=>{e()===Pe.ExportData?H(Q):H(se,!1)},!0)}g(U,R)};B(N,U=>{e()===Pe.ImportData?U(Y):U(z,!1)},!0)}g(w,C)};B(_,w=>{e()===Pe.Note?w(y):w(E,!1)},!0)}g(m,k)};B(v,m=>{e()===Pe.NewNote?m(h):m(p,!1)},!0)}g(c,d)};B(i,c=>{e()===Pe.Settings?c(l):c(u,!1)})}g(t,s)};var Kh=S("<!> <!>",1);function Yh(t,e){Ce(e,!0);let a=T(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:r,checkClosableDialog:o}=Qt(),{sidebarClose:s,getSidebarState:i}=Ar(),l=T(r),u=T(o),{getDialogPages:c}=zt(),{getAccount:d}=ls();let v=T(c),h=T(()=>d()!==void 0);const{checkMobileSize:p}=ga();let m=D(ft([]));const k=T(p),{clearDialogPages:_,popDialogPage:y}=zt(),{checkLeftStart:E}=Qt();let w=T(E);Ue(()=>{c().length>0&&i()!=="closed"&&setTimeout(()=>{s()},60)});const C=()=>{y()},N=()=>{_()};Ue(()=>{n(v),n(k),Ft(()=>{if(n(k))n(v).length>=n(m).length||n(w)?f(m,n(v).map(H=>({page:H,shown:!0})),!0):f(m,n(m).map((H,O)=>({page:H.page,shown:O<n(v).length})),!0);else if(n(v).length>=n(m).length)f(m,n(v).map(H=>({page:H,shown:!0})),!0);else{if(n(v).length===0){f(m,[{page:n(m)[n(m).length-1].page,shown:!1}],!0);return}f(m,n(v).map(H=>({page:H,shown:!0})),!0)}})});const Y=()=>{f(m,n(v).map(H=>({page:H,shown:!0})),!0)};var z=Kh(),U=P(z);{var R=H=>{Nh(H)};B(U,H=>{n(h)&&H(R)})}var G=A(U,2);{var Q=H=>{var O=ye(),we=P(O);Bn(we,19,()=>n(m),ue=>ue.page.split("?")[0],(ue,M,I)=>{const Z=T(()=>n(M).page.split("?")[1]),oe=T(()=>n(M).page.split("?")[0]),de=T(()=>n(I)!==n(m).length-1&&!!n(m)[n(I)+1]?.shown),ce=T(()=>n(I)===0);{let Ae=T(()=>As[n(oe)]||""),Fe=T(()=>n(l)||n(ce)&&!n(u)),he=T(()=>({...n(oe)!==Pe.NewNote&&n(oe)!==Pe.Note?n(a):{}}));zh(ue,Oo({get shown(){return n(M).shown},get title(){return n(Ae)},get hidden(){return n(de)},get blocked(){return n(Fe)},onClose:C,onClosed:Y},()=>n(he),{children:(ve,ze)=>{js(ve,()=>n(oe),()=>n(Z),()=>n(de))},$$slots:{default:!0}}))}}),g(H,O)},se=H=>{var O=ye(),we=P(O);{var ue=M=>{const I=T(()=>n(m)[n(m).length-1].page.split("?")[1]),Z=T(()=>n(m)[n(m).length-1].page.split("?")[0]),oe=T(()=>n(m)[n(m).length-1].shown),de=T(()=>n(m).length===1);{let ce=T(()=>As[n(Z)]||""),Ae=T(()=>n(l)||!n(u)),Fe=T(()=>n(l)||n(de)?void 0:C);qh(M,{get shownDialog(){return n(oe)},get title(){return n(ce)},get blockedDialog(){return n(Ae)},hiddenDialog:!1,get onStartBack(){return n(Fe)},onStartClose:N,onClosed:Y,children:(he,ve)=>{js(he,()=>n(Z),()=>n(I))},$$slots:{default:!0}})}};B(we,M=>{n(m).length>0&&M(ue)},!0)}g(H,O)};B(G,H=>{p()?H(Q):H(se,!1)})}g(t,z),Se()}function Gh(t,e){Ce(e,!1);let a=0;Ne(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),ss(),Se()}const Xh=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;var Jh=S('<div><button class="d p-bn1wva"><!> <span class="e p-bn1wva"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),Zh=S('<!> <!> <!> <!> <main><div class="a p-bn1wva"><div class="b p-bn1wva"><!></div></div> <div class="c p-bn1wva"><!></div></main> <!>',1);function Qh(t,e){Ce(e,!0);const{replaceSearchParams:a,getHref:r,getSearchParams:o}=Ht(),{hasDialogPage:s}=zt(),{setScrollContainer:i}=vo(),{getAccount:l,init:u}=ls(),{isInitedNotes:c}=Ot(),{isInitedSettings:d}=ua(),{getDialogPages:v}=zt(),{createBroadcastChannel:h,tabId:p}=uo(),m=h(),{getSidebarState:k}=Ar(),{setClosableDialog:_}=Qt(),{getViewMode:y}=ua(),E=()=>{Xh()?a(`${tn}=${Pe.AccountSetup}`):a(`${tn}=${Pe.Install}`)};Ne(()=>{u(De=>{De===void 0?E():(s(Pe.AccountSetup)&&a(""),De?f(z,De):f(z,null))});const ee=async De=>{const pe=JSON.parse(De.data);if(pe.tabId&&pe.tabId===p)return;const xe=pe;xe.type==="initLocalAccount"||xe.type==="initCloudAccount"||xe.type==="updateAccount"||xe.type==="disconnectCloudAccount"?a(""):xe.type==="exit"&&E()};return m.addEventListener(ee),()=>m.removeEventListener(ee)});const w=Kn();Ne(async()=>{await new Promise(ee=>setTimeout(ee,60)),await Ai(),w.working=!0});let C=D(!1),N=0,Y=T(()=>v().length>0),z=T(l),U=T(c),R=T(d),G=D(null);const Q=()=>{n(G)&&n(G).scrollTo({top:0})};Ue(()=>{_(n(z)!==void 0)}),Ue(()=>{i(n(G))});const se=()=>{if(n(G)){const ee=n(G).scrollTop||0;ee===0?f(C,!1):!n(C)&&N>ee?f(C,!0):n(C)&&N+50<ee&&f(C,!1),N=ee}},H=()=>{se()};Ue(()=>(n(G)?.addEventListener("scroll",H),window.addEventListener("resize",H),()=>{n(G)?.removeEventListener("scroll",H),window.removeEventListener("resize",H)}));const O=T(k);let we=T(()=>w.swipingRatio);const ue=()=>{const ee=new URLSearchParams(o());return r(ee)},M=async ee=>{ee.preventDefault()},I=T(y),Z=T(()=>n(I)==="popup"?{onOpenWindow:M,openWindowHref:ue()}:{});var oe=Zh(),de=P(oe);Gh(de,{});var ce=A(de,2);Fu(ce,{});var Ae=A(ce,2);go(Ae,{});var Fe=A(Ae,2);af(Fe,{});var he=A(Fe,2),ve=b(he),ze=b(ve),W=b(ze);{var te=ee=>{tg(ee,Oo(()=>n(Z)))};B(W,ee=>{n(R)&&n(z)!==void 0&&ee(te)})}var be=A(ve,2),Ee=b(be);{var fe=ee=>{Yh(ee,Oo(()=>n(Z)))};B(Ee,ee=>{n(U)&&n(R)&&ee(fe)})}$e(he,ee=>f(G,ee),()=>n(G));var re=A(he,2);{var ke=ee=>{var De=Jh(),pe=b(De);pe.__click=Q;var xe=b(pe);_t(xe,{children:(F,V)=>{var q=Ye("top");g(F,q)}});var x=A(xe,2),L=b(x);ge(L,()=>({"--rotate":"90deg","--size":"28px"})),_e(L.lastChild,{name:"back"}),Ie(()=>{Qa(De,`--swiping-ratio: ${n(we)}; --transition-timing-default: ${w.duration}s;`),et(De,1,nt({i:!0,g:w.working&&!w.isSwiping,j:n(Y)||n(O)!=="closed"}),"p-bn1wva")}),g(ee,De)};B(re,ee=>{n(C)&&ee(ke)})}Ie(()=>{Qa(he,`--swiping-ratio: ${n(we)}; --transition-timing-default: ${w.duration}s;`),et(he,1,nt({f:!0,g:w.working&&!w.isSwiping,h:n(O)!=="closed"}),"p-bn1wva")}),g(t,oe),Se()}pt(["click"]);function $h(t){lu(t,{children:(e,a)=>{Qh(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||Uc($h,{target:document.getElementById("app")});export{ut as $,T as A,Lt as B,Ht as C,ls as D,ss as E,Cr as F,Zt as G,sg as H,_e as I,Ot as J,ga as K,Ia as L,ua as M,vl as N,Zi as O,Pe as P,Ds as Q,Jn as R,$e as S,ip as T,sp as U,_t as V,_u as W,wu as X,tn as Y,yr as Z,Ft as _,f as a,_n as a0,oh as a1,uo as a2,ap as a3,rp as a4,Xh as a5,np as a6,Oe as a7,Qa as a8,op as a9,D as b,b as c,ge as d,Bn as e,S as f,n as g,dt as h,g as i,B as j,et as k,nt as l,Se as m,P as n,Ne as o,Ce as p,vt as q,pt as r,A as s,Ie as t,zt as u,Qt as v,ft as w,Ue as x,ye as y,Ye as z};
