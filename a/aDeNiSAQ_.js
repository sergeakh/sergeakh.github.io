const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/a64F33uS3.js","a/aCeYg3FOS.css","a/aDFIjtaZu.js","a/a9q_jSmK4.js","a/abA9hIFUQ.js","a/aBrkJtqMH.css","a/aDEL_kBnT.js","a/aDB02xhFr.css","a/aB8EJ-vYG.js","a/a54d_SC5m.css","a/aCDJzUZcl.js","a/aCpa8lgv9.js","a/afGUkjeV7.css","a/aBayTpSvQ.js","a/aY1d2PU1k.css","a/aDnNF4aJf.js","a/aCMczUtB9.js","a/aCpd7MTd8.css","a/aJuI-2_aP.js","a/aenMKNzfI.css","a/aC969LWc5.css","a/aBNsJu5gZ.js","a/aCeh8XjKC.css","a/aC9dLoWEF.js","a/aCBPoPn5g.css","a/apMBNoldj.js","a/aK1a0NeEW.css","a/aBxseH24r.js","a/aBem4Ctjp.css","a/aDbo9HI09.js","a/aBdnakgrk.css","a/aDzrUvh_m.js","a/aDzsMVVo5.css","a/a12GO-ix6.js","a/aCH18nfIo.css","a/a1AgKEc67.js","a/aub3SUNKA.js","a/aCb6DfA6m.css","a/aBCgyxBNC.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var Sl=Object.defineProperty;var gs=t=>{throw TypeError(t)};var Cl=(t,e,a)=>e in t?Sl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var Ot=(t,e,a)=>Cl(t,typeof e!="symbol"?e+"":e,a),wo=(t,e,a)=>e.has(t)||gs("Cannot "+a);var B=(t,e,a)=>(wo(t,e,"read from private field"),a?a.call(t):e.get(t)),je=(t,e,a)=>e.has(t)?gs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),Re=(t,e,a,r)=>(wo(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),ot=(t,e,a)=>(wo(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const kl=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};kl(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const xl=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};xl();const ko=!1;var Qo=Array.isArray,Tl=Array.prototype.indexOf,ro=Array.from,El=Object.defineProperty,ra=Object.getOwnPropertyDescriptor,Hs=Object.getOwnPropertyDescriptors,Us=Object.prototype,Pl=Array.prototype,oo=Object.getPrototypeOf,hs=Object.isExtensible;function ir(t){return typeof t=="function"}const Ye=()=>{};function Nl(t){return typeof t?.then=="function"}function Al(t){return t()}function xo(t){for(var e=0;e<t.length;e++)t[e]()}function Ws(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function Ml(t,e,a=!1){return t===void 0?a?e():e:t}const At=2,$o=4,so=8,Dl=1<<24,Wn=16,qn=32,Aa=64,io=128,fn=512,It=1024,qt=2048,kn=4096,Xt=8192,Rn=16384,es=32768,ua=65536,ps=1<<17,qs=1<<18,ar=1<<19,Vs=1<<20,Ln=1<<25,Ea=32768,To=1<<21,ts=1<<22,oa=1<<23,sa=Symbol("$state"),Ks=Symbol("legacy props"),Il=Symbol(""),Ha=new class extends Error{constructor(){super(...arguments);Ot(this,"name","StaleReactionError");Ot(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ys(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ll(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Rl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ol(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Fl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function zl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Bl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function jl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Hl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ul(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Wl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const ql=1,Vl=2,Gs=4,Kl=8,Yl=16,Gl=1,Xl=2,Jl=4,Zl=8,Ql=16,$l=1,ec=2,Pt=Symbol(),tc="http://www.w3.org/1999/xhtml";function nc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Xs(t){return t===this.v}function ac(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Js(t){return!ac(t,this.v)}let rr=!1,rc=!1;function oc(){rr=!0}const sc=[];function pa(t,e=!1,a=!1){return jr(t,new Map,"",sc,null,a)}function jr(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(Qo(t)){var l=Array(t.length);e.set(t,l),o!==null&&e.set(o,l);for(var d=0;d<t.length;d+=1){var u=t[d];d in t&&(l[d]=jr(u,e,a,r,null,s))}return l}if(oo(t)===Us){l={},e.set(t,l),o!==null&&e.set(o,l);for(var c in t)l[c]=jr(t[c],e,a,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return jr(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let nt=null;function Za(t){nt=t}function vt(t){return Zs().get(t)}function gt(t,e){return Zs().set(t,e),e}function fe(t,e=!1,a){nt={p:nt,i:!1,c:null,e:null,s:t,x:null,l:rr&&!e?{s:null,u:null,$:[]}:null}}function ve(t){var e=nt,a=e.e;if(a!==null){e.e=null;for(var r of a)mi(r)}return t!==void 0&&(e.x=t),e.i=!0,nt=e.p,t??{}}function or(){return!rr||nt!==null&&nt.l===null}function Zs(t){return nt===null&&Ys(),nt.c??(nt.c=new Map(ic(nt)||void 0))}function ic(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let _a=[];function Qs(){var t=_a;_a=[],xo(t)}function Ma(t){if(_a.length===0&&!qa){var e=_a;queueMicrotask(()=>{e===_a&&Qs()})}_a.push(t)}function lc(){for(;_a.length>0;)Qs()}function $s(t){var e=Xe;if(e===null)return Ue.f|=oa,t;if((e.f&es)===0){if((e.f&io)===0)throw t;e.b.error(t)}else Qa(t,e)}function Qa(t,e){for(;e!==null;){if((e.f&io)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Or=new Set;let Je=null,Hr=null,ln=null,on=[],lo=null,Eo=!1,qa=!1;var Ka,Ya,wa,ya,kr,Ga,Xa,Nt,Po,cr,No,ei,ti;const $r=class $r{constructor(){je(this,Nt);Ot(this,"committed",!1);Ot(this,"current",new Map);Ot(this,"previous",new Map);je(this,Ka,new Set);je(this,Ya,new Set);je(this,wa,0);je(this,ya,0);je(this,kr,null);je(this,Ga,new Set);je(this,Xa,new Set);Ot(this,"skipped_effects",new Set);Ot(this,"is_fork",!1)}is_deferred(){return this.is_fork||B(this,ya)>0}process(e){on=[],Hr=null,this.apply();var a={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)ot(this,Nt,Po).call(this,r,a);this.is_fork||ot(this,Nt,ei).call(this),this.is_deferred()?(ot(this,Nt,cr).call(this,a.effects),ot(this,Nt,cr).call(this,a.render_effects)):(Hr=this,Je=null,ms(a.render_effects),ms(a.effects),Hr=null,B(this,kr)?.resolve()),ln=null}capture(e,a){this.previous.has(e)||this.previous.set(e,a),(e.f&oa)===0&&(this.current.set(e,e.v),ln?.set(e,e.v))}activate(){Je=this,this.apply()}deactivate(){Je===this&&(Je=null,ln=null)}flush(){if(this.activate(),on.length>0){if(ai(),Je!==null&&Je!==this)return}else B(this,wa)===0&&this.process([]);this.deactivate()}discard(){for(const e of B(this,Ya))e(this);B(this,Ya).clear()}increment(e){Re(this,wa,B(this,wa)+1),e&&Re(this,ya,B(this,ya)+1)}decrement(e){Re(this,wa,B(this,wa)-1),e&&Re(this,ya,B(this,ya)-1),this.revive()}revive(){for(const e of B(this,Ga))B(this,Xa).delete(e),Rt(e,qt),Pa(e);for(const e of B(this,Xa))Rt(e,kn),Pa(e);this.flush()}oncommit(e){B(this,Ka).add(e)}ondiscard(e){B(this,Ya).add(e)}settled(){return(B(this,kr)??Re(this,kr,Ws())).promise}static ensure(){if(Je===null){const e=Je=new $r;Or.add(Je),qa||$r.enqueue(()=>{Je===e&&e.flush()})}return Je}static enqueue(e){Ma(e)}apply(){}};Ka=new WeakMap,Ya=new WeakMap,wa=new WeakMap,ya=new WeakMap,kr=new WeakMap,Ga=new WeakMap,Xa=new WeakMap,Nt=new WeakSet,Po=function(e,a){e.f^=It;for(var r=e.first;r!==null;){var o=r.f,s=(o&(qn|Aa))!==0,i=s&&(o&It)!==0,l=i||(o&Xt)!==0||this.skipped_effects.has(r);if((r.f&io)!==0&&r.b?.is_pending()&&(a={parent:a,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=It:(o&$o)!==0?a.effects.push(r):Ar(r)&&((r.f&Wn)!==0&&B(this,Ga).add(r),wr(r));var d=r.first;if(d!==null){r=d;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===a.effect&&(ot(this,Nt,cr).call(this,a.effects),ot(this,Nt,cr).call(this,a.render_effects),a=a.parent),r=u.next,u=u.parent}},cr=function(e){for(const a of e)(a.f&qt)!==0?B(this,Ga).add(a):(a.f&kn)!==0&&B(this,Xa).add(a),ot(this,Nt,No).call(this,a.deps),Rt(a,It)},No=function(e){if(e!==null)for(const a of e)(a.f&At)===0||(a.f&Ea)===0||(a.f^=Ea,ot(this,Nt,No).call(this,a.deps))},ei=function(){if(B(this,ya)===0){for(const e of B(this,Ka))e();B(this,Ka).clear()}B(this,wa)===0&&ot(this,Nt,ti).call(this)},ti=function(){var s;if(Or.size>1){this.previous.clear();var e=ln,a=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Or){if(i===this){a=!1;continue}const l=[];for(const[u,c]of this.current){if(i.current.has(u))if(a&&c!==i.current.get(u))i.current.set(u,c);else continue;l.push(u)}if(l.length===0)continue;const d=[...i.current.keys()].filter(u=>!this.current.has(u));if(d.length>0){var o=on;on=[];const u=new Set,c=new Map;for(const v of l)ri(v,d,u,c);if(on.length>0){Je=i,i.apply();for(const v of on)ot(s=i,Nt,Po).call(s,v,r);i.deactivate()}on=o}}Je=null,ln=e}this.committed=!0,Or.delete(this)};let yn=$r;function ni(t){var e=qa;qa=!0;try{for(var a;;){if(lc(),on.length===0&&(Je?.flush(),on.length===0))return lo=null,a;ai()}}finally{qa=e}}function ai(){var t=Ta;Eo=!0;var e=null;try{var a=0;for(Yr(!0);on.length>0;){var r=yn.ensure();if(a++>1e3){var o,s;cc()}r.process(on),ia.clear()}}finally{Eo=!1,Yr(t),lo=null}}function cc(){try{zl()}catch(t){Qa(t,lo)}}let Mn=null;function ms(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Rn|Xt))===0&&Ar(r)&&(Mn=new Set,wr(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?yi(r):r.fn=null),Mn?.size>0)){ia.clear();for(const o of Mn){if((o.f&(Rn|Xt))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)Mn.has(i)&&(Mn.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const d=s[l];(d.f&(Rn|Xt))===0&&wr(d)}}Mn.clear()}}Mn=null}}function ri(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&At)!==0?ri(o,e,a,r):(s&(ts|Wn))!==0&&(s&qt)===0&&oi(o,e,r)&&(Rt(o,qt),Pa(o))}}function oi(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(e.includes(o))return!0;if((o.f&At)!==0&&oi(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function Pa(t){for(var e=lo=t;e.parent!==null;){e=e.parent;var a=e.f;if(Eo&&e===Xe&&(a&Wn)!==0&&(a&qs)===0)return;if((a&(Aa|qn))!==0){if((a&It)===0)return;e.f^=It}}on.push(e)}function dc(t){let e=0,a=xn(0),r;return()=>{mr()&&(n(a),uo(()=>(e===0&&(r=zt(()=>t(()=>la(a)))),e+=1,()=>{Ma(()=>{e-=1,e===0&&(r?.(),r=void 0,la(a))})})))}}var uc=ua|ar|io;function fc(t,e,a){new vc(t,e,a)}var nn,an,Zo,hn,ba,pn,rn,Ht,mn,In,$n,Sa,ea,Ca,ta,eo,xt,gc,hc,Ao,Ur,Wr,Mo;class vc{constructor(e,a,r){je(this,xt);Ot(this,"parent");je(this,nn,!1);je(this,an);je(this,Zo,null);je(this,hn);je(this,ba);je(this,pn);je(this,rn,null);je(this,Ht,null);je(this,mn,null);je(this,In,null);je(this,$n,null);je(this,Sa,0);je(this,ea,0);je(this,Ca,!1);je(this,ta,null);je(this,eo,dc(()=>(Re(this,ta,xn(B(this,Sa))),()=>{Re(this,ta,null)})));Re(this,an,e),Re(this,hn,a),Re(this,ba,r),this.parent=Xe.b,Re(this,nn,!!B(this,hn).pending),Re(this,pn,sr(()=>{Xe.b=this;{var o=ot(this,xt,Ao).call(this);try{Re(this,rn,sn(()=>r(o)))}catch(s){this.error(s)}B(this,ea)>0?ot(this,xt,Wr).call(this):Re(this,nn,!1)}return()=>{B(this,$n)?.remove()}},uc))}is_pending(){return B(this,nn)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!B(this,hn).pending}update_pending_count(e){ot(this,xt,Mo).call(this,e),Re(this,Sa,B(this,Sa)+e),B(this,ta)&&On(B(this,ta),B(this,Sa))}get_effect_pending(){return B(this,eo).call(this),n(B(this,ta))}error(e){var a=B(this,hn).onerror;let r=B(this,hn).failed;if(B(this,Ca)||!a&&!r)throw e;B(this,rn)&&(Wt(B(this,rn)),Re(this,rn,null)),B(this,Ht)&&(Wt(B(this,Ht)),Re(this,Ht,null)),B(this,mn)&&(Wt(B(this,mn)),Re(this,mn,null));var o=!1,s=!1;const i=()=>{if(o){nc();return}o=!0,s&&Wl(),yn.ensure(),Re(this,Sa,0),B(this,mn)!==null&&xa(B(this,mn),()=>{Re(this,mn,null)}),Re(this,nn,this.has_pending_snippet()),Re(this,rn,ot(this,xt,Ur).call(this,()=>(Re(this,Ca,!1),sn(()=>B(this,ba).call(this,B(this,an)))))),B(this,ea)>0?ot(this,xt,Wr).call(this):Re(this,nn,!1)};var l=Ue;try{Ut(null),s=!0,a?.(e,i),s=!1}catch(d){Qa(d,B(this,pn)&&B(this,pn).parent)}finally{Ut(l)}r&&Ma(()=>{Re(this,mn,ot(this,xt,Ur).call(this,()=>{yn.ensure(),Re(this,Ca,!0);try{return sn(()=>{r(B(this,an),()=>e,()=>i)})}catch(d){return Qa(d,B(this,pn).parent),null}finally{Re(this,Ca,!1)}}))})}}nn=new WeakMap,an=new WeakMap,Zo=new WeakMap,hn=new WeakMap,ba=new WeakMap,pn=new WeakMap,rn=new WeakMap,Ht=new WeakMap,mn=new WeakMap,In=new WeakMap,$n=new WeakMap,Sa=new WeakMap,ea=new WeakMap,Ca=new WeakMap,ta=new WeakMap,eo=new WeakMap,xt=new WeakSet,gc=function(){try{Re(this,rn,sn(()=>B(this,ba).call(this,B(this,an))))}catch(e){this.error(e)}Re(this,nn,!1)},hc=function(){const e=B(this,hn).pending;e&&(Re(this,Ht,sn(()=>e(B(this,an)))),yn.enqueue(()=>{var a=ot(this,xt,Ao).call(this);Re(this,rn,ot(this,xt,Ur).call(this,()=>(yn.ensure(),sn(()=>B(this,ba).call(this,a))))),B(this,ea)>0?ot(this,xt,Wr).call(this):(xa(B(this,Ht),()=>{Re(this,Ht,null)}),Re(this,nn,!1))}))},Ao=function(){var e=B(this,an);return B(this,nn)&&(Re(this,$n,Fn()),B(this,an).before(B(this,$n)),e=B(this,$n)),e},Ur=function(e){var a=Xe,r=Ue,o=nt;Tn(B(this,pn)),Ut(B(this,pn)),Za(B(this,pn).ctx);try{return e()}catch(s){return $s(s),null}finally{Tn(a),Ut(r),Za(o)}},Wr=function(){const e=B(this,hn).pending;B(this,rn)!==null&&(Re(this,In,document.createDocumentFragment()),B(this,In).append(B(this,$n)),Ci(B(this,rn),B(this,In))),B(this,Ht)===null&&Re(this,Ht,sn(()=>e(B(this,an))))},Mo=function(e){var a;if(!this.has_pending_snippet()){this.parent&&ot(a=this.parent,xt,Mo).call(a,e);return}Re(this,ea,B(this,ea)+e),B(this,ea)===0&&(Re(this,nn,!1),B(this,Ht)&&xa(B(this,Ht),()=>{Re(this,Ht,null)}),B(this,In)&&(B(this,an).before(B(this,In)),Re(this,In,null)))};function pc(t,e,a,r){const o=or()?Er:Pr;if(a.length===0&&t.length===0){r(e.map(o));return}var s=Je,i=Xe,l=si();function d(){Promise.all(a.map(u=>mc(u))).then(u=>{l();try{r([...e.map(o),...u])}catch(c){(i.f&Rn)===0&&Qa(c,i)}s?.deactivate(),pr()}).catch(u=>{Qa(u,i)})}t.length>0?Promise.all(t).then(()=>{l();try{return d()}finally{s?.deactivate(),pr()}}):d()}function si(){var t=Xe,e=Ue,a=nt,r=Je;return function(s=!0){Tn(t),Ut(e),Za(a),s&&r?.activate()}}function pr(){Tn(null),Ut(null),Za(null)}function Er(t){var e=At|qt,a=Ue!==null&&(Ue.f&At)!==0?Ue:null;return Xe!==null&&(Xe.f|=ar),{ctx:nt,deps:null,effects:null,equals:Xs,f:e,fn:t,reactions:null,rv:0,v:Pt,wv:0,parent:a??Xe,ac:null}}function mc(t,e){let a=Xe;a===null&&Ll();var r=a.b,o=void 0,s=xn(Pt),i=!Ue,l=new Map;return Pc(()=>{var d=Ws();o=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{u===Je&&u.committed&&u.deactivate(),pr()})}catch(h){d.reject(h),pr()}var u=Je;if(i){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),l.get(u)?.reject(Ha),l.delete(u),l.set(u,d)}const v=(h,p=void 0)=>{if(u.activate(),p)p!==Ha&&(s.f|=oa,On(s,p));else{(s.f&oa)!==0&&(s.f^=oa),On(s,h);for(const[m,x]of l){if(l.delete(m),m===u)break;x.reject(Ha)}}i&&(r.update_pending_count(-1),u.decrement(c))};d.promise.then(v,h=>v(null,h||"unknown"))}),pi(()=>{for(const d of l.values())d.reject(Ha)}),new Promise(d=>{function u(c){function v(){c===o?d(s):u(o)}c.then(v,v)}u(o)})}function N(t){const e=Er(t);return ki(e),e}function Pr(t){const e=Er(t);return e.equals=Js,e}function ii(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)Wt(e[a])}}function _c(t){for(var e=t.parent;e!==null;){if((e.f&At)===0)return(e.f&Rn)===0?e:null;e=e.parent}return null}function ns(t){var e,a=Xe;Tn(_c(t));try{t.f&=~Ea,ii(t),e=Pi(t)}finally{Tn(a)}return e}function li(t){var e=ns(t);if(t.equals(e)||(Je?.is_fork||(t.v=e),t.wv=Ti()),!Da)if(ln!==null)(mr()||Je?.is_fork)&&ln.set(t,e);else{var a=(t.f&fn)===0?kn:It;Rt(t,a)}}let Do=new Set;const ia=new Map;let ci=!1;function xn(t,e){var a={f:0,v:t,reactions:null,equals:Xs,rv:0,wv:0};return a}function I(t,e){const a=xn(t);return ki(a),a}function Io(t,e=!1,a=!0){var o;const r=xn(t);return e||(r.equals=Js),rr&&a&&nt!==null&&nt.l!==null&&((o=nt.l).s??(o.s=[])).push(r),r}function f(t,e,a=!1){Ue!==null&&(!bn||(Ue.f&ps)!==0)&&or()&&(Ue.f&(At|Wn|ts|ps))!==0&&!zn?.includes(t)&&Ul();let r=a?ft(e):e;return On(t,r)}function On(t,e){if(!t.equals(e)){var a=t.v;Da?ia.set(t,e):ia.set(t,a),t.v=e;var r=yn.ensure();r.capture(t,a),(t.f&At)!==0&&((t.f&qt)!==0&&ns(t),Rt(t,(t.f&fn)!==0?It:kn)),t.wv=Ti(),di(t,qt),or()&&Xe!==null&&(Xe.f&It)!==0&&(Xe.f&(qn|Aa))===0&&(en===null?Mc([t]):en.push(t)),!r.is_fork&&Do.size>0&&!ci&&wc()}return e}function wc(){ci=!1;var t=Ta;Yr(!0);const e=Array.from(Do);try{for(const a of e)(a.f&It)!==0&&Rt(a,kn),Ar(a)&&wr(a)}finally{Yr(t)}Do.clear()}function la(t){f(t,t.v+1)}function di(t,e){var a=t.reactions;if(a!==null)for(var r=or(),o=a.length,s=0;s<o;s++){var i=a[s],l=i.f;if(!(!r&&i===Xe)){var d=(l&qt)===0;if(d&&Rt(i,e),(l&At)!==0){var u=i;ln?.delete(u),(l&Ea)===0&&(l&fn&&(i.f|=Ea),di(u,kn))}else d&&((l&Wn)!==0&&Mn!==null&&Mn.add(i),Pa(i))}}}function ft(t){if(typeof t!="object"||t===null||sa in t)return t;const e=oo(t);if(e!==Us&&e!==Pl)return t;var a=new Map,r=Qo(t),o=I(0),s=Bn,i=l=>{if(Bn===s)return l();var d=Ue,u=Bn;Ut(null),bs(s);var c=l();return Ut(d),bs(u),c};return r&&a.set("length",I(t.length)),new Proxy(t,{defineProperty(l,d,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&jl();var c=a.get(d);return c===void 0?c=i(()=>{var v=I(u.value);return a.set(d,v),v}):f(c,u.value,!0),!0},deleteProperty(l,d){var u=a.get(d);if(u===void 0){if(d in l){const c=i(()=>I(Pt));a.set(d,c),la(o)}}else f(u,Pt),la(o);return!0},get(l,d,u){if(d===sa)return t;var c=a.get(d),v=d in l;if(c===void 0&&(!v||ra(l,d)?.writable)&&(c=i(()=>{var p=ft(v?l[d]:Pt),m=I(p);return m}),a.set(d,c)),c!==void 0){var h=n(c);return h===Pt?void 0:h}return Reflect.get(l,d,u)},getOwnPropertyDescriptor(l,d){var u=Reflect.getOwnPropertyDescriptor(l,d);if(u&&"value"in u){var c=a.get(d);c&&(u.value=n(c))}else if(u===void 0){var v=a.get(d),h=v?.v;if(v!==void 0&&h!==Pt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(l,d){if(d===sa)return!0;var u=a.get(d),c=u!==void 0&&u.v!==Pt||Reflect.has(l,d);if(u!==void 0||Xe!==null&&(!c||ra(l,d)?.writable)){u===void 0&&(u=i(()=>{var h=c?ft(l[d]):Pt,p=I(h);return p}),a.set(d,u));var v=n(u);if(v===Pt)return!1}return c},set(l,d,u,c){var v=a.get(d),h=d in l;if(r&&d==="length")for(var p=u;p<v.v;p+=1){var m=a.get(p+"");m!==void 0?f(m,Pt):p in l&&(m=i(()=>I(Pt)),a.set(p+"",m))}if(v===void 0)(!h||ra(l,d)?.writable)&&(v=i(()=>I(void 0)),f(v,ft(u)),a.set(d,v));else{h=v.v!==Pt;var x=i(()=>ft(u));f(v,x)}var w=Reflect.getOwnPropertyDescriptor(l,d);if(w?.set&&w.set.call(c,u),!h){if(r&&typeof d=="string"){var k=a.get("length"),F=Number(d);Number.isInteger(F)&&F>=k.v&&f(k,F+1)}la(o)}return!0},ownKeys(l){n(o);var d=Reflect.ownKeys(l).filter(v=>{var h=a.get(v);return h===void 0||h.v!==Pt});for(var[u,c]of a)c.v!==Pt&&!(u in l)&&d.push(u);return d},setPrototypeOf(){Hl()}})}var _s,ui,fi,vi;function yc(){if(_s===void 0){_s=window,ui=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;fi=ra(e,"firstChild").get,vi=ra(e,"nextSibling").get,hs(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),hs(a)&&(a.__t=void 0)}}function Fn(t=""){return document.createTextNode(t)}function $a(t){return fi.call(t)}function Nr(t){return vi.call(t)}function C(t,e){return $a(t)}function A(t,e=!1){{var a=$a(t);return a instanceof Comment&&a.data===""?Nr(a):a}}function D(t,e=1,a=!1){let r=t;for(;e--;)r=Nr(r);return r}function bc(t){t.textContent=""}function gi(){return!1}let ws=!1;function Sc(){ws||(ws=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function co(t){var e=Ue,a=Xe;Ut(null),Tn(null);try{return t()}finally{Ut(e),Tn(a)}}function Cc(t,e,a,r=a){t.addEventListener(e,()=>co(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),Sc()}function hi(t){Xe===null&&(Ue===null&&Fl(),Ol()),Da&&Rl()}function kc(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function Pn(t,e,a){var r=Xe;r!==null&&(r.f&Xt)!==0&&(t|=Xt);var o={ctx:nt,deps:null,nodes:null,f:t|qt|fn,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{wr(o),o.f|=es}catch(l){throw Wt(o),l}else e!==null&&Pa(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&ar)===0&&(s=s.first,(t&Wn)!==0&&(t&ua)!==0&&s!==null&&(s.f|=ua)),s!==null&&(s.parent=r,r!==null&&kc(s,r),Ue!==null&&(Ue.f&At)!==0&&(t&Aa)===0)){var i=Ue;(i.effects??(i.effects=[])).push(s)}return o}function mr(){return Ue!==null&&!bn}function pi(t){const e=Pn(so,null,!1);return Rt(e,It),e.teardown=t,e}function Fe(t){hi();var e=Xe.f,a=!Ue&&(e&qn)!==0&&(e&es)===0;if(a){var r=nt;(r.e??(r.e=[])).push(t)}else return mi(t)}function mi(t){return Pn($o|Vs,t,!1)}function xc(t){return hi(),Pn(so|Vs,t,!0)}function Tc(t){yn.ensure();const e=Pn(Aa|ar,t,!0);return(a={})=>new Promise(r=>{a.outro?xa(e,()=>{Wt(e),r(void 0)}):(Wt(e),r(void 0))})}function Ec(t){return Pn($o,t,!1)}function Pc(t){return Pn(ts|ar,t,!0)}function uo(t,e=0){return Pn(so|e,t,!0)}function xe(t,e=[],a=[],r=[]){pc(r,e,a,o=>{Pn(so,()=>t(...o.map(n)),!0)})}function sr(t,e=0){var a=Pn(Wn|e,t,!0);return a}function sn(t){return Pn(qn|ar,t,!0)}function _i(t){var e=t.teardown;if(e!==null){const a=Da,r=Ue;ys(!0),Ut(null);try{e.call(null)}finally{ys(a),Ut(r)}}}function wi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&co(()=>{o.abort(Ha)});var r=a.next;(a.f&Aa)!==0?a.parent=null:Wt(a,e),a=r}}function Nc(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&qn)===0&&Wt(e),e=a}}function Wt(t,e=!0){var a=!1;(e||(t.f&qs)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Ac(t.nodes.start,t.nodes.end),a=!0),wi(t,e&&!a),Gr(t,0),Rt(t,Rn);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();_i(t);var o=t.parent;o!==null&&o.first!==null&&yi(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Ac(t,e){for(;t!==null;){var a=t===e?null:Nr(t);t.remove(),t=a}}function yi(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function xa(t,e,a=!0){var r=[];bi(t,r,!0);var o=()=>{a&&Wt(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var l of r)l.out(i)}else o()}function bi(t,e,a){if((t.f&Xt)===0){t.f^=Xt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||a)&&e.push(l);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&ua)!==0||(o.f&qn)!==0&&(t.f&Wn)!==0;bi(o,e,i?a:!1),o=s}}}function as(t){Si(t,!0)}function Si(t,e){if((t.f&Xt)!==0){t.f^=Xt,(t.f&It)===0&&(Rt(t,qt),Pa(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&ua)!==0||(a.f&qn)!==0;Si(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function Ci(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Nr(a);e.append(a),a=o}}let Ta=!1;function Yr(t){Ta=t}let Da=!1;function ys(t){Da=t}let Ue=null,bn=!1;function Ut(t){Ue=t}let Xe=null;function Tn(t){Xe=t}let zn=null;function ki(t){Ue!==null&&(zn===null?zn=[t]:zn.push(t))}let Ft=null,Kt=0,en=null;function Mc(t){en=t}let xi=1,_r=0,Bn=_r;function bs(t){Bn=t}function Ti(){return++xi}function Ar(t){var e=t.f;if((e&qt)!==0)return!0;if(e&At&&(t.f&=~Ea),(e&kn)!==0){var a=t.deps;if(a!==null)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(Ar(s)&&li(s),s.wv>t.wv)return!0}(e&fn)!==0&&ln===null&&Rt(t,It)}return!1}function Ei(t,e,a=!0){var r=t.reactions;if(r!==null&&!zn?.includes(t))for(var o=0;o<r.length;o++){var s=r[o];(s.f&At)!==0?Ei(s,e,!1):e===s&&(a?Rt(s,qt):(s.f&It)!==0&&Rt(s,kn),Pa(s))}}function Pi(t){var m;var e=Ft,a=Kt,r=en,o=Ue,s=zn,i=nt,l=bn,d=Bn,u=t.f;Ft=null,Kt=0,en=null,Ue=(u&(qn|Aa))===0?t:null,zn=null,Za(t.ctx),bn=!1,Bn=++_r,t.ac!==null&&(co(()=>{t.ac.abort(Ha)}),t.ac=null);try{t.f|=To;var c=t.fn,v=c(),h=t.deps;if(Ft!==null){var p;if(Gr(t,Kt),h!==null&&Kt>0)for(h.length=Kt+Ft.length,p=0;p<Ft.length;p++)h[Kt+p]=Ft[p];else t.deps=h=Ft;if(mr()&&(t.f&fn)!==0)for(p=Kt;p<h.length;p++)((m=h[p]).reactions??(m.reactions=[])).push(t)}else h!==null&&Kt<h.length&&(Gr(t,Kt),h.length=Kt);if(or()&&en!==null&&!bn&&h!==null&&(t.f&(At|kn|qt))===0)for(p=0;p<en.length;p++)Ei(en[p],t);return o!==null&&o!==t&&(_r++,en!==null&&(r===null?r=en:r.push(...en))),(t.f&oa)!==0&&(t.f^=oa),v}catch(x){return $s(x)}finally{t.f^=To,Ft=e,Kt=a,en=r,Ue=o,zn=s,Za(i),bn=l,Bn=d}}function Dc(t,e){let a=e.reactions;if(a!==null){var r=Tl.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}a===null&&(e.f&At)!==0&&(Ft===null||!Ft.includes(e))&&(Rt(e,kn),(e.f&fn)!==0&&(e.f^=fn,e.f&=~Ea),ii(e),Gr(e,0))}function Gr(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Dc(t,a[r])}function wr(t){var e=t.f;if((e&Rn)===0){Rt(t,It);var a=Xe,r=Ta;Xe=t,Ta=!0;try{(e&(Wn|Dl))!==0?Nc(t):wi(t),_i(t);var o=Pi(t);t.teardown=typeof o=="function"?o:null,t.wv=xi;var s;ko&&rc&&(t.f&qt)!==0&&t.deps}finally{Ta=r,Xe=a}}}async function Ni(){await Promise.resolve(),ni()}function n(t){var e=t.f,a=(e&At)!==0;if(Ue!==null&&!bn){var r=Xe!==null&&(Xe.f&Rn)!==0;if(!r&&!zn?.includes(t)){var o=Ue.deps;if((Ue.f&To)!==0)t.rv<_r&&(t.rv=_r,Ft===null&&o!==null&&o[Kt]===t?Kt++:Ft===null?Ft=[t]:Ft.includes(t)||Ft.push(t));else{(Ue.deps??(Ue.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[Ue]:s.includes(Ue)||s.push(Ue)}}}if(Da){if(ia.has(t))return ia.get(t);if(a){var i=t,l=i.v;return((i.f&It)===0&&i.reactions!==null||Mi(i))&&(l=ns(i)),ia.set(i,l),l}}else a&&(!ln?.has(t)||Je?.is_fork&&!mr())&&(i=t,Ar(i)&&li(i),Ta&&mr()&&(i.f&fn)===0&&Ai(i));if(ln?.has(t))return ln.get(t);if((t.f&oa)!==0)throw t.v;return t.v}function Ai(t){if(t.deps!==null){t.f^=fn;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&At)!==0&&(e.f&fn)===0&&Ai(e)}}function Mi(t){if(t.v===Pt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ia.has(e)||(e.f&At)!==0&&Mi(e))return!0;return!1}function zt(t){var e=bn;try{return bn=!0,t()}finally{bn=e}}const Ic=-7169;function Rt(t,e){t.f=t.f&Ic|e}function Lc(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(sa in t)Lo(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&sa in a&&Lo(a)}}}function Lo(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Lo(t[r],e)}catch{}const a=oo(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Hs(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const Rc=["touchstart","touchmove"];function Oc(t){return Rc.includes(t)}const Di=new Set,Ro=new Set;function Fc(t,e,a,r={}){function o(s){if(r.capture||dr.call(e,s),!s.cancelBubble)return co(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Ma(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function cn(t,e,a,r,o){var s={capture:r,passive:o},i=Fc(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&pi(()=>{e.removeEventListener(t,i,s)})}function ht(t){for(var e=0;e<t.length;e++)Di.add(t[e]);for(var a of Ro)a(t)}let Ss=null;function dr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;Ss=t;var i=0,l=Ss===t&&t.__root;if(l){var d=o.indexOf(l);if(d!==-1&&(e===document||e===window)){t.__root=e;return}var u=o.indexOf(e);if(u===-1)return;d<=u&&(i=d)}if(s=o[i]||t.target,s!==e){El(t,"currentTarget",{configurable:!0,get(){return s||a}});var c=Ue,v=Xe;Ut(null),Tn(null);try{for(var h,p=[];s!==null;){var m=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+r];x!=null&&(!s.disabled||t.target===s)&&x.call(s,t)}catch(w){h?p.push(w):h=w}if(t.cancelBubble||m===e||m===null)break;s=m}if(h){for(let w of p)queueMicrotask(()=>{throw w});throw h}}finally{t.__root=e,delete t.currentTarget,Ut(c),Tn(v)}}}function Ii(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function yr(t,e){var a=Xe;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function P(t,e){var a=(e&$l)!==0,r=(e&ec)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=Ii(s?t:"<!>"+t),a||(o=$a(o)));var i=r||ui?document.importNode(o,!0):o.cloneNode(!0);if(a){var l=$a(i),d=i.lastChild;yr(l,d)}else yr(i,i);return i}}function zc(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=Ii(o),l=$a(i);s=$a(l)}var d=s.cloneNode(!0);return yr(d,d),d}}function Bc(t,e){return zc(t,e,"svg")}function Ie(t=""){{var e=Fn(t+"");return yr(e,e),e}}function ue(){var t=document.createDocumentFragment(),e=document.createComment(""),a=Fn();return t.append(e,a),yr(e,a),t}function g(t,e){t!==null&&t.before(e)}function xh(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function dt(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function jc(t,e){return Hc(t,e)}const Ba=new Map;function Hc(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){yc();var l=new Set,d=v=>{for(var h=0;h<v.length;h++){var p=v[h];if(!l.has(p)){l.add(p);var m=Oc(p);e.addEventListener(p,dr,{passive:m});var x=Ba.get(p);x===void 0?(document.addEventListener(p,dr,{passive:m}),Ba.set(p,1)):Ba.set(p,x+1)}}};d(ro(Di)),Ro.add(d);var u=void 0,c=Tc(()=>{var v=a??e.appendChild(Fn());return fc(v,{pending:()=>{}},h=>{if(s){fe({});var p=nt;p.c=s}o&&(r.$$events=o),u=t(h,r)||{},s&&ve()}),()=>{for(var h of l){e.removeEventListener(h,dr);var p=Ba.get(h);--p===0?(document.removeEventListener(h,dr),Ba.delete(h)):Ba.set(h,p)}Ro.delete(d),v!==a&&v.parentNode?.removeChild(v)}});return Uc.set(u,c),u}let Uc=new WeakMap;var dn,_n,Gt,ka,xr,Tr,to;class fo{constructor(e,a=!0){Ot(this,"anchor");je(this,dn,new Map);je(this,_n,new Map);je(this,Gt,new Map);je(this,ka,new Set);je(this,xr,!0);je(this,Tr,()=>{var e=Je;if(B(this,dn).has(e)){var a=B(this,dn).get(e),r=B(this,_n).get(a);if(r)as(r),B(this,ka).delete(a);else{var o=B(this,Gt).get(a);o&&(B(this,_n).set(a,o.effect),B(this,Gt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of B(this,dn)){if(B(this,dn).delete(s),s===e)break;const l=B(this,Gt).get(i);l&&(Wt(l.effect),B(this,Gt).delete(i))}for(const[s,i]of B(this,_n)){if(s===a||B(this,ka).has(s))continue;const l=()=>{if(Array.from(B(this,dn).values()).includes(s)){var u=document.createDocumentFragment();Ci(i,u),u.append(Fn()),B(this,Gt).set(s,{effect:i,fragment:u})}else Wt(i);B(this,ka).delete(s),B(this,_n).delete(s)};B(this,xr)||!r?(B(this,ka).add(s),xa(i,l,!1)):l()}}});je(this,to,e=>{B(this,dn).delete(e);const a=Array.from(B(this,dn).values());for(const[r,o]of B(this,Gt))a.includes(r)||(Wt(o.effect),B(this,Gt).delete(r))});this.anchor=e,Re(this,xr,a)}ensure(e,a){var r=Je,o=gi();if(a&&!B(this,_n).has(e)&&!B(this,Gt).has(e))if(o){var s=document.createDocumentFragment(),i=Fn();s.append(i),B(this,Gt).set(e,{effect:sn(()=>a(i)),fragment:s})}else B(this,_n).set(e,sn(()=>a(this.anchor)));if(B(this,dn).set(r,e),o){for(const[l,d]of B(this,_n))l===e?r.skipped_effects.delete(d):r.skipped_effects.add(d);for(const[l,d]of B(this,Gt))l===e?r.skipped_effects.delete(d.effect):r.skipped_effects.add(d.effect);r.oncommit(B(this,Tr)),r.ondiscard(B(this,to))}else B(this,Tr).call(this)}}dn=new WeakMap,_n=new WeakMap,Gt=new WeakMap,ka=new WeakMap,xr=new WeakMap,Tr=new WeakMap,to=new WeakMap;const Wc=0,yo=1;function qc(t,e,a,r,o){var s=or(),i=Pt,l=s?xn(i):Io(i,!1,!1),d=s?xn(i):Io(i,!1,!1),u=new fo(t);sr(()=>{var c=e(),v=!1;if(Nl(c)){var h=si(),p=!1;const m=x=>{if(!v){p=!0,h(!1),yn.ensure();try{x()}finally{pr(),qa||ni()}}};c.then(x=>{m(()=>{On(l,x),u.ensure(yo,r&&(w=>r(w,l)))})},x=>{m(()=>{if(On(d,x),u.ensure(yo,o&&(w=>o(w,d))),!o)throw d.v})}),Ma(()=>{p||m(()=>{u.ensure(Wc,a)})})}else On(l,c),u.ensure(yo,r&&(m=>r(m,l)));return()=>{v=!0}})}function q(t,e,a=!1){var r=new fo(t),o=a?ua:0;function s(i,l){r.ensure(i,l)}sr(()=>{var i=!1;e((l,d=!0)=>{i=!0,s(d,l)}),i||s(!1,null)},o)}function ce(t,e){uo(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Vc(t,e,a){for(var r=[],o=e.length,s,i=e.length,l=0;l<o;l++){let v=e[l];xa(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var h=t.outrogroups;Oo(ro(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var d=r.length===0&&a!==null;if(d){var u=a,c=u.parentNode;bc(c),c.append(u),t.items.clear()}Oo(e,!d)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function Oo(t,e=!0){for(var a=0;a<t.length;a++)Wt(t[a],e)}var Cs;function jn(t,e,a,r,o,s=null){var i=t,l=new Map,d=(e&Gs)!==0;if(d){var u=t;i=u.appendChild(Fn())}var c=null,v=Pr(()=>{var k=a();return Qo(k)?k:k==null?[]:ro(k)}),h,p=!0;function m(){w.fallback=c,Kc(w,h,i,e,r),c!==null&&(h.length===0?(c.f&Ln)===0?as(c):(c.f^=Ln,ur(c,null,i)):xa(c,()=>{c=null}))}var x=sr(()=>{h=n(v);for(var k=h.length,F=new Set,b=Je,T=gi(),L=0;L<k;L+=1){var Y=h[L],O=r(Y,L),U=p?null:l.get(O);U?(U.v&&On(U.v,Y),U.i&&On(U.i,L),T&&b.skipped_effects.delete(U.e)):(U=Yc(l,p?i:Cs??(Cs=Fn()),Y,O,L,o,e,a),p||(U.e.f|=Ln),l.set(O,U)),F.add(O)}if(k===0&&s&&!c&&(p?c=sn(()=>s(i)):(c=sn(()=>s(Cs??(Cs=Fn()))),c.f|=Ln)),!p)if(T){for(const[R,H]of l)F.has(R)||b.skipped_effects.add(H.e);b.oncommit(m),b.ondiscard(()=>{})}else m();n(v)}),w={effect:x,items:l,outrogroups:null,fallback:c};p=!1}function Kc(t,e,a,r,o){var s=(r&Kl)!==0,i=e.length,l=t.items,d=t.effect.first,u,c=null,v,h=[],p=[],m,x,w,k;if(s)for(k=0;k<i;k+=1)m=e[k],x=o(m,k),w=l.get(x).e,(w.f&Ln)===0&&(w.nodes?.a?.measure(),(v??(v=new Set)).add(w));for(k=0;k<i;k+=1){if(m=e[k],x=o(m,k),w=l.get(x).e,t.outrogroups!==null)for(const H of t.outrogroups)H.pending.delete(w),H.done.delete(w);if((w.f&Ln)!==0)if(w.f^=Ln,w===d)ur(w,null,a);else{var F=c?c.next:d;w===t.effect.last&&(t.effect.last=w.prev),w.prev&&(w.prev.next=w.next),w.next&&(w.next.prev=w.prev),Yn(t,c,w),Yn(t,w,F),ur(w,F,a),c=w,h=[],p=[],d=c.next;continue}if((w.f&Xt)!==0&&(as(w),s&&(w.nodes?.a?.unfix(),(v??(v=new Set)).delete(w))),w!==d){if(u!==void 0&&u.has(w)){if(h.length<p.length){var b=p[0],T;c=b.prev;var L=h[0],Y=h[h.length-1];for(T=0;T<h.length;T+=1)ur(h[T],b,a);for(T=0;T<p.length;T+=1)u.delete(p[T]);Yn(t,L.prev,Y.next),Yn(t,c,L),Yn(t,Y,b),d=b,c=Y,k-=1,h=[],p=[]}else u.delete(w),ur(w,d,a),Yn(t,w.prev,w.next),Yn(t,w,c===null?t.effect.first:c.next),Yn(t,c,w),c=w;continue}for(h=[],p=[];d!==null&&d!==w;)(u??(u=new Set)).add(d),p.push(d),d=d.next;if(d===null)continue}(w.f&Ln)===0&&h.push(w),c=w,d=w.next}if(t.outrogroups!==null){for(const H of t.outrogroups)H.pending.size===0&&(Oo(ro(H.done)),t.outrogroups?.delete(H));t.outrogroups.size===0&&(t.outrogroups=null)}if(d!==null||u!==void 0){var O=[];if(u!==void 0)for(w of u)(w.f&Xt)===0&&O.push(w);for(;d!==null;)(d.f&Xt)===0&&d!==t.fallback&&O.push(d),d=d.next;var U=O.length;if(U>0){var R=(r&Gs)!==0&&i===0?a:null;if(s){for(k=0;k<U;k+=1)O[k].nodes?.a?.measure();for(k=0;k<U;k+=1)O[k].nodes?.a?.fix()}Vc(t,O,R)}}s&&Ma(()=>{if(v!==void 0)for(w of v)w.nodes?.a?.apply()})}function Yc(t,e,a,r,o,s,i,l){var d=(i&ql)!==0?(i&Yl)===0?Io(a,!1,!1):xn(a):null,u=(i&Vl)!==0?xn(o):null;return{v:d,i:u,e:sn(()=>(s(e,d??a,u??o,l),()=>{t.delete(r)}))}}function ur(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&Ln)===0?e.nodes.start:a;r!==null;){var i=Nr(r);if(s.before(r),r===o)return;r=i}}function Yn(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function Ae(t,e,...a){var r=new fo(t);sr(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},ua)}function Gc(t,e,a){var r=new fo(t);sr(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},ua)}function Li(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=Li(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function Xc(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=Li(t))&&(r&&(r+=" "),r+=e);return r}function it(t){return typeof t=="object"?Xc(t):t??""}const ks=[...` 	
\r\fÂ \v\uFEFF`];function Jc(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||ks.includes(r[i-1]))&&(l===r.length||ks.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function Zc(t,e){return t==null?null:String(t)}function at(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var l=Jc(a,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=a}else if(s&&o!==s)for(var d in s){var u=!!s[d];(o==null||u!==!!o[d])&&t.classList.toggle(d,u)}return s}function er(t,e,a,r){var o=t.__style;if(o!==e){var s=Zc(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const Qc=Symbol("is custom element"),$c=Symbol("is html");function Th(t,e){var a=rs(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Eh(t,e){var a=rs(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function st(t,e,a,r){var o=rs(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Il]=a),a==null?t.removeAttribute(e):typeof a!="string"&&ed(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function rs(t){return t.__attributes??(t.__attributes={[Qc]:t.nodeName.includes("-"),[$c]:t.namespaceURI===tc})}var xs=new Map;function ed(t){var e=t.getAttribute("is")||t.nodeName,a=xs.get(e);if(a)return a;xs.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=Hs(o);for(var i in r)r[i].set&&a.push(i);o=oo(o)}return a}function Ri(t,e,a=e){var r=new WeakSet;Cc(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=bo(t)?So(s):s,a(s),Je!==null&&r.add(Je),await Ni(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,d=t.value.length;if(t.value=s??"",l!==null){var u=t.value.length;i===l&&l===d&&u>d?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=i,t.selectionEnd=Math.min(l,u))}}}),zt(e)==null&&t.value&&(a(bo(t)?So(t.value):t.value),Je!==null&&r.add(Je)),uo(()=>{var o=e();if(t===document.activeElement){var s=Hr??Je;if(r.has(s))return}bo(t)&&o===So(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function bo(t){var e=t.type;return e==="number"||e==="range"}function So(t){return t===""?null:+t}function Ts(t,e){return t===e||t?.[sa]===e}function Ze(t={},e,a,r){return Ec(()=>{var o,s;return uo(()=>{o=s,s=[],zt(()=>{t!==a(...s)&&(e(t,...s),o&&Ts(a(...o),t)&&e(null,...o))})}),()=>{Ma(()=>{s&&Ts(a(...s),t)&&e(null,...s)})}}),t}function os(t=!1){const e=nt,a=e.l.u;if(!a)return;let r=()=>Lc(e.s);if(t){let o=0,s={};const i=Er(()=>{let l=!1;const d=e.s;for(const u in d)d[u]!==s[u]&&(s[u]=d[u],l=!0);return l&&o++,o});r=()=>n(i)}a.b.length&&xc(()=>{Es(e,r),xo(a.b)}),Fe(()=>{const o=zt(()=>a.m.map(Al));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&Fe(()=>{Es(e,r),xo(a.a)})}function Es(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let Fr=!1;function td(t){var e=Fr;try{return Fr=!1,[t(),Fr]}finally{Fr=e}}const nd={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(ir(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];ir(o)&&(o=o());const s=ra(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(ir(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=ra(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===sa||e===Ks)return!1;for(let a of t.props)if(ir(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(ir(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function Fo(...t){return new Proxy({props:t},nd)}function Ne(t,e,a,r){var o=!rr||(a&Xl)!==0,s=(a&Zl)!==0,i=(a&Ql)!==0,l=r,d=!0,u=()=>(d&&(d=!1,l=i?zt(r):r),l),c;if(s){var v=sa in t||Ks in t;c=ra(t,e)?.set??(v&&e in t?b=>t[e]=b:void 0)}var h,p=!1;s?[h,p]=td(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=u(),c&&(o&&Bl(),c(h)));var m;if(o?m=()=>{var b=t[e];return b===void 0?u():(d=!0,b)}:m=()=>{var b=t[e];return b!==void 0&&(l=void 0),b===void 0?l:b},o&&(a&Jl)===0)return m;if(c){var x=t.$$legacy;return(function(b,T){return arguments.length>0?((!o||!T||x||p)&&c(T?m():b),b):m()})}var w=!1,k=((a&Gl)!==0?Er:Pr)(()=>(w=!1,m()));s&&n(k);var F=Xe;return(function(b,T){if(arguments.length>0){const L=T?n(k):o&&s?ft(b):b;return f(k,L),w=!0,l!==void 0&&(l=L),b}return Da&&w||(F.f&Rn)!==0?k.v:n(k)})}function be(t){nt===null&&Ys(),rr&&nt.l!==null?ad(nt).m.push(t):Fe(()=>{const e=zt(t);if(typeof e=="function")return e})}function ad(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const rd="5";var js;typeof window<"u"&&((js=window.__svelte??(window.__svelte={})).v??(js.v=new Set)).add(rd);oc();const Oi={};function od(t){gt(Oi,t)}function Xr(){const t=vt(Oi);if(!t)throw new Error("No FeedSearchContext found");return t}const Fi={};function sd(t){gt(Fi,t)}function Vt(){const t=vt(Fi);if(!t)throw new Error("No SearchParamsContext found");return t}function id(t,e){fe(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Vt(),s="feedSearch",i=N(()=>o().get(s)||""),l=N(()=>n(i));od({getFeedSearch:()=>n(l),setFeedSearch:c=>{c===""?r(s):a(s,c)}});var d=ue(),u=A(d);Ae(u,()=>e.children??Ye),g(t,d),ve()}const zi={};function ld(t){gt(zi,t)}function cd(){const t=vt(zi);if(!t)throw new Error("No TagsSearchContext found");return t}function dd(t,e){fe(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Vt(),s="tagsSearch",i=N(()=>o().get(s)||""),l=N(()=>n(i));ld({getTagsSearch:()=>n(l),setTagsSearch:c=>{c===""?r(s):a(s,c)}});var d=ue(),u=A(d);Ae(u,()=>e.children??Ye),g(t,d),ve()}const Bi={};function ud(t){gt(Bi,t)}function ji(){const t=vt(Bi);if(!t)throw new Error("No FeedOrderContext found");return t}function fd(t,e){fe(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Vt(),s="feedOrder",i=N(()=>o().get(s)||"newest"),l=N(()=>n(i));let d=["newest","oldest","AtoZ","ZtoA","updatedNewest","updatedOldest"];ud({getFeedOrder:()=>n(l),setFeedOrder:v=>{v==="newest"||!d.includes(v)?r(s):a(s,v)}});var u=ue(),c=A(u);Ae(c,()=>e.children??Ye),g(t,u),ve()}const Hi={};function vd(t){gt(Hi,t)}function Mr(){const t=vt(Hi);if(!t)throw new Error("No SidebarContext found");return t}function gd(t,e){fe(e,!0);let a=I("closed");vd({sidebarOpen:()=>{f(a,"preOpening")},sidebarClose:()=>{f(a,"closing")},getSidebarState:()=>n(a),setSidebarState:u=>{f(a,u,!0)}});var l=ue(),d=A(l);Ae(d,()=>e.children??Ye),g(t,l),ve()}const Ui={};function hd(t){gt(Ui,t)}function Vn(){const t=vt(Ui);if(!t)throw new Error("No SelectedTagsContext found");return t}function pd(t,e){fe(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Vt(),s=N(a),i="selectedTags";let l=N(()=>n(s).get(i)||""),d=N(()=>new Set(n(l).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!=="")));hd({getSelectedTags:()=>n(d),addTag:w=>{n(d).has(w)||r(i,[...n(d),w].map(k=>encodeURIComponent(k)).join(","))},removeTag:w=>{n(d).has(w)&&n(d).size===1?o(i):n(d).has(w)&&r(i,[...n(d)].filter(k=>k!==w).map(k=>encodeURIComponent(k)).join(","))},clearTags:()=>{o(i)},setSelectedTags:w=>{w.size===0?o(i):r(i,[...w].map(k=>encodeURIComponent(k)).join(","))}});var m=ue(),x=A(m);Ae(x,()=>e.children??Ye),g(t,m),ve()}const Wi={};function md(t){gt(Wi,t)}function fa(){const t=vt(Wi);if(!t)throw new Error("No SelectedNotesContext found");return t}var _d=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],wd=["difference","intersection","symmetricDifference","union"],Ps=!1,Ja,un,na,no,tr,qi,Vi;const ao=class ao extends Set{constructor(a){super();je(this,tr);je(this,Ja,new Map);je(this,un,I(0));je(this,na,I(0));je(this,no,Bn||-1);if(a){for(var r of a)super.add(r);B(this,na).v=super.size}Ps||ot(this,tr,Vi).call(this)}has(a){var r=super.has(a),o=B(this,Ja),s=o.get(a);if(s===void 0){if(!r)return n(B(this,un)),!1;s=ot(this,tr,qi).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),f(B(this,na),super.size),la(B(this,un))),this}delete(a){var r=super.delete(a),o=B(this,Ja),s=o.get(a);return s!==void 0&&(o.delete(a),f(s,!1)),r&&(f(B(this,na),super.size),la(B(this,un))),r}clear(){if(super.size!==0){super.clear();var a=B(this,Ja);for(var r of a.values())f(r,!1);a.clear(),f(B(this,na),0),la(B(this,un))}}keys(){return this.values()}values(){return n(B(this,un)),super.values()}entries(){return n(B(this,un)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(B(this,na))}};Ja=new WeakMap,un=new WeakMap,na=new WeakMap,no=new WeakMap,tr=new WeakSet,qi=function(a){return Bn===B(this,no)?I(a):xn(a)},Vi=function(){Ps=!0;var a=ao.prototype,r=Set.prototype;for(const o of _d)a[o]=function(...s){return n(B(this,un)),r[o].apply(this,s)};for(const o of wd)a[o]=function(...s){n(B(this,un));var i=r[o].apply(this,s);return new ao(i)}};let zo=ao;function yd(t,e){fe(e,!0);let a=new zo,r=I("single");const o=()=>a,s=p=>{a.clear(),p.forEach(m=>a.add(m))},i=p=>{a.add(p)},l=p=>{a.delete(p)},d=()=>{a.clear()};md({getSelectedNotes:o,setSelectedNotes:s,addNote:i,removeNote:l,clearNotes:d,getMode:()=>n(r),changeMode:p=>{f(r,p,!0),p==="single"&&d()}});var v=ue(),h=A(v);Ae(h,()=>e.children??Ye),g(t,v),ve()}const Ki={};function bd(t){gt(Ki,t)}function ss(){const t=vt(Ki);if(!t)throw new Error("No LocalDBContext found");return t}const Yi={};function Sd(t){gt(Yi,t)}function Na(){const t=vt(Yi);if(!t)throw new Error("No SettingsContext found");return t}const Gi={};function Cd(t){gt(Gi,t)}function vo(){const t=vt(Gi);if(!t)throw new Error("No BroadcastContext found");return t}const kd="AppStorage",xd=1,fr="account",Jn="settings",$e="notes",jt="tags",Td="syncLog",va="success",Un="error",kt=(t,e,a)=>{t?.addEventListener(e,a)},Ns=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();kt(s,va,()=>{const i=s?.result||[];a(i)}),kt(s,Un,i=>{r(i)})}),Jr=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);kt(i,va,()=>{const l=i?.result?.data;r(l)}),kt(i,Un,l=>{o(l)})}),wn=(t,e,a,r)=>new Promise((o,s)=>{const d=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});kt(d,va,()=>{o()}),kt(d,Un,u=>{s(u)})}),_t=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((l,d)=>{kt(i,va,()=>{l()}),kt(i,Un,u=>{d(u)})})}))},Co=(t,e,a)=>new Promise((r,o)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);kt(l,va,()=>{r()}),kt(l,Un,d=>{o(d)})}),lr=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((l,d)=>{kt(i,va,()=>{l()}),kt(i,Un,u=>{d(u)})})}))},Ua=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();kt(i,va,()=>{a()}),kt(i,Un,l=>{r(l)})}),tn="dialogPages",Xi={};function Ed(t){gt(Xi,t)}function Jt(){const t=vt(Xi);if(!t)throw new Error("No DialogPagesContext found");return t}var Ce=(t=>(t.NewNote="newNote",t.Note="note",t.Settings="settings",t.ImportData="importData",t.ExportData="exportData",t.Account="account",t.Sync="sync",t.AccountSetup="accountSetup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="accessKeys",t.ConfirmAccessKey="confirmAccessKey",t.Subscription="subscription",t.Exit="exit",t.NotFound="notFound",t.About="about",t.Install="install",t.InstallSuccess="installSuccess",t.Extension="extension",t))(Ce||{});const As={settings:"Settings",importData:"Import",exportData:"Export",account:"Account",sync:"Sync",accountSetup:"",auth:"Auth",signin:"Sign in",signup:"Sign up",confirmAccessKey:"Confirm access key",accessKeys:"Access keys",subscription:"Subscription",exit:"Exit",notFound:"",about:"About",install:"Install app",installSuccess:"Install success",extension:"Extension"},Ph=()=>chrome,Ms=()=>LanguageModel;function Pd(t,e){fe(e,!0);const{deleteSearchParam:a,getSearchParams:r}=Vt(),{clearDialogPages:o,getDialogPages:s,replaceDialogPage:i}=Jt(),l="viewMode";let u=ft((()=>{const Q=new URLSearchParams(window.location.search).get(l)||"tab";return Q==="popup"||Q==="window"||Q==="tab"||Q==="sidebar"?Q:"tab"})());be(()=>{a(l)});let c=I(!1),v=I(ft({showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:h}=ss(),{createBroadcastChannel:p,tabId:m}=vo(),x=p(),w=N(h),k=async()=>{const ie=await Jr(n(w),Jn,"default");ie&&f(v,ie,!0)},F=async()=>{await k();const ie=r().get("noteId");s().includes(Ce.NewNote)&&ie&&(i(`${Ce.Note}?id=${ie}`),a("noteId")),f(c,!0)},b=async ie=>{const Q=JSON.parse(ie.data),V=Q;if(Q.tabId&&Q.tabId===m){V.type==="exit"&&(f(v,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),Ua(n(w),Jn));return}V.type==="updateSettings"?k():V.type==="exit"&&f(v,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},T=()=>n(v).showFavicon,L=()=>n(v).recordMode,Y=async ie=>{n(v).showFavicon=ie,await wn(n(w),Jn,"default",pa(n(v))),x.postMessage({type:"updateSettings"})},O=async ie=>{n(v).recordMode=ie,await wn(n(w),Jn,"default",pa(n(v))),x.postMessage({type:"updateSettings"})},U=async ie=>{n(v).tags.prev=ie,await wn(n(w),Jn,"default",pa(n(v))),x.postMessage({type:"updateSettings"})},R=()=>n(v).tags.prev||[],H=async ie=>{n(v).tags.llm=ie,await wn(n(w),Jn,"default",pa(n(v))),x.postMessage({type:"updateSettings"})},K=()=>n(v).tags.llm,ee=()=>n(v).tags.pageData,Z=async ie=>{n(v).tags.pageData=ie,await wn(n(w),Jn,"default",pa(n(v))),x.postMessage({type:"updateSettings"})};be(()=>(F(),x.addEventListener(b),()=>{x.removeEventListener(b)})),Sd({getFaviconEnabled:T,getRecordMode:L,setRecordMode:O,setFaviconShown:Y,isInitedSettings:()=>n(c),getViewMode:()=>u,setLlmTagsEnabled:H,getLlmTagsEnabled:K,setPrevTags:U,getPrevTags:R,getPageDataForTagsEnabled:ee,setPageDataForTagsEnabled:Z});var j=ue(),we=A(j);Ae(we,()=>e.children??Ye),g(t,j),ve()}const Ji={};function Nd(t){gt(Ji,t)}function is(){const t=vt(Ji);if(!t)throw new Error("No AccountContext found");return t}function Ad(t,e){fe(e,!0);let a=I(void 0);const{getDB:r}=ss(),{createBroadcastChannel:o,tabId:s}=vo(),i=N(r),l=o(),d=async()=>{const b=await Jr(n(i),fr,"default");f(a,b,!0)},u=b=>wn(n(i),fr,"default",b),c=async b=>{const T=await Jr(n(i),fr,"default");T!==void 0&&f(a,T,!0),b(T)},v=async b=>{const T=JSON.parse(b.data);if(T.tabId&&T.tabId===s)return;const L=T;L.type==="initLocalAccount"?f(a,null):L.type==="initCloudAccount"?d():L.type==="disconnectCloudAccount"?f(a,null):L.type==="exit"?f(a,void 0):L.type==="updateAccount"&&d()};be(()=>(l.addEventListener(v),()=>{l.removeEventListener(v)})),Nd({init:c,getAccount:()=>n(a),initLocalAccount:async()=>{f(a,null),await u(null),l.postMessage({type:"initLocalAccount"})},initCloudAccount:async b=>{const T={encryptedClientKey:b.encryptedClientKey||"",subscriptionExpires:b.subscriptionExpires||-1,lastSync:-1};await u(T),f(a,T,!0),l.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{f(a,null),await u(null),l.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async b=>{if(!n(a))throw new Error("No account to update subscription for");const T={...n(a),subscriptionExpires:b};await u(T),l.postMessage({type:"updateAccount"})},exitApp:async()=>{f(a,void 0),l.postMessage({type:"exit"}),await Ua(n(i),fr)}});var k=ue(),F=A(k);Ae(F,()=>e.children??Ye),g(t,k),ve()}const Zi={};function Md(t){gt(Zi,t)}function Bt(){const t=vt(Zi);if(!t)throw new Error("No NotesContext found");return t}const Zn=()=>crypto.randomUUID(),Dd=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},Qi=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}};async function Nh(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{console.error("")}}const St=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t));function Id(t,e){fe(e,!0);const{getDB:a}=ss(),{createBroadcastChannel:r,tabId:o}=vo(),s=N(a),i=r(),l=720*60*60*1e3;let d=I(!1),u=I(()=>new Map),c=I(()=>[]),v=I(()=>new Map);const h=()=>n(d),p=()=>n(c)().some(y=>y.data&&!y.data.deletedAt&&!y.data.archivedAt),m=()=>n(c)().some(y=>y.data&&y.data.deletedAt),x=()=>n(c)().some(y=>y.data&&y.data.archivedAt&&!y.data.deletedAt),w=y=>{const E=n(c)(),_=n(v)(),S=_.get(y.id);S?S.data=y.data:(E.push(y),_.set(y.id,y)),f(c,()=>E),f(v,()=>_)},k=y=>{const E=n(c)(),_=n(v)(),S=_.get(y);_.has(y)&&_.delete(y),S&&(S.data=void 0),f(c,()=>E),f(v,()=>_)},F=y=>{const E=n(c)(),_=n(v)();for(const S of y){const z=_.get(S);_.has(S)&&_.delete(S),z&&(z.data=void 0)}f(c,()=>E),f(v,()=>_)},b=()=>{f(c,()=>[]),f(u,()=>new Map),f(v,()=>new Map)},T=()=>n(c),L=y=>{const E=n(u)();for(const _ of y)E.get(_)||E.set(_,{name:_});f(u,()=>E)},Y=async()=>{const[y,E]=await Promise.all([Ns(n(s),$e),Ns(n(s),jt).then(W=>W.reduce((X,re)=>X.set(re.id,re.data),new Map))]),_=[],S=[],z=new Map;for(const W of y)W.data.deletedAt&&Date.now()-W.data.deletedAt>l?_.push(W.id):(S.push(W),z.set(W.id,W));const M=Dd(S),oe=[],ge=new Map(E);[...M.values()].forEach(W=>{ge.set(W,{name:W,pinned:E.get(W)?.pinned||!1}),E.has(W)||oe.push(W)});const he=[];[...E.keys()].forEach(W=>{M.has(W)||he.push(W)}),await lr(n(s),$e,_),await lr(n(s),jt,he),await _t(n(s),jt,oe.map(W=>({id:W,data:{pinned:ge.get(W)?.pinned||!1}}))),f(c,()=>S),f(v,()=>z),f(u,()=>ge),f(d,!0)},O=async y=>{const E=n(u)(),_=y.data.tags.filter(S=>!E.has(S))||[];return await wn(n(s),$e,y.id,{...y.data}),_.length>0&&(await _t(n(s),jt,_.map(S=>({id:S,data:{pinned:!1}}))||[]),L(_)),w(y),i.postMessage({type:"putNote",data:{id:y.id}}),y.id},U=async({link:y,text:E,tags:_})=>{const S={id:Zn(),data:{link:St(y),text:E,tags:St(_),history:[],createdAt:Date.now(),updatedAt:Date.now()}};return await O(S),S.id},R=async(y,{link:E,text:_,tags:S})=>{const z=j(y);if(!z||!z.data)return;const M={id:y,data:{...z.data,link:St(E),text:_,tags:St(S),updatedAt:Date.now()}};await O(M)},H=async(y,{link:E,text:_,tags:S})=>{const z=j(y);if(!z||!z.data)return;const M=Zn(),oe={id:y,data:{...z.data,link:E,text:_,tags:S,updatedAt:Date.now(),history:[...(z.data.history||[]).slice(-49),{id:M,link:St(z.data.link),text:z.data.text,tags:St(z.data.tags),updatedAt:z.data.updatedAt}]}};return await O(oe),M},K=async(y,E)=>{const _=j(y);if(!_||!_.data)return;const S=_.data.history?.find?.(M=>M.id===E);if(!S)return;const z={id:y,data:{..._.data,link:St(S.link),text:S.text,tags:St(S.tags),updatedAt:S.updatedAt,history:_.data.history?.filter?.(M=>M.id!==E)||[]}};await O(z)},ee=async y=>{const _=n(v)().get(y);!_||!_.data||(k(y),await Co(n(s),$e,y),i.postMessage({type:"deleteNote",data:{id:y}}))},Z=async()=>{await Ua(n(s),$e),await Ua(n(s),jt),b(),i.postMessage({type:"clearNotes"})},j=y=>n(v)().get(y),we=async(y,E)=>{const S=n(v)().get(y);if(!S||!S.data)return;const z={id:y,data:{...S.data,pinned:E}};O(z)},ie=async y=>{const _=n(v)().get(y);if(!_||!_.data)return;const S={id:y,data:{..._.data,deletedAt:Date.now()}};await O(S)},Q=async y=>{const _=n(v)().get(y);if(!_||!_.data)return;const S={id:y,data:{..._.data,archivedAt:Date.now()}};await O(S)},V=async({noteIds:y})=>{const E=n(v)(),_=n(c)();for(const z of y){const M=E.get(z);M?.data&&(M.data.deletedAt=Date.now())}return await _t(n(s),$e,y.map(z=>{const M=E.get(z);return{id:z,data:M?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_),{cancel:async()=>{for(const z of y){const M=E.get(z);M?.data&&(M.data.deletedAt=0)}await _t(n(s),$e,y.map(z=>{const M=E.get(z);return{id:z,data:M?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_)}}},$=async({noteIds:y})=>{const E=n(v)(),_=n(c)();for(const z of y){const M=E.get(z);M?.data&&(M.data.archivedAt=Date.now())}return await _t(n(s),$e,y.map(z=>{const M=E.get(z);return{id:z,data:M?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_),{cancel:async()=>{for(const z of y){const M=E.get(z);M?.data&&(M.data.archivedAt=0)}await _t(n(s),$e,y.map(z=>{const M=E.get(z);return{id:z,data:M?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_)}}},te=async({noteIds:y})=>{const E=n(v)(),_=n(c)(),S=[];for(const M of y){const oe=E.get(M);oe?.data&&(S.push({id:M,data:St(oe.data)}),oe.data.archivedAt=0)}return await _t(n(s),$e,y.map(M=>{const oe=E.get(M);return{id:M,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_),{cancel:async()=>{for(const M of S){const oe=E.get(M.id);oe?.data&&(oe.data=M.data)}await _t(n(s),$e,y.map(M=>{const oe=E.get(M);return{id:M,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_)}}},se=async({noteIds:y})=>{const E=n(v)(),_=n(c)(),S=[];for(const M of y){const oe=E.get(M);oe?.data&&(S.push({id:M,data:St(oe.data)}),oe.data.deletedAt=0)}return await _t(n(s),$e,y.map(M=>{const oe=E.get(M);return{id:M,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_),{cancel:async()=>{for(const M of S){const oe=E.get(M.id);oe?.data&&(oe.data=M.data)}await _t(n(s),$e,y.map(M=>{const oe=E.get(M);return{id:M,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>_)}}},ne=async y=>{const _=n(v)().get(y);if(!_||!_.data)return;const S={id:y,data:{..._.data,deletedAt:0}};await O(S)},de=async y=>{const _=n(v)().get(y);if(!_||!_.data)return;const S={id:y,data:{..._.data,archivedAt:0}};await O(S)},me=async(y,E)=>{const _=n(u)();_.set(y,{name:y,pinned:E}),await wn(n(s),jt,y,{pinned:E}),i.postMessage({type:"pinTag",data:{tag:y,pinned:E}}),f(u,()=>_)},ae=async({noteIds:y})=>{const E=n(u)(),_=n(c)();F(y),await lr(n(s),$e,y),i.postMessage({type:"reloadNotes"}),f(c,()=>_),f(u,()=>E)},J=async y=>{const E=n(v)(),_={};y.forEach(S=>{const z=E.get(S.id),M=[];if(z&&z.data){let oe=0,ge=0;for(;oe<S.data.history.length&&ge<z.data.history.length;){const he=S.data.history[oe],W=z.data.history[ge];he.id===W.id?(he.updatedAt>W.updatedAt?M.push(he):M.push(W),oe+=1,ge+=1):he.updatedAt<W.updatedAt?(M.push(he),oe+=1):he.updatedAt>W.updatedAt?(M.push(W),ge+=1):(M.push(W),oe+=1,ge+=1)}z.data.updatedAt>S.data.updatedAt?_[z.id]={id:z.id,data:{...z.data,history:M}}:_[S.id]={id:S.id,data:{...S.data,history:M}}}else _[S.id]=S}),await _t(n(s),$e,Object.values(_)),await Y(),i.postMessage({type:"reloadNotes"})},le=async()=>{const y=[];n(c)().forEach(_=>{_&&_.data&&_.data.deletedAt&&y.push(_.id)}),await lr(n(s),$e,y),await Y(),i.postMessage({type:"emptyBin"})},Se=async(y,E)=>{const _=n(v)(),S=n(c)(),z=[],M=[];for(const ge of E){const he=_.get(ge);he?.data&&(z.push({id:ge,data:St(he.data)}),M.push({id:ge,data:{...he.data,tags:he.data.tags.filter(W=>W!==y),history:[...he.data.history||[],{id:Zn(),link:St(he.data.link),text:he.data.text,tags:he.data.tags,updatedAt:Date.now()}]}}))}for(const ge of M){const he=_.get(ge.id);he?.data&&(he.data=ge.data)}return await _t(n(s),$e,M.map(ge=>({id:ge.id,data:ge.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>_),f(c,()=>S),{cancel:async()=>{for(const ge of z){const he=_.get(ge.id);he?.data&&(he.data=ge.data)}await _t(n(s),$e,z.map(ge=>({id:ge.id,data:ge.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>_),f(c,()=>S)}}},_e=async(y,E,_)=>{const S=n(v)(),z=n(c)(),M=n(u)(),oe=[],ge=[];for(const X of _){const re=S.get(X);re?.data&&(oe.push({id:X,data:St(re.data)}),ge.push({id:X,data:{...re.data,tags:re.data.tags.map(ye=>ye!==y?ye:E),history:[...re.data.history||[],{id:Zn(),link:St(re.data.link),text:re.data.text,tags:re.data.tags,updatedAt:Date.now()}]}}))}for(const X of ge){const re=S.get(X.id);re?.data&&(re.data=X.data)}const he=M.has(E);return await Promise.all([(async()=>{if(!he){const X=M.get(y)?.pinned||!1;M.set(E,{name:E,pinned:X}),await wn(n(s),jt,E,{pinned:X})}})(),_t(n(s),$e,ge.map(X=>({id:X.id,data:X.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>z),f(u,()=>M),{cancel:async()=>{for(const X of oe){const re=S.get(X.id);re?.data&&(re.data=X.data)}await Promise.all([(async()=>{he||(M.delete(E),await Co(n(s),jt,E))})(),_t(n(s),$e,oe.map(X=>({id:X.id,data:X.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>z),f(u,()=>M)}}},Te=async(y,E)=>{const _=n(v)(),S=n(c)(),z=n(u)(),M=[],oe=[];for(const W of E){const X=_.get(W);X?.data&&(M.push({id:W,data:St(X.data)}),oe.push({id:W,data:{...X.data,tags:[...new Set([...X.data.tags,y])],history:[...X.data.history||[],{id:Zn(),link:St(X.data.link),text:X.data.text,tags:X.data.tags,updatedAt:Date.now()}]}}))}for(const W of oe){const X=_.get(W.id);X?.data&&(X.data=W.data)}const ge=z.has(y);return await Promise.all([(async()=>{ge||(z.set(y,{name:y,pinned:!1}),await wn(n(s),jt,y,{pinned:!1}))})(),_t(n(s),$e,oe.map(W=>({id:W.id,data:W.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>_),f(c,()=>S),f(u,()=>z),{cancel:async()=>{for(const W of M){const X=_.get(W.id);X?.data&&(X.data=W.data)}await Promise.all([(async()=>{ge||(z.delete(y),await Co(n(s),jt,y))})(),_t(n(s),$e,M.map(W=>({id:W.id,data:W.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>_),f(c,()=>S),f(u,()=>z)}}},Me=async(y,E,_)=>{const S=n(v)(),z=n(c)(),M=n(u)(),oe=[],ge=[];for(const re of _){const ye=S.get(re);ye?.data&&(oe.push({id:re,data:St(ye.data)}),ge.push({id:re,data:{...ye.data,tags:[...new Set([...ye.data.tags.filter(Le=>!y.includes(Le)),...E])],history:[...ye.data.history||[],{id:Zn(),link:St(ye.data.link),text:ye.data.text,tags:ye.data.tags,updatedAt:Date.now()}]}}))}for(const re of ge){const ye=S.get(re.id);ye?.data&&(ye.data=re.data)}const he=n(u)(),W=E.filter(re=>!he.has(re));return await Promise.all([(async()=>{if(W.length>0)return _t(n(s),jt,W.map(re=>({id:re,data:{pinned:!1}})))})(),_t(n(s),$e,ge.map(re=>({id:re.id,data:re.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>z),f(u,()=>M),{cancel:async()=>{for(const re of oe){const ye=S.get(re.id);ye?.data&&(ye.data=re.data)}await Promise.all([(async()=>{if(W.length>0){for(const re of W)M.delete(re);return lr(n(s),jt,W)}})(),_t(n(s),$e,oe.map(re=>({id:re.id,data:re.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>z),f(u,()=>M)}}},Oe=async y=>{const E=JSON.parse(y.data),_=E;if(E.tabId&&E.tabId===o){_.type==="exit"&&(b(),await Ua(n(s),$e),await Ua(n(s),jt));return}if(_.type==="putNote"){const z=_.data.id;if(!z)return;const M=await Jr(n(s),$e,z);if(!M)return;w({id:z,data:M})}else if(_.type==="deleteNote"){const S=_.data.id;if(!S)return;k(S)}else if(_.type==="pinTag"){const S=_.data.tag,z=_.data.pinned,M=n(u)();M.set(S,{name:S,pinned:z}),f(u,()=>M)}else _.type==="clearNotes"?b():_.type==="reloadNotes"||_.type==="emptyBin"?Y():_.type==="exit"&&b()};be(()=>(Y(),i.addEventListener(Oe),()=>{i.removeEventListener(Oe)})),Md({isInitedNotes:h,createNote:U,updateNote:R,deleteNote:ee,saveNote:H,revertNote:K,pinNote:we,moveNoteToBin:ie,moveNoteToArchive:Q,getGetNotes:T,importNotes:J,clearNotes:Z,getNoteById:j,getGetMapTags:()=>n(u),pinTag:me,restoreNoteFromBin:ne,moveNoteFromArchive:de,checkNotes:p,checkNotesInBin:m,checkNotesInArchive:x,emptyBin:le,moveNotesToBin:V,moveNotesToArchive:$,moveNotesFromArchive:te,deleteNotes:ae,restoreNotesFromBin:se,deleteTag:Se,renameTag:_e,addTag:Te,changeTags:Me});var Ee=ue(),G=A(Ee);Ae(G,()=>e.children??Ye),g(t,Ee),ve()}const $i={};function Ld(t){gt($i,t)}function Ia(){const t=vt($i);if(!t)throw new Error("No FeedContext found");return t}const el={};var et=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(et||{});function Rd(t){gt(el,t)}function go(){const t=vt(el);if(!t)throw new Error("No SelectedMetaTagsContext found");return t}function Od(t,e){fe(e,!0);const a=Xr(),{getSelectedTags:r}=Vn(),{getSelectedMetaTags:o}=go(),{getGetNotes:s}=Bt();let i=N(r),l=N(o),d=I(0),u=[],c=I(0),v=N(()=>n(l).has(et.ARCHIVED)),h=N(()=>n(l).has(et.BIN));Fe(()=>{const x=s()()||[],w=[],k=Array.from(n(i).values());for(let F=x.length-1;F>=0;F--){if(!x[F]||!x[F].data)continue;const b=x[F];if(!n(v)&&!n(h)&&(b?.data.deletedAt||b?.data.archivedAt)||n(v)&&(b?.data.deletedAt||!b?.data.archivedAt)||n(h)&&!b?.data.deletedAt)continue;const T=a?.getFeedSearch().toLowerCase()||"";if(!(a&&!(b.data.link?.title.toLowerCase().includes(T)||b.data.link?.url.toLowerCase().includes(T)||b.data.text.toLowerCase().includes(T)||b.data.tags.map(L=>L.toLowerCase()).join(" ").includes(T)))){if(n(l).has(et.INBOX)){if(b.data.tags.length>0)continue}else if(n(i).size&&k.some(L=>!b.data.tags.includes(L)))continue;w.push(b)}}f(d,w.length,!0),u=w,f(c,Date.now(),!0)}),Ld({getFiltredNotesLength:()=>n(d),getFiltredNotes:()=>(n(c),u),getUpdatedFiltredNotesTimestamp:()=>n(c)});var p=ue(),m=A(p);Ae(m,()=>e.children??Ye),g(t,p),ve()}function Fd(t,e){fe(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Vt(),s=N(a),i="selectedMetaTags";let l=N(()=>n(s).get(i)||""),d=N(()=>new Set(n(l).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!=="")));Rd({getSelectedMetaTags:()=>n(d),addMetaTag:w=>{n(d).has(w)||r(i,[...n(d),w].map(k=>encodeURIComponent(k)).join(","))},removeMetaTag:w=>{n(d).has(w)&&n(d).size===1?o(i):n(d).has(w)&&r(i,[...n(d)].filter(k=>k!==w).map(k=>encodeURIComponent(k)).join(","))},clearSelectedMetaTags:()=>{o(i)},setSelectedMetaTags:w=>{w.size===0?o(i):r(i,[...w].map(k=>encodeURIComponent(k)).join(","))}});var m=ue(),x=A(m);Ae(x,()=>e.children??Ye),g(t,m),ve()}const tl={},ca=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function zd(t){gt(tl,t)}function Kn(){const t=vt(tl);if(!t)throw new Error("No AnimationSettingsContext found");return t}function Bd(t,e){fe(e,!0);let a=ft(ca());zd(a);var r=ue(),o=A(r);Ae(o,()=>e.children??Ye),g(t,r),ve()}const nl={};function jd(t){gt(nl,t)}function ls(){const t=vt(nl);if(!t)throw new Error("No ScrollingContext found");return t}function Hd(t,e){fe(e,!0);let a=I(!1);const r=()=>n(a),o=Qi(()=>{f(a,!1)},100);jd({isScrolling:r,enable:()=>{f(a,!0),o()}});var i=ue(),l=A(i);Ae(l,()=>e.children??Ye),g(t,i),ve()}const al={};function Ud(t){gt(al,t)}function La(){const t=vt(al);if(!t)throw new Error("No MobileSizeContext found");return t}function Wd(t,e){fe(e,!0);const a=()=>window.matchMedia("(max-width: 767px)").matches;let r=I(ft(a())),o=Kn();const s=Qi(()=>{o.working=!0},16),i=()=>{o.working=!1,s(),requestAnimationFrame(()=>{f(r,a(),!0)})};Ud({checkMobileSize:()=>n(r)}),be(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)));var d=ue(),u=A(d);Ae(u,()=>e.children??Ye),g(t,d),ve()}const rl={};function qd(t){gt(rl,t)}function Zt(){const t=vt(rl);if(!t)throw new Error("No DialogContext found");return t}function Vd(t,e){fe(e,!0);let a=I(0),r=I(!1),o=I(!0),s=I(!1),i=I(!1);qd({checkExistedDialog:()=>n(a)>0,dialogInc:()=>{f(a,n(a)+1)},dialogDec:()=>{f(a,n(a)-1)},blockDialog:L=>{f(r,L,!0)},checkBlockedDialog:()=>n(r),setClosableDialog:L=>{f(o,L,!0)},checkClosableDialog:()=>n(o),checkLeftStart:()=>n(s),checkLeftEnd:()=>n(i),setLeftStart:L=>{f(s,L,!0)},setLeftEnd:L=>{f(i,L,!0)},getCountDialog:()=>n(a)});var b=ue(),T=A(b);Ae(T,()=>e.children??Ye),g(t,b),ve()}const ol={};function Kd(t){gt(ol,t)}function ho(){const t=vt(ol);if(!t)throw new Error("No ScrollContainerContext found");return t}function Yd(t,e){fe(e,!0);let a=I(null);Kd({setScrollContainer:l=>{f(a,l,!0)},getScrollContainer:()=>n(a)});var s=ue(),i=A(s);Ae(i,()=>e.children??Ye),g(t,s),ve()}const sl={};function Gd(t){gt(sl,t)}function cs(){const t=vt(sl);if(!t)throw new Error("No DialogPageHeightContext found");return t}function Xd(t,e){fe(e,!0);let a=I(200);Gd({setDialogPageHeight:l=>{f(a,l,!0)},getDialogPageHeight:()=>n(a)});var s=ue(),i=A(s);Ae(i,()=>e.children??Ye),g(t,s),ve()}const Jd=[fr,Jn,$e,jt,Td];function Zd(){return new Promise((t,e)=>{const a=indexedDB.open(kd,xd);kt(a,"upgradeneeded",()=>{const r=a.result;for(const o of Jd)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),kt(a,va,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),kt(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),kt(a,Un,()=>{e(),console.error(Un,a.error)})})}function Qd(t,e){fe(e,!0);let a=I(null);be(()=>{Zd().then(l=>{f(a,l,!0)}).catch(l=>{console.error("Failed to initialize LocalDB:",l)})}),bd({getDB:()=>n(a)});var o=ue(),s=A(o);{var i=l=>{var d=ue(),u=A(d);Ae(u,()=>e.children??Ye),g(l,d)};q(s,l=>{n(a)&&l(i)})}g(t,o),ve()}function $d(t,e){fe(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Vt(),s=N(a);let i=N(()=>n(s).get(tn)||""),l=N(()=>n(i).split(",").map(b=>decodeURIComponent(b)).filter(b=>b!==""));const d=()=>n(l),u=b=>{if(b.length===0){o(tn);return}r(tn,b.map(T=>encodeURIComponent(T)).join(","))},c=b=>{r(tn,[...n(l),b].map(T=>encodeURIComponent(T)).join(","))};Ed({setDialogPages:u,getDialogPages:d,pushDialogPage:c,popDialogPage:()=>{const b=n(l)[n(l).length-1];return n(l).length<=1?(o(tn),b):(r(tn,n(l).slice(0,-1).map(T=>encodeURIComponent(T)).join(",")),b)},replaceDialogPage:b=>{r(tn,[...n(l).slice(0,-1),b].map(T=>encodeURIComponent(T)).join(","))},hasDialogPage:b=>n(l).find(T=>{const[L]=T.split("?");return L===b})!==void 0,clearDialogPages:()=>{o(tn)},createDialogPageHref:b=>{const T=new URLSearchParams(n(s).toString());return T.set(tn,[...d(),b].map(L=>encodeURIComponent(L)).join(",")),`${window.location.pathname}?${T.toString()}`},createHandleClickDialogPage:b=>T=>{T.preventDefault(),c(b)}});var k=ue(),F=A(k);Ae(F,()=>e.children??Ye),g(t,k),ve()}function eu(t,e){fe(e,!0);let a=I(ft(new URLSearchParams(window.location.search)));const r=v=>{const h=window.location.pathname;f(a,v,!0),window.history.replaceState(null,"",`${h}${v.size>0?`?${v.toString()}`:""}`)};sd({getSearchParams:()=>n(a),replaceSearchParams:v=>{const h=new URLSearchParams(v);r(h)},setSearchParam:(v,h)=>{const p=new URLSearchParams(n(a));p.set(v,h),r(p)},deleteSearchParam:v=>{const h=new URLSearchParams(n(a));h.delete(v),r(h)},getHref:v=>{const h=new URLSearchParams(v);return`${window.location.pathname}${h.toString().length>0?`?${h.toString()}`:""}`},clearSearchParams:()=>{r(new URLSearchParams)}});var u=ue(),c=A(u);Ae(c,()=>e.children??Ye),g(t,u),ve()}const il={};function tu(t){gt(il,t)}function nu(){const t=vt(il);if(!t)throw new Error("No KeyboardVisibleContext found");return t}function au(t,e){fe(e,!0);let a=ft({value:!1});const r=()=>a.value,o=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";be(()=>{const l=()=>{setTimeout(()=>{o()?a.value=!0:a.value=!1},0)};l(),document.addEventListener("focusin",l),document.addEventListener("focusout",l);let d=null;const u=c=>{o()&&(d&&clearTimeout(d),d=setTimeout(()=>{o()&&c.target!==document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement?.blur?.()},120))};return document.addEventListener("touchstart",u,{passive:!0}),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",l),document.removeEventListener("touchstart",u)}}),tu({getIsKeyboardVisible:r});var s=ue(),i=A(s);Ae(i,()=>e.children??Ye),g(t,s),ve()}function ru(t,e){fe(e,!0);const a=crypto.randomUUID(),r=(i,l)=>{i.postMessage(JSON.stringify({...l,tabId:a}))};Cd({tabId:a,createBroadcastChannel:()=>{const i=new BroadcastChannel("app");return{postMessage:l=>r(i,l),addEventListener:l=>{i.addEventListener("message",l)},removeEventListener:l=>{i.removeEventListener("message",l)}}}});var o=ue(),s=A(o);Ae(s,()=>e.children??Ye),g(t,o),ve()}function ou(t,e){Qd(t,{children:(a,r)=>{ru(a,{children:(o,s)=>{Bd(o,{children:(i,l)=>{Hd(i,{children:(d,u)=>{Wd(d,{children:(c,v)=>{Vd(c,{children:(h,p)=>{Yd(h,{children:(m,x)=>{Xd(m,{children:(w,k)=>{au(w,{children:(F,b)=>{eu(F,{children:(T,L)=>{$d(T,{children:(Y,O)=>{var U=ue(),R=A(U);Ae(R,()=>e.children??Ye),g(Y,U)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function su(t,e){ou(t,{children:(a,r)=>{dd(a,{children:(o,s)=>{id(o,{children:(i,l)=>{fd(i,{children:(d,u)=>{gd(d,{children:(c,v)=>{Fd(c,{children:(h,p)=>{pd(h,{children:(m,x)=>{yd(m,{children:(w,k)=>{Pd(w,{children:(F,b)=>{Ad(F,{children:(T,L)=>{Id(T,{children:(Y,O)=>{Od(Y,{children:(U,R)=>{var H=ue(),K=A(H);Ae(K,()=>e.children??Ye),g(U,H)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}const iu=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),wt=t=>{const e=iu(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let Dt=I(""),Gn=I(null),Wa=I(null),Dn=I(null),Xn=I(ft([])),zr=I(null),Qn=null;function ut(t,e){f(Dt,""),Qn=null,f(Wa,null),f(Dn,null),setTimeout(()=>{f(Dt,t,!0),e?.onFinish&&f(Wa,e.onFinish,!0),e?.cancel&&(f(Dn,e.cancel.onCancel,!0),Qn=e.cancel.nextFocusRef)},16)}var lu=P('<button type="button" class="c p-zc0ssu">undo</button>'),cu=P('<div class="a p-zc0ssu"><div class="b p-zc0ssu"><span> </span> <!></div></div>'),du=P("<div><!></div>");function ds(t,e){fe(e,!0);const a=Zn();be(()=>(f(Xn,[...n(Xn),a],!0),()=>{const d=n(Xn).indexOf(a);d!==-1&&f(Xn,n(Xn).filter((u,c)=>c!==d),!0)}));const r=d=>{if(d.key==="Tab"&&d.shiftKey){if(Qn&&n(Dt)){d.preventDefault();const{prev:u}=wt(Qn);u?.focus(),f(Dt,"")}}else if(d.key==="Tab"&&!d.shiftKey)Qn&&n(Dt)&&(d.preventDefault(),f(Dt,""),Qn?.focus());else if(d.key==="Escape"&&n(Dt)){if(d.preventDefault(),Qn){const{prev:u}=wt(Qn);u?.focus()}f(Dt,"")}};be(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)})),Fe(()=>{n(Dt);const d=n(Dn)?2e3:800;n(Dt)&&(n(Gn)?.getBoundingClientRect(),n(Gn)?.style.setProperty("opacity","1"));const u=setTimeout(()=>{n(Gn)?.style.removeProperty("opacity")},d),c=setTimeout(()=>{f(Dt,""),n(Wa)&&n(Wa)(),f(Wa,null),f(Dn,null),n(Gn)?.style.removeProperty("opacity")},d+400);return()=>{clearTimeout(u),clearTimeout(c)}});const o=d=>{d.preventDefault(),n(Dn)&&(f(Wa,null),n(Dn)(),f(Dn,null)),f(Dt,""),n(Gn)?.style.removeProperty("opacity")};Fe(()=>{n(Dt)&&n(Dn)&&n(zr)&&setTimeout(()=>{n(zr)?.focus()},151)}),Fe(()=>{n(Xn),zt(()=>{f(Dt,""),n(Gn)?.style.removeProperty("opacity")})});var s=du(),i=C(s);{var l=d=>{var u=cu(),c=C(u),v=C(c),h=C(v),p=D(v,2);{var m=x=>{var w=lu();w.__click=o,Ze(w,k=>f(zr,k),()=>n(zr)),g(x,w)};q(p,x=>{n(Dn)&&x(m)})}Ze(c,x=>f(Gn,x),()=>n(Gn)),xe(()=>dt(h,n(Dt))),g(d,u)};q(i,d=>{n(Dt)&&n(Xn)[n(Xn).length-1]===a&&d(l)})}g(t,s),ve()}ht(["click"]);var uu=P('<span class="a p-lxk90o"><!></span>');function pt(t,e){var a=uu(),r=C(a);Ae(r,()=>e.children),g(t,a)}var fu=Bc('<svg class="p-1yv1ibq"><use></use></svg>');function pe(t,e){let a=Ne(e,"name",8,"");var r=fu(),o=C(r);xe(()=>st(o,"href",`#icon-${a()??""}`)),g(t,r)}var vu=P('<button class="a p-1cnj0y3"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function ll(t,e){fe(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Mr(),{getDialogPages:s}=Jt(),{checkExistedDialog:i}=Zt();let l=N(()=>s().length>0||i());const d=h=>{if(h.preventDefault(),n(l))return;const p=r();p==="closed"?a():p==="opened"&&o()};var u=vu();u.__click=d;var c=C(u);ce(c,()=>({"--size":"32px"})),pe(c.lastChild,{name:"sidebarMenu"});var v=D(c,2);pt(v,{children:(h,p)=>{var m=Ie("Menu");g(h,m)}}),g(t,u),ve()}ht(["click"]);var gu=P('<button class="b p-3z9gmw"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),hu=P('<div class="a p-3z9gmw"><input class="p-3z9gmw"/> <!></div>');function Bo(t,e){fe(e,!0);let a=Ne(e,"value",15,""),r=Ne(e,"ref",15,null);const o=u=>{u.key==="Escape"&&(u.stopPropagation(),r()&&(e.onEscape?.(),r().blur()))};be(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=hu(),i=C(s);i.__input=u=>e.onChange?.(u.target?.value||""),Ze(i,u=>r(u),()=>r());var l=D(i,2);{var d=u=>{var c=gu();c.__click=()=>{a(""),e.onChange?.("")};var v=C(c);ce(v,()=>({"--size":"20px"})),pe(v.lastChild,{name:"close"});var h=D(v,2);pt(h,{children:(p,m)=>{var x=Ie("Clear");g(p,x)}}),g(u,c)};q(l,u=>{a()&&u(d)})}xe(()=>st(i,"placeholder",e.placeholder)),cn("focus",i,function(...u){e.onFocus?.apply(this,u)}),cn("blur",i,function(...u){e.onBlur?.apply(this,u)}),Ri(i,a),g(t,s),ve()}ht(["input","click"]);function us(t,e){fe(e,!0),be(()=>{const a=r=>{r.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==r.target&&!e.dialogInner.contains(r.target)&&e.onClose()};return document.addEventListener("click",a,{capture:!0}),()=>{document.removeEventListener("click",a,{capture:!0})}}),ve()}function pu(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const vn=pu(),mu=()=>{const t=navigator.userAgent;return/android/i.test(t)},En=mu(),Ah=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},Mh=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},br=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))};let ja=I(ft([]));var _u=P("<dialog><div><!></div></dialog> <!>",1);function Dr(t,e){fe(e,!0);const a=Zn(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;be(()=>(f(ja,[...n(ja),a],!0),()=>{const b=n(ja).indexOf(a);b!==-1&&f(ja,n(ja).filter((T,L)=>L!==b),!0)}));let o=Ne(e,"onClosed",3,()=>{}),s=Ne(e,"blocked",3,!1),i=I(null),l=I(null),d=I(!1),{dialogInc:u,dialogDec:c}=Zt();const v=()=>{const b=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(b),o()()},{once:!0}),f(d,!1)};Fe(()=>{e.startClose&&v()}),be(()=>{n(i)?.showModal(),n(i)?.getClientRects(),f(d,!0);const b=T=>{T?.preventDefault(),s()||v()};return n(i)?.addEventListener("cancel",b),n(i)?.addEventListener("close",b),()=>{n(i)?.removeEventListener("cancel",b),n(i)?.removeEventListener("close",b)}}),be(()=>(u(),()=>{c()})),be(()=>{const b=T=>{T.key==="Escape"&&s()&&T.preventDefault()};return window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}});function h(){setTimeout(()=>{if(vn||!n(i)||!n(l))return;const b=window.visualViewport;if(b)if(b.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},0)}be(()=>(h(),window.visualViewport?.addEventListener("resize",h),window.visualViewport?.addEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h),()=>{window.visualViewport?.removeEventListener("resize",h),window.visualViewport?.removeEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h)}));var p=_u(),m=A(p),x=C(m),w=C(x);Ae(w,()=>e.children),Ze(x,b=>f(l,b),()=>n(l)),Ze(m,b=>f(i,b),()=>n(i));var k=D(m,2);{var F=b=>{us(b,{get dialog(){return n(i)},get dialogInner(){return n(l)},onClose:v})};q(k,b=>{n(i)&&n(l)&&!s()&&b(F)})}xe(()=>{at(m,1,it({a:!0,b:n(d),c:n(ja).length>1}),"p-1x14yml"),at(x,1,it({d:!0,b:n(d)}),"p-1x14yml")}),g(t,p),ve()}var wu=P("<div><!></div>");function yu(t,e){fe(e,!0);let a=I(!1),r=I(null);const o=()=>{const c=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(c),e.onClosed()},{once:!0}),f(a,!1)},s=c=>{c.target!==n(r)&&!n(r)?.contains(c.target)&&o()},i=c=>{c.target!==n(r)&&!n(r)?.contains(c.target)&&o()},l=c=>{c.key==="Escape"&&o()};be(()=>{n(r)?.getClientRects(),f(a,!0);const c=setTimeout(()=>{document.addEventListener("focusin",s),document.addEventListener("click",i),document.addEventListener("keydown",l)},0);return()=>{clearTimeout(c),document.removeEventListener("focusin",s),document.removeEventListener("click",i),document.removeEventListener("keydown",l)}}),Fe(()=>{e.startClose&&o()});var d=wu(),u=C(d);Ae(u,()=>e.children),Ze(d,c=>f(r,c),()=>n(r)),xe(()=>at(d,1,it({a:!0,b:n(a)}),"p-1unpq18")),g(t,d),ve()}var bu=P("<ul><!></ul>"),Su=P("<ul><!></ul>");function Ir(t,e){fe(e,!0);let a=Ne(e,"ref",15);var r=ue(),o=A(r);{var s=l=>{Dr(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(d,u)=>{var c=bu(),v=C(c);Ae(v,()=>e.children),Ze(c,h=>a(h),()=>a()),xe(()=>at(c,1,it({a:!0,b:e.isMobile}),"p-6pddb9")),g(d,c)},$$slots:{default:!0}})},i=l=>{yu(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(d,u)=>{var c=Su(),v=C(c);Ae(v,()=>e.children),Ze(c,h=>a(h),()=>a()),xe(()=>at(c,1,it({a:!0,b:e.isMobile}),"p-6pddb9")),g(d,c)},$$slots:{default:!0}})};q(o,l=>{e.isMobile?l(s):l(i,!1)})}g(t,r),ve()}var Cu=P("<button><!></button>"),ku=P("<a><!></a>");function We(t,e){let a=Ne(e,"dangerous",3,!1),r=Ne(e,"type",3,"button"),o=Ne(e,"href",3,"");var s=ue(),i=A(s);{var l=u=>{var c=Cu();c.__click=function(...h){e.onClick?.apply(this,h)},c.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=C(c);Ae(v,()=>e.children??Ye),xe(()=>at(c,1,it({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1cyyat5")),g(u,c)},d=u=>{var c=ku();c.__click=function(...h){e.onClick?.apply(this,h)},c.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=C(c);Ae(v,()=>e.children??Ye),xe(()=>{st(c,"href",o()),at(c,1,it({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1cyyat5")}),g(u,c)};q(i,u=>{r()==="button"?u(l):u(d,!1)})}g(t,s)}ht(["click","keydown"]);var xu=P('<li class="p-vm5mum"><!></li> <li class="p-vm5mum"><!></li> <li class="p-vm5mum"><!></li> <li class="p-vm5mum"><!></li> <li class="p-vm5mum"><!></li> <li class="p-vm5mum"><!></li>',1),Tu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Eu=P('<div class="a p-vm5mum"><button><!> <!></button> <!></div>');function Pu(t,e){fe(e,!0);let a=I(!1),r=I(!1);const{getFeedOrder:o,setFeedOrder:s}=ji();let i=vn||En,l=N(o);const d=()=>{n(a)||f(a,!0)},u=k=>{f(r,!0),s(k)},c=()=>{f(a,!1),f(r,!1)};be(()=>{const k=F=>{F.key==="Escape"&&f(r,!0)};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)});var v=Eu(),h=C(v);h.__click=d,at(h,1,it({b:!0,c:!0}),"p-vm5mum");var p=C(h);pe(p,{name:"filter"});var m=D(p,2);pt(m,{children:(k,F)=>{var b=Ie("show feed order menu");g(k,b)}});var x=D(h,2);{var w=k=>{var F=Tu(),b=A(F);ce(b,()=>({"--right":"0px","--top":"44px"})),Ir(b.lastChild,{get startClose(){return n(r)},onClosed:c,get isMobile(){return i},children:(T,L)=>{var Y=xu(),O=A(Y),U=C(O);{let $=N(()=>n(l)==="newest");We(U,{get active(){return n($)},get dialogMode(){return i},onClick:()=>u("newest"),children:(te,se)=>{var ne=Ie("Newest");g(te,ne)},$$slots:{default:!0}})}var R=D(O,2),H=C(R);{let $=N(()=>n(l)==="oldest");We(H,{get active(){return n($)},get dialogMode(){return i},onClick:()=>u("oldest"),children:(te,se)=>{var ne=Ie("Oldest");g(te,ne)},$$slots:{default:!0}})}var K=D(R,2),ee=C(K);{let $=N(()=>n(l)==="AtoZ");We(ee,{get active(){return n($)},get dialogMode(){return i},onClick:()=>u("AtoZ"),children:(te,se)=>{var ne=Ie("A to Z");g(te,ne)},$$slots:{default:!0}})}var Z=D(K,2),j=C(Z);{let $=N(()=>n(l)==="ZtoA");We(j,{get active(){return n($)},get dialogMode(){return i},onClick:()=>u("ZtoA"),children:(te,se)=>{var ne=Ie("Z to A");g(te,ne)},$$slots:{default:!0}})}var we=D(Z,2),ie=C(we);{let $=N(()=>n(l)==="updatedNewest");We(ie,{get active(){return n($)},get dialogMode(){return i},onClick:()=>u("updatedNewest"),children:(te,se)=>{var ne=Ie("Updated");g(te,ne)},$$slots:{default:!0}})}var Q=D(we,2),V=C(Q);{let $=N(()=>n(l)==="updatedOldest");We(V,{get active(){return n($)},get dialogMode(){return i},onClick:()=>u("updatedOldest"),children:(te,se)=>{var ne=Ie("Updated rev");g(te,ne)},$$slots:{default:!0}})}g(T,Y)},$$slots:{default:!0}}),g(k,F)};q(x,k=>{n(a)&&k(w)})}g(t,v),ve()}ht(["click"]);var Nu=P('<div><!> <div class="a p-y3zt6o"></div></div>');function Ra(t,e){fe(e,!0);let a=I(!1);be(()=>{const s=setTimeout(()=>{f(a,!0)},200);return()=>{clearTimeout(s)}});var r=Nu(),o=C(r);Ae(o,()=>e.children??Ye),xe(()=>at(r,1,it({b:!0,c:n(a)}),"p-y3zt6o")),g(t,r),ve()}var Au=P("<a><!></a>"),Mu=P("<button><!></button>");function Lt(t,e){let a=Ne(e,"type",3,"standard"),r=Ne(e,"typeButton",3,"button"),o=Ne(e,"element",3,"button"),s=Ne(e,"href",3,""),i=Ne(e,"fullWidth",3,!1),l=Ne(e,"withoutMinWidth",3,!1);var d=ue(),u=A(d);{var c=h=>{var p=Au();p.__click=function(...x){e.onClick?.apply(this,x)};var m=C(p);Ae(m,()=>e.children??Ye),xe(()=>{st(p,"target",e.target),st(p,"rel",e.rel),st(p,"href",s()),at(p,1,it({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l()}),"p-117xh5e")}),g(h,p)},v=h=>{var p=Mu();p.__click=function(...x){e.onClick?.apply(this,x)};var m=C(p);Ae(m,()=>e.children??Ye),xe(()=>{st(p,"type",r()),at(p,1,it({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l()}),"p-117xh5e")}),g(h,p)};q(u,h=>{o()==="a"?h(c):h(v,!1)})}g(t,d)}ht(["click"]);let jo=I(!1),Br=I(!1),Ho=I(""),Uo=I("Cancel"),Wo=I("Confirm"),qo,qr=I(void 0),Vo,Ko=I("dangerous");function Va(t){f(jo,!0),f(Ho,t.title,!0),t.buttonCancelTitle&&f(Uo,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&f(Wo,t.buttonConfirmTitle,!0),qo=t.onConfirm,f(qr,t.onCancel,!0),Vo=t.onClosed,t.type?f(Ko,t.type,!0):f(Ko,"dangerous")}var Du=P('<span class="b p-1jlul5o"> </span> <div class="c p-1jlul5o"><!> <!></div>',1),Iu=P('<div class="a p-1jlul5o"><!></div>');function Lu(t,e){fe(e,!0);let a=I(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{f(a,!0)},250)};be(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(qr)?.(),f(Br,!0)},l=async()=>{s(),await qo?.(),f(Br,!0),o=!0},d=()=>{clearTimeout(r),f(a,!1),f(jo,!1),f(Br,!1),f(Ho,""),f(Uo,"Cancel"),f(Wo,"Confirm"),f(qr,void 0),qo=void 0,Vo&&Vo(o),o=!1};var u=ue(),c=A(u);{var v=h=>{Dr(h,{get blocked(){return n(a)},get startClose(){return n(Br)},onClosed:d,children:(p,m)=>{var x=Iu(),w=C(x);{var k=b=>{Ra(b,{})},F=b=>{var T=Du(),L=A(T),Y=C(L),O=D(L,2),U=C(O);{var R=K=>{Lt(K,{onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(ee,Z)=>{var j=Ie();xe(()=>dt(j,n(Uo))),g(ee,j)},$$slots:{default:!0}})};q(U,K=>{n(qr)&&K(R)})}var H=D(U,2);Lt(H,{onClick:l,fullWidth:!0,withoutMinWidth:!0,get type(){return n(Ko)},children:(K,ee)=>{var Z=Ie();xe(()=>dt(Z,n(Wo))),g(K,Z)},$$slots:{default:!0}}),xe(()=>dt(Y,n(Ho))),g(b,T)};q(w,b=>{n(a)?b(k):b(F,!1)})}g(p,x)},$$slots:{default:!0}})};q(c,h=>{n(jo)&&h(v)})}g(t,u),ve()}const Sr=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,l=a.ctrlKey,d=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!l&&!!t.shift==!!d){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var Ru=P('<div class="a p-6qmscy"><a class="b p-6qmscy"><span class="c p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function Ou(t,e){fe(e,!1);const{createDialogPageHref:a,createHandleClickDialogPage:r,getDialogPages:o,pushDialogPage:s}=Jt(),{checkExistedDialog:i}=Zt(),l=()=>{o.length===0&&!i()&&s(Ce.NewNote)};be(()=>Sr({key:"n",action:l})),os();var d=Ru(),u=C(d),c=N(()=>r(Ce.NewNote));u.__click=function(...w){n(c)?.apply(this,w)};var v=C(u),h=C(v);ce(h,()=>({"--size":"32px","--color":"#b0b0b0"})),pe(h.lastChild,{name:"add"});var p=D(h,2);pt(p,{children:(w,k)=>{var F=Ie("Add note");g(w,F)}});var m=D(v,2),x=C(m);ce(x,()=>({"--size":"16px","--color":"#b0b0b0"})),pe(x.lastChild,{name:"plus"}),xe(w=>st(u,"href",w),[()=>a(Ce.NewNote)]),g(t,d),ve()}ht(["click"]);var Fu=P("<button><!></button>");function ga(t,e){fe(e,!0);let a=Ne(e,"type",3,"button"),r=!1,o=I(null);Fe(()=>{e.onRef&&e.onRef(n(o))});const s=c=>{(c.key==="Enter"||c.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},l=c=>{(c.pointerType==="mouse"&&c.button===0||c.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(c)};var d=Fu();d.__keydown=s,d.__click=i,d.__pointerdown=l,d.__touchstart=function(...c){e.onTouchStart?.apply(this,c)};var u=C(d);Ae(u,()=>e.children??Ye),Ze(d,c=>f(o,c),()=>n(o)),xe(()=>{st(d,"type",a()),d.disabled=e.disabled,at(d,1,it({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty"}),"p-1g975vt")}),g(t,d),ve()}ht(["keydown","click","pointerdown","touchstart"]);var zu=P('<div class="b p-1pt17hy"> </div>'),Bu=P('<div class="a p-1pt17hy"><input/> <!></div>');function Cr(t,e){fe(e,!0);let a=Ne(e,"value",15,""),r=Ne(e,"error",3,""),o=Ne(e,"ref",15,null);var s=Bu(),i=C(s);i.__input=function(...c){e.onInput?.apply(this,c)};let l;Ze(i,c=>o(c),()=>o());var d=D(i,2);{var u=c=>{var v=zu(),h=C(v);xe(()=>dt(h,r())),g(c,v)};q(d,c=>{r()&&c(u)})}xe(()=>{st(i,"placeholder",e.placeholder),l=at(i,1,"p-1pt17hy",null,l,{error:!!r()})}),cn("blur",i,function(...c){e.onBlur?.apply(this,c)}),cn("focus",i,function(...c){e.onFocus?.apply(this,c)}),Ri(i,a),g(t,s),ve()}ht(["input"]);var ju=P('<div class="b p-y9ylet"> </div> <!> <div class="c p-y9ylet"><!> <!></div>',1),Hu=P('<form class="a p-y9ylet"><!></form>');function Uu(t,e){fe(e,!0);const{renameTag:a}=Bt(),{getSelectedTags:r,setSelectedTags:o}=Vn(),{getSelectedNotes:s,setSelectedNotes:i,clearNotes:l}=fa(),{getFiltredNotes:d}=Ia();let u=I(!1),c=I(!1),v,h=!1,p=I(null),m=I(ft(e.tag)),x=e.nextFocusRef;be(()=>(n(p)&&n(p).focus(),()=>{v&&clearTimeout(v)}));const w=()=>{v=setTimeout(()=>{f(c,!0)},250)},k=()=>{f(u,!0)},F=async()=>{if(n(m).trim()===e.tag){k();return}if(n(m).trim()!=="")try{w();const L=r(),Y=[...L].map(K=>K===e.tag?n(m).trim():K),O=new Set(s()),U=d(),R=O.size?[...O]:U.map(K=>K.id),{cancel:H}=await a(e.tag,n(m).trim(),R);l(),o(new Set(Y)),ut("Tag renamed",{cancel:{nextFocusRef:x,onCancel:async()=>{await H(),o(L),i(O),setTimeout(()=>{const{prev:K}=wt(x);K?.focus()},16)}}}),h=!0}finally{f(u,!0)}},b=()=>{e.onClosed?.(h)},T=L=>{L.preventDefault(),F()};Dr(t,{get blocked(){return n(c)},get startClose(){return n(u)},onClosed:b,children:(L,Y)=>{var O=Hu(),U=C(O);{var R=K=>{Ra(K,{})},H=K=>{var ee=ju(),Z=A(ee),j=C(Z),we=D(Z,2);Cr(we,{placeholder:"Enter new tag name",get ref(){return n(p)},set ref($){f(p,$,!0)},get value(){return n(m)},set value($){f(m,$,!0)}});var ie=D(we,2),Q=C(ie);Lt(Q,{onClick:k,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:($,te)=>{var se=Ie("Cancel");g($,se)},$$slots:{default:!0}});var V=D(Q,2);Lt(V,{onClick:F,fullWidth:!0,withoutMinWidth:!0,children:($,te)=>{var se=Ie("OK");g($,se)},$$slots:{default:!0}}),xe(()=>dt(j,`Rename "${e.tag??""}" for selected notes`)),g(K,ee)};q(U,K=>{n(c)?K(R):K(H,!1)})}cn("submit",O,T),g(L,O)},$$slots:{default:!0}}),ve()}let aa=I(!1),ha=I(!1),Yt=I(""),ma=I(0),vr=I(0),gr=I(0),Vr,Zr=()=>({bottom:0,right:0,height:0}),$t=I(null),Yo=I(null);function Wu(t){if(n(aa)){f(ha,!0),n(Yt)!==t.tag&&(Vr=()=>{const a=t.getRect();f(aa,!0),f(Yt,t.tag,!0),f(ma,a.bottom,!0),f(vr,a.right,!0),f(gr,a.height,!0),Zr=t.getRect,f($t,t.focusRef,!0)});return}const e=t.getRect();f(aa,!0),f(Yt,t.tag,!0),f(ma,e.bottom,!0),f(vr,e.right,!0),f(gr,e.height,!0),Zr=t.getRect,f($t,t.focusRef,!0)}const qu=()=>n(aa),Vu=()=>n(Yo);var Ku=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),Yu=P('<li class="p-16hbyw2"><!></li>'),Gu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),Xu=P('<li class="p-16hbyw2"><!></li>'),Ju=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),Zu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),Qu=P('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),$u=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ef=P("<!> <!>",1);function tf(t,e){fe(e,!0);const{getScrollContainer:a}=ho(),{pinTag:r,getGetMapTags:o,deleteTag:s}=Bt(),{checkMobileSize:i}=La(),{getSelectedTags:l,removeTag:d,setSelectedTags:u}=Vn(),{getSelectedNotes:c,setSelectedNotes:v,clearNotes:h}=fa(),{getFiltredNotes:p}=Ia();let m=I(!1);Fe(()=>{n(aa),zt(()=>{f(m,o()().get(n(Yt))?.pinned||!1,!0)})});let x=I(!1);const w=()=>{r(n(Yt),!0),f(ha,!0);let Q=n($t),V=wt(Q)?.next;ut("Tag pinned",{cancel:{nextFocusRef:V,onCancel:async()=>{r(n(Yt),!1),setTimeout(()=>{const{prev:$}=wt(V);$?.focus()},16)}}})},k=()=>{r(n(Yt),!1),f(ha,!0);let Q=n($t),V=wt(Q)?.next;ut("Tag unpinned",{cancel:{nextFocusRef:V,onCancel:async()=>{r(n(Yt),!0),setTimeout(()=>{const{prev:$}=wt(V);$?.focus()},16)}}})},F=()=>{f(aa,!1),f(ha,!1),f(ma,0),f(vr,0),f(gr,0),Zr=()=>({bottom:0,right:0,height:0}),f($t,null),Vr&&setTimeout(()=>{Vr?.(),Vr=void 0})};let b=N(()=>window.innerHeight-n(ma)<100?n(ma)-n(gr)-98+"px":n(ma)+5+"px"),T=N(a);const L=Q=>{Q.key==="Tab"&&Q.shiftKey&&(Q.preventDefault(),n($t)?.focus())},Y=Q=>{Q.key==="Tab"&&!Q.shiftKey&&n($t)&&(Q.preventDefault(),wt(n($t))?.next?.focus())};be(()=>{const Q=V=>{V.key==="Escape"&&n(aa)&&n($t)?.focus()};return window.addEventListener("keydown",Q),()=>{window.removeEventListener("keydown",Q)}});const O=()=>{f(ha,!0);let Q=n($t),V=wt(Q)?.next;Va({title:`Are you sure to delete "${n(Yt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const $=Array.from(n(H)),te=new Set(c()),se=p(),ne=te.size?[...te]:se.map(me=>me.id);n(H).has(n(Yt))&&(te.size===0||se.length===te.size)&&d(n(Yt)),h();const{cancel:de}=await s(n(Yt),ne);ut("Tag deleted",{cancel:{nextFocusRef:V,onCancel:async()=>{await de(),u(new Set($)),v(new Set(te)),setTimeout(()=>{const{prev:me}=wt(V);me?.focus()},16)}}})},onCancel:async()=>{},onClosed:$=>{setTimeout(()=>{$||Q?.focus()},16)}})};let U=()=>{};const R=()=>{f(ha,!0),f(x,!0);let Q=n($t);U=()=>{f(x,!1),setTimeout(()=>{Q?.focus()},16)}};Fe(()=>{const Q=()=>{const V=Zr();f(ma,V.bottom,!0),f(vr,V.right,!0),f(gr,V.height,!0)};return n(T)?.addEventListener("scroll",Q),window.addEventListener("resize",Q),()=>{n(T)?.removeEventListener("scroll",Q),window.removeEventListener("resize",Q)}});let H=N(l),K=N(i);var ee=ef(),Z=A(ee);{var j=Q=>{var V=$u(),$=A(V);ce($,()=>({"--left":n(vr)-36+"px","--top":n(b),"--transform-origin":"top left"})),Ir($.lastChild,{get startClose(){return n(ha)},onClosed:F,get isMobile(){return n(K)},get ref(){return n(Yo)},set ref(te){f(Yo,te,!0)},children:(te,se)=>{var ne=Qu(),de=A(ne);{var me=Te=>{var Me=Yu(),Oe=C(Me);We(Oe,{onClick:w,onKeydown:L,get dialogMode(){return n(K)},children:(Ee,G)=>{var y=Ku(),E=A(y);ce(E,()=>({"--size":"20px"})),pe(E.lastChild,{name:"pin"}),g(Ee,y)},$$slots:{default:!0}}),g(Te,Me)},ae=Te=>{var Me=Xu(),Oe=C(Me);We(Oe,{onClick:k,onKeydown:L,get dialogMode(){return n(K)},children:(Ee,G)=>{var y=Gu(),E=A(y);ce(E,()=>({"--size":"20px"})),pe(E.lastChild,{name:"pin-cancel"}),g(Ee,y)},$$slots:{default:!0}}),g(Te,Me)};q(de,Te=>{n(m)?Te(ae,!1):Te(me)})}var J=D(de,2),le=C(J);We(le,{onClick:R,get dialogMode(){return n(K)},children:(Te,Me)=>{var Oe=Ju(),Ee=A(Oe);ce(Ee,()=>({"--size":"20px"})),pe(Ee.lastChild,{name:"pen"}),g(Te,Oe)},$$slots:{default:!0}});var Se=D(J,2),_e=C(Se);We(_e,{onClick:O,onKeydown:Y,dangerous:!0,get dialogMode(){return n(K)},children:(Te,Me)=>{var Oe=Zu(),Ee=A(Oe);ce(Ee,()=>({"--size":"20px"})),pe(Ee.lastChild,{name:"bin"}),g(Te,Oe)},$$slots:{default:!0}}),g(te,ne)},$$slots:{default:!0}}),g(Q,V)};q(Z,Q=>{n(aa)&&Q(j)})}var we=D(Z,2);{var ie=Q=>{{let V=N(()=>wt(n($t))?.next||null);Uu(Q,{get tag(){return n(Yt)},get nextFocusRef(){return n(V)},onClosed:$=>{U($)}})}};q(we,Q=>{n(x)&&Q(ie)})}g(t,ee),ve()}var nf=P('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),af=P('<button><span class="b p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),rf=P("<!> <span> </span> <!>",1),of=P('<div class="a p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function hr(t,e){fe(e,!0);let{getGetMapTags:a}=Bt(),r=I(null),o=N(qu);const s=()=>{if(n(r)){const v=n(r).getBoundingClientRect();return{bottom:v.bottom,right:v.right,height:v.height}}return{bottom:0,right:0,height:0}},i=v=>{v.stopPropagation(),v.preventDefault(),Wu({tag:e.tag,getRect:s,focusRef:n(r)})},l=v=>{v.key==="Tab"&&!v.shiftKey&&n(o)&&(v.preventDefault(),Vu()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let d=N(()=>a()().get(e.tag)?.pinned||!1);var u=of(),c=C(u);ce(c,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),ga(c.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(v,h)=>{var p=rf(),m=A(p);{var x=T=>{var L=nf(),Y=C(L);ce(Y,()=>({"--size":"18px"})),pe(Y.lastChild,{name:"pin"}),g(T,L)};q(m,T=>{n(d)&&T(x)})}var w=D(m,2),k=C(w),F=D(w,2);{var b=T=>{var L=af();L.__click=i,L.__keydown=l;var Y=C(L),O=C(Y);ce(O,()=>({"--size":"16px"})),pe(O.lastChild,{name:"menu"});var U=D(O,2);pt(U,{children:(R,H)=>{var K=Ie("Tag options");g(R,K)}}),Ze(L,R=>f(r,R),()=>n(r)),xe(()=>at(L,1,it({c:!0,d:e.type==="selected"}),"p-9jjlcl")),g(T,L)};q(F,T=>{e.hideMenu||T(b)})}xe(()=>dt(k,e.tag)),g(v,p)},$$slots:{default:!0}}),g(t,u),ve()}ht(["click","keydown"]);var sf=P('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function Ds(t,e){fe(e,!0);let a=Ne(e,"mobile",3,!1);const{getGetMapTags:r}=Bt();let s=N(()=>{const p=r()();return[...e.tags].sort((m,x)=>p.get(m)?.pinned?-1:p.get(x)?.pinned?1:m.localeCompare(x))}),i=N(()=>n(s).filter(p=>r()().get(p)?.pinned)),l=N(()=>n(s).filter(p=>!r()().get(p)?.pinned));var d=sf(),u=C(d),c=C(u);jn(c,16,()=>n(i),p=>p,(p,m)=>{hr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return m},onClick:()=>{e.handleTagClick(m)}})});var v=D(c,2);jn(v,17,()=>e.metaTags,p=>"meta"+p,(p,m)=>{hr(p,{hideMenu:!0,get tag(){return n(m)},onClick:()=>{e.handleMetaTagClick(n(m))}})});var h=D(v,2);jn(h,16,()=>n(l),p=>p,(p,m)=>{hr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return m},onClick:()=>{e.handleTagClick(m)}})}),xe(()=>at(u,1,it({b:!0,c:a()}),"p-lawyrs")),g(t,d),ve()}var lf=P('<div class="b c p-32813r"><div class="d p-32813r"><button class="e p-32813r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),cf=P('<div class="a p-32813r"><!></div>');function Is(t,e){fe(e,!0);let a=I(null);const r=d=>{f(a,d,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};Fe(()=>{n(a)&&n(a).focus()});var s=cf(),i=C(s);{var l=d=>{var u=lf(),c=C(u),v=C(c);v.__click=o;var h=C(v);ce(h,()=>({"--size":"20px"})),pe(h.lastChild,{name:"close"});var p=D(h,2);pt(p,{children:(w,k)=>{var F=Ie("Clear");g(w,F)}});var m=D(c,2);jn(m,19,()=>e.metaTags,w=>"meta_"+w,(w,k,F)=>{{let b=N(()=>n(F)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);hr(w,{hideMenu:!0,type:"selected",get tag(){return n(k)},onClick:()=>{e.handleMetaTagClick(n(k))},get onRef(){return n(b)}})}});var x=D(m,2);jn(x,18,()=>e.selectedTags,w=>w,(w,k,F)=>{{let b=N(()=>n(F)===e.selectedTags.size-1?r:void 0);hr(w,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return k},onClick:()=>{e.handleSelectedTagClick(k)},get onRef(){return n(b)}})}}),g(d,u)};q(i,d=>{e.selectedTags.size+e.metaTags.size>0&&d(l)})}g(t,s),ve()}ht(["click"]);const Go=(t,e,a,r)=>{if(t.has(et.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const l of i?.data?.tags||[])o.includes(l)||o.push(l);continue}if(i.data&&s.every(l=>i.data?.tags.includes(l)))for(const l of i.data.tags||[])!e.has(l)&&!o.includes(l)&&o.push(l)}return o},Hn=200,df=t=>t<.5?2*t*t:-1+(4-2*t)*t,cl=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,df(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},uf=t=>{const{getIsKeyboardVisible:a}=nu();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},l=v=>({x:v.clientX,y:v.clientY,time:performance.now()}),d=v=>{r=[l(v.touches[0])],o=!0},u=v=>{if(!o||s)return;r.push(l(v.touches[0]));const h=performance.now()-150;r=r.filter(O=>O.time>=h);const p=r.at(-1),m=r[0];if(!p||!m)return;const x=m.x,w=m.y,k=p.x,F=p.y,b=k-x,T=F-w,L=Math.abs(b)>Math.abs(T),Y=Math.abs(b)>3;L&&Y&&!a()&&(s=!0,v.preventDefault(),t([...r]),i())},c=()=>{i()};be(()=>(document.addEventListener("touchstart",d,{passive:!0}),document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",c,{passive:!0}),document.addEventListener("touchcancel",c,{passive:!0}),()=>{document.removeEventListener("touchstart",d),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",c),document.removeEventListener("touchcancel",c)}))},Ls=5,Rs=.6,da=.3;function dl(t,e){fe(e,!0);let a=[],r=0,o=!1,s=0,i=0,l=0,d=0,u=0,c=null,v=null;const h=()=>{a=[],r=0,o=!1,s=0,i=0,l=0,d=0,u=0,c!==null&&(cancelAnimationFrame(c),c=null),v&&(clearTimeout(v),v=null)},p=()=>{e.onCancel(),h()},m=()=>{v&&clearTimeout(v),v=setTimeout(p,5e3)};uf(async Y=>{if(!o)try{const O=Y.at(-1);if(!O)throw new Error("No points available for swipe initialization");const U=await e.onInit();if(!U)return;s=U.initialPosition,i=U.currentPosition,l=U.minPosition,d=U.maxPosition,u=U.width,r=O.x,a=Y,o=!0,m()}catch(O){console.error("Error during swipe initialization:",O),h()}});const w=Y=>Math.max(l,Math.min(d,Y)),k=()=>{if(c=null,!o){h();return}const Y=a.at(-1),O=a[0];if(!Y||!O)return;let U=Y.x-r;r=Y.x;const R=w(i+U);R!==i&&(i=R,e.onUpdate({initialPosition:s,newPosition:R,width:u,minPosition:l,maxPosition:d}))},F=Y=>{if(!o){h();return}a.push({x:Y.touches[0].clientX,y:Y.touches[0].clientY,time:performance.now()});const O=performance.now()-150;a=a.filter(K=>K.time>=O),c===null&&(c=requestAnimationFrame(k)),m();const U=Y.touches[0].clientX-a[0].x,R=Y.touches[0].clientY-a[0].y;Math.abs(U)>Math.abs(R)&&Y.cancelable&&Y.preventDefault()},b=Y=>{const O=Math.abs(Y);if(O>=Rs)return Ls;if(O>=da){const U=(O-da)/(Rs-da);return e.baseActionThreshold-U*(e.baseActionThreshold-Ls)}else return e.baseActionThreshold},T=Y=>{if(!o){h();return}let O=0;a.push({x:Y.changedTouches[0].clientX,y:Y.changedTouches[0].clientY,time:performance.now()}),k(),c!==null&&(cancelAnimationFrame(c),c=null);const U=a[0],R=a[a.length-1],H=R.x-U.x,K=R.time-U.time;K>0&&(O=H/K);const ee=b(O);e.onFinish({swipeVelocity:O,currentPosition:i,minPosition:l,maxPosition:d,initialPosition:s,width:u,actionThreshold:ee}),h()},L=()=>{p()};be(()=>(document.addEventListener("touchmove",F,{passive:!1}),document.addEventListener("touchend",T,{passive:!0}),document.addEventListener("touchcancel",L,{passive:!0}),()=>{document.removeEventListener("touchmove",F),document.removeEventListener("touchend",T),document.removeEventListener("touchcancel",L),c!==null&&cancelAnimationFrame(c),v&&clearTimeout(v)})),ve()}function ff(t,e){fe(e,!0);const a=Kn();let r=Ne(e,"animationRef",7),o=Ne(e,"dialog",7);dl(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const u=-e.dialogWidth*.7,c=0;let v=e.sidebarState==="closed"?u:c,h=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let x=()=>1;if(r().current){r().current.pause();let w=Number(r().current.currentTime);br()&&(w=Number(w)+50,r().current.currentTime=Math.min(Math.max(Hn-1,w),w));const k=r().current.effect?.getComputedTiming().progress||0;x=()=>k,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(w=>requestAnimationFrame(w)),h=Math.abs(1-x())}h=e.sidebarState==="closed"?h:1-h,o().style.setProperty("--backdrop-bg",`${h*.1}`),o()&&!o().open&&(o().showModal(),br()&&o().getBoundingClientRect()),a.isSwiping=!0,a.duration=0,a.swipingRatio=h*-25;const p=h*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let m=e.sidebarState==="closed"?u:c;return e.sidebarState==="opened"||e.sidebarState==="closed"||(m=p),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:v,currentPosition:m,minPosition:u,maxPosition:c,width:e.dialogWidth}},onCancel:()=>{a.isSwiping=!1,e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:u,width:c})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const v=1-Math.abs(u/c)/7*10;o().style.transform=`translate3d(${u}px, 0, 0)`,a.swipingRatio=v*-25,o().style.setProperty("--backdrop-bg",`${v*.1}`)},onFinish:({swipeVelocity:u,currentPosition:c,initialPosition:v,width:h,actionThreshold:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let m="close";const x=Math.abs(c-v)/h*100/7*10;if(x===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(x===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?m=Math.abs(x)>p||u>da?"open":"close":e.sidebarState==="swipingClose"&&(m=Math.abs(x)>p&&u<=da||u<-da?"close":"open");let w=cl(Math.abs(x)/100);e.sidebarState==="swipingClose"&&m==="close"&&(w=1-w);const k=(m==="open"?1-w:w)*Hn;a.duration=k/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),o().style.setProperty("--backdrop-bg",`${m==="open"?.1:0}`),m==="open"?e.onOpen():m==="close"&&e.onClose()}}),ve()}var vf=P("<dialog><div><!> <!></div></dialog> <!> <!>",1);function gf(t,e){fe(e,!0);const{getSidebarState:a,setSidebarState:r}=Mr();let o=I(0);be(()=>{const j=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",j),j(),()=>{window.removeEventListener("resize",j)}});const s=Kn(),{isScrolling:i}=ls();let l=I(null),d=I(null),u={},c=N(a);const v=()=>{e.blocked||r("closing")},h=j=>{r(j==="open"?"swipingOpen":"swipingClose")},p=()=>{r("opened")},m=()=>{r("preOpening")},x=()=>{n(l)?.close(),r("closed")},w=j=>{j.preventDefault(),v()};be(()=>(n(l)?.addEventListener("close",x),n(l)?.addEventListener("cancel",w),()=>{n(l)?.removeEventListener("close",x),n(l)?.removeEventListener("cancel",w)}));const k=N(i);let F=N(()=>s.working);const b=j=>{j?(r("opened"),s.swipingRatio=-25):(r("closed"),s.swipingRatio=0,n(l)?.close()),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ca().duration};Fe(()=>{n(c)==="opening"?zt(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=-25,n(l).style.removeProperty("--backdrop-bg");const j=n(l).style.transform||"translate3d(-100%, 0, 0)";n(l).style.transform="";const we=n(l)?.animate([{transform:j},{transform:"translate3d(0, 0, 0)"}],{duration:s.duration*1e3||Hn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});u.current=we,we&&(we.onfinish=()=>{p(),s.swipingRatio=-25,n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ca().duration,we.cancel(),u.current=void 0})})}):n(c)==="closing"&&zt(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=0,n(l).style.removeProperty("--backdrop-bg");const j=n(l).style.transform||"translate3d(0, 0, 0)";n(l).style.transform="";const we=n(l)?.animate([{transform:j},{transform:"translate3d(-100%, 0, 0)"}],{duration:s.duration*1e3||Hn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});u.current=we,we&&(we.onfinish=()=>{x(),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ca().duration,we.cancel(),u.current=void 0})})})}),Fe(()=>{n(c)==="preOpening"&&(n(l)?.open||(n(l)?.showModal(),br()&&n(l)?.getBoundingClientRect()),r("opening"))}),be(()=>{n(c)==="opened"&&r("preOpening")});var T=vf(),L=A(T),Y=C(L),O=C(Y);Ae(O,()=>e.children);var U=D(O,2);{var R=j=>{ds(j,{})};q(U,j=>{n(c)==="opened"&&j(R)})}Ze(Y,j=>f(d,j),()=>n(d)),Ze(L,j=>f(l,j),()=>n(l));var H=D(L,2);{var K=j=>{us(j,{get dialog(){return n(l)},get dialogInner(){return n(d)},onClose:v})};q(H,j=>{n(d)&&n(c)==="opened"&&!e.blocked&&j(K)})}var ee=D(H,2);{var Z=j=>{ff(j,{onCancelSwipe:b,onOpen:m,onClose:v,onSwipe:h,get dialogWidth(){return n(o)},get animationRef(){return u},get dialog(){return n(l)},get sidebarState(){return n(c)}})};q(ee,j=>{!n(k)&&!e.blocked&&j(Z)})}xe(()=>{at(L,1,it({a:!0,b:n(F),c:n(c)==="opened"||n(c)==="opening"||n(c)==="closing"||n(c)==="swipingClose",d:n(c)==="opened"||n(c)==="opening"||n(c)==="swipingOpen"}),"p-1gucilc"),at(Y,1,it({e:!0,f:n(c)==="swipingOpen",g:n(c)!=="opened"}),"p-1gucilc")}),g(t,T),ve()}var hf=P('<div class="a p-1lsyiiu"><div class="b p-1lsyiiu"><!> <div class="c p-1lsyiiu"><a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <div class="e p-1lsyiiu"><!></div> <!></div> <!>',1),pf=P('<div class="f p-1lsyiiu"><div class="e p-1lsyiiu"><!></div> <div class="g p-1lsyiiu"><div class="a p-1lsyiiu"><!></div> <!></div></div>');function mf(t,e){fe(e,!0);const{checkMobileSize:a}=La(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Mr(),{getDialogPages:i,createDialogPageHref:l,createHandleClickDialogPage:d}=Jt(),{getTagsSearch:u,setTagsSearch:c}=cd(),{getSelectedTags:v,addTag:h,removeTag:p,clearTags:m}=Vn(),{getSelectedMetaTags:x,addMetaTag:w,removeMetaTag:k,clearSelectedMetaTags:F}=go();let b=N(v),T=N(x);const{getGetNotes:L,checkNotesInArchive:Y,checkNotesInBin:O}=Bt(),U=N(L),R=ae=>{h(ae)},H=ae=>{w(ae)},K=ae=>{p(ae)},ee=ae=>{k(ae)};let Z=N(()=>n(b).size===0&&!n(T).has(et.INBOX)&&(n(U)()||[]).some(ae=>(!n(T).has(et.ARCHIVED)&&!n(T).has(et.BIN)&&ae?.data&&!ae.data.deletedAt&&!ae.data.archivedAt||n(T).has(et.ARCHIVED)&&ae?.data&&!ae.data.deletedAt&&ae.data.archivedAt||n(T).has(et.BIN)&&ae?.data&&ae.data.deletedAt)&&ae?.data?.tags.length===0)),j=N(()=>Go(n(T),n(b),n(U)()||[],ae=>!(ae?.data&&(ae.data.deletedAt||ae.data.archivedAt)&&!n(T).has(et.ARCHIVED)&&!n(T).has(et.BIN)||ae?.data&&(ae.data.deletedAt||!ae.data.archivedAt)&&n(T).has(et.ARCHIVED)||ae?.data&&!ae.data.deletedAt&&n(T).has(et.BIN)))),we=N(()=>n(j).filter(ae=>u()===""||ae.toLowerCase().indexOf(u().toLowerCase())!==-1)),ie=N(a);const{checkExistedDialog:Q}=Zt();let V=N(()=>i().length>0||Q());const $=()=>{if(n(ie)){if(n(V))return;o()==="opened"?r():o()==="closed"&&s()}};be(()=>Sr({key:"b",meta:!0,action:$})),be(()=>Sr({key:"b",ctrl:!0,action:$}));let te=N(()=>[...n(Z)&&n(T).size===0?[et.INBOX]:[],...n(T).size===0?[...Y()&&n(b).size===0?[et.ARCHIVED]:[],...O()&&n(b).size===0?[et.BIN]:[]]:[]].filter(ae=>u()===""||ae.toLowerCase().indexOf(u().toLowerCase())!==-1).sort((ae,J)=>ae===et.INBOX?-1:J===et.INBOX?1:ae.localeCompare(J)));var se=ue(),ne=A(se);{var de=ae=>{gf(ae,{get blocked(){return n(V)},children:(J,le)=>{var Se=hf(),_e=A(Se),Te=C(_e),Me=C(Te);ll(Me,{});var Oe=D(Me,2),Ee=C(Oe),G=N(()=>d(Ce.Settings));Ee.__click=function(...X){n(G)?.apply(this,X)};var y=C(Ee);ce(y,()=>({"--size":"24px"})),pe(y.lastChild,{name:"settings"});var E=D(y,2);pt(E,{children:(X,re)=>{var ye=Ie("Settings");g(X,ye)}});var _=D(Ee,2),S=N(()=>d(Ce.Sync));_.__click=function(...X){n(S)?.apply(this,X)};var z=C(_);ce(z,()=>({"--size":"24px"})),pe(z.lastChild,{name:"sync"});var M=D(z,2);pt(M,{children:(X,re)=>{var ye=Ie("Sync");g(X,ye)}});var oe=D(Te,2),ge=C(oe);{let X=N(u);Bo(ge,{placeholder:"Search tag",get value(){return n(X)},onChange:re=>{c(re)}})}var he=D(oe,2);{let X=N(()=>n(T).has(et.BIN));Is(he,{get clearTags(){return m},get clearMetaTags(){return F},get hideTagMenu(){return n(X)},handleMetaTagClick:ee,get metaTags(){return n(T)},get selectedTags(){return n(b)},handleSelectedTagClick:K})}var W=D(_e,2);{let X=N(()=>n(T).has(et.BIN));Ds(W,{get hideTagMenu(){return n(X)},get metaTags(){return n(te)},get tags(){return n(we)},handleMetaTagClick:H,handleTagClick:R,mobile:!0})}xe((X,re)=>{st(Ee,"href",X),st(_,"href",re)},[()=>l(Ce.Settings),()=>l(Ce.Sync)]),g(J,Se)},$$slots:{default:!0}})},me=ae=>{var J=pf(),le=C(J),Se=C(le);{let Ee=N(u);Bo(Se,{placeholder:"Search tag",get value(){return n(Ee)},onChange:G=>{c(G)}})}var _e=D(le,2),Te=C(_e),Me=C(Te);{let Ee=N(()=>n(T).has(et.BIN));Is(Me,{get metaTags(){return n(T)},get clearTags(){return m},get clearMetaTags(){return F},get hideTagMenu(){return n(Ee)},get selectedTags(){return n(b)},handleMetaTagClick:ee,handleSelectedTagClick:K})}var Oe=D(Te,2);{let Ee=N(()=>n(T).has(et.BIN));Ds(Oe,{get metaTags(){return n(te)},get hideTagMenu(){return n(Ee)},get tags(){return n(we)},handleMetaTagClick:H,handleTagClick:R})}g(ae,J)};q(ne,ae=>{n(ie)?ae(de):ae(me,!1)})}g(t,se),ve()}ht(["click"]);var _f=P('<button class="a p-1rhvlnb"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function wf(t,e){fe(e,!0);let a=Ne(e,"ref",15);var r=_f();r.__click=function(...i){e.onClick?.apply(this,i)};var o=C(r);ce(o,()=>({"--rotate":"-90deg"})),pe(o.lastChild,{name:"menu"});var s=D(o,2);pt(s,{children:(i,l)=>{var d=Ie();xe(()=>dt(d,e.title)),g(i,d)}}),Ze(r,i=>a(i),()=>a()),g(t,r),ve()}ht(["click"]);const Xo=t=>{try{new URL(t)}catch{return!1}return!0};var yf=P('<div class="b p-y9ylet">Add tag for selected notes</div> <!> <div class="c p-y9ylet"><!> <!></div>',1),bf=P('<form class="a p-y9ylet"><!></form>');function Sf(t,e){fe(e,!0);const{addTag:a}=Bt(),{getSelectedTags:r}=Vn(),{getSelectedNotes:o}=fa(),{getFiltredNotes:s}=Ia();let i=I(!1),l=I(!1),d,u=!1,c=I(null),v=I(""),h=e.nextFocusRef;be(()=>(n(c)&&n(c).focus(),()=>{d&&clearTimeout(d)}));const p=()=>{d=setTimeout(()=>{f(l,!0)},250)},m=()=>{f(i,!0)},x=async()=>{if(r().has(n(v).trim())){m();return}if(n(v).trim()!=="")try{p();const b=new Set(o()),T=b.size?[...b]:s().map(Y=>Y.id),{cancel:L}=await a(n(v).trim(),T);ut("Tag added",{cancel:{nextFocusRef:h,onCancel:async()=>{await L(),setTimeout(()=>{const{prev:Y}=wt(h);Y?.focus()},16)}}}),u=!0}finally{f(i,!0)}},w=()=>{e.onClosed?.(u)},k=F=>{F.preventDefault(),x()};Dr(t,{get blocked(){return n(l)},get startClose(){return n(i)},onClosed:w,children:(F,b)=>{var T=bf(),L=C(T);{var Y=U=>{Ra(U,{})},O=U=>{var R=yf(),H=D(A(R),2);Cr(H,{placeholder:"Enter new tag name",get ref(){return n(c)},set ref(j){f(c,j,!0)},get value(){return n(v)},set value(j){f(v,j,!0)}});var K=D(H,2),ee=C(K);Lt(ee,{onClick:m,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(j,we)=>{var ie=Ie("Cancel");g(j,ie)},$$slots:{default:!0}});var Z=D(ee,2);Lt(Z,{onClick:x,fullWidth:!0,withoutMinWidth:!0,children:(j,we)=>{var ie=Ie("OK");g(j,ie)},$$slots:{default:!0}}),g(U,R)};q(L,U=>{n(l)?U(Y):U(O,!1)})}cn("submit",T,k),g(F,T)},$$slots:{default:!0}}),ve()}var Cf=P('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),kf=P('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),xf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Tf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),Ef=P("<div><!></div>"),Pf=P('<form class="c p-r3if1j"><div class="d p-r3if1j"><!></div> <button type="button" class="e p-r3if1j">Done</button></form>'),Nf=P('<div class="a"><div class="b p-r3if1j"><!> <!> <!> <!> <!> <!></div> <!></div>');function ul(t,e){fe(e,!0);const{isInitedNotes:a,getGetMapTags:r,getGetNotes:o}=Bt(),{getSelectedTags:s}=Vn();let i=I(null),l=I(""),d=I(null);const u=N(a);let c=Ne(e,"shownTagInput",15);const v=()=>n(u)?e.mode==="exit"?Go(new Set,new Set(e.selectedTags),o()()||[]):[...r()().keys()]:[];let p=N(()=>{const V=s(),$=new Set(Go(new Set,new Set(e.selectedTags.length>0?e.selectedTags:V),o()()||[]));return v().filter(se=>e.selectedTags.some(ne=>se===ne)?!1:n(l)===""||se.toLowerCase().indexOf(n(l).toLowerCase())===0).sort((se,ne)=>V.has(se)&&V.has(ne)?se.localeCompare(ne):V.has(se)?-1:V.has(ne)?1:$.has(se)&&$.has(ne)?se.localeCompare(ne):$.has(se)?-1:$.has(ne)?1:0)});const m=V=>{if(!e.selectedTags.includes(V)){if(e.mode!=="exit"||n(p).includes(V)){e.onChangeTags([...e.selectedTags,V]),f(l,"");return}n(i)?.focus()}},x=V=>{const $=e.selectedTags.filter(te=>te!==V);e.onRejectedTag&&e.onRejectedTag(V),$.length===0?e.onChangeTags([]):e.onChangeTags($)},w=V=>{V.preventDefault(),n(l)!==""?m(n(l)):c(!1)};Fe(()=>{n(i)&&c()&&n(i).focus(),c()||f(l,"")});const k=V=>{V.preventDefault()},F=V=>{V.preventDefault(),V.stopPropagation(),V.stopImmediatePropagation()};var b=Nf(),T=C(b),L=C(T);jn(L,17,()=>e.selectedTags,V=>V+"-tags_selected",(V,$)=>{ga(V,{onPointerDown:k,onTouchStart:F,onClick:()=>{x(n($))},type:"button",style:"selected",children:(te,se)=>{var ne=Ie();xe(()=>dt(ne,n($))),g(te,ne)},$$slots:{default:!0}})});var Y=D(L,2);{var O=V=>{var $=ue(),te=A($);jn(te,17,()=>n(p).filter(se=>se.toLowerCase()!==n(l).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),se=>se+"-tags_suggested",(se,ne)=>{ga(se,{onPointerDown:k,onTouchStart:F,onClick:()=>{m(n(ne))},children:(de,me)=>{var ae=Ie();xe(()=>dt(ae,n(ne))),g(de,ae)},$$slots:{default:!0}})}),g(V,$)};q(Y,V=>{c()&&V(O)})}var U=D(Y,2);{var R=V=>{ga(V,{onPointerDown:k,onTouchStart:F,onClick:()=>{m(n(l)),f(l,"")},children:($,te)=>{var se=Ie();xe(()=>dt(se,n(l))),g($,se)},$$slots:{default:!0}})};q(U,V=>{n(l)!==""&&(e.mode!=="exit"||n(p).find($=>$.toLowerCase()===n(l).toLowerCase()))&&V(R)})}var H=D(U,2);{var K=V=>{ga(V,{mode:"empty",onPointerDown:k,onTouchStart:F,onClick:()=>{c(!0)},children:($,te)=>{var se=Cf(),ne=C(se);ce(ne,()=>({"--size":"12px"})),pe(ne.lastChild,{name:"plus"});var de=D(ne,2);pt(de,{children:(me,ae)=>{var J=Ie("add tag");g(me,J)}}),g($,se)},$$slots:{default:!0}})};q(H,V=>{c()||V(K)})}var ee=D(H,2);{var Z=V=>{ga(V,{mode:"empty",onPointerDown:k,onTouchStart:F,get onClick(){return e.onUsePreviousTags},children:($,te)=>{var se=kf(),ne=C(se);ce(ne,()=>({"--size":"12px"})),pe(ne.lastChild,{name:"back"});var de=D(ne,2);pt(de,{children:(me,ae)=>{var J=Ie("use previous tags");g(me,J)}}),g($,se)},$$slots:{default:!0}})};q(ee,V=>{e.previousTagsEnabled&&e.onUsePreviousTags&&V(Z)})}var j=D(ee,2);{var we=V=>{ga(V,{mode:"empty",onPointerDown:k,onTouchStart:F,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:($,te)=>{var se=Ef(),ne=C(se);{var de=ae=>{var J=xf(),le=A(J);ce(le,()=>({"--size":"12px"})),Ra(le.lastChild,{}),g(ae,J)},me=ae=>{var J=Tf(),le=A(J);ce(le,()=>({"--size":"12px","--rotate":"180deg"})),pe(le.lastChild,{name:"stars"});var Se=D(le,2);pt(Se,{children:(_e,Te)=>{var Me=Ie("gen tags");g(_e,Me)}}),g(ae,J)};q(ne,ae=>{e.generatingTags?ae(de):ae(me,!1)})}g($,se)},$$slots:{default:!0}})};q(j,V=>{e.genTagsEnabled&&e.onGenTags&&V(we)})}var ie=D(T,2);{var Q=V=>{var $=Pf(),te=C($),se=C(te);Cr(se,{placeholder:"tag",get ref(){return n(i)},set ref(de){f(i,de,!0)},get value(){return n(l)},set value(de){f(l,de,!0)}});var ne=D(te,2);ne.__pointerdown=k,ne.__touchstart=F,ne.__click=()=>{n(i)?.blur(),n(l)!==""&&m(n(l)),c(!1),f(l,"")},cn("submit",$,w),g(V,$)};q(ie,V=>{c()&&V(Q)})}Ze(b,V=>f(d,V),()=>n(d)),g(t,b),ve()}ht(["pointerdown","touchstart","click"]);var Af=P('<div class="c p-y9ylet"><!> <!></div>'),Mf=P('<div class="b p-y9ylet">Change tags for selected notes</div> <!> <!>',1),Df=P('<form class="a p-y9ylet"><!></form>');function If(t,e){fe(e,!0);const{changeTags:a,getNoteById:r}=Bt(),{getSelectedTags:o}=Vn(),{getSelectedNotes:s}=fa(),{getFiltredNotes:i}=Ia();let l=I(!1),d=I(!1),u,c=!1,v=I(!1),h=e.nextFocusRef,m=(()=>{const O=[...o()],U=s();if(U.size===0)return O;const R=Array.from(U);let H=new Set(r(R[0])?.data.tags||[]);for(let K=1;K<R.length;K++){const ee=new Set(r(R[K])?.data.tags||[]),Z=new Set([]);ee.forEach(j=>{H.has(j)&&Z.add(j)}),H=Z}return Array.from(H)})(),x=I(ft(m));be(()=>()=>{u&&clearTimeout(u)});const w=()=>{u=setTimeout(()=>{f(d,!0)},250)},k=()=>{f(l,!0)},F=async()=>{const O=m,U=new Set(s()),R=U.size?[...U]:i().map(H=>H.id);try{w();const{cancel:H}=await a([...O],n(x),R);ut("Tags changed",{cancel:{nextFocusRef:h,onCancel:async()=>{await H(),setTimeout(()=>{const{prev:K}=wt(h);K?.focus()},16)}}}),c=!0}finally{f(l,!0)}},b=O=>{O.key==="Escape"&&n(v)&&(f(v,!1),O.preventDefault(),O.stopPropagation())};be(()=>(document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)));const T=()=>{e.onClosed?.(c)},L=O=>{f(x,O,!0)},Y=O=>{O.preventDefault(),F()};Dr(t,{get blocked(){return n(d)},get startClose(){return n(l)},onClosed:T,children:(O,U)=>{var R=Df(),H=C(R);{var K=Z=>{Ra(Z,{})},ee=Z=>{var j=Mf(),we=D(A(j),2);ul(we,{get selectedTags(){return n(x)},onChangeTags:L,get shownTagInput(){return n(v)},set shownTagInput(V){f(v,V,!0)}});var ie=D(we,2);{var Q=V=>{var $=Af(),te=C($);Lt(te,{onClick:k,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(ne,de)=>{var me=Ie("Cancel");g(ne,me)},$$slots:{default:!0}});var se=D(te,2);Lt(se,{onClick:F,fullWidth:!0,withoutMinWidth:!0,children:(ne,de)=>{var me=Ie("OK");g(ne,me)},$$slots:{default:!0}}),g(V,$)};q(ie,V=>{n(v)||V(Q)})}g(Z,j)};q(H,Z=>{n(d)?Z(K):Z(ee,!1)})}cn("submit",R,Y),g(O,R)},$$slots:{default:!0}}),ve()}var Lf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),Rf=P('<li class="p-antir2"><!></li>'),Of=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),Ff=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),zf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),Bf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),jf=P('<li class="p-antir2"><!></li> <li class="p-antir2"><!></li>',1),Hf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Uf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),Wf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),qf=P('<li class="p-antir2"><!></li>'),Vf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),Kf=P('<li class="p-antir2"><!></li>'),Yf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),Gf=P('<li class="p-antir2"><!></li> <li class="p-antir2"><!></li> <!> <li class="p-antir2"><!></li>',1),Xf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),Jf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),Zf=P('<li class="p-antir2"><!></li> <li class="p-antir2"><!></li>',1),Qf=P('<!> <!> <li class="p-antir2"><!></li> <li class="p-antir2"><!></li> <!> <!> <!>',1),$f=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ev=P('<div class="a p-antir2"><!></div> <!> <!> <!>',1);function tv(t,e){fe(e,!0);const{getSelectedTags:a,setSelectedTags:r,clearTags:o}=Vn(),{moveNotesToBin:s,moveNotesToArchive:i,moveNotesFromArchive:l,restoreNotesFromBin:d,deleteNotes:u}=Bt(),{getFiltredNotes:c}=Ia(),{getMode:v,changeMode:h,getSelectedNotes:p,setSelectedNotes:m,clearNotes:x}=fa();let w=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),k=N(a),F=I(!1),b=I(!1),T=I(!1),L=I(!1),Y=I(null),O=I(null);const U=()=>{n(F)||f(F,!0)},R=()=>{f(F,!1),f(b,!1)};Fe(()=>{!n(F)&&!n(T)&&!n(L)&&f(Y,wt(n(O)).next,!0)}),be(()=>{const G=y=>{y.key==="Escape"&&n(F)&&n(O)?.focus()};return window.addEventListener("keydown",G),()=>{window.removeEventListener("keydown",G)}});let H=()=>{};const K=()=>{f(b,!0),f(T,!0);let G=n(O);H=()=>{f(T,!1),setTimeout(()=>{G?.focus()},16)}};let ee=()=>{};const Z=()=>{f(b,!0),f(L,!0);let G=n(O);ee=()=>{f(L,!1),setTimeout(()=>{G?.focus()},16)}},j=async()=>{const G=Array.from(n(k)),y=new Set(p()),E=y.size?[...y]:c().map(S=>S.id),{cancel:_}=await s({noteIds:E});o(),x(),ut("Notes moved to bin",{cancel:{nextFocusRef:n(Y),onCancel:async()=>{await _(),r(new Set(G)),m(y),setTimeout(()=>{const{prev:S}=wt(n(Y));S?.focus()},16)}}}),f(b,!0)},we=async()=>{const G=Array.from(n(k)),y=new Set(p()),E=y.size?[...y]:c().map(S=>S.id),{cancel:_}=await i({noteIds:E});o(),x(),ut("Notes moved to archive",{cancel:{nextFocusRef:n(Y),onCancel:async()=>{await _(),r(new Set(G)),m(y),setTimeout(()=>{const{prev:S}=wt(n(Y));S?.focus()},16)}}}),f(b,!0)},ie=async()=>{const G=Array.from(n(k)),y=new Set(p()),E=y.size?[...y]:c().map(S=>S.id),{cancel:_}=await l({noteIds:E});o(),x(),ut("Notes moved from archive",{cancel:{nextFocusRef:n(Y),onCancel:async()=>{await _(),r(new Set(G)),m(y),setTimeout(()=>{const{prev:S}=wt(n(Y));S?.focus()},16)}}}),f(b,!0)},Q=async()=>{const G=Array.from(n(k)),y=new Set(p()),E=y.size?[...y]:c().map(S=>S.id),{cancel:_}=await d({noteIds:E});o(),x(),ut("Notes restored",{cancel:{nextFocusRef:n(Y),onCancel:async()=>{await _(),r(new Set(G)),m(y),setTimeout(()=>{const{prev:S}=wt(n(Y));S?.focus()},16)}}}),f(b,!0)},V=()=>{const G=new Set(p()),y=G.size?[...G]:c().map(E=>E.id);f(b,!0),Va({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{f(b,!0),o(),x(),await u({noteIds:y})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(O)?.focus()},16)}})},$=()=>{const G=c(),y=Array.from(p()),E=[];for(const S of G)S.data&&S.data?.link&&Xo(S.data?.link.url)&&(y.includes(S.id)||y.length===0)&&E.push(S.data?.link.url);const _=()=>{for(const S of E)if(!window.open(S,"_blank")){Va({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(O)?.focus()},16)}});break}};E.length<=10?_():Va({title:`Are you sure to open ${E.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{_()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(O)?.focus()},16)}}),f(b,!0)},te=()=>{const G=c(),y=Array.from(p());let E="";for(const _ of G)_.data&&_.data?.link&&Xo(_.data?.link.url)&&(y.includes(_.id)||y.length===0)&&(E+=_.data?.link.url+`
`);navigator.clipboard.writeText(E),ut("Copied links"),f(b,!0)},se=()=>{const G=c(),y=Array.from(p());let E="";for(const _ of G)_.data&&(y.includes(_.id)||y.length===0)&&(_.data?.link?.url&&(E+=_.data?.link.url+`
`),_.data?.text&&(E+=`
`+_.data?.text+`
`),E+=`---------------------

`);navigator.clipboard.writeText(E),ut("Copied"),f(b,!0)},ne=()=>{const G=c(),y=Array.from(p());let E="";for(const _ of G)_.data&&(y.includes(_.id)||y.length===0)&&_.data?.link?.url&&(E+=_.data?.link.url+`

`);navigator.share({text:E}).catch(_=>{console.error("Error sharing",_)}),f(b,!0)},de=()=>{const G=c(),y=Array.from(p());let E="";for(const _ of G)_.data&&(y.includes(_.id)||y.length===0)&&(_.data?.link?.url&&(E+=_.data?.link.url+`
`),_.data?.text&&(E+=`
`+_.data?.text+`
`),E+=`---------------------

`);navigator.share({text:E}).catch(_=>{console.error("Error sharing",_)}),f(b,!0)};let me=vn||En;var ae=ev(),J=A(ae),le=C(J);wf(le,{title:"notes menu",onClick:U,get ref(){return n(O)},set ref(G){f(O,G,!0)}});var Se=D(J,2);{var _e=G=>{var y=$f(),E=A(y);ce(E,()=>({"--right":"0","--top":"44px"})),Ir(E.lastChild,{get startClose(){return n(b)},onClosed:R,get isMobile(){return me},children:(_,S)=>{var z=Qf(),M=A(z);{var oe=ke=>{var Pe=Rf(),He=C(Pe);We(He,{onClick:$,get dialogMode(){return me},children:(Ge,Ve)=>{var Ke=Lf(),Be=A(Ke);ce(Be,()=>({"--size":"20px"})),pe(Be.lastChild,{name:"open"}),g(Ge,Ke)},$$slots:{default:!0}}),g(ke,Pe)};q(M,ke=>{vn||En||ke(oe)})}var ge=D(M,2);q(ge,ke=>{});var he=D(ge,2),W=C(he);We(W,{onClick:te,get dialogMode(){return me},children:(ke,Pe)=>{var He=Of(),Ge=A(He);ce(Ge,()=>({"--size":"20px"})),pe(Ge.lastChild,{name:"copy"}),g(ke,He)},$$slots:{default:!0}});var X=D(he,2),re=C(X);We(re,{onClick:se,get dialogMode(){return me},children:(ke,Pe)=>{var He=Ff(),Ge=A(He);ce(Ge,()=>({"--size":"20px"})),pe(Ge.lastChild,{name:""}),g(ke,He)},$$slots:{default:!0}});var ye=D(X,2);{var Le=ke=>{var Pe=jf(),He=A(Pe),Ge=C(He);We(Ge,{onClick:ne,get dialogMode(){return me},children:(Be,rt)=>{var tt=zf(),Qe=A(tt);ce(Qe,()=>({"--size":"20px"})),pe(Qe.lastChild,{name:"share"}),g(Be,tt)},$$slots:{default:!0}});var Ve=D(He,2),Ke=C(Ve);We(Ke,{onClick:de,get dialogMode(){return me},children:(Be,rt)=>{var tt=Bf(),Qe=A(tt);ce(Qe,()=>({"--size":"20px"})),pe(Qe.lastChild,{name:""}),g(Be,tt)},$$slots:{default:!0}}),g(ke,Pe)};q(ye,ke=>{w&&ke(Le)})}var De=D(ye,2);{var ze=ke=>{var Pe=Gf(),He=A(Pe),Ge=C(He);We(Ge,{onClick:K,get dialogMode(){return me},children:(ct,Et)=>{var mt=Hf(),lt=A(mt);ce(lt,()=>({"--size":"20px","--rotate":"45deg"})),pe(lt.lastChild,{name:"close"}),g(ct,mt)},$$slots:{default:!0}});var Ve=D(He,2),Ke=C(Ve);We(Ke,{onClick:Z,get dialogMode(){return me},children:(ct,Et)=>{var mt=Uf(),lt=A(mt);ce(lt,()=>({"--size":"20px"})),pe(lt.lastChild,{name:""}),g(ct,mt)},$$slots:{default:!0}});var Be=D(Ve,2);{var rt=ct=>{var Et=qf(),mt=C(Et);We(mt,{onClick:we,get dialogMode(){return me},children:(lt,Qt)=>{var Nn=Wf(),An=A(Nn);ce(An,()=>({"--size":"20px"})),pe(An.lastChild,{name:"archive"}),g(lt,Nn)},$$slots:{default:!0}}),g(ct,Et)},tt=ct=>{var Et=Kf(),mt=C(Et);We(mt,{onClick:ie,get dialogMode(){return me},children:(lt,Qt)=>{var Nn=Vf(),An=A(Nn);ce(An,()=>({"--size":"20px"})),pe(An.lastChild,{name:"archive-cancel"}),g(lt,Nn)},$$slots:{default:!0}}),g(ct,Et)};q(Be,ct=>{e.mode==="notes"?ct(rt):ct(tt,!1)})}var Qe=D(Be,2),Tt=C(Qe);We(Tt,{onClick:j,get dialogMode(){return me},dangerous:!0,children:(ct,Et)=>{var mt=Yf(),lt=A(mt);ce(lt,()=>({"--size":"20px"})),pe(lt.lastChild,{name:"bin"}),g(ct,mt)},$$slots:{default:!0}}),g(ke,Pe)};q(De,ke=>{(e.mode==="notes"||e.mode==="archive")&&ke(ze)})}var bt=D(De,2);{var qe=ke=>{var Pe=Zf(),He=A(Pe),Ge=C(He);We(Ge,{onClick:Q,get dialogMode(){return me},children:(Be,rt)=>{var tt=Xf(),Qe=A(tt);ce(Qe,()=>({"--size":"20px"})),pe(Qe.lastChild,{name:"bin-cancel"}),g(Be,tt)},$$slots:{default:!0}});var Ve=D(He,2),Ke=C(Ve);We(Ke,{onClick:V,get dialogMode(){return me},dangerous:!0,children:(Be,rt)=>{var tt=Jf(),Qe=A(tt);ce(Qe,()=>({"--size":"20px"})),pe(Qe.lastChild,{name:"bin"}),g(Be,tt)},$$slots:{default:!0}}),g(ke,Pe)};q(bt,ke=>{e.mode==="bin"&&ke(qe)})}g(_,z)},$$slots:{default:!0}}),g(G,y)};q(Se,G=>{n(F)&&G(_e)})}var Te=D(Se,2);{var Me=G=>{Sf(G,{get nextFocusRef(){return n(Y)},onClosed:y=>{H(y)}})};q(Te,G=>{n(T)&&G(Me)})}var Oe=D(Te,2);{var Ee=G=>{If(G,{get nextFocusRef(){return n(Y)},onClosed:y=>{ee(y)}})};q(Oe,G=>{n(L)&&G(Ee)})}g(t,ae),ve()}var nv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),av=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),rv=P('<li class="p-1ljon4s"><!></li>'),ov=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),sv=P('<li class="p-1ljon4s"><!></li>'),iv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),lv=P('<li class="p-1ljon4s"><!></li>'),cv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),dv=P('<li class="p-1ljon4s"><!></li>'),uv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),fv=P('<li class="p-1ljon4s"><!></li>'),vv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),gv=P('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),hv=P('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),pv=P('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),mv=P(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),_v=P('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),wv=P('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!>',1),yv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function bv(t,e){fe(e,!0);const{checkMobileSize:a}=La(),{getMode:r,getSelectedNotes:o,changeMode:s,addNote:i,removeNote:l}=fa(),{moveNoteToBin:d,moveNoteFromArchive:u,moveNoteToArchive:c,deleteNote:v,pinNote:h,restoreNoteFromBin:p}=Bt();let m=Ne(e,"mode",3,"notes"),x=Ne(e,"shownMenu",15),w=I(!1),k=I(!1),F=I(!1),b=I(!1),T=I(!1),L=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const Y=async()=>{d(e.noteId),ut("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId)}}})},O=async()=>{c(e.noteId),ut("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{u(e.noteId)}}})},U=async()=>{u(e.noteId),ut("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{c(e.noteId)}}})},R=()=>{p(e.noteId),ut("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(e.noteId)}}})},H=()=>{e.noteData.pinned?(h(e.noteId,!1),ut("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{h(e.noteId,!0)}}})):(h(e.noteId,!0),ut("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{h(e.noteId,!1)}}})),f(w,!0)},K=()=>{n(k)?(f(k,!1),Y()):n(T)?(f(T,!1),R()):n(F)?(f(F,!1),O()):n(b)&&(f(b,!1),U()),x(!1),f(w,!1)},ee=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),ut("Copied link"),f(w,!0))},Z=()=>{let de="";e.noteData.link?.url&&(de+=e.noteData.link.url+`
`),e.noteData.text&&(de+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(de),ut("Copied"),f(w,!0)},j=()=>{f(w,!0),Va({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await v(e.noteId)},onCancel:async()=>{}})},we=()=>{if(navigator.share){const de={};let me="";e.noteData.link?.url&&(me+=e.noteData.link.url+`
`),e.noteData.text&&(me+=`
`+e.noteData.text+`
`),de.text=me,navigator.share(de).catch(ae=>{console.error("Error sharing",ae)})}f(w,!0)},ie=()=>{if(navigator.share){const de={};e.noteData.link?.url&&(de.url=e.noteData.link.url),e.noteData.link?.title&&(de.title=e.noteData.link.title),navigator.share(de).catch(me=>{console.error("Error sharing",me)})}f(w,!0)};let Q=vn||En,V=N(a),$=N(()=>r()==="multiple"&&o().has(e.noteId));var te=ue(),se=A(te);{var ne=de=>{var me=yv(),ae=A(me);ce(ae,()=>({"--bottom":e.showMenuUp?"calc(100%)":"auto","--top":e.showMenuUp?"auto":"calc(100%)","--right":"10px"})),Ir(ae.lastChild,{get startClose(){return n(w)},onClosed:K,get isMobile(){return Q},children:(J,le)=>{var Se=wv(),_e=A(Se),Te=C(_e);We(Te,{onClick:H,get dialogMode(){return Q},children:(W,X)=>{var re=nv(),ye=A(re);{let De=N(()=>e.noteData.pinned?"pin-cancel":"pin");ce(ye,()=>({"--size":"20px"})),pe(ye.lastChild,{get name(){return n(De)}})}var Le=D(ye);xe(()=>dt(Le,` ${e.noteData.pinned?"Unpin":"Pin"}`)),g(W,re)},$$slots:{default:!0}});var Me=D(_e,2);{var Oe=W=>{var X=rv(),re=C(X);We(re,{onClick:ee,get dialogMode(){return Q},children:(ye,Le)=>{var De=av(),ze=A(De);ce(ze,()=>({"--size":"20px"})),pe(ze.lastChild,{name:"copy"}),g(ye,De)},$$slots:{default:!0}}),g(W,X)};q(Me,W=>{n(V)&&e.noteData.link?.url&&W(Oe)})}var Ee=D(Me,2);{var G=W=>{var X=sv(),re=C(X);We(re,{onClick:Z,get dialogMode(){return Q},children:(ye,Le)=>{var De=ov(),ze=A(De);ce(ze,()=>({"--size":"20px"})),pe(ze.lastChild,{name:"copy"}),g(ye,De)},$$slots:{default:!0}}),g(W,X)};q(Ee,W=>{e.noteData.text&&W(G)})}var y=D(Ee,2);{var E=W=>{var X=lv(),re=C(X);We(re,{onClick:we,get dialogMode(){return Q},children:(ye,Le)=>{var De=iv(),ze=A(De);ce(ze,()=>({"--size":"20px"})),pe(ze.lastChild,{name:"share"}),g(ye,De)},$$slots:{default:!0}}),g(W,X)};q(y,W=>{L&&e.noteData.text&&W(E)})}var _=D(y,2);{var S=W=>{var X=dv(),re=C(X);We(re,{onClick:ie,get dialogMode(){return Q},children:(ye,Le)=>{var De=cv(),ze=A(De);ce(ze,()=>({"--size":"20px"})),pe(ze.lastChild,{name:"share"}),g(ye,De)},$$slots:{default:!0}}),g(W,X)};q(_,W=>{L&&e.noteData.link?.url&&W(S)})}var z=D(_,2);{var M=W=>{var X=fv(),re=C(X);We(re,{onClick:()=>{f(w,!0),r()!=="multiple"&&s("multiple"),i(e.noteId)},get dialogMode(){return Q},children:(ye,Le)=>{var De=uv(),ze=A(De);ce(ze,()=>({"--size":"20px"})),pe(ze.lastChild,{name:"check"}),g(ye,De)},$$slots:{default:!0}}),g(W,X)};q(z,W=>{n($)||W(M)})}var oe=D(z,2);{var ge=W=>{var X=hv(),re=A(X),ye=C(re);We(ye,{onClick:()=>{f(F,m()==="notes"),f(b,m()==="archive"),f(w,!0)},get dialogMode(){return Q},children:(ze,bt)=>{var qe=vv(),ke=A(qe);{let He=N(()=>m()==="archive"?"archive-cancel":"archive");ce(ke,()=>({"--size":"20px"})),pe(ke.lastChild,{get name(){return n(He)}})}var Pe=D(ke);xe(()=>dt(Pe,` ${m()==="archive"?"Unarchive":"Archive"}`)),g(ze,qe)},$$slots:{default:!0}});var Le=D(re,2),De=C(Le);We(De,{onClick:()=>{f(k,!0),f(w,!0)},get dialogMode(){return Q},dangerous:!0,children:(ze,bt)=>{var qe=gv(),ke=A(qe),Pe=C(ke);ce(Pe,()=>({"--size":"20px"})),pe(Pe.lastChild,{name:"bin"}),g(ze,qe)},$$slots:{default:!0}}),g(W,X)},he=W=>{var X=_v(),re=A(X),ye=C(re);We(ye,{onClick:()=>{f(T,!0),f(w,!0)},get dialogMode(){return Q},children:(ze,bt)=>{var qe=pv(),ke=A(qe),Pe=C(ke);ce(Pe,()=>({"--size":"20px"})),pe(Pe.lastChild,{name:"bin-cancel"}),g(ze,qe)},$$slots:{default:!0}});var Le=D(re,2),De=C(Le);We(De,{onClick:j,get dialogMode(){return Q},dangerous:!0,children:(ze,bt)=>{var qe=mv(),ke=A(qe),Pe=C(ke);ce(Pe,()=>({"--size":"20px"})),pe(Pe.lastChild,{name:"bin"}),g(ze,qe)},$$slots:{default:!0}}),g(W,X)};q(oe,W=>{m()==="notes"||m()==="archive"?W(ge):W(he,!1)})}g(J,Se)},$$slots:{default:!0}}),g(de,me)};q(se,de=>{x()&&de(ne)})}g(t,te),ve()}var Sv=P('<div class="a p-1hg9kpf"></div>'),Cv=P('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function fl(t,e){fe(e,!0);const a=u=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(u).host}.ico`}catch{return""}};let r=I(!1),o=N(()=>a(e.url));var s=ue(),i=A(s);{var l=u=>{var c=Sv();g(u,c)},d=u=>{var c=Cv();xe(v=>st(c,"src",v),[()=>a(e.url)]),cn("error",c,()=>{f(r,!0)}),g(u,c)};q(i,u=>{n(r)||!n(o)?u(l):u(d,!1)})}g(t,s),ve()}var kv=P('<a target="_blank" rel="noopener noreferrer" class="a p-1mepfnj"><!> <!></a>'),xv=P('<button class="a p-1mepfnj"><!> <!></button>');function Sn(t,e){fe(e,!0);let a=Ne(e,"tabindex",3,0),r=Ne(e,"onclick",3,()=>{}),o=Ne(e,"ref",15);var s=ue(),i=A(s);{var l=u=>{var c=kv();c.__click=function(...p){r()?.apply(this,p)};var v=C(c);Ae(v,()=>e.children);var h=D(v,2);pt(h,{children:(p,m)=>{var x=Ie();xe(()=>dt(x,e.title)),g(p,x)}}),Ze(c,p=>o(p),()=>o()),xe(()=>{st(c,"href",e.href),st(c,"tabindex",a())}),g(u,c)},d=u=>{var c=ue(),v=A(c);{var h=p=>{var m=xv();m.__click=function(...k){r()?.apply(this,k)};var x=C(m);Ae(x,()=>e.children);var w=D(x,2);pt(w,{children:(k,F)=>{var b=Ie();xe(()=>dt(b,e.title)),g(k,b)}}),Ze(m,k=>o(k),()=>o()),xe(()=>st(m,"tabindex",a())),g(p,m)};q(v,p=>{e.elem==="button"&&p(h)},!0)}g(u,c)};q(i,u=>{e.elem==="a"?u(l):u(d,!1)})}g(t,s),ve()}ht(["click"]);let po=I(!1),mo=I(!1),Cn=I(void 0),Qr={};const Tv=()=>{vn||En||f(mo,!0)},Ev=()=>{f(mo,!1)},Jo=()=>{vn||En||f(po,!0)},Pv=()=>{f(po,!1)},Nv=()=>n(mo),vl=()=>n(po),gn=t=>{vn||En||f(Cn,t,!0)},Kr=()=>n(Cn),Os=()=>{const t=Qr[n(Cn)||""]?.next;if(t)return f(Cn,t,!0),t},Fs=()=>{const t=Qr[n(Cn)||""]?.prev;if(t)return f(Cn,t,!0),t};var Av=P('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),Mv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Dv=P('<div class="b p-rxwzp0"><!></div>'),Iv=P('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Lv=P('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Rv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Ov=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Fv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),zv=P("<!> <!> <!>",1),Bv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),jv=P("<li><!> <!> <!> <div><!> <!></div> <!></li>");function Hv(t,e){fe(e,!0);const{pushDialogPage:a}=Jt(),{getFaviconEnabled:r,getRecordMode:o}=Na(),{getMode:s,getSelectedNotes:i,addNote:l,removeNote:d}=fa(),{getSearchParams:u,getHref:c}=Vt();let v=Ne(e,"mode",3,"notes"),h="unknown";Fe(()=>(Qr[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete Qr[e.noteId]}));let p=I(!1),m=I(!1),x=N(r),w=N(o),k=I(null),F=I(null),b=I(null);const{checkMobileSize:T}=La(),L=()=>{f(p,!0)},Y=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),ut("copied"))};Fe(()=>{n(Cn)===e.noteId?f(m,!0):f(m,!1)});const O=J=>{J.preventDefault(),a(`${Ce.Note}?id=${encodeURIComponent(e.noteId)}`)},U=N(()=>e.noteData.link?.url||"");let R=N(()=>n(p)&&n(k)?wt(n(k)).next:null);const H=J=>{J?l(e.noteId):d(e.noteId)},K=()=>{const J=new URLSearchParams(u());return J.set(tn,`${Ce.Note}?id=${encodeURIComponent(e.noteId)}`),c(J)};let ee=N(()=>s()==="multiple"&&i().has(e.noteId));be(()=>{const J=le=>{if(h="keyboard",n(Cn)===e.noteId&&(le.key==="Enter"&&n(mo)&&(n(w)==="note"?(le.preventDefault(),setTimeout(()=>{a(`${Ce.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(w)==="bookmark"&&n(U)&&window.open(n(U),"_blank","noopener")),le.key==="Tab"&&n(po)&&(Pv(),n(b)))){const Se=wt(n(b));le.shiftKey?Se.prev?.focus():Se?.next?.focus()}};return document.addEventListener("keydown",J),()=>{document.removeEventListener("keydown",J)}});var Z=jv();Z.__focusin=()=>{h==="keyboard"&&f(Cn,e.noteId,!0)};var j=C(Z);{var we=J=>{var le=Av(),Se=C(le);ce(Se,()=>({"--size":"18px"})),pe(Se.lastChild,{name:"pin"}),g(J,le)};q(j,J=>{e.noteData.pinned&&J(we)})}var ie=D(j,2);{var Q=J=>{var le=Dv(),Se=C(le);{var _e=Me=>{fl(Me,{get url(){return n(U)}})},Te=Me=>{var Oe=Mv(),Ee=A(Oe);ce(Ee,()=>({"--size":"16px"})),pe(Ee.lastChild,{name:"note"}),g(Me,Oe)};q(Se,Me=>{n(U)?Me(_e):Me(Te,!1)})}g(J,le)};q(ie,J=>{n(x)&&J(Q)})}var V=D(ie,2);{var $=J=>{var le=Iv();le.__keydown=_e=>{_e.key==="Enter"&&(h="keyboard")},le.__mousedown=()=>{h="mouse"},le.__click=_e=>{console.log(h),h==="mouse"&&gn(void 0),_e.preventDefault(),s()==="multiple"?H(!n(ee)):O(_e)};var Se=C(le);Ze(le,_e=>f(b,_e),()=>n(b)),xe((_e,Te)=>{st(le,"tabindex",e.focusHidden?-1:0),st(le,"href",_e),dt(Se,Te)},[K,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),cn("focus",le,()=>{}),g(J,le)},te=J=>{var le=Lv();le.__keydown=_e=>{_e.key==="Enter"&&(h="keyboard")},le.__mousedown=()=>{h="mouse"},le.__click=_e=>{s()==="multiple"&&(_e.preventDefault(),H(!n(ee)))};var Se=C(le);Ze(le,_e=>f(b,_e),()=>n(b)),xe(_e=>{st(le,"tabindex",e.focusHidden?-1:0),st(le,"href",n(U)),dt(Se,_e)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),cn("focus",le,()=>{}),g(J,le)};q(V,J=>{n(w)==="note"||!n(U)?J($):J(te,!1)})}var se=D(V,2),ne=C(se);{var de=J=>{var le=zv(),Se=A(le);{var _e=G=>{{let y=N(K),E=N(()=>e.focusHidden?-1:0);Sn(G,{title:"edit",elem:"a",get href(){return n(y)},get tabindex(){return n(E)},onclick:O,children:(_,S)=>{var z=Rv(),M=A(z);ce(M,()=>({"--size":"18px"})),pe(M.lastChild,{name:"pen"}),g(_,z)},$$slots:{default:!0}})}};q(Se,G=>{(n(w)==="bookmark"||s()==="multiple")&&G(_e)})}var Te=D(Se,2);{var Me=G=>{{let y=N(()=>e.focusHidden?-1:0),E=N(()=>e.noteData.link?.title||"unknown");Sn(G,{elem:"a",get href(){return n(U)},get tabindex(){return n(y)},get title(){return n(E)},children:(_,S)=>{var z=Ov(),M=A(z);ce(M,()=>({"--size":"18px"})),pe(M.lastChild,{name:"open"}),g(_,z)},$$slots:{default:!0}})}};q(Te,G=>{(n(w)==="note"||s()==="multiple")&&G(Me)})}var Oe=D(Te,2);{var Ee=G=>{{let y=N(()=>e.focusHidden?-1:0);Sn(G,{elem:"button",onclick:Y,get tabindex(){return n(y)},title:"copy link",children:(E,_)=>{var S=Fv(),z=A(S);ce(z,()=>({"--size":"20px"})),pe(z.lastChild,{name:"copy"}),g(E,S)},$$slots:{default:!0}})}};q(Oe,G=>{T()||G(Ee)})}g(J,le)};q(ne,J=>{n(U)&&J(de)})}var me=D(ne,2);{let J=N(()=>e.focusHidden?-1:0);Sn(me,{title:"show menu",elem:"button",get tabindex(){return n(J)},onclick:L,get ref(){return n(k)},set ref(le){f(k,le,!0)},children:(le,Se)=>{var _e=Bv(),Te=A(_e);ce(Te,()=>({"--size":"18px","--rotate":"90deg"})),pe(Te.lastChild,{name:"menu"}),g(le,_e)},$$slots:{default:!0}})}var ae=D(se,2);bv(ae,{get nextFocusRef(){return n(R)},get mode(){return v()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(p)},set shownMenu(J){f(p,J,!0)}}),Ze(Z,J=>f(F,J),()=>n(F)),xe(()=>{at(Z,1,it({d:!0,e:n(m),f:n(ee)||n(Cn)===e.noteId}),"p-rxwzp0"),at(se,1,it({g:!0,h:n(m)}),"p-rxwzp0")}),g(t,Z),ve()}ht(["focusin","keydown","mousedown","click"]);var Uv=P('<div class="g e p-lub4l9"><button class="d p-lub4l9" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),Wv=P('<div class="g p-lub4l9"><button class="d p-lub4l9" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),qv=P('<a class="i j p-lub4l9"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),Vv=P('<div class="h p-lub4l9"><!> <!></div>'),Kv=P('<!> <div class="p p-lub4l9"><!></div>',1),Yv=P('<button class="t p-lub4l9">All</button>'),Gv=P('<button class="t p-lub4l9"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),Xv=P('<div class="r p-lub4l9"><div class="s p-lub4l9"><!> <span> </span> <!></div> <button class="t u p-lub4l9"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),Jv=P('<div class="a p-lub4l9"><div class="b p-lub4l9"><div class="c p-lub4l9"><a class="d p-lub4l9"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-lub4l9"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-lub4l9"><!></div> <div class="f p-lub4l9"><!></div></div> <div class="k p-lub4l9"><div class="l p-lub4l9"><!></div> <div class="m p-lub4l9"><div class="n p-lub4l9"><div class="o p-lub4l9"><!></div> <!></div> <div class="q p-lub4l9"><!></div></div></div></div>');function Zv(t,e){fe(e,!0);const{getFeedSearch:a,setFeedSearch:r}=Xr(),{getScrollContainer:o}=ho();let s=N(o);const{emptyBin:i,checkNotesInBin:l,checkNotesInArchive:d,checkNotes:u}=Bt(),{replaceSearchParams:c}=Vt(),{createDialogPageHref:v,createHandleClickDialogPage:h,getDialogPages:p}=Jt(),{checkExistedDialog:m}=Zt(),{getMode:x,clearNotes:w,setSelectedNotes:k,getSelectedNotes:F,changeMode:b}=fa(),{checkMobileSize:T}=La(),{getFiltredNotes:L}=Ia(),{getSelectedMetaTags:Y}=go(),{getViewMode:O}=Na();let U=N(Y),R=I(null);const H=N(l);let ee=N(()=>{const W=L()||[],X=F();return W.every(re=>X.has(re.id))});const Z=()=>{Va({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await i(),c("")},onCancel:async()=>{}})};let j=N(()=>p().length===0);Fe(()=>{n(j)});const we=()=>{p().length===0&&!m()&&n(R)?.focus()};be(()=>Sr({key:"k",meta:!0,action:we})),be(()=>Sr({key:"k",ctrl:!0,action:we})),be(()=>{}),Fe(()=>{const W=L()||[];zt(()=>{const X=F();k(new Set(W.filter(re=>X.has(re.id)).map(re=>re.id)))})});let ie=N(()=>n(U).has(et.ARCHIVED)?"archive":n(U).has(et.BIN)?"bin":"notes");be(()=>{n(R)&&n(R).addEventListener("keydown",W=>{W.key==="Tab"&&Kr()&&W.preventDefault()})}),Fe(()=>{vl()&&setTimeout(()=>{n(R)?.focus(),n(R)?.setSelectionRange(n(R).value.length,n(R).value.length)},0)}),be(()=>{});var Q=Jv(),V=C(Q),$=C(V),te=C($),se=N(()=>h(Ce.Settings));te.__click=function(...W){n(se)?.apply(this,W)};var ne=C(te);ce(ne,()=>({"--rotate":"30deg","--size":"20px"})),pe(ne.lastChild,{name:"settings"});var de=D(te,2),me=N(()=>h(Ce.Sync));de.__click=function(...W){n(me)?.apply(this,W)};var ae=C(de);ce(ae,()=>({"--size":"20px"})),pe(ae.lastChild,{name:"sync"});var J=D($,2),le=C(J);ll(le,{});var Se=D(J,2),_e=C(Se);{var Te=W=>{var X=ue(),re=A(X);{var ye=Le=>{var De=ue(),ze=A(De);{var bt=ke=>{var Pe=Uv(),He=C(Pe);He.__click=Z;var Ge=C(He);ce(Ge,()=>({"--scale":"1.2","--size":"20px"})),pe(Ge.lastChild,{name:"clear"});var Ve=D(Ge);pt(Ve,{children:(Ke,Be)=>{var rt=Ie("Empty bin");g(Ke,rt)}}),g(ke,Pe)},qe=ke=>{var Pe=Wv(),He=C(Pe);He.__click=Z;var Ge=C(He);ce(Ge,()=>({"--scale":"0.9","--size":"20px"})),pe(Ge.lastChild,{name:"clear"}),g(ke,Pe)};q(ze,ke=>{T()?ke(bt):ke(qe,!1)})}g(Le,De)};q(re,Le=>{n(H)&&Le(ye)})}g(W,X)},Me=W=>{var X=ue(),re=A(X);{var ye=Le=>{var De=Vv(),ze=C(De);{var bt=ke=>{var Pe=qv();Pe.__click=function(...Ve){e.onOpenWindow?.apply(this,Ve)};var He=C(Pe);ce(He,()=>({"--scale":"0.7","--size":"32px"})),pe(He.lastChild,{name:"open-window"});var Ge=D(He,2);pt(Ge,{children:(Ve,Ke)=>{var Be=Ie("open window");g(Ve,Be)}}),xe(()=>st(Pe,"href",e.openWindowHref)),g(ke,Pe)};q(ze,ke=>{e.onOpenWindow&&ke(bt)})}var qe=D(ze,2);Ou(qe,{}),g(Le,De)};q(re,Le=>{n(ie)==="notes"&&Le(ye)},!0)}g(W,X)};q(_e,W=>{n(ie)==="bin"?W(Te):W(Me,!1)})}var Oe=D(V,2),Ee=C(Oe),G=C(Ee);mf(G,{});var y=D(Ee,2),E=C(y),_=C(E),S=C(_);{let W=N(a);Bo(S,{placeholder:"Search",onFocus:()=>{vn||En||(Tv(),Jo(),n(R)?.setSelectionRange(n(R).value.length,n(R).value.length))},onBlur:()=>{Ev()},get value(){return n(W)},onChange:X=>{gn(void 0),n(s)&&n(s).scrollTo({top:0}),r(X)},onEscape:()=>{gn(void 0)},get ref(){return n(R)},set ref(X){f(R,X,!0)}})}var z=D(_,2);{var M=W=>{var X=Kv(),re=A(X);Pu(re,{});var ye=D(re,2),Le=C(ye);tv(Le,{get mode(){return n(ie)}}),g(W,X)};q(z,W=>{(n(ie)==="notes"&&u()||n(ie)==="bin"&&l()||n(ie)==="archive"&&d())&&W(M)})}var oe=D(E,2),ge=C(oe);{var he=W=>{var X=ue(),re=A(X);{var ye=Le=>{var De=Xv(),ze=C(De),bt=C(ze);{var qe=Be=>{var rt=Yv();rt.__click=tt=>{tt.preventDefault();const Qe=L()||[];k(new Set(Qe.map(Tt=>Tt.id)))},g(Be,rt)};q(bt,Be=>{n(ee)||Be(qe)})}var ke=D(bt,2),Pe=C(ke),He=D(ke,2);{var Ge=Be=>{var rt=Gv();rt.__click=Qe=>{Qe.preventDefault(),w()};var tt=C(rt);ce(tt,()=>({"--size":"16px"})),pe(tt.lastChild,{name:"close"}),g(Be,rt)};q(He,Be=>{F().size>0&&Be(Ge)})}var Ve=D(ze,2);Ve.__click=Be=>{Be.preventDefault(),b("single")};var Ke=C(Ve);ce(Ke,()=>({"--size":"16px"})),pe(Ke.lastChild,{name:"close"}),xe(Be=>dt(Pe,`Selected ${Be??""}`),[()=>F().size]),g(Le,De)};q(re,Le=>{x()==="multiple"&&Le(ye)})}g(W,X)};q(ge,W=>{(n(ie)==="notes"&&u()||n(ie)==="bin"&&l()||n(ie)==="archive"&&d())&&W(he)})}xe((W,X)=>{st(te,"href",W),st(de,"href",X)},[()=>v(Ce.Settings),()=>v(Ce.Sync)]),g(t,Q),ve()}ht(["click"]);var Qv=P('<div class="p-gkgqyo"><!></div>');function yt(t,e){fe(e,!0);const{setDialogPageHeight:a}=cs();let r=I(null);be(()=>{n(r);const i=new ResizeObserver(l=>{for(let d of l){const u=d.contentRect.height;a(u)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=Qv(),s=C(o);Ae(s,()=>e.children),Ze(o,i=>f(r,i),()=>n(r)),g(t,o),ve()}var $v=P('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function eg(t,e){fe(e,!1);const{replaceSearchParams:a,getHref:r}=Vt(),o=l=>{l.preventDefault(),a("")};os();var s=$v(),i=D(C(s),2);{let l=Pr(()=>r(""));Lt(i,{element:"a",get href(){return n(l)},onClick:o,children:(d,u)=>{var c=Ie("close");g(d,c)},$$slots:{default:!0}})}g(t,s),ve()}var tg=P('<h1 class="p-1n0ziuh"><!></h1>');function ng(t,e){var a=tg(),r=C(a);Ae(r,()=>e.children),g(t,a)}var ag=P('<!> <div class="b p-193tby9"><!> <!></div>',1),rg=P('<div class="a p-193tby9"><!></div>');function og(t,e){fe(e,!0);const{blockDialog:a,setLeftEnd:r}=Zt(),{pushDialogPage:o}=Jt(),{initLocalAccount:s}=is(),{replaceSearchParams:i}=Vt(),l=Kn(),d=()=>{o(Ce.Auth)},u=async()=>{l.duration=0,l.swipingRatio=-25,requestAnimationFrame(()=>{l.duration=ca().duration,l.swipingRatio=ca().swipingRatio,s(),a(!1),r(!0),i("")})};var c=rg(),v=C(c);{var h=p=>{var m=ag(),x=A(m);ng(x,{children:(b,T)=>{var L=Ie("Welcome");g(b,L)}});var w=D(x,2),k=C(w);Lt(k,{onClick:d,fullWidth:!0,children:(b,T)=>{var L=Ie("Cloud account");g(b,L)},$$slots:{default:!0}});var F=D(k,2);Lt(F,{onClick:u,fullWidth:!0,type:"secondary",children:(b,T)=>{var L=Ie("Local account");g(b,L)},$$slots:{default:!0}}),g(p,m)};q(v,p=>{p(h)})}g(t,c),ve()}var sg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Edit',1),ig=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),lg=P('<li class="p-1jbq6g9"><!></li> <li class="p-1jbq6g9"><!></li>',1),cg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function dg(t,e){fe(e,!0);let a=Ne(e,"shownMenu",15),r=I(!1),o=I(!1),s=I(!1);const i=async()=>{e.onEdit()},l=()=>{n(o)?(f(o,!1),i()):n(s)&&(f(s,!1),e.onDelete()),a(!1),f(r,!1)};let d=vn||En;var u=ue(),c=A(u);{var v=h=>{var p=cg(),m=A(p);ce(m,()=>({"--top":"90%","--right":"0px"})),Ir(m.lastChild,{get startClose(){return n(r)},onClosed:l,get isMobile(){return d},children:(x,w)=>{var k=lg(),F=A(k),b=C(F);We(b,{onClick:()=>{f(o,!0),f(r,!0)},get dialogMode(){return d},children:(Y,O)=>{var U=sg(),R=A(U);ce(R,()=>({"--size":"20px"})),pe(R.lastChild,{name:"pen"}),g(Y,U)},$$slots:{default:!0}});var T=D(F,2),L=C(T);We(L,{onClick:()=>{f(s,!0),f(r,!0)},get dialogMode(){return d},children:(Y,O)=>{var U=ig(),R=A(U);ce(R,()=>({"--size":"20px"})),pe(R.lastChild,{name:"bin"}),g(Y,U)},$$slots:{default:!0}}),g(x,k)},$$slots:{default:!0}}),g(h,p)};q(c,h=>{a()&&h(v)})}g(t,u),ve()}var ug=P('<div class="b p-ptbuqy"><!> <!> <div class="c p-ptbuqy"><button class="p-ptbuqy">Cancel</button> <button class="p-ptbuqy">Done</button></div></div>'),fg=P('<div class="e p-ptbuqy"><!></div>'),vg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),hg=P('<div class="d p-ptbuqy"><div><!> <a class="f p-ptbuqy" target="_blank" rel="noopener noreferrer"> </a> <div><!> <!></div> <!></div></div>'),pg=P('<div class="a p-ptbuqy"><!></div>');function mg(t,e){fe(e,!0);let a=Ne(e,"shownUrlInput",15);const{getFaviconEnabled:r}=Na();let o=N(r),s=I(null),i=I(null),l=I(ft(e.url)),d=I(ft(e.title)),u=I(null),c=I(null),v=I(!1);const h=T=>{f(l,T.target.value||"",!0)},p=T=>{f(d,T.target.value||"",!0)};Fe(()=>{a()&&n(s)?.focus()});const m=()=>{f(v,!0)},x=()=>{e.url&&(navigator.clipboard.writeText(e.url),ut("copied"))};var w=pg(),k=C(w);{var F=T=>{var L=ug(),Y=C(L);Cr(Y,{get value(){return n(l)},onInput:h,placeholder:"url",get ref(){return n(s)},set ref(K){f(s,K,!0)}});var O=D(Y,2);Cr(O,{get value(){return n(d)},onInput:p,placeholder:"title"});var U=D(O,2),R=C(U);R.__click=()=>{f(l,e.url,!0),f(d,e.title,!0),a(!1)};var H=D(R,2);H.__click=()=>{let K=n(l).trim();K!==""&&/^[[a-zA-Z]+?:\/\//.test(K)===!1&&(K="https://"+K,f(l,K,!0)),e.onChangeUrl(K,n(d)),a(!1)},g(T,L)},b=T=>{var L=ue(),Y=A(L);{var O=R=>{var H=hg(),K=C(H);at(K,1,it({i:!0}),"p-ptbuqy");var ee=C(K);{var Z=te=>{var se=fg(),ne=C(se);fl(ne,{get url(){return e.url}}),g(te,se)};q(ee,te=>{n(o)&&te(Z)})}var j=D(ee,2),we=C(j),ie=D(j,2);at(ie,1,it({j:!0}),"p-ptbuqy");var Q=C(ie);Sn(Q,{title:"copy link",elem:"button",onclick:x,children:(te,se)=>{var ne=vg(),de=A(ne);ce(de,()=>({"--size":"20px"})),pe(de.lastChild,{name:"copy"}),g(te,ne)},$$slots:{default:!0}});var V=D(Q,2);Sn(V,{title:"show menu",elem:"button",onclick:m,get ref(){return n(c)},set ref(te){f(c,te,!0)},children:(te,se)=>{var ne=gg(),de=A(ne);ce(de,()=>({"--size":"18px","--rotate":"90deg"})),pe(de.lastChild,{name:"menu"}),g(te,ne)},$$slots:{default:!0}});var $=D(ie,2);dg($,{onDelete:()=>{f(d,""),f(l,""),e.onDeleteUrl()},onEdit:()=>{a(!0)},get shownMenu(){return n(v)},set shownMenu(te){f(v,te,!0)}}),Ze(K,te=>f(u,te),()=>n(u)),xe(()=>{st(j,"href",e.url),dt(we,e.title||"unknown")}),g(R,H)},U=R=>{};q(Y,R=>{e.url?R(O):R(U,!1)})}g(T,L)};q(k,T=>{a()?T(F):T(b,!1)})}Ze(w,T=>f(i,T),()=>n(i)),g(t,w),ve()}ht(["click"]);var _g=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),wg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),yg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),bg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Sg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Cg=P("<!> <!>",1),kg=P('<div class="g p-k0zico">Note</div>'),xg=P("<span> </span>"),Tg=P('<div class="k p-k0zico"><!></div>'),Eg=P('<div class="a p-k0zico"><div class="b p-k0zico"><!></div></div> <!> <div class="c p-k0zico"><div class="d"><div class="e"><div class="f p-k0zico"><!> <div class="h p-k0zico" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"> </div></div></div></div> <div class="i j p-k0zico"><!> <div class="l p-k0zico"><!></div></div></div>',1);function Pg(t,e){fe(e,!0);const{getLlmTagsEnabled:a,getPrevTags:r,getPageDataForTagsEnabled:o}=Na(),{pushDialogPage:s}=Jt(),{checkMobileSize:i}=La();let l=Ne(e,"link",15,void 0),d=Ne(e,"text",15,""),u=Ne(e,"tags",31,()=>ft([])),c=Ne(e,"pinned",15,!1),v=I(null),h=I(!1),p=I(!1),m=I(ft(new Set)),x=I(!1);const w=G=>{let y="",E=!0;function _(S){for(let z=0;z<S.length;z++){const M=S[z];if(M.nodeName==="BR"){y+=`
`,E=!0;continue}M.nodeName==="DIV"&&E===!1&&(y+=`
`),E=!1,M.nodeType===3&&M.textContent&&(y+=M.textContent),_(M.childNodes)}}_(G.currentTarget.childNodes),y===`
`&&(y=y.slice(0,-1)),d(y)},k=G=>{G.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(h)&&(f(h,!1),G.preventDefault(),G.stopPropagation()),n(p)&&(f(p,!1),G.preventDefault(),G.stopPropagation()))};be(()=>(document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)));const F=(G,y)=>{l({url:G,title:y})},b=()=>{l(void 0)},T=G=>{u(G)},L=r(),Y=()=>{u([...new Set([...u(),...L])])},O=d();be(()=>{if(n(v)&&navigator.userActivation.isActive&&(e.mode==="add"||!(vn||En))){n(v).focus();const G=document.createRange();G.selectNodeContents(n(v)),G.collapse(!1);const y=window.getSelection();y?.removeAllRanges(),y?.addRange(G)}});let U=I("unknown");const R=async()=>{if(typeof LanguageModel>"u"){f(U,"unavailable");return}f(U,await Ms().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),!0)};be(()=>{R()});let H=N(a),K=null;const ee=async()=>K||(K=await Ms().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),K),Z=async()=>{if(n(U)==="downloadable"||n(U)==="downloading"){s(Ce.Extension);return}f(x,!0);const G=await ee(),y={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},E=`
			Page information:
			Title: ${l()?.title||"N/A"}.
			URL: ${l()?.url||"N/A"}.
			Description: N/A.
			Note content: ${d()||"N/A"}.
			Dont return tags: ${[...n(m).size>0?Array.from(n(m)):[],...u().length>0?u():[]].join(", ")||"N/A"}.
			Page contents: N/A.
		`.slice(0,5e3),_=await G.prompt(E,{responseConstraint:y});u(Array.from(new Set([...u(),...(JSON.parse(_)?.tags||[]).map(S=>S.trim().toLowerCase()).filter(S=>S!=="")]))),f(x,!1)};var j=Eg(),we=A(j),ie=C(we),Q=C(ie);{var V=G=>{var y=yg(),E=A(y);{let S=N(()=>c()?"unpin":"pin");ce(E,()=>({"--padding-bottom":"2px"})),Sn(E.lastChild,{get title(){return n(S)},elem:"button",onclick:()=>{c(!c())},children:(z,M)=>{var oe=_g(),ge=A(oe);{let he=N(()=>c()?"pin-cancel":"pin");ce(ge,()=>({"--size":"20px"})),pe(ge.lastChild,{get name(){return n(he)}})}g(z,oe)},$$slots:{default:!0}})}var _=D(E,2);Sn(_,{title:"menu",elem:"button",onclick:()=>{console.log("clicked")},children:(S,z)=>{var M=wg(),oe=A(M);ce(oe,()=>({"--size":"20px"})),pe(oe.lastChild,{name:"menu"}),g(S,M)},$$slots:{default:!0}}),g(G,y)},$=G=>{var y=Cg(),E=A(y);Sn(E,{title:"menu",elem:"button",onclick:()=>{console.log("clicked")},children:(S,z)=>{var M=bg(),oe=A(M);ce(oe,()=>({"--size":"24px"})),pe(oe.lastChild,{name:"menu"}),g(S,M)},$$slots:{default:!0}});var _=D(E,2);{let S=N(()=>c()?"unpin":"pin");Sn(_,{get title(){return n(S)},elem:"button",onclick:()=>{c(!c())},children:(z,M)=>{var oe=Sg(),ge=A(oe);{let he=N(()=>c()?"pin-cancel":"pin");ce(ge,()=>({"--size":"24px"})),pe(ge.lastChild,{get name(){return n(he)}})}g(z,oe)},$$slots:{default:!0}})}g(G,y)};q(Q,G=>{i()?G(V):G($,!1)})}var te=D(we,2);{let G=N(()=>l()?.url||""),y=N(()=>l()?.title||"");mg(te,{get url(){return n(G)},get title(){return n(y)},onChangeUrl:F,onDeleteUrl:b,get shownUrlInput(){return n(p)},set shownUrlInput(E){f(p,E,!0)}})}var se=D(te,2),ne=C(se),de=C(ne),me=C(de),ae=C(me);{var J=G=>{var y=kg();g(G,y)};q(ae,G=>{d()||G(J)})}var le=D(ae,2);le.__input=w;var Se=C(le);Ze(le,G=>f(v,G),()=>n(v));var _e=D(ne,2),Te=C(_e);{var Me=G=>{var y=Tg(),E=C(y);{var _=S=>{var z=xg(),M=C(z);xe(oe=>dt(M,`updated: ${oe??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),g(S,z)};q(E,S=>{e.updatedAt&&S(_)})}g(G,y)};q(Te,G=>{e.mode==="edit"&&G(Me)})}var Oe=D(Te,2),Ee=C(Oe);{let G=N(()=>n(H)&&n(U)!=="unknown"&&n(U)!=="unavailable"),y=N(()=>e.mode==="add"&&L.length>0);ul(Ee,{get selectedTags(){return u()},onRejectedTag:E=>{f(m,new Set([...n(m),E]),!0)},onChangeTags:T,get genTagsEnabled(){return n(G)},onGenTags:Z,get generatingTags(){return n(x)},onUsePreviousTags:Y,get previousTagsEnabled(){return n(y)},get shownTagInput(){return n(h)},set shownTagInput(E){f(h,E,!0)}})}xe(()=>dt(Se,O)),g(t,j),ve()}ht(["input"]);function Ng(t,e){fe(e,!0);const{isInitedNotes:a,createNote:r,updateNote:o,deleteNote:s,getNoteById:i,pinNote:l}=Bt(),{getViewMode:d,setPrevTags:u}=Na(),{setSearchParam:c,deleteSearchParam:v,getSearchParams:h}=Vt();let p=I("loading"),m=I("idle"),x=I(""),w=I(void 0),k=I(""),F=I(!1),b=I(ft([]));const T=()=>{{const H=h().get("url"),K=h().get("title"),ee=h().get("text");H&&f(w,{url:H,title:K||""},!0),ee&&(!H&&Xo(ee)?f(w,{url:ee,title:K||new URL(ee).hostname},!0):f(k,ee,!0)),v("url"),v("title"),v("text"),f(p,"finish");return}},L=N(()=>a()&&n(p)==="finish"),Y=async()=>{if(n(w)?.title||n(w)?.url||n(k)||n(b).length>0){if(n(x)){const H=i(n(x));if(!H?.data)return;if((H.data.link?.url!==n(w)?.url||H.data.link?.title!==n(w)?.title||H.data.text!==n(k)||JSON.stringify(H.data.tags)!==JSON.stringify(n(b)))&&n(m)==="idle"){f(m,"loading");try{await o(n(x),{link:pa(n(w)),text:n(k),tags:n(b).slice()})}finally{f(m,"idle")}}}else if(n(m)==="idle"){f(m,"loading");try{f(x,await r({link:pa(n(w)),text:n(k),tags:n(b).slice()}),!0),c("noteId",n(x))}catch(H){console.error("Error creating note:",H)}finally{f(m,"idle")}}}else if(n(x)&&n(m)==="idle"){f(m,"loading");try{await s(n(x)),f(x,""),v("noteId")}finally{f(m,"idle")}}};Fe(()=>{n(L)&&n(m)!=="loading"&&Y()}),Fe(()=>{n(L)&&n(m)!=="loading"&&n(x)&&(n(F),zt(()=>{i(n(x))?.data.pinned!==n(F)&&l(n(x),n(F))}))}),be(()=>{T()}),be(()=>()=>{n(b).length>0&&u([...n(b)])}),be(()=>()=>{n(x)&&v("noteId")});var O=ue(),U=A(O);{var R=H=>{Pg(H,{mode:"add",get link(){return n(w)},set link(K){f(w,K,!0)},get text(){return n(k)},set text(K){f(k,K,!0)},get tags(){return n(b)},set tags(K){f(b,K,!0)},get pinned(){return n(F)},set pinned(K){f(F,K,!0)}})};q(U,H=>{n(L)&&H(R)})}g(t,O),ve()}const Ag="modulepreload",Mg=function(t){return"/"+t},zs={},Ct=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let d=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");o=d(a.map(u=>{if(u=Mg(u),u in zs)return;zs[u]=!0;const c=u.endsWith(".css"),v=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${v}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Ag,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var Dg=P('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function Ig(t){var e=Dg(),a=D(C(e),2);Lt(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=Ie("Reload");g(r,s)},$$slots:{default:!0}}),g(t,e)}var Lg=P('<div class="p-uzefkz"><!></div>');function Rg(t,e){fe(e,!0);let a=I(!1);const{getDialogPageHeight:r}=cs(),o=N(r);be(()=>{const d=setTimeout(()=>{f(a,!0)},250);return()=>{clearTimeout(d)}});var s=Lg(),i=C(s);{var l=d=>{Ra(d,{})};q(i,d=>{n(a)&&d(l)})}xe(()=>er(s,`min-height: ${n(o)??""}px;`)),g(t,s),ve()}function Mt(t,e){fe(e,!0);const a={},r=Object.assign({"./Pages/About.svelte":()=>Ct(()=>import("./a64F33uS3.js"),__vite__mapDeps([0,1])),"./Pages/AccessKeys.svelte":()=>Ct(()=>import("./aDFIjtaZu.js"),__vite__mapDeps([2,3,4,5])),"./Pages/Account.svelte":()=>Ct(()=>import("./aDEL_kBnT.js"),__vite__mapDeps([6,3,7])),"./Pages/Auth.svelte":()=>Ct(()=>import("./aB8EJ-vYG.js"),__vite__mapDeps([8,9])),"./Pages/ChangeTags.svelte":()=>Ct(()=>import("./aM0eRvpkV.js"),[]),"./Pages/ConfirmAccessKey.svelte":()=>Ct(()=>import("./aCDJzUZcl.js"),__vite__mapDeps([10,4,3,11,12])),"./Pages/Exit.svelte":()=>Ct(()=>import("./aBayTpSvQ.js"),__vite__mapDeps([13,14])),"./Pages/ExportData.svelte":()=>Ct(()=>import("./aDnNF4aJf.js"),__vite__mapDeps([15,16,17,18,19,20])),"./Pages/Extension.svelte":()=>Ct(()=>import("./aBNsJu5gZ.js"),__vite__mapDeps([21,18,19,22])),"./Pages/ImportData.svelte":()=>Ct(()=>import("./aC9dLoWEF.js"),__vite__mapDeps([23,24])),"./Pages/Install.svelte":()=>Ct(()=>import("./apMBNoldj.js"),__vite__mapDeps([25,26])),"./Pages/InstallSuccess.svelte":()=>Ct(()=>import("./aBxseH24r.js"),__vite__mapDeps([27,28])),"./Pages/Note.svelte":()=>Ct(()=>import("./aDbo9HI09.js"),__vite__mapDeps([29,30])),"./Pages/Settings.svelte":()=>Ct(()=>import("./aDzrUvh_m.js"),__vite__mapDeps([31,18,19,16,17,32])),"./Pages/Signin.svelte":()=>Ct(()=>import("./a12GO-ix6.js"),__vite__mapDeps([33,4,3,11,34])),"./Pages/Signup.svelte":()=>Ct(()=>import("./a1AgKEc67.js"),__vite__mapDeps([35,11,4,3,34])),"./Pages/Subscription.svelte":()=>Ct(()=>import("./aub3SUNKA.js"),__vite__mapDeps([36,37])),"./Pages/Sync.svelte":()=>Ct(()=>import("./aBCgyxBNC.js"),__vite__mapDeps([38,39]))}),o=async l=>{const d=`./Pages/${l[0].toUpperCase()+l.slice(1)}.svelte`;if(!a[l]){if(r[d]){const u=r[d]();return a[l]={promise:u},a[l].module=await u,a[l].module}throw new Error(`Page ${l} not found`)}return a[l].module||await a[l].promise};var s=ue(),i=A(s);qc(i,()=>o(e.page),l=>{Rg(l,{})},(l,d)=>{const u=N(()=>n(d).default);var c=ue(),v=A(c);Gc(v,()=>n(u),(h,p)=>{p(h,{get params(){return e.params},get hidden(){return e.hidden}})}),g(l,c)},l=>{Ig(l)}),g(t,s),ve()}var nr,gl,hl;class Og{constructor(e){je(this,nr);Ot(this,"data");Ot(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),ot(this,nr,gl).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,ot(this,nr,hl).call(this)),e}isEmpty(){return this.data.length===0}}nr=new WeakSet,gl=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},hl=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class Fg{constructor(e,a){Ot(this,"heap");Ot(this,"done");Ot(this,"cache",[]);this.heap=new Og(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var zg=P("<span>Back to notes</span>"),Bg=P('<div class="c p-1jdj5w3">No notes in bin</div> <div class="d p-1jdj5w3"><!></div>',1),jg=P("<span>Back to notes</span>"),Hg=P('<div class="c p-1jdj5w3">No notes in archive</div> <div class="d p-1jdj5w3"><!></div>',1),Ug=P('<p class="f">No notes in bin</p>'),Wg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),qg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Vg=P('<div class="g p-1jdj5w3"><div class="d p-1jdj5w3"><!></div> <div>or</div> <div class="d p-1jdj5w3"><!></div></div>'),Kg=P('<div class="e p-1jdj5w3"><!></div>'),Yg=P('<div class="h"><div class="c p-1jdj5w3">No notes found</div></div>'),Gg=P('<div class="i p-1jdj5w3"><ul class="p-1jdj5w3"></ul></div>'),Xg=P('<div class="a p-1jdj5w3"><div class="b p-1jdj5w3"><!></div></div>');function Jg(t,e){fe(e,!0);const{getCountDialog:a}=Zt(),{getScrollContainer:r}=ho(),{createHandleClickDialogPage:o,createDialogPageHref:s}=Jt(),{getSelectedTags:i}=Vn(),{getFeedOrder:l}=ji(),{checkNotesInArchive:d,checkNotesInBin:u,checkNotes:c,isInitedNotes:v}=Bt(),{getSelectedMetaTags:h}=go(),{replaceSearchParams:p,getHref:m}=Vt();Xr();const{getFiltredNotesLength:x,getFiltredNotes:w,getUpdatedFiltredNotesTimestamp:k}=Ia(),{getFeedSearch:F}=Xr();let b="keyboard",T=N(h),L=N(x),Y=N(w),O=N(k),U=N(v),R=54,H=I(0),K=I(0),ee=I(0),Z=I(null),j=N(r),we=null,ie=null,Q=N(()=>n(T).has(et.ARCHIVED)?"archive":n(T).has(et.BIN)?"bin":"notes");const V=N(i);Fe(()=>{n(V),n(de),n(j)?.scrollTo(0,0)});const{enable:$}=ls(),te=()=>{$(),we||(we=requestAnimationFrame(()=>{const _=n(j)?.scrollTop||0;f(ee,_,!0);const S=Math.ceil(n(H)/R);f(K,Math.floor(_/(R*S))*(R*S)),we=null}))},se=()=>{ie||(ie=requestAnimationFrame(()=>{f(H,window.innerHeight-180||0,!0);const _=n(j)?.scrollTop||0;f(ee,_,!0);const S=Math.ceil(n(H)/R);f(K,Math.floor(_/(R*S))*(R*S)),ie=null}))};be(()=>{const _=S=>{if(!(!Nv()&&Kr()===void 0)&&!(a()>0)&&(S.key==="ArrowDown"||S.key==="ArrowUp")){if(S.preventDefault(),S.key==="ArrowDown"){const z=Kr(),M=n(J).findIndex(he=>he.id===z),oe=Te(),ge=Me();if(!z||M===-1)gn(oe?.id);else if(M<=ge.index&&M>=oe.index)Os()&&M!==-1&&_e(M+1)&&n(j)&&(n(j).scrollTop=Math.floor(n(j).scrollTop/R)*R+R);else if(M>ge.index&&!_e(M-1)&&_e(M)){n(j)&&(n(j).scrollTop=Math.ceil(n(j).scrollTop/R)*R+R);const he=Os();gn(he)}else gn(oe?.id)}else if(S.key==="ArrowUp"){const z=Kr(),M=n(J).findIndex(he=>he.id===z),oe=Te(),ge=Me();if(!z||M===-1)gn(ge?.id);else if(M<=ge.index&&M>=oe.index)Fs()&&M!==-1&&_e(M-1)&&n(j)&&(n(j).scrollTop=Math.ceil(n(j).scrollTop/R)*R-R);else if(M<oe.index&&!_e(M+1)&&_e(M)){n(j)&&(n(j).scrollTop=n(Se)+M*R-R);const he=Fs();gn(he)}else gn(ge?.id)}vl()||Jo()}};return document.addEventListener("keydown",_),()=>{document.removeEventListener("keydown",_)}}),be(()=>{se(),te()});const ne=()=>{te()};Fe(()=>{F()!==""&&b==="keyboard"&&(gn(Te().id),Jo())}),Fe(()=>(n(j)?.addEventListener("scroll",ne),window.addEventListener("resize",se),()=>{n(j)?.removeEventListener("scroll",ne),window.removeEventListener("resize",se)}));const de=N(l);Fe(()=>{n(de),n(O),f(Z,new Fg(n(Y),(_,S)=>{if(!_||!S||!_.data||!S.data)return 0;if(_.data.pinned&&!S.data.pinned)return-1;if(!_.data.pinned&&S.data.pinned)return 1;if(_.data.pinned&&S.data.pinned){if(_.data.pinned<S.data.pinned)return 1;if(_.data.pinned>S.data.pinned)return-1}const z=(M,oe)=>M.data.text||oe.data.text?(M.data.text||"").localeCompare(oe.data.text||""):(M.data.link?.title||"").localeCompare(oe.data.link?.title||"");switch(n(de)){case"newest":return _.data.createdAt<S.data.createdAt?1:_.data.createdAt>S.data.createdAt?-1:z(_,S);case"oldest":return _.data.createdAt>S.data.createdAt?1:_.data.createdAt<S.data.createdAt?-1:z(_,S);case"AtoZ":return z(_,S);case"ZtoA":return z(S,_);case"updatedNewest":return _.data.updatedAt<S.data.updatedAt?1:_.data.updatedAt>S.data.updatedAt?-1:z(_,S);case"updatedOldest":return _.data.updatedAt>S.data.updatedAt?1:_.data.updatedAt<S.data.updatedAt?-1:z(_,S);default:return 0}}),!0)});const me=N(()=>n(L)*R);let J=N(()=>{n(O);const _=Math.ceil(n(H)/R);let S=Math.floor(n(K)/R);return S=S-Math.min(S,_),n(Z)?.get(S,S+_*3)||[]}),le=N(()=>R*Math.ceil(n(H)/R));const Se=N(()=>n(K)-Math.min(n(K),n(le))),_e=_=>_*R<n(ee)-n(Se)-R/2||_*R>n(ee)-n(Se)+Math.floor(n(H)/R)*R,Te=()=>{for(let _=0;_<n(J).length;_++)if(!_e(_))return{index:_,id:n(J)[_].id};return{index:-1,id:void 0}},Me=()=>{for(let _=n(J).length-1;_>=0;_--)if(!_e(_))return{index:_,id:n(J)[_].id};return{index:-1,id:void 0}};be(()=>{document.addEventListener("mousemove",()=>{b="mouse"}),document.addEventListener("keydown",()=>{b="keyboard"})});var Oe=Xg(),Ee=C(Oe),G=C(Ee);{var y=_=>{Ra(_,{})},E=_=>{var S=ue(),z=A(S);{var M=ge=>{var he=Bg(),W=D(A(he),2),X=C(W);{let re=N(()=>m(""));Lt(X,{element:"a",get href(){return n(re)},onClick:ye=>{ye.preventDefault(),p("")},children:(ye,Le)=>{var De=zg();g(ye,De)},$$slots:{default:!0}})}g(ge,he)},oe=ge=>{var he=ue(),W=A(he);{var X=ye=>{var Le=Hg(),De=D(A(Le),2),ze=C(De);{let bt=N(()=>m(""));Lt(ze,{element:"a",get href(){return n(bt)},onClick:qe=>{qe.preventDefault(),p("")},children:(qe,ke)=>{var Pe=jg();g(qe,Pe)},$$slots:{default:!0}})}g(ye,Le)},re=ye=>{var Le=ue(),De=A(Le);{var ze=qe=>{var ke=Kg(),Pe=C(ke);{var He=Ve=>{var Ke=Ug();g(Ve,Ke)},Ge=Ve=>{var Ke=Vg(),Be=C(Ke),rt=C(Be);{let Tt=N(()=>s(Ce.NewNote)),ct=N(()=>o(Ce.NewNote));Lt(rt,{element:"a",get href(){return n(Tt)},get onClick(){return n(ct)},children:(Et,mt)=>{var lt=Wg(),Qt=A(lt);ce(Qt,()=>({"--size":"18px","--color":"#b0b0b0"})),pe(Qt.lastChild,{name:"plus"}),g(Et,lt)},$$slots:{default:!0}})}var tt=D(Be,4),Qe=C(tt);{let Tt=N(()=>s(Ce.ImportData)),ct=N(()=>o(Ce.ImportData));Lt(Qe,{element:"a",get href(){return n(Tt)},get onClick(){return n(ct)},children:(Et,mt)=>{var lt=qg(),Qt=A(lt);ce(Qt,()=>({"--size":"18px","--color":"#b0b0b0"})),pe(Qt.lastChild,{name:"import"}),g(Et,lt)},$$slots:{default:!0}})}g(Ve,Ke)};q(Pe,Ve=>{n(Q)==="bin"?Ve(He):Ve(Ge,!1)})}g(qe,ke)},bt=qe=>{var ke=ue(),Pe=A(ke);{var He=Ve=>{var Ke=Yg();g(Ve,Ke)},Ge=Ve=>{var Ke=Gg(),Be=C(Ke);jn(Be,23,()=>n(J),rt=>rt.data,(rt,tt,Qe)=>{var Tt=ue(),ct=A(Tt);{var Et=mt=>{{let lt=N(()=>n(J)[n(Qe)+1]?.id),Qt=N(()=>n(J)[n(Qe)-1]?.id),Nn=N(()=>_e(n(Qe))),An=N(()=>(n(Qe)+5)*R<n(ee)-n(Se)-R/2||(n(Qe)+5)*R>n(ee)-n(Se)+Math.floor(n(H)/R)*R);Hv(mt,{get nextNoteId(){return n(lt)},get prevNoteId(){return n(Qt)},get mode(){return n(Q)},get focusHidden(){return n(Nn)},get showMenuUp(){return n(An)},get noteId(){return n(tt).id},get noteData(){return n(tt).data}})}};q(ct,mt=>{n(tt).data&&mt(Et)})}g(rt,Tt)}),xe(rt=>{er(Ke,rt),er(Be,`transform: translateY(${n(Se)??""}px);`)},[()=>`--minHeight: ${Math.max((n(me)>n(H),n(me)),0)}px`]),g(Ve,Ke)};q(Pe,Ve=>{n(J).length===0?Ve(He):Ve(Ge,!1)},!0)}g(qe,ke)};q(De,qe=>{!u()&&!d()&&!c()?qe(ze):qe(bt,!1)},!0)}g(ye,Le)};q(W,ye=>{n(Q)==="archive"&&!d()?ye(X):ye(re,!1)},!0)}g(ge,he)};q(z,ge=>{n(Q)==="bin"&&!u()?ge(M):ge(oe,!1)},!0)}g(_,S)};q(G,_=>{n(U)?_(E,!1):_(y)})}g(t,Oe),ve()}var Zg=P('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Qg(t){var e=Zg(),a=D(A(e),2),r=C(a);Jg(r,{}),g(t,e)}function $g(t,e){fe(e,!0);const a=Kn();let r=Ne(e,"animationRef",7),o=Ne(e,"dialog",7);dl(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let u=0,c=0,v=()=>1;if(r().current){r().current.pause();let p=Number(r().current.currentTime);br()&&(p=Number(p)+50,r().current.currentTime=Math.min(Math.max(Hn-1,p),p));const m=r().current.effect?.getComputedTiming().progress||0;v=()=>m,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(p=>requestAnimationFrame(p)),c=1-v();const h=c*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-c)*.1}`),a.swipingRatio=Math.abs(1-c)*25,a.isSwiping=!0,a.duration=0,o().style.transform=`translate3d(${h}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:u,currentPosition:h,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:u,width:c})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-u/c)*.1}`),o().style.transform=`translate3d(${u}px, 0, 0)`,a.swipingRatio=Math.abs(1-u/c)*25)},onFinish:({swipeVelocity:u,currentPosition:c,width:v,actionThreshold:h,initialPosition:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const m=()=>Math.abs(p+c)/v*100;let x=null;if(u<=-da?x="open":u>=da?x="close":x=Math.abs(m())>h?"close":"open",r().progress=cl(m()/100),x==="close"){const w=(1-(r().progress||0))*Hn;a.duration=w/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=0,e.onClose()}else{const w=(r().progress||1)*Hn;a.duration=w/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=25,e.onOpen()}}}),ve()}var eh=P('<div class="d p-8xr118"> </div>'),th=P('<button class="e f p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),nh=P('<a class="e g p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),ah=P('<div><div class="a p-8xr118"><div class="b p-8xr118"><div class="c p-8xr118"><!> <!> <!></div></div></div> <!> <!></div>'),rh=P("<dialog><!></dialog> <!>",1);function oh(t,e){fe(e,!0);const{isScrolling:a,enable:r}=ls();let o=I(null),s=I(null),i={};const l=Kn(),{checkLeftEnd:d,checkLeftStart:u,setLeftEnd:c,setLeftStart:v,getCountDialog:h}=Zt(),p=N(u),m=N(d);let x=N(()=>l.working);const w=()=>{e.dialogState!=="opened"&&e.onStartOpening()},k=()=>{e.onClose()},F=()=>{e.onSwipe()},b=ee=>{ee.preventDefault(),k()};be(()=>(n(o)?.addEventListener("close",k),n(o)?.addEventListener("cancel",b),()=>{n(o)?.removeEventListener("close",k),n(o)?.removeEventListener("cancel",b)})),Fe(()=>{h()>0&&(l.swipingRatio=25)}),Fe(()=>{e.dialogState==="opening"?zt(()=>{requestAnimationFrame(()=>{if(!n(o))return;const ee=(i.progress||1)*Hn,Z=n(o).style.transform||`translate3d(${n(p)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const j=n(o)?.animate([{transform:Z},{transform:"translate3d(0, 0, 0)"}],{duration:ee,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=j,j&&(j.onfinish=()=>{e.onOpened(),l.swipingRatio=25,n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=ca().duration,j.cancel(),i.current=void 0,i.progress=void 0,n(p)&&v(!1)})})}):e.dialogState==="closing"&&zt(()=>{requestAnimationFrame(()=>{if(!n(o))return;l.swipingRatio=0;const ee=(1-(i.progress||0))*Hn,Z=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const j=n(o)?.animate([{transform:Z},{transform:`translate3d(${n(m)?"-100%":"100%"}, 0, 0)`}],{duration:ee,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=j,j&&(j.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=ca().duration,j.cancel(),i.current=void 0,i.progress=void 0,n(m)&&c(!1)})})})});const T=()=>{r()},L=N(a);be(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),br()&&n(o).getBoundingClientRect(),!n(x)){e.onOpened();return}e.onStartOpening()}});var Y=rh(),O=A(Y),U=C(O);{var R=ee=>{var Z=ah(),j=C(Z),we=C(j),ie=C(we),Q=C(ie);{var V=J=>{var le=eh(),Se=C(le);xe(()=>dt(Se,e.title)),g(J,le)};q(Q,J=>{e.title&&J(V)})}var $=D(Q,2);{var te=J=>{var le=th();le.__click=k;var Se=C(le);ce(Se,()=>({"--size":"32px"})),pe(Se.lastChild,{name:"back"});var _e=D(Se,2);pt(_e,{children:(Te,Me)=>{var Oe=Ie("back");g(Te,Oe)}}),g(J,le)};q($,J=>{e.blocked||J(te)})}var se=D($,2);{var ne=J=>{var le=nh();le.__click=function(...Te){e.onOpenWindow?.apply(this,Te)};var Se=C(le);ce(Se,()=>({"--scale":"0.7","--size":"32px"})),pe(Se.lastChild,{name:"open-window"});var _e=D(Se,2);pt(_e,{children:(Te,Me)=>{var Oe=Ie("open window");g(Te,Oe)}}),xe(()=>st(le,"href",e.openWindowHref)),g(J,le)};q(se,J=>{e.onOpenWindow&&J(ne)})}var de=D(j,2);Ae(de,()=>e.children);var me=D(de,2);{var ae=J=>{ds(J,{})};q(me,J=>{e.dialogState==="opened"&&J(ae)})}Ze(Z,J=>f(s,J),()=>n(s)),xe(()=>at(Z,1,it({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-8xr118")),cn("scroll",Z,T),g(ee,Z)};q(U,ee=>{e.dialogState!=="preOpening"&&ee(R)})}Ze(O,ee=>f(o,ee),()=>n(o));var H=D(O,2);{var K=ee=>{$g(ee,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:w,onClose:k,onSwipe:F,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};q(H,ee=>{n(s)&&!n(L)&&!e.blocked&&!e.hidden&&ee(K)})}xe(()=>at(O,1,it({h:!0,i:n(x),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(p),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-8xr118")),g(t,Y),ve()}ht(["click"]);function sh(t,e){fe(e,!0);let a=Ne(e,"hidden",3,!1),r=Ne(e,"onClosed",3,()=>{}),o=I(0);be(()=>{const k=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",k),k(),()=>{window.removeEventListener("resize",k)}});const{dialogDec:s,dialogInc:i}=Zt(),l=Kn();be(()=>(i(),()=>{s()}));let d=I("closed");const u=()=>{f(d,"opening")},c=()=>{f(d,"swiping")},v=()=>{f(d,"opened")},h=()=>{e.onClose(),f(d,"closing")},p=()=>{f(d,"closed"),r()()};Fe(()=>{e.shown&&n(d)==="closed"?f(d,"preOpening"):!e.shown&&n(d)==="opened"&&f(d,"closing")}),Fe(()=>{n(d)==="closed"?(l.swipingRatio=0,l.duration=.2):(n(d)==="opened"||n(d)==="opening")&&(l.duration=.2,l.swipingRatio=25)});var m=ue(),x=A(m);{var w=k=>{oh(k,{get dialogWidth(){return n(o)},get dialogState(){return n(d)},get title(){return e.title},onStartOpening:u,onOpened:v,onClose:h,onClosed:p,onSwipe:c,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(F,b)=>{var T=ue(),L=A(T);Ae(L,()=>e.children),g(F,T)},$$slots:{default:!0}})};q(x,k=>{n(d)!=="closed"&&k(w)})}g(t,m),ve()}const ih=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};be(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),be(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var lh=P('<button class="d e p-t76syq"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),ch=P('<div class="f p-t76syq"> </div>'),dh=P('<button class="d g p-t76syq"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),uh=P('<dialog><div class="a p-t76syq"><div class="b p-t76syq"><div class="c p-t76syq"><div><!></div> <!> <div><!></div></div></div> <!></div></dialog> <!>',1);function fh(t,e){fe(e,!0);let a=Ne(e,"blockedDialog",3,!1),r=Ne(e,"hiddenDialog",3,!1),o=Ne(e,"isDesktopAnimationOff",3,!1),s=I(null),i=I(null),l=I(!1);ih({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const d=Kn();Fe(()=>{e.stateDialog==="closing"&&(d.working?n(s)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const{getDialogPageHeight:u}=cs(),c=N(u);be(()=>{setTimeout(()=>{f(l,!0)},50)});var v=uh(),h=A(v),p=C(h),m=C(p),x=C(m),w=C(x),k=C(w);{var F=H=>{var K=lh();K.__click=()=>{e.onStartBack()};var ee=C(K);ce(ee,()=>({"--size":"24px"})),pe(ee.lastChild,{name:"back"});var Z=D(ee,2);pt(Z,{children:(j,we)=>{var ie=Ie("back");g(j,ie)}}),g(H,K)};q(k,H=>{(!(a()||r())||a())&&e.onStartBack&&H(F)})}var b=D(w,2);{var T=H=>{var K=ch(),ee=C(K);xe(()=>dt(ee,e.title)),g(H,K)};q(b,H=>{e.title&&H(T)})}var L=D(b,2),Y=C(L);{var O=H=>{var K=dh();K.__click=()=>{e.onStartClose()};var ee=C(K);ce(ee,()=>({"--size":"24px"})),pe(ee.lastChild,{name:"close"});var Z=D(ee,2);pt(Z,{children:(j,we)=>{var ie=Ie("close");g(j,ie)}}),g(H,K)};q(Y,H=>{a()||r()||H(O)})}var U=D(m,2);Ae(U,()=>e.children),Ze(p,H=>f(i,H),()=>n(i)),Ze(h,H=>f(s,H),()=>n(s));var R=D(h,2);us(R,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose}}),xe(()=>{er(h,`height: ${n(c)+74}px`),at(h,1,it({h:!0,i:e.stateDialog==="open",j:n(l),k:d.working,l:o(),m:r()}),"p-t76syq")}),g(t,v),ve()}ht(["click"]);const vh=({onStartClose:t,onClosed:e})=>{let a=I("close");return{get state(){return n(a)},set state(i){f(a,i,!0)},handleStartClose:(i=!1)=>{i||(f(a,"closing"),t?.())},handleOpen:()=>{f(a,"open")},handleClose:()=>{f(a,"close"),e?.()}}};function gh(t,e){fe(e,!0);let a=Ne(e,"blockedDialog",3,!1),r=Ne(e,"hiddenDialog",3,!1),o=Ne(e,"onStartClose",3,()=>{}),s=Ne(e,"onClosed",3,()=>{}),i=vh({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:l,dialogInc:d}=Zt();be(()=>(d(),()=>{l()})),Fe(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const u=p=>{p.key==="Escape"&&a()&&(p.preventDefault(),p.stopPropagation())};be(()=>(document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}));var c=ue(),v=A(c);{var h=p=>{fh(p,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(m,x)=>{var w=ue(),k=A(w);Ae(k,()=>e.children),g(m,w)},$$slots:{default:!0}})};q(v,p=>{i.state!=="close"&&p(h)})}g(t,c),ve()}const Bs=(t,e=Ye,a=Ye,r)=>{let o=Pr(()=>Ml(r?.(),!1));var s=ue(),i=A(s);{var l=u=>{yt(u,{children:(c,v)=>{Mt(c,{get hidden(){return n(o)},get page(){return Ce.Settings}})},$$slots:{default:!0}})},d=u=>{var c=ue(),v=A(c);{var h=m=>{yt(m,{children:(x,w)=>{Ng(x,{})},$$slots:{default:!0}})},p=m=>{var x=ue(),w=A(x);{var k=b=>{yt(b,{children:(T,L)=>{Mt(T,{get params(){return a()},get hidden(){return n(o)},get page(){return Ce.Note}})},$$slots:{default:!0}})},F=b=>{var T=ue(),L=A(T);{var Y=U=>{yt(U,{children:(R,H)=>{Mt(R,{get hidden(){return n(o)},get page(){return Ce.ImportData}})},$$slots:{default:!0}})},O=U=>{var R=ue(),H=A(R);{var K=Z=>{yt(Z,{children:(j,we)=>{Mt(j,{get hidden(){return n(o)},get page(){return Ce.ExportData}})},$$slots:{default:!0}})},ee=Z=>{var j=ue(),we=A(j);{var ie=V=>{yt(V,{children:($,te)=>{og($,{})},$$slots:{default:!0}})},Q=V=>{var $=ue(),te=A($);{var se=de=>{yt(de,{children:(me,ae)=>{Mt(me,{get hidden(){return n(o)},get page(){return Ce.Install}})},$$slots:{default:!0}})},ne=de=>{var me=ue(),ae=A(me);{var J=Se=>{yt(Se,{children:(_e,Te)=>{Mt(_e,{get hidden(){return n(o)},get page(){return Ce.InstallSuccess}})},$$slots:{default:!0}})},le=Se=>{var _e=ue(),Te=A(_e);{var Me=Ee=>{yt(Ee,{children:(G,y)=>{Mt(G,{get hidden(){return n(o)},get page(){return Ce.Auth}})},$$slots:{default:!0}})},Oe=Ee=>{var G=ue(),y=A(G);{var E=S=>{yt(S,{children:(z,M)=>{Mt(z,{get hidden(){return n(o)},get page(){return Ce.Signup}})},$$slots:{default:!0}})},_=S=>{var z=ue(),M=A(z);{var oe=he=>{yt(he,{children:(W,X)=>{Mt(W,{get hidden(){return n(o)},get page(){return Ce.Signin}})},$$slots:{default:!0}})},ge=he=>{var W=ue(),X=A(W);{var re=Le=>{yt(Le,{children:(De,ze)=>{Mt(De,{get hidden(){return n(o)},get page(){return Ce.AccessKeys}})},$$slots:{default:!0}})},ye=Le=>{var De=ue(),ze=A(De);{var bt=ke=>{yt(ke,{children:(Pe,He)=>{Mt(Pe,{get hidden(){return n(o)},get page(){return Ce.Account}})},$$slots:{default:!0}})},qe=ke=>{var Pe=ue(),He=A(Pe);{var Ge=Ke=>{yt(Ke,{children:(Be,rt)=>{Mt(Be,{get hidden(){return n(o)},get page(){return Ce.ConfirmAccessKey}})},$$slots:{default:!0}})},Ve=Ke=>{var Be=ue(),rt=A(Be);{var tt=Tt=>{yt(Tt,{children:(ct,Et)=>{Mt(ct,{get hidden(){return n(o)},get page(){return Ce.Exit}})},$$slots:{default:!0}})},Qe=Tt=>{var ct=ue(),Et=A(ct);{var mt=lt=>{var Qt=ue(),Nn=A(Qt);{var An=Oa=>{yt(Oa,{children:(Lr,fs)=>{Mt(Lr,{get hidden(){return n(o)},get page(){return Ce.Sync}})},$$slots:{default:!0}})},pl=Oa=>{var Lr=ue(),fs=A(Lr);{var ml=Fa=>{yt(Fa,{children:(Rr,vs)=>{Mt(Rr,{get hidden(){return n(o)},get page(){return Ce.Subscription}})},$$slots:{default:!0}})},_l=Fa=>{var Rr=ue(),vs=A(Rr);{var wl=za=>{yt(za,{children:(_o,bl)=>{Mt(_o,{get hidden(){return n(o)},get page(){return Ce.About}})},$$slots:{default:!0}})},yl=za=>{yt(za,{children:(_o,bl)=>{eg(_o,{})},$$slots:{default:!0}})};q(vs,za=>{e()===Ce.About?za(wl):za(yl,!1)},!0)}g(Fa,Rr)};q(fs,Fa=>{e()===Ce.Subscription?Fa(ml):Fa(_l,!1)},!0)}g(Oa,Lr)};q(Nn,Oa=>{e()===Ce.Sync?Oa(An):Oa(pl,!1)},!0)}g(lt,Qt)};q(Et,lt=>{e(),Ce.Extension,lt(mt,!1)},!0)}g(Tt,ct)};q(rt,Tt=>{e()===Ce.Exit?Tt(tt):Tt(Qe,!1)},!0)}g(Ke,Be)};q(He,Ke=>{e()===Ce.ConfirmAccessKey?Ke(Ge):Ke(Ve,!1)},!0)}g(ke,Pe)};q(ze,ke=>{e()===Ce.Account?ke(bt):ke(qe,!1)},!0)}g(Le,De)};q(X,Le=>{e()===Ce.AccessKeys?Le(re):Le(ye,!1)},!0)}g(he,W)};q(M,he=>{e()===Ce.Signin?he(oe):he(ge,!1)},!0)}g(S,z)};q(y,S=>{e()===Ce.Signup?S(E):S(_,!1)},!0)}g(Ee,G)};q(Te,Ee=>{e()===Ce.Auth?Ee(Me):Ee(Oe,!1)},!0)}g(Se,_e)};q(ae,Se=>{e()===Ce.InstallSuccess?Se(J):Se(le,!1)},!0)}g(de,me)};q(te,de=>{e()===Ce.Install?de(se):de(ne,!1)},!0)}g(V,$)};q(we,V=>{e()===Ce.AccountSetup?V(ie):V(Q,!1)},!0)}g(Z,j)};q(H,Z=>{e()===Ce.ExportData?Z(K):Z(ee,!1)},!0)}g(U,R)};q(L,U=>{e()===Ce.ImportData?U(Y):U(O,!1)},!0)}g(b,T)};q(w,b=>{e()===Ce.Note?b(k):b(F,!1)},!0)}g(m,x)};q(v,m=>{e()===Ce.NewNote?m(h):m(p,!1)},!0)}g(u,c)};q(i,u=>{e()===Ce.Settings?u(l):u(d,!1)})}g(t,s)};var hh=P("<!> <!>",1);function ph(t,e){fe(e,!0);let a=N(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:r,checkClosableDialog:o}=Zt(),{sidebarClose:s,getSidebarState:i}=Mr(),l=N(r),d=N(o),{getDialogPages:u}=Jt(),{getAccount:c}=is();let v=N(u),h=N(()=>c()!==void 0);const{checkMobileSize:p}=La();let m=I(ft([]));const x=N(p),{clearDialogPages:w,popDialogPage:k}=Jt(),{checkLeftStart:F}=Zt();let b=N(F);Fe(()=>{u().length>0&&i()!=="closed"&&setTimeout(()=>{s()},60)});const T=()=>{k()},L=()=>{w()};Fe(()=>{n(v),n(x),zt(()=>{if(n(x))n(v).length>=n(m).length||n(b)?f(m,n(v).map(Z=>({page:Z,shown:!0})),!0):f(m,n(m).map((Z,j)=>({page:Z.page,shown:j<n(v).length})),!0);else if(n(v).length>=n(m).length)f(m,n(v).map(Z=>({page:Z,shown:!0})),!0);else{if(n(v).length===0){f(m,[{page:n(m)[n(m).length-1].page,shown:!1}],!0);return}f(m,n(v).map(Z=>({page:Z,shown:!0})),!0)}})});const Y=()=>{f(m,n(v).map(Z=>({page:Z,shown:!0})),!0)};var O=hh(),U=A(O);{var R=Z=>{Qg(Z)};q(U,Z=>{n(h)&&Z(R)})}var H=D(U,2);{var K=Z=>{var j=ue(),we=A(j);jn(we,19,()=>n(m),ie=>ie.page,(ie,Q,V)=>{const $=N(()=>n(Q).page.split("?")[1]),te=N(()=>n(Q).page.split("?")[0]),se=N(()=>n(V)!==n(m).length-1&&!!n(m)[n(V)+1]?.shown),ne=N(()=>n(V)===0);{let de=N(()=>As[n(te)]||""),me=N(()=>n(l)||n(ne)&&!n(d));sh(ie,Fo({get shown(){return n(Q).shown},get title(){return n(de)},get hidden(){return n(se)},get blocked(){return n(me)},onClose:T,onClosed:Y},()=>n(a),{children:(ae,J)=>{Bs(ae,()=>n(te),()=>n($),()=>n(se))},$$slots:{default:!0}}))}}),g(Z,j)},ee=Z=>{var j=ue(),we=A(j);{var ie=Q=>{const V=N(()=>n(m)[n(m).length-1].page.split("?")[1]),$=N(()=>n(m)[n(m).length-1].page.split("?")[0]),te=N(()=>n(m)[n(m).length-1].shown),se=N(()=>n(m).length===1);{let ne=N(()=>As[n($)]||""),de=N(()=>n(l)||!n(d)),me=N(()=>n(l)||n(se)?void 0:T);gh(Q,{get shownDialog(){return n(te)},get title(){return n(ne)},get blockedDialog(){return n(de)},hiddenDialog:!1,get onStartBack(){return n(me)},onStartClose:L,onClosed:Y,children:(ae,J)=>{Bs(ae,()=>n($),()=>n(V))},$$slots:{default:!0}})}};q(we,Q=>{n(m).length>0&&Q(ie)},!0)}g(Z,j)};q(H,Z=>{p()?Z(K):Z(ee,!1)})}g(t,O),ve()}function mh(t,e){fe(e,!1);let a=0;be(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),os(),ve()}const _h=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;var wh=P('<div><button class="d p-bn1wva"><!> <span class="e p-bn1wva"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),yh=P('<!> <!> <!> <!> <main><div class="a p-bn1wva"><div class="b p-bn1wva"><!></div></div> <div class="c p-bn1wva"><!></div></main> <!>',1);function bh(t,e){fe(e,!0);const{replaceSearchParams:a,getHref:r,getSearchParams:o}=Vt(),{hasDialogPage:s}=Jt(),{setScrollContainer:i}=ho(),{getAccount:l,init:d}=is(),{isInitedNotes:u}=Bt(),{isInitedSettings:c}=Na(),{getDialogPages:v}=Jt(),{createBroadcastChannel:h,tabId:p}=vo(),m=h(),{getSidebarState:x}=Mr(),{setClosableDialog:w}=Zt(),{getViewMode:k}=Na(),F=()=>{_h()?a(`${tn}=${Ce.AccountSetup}`):a(`${tn}=${Ce.Install}`)};be(()=>{d(E=>{E===void 0?F():(s(Ce.AccountSetup)&&a(""),E?f(O,E):f(O,null))});const y=async E=>{const _=JSON.parse(E.data);if(_.tabId&&_.tabId===p)return;const S=_;S.type==="initLocalAccount"||S.type==="initCloudAccount"||S.type==="updateAccount"||S.type==="disconnectCloudAccount"?a(""):S.type==="exit"&&F()};return m.addEventListener(y),()=>m.removeEventListener(y)});const b=Kn();be(async()=>{await new Promise(y=>setTimeout(y,60)),await Ni(),b.working=!0});let T=I(!1),L=0,Y=N(()=>v().length>0),O=N(l),U=N(u),R=N(c),H=I(null);const K=()=>{n(H)&&n(H).scrollTo({top:0})};Fe(()=>{w(n(O)!==void 0)}),Fe(()=>{i(n(H))});const ee=()=>{if(n(H)){const y=n(H).scrollTop||0;y===0?f(T,!1):!n(T)&&L>y?f(T,!0):n(T)&&L+50<y&&f(T,!1),L=y}},Z=()=>{ee()};Fe(()=>(n(H)?.addEventListener("scroll",Z),window.addEventListener("resize",Z),()=>{n(H)?.removeEventListener("scroll",Z),window.removeEventListener("resize",Z)}));const j=N(x);let we=N(()=>b.swipingRatio);const ie=()=>{const y=new URLSearchParams(o());return r(y)},Q=async()=>{},V=N(k),$=N(()=>n(V)==="popup"||n(V)==="sidebar"?{onOpenWindow:Q,openWindowHref:ie()}:{});var te=yh(),se=A(te);mh(se,{});var ne=D(se,2);Lu(ne,{});var de=D(ne,2);ds(de,{});var me=D(de,2);tf(me,{});var ae=D(me,2),J=C(ae),le=C(J),Se=C(le);{var _e=y=>{Zv(y,Fo(()=>n($)))};q(Se,y=>{n(R)&&n(O)!==void 0&&y(_e)})}var Te=D(J,2),Me=C(Te);{var Oe=y=>{ph(y,Fo(()=>n($)))};q(Me,y=>{n(U)&&n(R)&&y(Oe)})}Ze(ae,y=>f(H,y),()=>n(H));var Ee=D(ae,2);{var G=y=>{var E=wh(),_=C(E);_.__click=K;var S=C(_);pt(S,{children:(oe,ge)=>{var he=Ie("top");g(oe,he)}});var z=D(S,2),M=C(z);ce(M,()=>({"--rotate":"90deg","--size":"28px"})),pe(M.lastChild,{name:"back"}),xe(()=>{er(E,`--swiping-ratio: ${n(we)}; --transition-timing-default: ${b.duration}s;`),at(E,1,it({i:!0,g:b.working&&!b.isSwiping,j:n(Y)||n(j)!=="closed"}),"p-bn1wva")}),g(y,E)};q(Ee,y=>{n(T)&&y(G)})}xe(()=>{er(ae,`--swiping-ratio: ${n(we)}; --transition-timing-default: ${b.duration}s;`),at(ae,1,it({f:!0,g:b.working&&!b.isSwiping,h:n(j)!=="closed"}),"p-bn1wva")}),g(t,te),ve()}ht(["click"]);function Sh(t){su(t,{children:(e,a)=>{bh(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||jc(Sh,{target:document.getElementById("app")});export{St as $,N as A,Lt as B,Vt as C,is as D,os as E,Cr as F,cn as G,ng as H,pe as I,Bt as J,La as K,Ra as L,Na as M,ul as N,Ms as O,Ce as P,Ph as Q,Zn as R,Ze as S,Mh as T,Ah as U,pt as V,pu as W,mu as X,tn as Y,br as Z,zt as _,f as a,pa as a0,Pg as a1,vo as a2,Th as a3,Eh as a4,_h as a5,xh as a6,Ne as a7,er as a8,Nh as a9,I as b,C as c,ce as d,jn as e,P as f,n as g,st as h,g as i,q as j,at as k,it as l,ve as m,A as n,be as o,fe as p,dt as q,ht as r,D as s,xe as t,Jt as u,Zt as v,ft as w,Fe as x,ue as y,Ie as z};
