import{G as _e,p as ce,J as me,f as E,e as Te,l as y,s as f,t as ne,b as q,g as e,K as be,M as Ee,m as De,c as v,d as l,N as ke,j as de,w as ve,D as ye,n as xe,q as Oe,O as Le,h as H,r as we,u as Ae,o as le,i as w,k as m,a as Ce,I as $e,v as ee,x as W,B as ae,y as te,L as Re}from"./aDGhOd8ds.js";import{N as Ie}from"./aCBTQ6nN1.js";import{S as ie}from"./aJA1Pq_w4.js";import"./aDXjCFdaU.js";const He=D=>{const r=Math.floor(Date.now()/1e3),s={};D.forEach(a=>{if(!a)return;const o=a.data.tags||["Imported"];if(o.length===0){s.ROOT||(s.ROOT=[]),s.ROOT.push(a);return}o.forEach(t=>{s[t]||(s[t]=[]),s[t].push(a)})});let u=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(s).forEach(a=>{a!=="ROOT"&&a!=="other"&&(u+=`
    <DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}">${a}</H3>
    <DL><p>`,s[a].forEach(o=>{const t=o.data.name.replace(/"/g,"&quot;");u+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||r}">${t}</A>`}),u+=`
    </DL><p>`)}),s.ROOT&&s.ROOT.forEach(a=>{const o=a.data.name.replace(/"/g,"&quot;");u+=`
    <DT><A HREF="${a.data.url}" ADD_DATE="${Math.floor(a.data.createdAt/1e3)||r}">${o}</A>`}),u+=`
</DL><p>`,s.other&&s.other.forEach(a=>{const o=a.data.name.replace(/"/g,"&quot;");u+=`
    <DT><A HREF="${a.data.url}" ADD_DATE="${Math.floor(a.data.createdAt/1e3)||r}">${o}</A>`}),u+="</DL><p>",u},Se=async(D,r="")=>{const s=`${r}.json`,u=JSON.stringify({notes:D}),a=new Blob([u],{type:"application/json"}),o=URL.createObjectURL(a),t=document.createElement("a");t.href=o,t.download=s,document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(o)},0)},Me=(D,r,s)=>{r(D.target.value),s.onChange(r())};var je=E('<input class="c d p-1qofubb" type="radio"/> <label class="e p-1qofubb"> </label>',1),Pe=E('<div class="a p-1qofubb"><fieldset class="b p-1qofubb"><!> <div class="f p-1qofubb"><div class="g p-1qofubb"></div></div></fieldset></div>');function Be(D,r){const s=_e();ce(r,!0);let u=me(r,"value",7);const a=`switcher-${s}`;var o=Pe(),t=v(o),A=v(t);Te(A,17,()=>r.items,k=>k.title,(k,g)=>{var S=je(),x=y(S);x.__change=[Me,u,r];var M=f(x,2),K=v(M);ne(()=>{q(x,"id",`${e(g).title}-${s}`),q(x,"name",a),be(x,e(g).value),Ee(x,e(g).value===u()),q(x,"aria-label",e(g).title),q(M,"for",`${e(g).title}-${s}`),q(M,"title",e(g).title),q(M,"aria-label",e(g).title),De(K,e(g).title)}),l(k,S)});var T=f(A,2),$=v(T);ne(k=>ke($,k),[()=>`transform: translateX(${r.items.findIndex(k=>k.value===u())*100}%)`]),l(D,o),de()}ve(["change"]);var Fe=(D,r)=>m(r,!e(r)),Ne=E('<p class="c h p-12aanne">Exclude history</p> <div class="i p-12aanne"><!></div>',1),qe=E('<p class="c h p-12aanne">Exclude other tags</p> <div class="i p-12aanne"><!></div>',1),Ue=E('<!> <!> <p class="c h p-12aanne">Filter tags:</p> <!>',1),ze=E('<div class="j p-12aanne"><!></div>'),We=E('<div class="b p-12aanne"><h4 class="c p-12aanne">Export data</h4> <div class="d p-12aanne"><!> <p class="e p-12aanne"><!></p></div></div> <div><div class="f p-12aanne"><button class="g p-12aanne"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),Ge=E('<div class="b p-12aanne"><p class="c p-12aanne">Exporting data...</p> <!></div>'),Je=E('<div class="b p-12aanne"><p class="c k p-12aanne">Something went wrong</p></div> <div class="j p-12aanne"><!></div>',1),Ke=E('<div class="b p-12aanne"><p class="c p-12aanne">Data exported successfully!</p></div> <div class="j p-12aanne"><!></div>',1),Qe=E('<div class="a p-12aanne"><!></div>');function ea(D,r){ce(r,!0);const{getGetNotes:s}=ye(),{clearDialogPages:u}=xe(),{blockDialog:a}=Oe(),{checkMobileSize:o}=Le();let t=H("idle"),A=H("sync"),T=H(we([])),$=H(!1),k=H(!1),g=H(!1),S=H(!1);const x=()=>{u()};Ae(()=>{a(e(t)==="loading")}),le(()=>()=>{a(!1)});const M=async()=>{m(t,"loading"),setTimeout(async()=>{let h=(s()()||[]).filter(c=>c.data).filter(c=>e(T).length===0?!0:e(T).every(d=>c.data.tags.includes(d)));if(e(S)&&(h=h.map(c=>{const d={...c};return d.data={...d.data,history:[]},d})),e(g)&&(h=h.map(c=>{const d={...c};return d.data={...d.data,tags:d.data.tags.filter(_=>e(T).includes(_)),history:d.data.history.map(_=>({..._,tags:_.tags.filter(p=>e(T).includes(p))}))},d})),e(A)==="sync")await Se(h,[...e(T),"notes"].join("_")).finally(async()=>{await new Promise(c=>setTimeout(c,500)),m(t,"success")});else try{const c=He(h),d=new Blob([c],{type:"text/html"}),_=URL.createObjectURL(d),p=document.createElement("a");p.href=_,p.download=`${[...e(T),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(_),m(t,"success")}catch{m(t,"error")}},0)},K=i=>{m(T,i,!0)},re=i=>{i.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e($)&&m($,!1),document.activeElement.blur(),i.preventDefault(),i.stopPropagation())},ue=i=>{m(g,i,!0)},pe=i=>{m(S,i,!0)};le(()=>(document.addEventListener("keydown",re),()=>document.removeEventListener("keydown",re)));var se=Qe(),fe=v(se);{var ge=i=>{var h=We(),c=y(h),d=f(v(c),2),_=v(d);Be(_,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(A)},onChange:n=>{m(A,n,!0)}});var p=f(_,2),R=v(p);{var U=n=>{var b=W("App format for sync or backup");l(n,b)},Q=n=>{var b=W("Browser bookmarks format (exports only bookmarks, not notes)");l(n,b)};w(R,n=>{e(A)==="sync"?n(U):n(Q,!1)})}var V=f(c,2),O=v(V),C=v(O);C.__click=[Fe,k];var j=v(C);Ce(j,()=>({"--rotate":"30deg","--size":"20px"})),$e(j.lastChild,{name:"settings"});var P=f(O,2);{var I=n=>{var b=Ue(),F=y(b);{var J=L=>{var z=Ne(),Y=f(y(z),2),Z=v(Y);ie(Z,{get checked(){return e(S)},onChange:pe}),l(L,z)};w(F,L=>{e(A)==="sync"&&L(J)})}var N=f(F,2);{var oe=L=>{var z=qe(),Y=f(y(z),2),Z=v(Y);ie(Z,{get checked(){return e(g)},onChange:ue}),l(L,z)};w(N,L=>{e(T).length>0&&L(oe)})}var X=f(N,4);Ie(X,{mode:"exit",get selectedTags(){return e(T)},onChangeTags:K,get shownTagInput(){return e($)},set shownTagInput(L){m($,L,!0)}}),l(n,b)};w(P,n=>{e(k)&&n(I)})}var B=f(P,2);{var G=n=>{var b=ze(),F=v(b);{let J=te(o);ae(F,{get fullWidth(){return e(J)},onClick:M,children:(N,oe)=>{var X=W("Export");l(N,X)},$$slots:{default:!0}})}l(n,b)};w(B,n=>{e($)||n(G)})}l(i,h)},he=i=>{var h=ee(),c=y(h);{var d=p=>{var R=Ge(),U=f(v(R),2);Re(U,{}),l(p,R)},_=p=>{var R=ee(),U=y(R);{var Q=O=>{var C=Je(),j=f(y(C),2),P=v(j);{let I=te(o);ae(P,{get fullWidth(){return e(I)},onClick:()=>{m(t,"idle")},children:(B,G)=>{var n=W("Try Again");l(B,n)},$$slots:{default:!0}})}l(O,C)},V=O=>{var C=ee(),j=y(C);{var P=I=>{var B=Ke(),G=f(y(B),2),n=v(G);{let b=te(o);ae(n,{get fullWidth(){return e(b)},onClick:x,children:(F,J)=>{var N=W("Close");l(F,N)},$$slots:{default:!0}})}l(I,B)};w(j,I=>{e(t)==="success"&&I(P)},!0)}l(O,C)};w(U,O=>{e(t)==="error"?O(Q):O(V,!1)},!0)}l(p,R)};w(c,p=>{e(t)==="loading"?p(d):p(_,!1)},!0)}l(i,h)};w(fe,i=>{e(t)==="idle"?i(ge):i(he,!1)})}l(D,se),de()}ve(["click"]);export{ea as default};
