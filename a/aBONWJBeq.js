const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/aC8tFh_2t.js","a/aV5hTSKOt.css","a/aa5i5sX7f.js","a/a9q_jSmK4.js","a/abA9hIFUQ.js","a/aCEJYRiD0.css","a/aCLuK-LO-.js","a/aTv4EaMk6.css","a/aD0aGCf9U.js","a/a54d_SC5m.css","a/altcAB6ym.js","a/aCpa8lgv9.js","a/afGUkjeV7.css","a/aN0uO0GoH.js","a/aY1d2PU1k.css","a/aDUOuLKRj.js","a/aCFqNONgv.js","a/aB5329lax.css","a/aLG925tyx.js","a/aCCHsQD5d.css","a/aCqfDKMcs.css","a/aDk-_3NDX.js","a/aCeh8XjKC.css","a/ar2Gr3Y2Z.js","a/aCcep2p5V.css","a/aCM3gO_a_.js","a/awSKLKcnU.css","a/aC1qkNCpj.js","a/aBem4Ctjp.css","a/a6Pi4IEeB.js","a/aBdnakgrk.css","a/aI7lqKR-d.js","a/aCaaU30E9.css","a/aBRJ9mRdI.js","a/aCH18nfIo.css","a/aCs_rTHGA.js","a/aBcamt-sp.js","a/aCb6DfA6m.css","a/aDPKg83v4.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var bl=Object.defineProperty;var vs=t=>{throw TypeError(t)};var Sl=(t,e,a)=>e in t?bl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var Rt=(t,e,a)=>Sl(t,typeof e!="symbol"?e+"":e,a),_o=(t,e,a)=>e.has(t)||vs("Cannot "+a);var z=(t,e,a)=>(_o(t,e,"read from private field"),a?a.call(t):e.get(t)),Be=(t,e,a)=>e.has(t)?vs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),Re=(t,e,a,r)=>(_o(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),nt=(t,e,a)=>(_o(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const Cl=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};Cl(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const kl=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};kl();const Co=!1;var Jo=Array.isArray,xl=Array.prototype.indexOf,ao=Array.from,Tl=Object.defineProperty,$n=Object.getOwnPropertyDescriptor,Hs=Object.getOwnPropertyDescriptors,Us=Object.prototype,El=Array.prototype,ro=Object.getPrototypeOf,gs=Object.isExtensible;function ir(t){return typeof t=="function"}const Ye=()=>{};function Pl(t){return typeof t?.then=="function"}function Nl(t){return t()}function ko(t){for(var e=0;e<t.length;e++)t[e]()}function Ws(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function Al(t,e,a=!1){return t===void 0?a?e():e:t}const Nt=2,Zo=4,oo=8,Ml=1<<24,zn=16,Bn=32,Pa=64,so=128,un=512,Dt=1024,Vt=2048,yn=4096,Xt=8192,An=16384,Qo=32768,sa=65536,hs=1<<17,Vs=1<<18,ar=1<<19,qs=1<<20,Pn=1<<25,xa=32768,xo=1<<21,$o=1<<22,ea=1<<23,ta=Symbol("$state"),Ks=Symbol("legacy props"),Dl=Symbol(""),ja=new class extends Error{constructor(){super(...arguments);Rt(this,"name","StaleReactionError");Rt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ys(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Il(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ll(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Rl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ol(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Fl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function zl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Bl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function jl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Hl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ul(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Wl=1,Vl=2,Gs=4,ql=8,Kl=16,Yl=1,Gl=2,Xl=4,Jl=8,Zl=16,Ql=1,$l=2,Et=Symbol(),ec="http://www.w3.org/1999/xhtml";function tc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Xs(t){return t===this.v}function nc(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Js(t){return!nc(t,this.v)}let rr=!1,ac=!1;function rc(){rr=!0}const oc=[];function ga(t,e=!1,a=!1){return jr(t,new Map,"",oc,null,a)}function jr(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(Jo(t)){var l=Array(t.length);e.set(t,l),o!==null&&e.set(o,l);for(var d=0;d<t.length;d+=1){var u=t[d];d in t&&(l[d]=jr(u,e,a,r,null,s))}return l}if(ro(t)===Us){l={},e.set(t,l),o!==null&&e.set(o,l);for(var c in t)l[c]=jr(t[c],e,a,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return jr(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let et=null;function Ja(t){et=t}function ut(t){return Zs().get(t)}function ft(t,e){return Zs().set(t,e),e}function fe(t,e=!1,a){et={p:et,i:!1,c:null,e:null,s:t,x:null,l:rr&&!e?{s:null,u:null,$:[]}:null}}function ve(t){var e=et,a=e.e;if(a!==null){e.e=null;for(var r of a)mi(r)}return t!==void 0&&(e.x=t),e.i=!0,et=e.p,t??{}}function or(){return!rr||et!==null&&et.l===null}function Zs(t){return et===null&&Ys(),et.c??(et.c=new Map(sc(et)||void 0))}function sc(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let pa=[];function Qs(){var t=pa;pa=[],ko(t)}function Na(t){if(pa.length===0&&!Wa){var e=pa;queueMicrotask(()=>{e===pa&&Qs()})}pa.push(t)}function ic(){for(;pa.length>0;)Qs()}function $s(t){var e=Ge;if(e===null)return We.f|=ea,t;if((e.f&Qo)===0){if((e.f&so)===0)throw t;e.b.error(t)}else Za(t,e)}function Za(t,e){for(;e!==null;){if((e.f&so)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Or=new Set;let Xe=null,Hr=null,sn=null,rn=[],io=null,To=!1,Wa=!1;var qa,Ka,ma,_a,kr,Ya,Ga,Pt,Eo,cr,Po,ei,ti;const Qr=class Qr{constructor(){Be(this,Pt);Rt(this,"committed",!1);Rt(this,"current",new Map);Rt(this,"previous",new Map);Be(this,qa,new Set);Be(this,Ka,new Set);Be(this,ma,0);Be(this,_a,0);Be(this,kr,null);Be(this,Ya,new Set);Be(this,Ga,new Set);Rt(this,"skipped_effects",new Set);Rt(this,"is_fork",!1)}is_deferred(){return this.is_fork||z(this,_a)>0}process(e){rn=[],Hr=null,this.apply();var a={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)nt(this,Pt,Eo).call(this,r,a);this.is_fork||nt(this,Pt,ei).call(this),this.is_deferred()?(nt(this,Pt,cr).call(this,a.effects),nt(this,Pt,cr).call(this,a.render_effects)):(Hr=this,Xe=null,ps(a.render_effects),ps(a.effects),Hr=null,z(this,kr)?.resolve()),sn=null}capture(e,a){this.previous.has(e)||this.previous.set(e,a),(e.f&ea)===0&&(this.current.set(e,e.v),sn?.set(e,e.v))}activate(){Xe=this,this.apply()}deactivate(){Xe===this&&(Xe=null,sn=null)}flush(){if(this.activate(),rn.length>0){if(ai(),Xe!==null&&Xe!==this)return}else z(this,ma)===0&&this.process([]);this.deactivate()}discard(){for(const e of z(this,Ka))e(this);z(this,Ka).clear()}increment(e){Re(this,ma,z(this,ma)+1),e&&Re(this,_a,z(this,_a)+1)}decrement(e){Re(this,ma,z(this,ma)-1),e&&Re(this,_a,z(this,_a)-1),this.revive()}revive(){for(const e of z(this,Ya))z(this,Ga).delete(e),Lt(e,Vt),Ta(e);for(const e of z(this,Ga))Lt(e,yn),Ta(e);this.flush()}oncommit(e){z(this,qa).add(e)}ondiscard(e){z(this,Ka).add(e)}settled(){return(z(this,kr)??Re(this,kr,Ws())).promise}static ensure(){if(Xe===null){const e=Xe=new Qr;Or.add(Xe),Wa||Qr.enqueue(()=>{Xe===e&&e.flush()})}return Xe}static enqueue(e){Na(e)}apply(){}};qa=new WeakMap,Ka=new WeakMap,ma=new WeakMap,_a=new WeakMap,kr=new WeakMap,Ya=new WeakMap,Ga=new WeakMap,Pt=new WeakSet,Eo=function(e,a){e.f^=Dt;for(var r=e.first;r!==null;){var o=r.f,s=(o&(Bn|Pa))!==0,i=s&&(o&Dt)!==0,l=i||(o&Xt)!==0||this.skipped_effects.has(r);if((r.f&so)!==0&&r.b?.is_pending()&&(a={parent:a,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=Dt:(o&Zo)!==0?a.effects.push(r):Ar(r)&&((r.f&zn)!==0&&z(this,Ya).add(r),wr(r));var d=r.first;if(d!==null){r=d;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===a.effect&&(nt(this,Pt,cr).call(this,a.effects),nt(this,Pt,cr).call(this,a.render_effects),a=a.parent),r=u.next,u=u.parent}},cr=function(e){for(const a of e)(a.f&Vt)!==0?z(this,Ya).add(a):(a.f&yn)!==0&&z(this,Ga).add(a),nt(this,Pt,Po).call(this,a.deps),Lt(a,Dt)},Po=function(e){if(e!==null)for(const a of e)(a.f&Nt)===0||(a.f&xa)===0||(a.f^=xa,nt(this,Pt,Po).call(this,a.deps))},ei=function(){if(z(this,_a)===0){for(const e of z(this,qa))e();z(this,qa).clear()}z(this,ma)===0&&nt(this,Pt,ti).call(this)},ti=function(){var s;if(Or.size>1){this.previous.clear();var e=sn,a=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Or){if(i===this){a=!1;continue}const l=[];for(const[u,c]of this.current){if(i.current.has(u))if(a&&c!==i.current.get(u))i.current.set(u,c);else continue;l.push(u)}if(l.length===0)continue;const d=[...i.current.keys()].filter(u=>!this.current.has(u));if(d.length>0){var o=rn;rn=[];const u=new Set,c=new Map;for(const v of l)ri(v,d,u,c);if(rn.length>0){Xe=i,i.apply();for(const v of rn)nt(s=i,Pt,Eo).call(s,v,r);i.deactivate()}rn=o}}Xe=null,sn=e}this.committed=!0,Or.delete(this)};let mn=Qr;function ni(t){var e=Wa;Wa=!0;try{for(var a;;){if(ic(),rn.length===0&&(Xe?.flush(),rn.length===0))return io=null,a;ai()}}finally{Wa=e}}function ai(){var t=ka;To=!0;var e=null;try{var a=0;for(Yr(!0);rn.length>0;){var r=mn.ensure();if(a++>1e3){var o,s;lc()}r.process(rn),na.clear()}}finally{To=!1,Yr(t),io=null}}function lc(){try{Fl()}catch(t){Za(t,io)}}let kn=null;function ps(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(An|Xt))===0&&Ar(r)&&(kn=new Set,wr(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?yi(r):r.fn=null),kn?.size>0)){na.clear();for(const o of kn){if((o.f&(An|Xt))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)kn.has(i)&&(kn.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const d=s[l];(d.f&(An|Xt))===0&&wr(d)}}kn.clear()}}kn=null}}function ri(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&Nt)!==0?ri(o,e,a,r):(s&($o|zn))!==0&&(s&Vt)===0&&oi(o,e,r)&&(Lt(o,Vt),Ta(o))}}function oi(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(e.includes(o))return!0;if((o.f&Nt)!==0&&oi(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function Ta(t){for(var e=io=t;e.parent!==null;){e=e.parent;var a=e.f;if(To&&e===Ge&&(a&zn)!==0&&(a&Vs)===0)return;if((a&(Pa|Bn))!==0){if((a&Dt)===0)return;e.f^=Dt}}rn.push(e)}function cc(t){let e=0,a=bn(0),r;return()=>{mr()&&(n(a),co(()=>(e===0&&(r=Ft(()=>t(()=>aa(a)))),e+=1,()=>{Na(()=>{e-=1,e===0&&(r?.(),r=void 0,aa(a))})})))}}var dc=sa|ar|so;function uc(t,e,a){new fc(t,e,a)}var tn,nn,Xo,fn,wa,vn,an,Ht,gn,En,Gn,ya,Xn,ba,Jn,$r,Tt,vc,gc,No,Ur,Wr,Ao;class fc{constructor(e,a,r){Be(this,Tt);Rt(this,"parent");Be(this,tn,!1);Be(this,nn);Be(this,Xo,null);Be(this,fn);Be(this,wa);Be(this,vn);Be(this,an,null);Be(this,Ht,null);Be(this,gn,null);Be(this,En,null);Be(this,Gn,null);Be(this,ya,0);Be(this,Xn,0);Be(this,ba,!1);Be(this,Jn,null);Be(this,$r,cc(()=>(Re(this,Jn,bn(z(this,ya))),()=>{Re(this,Jn,null)})));Re(this,nn,e),Re(this,fn,a),Re(this,wa,r),this.parent=Ge.b,Re(this,tn,!!z(this,fn).pending),Re(this,vn,sr(()=>{Ge.b=this;{var o=nt(this,Tt,No).call(this);try{Re(this,an,on(()=>r(o)))}catch(s){this.error(s)}z(this,Xn)>0?nt(this,Tt,Wr).call(this):Re(this,tn,!1)}return()=>{z(this,Gn)?.remove()}},dc))}is_pending(){return z(this,tn)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!z(this,fn).pending}update_pending_count(e){nt(this,Tt,Ao).call(this,e),Re(this,ya,z(this,ya)+e),z(this,Jn)&&Mn(z(this,Jn),z(this,ya))}get_effect_pending(){return z(this,$r).call(this),n(z(this,Jn))}error(e){var a=z(this,fn).onerror;let r=z(this,fn).failed;if(z(this,ba)||!a&&!r)throw e;z(this,an)&&(Wt(z(this,an)),Re(this,an,null)),z(this,Ht)&&(Wt(z(this,Ht)),Re(this,Ht,null)),z(this,gn)&&(Wt(z(this,gn)),Re(this,gn,null));var o=!1,s=!1;const i=()=>{if(o){tc();return}o=!0,s&&Ul(),mn.ensure(),Re(this,ya,0),z(this,gn)!==null&&Ca(z(this,gn),()=>{Re(this,gn,null)}),Re(this,tn,this.has_pending_snippet()),Re(this,an,nt(this,Tt,Ur).call(this,()=>(Re(this,ba,!1),on(()=>z(this,wa).call(this,z(this,nn)))))),z(this,Xn)>0?nt(this,Tt,Wr).call(this):Re(this,tn,!1)};var l=We;try{Ut(null),s=!0,a?.(e,i),s=!1}catch(d){Za(d,z(this,vn)&&z(this,vn).parent)}finally{Ut(l)}r&&Na(()=>{Re(this,gn,nt(this,Tt,Ur).call(this,()=>{mn.ensure(),Re(this,ba,!0);try{return on(()=>{r(z(this,nn),()=>e,()=>i)})}catch(d){return Za(d,z(this,vn).parent),null}finally{Re(this,ba,!1)}}))})}}tn=new WeakMap,nn=new WeakMap,Xo=new WeakMap,fn=new WeakMap,wa=new WeakMap,vn=new WeakMap,an=new WeakMap,Ht=new WeakMap,gn=new WeakMap,En=new WeakMap,Gn=new WeakMap,ya=new WeakMap,Xn=new WeakMap,ba=new WeakMap,Jn=new WeakMap,$r=new WeakMap,Tt=new WeakSet,vc=function(){try{Re(this,an,on(()=>z(this,wa).call(this,z(this,nn))))}catch(e){this.error(e)}Re(this,tn,!1)},gc=function(){const e=z(this,fn).pending;e&&(Re(this,Ht,on(()=>e(z(this,nn)))),mn.enqueue(()=>{var a=nt(this,Tt,No).call(this);Re(this,an,nt(this,Tt,Ur).call(this,()=>(mn.ensure(),on(()=>z(this,wa).call(this,a))))),z(this,Xn)>0?nt(this,Tt,Wr).call(this):(Ca(z(this,Ht),()=>{Re(this,Ht,null)}),Re(this,tn,!1))}))},No=function(){var e=z(this,nn);return z(this,tn)&&(Re(this,Gn,Dn()),z(this,nn).before(z(this,Gn)),e=z(this,Gn)),e},Ur=function(e){var a=Ge,r=We,o=et;Sn(z(this,vn)),Ut(z(this,vn)),Ja(z(this,vn).ctx);try{return e()}catch(s){return $s(s),null}finally{Sn(a),Ut(r),Ja(o)}},Wr=function(){const e=z(this,fn).pending;z(this,an)!==null&&(Re(this,En,document.createDocumentFragment()),z(this,En).append(z(this,Gn)),Ci(z(this,an),z(this,En))),z(this,Ht)===null&&Re(this,Ht,on(()=>e(z(this,nn))))},Ao=function(e){var a;if(!this.has_pending_snippet()){this.parent&&nt(a=this.parent,Tt,Ao).call(a,e);return}Re(this,Xn,z(this,Xn)+e),z(this,Xn)===0&&(Re(this,tn,!1),z(this,Ht)&&Ca(z(this,Ht),()=>{Re(this,Ht,null)}),z(this,En)&&(z(this,nn).before(z(this,En)),Re(this,En,null)))};function hc(t,e,a,r){const o=or()?Er:Pr;if(a.length===0&&t.length===0){r(e.map(o));return}var s=Xe,i=Ge,l=si();function d(){Promise.all(a.map(u=>pc(u))).then(u=>{l();try{r([...e.map(o),...u])}catch(c){(i.f&An)===0&&Za(c,i)}s?.deactivate(),pr()}).catch(u=>{Za(u,i)})}t.length>0?Promise.all(t).then(()=>{l();try{return d()}finally{s?.deactivate(),pr()}}):d()}function si(){var t=Ge,e=We,a=et,r=Xe;return function(s=!0){Sn(t),Ut(e),Ja(a),s&&r?.activate()}}function pr(){Sn(null),Ut(null),Ja(null)}function Er(t){var e=Nt|Vt,a=We!==null&&(We.f&Nt)!==0?We:null;return Ge!==null&&(Ge.f|=ar),{ctx:et,deps:null,effects:null,equals:Xs,f:e,fn:t,reactions:null,rv:0,v:Et,wv:0,parent:a??Ge,ac:null}}function pc(t,e){let a=Ge;a===null&&Il();var r=a.b,o=void 0,s=bn(Et),i=!We,l=new Map;return Ec(()=>{var d=Ws();o=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{u===Xe&&u.committed&&u.deactivate(),pr()})}catch(p){d.reject(p),pr()}var u=Xe;if(i){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),l.get(u)?.reject(ja),l.delete(u),l.set(u,d)}const v=(p,m=void 0)=>{if(u.activate(),m)m!==ja&&(s.f|=ea,Mn(s,m));else{(s.f&ea)!==0&&(s.f^=ea),Mn(s,p);for(const[_,x]of l){if(l.delete(_),_===u)break;x.reject(ja)}}i&&(r.update_pending_count(-1),u.decrement(c))};d.promise.then(v,p=>v(null,p||"unknown"))}),pi(()=>{for(const d of l.values())d.reject(ja)}),new Promise(d=>{function u(c){function v(){c===o?d(s):u(o)}c.then(v,v)}u(o)})}function A(t){const e=Er(t);return ki(e),e}function Pr(t){const e=Er(t);return e.equals=Js,e}function ii(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)Wt(e[a])}}function mc(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&An)===0?e:null;e=e.parent}return null}function es(t){var e,a=Ge;Sn(mc(t));try{t.f&=~xa,ii(t),e=Pi(t)}finally{Sn(a)}return e}function li(t){var e=es(t);if(t.equals(e)||(Xe?.is_fork||(t.v=e),t.wv=Ti()),!Aa)if(sn!==null)(mr()||Xe?.is_fork)&&sn.set(t,e);else{var a=(t.f&un)===0?yn:Dt;Lt(t,a)}}let Mo=new Set;const na=new Map;let ci=!1;function bn(t,e){var a={f:0,v:t,reactions:null,equals:Xs,rv:0,wv:0};return a}function I(t,e){const a=bn(t);return ki(a),a}function Do(t,e=!1,a=!0){var o;const r=bn(t);return e||(r.equals=Js),rr&&a&&et!==null&&et.l!==null&&((o=et.l).s??(o.s=[])).push(r),r}function f(t,e,a=!1){We!==null&&(!_n||(We.f&hs)!==0)&&or()&&(We.f&(Nt|zn|$o|hs))!==0&&!In?.includes(t)&&Hl();let r=a?dt(e):e;return Mn(t,r)}function Mn(t,e){if(!t.equals(e)){var a=t.v;Aa?na.set(t,e):na.set(t,a),t.v=e;var r=mn.ensure();r.capture(t,a),(t.f&Nt)!==0&&((t.f&Vt)!==0&&es(t),Lt(t,(t.f&un)!==0?Dt:yn)),t.wv=Ti(),di(t,Vt),or()&&Ge!==null&&(Ge.f&Dt)!==0&&(Ge.f&(Bn|Pa))===0&&($t===null?Ac([t]):$t.push(t)),!r.is_fork&&Mo.size>0&&!ci&&_c()}return e}function _c(){ci=!1;var t=ka;Yr(!0);const e=Array.from(Mo);try{for(const a of e)(a.f&Dt)!==0&&Lt(a,yn),Ar(a)&&wr(a)}finally{Yr(t)}Mo.clear()}function aa(t){f(t,t.v+1)}function di(t,e){var a=t.reactions;if(a!==null)for(var r=or(),o=a.length,s=0;s<o;s++){var i=a[s],l=i.f;if(!(!r&&i===Ge)){var d=(l&Vt)===0;if(d&&Lt(i,e),(l&Nt)!==0){var u=i;sn?.delete(u),(l&xa)===0&&(l&un&&(i.f|=xa),di(u,yn))}else d&&((l&zn)!==0&&kn!==null&&kn.add(i),Ta(i))}}}function dt(t){if(typeof t!="object"||t===null||ta in t)return t;const e=ro(t);if(e!==Us&&e!==El)return t;var a=new Map,r=Jo(t),o=I(0),s=Ln,i=l=>{if(Ln===s)return l();var d=We,u=Ln;Ut(null),ys(s);var c=l();return Ut(d),ys(u),c};return r&&a.set("length",I(t.length)),new Proxy(t,{defineProperty(l,d,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Bl();var c=a.get(d);return c===void 0?c=i(()=>{var v=I(u.value);return a.set(d,v),v}):f(c,u.value,!0),!0},deleteProperty(l,d){var u=a.get(d);if(u===void 0){if(d in l){const c=i(()=>I(Et));a.set(d,c),aa(o)}}else f(u,Et),aa(o);return!0},get(l,d,u){if(d===ta)return t;var c=a.get(d),v=d in l;if(c===void 0&&(!v||$n(l,d)?.writable)&&(c=i(()=>{var m=dt(v?l[d]:Et),_=I(m);return _}),a.set(d,c)),c!==void 0){var p=n(c);return p===Et?void 0:p}return Reflect.get(l,d,u)},getOwnPropertyDescriptor(l,d){var u=Reflect.getOwnPropertyDescriptor(l,d);if(u&&"value"in u){var c=a.get(d);c&&(u.value=n(c))}else if(u===void 0){var v=a.get(d),p=v?.v;if(v!==void 0&&p!==Et)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return u},has(l,d){if(d===ta)return!0;var u=a.get(d),c=u!==void 0&&u.v!==Et||Reflect.has(l,d);if(u!==void 0||Ge!==null&&(!c||$n(l,d)?.writable)){u===void 0&&(u=i(()=>{var p=c?dt(l[d]):Et,m=I(p);return m}),a.set(d,u));var v=n(u);if(v===Et)return!1}return c},set(l,d,u,c){var v=a.get(d),p=d in l;if(r&&d==="length")for(var m=u;m<v.v;m+=1){var _=a.get(m+"");_!==void 0?f(_,Et):m in l&&(_=i(()=>I(Et)),a.set(m+"",_))}if(v===void 0)(!p||$n(l,d)?.writable)&&(v=i(()=>I(void 0)),f(v,dt(u)),a.set(d,v));else{p=v.v!==Et;var x=i(()=>dt(u));f(v,x)}var w=Reflect.getOwnPropertyDescriptor(l,d);if(w?.set&&w.set.call(c,u),!p){if(r&&typeof d=="string"){var k=a.get("length"),O=Number(d);Number.isInteger(O)&&O>=k.v&&f(k,O+1)}aa(o)}return!0},ownKeys(l){n(o);var d=Reflect.ownKeys(l).filter(v=>{var p=a.get(v);return p===void 0||p.v!==Et});for(var[u,c]of a)c.v!==Et&&!(u in l)&&d.push(u);return d},setPrototypeOf(){jl()}})}var ms,ui,fi,vi;function wc(){if(ms===void 0){ms=window,ui=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;fi=$n(e,"firstChild").get,vi=$n(e,"nextSibling").get,gs(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),gs(a)&&(a.__t=void 0)}}function Dn(t=""){return document.createTextNode(t)}function Qa(t){return fi.call(t)}function Nr(t){return vi.call(t)}function C(t,e){return Qa(t)}function M(t,e=!1){{var a=Qa(t);return a instanceof Comment&&a.data===""?Nr(a):a}}function D(t,e=1,a=!1){let r=t;for(;e--;)r=Nr(r);return r}function yc(t){t.textContent=""}function gi(){return!1}let _s=!1;function bc(){_s||(_s=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function lo(t){var e=We,a=Ge;Ut(null),Sn(null);try{return t()}finally{Ut(e),Sn(a)}}function Sc(t,e,a,r=a){t.addEventListener(e,()=>lo(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),bc()}function hi(t){Ge===null&&(We===null&&Ol(),Rl()),Aa&&Ll()}function Cc(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function Cn(t,e,a){var r=Ge;r!==null&&(r.f&Xt)!==0&&(t|=Xt);var o={ctx:et,deps:null,nodes:null,f:t|Vt|un,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{wr(o),o.f|=Qo}catch(l){throw Wt(o),l}else e!==null&&Ta(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&ar)===0&&(s=s.first,(t&zn)!==0&&(t&sa)!==0&&s!==null&&(s.f|=sa)),s!==null&&(s.parent=r,r!==null&&Cc(s,r),We!==null&&(We.f&Nt)!==0&&(t&Pa)===0)){var i=We;(i.effects??(i.effects=[])).push(s)}return o}function mr(){return We!==null&&!_n}function pi(t){const e=Cn(oo,null,!1);return Lt(e,Dt),e.teardown=t,e}function ze(t){hi();var e=Ge.f,a=!We&&(e&Bn)!==0&&(e&Qo)===0;if(a){var r=et;(r.e??(r.e=[])).push(t)}else return mi(t)}function mi(t){return Cn(Zo|qs,t,!1)}function kc(t){return hi(),Cn(oo|qs,t,!0)}function xc(t){mn.ensure();const e=Cn(Pa|ar,t,!0);return(a={})=>new Promise(r=>{a.outro?Ca(e,()=>{Wt(e),r(void 0)}):(Wt(e),r(void 0))})}function Tc(t){return Cn(Zo,t,!1)}function Ec(t){return Cn($o|ar,t,!0)}function co(t,e=0){return Cn(oo|e,t,!0)}function Ce(t,e=[],a=[],r=[]){hc(r,e,a,o=>{Cn(oo,()=>t(...o.map(n)),!0)})}function sr(t,e=0){var a=Cn(zn|e,t,!0);return a}function on(t){return Cn(Bn|ar,t,!0)}function _i(t){var e=t.teardown;if(e!==null){const a=Aa,r=We;ws(!0),Ut(null);try{e.call(null)}finally{ws(a),Ut(r)}}}function wi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&lo(()=>{o.abort(ja)});var r=a.next;(a.f&Pa)!==0?a.parent=null:Wt(a,e),a=r}}function Pc(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&Bn)===0&&Wt(e),e=a}}function Wt(t,e=!0){var a=!1;(e||(t.f&Vs)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Nc(t.nodes.start,t.nodes.end),a=!0),wi(t,e&&!a),Gr(t,0),Lt(t,An);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();_i(t);var o=t.parent;o!==null&&o.first!==null&&yi(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Nc(t,e){for(;t!==null;){var a=t===e?null:Nr(t);t.remove(),t=a}}function yi(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function Ca(t,e,a=!0){var r=[];bi(t,r,!0);var o=()=>{a&&Wt(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var l of r)l.out(i)}else o()}function bi(t,e,a){if((t.f&Xt)===0){t.f^=Xt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||a)&&e.push(l);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&sa)!==0||(o.f&Bn)!==0&&(t.f&zn)!==0;bi(o,e,i?a:!1),o=s}}}function ts(t){Si(t,!0)}function Si(t,e){if((t.f&Xt)!==0){t.f^=Xt,(t.f&Dt)===0&&(Lt(t,Vt),Ta(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&sa)!==0||(a.f&Bn)!==0;Si(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function Ci(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Nr(a);e.append(a),a=o}}let ka=!1;function Yr(t){ka=t}let Aa=!1;function ws(t){Aa=t}let We=null,_n=!1;function Ut(t){We=t}let Ge=null;function Sn(t){Ge=t}let In=null;function ki(t){We!==null&&(In===null?In=[t]:In.push(t))}let Ot=null,Kt=0,$t=null;function Ac(t){$t=t}let xi=1,_r=0,Ln=_r;function ys(t){Ln=t}function Ti(){return++xi}function Ar(t){var e=t.f;if((e&Vt)!==0)return!0;if(e&Nt&&(t.f&=~xa),(e&yn)!==0){var a=t.deps;if(a!==null)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(Ar(s)&&li(s),s.wv>t.wv)return!0}(e&un)!==0&&sn===null&&Lt(t,Dt)}return!1}function Ei(t,e,a=!0){var r=t.reactions;if(r!==null&&!In?.includes(t))for(var o=0;o<r.length;o++){var s=r[o];(s.f&Nt)!==0?Ei(s,e,!1):e===s&&(a?Lt(s,Vt):(s.f&Dt)!==0&&Lt(s,yn),Ta(s))}}function Pi(t){var _;var e=Ot,a=Kt,r=$t,o=We,s=In,i=et,l=_n,d=Ln,u=t.f;Ot=null,Kt=0,$t=null,We=(u&(Bn|Pa))===0?t:null,In=null,Ja(t.ctx),_n=!1,Ln=++_r,t.ac!==null&&(lo(()=>{t.ac.abort(ja)}),t.ac=null);try{t.f|=xo;var c=t.fn,v=c(),p=t.deps;if(Ot!==null){var m;if(Gr(t,Kt),p!==null&&Kt>0)for(p.length=Kt+Ot.length,m=0;m<Ot.length;m++)p[Kt+m]=Ot[m];else t.deps=p=Ot;if(mr()&&(t.f&un)!==0)for(m=Kt;m<p.length;m++)((_=p[m]).reactions??(_.reactions=[])).push(t)}else p!==null&&Kt<p.length&&(Gr(t,Kt),p.length=Kt);if(or()&&$t!==null&&!_n&&p!==null&&(t.f&(Nt|yn|Vt))===0)for(m=0;m<$t.length;m++)Ei($t[m],t);return o!==null&&o!==t&&(_r++,$t!==null&&(r===null?r=$t:r.push(...$t))),(t.f&ea)!==0&&(t.f^=ea),v}catch(x){return $s(x)}finally{t.f^=xo,Ot=e,Kt=a,$t=r,We=o,In=s,Ja(i),_n=l,Ln=d}}function Mc(t,e){let a=e.reactions;if(a!==null){var r=xl.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}a===null&&(e.f&Nt)!==0&&(Ot===null||!Ot.includes(e))&&(Lt(e,yn),(e.f&un)!==0&&(e.f^=un,e.f&=~xa),ii(e),Gr(e,0))}function Gr(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Mc(t,a[r])}function wr(t){var e=t.f;if((e&An)===0){Lt(t,Dt);var a=Ge,r=ka;Ge=t,ka=!0;try{(e&(zn|Ml))!==0?Pc(t):wi(t),_i(t);var o=Pi(t);t.teardown=typeof o=="function"?o:null,t.wv=xi;var s;Co&&ac&&(t.f&Vt)!==0&&t.deps}finally{ka=r,Ge=a}}}async function Ni(){await Promise.resolve(),ni()}function n(t){var e=t.f,a=(e&Nt)!==0;if(We!==null&&!_n){var r=Ge!==null&&(Ge.f&An)!==0;if(!r&&!In?.includes(t)){var o=We.deps;if((We.f&xo)!==0)t.rv<_r&&(t.rv=_r,Ot===null&&o!==null&&o[Kt]===t?Kt++:Ot===null?Ot=[t]:Ot.includes(t)||Ot.push(t));else{(We.deps??(We.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[We]:s.includes(We)||s.push(We)}}}if(Aa){if(na.has(t))return na.get(t);if(a){var i=t,l=i.v;return((i.f&Dt)===0&&i.reactions!==null||Mi(i))&&(l=es(i)),na.set(i,l),l}}else a&&(!sn?.has(t)||Xe?.is_fork&&!mr())&&(i=t,Ar(i)&&li(i),ka&&mr()&&(i.f&un)===0&&Ai(i));if(sn?.has(t))return sn.get(t);if((t.f&ea)!==0)throw t.v;return t.v}function Ai(t){if(t.deps!==null){t.f^=un;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&un)===0&&Ai(e)}}function Mi(t){if(t.v===Et)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(na.has(e)||(e.f&Nt)!==0&&Mi(e))return!0;return!1}function Ft(t){var e=_n;try{return _n=!0,t()}finally{_n=e}}const Dc=-7169;function Lt(t,e){t.f=t.f&Dc|e}function Ic(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ta in t)Io(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&ta in a&&Io(a)}}}function Io(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Io(t[r],e)}catch{}const a=ro(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Hs(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const Lc=["touchstart","touchmove"];function Rc(t){return Lc.includes(t)}const Di=new Set,Lo=new Set;function Oc(t,e,a,r={}){function o(s){if(r.capture||dr.call(e,s),!s.cancelBubble)return lo(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Na(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function ln(t,e,a,r,o){var s={capture:r,passive:o},i=Oc(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&pi(()=>{e.removeEventListener(t,i,s)})}function vt(t){for(var e=0;e<t.length;e++)Di.add(t[e]);for(var a of Lo)a(t)}let bs=null;function dr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;bs=t;var i=0,l=bs===t&&t.__root;if(l){var d=o.indexOf(l);if(d!==-1&&(e===document||e===window)){t.__root=e;return}var u=o.indexOf(e);if(u===-1)return;d<=u&&(i=d)}if(s=o[i]||t.target,s!==e){Tl(t,"currentTarget",{configurable:!0,get(){return s||a}});var c=We,v=Ge;Ut(null),Sn(null);try{for(var p,m=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+r];x!=null&&(!s.disabled||t.target===s)&&x.call(s,t)}catch(w){p?m.push(w):p=w}if(t.cancelBubble||_===e||_===null)break;s=_}if(p){for(let w of m)queueMicrotask(()=>{throw w});throw p}}finally{t.__root=e,delete t.currentTarget,Ut(c),Sn(v)}}}function Ii(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function yr(t,e){var a=Ge;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function P(t,e){var a=(e&Ql)!==0,r=(e&$l)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=Ii(s?t:"<!>"+t),a||(o=Qa(o)));var i=r||ui?document.importNode(o,!0):o.cloneNode(!0);if(a){var l=Qa(i),d=i.lastChild;yr(l,d)}else yr(i,i);return i}}function Fc(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=Ii(o),l=Qa(i);s=Qa(l)}var d=s.cloneNode(!0);return yr(d,d),d}}function zc(t,e){return Fc(t,e,"svg")}function Le(t=""){{var e=Dn(t+"");return yr(e,e),e}}function de(){var t=document.createDocumentFragment(),e=document.createComment(""),a=Dn();return t.append(e,a),yr(e,a),t}function h(t,e){t!==null&&t.before(e)}function Sh(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function it(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Bc(t,e){return jc(t,e)}const za=new Map;function jc(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){wc();var l=new Set,d=v=>{for(var p=0;p<v.length;p++){var m=v[p];if(!l.has(m)){l.add(m);var _=Rc(m);e.addEventListener(m,dr,{passive:_});var x=za.get(m);x===void 0?(document.addEventListener(m,dr,{passive:_}),za.set(m,1)):za.set(m,x+1)}}};d(ao(Di)),Lo.add(d);var u=void 0,c=xc(()=>{var v=a??e.appendChild(Dn());return uc(v,{pending:()=>{}},p=>{if(s){fe({});var m=et;m.c=s}o&&(r.$$events=o),u=t(p,r)||{},s&&ve()}),()=>{for(var p of l){e.removeEventListener(p,dr);var m=za.get(p);--m===0?(document.removeEventListener(p,dr),za.delete(p)):za.set(p,m)}Lo.delete(d),v!==a&&v.parentNode?.removeChild(v)}});return Hc.set(u,c),u}let Hc=new WeakMap;var cn,hn,Gt,Sa,xr,Tr,eo;class uo{constructor(e,a=!0){Rt(this,"anchor");Be(this,cn,new Map);Be(this,hn,new Map);Be(this,Gt,new Map);Be(this,Sa,new Set);Be(this,xr,!0);Be(this,Tr,()=>{var e=Xe;if(z(this,cn).has(e)){var a=z(this,cn).get(e),r=z(this,hn).get(a);if(r)ts(r),z(this,Sa).delete(a);else{var o=z(this,Gt).get(a);o&&(z(this,hn).set(a,o.effect),z(this,Gt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of z(this,cn)){if(z(this,cn).delete(s),s===e)break;const l=z(this,Gt).get(i);l&&(Wt(l.effect),z(this,Gt).delete(i))}for(const[s,i]of z(this,hn)){if(s===a||z(this,Sa).has(s))continue;const l=()=>{if(Array.from(z(this,cn).values()).includes(s)){var u=document.createDocumentFragment();Ci(i,u),u.append(Dn()),z(this,Gt).set(s,{effect:i,fragment:u})}else Wt(i);z(this,Sa).delete(s),z(this,hn).delete(s)};z(this,xr)||!r?(z(this,Sa).add(s),Ca(i,l,!1)):l()}}});Be(this,eo,e=>{z(this,cn).delete(e);const a=Array.from(z(this,cn).values());for(const[r,o]of z(this,Gt))a.includes(r)||(Wt(o.effect),z(this,Gt).delete(r))});this.anchor=e,Re(this,xr,a)}ensure(e,a){var r=Xe,o=gi();if(a&&!z(this,hn).has(e)&&!z(this,Gt).has(e))if(o){var s=document.createDocumentFragment(),i=Dn();s.append(i),z(this,Gt).set(e,{effect:on(()=>a(i)),fragment:s})}else z(this,hn).set(e,on(()=>a(this.anchor)));if(z(this,cn).set(r,e),o){for(const[l,d]of z(this,hn))l===e?r.skipped_effects.delete(d):r.skipped_effects.add(d);for(const[l,d]of z(this,Gt))l===e?r.skipped_effects.delete(d.effect):r.skipped_effects.add(d.effect);r.oncommit(z(this,Tr)),r.ondiscard(z(this,eo))}else z(this,Tr).call(this)}}cn=new WeakMap,hn=new WeakMap,Gt=new WeakMap,Sa=new WeakMap,xr=new WeakMap,Tr=new WeakMap,eo=new WeakMap;const Uc=0,wo=1;function Wc(t,e,a,r,o){var s=or(),i=Et,l=s?bn(i):Do(i,!1,!1),d=s?bn(i):Do(i,!1,!1),u=new uo(t);sr(()=>{var c=e(),v=!1;if(Pl(c)){var p=si(),m=!1;const _=x=>{if(!v){m=!0,p(!1),mn.ensure();try{x()}finally{pr(),Wa||ni()}}};c.then(x=>{_(()=>{Mn(l,x),u.ensure(wo,r&&(w=>r(w,l)))})},x=>{_(()=>{if(Mn(d,x),u.ensure(wo,o&&(w=>o(w,d))),!o)throw d.v})}),Na(()=>{m||_(()=>{u.ensure(Uc,a)})})}else Mn(l,c),u.ensure(wo,r&&(_=>r(_,l)));return()=>{v=!0}})}function H(t,e,a=!1){var r=new uo(t),o=a?sa:0;function s(i,l){r.ensure(i,l)}sr(()=>{var i=!1;e((l,d=!0)=>{i=!0,s(d,l)}),i||s(!1,null)},o)}function ue(t,e){co(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Vc(t,e,a){for(var r=[],o=e.length,s,i=e.length,l=0;l<o;l++){let v=e[l];Ca(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var p=t.outrogroups;Ro(ao(s.done)),p.delete(s),p.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var d=r.length===0&&a!==null;if(d){var u=a,c=u.parentNode;yc(c),c.append(u),t.items.clear()}Ro(e,!d)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function Ro(t,e=!0){for(var a=0;a<t.length;a++)Wt(t[a],e)}var Ss;function Rn(t,e,a,r,o,s=null){var i=t,l=new Map,d=(e&Gs)!==0;if(d){var u=t;i=u.appendChild(Dn())}var c=null,v=Pr(()=>{var k=a();return Jo(k)?k:k==null?[]:ao(k)}),p,m=!0;function _(){w.fallback=c,qc(w,p,i,e,r),c!==null&&(p.length===0?(c.f&Pn)===0?ts(c):(c.f^=Pn,ur(c,null,i)):Ca(c,()=>{c=null}))}var x=sr(()=>{p=n(v);for(var k=p.length,O=new Set,y=Xe,T=gi(),R=0;R<k;R+=1){var W=p[R],N=r(W,R),L=m?null:l.get(N);L?(L.v&&Mn(L.v,W),L.i&&Mn(L.i,R),T&&y.skipped_effects.delete(L.e)):(L=Kc(l,m?i:Ss??(Ss=Dn()),W,N,R,o,e,a),m||(L.e.f|=Pn),l.set(N,L)),O.add(N)}if(k===0&&s&&!c&&(m?c=on(()=>s(i)):(c=on(()=>s(Ss??(Ss=Dn()))),c.f|=Pn)),!m)if(T){for(const[J,U]of l)O.has(J)||y.skipped_effects.add(U.e);y.oncommit(_),y.ondiscard(()=>{})}else _();n(v)}),w={effect:x,items:l,outrogroups:null,fallback:c};m=!1}function qc(t,e,a,r,o){var s=(r&ql)!==0,i=e.length,l=t.items,d=t.effect.first,u,c=null,v,p=[],m=[],_,x,w,k;if(s)for(k=0;k<i;k+=1)_=e[k],x=o(_,k),w=l.get(x).e,(w.f&Pn)===0&&(w.nodes?.a?.measure(),(v??(v=new Set)).add(w));for(k=0;k<i;k+=1){if(_=e[k],x=o(_,k),w=l.get(x).e,t.outrogroups!==null)for(const U of t.outrogroups)U.pending.delete(w),U.done.delete(w);if((w.f&Pn)!==0)if(w.f^=Pn,w===d)ur(w,null,a);else{var O=c?c.next:d;w===t.effect.last&&(t.effect.last=w.prev),w.prev&&(w.prev.next=w.next),w.next&&(w.next.prev=w.prev),Un(t,c,w),Un(t,w,O),ur(w,O,a),c=w,p=[],m=[],d=c.next;continue}if((w.f&Xt)!==0&&(ts(w),s&&(w.nodes?.a?.unfix(),(v??(v=new Set)).delete(w))),w!==d){if(u!==void 0&&u.has(w)){if(p.length<m.length){var y=m[0],T;c=y.prev;var R=p[0],W=p[p.length-1];for(T=0;T<p.length;T+=1)ur(p[T],y,a);for(T=0;T<m.length;T+=1)u.delete(m[T]);Un(t,R.prev,W.next),Un(t,c,R),Un(t,W,y),d=y,c=W,k-=1,p=[],m=[]}else u.delete(w),ur(w,d,a),Un(t,w.prev,w.next),Un(t,w,c===null?t.effect.first:c.next),Un(t,c,w),c=w;continue}for(p=[],m=[];d!==null&&d!==w;)(u??(u=new Set)).add(d),m.push(d),d=d.next;if(d===null)continue}(w.f&Pn)===0&&p.push(w),c=w,d=w.next}if(t.outrogroups!==null){for(const U of t.outrogroups)U.pending.size===0&&(Ro(ao(U.done)),t.outrogroups?.delete(U));t.outrogroups.size===0&&(t.outrogroups=null)}if(d!==null||u!==void 0){var N=[];if(u!==void 0)for(w of u)(w.f&Xt)===0&&N.push(w);for(;d!==null;)(d.f&Xt)===0&&d!==t.fallback&&N.push(d),d=d.next;var L=N.length;if(L>0){var J=(r&Gs)!==0&&i===0?a:null;if(s){for(k=0;k<L;k+=1)N[k].nodes?.a?.measure();for(k=0;k<L;k+=1)N[k].nodes?.a?.fix()}Vc(t,N,J)}}s&&Na(()=>{if(v!==void 0)for(w of v)w.nodes?.a?.apply()})}function Kc(t,e,a,r,o,s,i,l){var d=(i&Wl)!==0?(i&Kl)===0?Do(a,!1,!1):bn(a):null,u=(i&Vl)!==0?bn(o):null;return{v:d,i:u,e:on(()=>(s(e,d??a,u??o,l),()=>{t.delete(r)}))}}function ur(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&Pn)===0?e.nodes.start:a;r!==null;){var i=Nr(r);if(s.before(r),r===o)return;r=i}}function Un(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function De(t,e,...a){var r=new uo(t);sr(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},sa)}function Yc(t,e,a){var r=new uo(t);sr(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},sa)}function Li(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=Li(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function Gc(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=Li(t))&&(r&&(r+=" "),r+=e);return r}function rt(t){return typeof t=="object"?Gc(t):t??""}const Cs=[...` 	
\r\fÂ \v\uFEFF`];function Xc(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||Cs.includes(r[i-1]))&&(l===r.length||Cs.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function Jc(t,e){return t==null?null:String(t)}function tt(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var l=Xc(a,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=a}else if(s&&o!==s)for(var d in s){var u=!!s[d];(o==null||u!==!!o[d])&&t.classList.toggle(d,u)}return s}function $a(t,e,a,r){var o=t.__style;if(o!==e){var s=Jc(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const Zc=Symbol("is custom element"),Qc=Symbol("is html");function Ch(t,e){var a=ns(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function kh(t,e){var a=ns(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function at(t,e,a,r){var o=ns(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Dl]=a),a==null?t.removeAttribute(e):typeof a!="string"&&$c(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function ns(t){return t.__attributes??(t.__attributes={[Zc]:t.nodeName.includes("-"),[Qc]:t.namespaceURI===ec})}var ks=new Map;function $c(t){var e=t.getAttribute("is")||t.nodeName,a=ks.get(e);if(a)return a;ks.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=Hs(o);for(var i in r)r[i].set&&a.push(i);o=ro(o)}return a}function Ri(t,e,a=e){var r=new WeakSet;Sc(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=yo(t)?bo(s):s,a(s),Xe!==null&&r.add(Xe),await Ni(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,d=t.value.length;if(t.value=s??"",l!==null){var u=t.value.length;i===l&&l===d&&u>d?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=i,t.selectionEnd=Math.min(l,u))}}}),Ft(e)==null&&t.value&&(a(yo(t)?bo(t.value):t.value),Xe!==null&&r.add(Xe)),co(()=>{var o=e();if(t===document.activeElement){var s=Hr??Xe;if(r.has(s))return}yo(t)&&o===bo(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function yo(t){var e=t.type;return e==="number"||e==="range"}function bo(t){return t===""?null:+t}function xs(t,e){return t===e||t?.[ta]===e}function Je(t={},e,a,r){return Tc(()=>{var o,s;return co(()=>{o=s,s=[],Ft(()=>{t!==a(...s)&&(e(t,...s),o&&xs(a(...o),t)&&e(null,...o))})}),()=>{Na(()=>{s&&xs(a(...s),t)&&e(null,...s)})}}),t}function as(t=!1){const e=et,a=e.l.u;if(!a)return;let r=()=>Ic(e.s);if(t){let o=0,s={};const i=Er(()=>{let l=!1;const d=e.s;for(const u in d)d[u]!==s[u]&&(s[u]=d[u],l=!0);return l&&o++,o});r=()=>n(i)}a.b.length&&kc(()=>{Ts(e,r),ko(a.b)}),ze(()=>{const o=Ft(()=>a.m.map(Nl));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&ze(()=>{Ts(e,r),ko(a.a)})}function Ts(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let Fr=!1;function ed(t){var e=Fr;try{return Fr=!1,[t(),Fr]}finally{Fr=e}}const td={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(ir(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];ir(o)&&(o=o());const s=$n(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(ir(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=$n(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===ta||e===Ks)return!1;for(let a of t.props)if(ir(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(ir(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function Oo(...t){return new Proxy({props:t},td)}function Pe(t,e,a,r){var o=!rr||(a&Gl)!==0,s=(a&Jl)!==0,i=(a&Zl)!==0,l=r,d=!0,u=()=>(d&&(d=!1,l=i?Ft(r):r),l),c;if(s){var v=ta in t||Ks in t;c=$n(t,e)?.set??(v&&e in t?y=>t[e]=y:void 0)}var p,m=!1;s?[p,m]=ed(()=>t[e]):p=t[e],p===void 0&&r!==void 0&&(p=u(),c&&(o&&zl(),c(p)));var _;if(o?_=()=>{var y=t[e];return y===void 0?u():(d=!0,y)}:_=()=>{var y=t[e];return y!==void 0&&(l=void 0),y===void 0?l:y},o&&(a&Xl)===0)return _;if(c){var x=t.$$legacy;return(function(y,T){return arguments.length>0?((!o||!T||x||m)&&c(T?_():y),y):_()})}var w=!1,k=((a&Yl)!==0?Er:Pr)(()=>(w=!1,_()));s&&n(k);var O=Ge;return(function(y,T){if(arguments.length>0){const R=T?n(k):o&&s?dt(y):y;return f(k,R),w=!0,l!==void 0&&(l=R),y}return Aa&&w||(O.f&An)!==0?k.v:n(k)})}function we(t){et===null&&Ys(),rr&&et.l!==null?nd(et).m.push(t):ze(()=>{const e=Ft(t);if(typeof e=="function")return e})}function nd(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const ad="5";var js;typeof window<"u"&&((js=window.__svelte??(window.__svelte={})).v??(js.v=new Set)).add(ad);rc();const Oi={};function rd(t){ft(Oi,t)}function rs(){const t=ut(Oi);if(!t)throw new Error("No FeedSearchContext found");return t}const Fi={};function od(t){ft(Fi,t)}function qt(){const t=ut(Fi);if(!t)throw new Error("No SearchParamsContext found");return t}function sd(t,e){fe(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=qt(),s="feedSearch",i=A(()=>o().get(s)||""),l=A(()=>n(i));rd({getFeedSearch:()=>n(l),setFeedSearch:c=>{c===""?r(s):a(s,c)}});var d=de(),u=M(d);De(u,()=>e.children??Ye),h(t,d),ve()}const zi={};function id(t){ft(zi,t)}function ld(){const t=ut(zi);if(!t)throw new Error("No TagsSearchContext found");return t}function cd(t,e){fe(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=qt(),s="tagsSearch",i=A(()=>o().get(s)||""),l=A(()=>n(i));id({getTagsSearch:()=>n(l),setTagsSearch:c=>{c===""?r(s):a(s,c)}});var d=de(),u=M(d);De(u,()=>e.children??Ye),h(t,d),ve()}const Bi={};function dd(t){ft(Bi,t)}function ji(){const t=ut(Bi);if(!t)throw new Error("No FeedOrderContext found");return t}function ud(t,e){fe(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=qt(),s="feedOrder",i=A(()=>o().get(s)||"newest"),l=A(()=>n(i));let d=["newest","oldest","AtoZ","ZtoA","updatedNewest","updatedOldest"];dd({getFeedOrder:()=>n(l),setFeedOrder:v=>{v==="newest"||!d.includes(v)?r(s):a(s,v)}});var u=de(),c=M(u);De(c,()=>e.children??Ye),h(t,u),ve()}const Hi={};function fd(t){ft(Hi,t)}function Mr(){const t=ut(Hi);if(!t)throw new Error("No SidebarContext found");return t}function vd(t,e){fe(e,!0);let a=I("closed");fd({sidebarOpen:()=>{f(a,"preOpening")},sidebarClose:()=>{f(a,"closing")},getSidebarState:()=>n(a),setSidebarState:u=>{f(a,u,!0)}});var l=de(),d=M(l);De(d,()=>e.children??Ye),h(t,l),ve()}const Ui={};function gd(t){ft(Ui,t)}function jn(){const t=ut(Ui);if(!t)throw new Error("No SelectedTagsContext found");return t}function hd(t,e){fe(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=qt(),s=A(a),i="selectedTags";let l=A(()=>n(s).get(i)||""),d=A(()=>new Set(n(l).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!=="")));gd({getSelectedTags:()=>n(d),addTag:w=>{n(d).has(w)||r(i,[...n(d),w].map(k=>encodeURIComponent(k)).join(","))},removeTag:w=>{n(d).has(w)&&n(d).size===1?o(i):n(d).has(w)&&r(i,[...n(d)].filter(k=>k!==w).map(k=>encodeURIComponent(k)).join(","))},clearTags:()=>{o(i)},setSelectedTags:w=>{w.size===0?o(i):r(i,[...w].map(k=>encodeURIComponent(k)).join(","))}});var _=de(),x=M(_);De(x,()=>e.children??Ye),h(t,_),ve()}const Wi={};function pd(t){ft(Wi,t)}function la(){const t=ut(Wi);if(!t)throw new Error("No SelectedNotesContext found");return t}var md=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],_d=["difference","intersection","symmetricDifference","union"],Es=!1,Xa,dn,Zn,to,tr,Vi,qi;const no=class no extends Set{constructor(a){super();Be(this,tr);Be(this,Xa,new Map);Be(this,dn,I(0));Be(this,Zn,I(0));Be(this,to,Ln||-1);if(a){for(var r of a)super.add(r);z(this,Zn).v=super.size}Es||nt(this,tr,qi).call(this)}has(a){var r=super.has(a),o=z(this,Xa),s=o.get(a);if(s===void 0){if(!r)return n(z(this,dn)),!1;s=nt(this,tr,Vi).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),f(z(this,Zn),super.size),aa(z(this,dn))),this}delete(a){var r=super.delete(a),o=z(this,Xa),s=o.get(a);return s!==void 0&&(o.delete(a),f(s,!1)),r&&(f(z(this,Zn),super.size),aa(z(this,dn))),r}clear(){if(super.size!==0){super.clear();var a=z(this,Xa);for(var r of a.values())f(r,!1);a.clear(),f(z(this,Zn),0),aa(z(this,dn))}}keys(){return this.values()}values(){return n(z(this,dn)),super.values()}entries(){return n(z(this,dn)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(z(this,Zn))}};Xa=new WeakMap,dn=new WeakMap,Zn=new WeakMap,to=new WeakMap,tr=new WeakSet,Vi=function(a){return Ln===z(this,to)?I(a):bn(a)},qi=function(){Es=!0;var a=no.prototype,r=Set.prototype;for(const o of md)a[o]=function(...s){return n(z(this,dn)),r[o].apply(this,s)};for(const o of _d)a[o]=function(...s){n(z(this,dn));var i=r[o].apply(this,s);return new no(i)}};let Fo=no;function wd(t,e){fe(e,!0);let a=new Fo,r=I("single");const o=()=>a,s=m=>{a.clear(),m.forEach(_=>a.add(_))},i=m=>{a.add(m)},l=m=>{a.delete(m)},d=()=>{a.clear()};pd({getSelectedNotes:o,setSelectedNotes:s,addNote:i,removeNote:l,clearNotes:d,getMode:()=>n(r),changeMode:m=>{f(r,m,!0),m==="single"&&d()}});var v=de(),p=M(v);De(p,()=>e.children??Ye),h(t,v),ve()}const Ki={};function yd(t){ft(Ki,t)}function os(){const t=ut(Ki);if(!t)throw new Error("No LocalDBContext found");return t}const Yi={};function bd(t){ft(Yi,t)}function er(){const t=ut(Yi);if(!t)throw new Error("No SettingsContext found");return t}const Gi={};function Sd(t){ft(Gi,t)}function fo(){const t=ut(Gi);if(!t)throw new Error("No BroadcastContext found");return t}const Cd="AppStorage",kd=1,fr="account",qn="settings",Ze="notes",jt="tags",xd="syncLog",ca="success",Fn="error",xt=(t,e,a)=>{t?.addEventListener(e,a)},Ps=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();xt(s,ca,()=>{const i=s?.result||[];a(i)}),xt(s,Fn,i=>{r(i)})}),Xr=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);xt(i,ca,()=>{const l=i?.result?.data;r(l)}),xt(i,Fn,l=>{o(l)})}),pn=(t,e,a,r)=>new Promise((o,s)=>{const d=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});xt(d,ca,()=>{o()}),xt(d,Fn,u=>{s(u)})}),_t=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((l,d)=>{xt(i,ca,()=>{l()}),xt(i,Fn,u=>{d(u)})})}))},So=(t,e,a)=>new Promise((r,o)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);xt(l,ca,()=>{r()}),xt(l,Fn,d=>{o(d)})}),lr=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((l,d)=>{xt(i,ca,()=>{l()}),xt(i,Fn,u=>{d(u)})})}))},Ha=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();xt(i,ca,()=>{a()}),xt(i,Fn,l=>{r(l)})}),en="dialogPages",Xi={};function Td(t){ft(Xi,t)}function Jt(){const t=ut(Xi);if(!t)throw new Error("No DialogPagesContext found");return t}var ye=(t=>(t.NewNote="newNote",t.Note="note",t.Settings="settings",t.ImportData="importData",t.ExportData="exportData",t.Account="account",t.Sync="sync",t.AccountSetup="accountSetup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="accessKeys",t.ConfirmAccessKey="confirmAccessKey",t.Subscription="subscription",t.Exit="exit",t.NotFound="notFound",t.About="about",t.Install="install",t.InstallSuccess="installSuccess",t.Extension="extension",t))(ye||{});const Ns={settings:"Settings",importData:"Import",exportData:"Export",account:"Account",sync:"Sync",accountSetup:"",auth:"Auth",signin:"Sign in",signup:"Sign up",confirmAccessKey:"Confirm access key",accessKeys:"Access keys",subscription:"Subscription",exit:"Exit",notFound:"",about:"About",install:"Install app",installSuccess:"Install success",extension:"Extension"},xh=()=>chrome,As=()=>LanguageModel;function Ed(t,e){fe(e,!0);const{deleteSearchParam:a,getSearchParams:r}=qt(),{clearDialogPages:o,getDialogPages:s,replaceDialogPage:i}=Jt(),l="viewMode";let u=dt((()=>{const $=new URLSearchParams(window.location.search).get(l)||"tab";return $==="popup"||$==="window"||$==="tab"||$==="sidebar"?$:"tab"})());we(()=>{a(l)});let c=I(!1),v=I(dt({showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:p}=os(),{createBroadcastChannel:m,tabId:_}=fo(),x=m(),w=A(p),k=async()=>{const he=await Xr(n(w),qn,"default");he&&f(v,he,!0)},O=async()=>{await k();const he=r().get("noteId");s().includes(ye.NewNote)&&he&&(i(`${ye.Note}?id=${he}`),a("noteId")),f(c,!0)},y=async he=>{const $=JSON.parse(he.data),j=$;if($.tabId&&$.tabId===_){j.type==="exit"&&(f(v,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),Ha(n(w),qn));return}j.type==="updateSettings"?k():j.type==="exit"&&f(v,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},T=()=>n(v).showFavicon,R=()=>n(v).recordMode,W=async he=>{n(v).showFavicon=he,await pn(n(w),qn,"default",ga(n(v))),x.postMessage({type:"updateSettings"})},N=async he=>{n(v).recordMode=he,await pn(n(w),qn,"default",ga(n(v))),x.postMessage({type:"updateSettings"})},L=async he=>{n(v).tags.prev=he,await pn(n(w),qn,"default",ga(n(v))),x.postMessage({type:"updateSettings"})},J=()=>n(v).tags.prev||[],U=async he=>{n(v).tags.llm=he,await pn(n(w),qn,"default",ga(n(v))),x.postMessage({type:"updateSettings"})},K=()=>n(v).tags.llm,Z=()=>n(v).tags.pageData,X=async he=>{n(v).tags.pageData=he,await pn(n(w),qn,"default",ga(n(v))),x.postMessage({type:"updateSettings"})};we(()=>(O(),x.addEventListener(y),()=>{x.removeEventListener(y)})),bd({getFaviconEnabled:T,getRecordMode:R,setRecordMode:N,setFaviconShown:W,isInitedSettings:()=>n(c),getViewMode:()=>u,setLlmTagsEnabled:U,getLlmTagsEnabled:K,setPrevTags:L,getPrevTags:J,getPageDataForTagsEnabled:Z,setPageDataForTagsEnabled:X});var V=de(),ge=M(V);De(ge,()=>e.children??Ye),h(t,V),ve()}const Ji={};function Pd(t){ft(Ji,t)}function ss(){const t=ut(Ji);if(!t)throw new Error("No AccountContext found");return t}function Nd(t,e){fe(e,!0);let a=I(void 0);const{getDB:r}=os(),{createBroadcastChannel:o,tabId:s}=fo(),i=A(r),l=o(),d=async()=>{const y=await Xr(n(i),fr,"default");f(a,y,!0)},u=y=>pn(n(i),fr,"default",y),c=async y=>{const T=await Xr(n(i),fr,"default");T!==void 0&&f(a,T,!0),y(T)},v=async y=>{const T=JSON.parse(y.data);if(T.tabId&&T.tabId===s)return;const R=T;R.type==="initLocalAccount"?f(a,null):R.type==="initCloudAccount"?d():R.type==="disconnectCloudAccount"?f(a,null):R.type==="exit"?f(a,void 0):R.type==="updateAccount"&&d()};we(()=>(l.addEventListener(v),()=>{l.removeEventListener(v)})),Pd({init:c,getAccount:()=>n(a),initLocalAccount:async()=>{f(a,null),await u(null),l.postMessage({type:"initLocalAccount"})},initCloudAccount:async y=>{const T={encryptedClientKey:y.encryptedClientKey||"",subscriptionExpires:y.subscriptionExpires||-1,lastSync:-1};await u(T),f(a,T,!0),l.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{f(a,null),await u(null),l.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async y=>{if(!n(a))throw new Error("No account to update subscription for");const T={...n(a),subscriptionExpires:y};await u(T),l.postMessage({type:"updateAccount"})},exitApp:async()=>{f(a,void 0),l.postMessage({type:"exit"}),await Ha(n(i),fr)}});var k=de(),O=M(k);De(O,()=>e.children??Ye),h(t,k),ve()}const Zi={};function Ad(t){ft(Zi,t)}function zt(){const t=ut(Zi);if(!t)throw new Error("No NotesContext found");return t}const Kn=()=>crypto.randomUUID(),Md=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},Qi=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}};async function Th(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{console.error("")}}const Ct=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t));function Dd(t,e){fe(e,!0);const{getDB:a}=os(),{createBroadcastChannel:r,tabId:o}=fo(),s=A(a),i=r(),l=720*60*60*1e3;let d=I(!1),u=I(()=>new Map),c=I(()=>[]),v=I(()=>new Map);const p=()=>n(d),m=()=>n(c)().some(g=>g.data&&!g.data.deletedAt&&!g.data.archivedAt),_=()=>n(c)().some(g=>g.data&&g.data.deletedAt),x=()=>n(c)().some(g=>g.data&&g.data.archivedAt&&!g.data.deletedAt),w=g=>{const b=n(c)(),S=n(v)(),E=S.get(g.id);E?E.data=g.data:(b.push(g),S.set(g.id,g)),f(c,()=>b),f(v,()=>S)},k=g=>{const b=n(c)(),S=n(v)(),E=S.get(g);S.has(g)&&S.delete(g),E&&(E.data=void 0),f(c,()=>b),f(v,()=>S)},O=g=>{const b=n(c)(),S=n(v)();for(const E of g){const F=S.get(E);S.has(E)&&S.delete(E),F&&(F.data=void 0)}f(c,()=>b),f(v,()=>S)},y=()=>{f(c,()=>[]),f(u,()=>new Map),f(v,()=>new Map)},T=()=>n(c),R=g=>{const b=n(u)();for(const S of g)b.get(S)||b.set(S,{name:S});f(u,()=>b)},W=async()=>{const[g,b]=await Promise.all([Ps(n(s),Ze),Ps(n(s),jt).then(q=>q.reduce((Y,se)=>Y.set(se.id,se.data),new Map))]),S=[],E=[],F=new Map;for(const q of g)q.data.deletedAt&&Date.now()-q.data.deletedAt>l?S.push(q.id):(E.push(q),F.set(q.id,q));const B=Md(E),oe=[],ke=new Map(b);[...B.values()].forEach(q=>{ke.set(q,{name:q,pinned:b.get(q)?.pinned||!1}),b.has(q)||oe.push(q)});const ie=[];[...b.keys()].forEach(q=>{B.has(q)||ie.push(q)}),await lr(n(s),Ze,S),await lr(n(s),jt,ie),await _t(n(s),jt,oe.map(q=>({id:q,data:{pinned:ke.get(q)?.pinned||!1}}))),f(c,()=>E),f(v,()=>F),f(u,()=>ke),f(d,!0)},N=async g=>{const b=n(u)(),S=g.data.tags.filter(E=>!b.has(E))||[];return await pn(n(s),Ze,g.id,{...g.data}),S.length>0&&(await _t(n(s),jt,S.map(E=>({id:E,data:{pinned:!1}}))||[]),R(S)),w(g),i.postMessage({type:"putNote",data:{id:g.id}}),g.id},L=async({link:g,text:b,tags:S})=>{const E={id:Kn(),data:{link:Ct(g),text:b,tags:Ct(S),history:[],createdAt:Date.now(),updatedAt:Date.now()}};return await N(E),E.id},J=async(g,{link:b,text:S,tags:E})=>{const F=V(g);if(!F||!F.data)return;const B={id:g,data:{...F.data,link:Ct(b),text:S,tags:Ct(E),updatedAt:Date.now()}};await N(B)},U=async(g,{link:b,text:S,tags:E})=>{const F=V(g);if(!F||!F.data)return;const B=Kn(),oe={id:g,data:{...F.data,link:b,text:S,tags:E,updatedAt:Date.now(),history:[...(F.data.history||[]).slice(-49),{id:B,link:Ct(F.data.link),text:F.data.text,tags:Ct(F.data.tags),updatedAt:F.data.updatedAt}]}};return await N(oe),B},K=async(g,b)=>{const S=V(g);if(!S||!S.data)return;const E=S.data.history?.find?.(B=>B.id===b);if(!E)return;const F={id:g,data:{...S.data,link:Ct(E.link),text:E.text,tags:Ct(E.tags),updatedAt:E.updatedAt,history:S.data.history?.filter?.(B=>B.id!==b)||[]}};await N(F)},Z=async g=>{const S=n(v)().get(g);!S||!S.data||(k(g),await So(n(s),Ze,g),i.postMessage({type:"deleteNote",data:{id:g}}))},X=async()=>{await Ha(n(s),Ze),await Ha(n(s),jt),y(),i.postMessage({type:"clearNotes"})},V=g=>n(v)().get(g),ge=async(g,b)=>{const E=n(v)().get(g);if(!E||!E.data)return;const F={id:g,data:{...E.data,pinned:b}};N(F)},he=async g=>{const S=n(v)().get(g);if(!S||!S.data)return;const E={id:g,data:{...S.data,deletedAt:Date.now()}};await N(E)},$=async g=>{const S=n(v)().get(g);if(!S||!S.data)return;const E={id:g,data:{...S.data,archivedAt:Date.now()}};await N(E)},j=async({noteIds:g})=>{const b=n(v)(),S=n(c)();for(const F of g){const B=b.get(F);B?.data&&(B.data.deletedAt=Date.now())}return await _t(n(s),Ze,g.map(F=>{const B=b.get(F);return{id:F,data:B?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S),{cancel:async()=>{for(const F of g){const B=b.get(F);B?.data&&(B.data.deletedAt=0)}await _t(n(s),Ze,g.map(F=>{const B=b.get(F);return{id:F,data:B?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S)}}},G=async({noteIds:g})=>{const b=n(v)(),S=n(c)();for(const F of g){const B=b.get(F);B?.data&&(B.data.archivedAt=Date.now())}return await _t(n(s),Ze,g.map(F=>{const B=b.get(F);return{id:F,data:B?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S),{cancel:async()=>{for(const F of g){const B=b.get(F);B?.data&&(B.data.archivedAt=0)}await _t(n(s),Ze,g.map(F=>{const B=b.get(F);return{id:F,data:B?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S)}}},ne=async({noteIds:g})=>{const b=n(v)(),S=n(c)(),E=[];for(const B of g){const oe=b.get(B);oe?.data&&(E.push({id:B,data:Ct(oe.data)}),oe.data.archivedAt=0)}return await _t(n(s),Ze,g.map(B=>{const oe=b.get(B);return{id:B,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S),{cancel:async()=>{for(const B of E){const oe=b.get(B.id);oe?.data&&(oe.data=B.data)}await _t(n(s),Ze,g.map(B=>{const oe=b.get(B);return{id:B,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S)}}},ae=async({noteIds:g})=>{const b=n(v)(),S=n(c)(),E=[];for(const B of g){const oe=b.get(B);oe?.data&&(E.push({id:B,data:Ct(oe.data)}),oe.data.deletedAt=0)}return await _t(n(s),Ze,g.map(B=>{const oe=b.get(B);return{id:B,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S),{cancel:async()=>{for(const B of E){const oe=b.get(B.id);oe?.data&&(oe.data=B.data)}await _t(n(s),Ze,g.map(B=>{const oe=b.get(B);return{id:B,data:oe?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>b),f(c,()=>S)}}},ee=async g=>{const S=n(v)().get(g);if(!S||!S.data)return;const E={id:g,data:{...S.data,deletedAt:0}};await N(E)},pe=async g=>{const S=n(v)().get(g);if(!S||!S.data)return;const E={id:g,data:{...S.data,archivedAt:0}};await N(E)},ce=async(g,b)=>{const S=n(u)();S.set(g,{name:g,pinned:b}),await pn(n(s),jt,g,{pinned:b}),i.postMessage({type:"pinTag",data:{tag:g,pinned:b}}),f(u,()=>S)},te=async({noteIds:g})=>{const b=n(u)(),S=n(c)();O(g),await lr(n(s),Ze,g),i.postMessage({type:"reloadNotes"}),f(c,()=>S),f(u,()=>b)},Q=async g=>{const b=n(v)(),S={};g.forEach(E=>{const F=b.get(E.id),B=[];if(F&&F.data){let oe=0,ke=0;for(;oe<E.data.history.length&&ke<F.data.history.length;){const ie=E.data.history[oe],q=F.data.history[ke];ie.id===q.id?(ie.updatedAt>q.updatedAt?B.push(ie):B.push(q),oe+=1,ke+=1):ie.updatedAt<q.updatedAt?(B.push(ie),oe+=1):ie.updatedAt>q.updatedAt?(B.push(q),ke+=1):(B.push(q),oe+=1,ke+=1)}F.data.updatedAt>E.data.updatedAt?S[F.id]={id:F.id,data:{...F.data,history:B}}:S[E.id]={id:E.id,data:{...E.data,history:B}}}else S[E.id]=E}),await _t(n(s),Ze,Object.values(S)),await W(),i.postMessage({type:"reloadNotes"})},re=async()=>{const g=[];n(c)().forEach(S=>{S&&S.data&&S.data.deletedAt&&g.push(S.id)}),await lr(n(s),Ze,g),await W(),i.postMessage({type:"emptyBin"})},be=async(g,b)=>{const S=n(v)(),E=n(c)(),F=[],B=[];for(const ke of b){const ie=S.get(ke);ie?.data&&(F.push({id:ke,data:Ct(ie.data)}),B.push({id:ke,data:{...ie.data,tags:ie.data.tags.filter(q=>q!==g),history:[...ie.data.history||[],{id:Kn(),link:Ct(ie.data.link),text:ie.data.text,tags:ie.data.tags,updatedAt:Date.now()}]}}))}for(const ke of B){const ie=S.get(ke.id);ie?.data&&(ie.data=ke.data)}return await _t(n(s),Ze,B.map(ke=>({id:ke.id,data:ke.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>E),{cancel:async()=>{for(const ke of F){const ie=S.get(ke.id);ie?.data&&(ie.data=ke.data)}await _t(n(s),Ze,F.map(ke=>({id:ke.id,data:ke.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>E)}}},Se=async(g,b,S)=>{const E=n(v)(),F=n(c)(),B=n(u)(),oe=[],ke=[];for(const Y of S){const se=E.get(Y);se?.data&&(oe.push({id:Y,data:Ct(se.data)}),ke.push({id:Y,data:{...se.data,tags:se.data.tags.map(_e=>_e!==g?_e:b),history:[...se.data.history||[],{id:Kn(),link:Ct(se.data.link),text:se.data.text,tags:se.data.tags,updatedAt:Date.now()}]}}))}for(const Y of ke){const se=E.get(Y.id);se?.data&&(se.data=Y.data)}const ie=B.has(b);return await Promise.all([(async()=>{if(!ie){const Y=B.get(g)?.pinned||!1;B.set(b,{name:b,pinned:Y}),await pn(n(s),jt,b,{pinned:Y})}})(),_t(n(s),Ze,ke.map(Y=>({id:Y.id,data:Y.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>F),f(u,()=>B),{cancel:async()=>{for(const Y of oe){const se=E.get(Y.id);se?.data&&(se.data=Y.data)}await Promise.all([(async()=>{ie||(B.delete(b),await So(n(s),jt,b))})(),_t(n(s),Ze,oe.map(Y=>({id:Y.id,data:Y.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>F),f(u,()=>B)}}},Te=async(g,b)=>{const S=n(v)(),E=n(c)(),F=n(u)(),B=[],oe=[];for(const q of b){const Y=S.get(q);Y?.data&&(B.push({id:q,data:Ct(Y.data)}),oe.push({id:q,data:{...Y.data,tags:[...new Set([...Y.data.tags,g])],history:[...Y.data.history||[],{id:Kn(),link:Ct(Y.data.link),text:Y.data.text,tags:Y.data.tags,updatedAt:Date.now()}]}}))}for(const q of oe){const Y=S.get(q.id);Y?.data&&(Y.data=q.data)}const ke=F.has(g);return await Promise.all([(async()=>{ke||(F.set(g,{name:g,pinned:!1}),await pn(n(s),jt,g,{pinned:!1}))})(),_t(n(s),Ze,oe.map(q=>({id:q.id,data:q.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>E),f(u,()=>F),{cancel:async()=>{for(const q of B){const Y=S.get(q.id);Y?.data&&(Y.data=q.data)}await Promise.all([(async()=>{ke||(F.delete(g),await So(n(s),jt,g))})(),_t(n(s),Ze,B.map(q=>({id:q.id,data:q.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(c,()=>E),f(u,()=>F)}}},Ie=async(g,b,S)=>{const E=n(v)(),F=n(c)(),B=n(u)(),oe=[],ke=[];for(const se of S){const _e=E.get(se);_e?.data&&(oe.push({id:se,data:Ct(_e.data)}),ke.push({id:se,data:{..._e.data,tags:[...new Set([..._e.data.tags.filter(Ve=>!g.includes(Ve)),...b])],history:[..._e.data.history||[],{id:Kn(),link:Ct(_e.data.link),text:_e.data.text,tags:_e.data.tags,updatedAt:Date.now()}]}}))}for(const se of ke){const _e=E.get(se.id);_e?.data&&(_e.data=se.data)}const ie=n(u)(),q=b.filter(se=>!ie.has(se));return await Promise.all([(async()=>{if(q.length>0)return _t(n(s),jt,q.map(se=>({id:se,data:{pinned:!1}})))})(),_t(n(s),Ze,ke.map(se=>({id:se.id,data:se.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>F),f(u,()=>B),{cancel:async()=>{for(const se of oe){const _e=E.get(se.id);_e?.data&&(_e.data=se.data)}await Promise.all([(async()=>{if(q.length>0){for(const se of q)B.delete(se);return lr(n(s),jt,q)}})(),_t(n(s),Ze,oe.map(se=>({id:se.id,data:se.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>E),f(c,()=>F),f(u,()=>B)}}},Oe=async g=>{const b=JSON.parse(g.data),S=b;if(b.tabId&&b.tabId===o){S.type==="exit"&&(y(),await Ha(n(s),Ze),await Ha(n(s),jt));return}if(S.type==="putNote"){const F=S.data.id;if(!F)return;const B=await Xr(n(s),Ze,F);if(!B)return;w({id:F,data:B})}else if(S.type==="deleteNote"){const E=S.data.id;if(!E)return;k(E)}else if(S.type==="pinTag"){const E=S.data.tag,F=S.data.pinned,B=n(u)();B.set(E,{name:E,pinned:F}),f(u,()=>B)}else S.type==="clearNotes"?y():S.type==="reloadNotes"||S.type==="emptyBin"?W():S.type==="exit"&&y()};we(()=>(W(),i.addEventListener(Oe),()=>{i.removeEventListener(Oe)})),Ad({isInitedNotes:p,createNote:L,updateNote:J,deleteNote:Z,saveNote:U,revertNote:K,pinNote:ge,moveNoteToBin:he,moveNoteToArchive:$,getGetNotes:T,importNotes:Q,clearNotes:X,getNoteById:V,getGetMapTags:()=>n(u),pinTag:ce,restoreNoteFromBin:ee,moveNoteFromArchive:pe,checkNotes:m,checkNotesInBin:_,checkNotesInArchive:x,emptyBin:re,moveNotesToBin:j,moveNotesToArchive:G,moveNotesFromArchive:ne,deleteNotes:te,restoreNotesFromBin:ae,deleteTag:be,renameTag:Se,addTag:Te,changeTags:Ie});var Ee=de(),le=M(Ee);De(le,()=>e.children??Ye),h(t,Ee),ve()}const $i={};function Id(t){ft($i,t)}function Ma(){const t=ut($i);if(!t)throw new Error("No FeedContext found");return t}const el={};var Qe=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(Qe||{});function Ld(t){ft(el,t)}function vo(){const t=ut(el);if(!t)throw new Error("No SelectedMetaTagsContext found");return t}function Rd(t,e){fe(e,!0);const a=rs(),{getSelectedTags:r}=jn(),{getSelectedMetaTags:o}=vo(),{getGetNotes:s}=zt();let i=A(r),l=A(o),d=I(0),u=[],c=I(0),v=A(()=>n(l).has(Qe.ARCHIVED)),p=A(()=>n(l).has(Qe.BIN));ze(()=>{const x=s()()||[],w=[],k=Array.from(n(i).values());for(let O=x.length-1;O>=0;O--){if(!x[O]||!x[O].data)continue;const y=x[O];if(!n(v)&&!n(p)&&(y?.data.deletedAt||y?.data.archivedAt)||n(v)&&(y?.data.deletedAt||!y?.data.archivedAt)||n(p)&&!y?.data.deletedAt)continue;const T=a?.getFeedSearch().toLowerCase()||"";if(!(a&&!(y.data.link?.title.toLowerCase().includes(T)||y.data.link?.url.toLowerCase().includes(T)||y.data.text.toLowerCase().includes(T)||y.data.tags.map(R=>R.toLowerCase()).join(" ").includes(T)))){if(n(l).has(Qe.INBOX)){if(y.data.tags.length>0)continue}else if(n(i).size&&k.some(R=>!y.data.tags.includes(R)))continue;w.push(y)}}f(d,w.length,!0),u=w,f(c,Date.now(),!0)}),Id({getFiltredNotesLength:()=>n(d),getFiltredNotes:()=>(n(c),u),getUpdatedFiltredNotesTimestamp:()=>n(c)});var m=de(),_=M(m);De(_,()=>e.children??Ye),h(t,m),ve()}function Od(t,e){fe(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=qt(),s=A(a),i="selectedMetaTags";let l=A(()=>n(s).get(i)||""),d=A(()=>new Set(n(l).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!=="")));Ld({getSelectedMetaTags:()=>n(d),addMetaTag:w=>{n(d).has(w)||r(i,[...n(d),w].map(k=>encodeURIComponent(k)).join(","))},removeMetaTag:w=>{n(d).has(w)&&n(d).size===1?o(i):n(d).has(w)&&r(i,[...n(d)].filter(k=>k!==w).map(k=>encodeURIComponent(k)).join(","))},clearSelectedMetaTags:()=>{o(i)},setSelectedMetaTags:w=>{w.size===0?o(i):r(i,[...w].map(k=>encodeURIComponent(k)).join(","))}});var _=de(),x=M(_);De(x,()=>e.children??Ye),h(t,_),ve()}const tl={},ra=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function Fd(t){ft(tl,t)}function Hn(){const t=ut(tl);if(!t)throw new Error("No AnimationSettingsContext found");return t}function zd(t,e){fe(e,!0);let a=dt(ra());Fd(a);var r=de(),o=M(r);De(o,()=>e.children??Ye),h(t,r),ve()}const nl={};function Bd(t){ft(nl,t)}function is(){const t=ut(nl);if(!t)throw new Error("No ScrollingContext found");return t}function jd(t,e){fe(e,!0);let a=I(!1);const r=()=>n(a),o=Qi(()=>{f(a,!1)},100);Bd({isScrolling:r,enable:()=>{f(a,!0),o()}});var i=de(),l=M(i);De(l,()=>e.children??Ye),h(t,i),ve()}const al={};function Hd(t){ft(al,t)}function Da(){const t=ut(al);if(!t)throw new Error("No MobileSizeContext found");return t}function Ud(t,e){fe(e,!0);const a=()=>window.matchMedia("(max-width: 767px)").matches;let r=I(dt(a())),o=Hn();const s=Qi(()=>{o.working=!0},16),i=()=>{o.working=!1,s(),requestAnimationFrame(()=>{f(r,a(),!0)})};Hd({checkMobileSize:()=>n(r)}),we(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)));var d=de(),u=M(d);De(u,()=>e.children??Ye),h(t,d),ve()}const rl={};function Wd(t){ft(rl,t)}function Zt(){const t=ut(rl);if(!t)throw new Error("No DialogContext found");return t}function Vd(t,e){fe(e,!0);let a=I(0),r=I(!1),o=I(!0),s=I(!1),i=I(!1);Wd({checkExistedDialog:()=>n(a)>0,dialogInc:()=>{f(a,n(a)+1)},dialogDec:()=>{f(a,n(a)-1)},blockDialog:R=>{f(r,R,!0)},checkBlockedDialog:()=>n(r),setClosableDialog:R=>{f(o,R,!0)},checkClosableDialog:()=>n(o),checkLeftStart:()=>n(s),checkLeftEnd:()=>n(i),setLeftStart:R=>{f(s,R,!0)},setLeftEnd:R=>{f(i,R,!0)},getCountDialog:()=>n(a)});var y=de(),T=M(y);De(T,()=>e.children??Ye),h(t,y),ve()}const ol={};function qd(t){ft(ol,t)}function go(){const t=ut(ol);if(!t)throw new Error("No ScrollContainerContext found");return t}function Kd(t,e){fe(e,!0);let a=I(null);qd({setScrollContainer:l=>{f(a,l,!0)},getScrollContainer:()=>n(a)});var s=de(),i=M(s);De(i,()=>e.children??Ye),h(t,s),ve()}const sl={};function Yd(t){ft(sl,t)}function ls(){const t=ut(sl);if(!t)throw new Error("No DialogPageHeightContext found");return t}function Gd(t,e){fe(e,!0);let a=I(200);Yd({setDialogPageHeight:l=>{f(a,l,!0)},getDialogPageHeight:()=>n(a)});var s=de(),i=M(s);De(i,()=>e.children??Ye),h(t,s),ve()}const Xd=[fr,qn,Ze,jt,xd];function Jd(){return new Promise((t,e)=>{const a=indexedDB.open(Cd,kd);xt(a,"upgradeneeded",()=>{const r=a.result;for(const o of Xd)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),xt(a,ca,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),xt(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),xt(a,Fn,()=>{e(),console.error(Fn,a.error)})})}function Zd(t,e){fe(e,!0);let a=I(null);we(()=>{Jd().then(l=>{f(a,l,!0)}).catch(l=>{console.error("Failed to initialize LocalDB:",l)})}),yd({getDB:()=>n(a)});var o=de(),s=M(o);{var i=l=>{var d=de(),u=M(d);De(u,()=>e.children??Ye),h(l,d)};H(s,l=>{n(a)&&l(i)})}h(t,o),ve()}function Qd(t,e){fe(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=qt(),s=A(a);let i=A(()=>n(s).get(en)||""),l=A(()=>n(i).split(",").map(y=>decodeURIComponent(y)).filter(y=>y!==""));const d=()=>n(l),u=y=>{if(y.length===0){o(en);return}r(en,y.map(T=>encodeURIComponent(T)).join(","))},c=y=>{r(en,[...n(l),y].map(T=>encodeURIComponent(T)).join(","))};Td({setDialogPages:u,getDialogPages:d,pushDialogPage:c,popDialogPage:()=>{const y=n(l)[n(l).length-1];return n(l).length<=1?(o(en),y):(r(en,n(l).slice(0,-1).map(T=>encodeURIComponent(T)).join(",")),y)},replaceDialogPage:y=>{r(en,[...n(l).slice(0,-1),y].map(T=>encodeURIComponent(T)).join(","))},hasDialogPage:y=>n(l).find(T=>{const[R]=T.split("?");return R===y})!==void 0,clearDialogPages:()=>{o(en)},createDialogPageHref:y=>{const T=new URLSearchParams(n(s).toString());return T.set(en,[...d(),y].map(R=>encodeURIComponent(R)).join(",")),`${window.location.pathname}?${T.toString()}`},createHandleClickDialogPage:y=>T=>{T.preventDefault(),c(y)}});var k=de(),O=M(k);De(O,()=>e.children??Ye),h(t,k),ve()}function $d(t,e){fe(e,!0);let a=I(dt(new URLSearchParams(window.location.search)));const r=v=>{const p=window.location.pathname;f(a,v,!0),window.history.replaceState(null,"",`${p}${v.size>0?`?${v.toString()}`:""}`)};od({getSearchParams:()=>n(a),replaceSearchParams:v=>{const p=new URLSearchParams(v);r(p)},setSearchParam:(v,p)=>{const m=new URLSearchParams(n(a));m.set(v,p),r(m)},deleteSearchParam:v=>{const p=new URLSearchParams(n(a));p.delete(v),r(p)},getHref:v=>{const p=new URLSearchParams(v);return`${window.location.pathname}${p.toString().length>0?`?${p.toString()}`:""}`},clearSearchParams:()=>{r(new URLSearchParams)}});var u=de(),c=M(u);De(c,()=>e.children??Ye),h(t,u),ve()}const il={};function eu(t){ft(il,t)}function tu(){const t=ut(il);if(!t)throw new Error("No KeyboardVisibleContext found");return t}function nu(t,e){fe(e,!0);let a=dt({value:!1});const r=()=>a.value,o=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";we(()=>{const l=()=>{setTimeout(()=>{o()?a.value=!0:a.value=!1},0)};l(),document.addEventListener("focusin",l),document.addEventListener("focusout",l);let d=null;const u=c=>{o()&&(d&&clearTimeout(d),d=setTimeout(()=>{o()&&c.target!==document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement?.blur?.()},120))};return document.addEventListener("touchstart",u,{passive:!0}),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",l),document.removeEventListener("touchstart",u)}}),eu({getIsKeyboardVisible:r});var s=de(),i=M(s);De(i,()=>e.children??Ye),h(t,s),ve()}function au(t,e){fe(e,!0);const a=crypto.randomUUID(),r=(i,l)=>{i.postMessage(JSON.stringify({...l,tabId:a}))};Sd({tabId:a,createBroadcastChannel:()=>{const i=new BroadcastChannel("app");return{postMessage:l=>r(i,l),addEventListener:l=>{i.addEventListener("message",l)},removeEventListener:l=>{i.removeEventListener("message",l)}}}});var o=de(),s=M(o);De(s,()=>e.children??Ye),h(t,o),ve()}function ru(t,e){Zd(t,{children:(a,r)=>{au(a,{children:(o,s)=>{zd(o,{children:(i,l)=>{jd(i,{children:(d,u)=>{Ud(d,{children:(c,v)=>{Vd(c,{children:(p,m)=>{Kd(p,{children:(_,x)=>{Gd(_,{children:(w,k)=>{nu(w,{children:(O,y)=>{$d(O,{children:(T,R)=>{Qd(T,{children:(W,N)=>{var L=de(),J=M(L);De(J,()=>e.children??Ye),h(W,L)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function ou(t,e){ru(t,{children:(a,r)=>{cd(a,{children:(o,s)=>{sd(o,{children:(i,l)=>{ud(i,{children:(d,u)=>{vd(d,{children:(c,v)=>{Od(c,{children:(p,m)=>{hd(p,{children:(_,x)=>{wd(_,{children:(w,k)=>{Ed(w,{children:(O,y)=>{Nd(O,{children:(T,R)=>{Dd(T,{children:(W,N)=>{Rd(W,{children:(L,J)=>{var U=de(),K=M(U);De(K,()=>e.children??Ye),h(L,U)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}const su=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),wt=t=>{const e=su(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let Mt=I(""),Wn=I(null),Ua=I(null),xn=I(null),Vn=I(dt([])),zr=I(null),Yn=null;function ct(t,e){f(Mt,""),Yn=null,f(Ua,null),f(xn,null),setTimeout(()=>{f(Mt,t,!0),e?.onFinish&&f(Ua,e.onFinish,!0),e?.cancel&&(f(xn,e.cancel.onCancel,!0),Yn=e.cancel.nextFocusRef)},16)}var iu=P('<button type="button" class="c p-1meeyyv">undo</button>'),lu=P('<div class="a p-1meeyyv"><div class="b p-1meeyyv"><span> </span> <!></div></div>'),cu=P("<div><!></div>");function cs(t,e){fe(e,!0);const a=Kn();we(()=>(f(Vn,[...n(Vn),a],!0),()=>{const d=n(Vn).indexOf(a);d!==-1&&f(Vn,n(Vn).filter((u,c)=>c!==d),!0)}));const r=d=>{if(d.key==="Tab"&&d.shiftKey){if(Yn&&n(Mt)){d.preventDefault();const{prev:u}=wt(Yn);u?.focus(),f(Mt,"")}}else if(d.key==="Tab"&&!d.shiftKey)Yn&&n(Mt)&&(d.preventDefault(),f(Mt,""),Yn?.focus());else if(d.key==="Escape"&&n(Mt)){if(d.preventDefault(),Yn){const{prev:u}=wt(Yn);u?.focus()}f(Mt,"")}};we(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)})),ze(()=>{n(Mt);const d=n(xn)?2e3:800;n(Mt)&&(n(Wn)?.getBoundingClientRect(),n(Wn)?.style.setProperty("opacity","1"));const u=setTimeout(()=>{n(Wn)?.style.removeProperty("opacity")},d),c=setTimeout(()=>{f(Mt,""),n(Ua)&&n(Ua)(),f(Ua,null),f(xn,null),n(Wn)?.style.removeProperty("opacity")},d+400);return()=>{clearTimeout(u),clearTimeout(c)}});const o=d=>{d.preventDefault(),n(xn)&&(f(Ua,null),n(xn)(),f(xn,null)),f(Mt,""),n(Wn)?.style.removeProperty("opacity")};ze(()=>{n(Mt)&&n(xn)&&n(zr)&&setTimeout(()=>{n(zr)?.focus()},151)}),ze(()=>{n(Vn),Ft(()=>{f(Mt,""),n(Wn)?.style.removeProperty("opacity")})});var s=cu(),i=C(s);{var l=d=>{var u=lu(),c=C(u),v=C(c),p=C(v),m=D(v,2);{var _=x=>{var w=iu();w.__click=o,Je(w,k=>f(zr,k),()=>n(zr)),h(x,w)};H(m,x=>{n(xn)&&x(_)})}Je(c,x=>f(Wn,x),()=>n(Wn)),Ce(()=>it(p,n(Mt))),h(d,u)};H(i,d=>{n(Mt)&&n(Vn)[n(Vn).length-1]===a&&d(l)})}h(t,s),ve()}vt(["click"]);var du=P('<span class="a p-lxk90o"><!></span>');function pt(t,e){var a=du(),r=C(a);De(r,()=>e.children),h(t,a)}var uu=zc('<svg class="p-1yv1ibq"><use></use></svg>');function me(t,e){let a=Pe(e,"name",8,"");var r=uu(),o=C(r);Ce(()=>at(o,"href",`#icon-${a()??""}`)),h(t,r)}var fu=P('<button class="a p-1ovuewe"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function ll(t,e){fe(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Mr(),{getDialogPages:s}=Jt(),{checkExistedDialog:i}=Zt();let l=A(()=>s().length>0||i());const d=p=>{if(p.preventDefault(),n(l))return;const m=r();m==="closed"?a():m==="opened"&&o()};var u=fu();u.__click=d;var c=C(u);ue(c,()=>({"--size":"32px"})),me(c.lastChild,{name:"sidebarMenu"});var v=D(c,2);pt(v,{children:(p,m)=>{var _=Le("Menu");h(p,_)}}),h(t,u),ve()}vt(["click"]);var vu=P('<button class="b p-1q8tydu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),gu=P('<div class="a p-1q8tydu"><input class="p-1q8tydu"/> <!></div>');function zo(t,e){fe(e,!0);let a=Pe(e,"value",15,""),r=Pe(e,"ref",15,null);const o=u=>{u.key==="Escape"&&r()&&(e.onEscape?.(),r().blur())};we(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=gu(),i=C(s);i.__input=u=>e.onChange?.(u.target?.value||""),Je(i,u=>r(u),()=>r());var l=D(i,2);{var d=u=>{var c=vu();c.__click=()=>{a(""),e.onChange?.("")};var v=C(c);ue(v,()=>({"--size":"20px"})),me(v.lastChild,{name:"close"});var p=D(v,2);pt(p,{children:(m,_)=>{var x=Le("Clear");h(m,x)}}),h(u,c)};H(l,u=>{a()&&u(d)})}Ce(()=>at(i,"placeholder",e.placeholder)),ln("focus",i,function(...u){e.onFocus?.apply(this,u)}),ln("blur",i,function(...u){e.onBlur?.apply(this,u)}),Ri(i,a),h(t,s),ve()}vt(["input","click"]);function ds(t,e){fe(e,!0),we(()=>{const a=r=>{r.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==r.target&&!e.dialogInner.contains(r.target)&&e.onClose()};return document.addEventListener("click",a,{capture:!0}),()=>{document.removeEventListener("click",a,{capture:!0})}}),ve()}function hu(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const ia=hu(),pu=()=>{const t=navigator.userAgent;return/android/i.test(t)},Ea=pu(),Eh=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},Ph=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},br=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))};let Ba=I(dt([]));var mu=P("<dialog><div><!></div></dialog> <!>",1);function Dr(t,e){fe(e,!0);const a=Kn(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;we(()=>(f(Ba,[...n(Ba),a],!0),()=>{const y=n(Ba).indexOf(a);y!==-1&&f(Ba,n(Ba).filter((T,R)=>R!==y),!0)}));let o=Pe(e,"onClosed",3,()=>{}),s=Pe(e,"blocked",3,!1),i=I(null),l=I(null),d=I(!1),{dialogInc:u,dialogDec:c}=Zt();const v=()=>{const y=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(y),o()()},{once:!0}),f(d,!1)};ze(()=>{e.startClose&&v()}),we(()=>{n(i)?.showModal(),n(i)?.getClientRects(),f(d,!0);const y=T=>{T?.preventDefault(),s()||v()};return n(i)?.addEventListener("cancel",y),n(i)?.addEventListener("close",y),()=>{n(i)?.removeEventListener("cancel",y),n(i)?.removeEventListener("close",y)}}),we(()=>(u(),()=>{c()})),we(()=>{const y=T=>{T.key==="Escape"&&s()&&T.preventDefault()};return window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}});function p(){setTimeout(()=>{if(ia||!n(i)||!n(l))return;const y=window.visualViewport;if(y)if(y.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},0)}we(()=>(p(),window.visualViewport?.addEventListener("resize",p),window.visualViewport?.addEventListener("scroll",p),document.addEventListener("focusin",p),document.addEventListener("focusout",p),()=>{window.visualViewport?.removeEventListener("resize",p),window.visualViewport?.removeEventListener("scroll",p),document.addEventListener("focusin",p),document.addEventListener("focusout",p)}));var m=mu(),_=M(m),x=C(_),w=C(x);De(w,()=>e.children),Je(x,y=>f(l,y),()=>n(l)),Je(_,y=>f(i,y),()=>n(i));var k=D(_,2);{var O=y=>{ds(y,{get dialog(){return n(i)},get dialogInner(){return n(l)},onClose:v})};H(k,y=>{n(i)&&n(l)&&!s()&&y(O)})}Ce(()=>{tt(_,1,rt({a:!0,b:n(d),c:n(Ba).length>1}),"p-1x14yml"),tt(x,1,rt({d:!0,b:n(d)}),"p-1x14yml")}),h(t,m),ve()}var _u=P("<div><!></div>");function wu(t,e){fe(e,!0);let a=I(!1),r=I(null);const o=()=>{const c=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(c),e.onClosed()},{once:!0}),f(a,!1)},s=c=>{c.target!==n(r)&&!n(r)?.contains(c.target)&&o()},i=c=>{c.target!==n(r)&&!n(r)?.contains(c.target)&&o()},l=c=>{c.key==="Escape"&&o()};we(()=>{n(r)?.getClientRects(),f(a,!0);const c=setTimeout(()=>{document.addEventListener("focusin",s),document.addEventListener("click",i),document.addEventListener("keydown",l)},0);return()=>{clearTimeout(c),document.removeEventListener("focusin",s),document.removeEventListener("click",i),document.removeEventListener("keydown",l)}}),ze(()=>{e.startClose&&o()});var d=_u(),u=C(d);De(u,()=>e.children),Je(d,c=>f(r,c),()=>n(r)),Ce(()=>tt(d,1,rt({a:!0,b:n(a)}),"p-1unpq18")),h(t,d),ve()}var yu=P("<ul><!></ul>"),bu=P("<ul><!></ul>");function Ir(t,e){fe(e,!0);let a=Pe(e,"ref",15);var r=de(),o=M(r);{var s=l=>{Dr(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(d,u)=>{var c=yu(),v=C(c);De(v,()=>e.children),Je(c,p=>a(p),()=>a()),Ce(()=>tt(c,1,rt({a:!0,b:e.isMobile}),"p-1sp2xya")),h(d,c)},$$slots:{default:!0}})},i=l=>{wu(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(d,u)=>{var c=bu(),v=C(c);De(v,()=>e.children),Je(c,p=>a(p),()=>a()),Ce(()=>tt(c,1,rt({a:!0,b:e.isMobile}),"p-1sp2xya")),h(d,c)},$$slots:{default:!0}})};H(o,l=>{e.isMobile?l(s):l(i,!1)})}h(t,r),ve()}var Su=P("<button><!></button>"),Cu=P("<a><!></a>");function qe(t,e){let a=Pe(e,"dangerous",3,!1),r=Pe(e,"type",3,"button"),o=Pe(e,"href",3,"");var s=de(),i=M(s);{var l=u=>{var c=Su();c.__click=function(...p){e.onClick?.apply(this,p)},c.__keydown=function(...p){e.onKeydown?.apply(this,p)};var v=C(c);De(v,()=>e.children??Ye),Ce(()=>tt(c,1,rt({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-14sw3vj")),h(u,c)},d=u=>{var c=Cu();c.__click=function(...p){e.onClick?.apply(this,p)},c.__keydown=function(...p){e.onKeydown?.apply(this,p)};var v=C(c);De(v,()=>e.children??Ye),Ce(()=>{at(c,"href",o()),tt(c,1,rt({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-14sw3vj")}),h(u,c)};H(i,u=>{r()==="button"?u(l):u(d,!1)})}h(t,s)}vt(["click","keydown"]);var ku=P('<li class="p-1i36lz9"><!></li> <li class="p-1i36lz9"><!></li> <li class="p-1i36lz9"><!></li> <li class="p-1i36lz9"><!></li> <li class="p-1i36lz9"><!></li> <li class="p-1i36lz9"><!></li>',1),xu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Tu=P('<div class="a p-1i36lz9"><button><!> <!></button> <!></div>');function Eu(t,e){fe(e,!0);let a=I(!1),r=I(!1);const{getFeedOrder:o,setFeedOrder:s}=ji();let i=ia||Ea,l=A(o);const d=()=>{n(a)||f(a,!0)},u=k=>{f(r,!0),s(k)},c=()=>{f(a,!1),f(r,!1)};we(()=>{const k=O=>{O.key==="Escape"&&f(r,!0)};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)});var v=Tu(),p=C(v);p.__click=d,tt(p,1,rt({b:!0,c:!0}),"p-1i36lz9");var m=C(p);me(m,{name:"filter"});var _=D(m,2);pt(_,{children:(k,O)=>{var y=Le("show feed order menu");h(k,y)}});var x=D(p,2);{var w=k=>{var O=xu(),y=M(O);ue(y,()=>({"--right":"0px","--top":"44px"})),Ir(y.lastChild,{get startClose(){return n(r)},onClosed:c,get isMobile(){return i},children:(T,R)=>{var W=ku(),N=M(W),L=C(N);{let G=A(()=>n(l)==="newest");qe(L,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>u("newest"),children:(ne,ae)=>{var ee=Le("Newest");h(ne,ee)},$$slots:{default:!0}})}var J=D(N,2),U=C(J);{let G=A(()=>n(l)==="oldest");qe(U,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>u("oldest"),children:(ne,ae)=>{var ee=Le("Oldest");h(ne,ee)},$$slots:{default:!0}})}var K=D(J,2),Z=C(K);{let G=A(()=>n(l)==="AtoZ");qe(Z,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>u("AtoZ"),children:(ne,ae)=>{var ee=Le("A to Z");h(ne,ee)},$$slots:{default:!0}})}var X=D(K,2),V=C(X);{let G=A(()=>n(l)==="ZtoA");qe(V,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>u("ZtoA"),children:(ne,ae)=>{var ee=Le("Z to A");h(ne,ee)},$$slots:{default:!0}})}var ge=D(X,2),he=C(ge);{let G=A(()=>n(l)==="updatedNewest");qe(he,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>u("updatedNewest"),children:(ne,ae)=>{var ee=Le("Updated");h(ne,ee)},$$slots:{default:!0}})}var $=D(ge,2),j=C($);{let G=A(()=>n(l)==="updatedOldest");qe(j,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>u("updatedOldest"),children:(ne,ae)=>{var ee=Le("Updated rev");h(ne,ee)},$$slots:{default:!0}})}h(T,W)},$$slots:{default:!0}}),h(k,O)};H(x,k=>{n(a)&&k(w)})}h(t,v),ve()}vt(["click"]);var Pu=P('<div><!> <div class="a p-y3zt6o"></div></div>');function Ia(t,e){fe(e,!0);let a=I(!1);we(()=>{const s=setTimeout(()=>{f(a,!0)},200);return()=>{clearTimeout(s)}});var r=Pu(),o=C(r);De(o,()=>e.children??Ye),Ce(()=>tt(r,1,rt({b:!0,c:n(a)}),"p-y3zt6o")),h(t,r),ve()}var Nu=P("<a><!></a>"),Au=P("<button><!></button>");function It(t,e){let a=Pe(e,"type",3,"standard"),r=Pe(e,"typeButton",3,"button"),o=Pe(e,"element",3,"button"),s=Pe(e,"href",3,""),i=Pe(e,"fullWidth",3,!1),l=Pe(e,"withoutMinWidth",3,!1);var d=de(),u=M(d);{var c=p=>{var m=Nu();m.__click=function(...x){e.onClick?.apply(this,x)};var _=C(m);De(_,()=>e.children??Ye),Ce(()=>{at(m,"target",e.target),at(m,"rel",e.rel),at(m,"href",s()),tt(m,1,rt({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l()}),"p-1ubwcpa")}),h(p,m)},v=p=>{var m=Au();m.__click=function(...x){e.onClick?.apply(this,x)};var _=C(m);De(_,()=>e.children??Ye),Ce(()=>{at(m,"type",r()),tt(m,1,rt({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l()}),"p-1ubwcpa")}),h(p,m)};H(u,p=>{o()==="a"?p(c):p(v,!1)})}h(t,d)}vt(["click"]);let Bo=I(!1),Br=I(!1),jo=I(""),Ho=I("Cancel"),Uo=I("Confirm"),Wo,Vr=I(void 0),Vo,qo=I("dangerous");function Va(t){f(Bo,!0),f(jo,t.title,!0),t.buttonCancelTitle&&f(Ho,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&f(Uo,t.buttonConfirmTitle,!0),Wo=t.onConfirm,f(Vr,t.onCancel,!0),Vo=t.onClosed,t.type?f(qo,t.type,!0):f(qo,"dangerous")}var Mu=P('<span class="b p-1jlul5o"> </span> <div class="c p-1jlul5o"><!> <!></div>',1),Du=P('<div class="a p-1jlul5o"><!></div>');function Iu(t,e){fe(e,!0);let a=I(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{f(a,!0)},250)};we(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(Vr)?.(),f(Br,!0)},l=async()=>{s(),await Wo?.(),f(Br,!0),o=!0},d=()=>{clearTimeout(r),f(a,!1),f(Bo,!1),f(Br,!1),f(jo,""),f(Ho,"Cancel"),f(Uo,"Confirm"),f(Vr,void 0),Wo=void 0,Vo&&Vo(o),o=!1};var u=de(),c=M(u);{var v=p=>{Dr(p,{get blocked(){return n(a)},get startClose(){return n(Br)},onClosed:d,children:(m,_)=>{var x=Du(),w=C(x);{var k=y=>{Ia(y,{})},O=y=>{var T=Mu(),R=M(T),W=C(R),N=D(R,2),L=C(N);{var J=K=>{It(K,{onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Z,X)=>{var V=Le();Ce(()=>it(V,n(Ho))),h(Z,V)},$$slots:{default:!0}})};H(L,K=>{n(Vr)&&K(J)})}var U=D(L,2);It(U,{onClick:l,fullWidth:!0,withoutMinWidth:!0,get type(){return n(qo)},children:(K,Z)=>{var X=Le();Ce(()=>it(X,n(Uo))),h(K,X)},$$slots:{default:!0}}),Ce(()=>it(W,n(jo))),h(y,T)};H(w,y=>{n(a)?y(k):y(O,!1)})}h(m,x)},$$slots:{default:!0}})};H(c,p=>{n(Bo)&&p(v)})}h(t,u),ve()}const Sr=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,l=a.ctrlKey,d=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!l&&!!t.shift==!!d){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var Lu=P('<div class="a p-rp2pt7"><a class="b p-rp2pt7"><span class="c p-rp2pt7"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-rp2pt7"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function Ru(t,e){fe(e,!1);const{createDialogPageHref:a,createHandleClickDialogPage:r,getDialogPages:o,pushDialogPage:s}=Jt(),{checkExistedDialog:i}=Zt(),l=()=>{o.length===0&&!i()&&s(ye.NewNote)};we(()=>Sr({key:"n",action:l})),as();var d=Lu(),u=C(d),c=A(()=>r(ye.NewNote));u.__click=function(...w){n(c)?.apply(this,w)};var v=C(u),p=C(v);ue(p,()=>({"--size":"32px","--color":"#b0b0b0"})),me(p.lastChild,{name:"add"});var m=D(p,2);pt(m,{children:(w,k)=>{var O=Le("Add note");h(w,O)}});var _=D(v,2),x=C(_);ue(x,()=>({"--size":"16px","--color":"#b0b0b0"})),me(x.lastChild,{name:"plus"}),Ce(w=>at(u,"href",w),[()=>a(ye.NewNote)]),h(t,d),ve()}vt(["click"]);var Ou=P("<button><!></button>");function fa(t,e){fe(e,!0);let a=Pe(e,"type",3,"button"),r=!1,o=I(null);ze(()=>{e.onRef&&e.onRef(n(o))});const s=c=>{(c.key==="Enter"||c.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},l=c=>{(c.pointerType==="mouse"&&c.button===0||c.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(c)};var d=Ou();d.__keydown=s,d.__click=i,d.__pointerdown=l,d.__touchstart=function(...c){e.onTouchStart?.apply(this,c)};var u=C(d);De(u,()=>e.children??Ye),Je(d,c=>f(o,c),()=>n(o)),Ce(()=>{at(d,"type",a()),d.disabled=e.disabled,tt(d,1,rt({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty"}),"p-wfgawb")}),h(t,d),ve()}vt(["keydown","click","pointerdown","touchstart"]);var Fu=P('<div class="b p-1pt17hy"> </div>'),zu=P('<div class="a p-1pt17hy"><input/> <!></div>');function Cr(t,e){fe(e,!0);let a=Pe(e,"value",15,""),r=Pe(e,"error",3,""),o=Pe(e,"ref",15,null);var s=zu(),i=C(s);i.__input=function(...c){e.onInput?.apply(this,c)};let l;Je(i,c=>o(c),()=>o());var d=D(i,2);{var u=c=>{var v=Fu(),p=C(v);Ce(()=>it(p,r())),h(c,v)};H(d,c=>{r()&&c(u)})}Ce(()=>{at(i,"placeholder",e.placeholder),l=tt(i,1,"p-1pt17hy",null,l,{error:!!r()})}),ln("blur",i,function(...c){e.onBlur?.apply(this,c)}),ln("focus",i,function(...c){e.onFocus?.apply(this,c)}),Ri(i,a),h(t,s),ve()}vt(["input"]);var Bu=P('<div class="b p-y9ylet"> </div> <!> <div class="c p-y9ylet"><!> <!></div>',1),ju=P('<form class="a p-y9ylet"><!></form>');function Hu(t,e){fe(e,!0);const{renameTag:a}=zt(),{getSelectedTags:r,setSelectedTags:o}=jn(),{getSelectedNotes:s,setSelectedNotes:i,clearNotes:l}=la(),{getFiltredNotes:d}=Ma();let u=I(!1),c=I(!1),v,p=!1,m=I(null),_=I(dt(e.tag)),x=e.nextFocusRef;we(()=>(n(m)&&n(m).focus(),()=>{v&&clearTimeout(v)}));const w=()=>{v=setTimeout(()=>{f(c,!0)},250)},k=()=>{f(u,!0)},O=async()=>{if(n(_).trim()===e.tag){k();return}if(n(_).trim()!=="")try{w();const R=r(),W=[...R].map(K=>K===e.tag?n(_).trim():K),N=new Set(s()),L=d(),J=N.size?[...N]:L.map(K=>K.id),{cancel:U}=await a(e.tag,n(_).trim(),J);l(),o(new Set(W)),ct("Tag renamed",{cancel:{nextFocusRef:x,onCancel:async()=>{await U(),o(R),i(N),setTimeout(()=>{const{prev:K}=wt(x);K?.focus()},16)}}}),p=!0}finally{f(u,!0)}},y=()=>{e.onClosed?.(p)},T=R=>{R.preventDefault(),O()};Dr(t,{get blocked(){return n(c)},get startClose(){return n(u)},onClosed:y,children:(R,W)=>{var N=ju(),L=C(N);{var J=K=>{Ia(K,{})},U=K=>{var Z=Bu(),X=M(Z),V=C(X),ge=D(X,2);Cr(ge,{placeholder:"Enter new tag name",get ref(){return n(m)},set ref(G){f(m,G,!0)},get value(){return n(_)},set value(G){f(_,G,!0)}});var he=D(ge,2),$=C(he);It($,{onClick:k,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(G,ne)=>{var ae=Le("Cancel");h(G,ae)},$$slots:{default:!0}});var j=D($,2);It(j,{onClick:O,fullWidth:!0,withoutMinWidth:!0,children:(G,ne)=>{var ae=Le("OK");h(G,ae)},$$slots:{default:!0}}),Ce(()=>it(V,`Rename "${e.tag??""}" for selected notes`)),h(K,Z)};H(L,K=>{n(c)?K(J):K(U,!1)})}ln("submit",N,T),h(R,N)},$$slots:{default:!0}}),ve()}let Qn=I(!1),va=I(!1),Yt=I(""),ha=I(0),vr=I(0),gr=I(0),qr,Jr=()=>({bottom:0,right:0,height:0}),Qt=I(null),Ko=I(null);function Uu(t){if(n(Qn)){f(va,!0),n(Yt)!==t.tag&&(qr=()=>{const a=t.getRect();f(Qn,!0),f(Yt,t.tag,!0),f(ha,a.bottom,!0),f(vr,a.right,!0),f(gr,a.height,!0),Jr=t.getRect,f(Qt,t.focusRef,!0)});return}const e=t.getRect();f(Qn,!0),f(Yt,t.tag,!0),f(ha,e.bottom,!0),f(vr,e.right,!0),f(gr,e.height,!0),Jr=t.getRect,f(Qt,t.focusRef,!0)}const Wu=()=>n(Qn),Vu=()=>n(Ko);var qu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),Ku=P('<li class="p-16hbyw2"><!></li>'),Yu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),Gu=P('<li class="p-16hbyw2"><!></li>'),Xu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),Ju=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),Zu=P('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),Qu=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),$u=P("<!> <!>",1);function ef(t,e){fe(e,!0);const{getScrollContainer:a}=go(),{pinTag:r,getGetMapTags:o,deleteTag:s}=zt(),{checkMobileSize:i}=Da(),{getSelectedTags:l,removeTag:d,setSelectedTags:u}=jn(),{getSelectedNotes:c,setSelectedNotes:v,clearNotes:p}=la(),{getFiltredNotes:m}=Ma();let _=I(!1);ze(()=>{n(Qn),Ft(()=>{f(_,o()().get(n(Yt))?.pinned||!1,!0)})});let x=I(!1);const w=()=>{r(n(Yt),!0),f(va,!0);let $=n(Qt),j=wt($)?.next;ct("Tag pinned",{cancel:{nextFocusRef:j,onCancel:async()=>{r(n(Yt),!1),setTimeout(()=>{const{prev:G}=wt(j);G?.focus()},16)}}})},k=()=>{r(n(Yt),!1),f(va,!0);let $=n(Qt),j=wt($)?.next;ct("Tag unpinned",{cancel:{nextFocusRef:j,onCancel:async()=>{r(n(Yt),!0),setTimeout(()=>{const{prev:G}=wt(j);G?.focus()},16)}}})},O=()=>{f(Qn,!1),f(va,!1),f(ha,0),f(vr,0),f(gr,0),Jr=()=>({bottom:0,right:0,height:0}),f(Qt,null),qr&&setTimeout(()=>{qr?.(),qr=void 0})};let y=A(()=>window.innerHeight-n(ha)<100?n(ha)-n(gr)-98+"px":n(ha)+5+"px"),T=A(a);const R=$=>{$.key==="Tab"&&$.shiftKey&&($.preventDefault(),n(Qt)?.focus())},W=$=>{$.key==="Tab"&&!$.shiftKey&&n(Qt)&&($.preventDefault(),wt(n(Qt))?.next?.focus())};we(()=>{const $=j=>{j.key==="Escape"&&n(Qn)&&n(Qt)?.focus()};return window.addEventListener("keydown",$),()=>{window.removeEventListener("keydown",$)}});const N=()=>{f(va,!0);let $=n(Qt),j=wt($)?.next;Va({title:`Are you sure to delete "${n(Yt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const G=Array.from(n(U)),ne=new Set(c()),ae=m(),ee=ne.size?[...ne]:ae.map(ce=>ce.id);n(U).has(n(Yt))&&(ne.size===0||ae.length===ne.size)&&d(n(Yt)),p();const{cancel:pe}=await s(n(Yt),ee);ct("Tag deleted",{cancel:{nextFocusRef:j,onCancel:async()=>{await pe(),u(new Set(G)),v(new Set(ne)),setTimeout(()=>{const{prev:ce}=wt(j);ce?.focus()},16)}}})},onCancel:async()=>{},onClosed:G=>{setTimeout(()=>{G||$?.focus()},16)}})};let L=()=>{};const J=()=>{f(va,!0),f(x,!0);let $=n(Qt);L=()=>{f(x,!1),setTimeout(()=>{$?.focus()},16)}};ze(()=>{const $=()=>{const j=Jr();f(ha,j.bottom,!0),f(vr,j.right,!0),f(gr,j.height,!0)};return n(T)?.addEventListener("scroll",$),window.addEventListener("resize",$),()=>{n(T)?.removeEventListener("scroll",$),window.removeEventListener("resize",$)}});let U=A(l),K=A(i);var Z=$u(),X=M(Z);{var V=$=>{var j=Qu(),G=M(j);ue(G,()=>({"--left":n(vr)-36+"px","--top":n(y),"--transform-origin":"top left"})),Ir(G.lastChild,{get startClose(){return n(va)},onClosed:O,get isMobile(){return n(K)},get ref(){return n(Ko)},set ref(ne){f(Ko,ne,!0)},children:(ne,ae)=>{var ee=Zu(),pe=M(ee);{var ce=Te=>{var Ie=Ku(),Oe=C(Ie);qe(Oe,{onClick:w,onKeydown:R,get dialogMode(){return n(K)},children:(Ee,le)=>{var g=qu(),b=M(g);ue(b,()=>({"--size":"20px"})),me(b.lastChild,{name:"pin"}),h(Ee,g)},$$slots:{default:!0}}),h(Te,Ie)},te=Te=>{var Ie=Gu(),Oe=C(Ie);qe(Oe,{onClick:k,onKeydown:R,get dialogMode(){return n(K)},children:(Ee,le)=>{var g=Yu(),b=M(g);ue(b,()=>({"--size":"20px"})),me(b.lastChild,{name:"pin-cancel"}),h(Ee,g)},$$slots:{default:!0}}),h(Te,Ie)};H(pe,Te=>{n(_)?Te(te,!1):Te(ce)})}var Q=D(pe,2),re=C(Q);qe(re,{onClick:J,get dialogMode(){return n(K)},children:(Te,Ie)=>{var Oe=Xu(),Ee=M(Oe);ue(Ee,()=>({"--size":"20px"})),me(Ee.lastChild,{name:"pen"}),h(Te,Oe)},$$slots:{default:!0}});var be=D(Q,2),Se=C(be);qe(Se,{onClick:N,onKeydown:W,dangerous:!0,get dialogMode(){return n(K)},children:(Te,Ie)=>{var Oe=Ju(),Ee=M(Oe);ue(Ee,()=>({"--size":"20px"})),me(Ee.lastChild,{name:"bin"}),h(Te,Oe)},$$slots:{default:!0}}),h(ne,ee)},$$slots:{default:!0}}),h($,j)};H(X,$=>{n(Qn)&&$(V)})}var ge=D(X,2);{var he=$=>{{let j=A(()=>wt(n(Qt))?.next||null);Hu($,{get tag(){return n(Yt)},get nextFocusRef(){return n(j)},onClosed:G=>{L(G)}})}};H(ge,$=>{n(x)&&$(he)})}h(t,Z),ve()}var tf=P('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),nf=P('<button><span class="b p-rl09jd"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),af=P("<!> <span> </span> <!>",1),rf=P('<div class="a p-rl09jd"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function hr(t,e){fe(e,!0);let{getGetMapTags:a}=zt(),r=I(null),o=A(Wu);const s=()=>{if(n(r)){const v=n(r).getBoundingClientRect();return{bottom:v.bottom,right:v.right,height:v.height}}return{bottom:0,right:0,height:0}},i=v=>{v.stopPropagation(),v.preventDefault(),Uu({tag:e.tag,getRect:s,focusRef:n(r)})},l=v=>{v.key==="Tab"&&!v.shiftKey&&n(o)&&(v.preventDefault(),Vu()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let d=A(()=>a()().get(e.tag)?.pinned||!1);var u=rf(),c=C(u);ue(c,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),fa(c.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(v,p)=>{var m=af(),_=M(m);{var x=T=>{var R=tf(),W=C(R);ue(W,()=>({"--size":"18px"})),me(W.lastChild,{name:"pin"}),h(T,R)};H(_,T=>{n(d)&&T(x)})}var w=D(_,2),k=C(w),O=D(w,2);{var y=T=>{var R=nf();R.__click=i,R.__keydown=l;var W=C(R),N=C(W);ue(N,()=>({"--size":"16px"})),me(N.lastChild,{name:"menu"});var L=D(N,2);pt(L,{children:(J,U)=>{var K=Le("Tag options");h(J,K)}}),Je(R,J=>f(r,J),()=>n(r)),Ce(()=>tt(R,1,rt({c:!0,d:e.type==="selected"}),"p-rl09jd")),h(T,R)};H(O,T=>{e.hideMenu||T(y)})}Ce(()=>it(k,e.tag)),h(v,m)},$$slots:{default:!0}}),h(t,u),ve()}vt(["click","keydown"]);var of=P('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function Ms(t,e){fe(e,!0);let a=Pe(e,"mobile",3,!1);const{getGetMapTags:r}=zt();let s=A(()=>{const m=r()();return[...e.tags].sort((_,x)=>m.get(_)?.pinned?-1:m.get(x)?.pinned?1:_.localeCompare(x))}),i=A(()=>n(s).filter(m=>r()().get(m)?.pinned)),l=A(()=>n(s).filter(m=>!r()().get(m)?.pinned));var d=of(),u=C(d),c=C(u);Rn(c,16,()=>n(i),m=>m,(m,_)=>{hr(m,{get hideMenu(){return e.hideTagMenu},get tag(){return _},onClick:()=>{e.handleTagClick(_)}})});var v=D(c,2);Rn(v,17,()=>e.metaTags,m=>"meta"+m,(m,_)=>{hr(m,{hideMenu:!0,get tag(){return n(_)},onClick:()=>{e.handleMetaTagClick(n(_))}})});var p=D(v,2);Rn(p,16,()=>n(l),m=>m,(m,_)=>{hr(m,{get hideMenu(){return e.hideTagMenu},get tag(){return _},onClick:()=>{e.handleTagClick(_)}})}),Ce(()=>tt(u,1,rt({b:!0,c:a()}),"p-lawyrs")),h(t,d),ve()}var sf=P('<div class="b c p-jd598i"><div class="d p-jd598i"><button class="e p-jd598i"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),lf=P('<div class="a p-jd598i"><!></div>');function Ds(t,e){fe(e,!0);let a=I(null);const r=d=>{f(a,d,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};ze(()=>{n(a)&&n(a).focus()});var s=lf(),i=C(s);{var l=d=>{var u=sf(),c=C(u),v=C(c);v.__click=o;var p=C(v);ue(p,()=>({"--size":"20px"})),me(p.lastChild,{name:"close"});var m=D(p,2);pt(m,{children:(w,k)=>{var O=Le("Clear");h(w,O)}});var _=D(c,2);Rn(_,19,()=>e.metaTags,w=>"meta_"+w,(w,k,O)=>{{let y=A(()=>n(O)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);hr(w,{hideMenu:!0,type:"selected",get tag(){return n(k)},onClick:()=>{e.handleMetaTagClick(n(k))},get onRef(){return n(y)}})}});var x=D(_,2);Rn(x,18,()=>e.selectedTags,w=>w,(w,k,O)=>{{let y=A(()=>n(O)===e.selectedTags.size-1?r:void 0);hr(w,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return k},onClick:()=>{e.handleSelectedTagClick(k)},get onRef(){return n(y)}})}}),h(d,u)};H(i,d=>{e.selectedTags.size+e.metaTags.size>0&&d(l)})}h(t,s),ve()}vt(["click"]);const Yo=(t,e,a,r)=>{if(t.has(Qe.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const l of i?.data?.tags||[])o.includes(l)||o.push(l);continue}if(i.data&&s.every(l=>i.data?.tags.includes(l)))for(const l of i.data.tags||[])!e.has(l)&&!o.includes(l)&&o.push(l)}return o},On=200,cf=t=>t<.5?2*t*t:-1+(4-2*t)*t,cl=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,cf(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},df=t=>{const{getIsKeyboardVisible:a}=tu();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},l=v=>({x:v.clientX,y:v.clientY,time:performance.now()}),d=v=>{r=[l(v.touches[0])],o=!0},u=v=>{if(!o||s)return;r.push(l(v.touches[0]));const p=performance.now()-150;r=r.filter(N=>N.time>=p);const m=r.at(-1),_=r[0];if(!m||!_)return;const x=_.x,w=_.y,k=m.x,O=m.y,y=k-x,T=O-w,R=Math.abs(y)>Math.abs(T),W=Math.abs(y)>3;R&&W&&!a()&&(s=!0,v.preventDefault(),t([...r]),i())},c=()=>{i()};we(()=>(document.addEventListener("touchstart",d,{passive:!0}),document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",c,{passive:!0}),document.addEventListener("touchcancel",c,{passive:!0}),()=>{document.removeEventListener("touchstart",d),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",c),document.removeEventListener("touchcancel",c)}))},Is=5,Ls=.6,oa=.3;function dl(t,e){fe(e,!0);let a=[],r=0,o=!1,s=0,i=0,l=0,d=0,u=0,c=null,v=null;const p=()=>{a=[],r=0,o=!1,s=0,i=0,l=0,d=0,u=0,c!==null&&(cancelAnimationFrame(c),c=null),v&&(clearTimeout(v),v=null)},m=()=>{e.onCancel(),p()},_=()=>{v&&clearTimeout(v),v=setTimeout(m,5e3)};df(async W=>{if(!o)try{const N=W.at(-1);if(!N)throw new Error("No points available for swipe initialization");const L=await e.onInit();if(!L)return;s=L.initialPosition,i=L.currentPosition,l=L.minPosition,d=L.maxPosition,u=L.width,r=N.x,a=W,o=!0,_()}catch(N){console.error("Error during swipe initialization:",N),p()}});const w=W=>Math.max(l,Math.min(d,W)),k=()=>{if(c=null,!o){p();return}const W=a.at(-1),N=a[0];if(!W||!N)return;let L=W.x-r;r=W.x;const J=w(i+L);J!==i&&(i=J,e.onUpdate({initialPosition:s,newPosition:J,width:u,minPosition:l,maxPosition:d}))},O=W=>{if(!o){p();return}a.push({x:W.touches[0].clientX,y:W.touches[0].clientY,time:performance.now()});const N=performance.now()-150;a=a.filter(K=>K.time>=N),c===null&&(c=requestAnimationFrame(k)),_();const L=W.touches[0].clientX-a[0].x,J=W.touches[0].clientY-a[0].y;Math.abs(L)>Math.abs(J)&&W.cancelable&&W.preventDefault()},y=W=>{const N=Math.abs(W);if(N>=Ls)return Is;if(N>=oa){const L=(N-oa)/(Ls-oa);return e.baseActionThreshold-L*(e.baseActionThreshold-Is)}else return e.baseActionThreshold},T=W=>{if(!o){p();return}let N=0;a.push({x:W.changedTouches[0].clientX,y:W.changedTouches[0].clientY,time:performance.now()}),k(),c!==null&&(cancelAnimationFrame(c),c=null);const L=a[0],J=a[a.length-1],U=J.x-L.x,K=J.time-L.time;K>0&&(N=U/K);const Z=y(N);e.onFinish({swipeVelocity:N,currentPosition:i,minPosition:l,maxPosition:d,initialPosition:s,width:u,actionThreshold:Z}),p()},R=()=>{m()};we(()=>(document.addEventListener("touchmove",O,{passive:!1}),document.addEventListener("touchend",T,{passive:!0}),document.addEventListener("touchcancel",R,{passive:!0}),()=>{document.removeEventListener("touchmove",O),document.removeEventListener("touchend",T),document.removeEventListener("touchcancel",R),c!==null&&cancelAnimationFrame(c),v&&clearTimeout(v)})),ve()}function uf(t,e){fe(e,!0);const a=Hn();let r=Pe(e,"animationRef",7),o=Pe(e,"dialog",7);dl(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const u=-e.dialogWidth*.7,c=0;let v=e.sidebarState==="closed"?u:c,p=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let x=()=>1;if(r().current){r().current.pause();let w=Number(r().current.currentTime);br()&&(w=Number(w)+50,r().current.currentTime=Math.min(Math.max(On-1,w),w));const k=r().current.effect?.getComputedTiming().progress||0;x=()=>k,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(w=>requestAnimationFrame(w)),p=Math.abs(1-x())}p=e.sidebarState==="closed"?p:1-p,o().style.setProperty("--backdrop-bg",`${p*.1}`),o()&&!o().open&&(o().showModal(),br()&&o().getBoundingClientRect()),a.isSwiping=!0,a.duration=0,a.swipingRatio=p*-25;const m=p*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let _=e.sidebarState==="closed"?u:c;return e.sidebarState==="opened"||e.sidebarState==="closed"||(_=m),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:v,currentPosition:_,minPosition:u,maxPosition:c,width:e.dialogWidth}},onCancel:()=>{a.isSwiping=!1,e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:u,width:c})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const v=1-Math.abs(u/c)/7*10;o().style.transform=`translate3d(${u}px, 0, 0)`,a.swipingRatio=v*-25,o().style.setProperty("--backdrop-bg",`${v*.1}`)},onFinish:({swipeVelocity:u,currentPosition:c,initialPosition:v,width:p,actionThreshold:m})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let _="close";const x=Math.abs(c-v)/p*100/7*10;if(x===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(x===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?_=Math.abs(x)>m||u>oa?"open":"close":e.sidebarState==="swipingClose"&&(_=Math.abs(x)>m&&u<=oa||u<-oa?"close":"open");let w=cl(Math.abs(x)/100);e.sidebarState==="swipingClose"&&_==="close"&&(w=1-w);const k=(_==="open"?1-w:w)*On;a.duration=k/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),o().style.setProperty("--backdrop-bg",`${_==="open"?.1:0}`),_==="open"?e.onOpen():_==="close"&&e.onClose()}}),ve()}var ff=P("<dialog><div><!> <!></div></dialog> <!> <!>",1);function vf(t,e){fe(e,!0);const{getSidebarState:a,setSidebarState:r}=Mr();let o=I(0);we(()=>{const V=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",V),V(),()=>{window.removeEventListener("resize",V)}});const s=Hn(),{isScrolling:i}=is();let l=I(null),d=I(null),u={},c=A(a);const v=()=>{e.blocked||r("closing")},p=V=>{r(V==="open"?"swipingOpen":"swipingClose")},m=()=>{r("opened")},_=()=>{r("preOpening")},x=()=>{n(l)?.close(),r("closed")},w=V=>{V.preventDefault(),v()};we(()=>(n(l)?.addEventListener("close",x),n(l)?.addEventListener("cancel",w),()=>{n(l)?.removeEventListener("close",x),n(l)?.removeEventListener("cancel",w)}));const k=A(i);let O=A(()=>s.working);const y=V=>{V?(r("opened"),s.swipingRatio=-25):(r("closed"),s.swipingRatio=0,n(l)?.close()),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ra().duration};ze(()=>{n(c)==="opening"?Ft(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=-25,n(l).style.removeProperty("--backdrop-bg");const V=n(l).style.transform||"translate3d(-100%, 0, 0)";n(l).style.transform="";const ge=n(l)?.animate([{transform:V},{transform:"translate3d(0, 0, 0)"}],{duration:s.duration*1e3||On,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});u.current=ge,ge&&(ge.onfinish=()=>{m(),s.swipingRatio=-25,n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ra().duration,ge.cancel(),u.current=void 0})})}):n(c)==="closing"&&Ft(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=0,n(l).style.removeProperty("--backdrop-bg");const V=n(l).style.transform||"translate3d(0, 0, 0)";n(l).style.transform="";const ge=n(l)?.animate([{transform:V},{transform:"translate3d(-100%, 0, 0)"}],{duration:s.duration*1e3||On,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});u.current=ge,ge&&(ge.onfinish=()=>{x(),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ra().duration,ge.cancel(),u.current=void 0})})})}),ze(()=>{n(c)==="preOpening"&&(n(l)?.open||(n(l)?.showModal(),br()&&n(l)?.getBoundingClientRect()),r("opening"))}),we(()=>{n(c)==="opened"&&r("preOpening")});var T=ff(),R=M(T),W=C(R),N=C(W);De(N,()=>e.children);var L=D(N,2);{var J=V=>{cs(V,{})};H(L,V=>{n(c)==="opened"&&V(J)})}Je(W,V=>f(d,V),()=>n(d)),Je(R,V=>f(l,V),()=>n(l));var U=D(R,2);{var K=V=>{ds(V,{get dialog(){return n(l)},get dialogInner(){return n(d)},onClose:v})};H(U,V=>{n(d)&&n(c)==="opened"&&!e.blocked&&V(K)})}var Z=D(U,2);{var X=V=>{uf(V,{onCancelSwipe:y,onOpen:_,onClose:v,onSwipe:p,get dialogWidth(){return n(o)},get animationRef(){return u},get dialog(){return n(l)},get sidebarState(){return n(c)}})};H(Z,V=>{!n(k)&&!e.blocked&&V(X)})}Ce(()=>{tt(R,1,rt({a:!0,b:n(O),c:n(c)==="opened"||n(c)==="opening"||n(c)==="closing"||n(c)==="swipingClose",d:n(c)==="opened"||n(c)==="opening"||n(c)==="swipingOpen"}),"p-1gucilc"),tt(W,1,rt({e:!0,f:n(c)==="swipingOpen",g:n(c)!=="opened"}),"p-1gucilc")}),h(t,T),ve()}var gf=P('<div class="a p-1lsyiiu"><div class="b p-1lsyiiu"><!> <div class="c p-1lsyiiu"><a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <div class="e p-1lsyiiu"><!></div> <!></div> <!>',1),hf=P('<div class="f p-1lsyiiu"><div class="e p-1lsyiiu"><!></div> <div class="g p-1lsyiiu"><div class="a p-1lsyiiu"><!></div> <!></div></div>');function pf(t,e){fe(e,!0);const{checkMobileSize:a}=Da(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Mr(),{getDialogPages:i,createDialogPageHref:l,createHandleClickDialogPage:d}=Jt(),{getTagsSearch:u,setTagsSearch:c}=ld(),{getSelectedTags:v,addTag:p,removeTag:m,clearTags:_}=jn(),{getSelectedMetaTags:x,addMetaTag:w,removeMetaTag:k,clearSelectedMetaTags:O}=vo();let y=A(v),T=A(x);const{getGetNotes:R,checkNotesInArchive:W,checkNotesInBin:N}=zt(),L=A(R),J=te=>{p(te)},U=te=>{w(te)},K=te=>{m(te)},Z=te=>{k(te)};let X=A(()=>n(y).size===0&&!n(T).has(Qe.INBOX)&&(n(L)()||[]).some(te=>(!n(T).has(Qe.ARCHIVED)&&!n(T).has(Qe.BIN)&&te?.data&&!te.data.deletedAt&&!te.data.archivedAt||n(T).has(Qe.ARCHIVED)&&te?.data&&!te.data.deletedAt&&te.data.archivedAt||n(T).has(Qe.BIN)&&te?.data&&te.data.deletedAt)&&te?.data?.tags.length===0)),V=A(()=>Yo(n(T),n(y),n(L)()||[],te=>!(te?.data&&(te.data.deletedAt||te.data.archivedAt)&&!n(T).has(Qe.ARCHIVED)&&!n(T).has(Qe.BIN)||te?.data&&(te.data.deletedAt||!te.data.archivedAt)&&n(T).has(Qe.ARCHIVED)||te?.data&&!te.data.deletedAt&&n(T).has(Qe.BIN)))),ge=A(()=>n(V).filter(te=>u()===""||te.toLowerCase().indexOf(u().toLowerCase())!==-1)),he=A(a);const{checkExistedDialog:$}=Zt();let j=A(()=>i().length>0||$());const G=()=>{if(n(he)){if(n(j))return;o()==="opened"?r():o()==="closed"&&s()}};we(()=>Sr({key:"b",meta:!0,action:G})),we(()=>Sr({key:"b",ctrl:!0,action:G}));let ne=A(()=>[...n(X)&&n(T).size===0?[Qe.INBOX]:[],...n(T).size===0?[...W()&&n(y).size===0?[Qe.ARCHIVED]:[],...N()&&n(y).size===0?[Qe.BIN]:[]]:[]].filter(te=>u()===""||te.toLowerCase().indexOf(u().toLowerCase())!==-1).sort((te,Q)=>te===Qe.INBOX?-1:Q===Qe.INBOX?1:te.localeCompare(Q)));var ae=de(),ee=M(ae);{var pe=te=>{vf(te,{get blocked(){return n(j)},children:(Q,re)=>{var be=gf(),Se=M(be),Te=C(Se),Ie=C(Te);ll(Ie,{});var Oe=D(Ie,2),Ee=C(Oe),le=A(()=>d(ye.Settings));Ee.__click=function(...Y){n(le)?.apply(this,Y)};var g=C(Ee);ue(g,()=>({"--size":"24px"})),me(g.lastChild,{name:"settings"});var b=D(g,2);pt(b,{children:(Y,se)=>{var _e=Le("Settings");h(Y,_e)}});var S=D(Ee,2),E=A(()=>d(ye.Sync));S.__click=function(...Y){n(E)?.apply(this,Y)};var F=C(S);ue(F,()=>({"--size":"24px"})),me(F.lastChild,{name:"sync"});var B=D(F,2);pt(B,{children:(Y,se)=>{var _e=Le("Sync");h(Y,_e)}});var oe=D(Te,2),ke=C(oe);{let Y=A(u);zo(ke,{placeholder:"Search tag",get value(){return n(Y)},onChange:se=>{c(se)}})}var ie=D(oe,2);{let Y=A(()=>n(T).has(Qe.BIN));Ds(ie,{get clearTags(){return _},get clearMetaTags(){return O},get hideTagMenu(){return n(Y)},handleMetaTagClick:Z,get metaTags(){return n(T)},get selectedTags(){return n(y)},handleSelectedTagClick:K})}var q=D(Se,2);{let Y=A(()=>n(T).has(Qe.BIN));Ms(q,{get hideTagMenu(){return n(Y)},get metaTags(){return n(ne)},get tags(){return n(ge)},handleMetaTagClick:U,handleTagClick:J,mobile:!0})}Ce((Y,se)=>{at(Ee,"href",Y),at(S,"href",se)},[()=>l(ye.Settings),()=>l(ye.Sync)]),h(Q,be)},$$slots:{default:!0}})},ce=te=>{var Q=hf(),re=C(Q),be=C(re);{let Ee=A(u);zo(be,{placeholder:"Search tag",get value(){return n(Ee)},onChange:le=>{c(le)}})}var Se=D(re,2),Te=C(Se),Ie=C(Te);{let Ee=A(()=>n(T).has(Qe.BIN));Ds(Ie,{get metaTags(){return n(T)},get clearTags(){return _},get clearMetaTags(){return O},get hideTagMenu(){return n(Ee)},get selectedTags(){return n(y)},handleMetaTagClick:Z,handleSelectedTagClick:K})}var Oe=D(Te,2);{let Ee=A(()=>n(T).has(Qe.BIN));Ms(Oe,{get metaTags(){return n(ne)},get hideTagMenu(){return n(Ee)},get tags(){return n(ge)},handleMetaTagClick:U,handleTagClick:J})}h(te,Q)};H(ee,te=>{n(he)?te(pe):te(ce,!1)})}h(t,ae),ve()}vt(["click"]);var mf=P('<button class="a p-16icze0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function _f(t,e){fe(e,!0);let a=Pe(e,"ref",15);var r=mf();r.__click=function(...i){e.onClick?.apply(this,i)};var o=C(r);ue(o,()=>({"--rotate":"-90deg"})),me(o.lastChild,{name:"menu"});var s=D(o,2);pt(s,{children:(i,l)=>{var d=Le();Ce(()=>it(d,e.title)),h(i,d)}}),Je(r,i=>a(i),()=>a()),h(t,r),ve()}vt(["click"]);const Rs=t=>{try{new URL(t)}catch{return!1}return!0};var wf=P('<div class="b p-y9ylet">Add tag for selected notes</div> <!> <div class="c p-y9ylet"><!> <!></div>',1),yf=P('<form class="a p-y9ylet"><!></form>');function bf(t,e){fe(e,!0);const{addTag:a}=zt(),{getSelectedTags:r}=jn(),{getSelectedNotes:o}=la(),{getFiltredNotes:s}=Ma();let i=I(!1),l=I(!1),d,u=!1,c=I(null),v=I(""),p=e.nextFocusRef;we(()=>(n(c)&&n(c).focus(),()=>{d&&clearTimeout(d)}));const m=()=>{d=setTimeout(()=>{f(l,!0)},250)},_=()=>{f(i,!0)},x=async()=>{if(r().has(n(v).trim())){_();return}if(n(v).trim()!=="")try{m();const y=new Set(o()),T=y.size?[...y]:s().map(W=>W.id),{cancel:R}=await a(n(v).trim(),T);ct("Tag added",{cancel:{nextFocusRef:p,onCancel:async()=>{await R(),setTimeout(()=>{const{prev:W}=wt(p);W?.focus()},16)}}}),u=!0}finally{f(i,!0)}},w=()=>{e.onClosed?.(u)},k=O=>{O.preventDefault(),x()};Dr(t,{get blocked(){return n(l)},get startClose(){return n(i)},onClosed:w,children:(O,y)=>{var T=yf(),R=C(T);{var W=L=>{Ia(L,{})},N=L=>{var J=wf(),U=D(M(J),2);Cr(U,{placeholder:"Enter new tag name",get ref(){return n(c)},set ref(V){f(c,V,!0)},get value(){return n(v)},set value(V){f(v,V,!0)}});var K=D(U,2),Z=C(K);It(Z,{onClick:_,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(V,ge)=>{var he=Le("Cancel");h(V,he)},$$slots:{default:!0}});var X=D(Z,2);It(X,{onClick:x,fullWidth:!0,withoutMinWidth:!0,children:(V,ge)=>{var he=Le("OK");h(V,he)},$$slots:{default:!0}}),h(L,J)};H(R,L=>{n(l)?L(W):L(N,!1)})}ln("submit",T,k),h(O,T)},$$slots:{default:!0}}),ve()}var Sf=P('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Cf=P('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),kf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),xf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),Tf=P("<div><!></div>"),Ef=P('<form class="c p-1u93q2r"><div class="d p-1u93q2r"><!></div> <button type="button" class="e p-1u93q2r">Done</button></form>'),Pf=P('<div class="a"><div class="b p-1u93q2r"><!> <!> <!> <!> <!> <!></div> <!></div>');function ul(t,e){fe(e,!0);const{isInitedNotes:a,getGetMapTags:r,getGetNotes:o}=zt(),{getSelectedTags:s}=jn();let i=I(null),l=I(""),d=I(null);const u=A(a);let c=Pe(e,"shownTagInput",15);const v=()=>n(u)?e.mode==="exit"?Yo(new Set,new Set(e.selectedTags),o()()||[]):[...r()().keys()]:[];let m=A(()=>{const j=s(),G=new Set(Yo(new Set,new Set(e.selectedTags.length>0?e.selectedTags:j),o()()||[]));return v().filter(ae=>e.selectedTags.some(ee=>ae===ee)?!1:n(l)===""||ae.toLowerCase().indexOf(n(l).toLowerCase())===0).sort((ae,ee)=>j.has(ae)&&j.has(ee)?ae.localeCompare(ee):j.has(ae)?-1:j.has(ee)?1:G.has(ae)&&G.has(ee)?ae.localeCompare(ee):G.has(ae)?-1:G.has(ee)?1:0)});const _=j=>{if(!e.selectedTags.includes(j)){if(e.mode!=="exit"||n(m).includes(j)){e.onChangeTags([...e.selectedTags,j]),f(l,"");return}n(i)?.focus()}},x=j=>{const G=e.selectedTags.filter(ne=>ne!==j);e.onRejectedTag&&e.onRejectedTag(j),G.length===0?e.onChangeTags([]):e.onChangeTags(G)},w=j=>{j.preventDefault(),n(l)!==""?_(n(l)):c(!1)};ze(()=>{n(i)&&c()&&n(i).focus(),c()||f(l,"")});const k=j=>{j.preventDefault()},O=j=>{j.preventDefault(),j.stopPropagation(),j.stopImmediatePropagation()};var y=Pf(),T=C(y),R=C(T);Rn(R,17,()=>e.selectedTags,j=>j+"-tags_selected",(j,G)=>{fa(j,{onPointerDown:k,onTouchStart:O,onClick:()=>{x(n(G))},type:"button",style:"selected",children:(ne,ae)=>{var ee=Le();Ce(()=>it(ee,n(G))),h(ne,ee)},$$slots:{default:!0}})});var W=D(R,2);{var N=j=>{var G=de(),ne=M(G);Rn(ne,17,()=>n(m).filter(ae=>ae.toLowerCase()!==n(l).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),ae=>ae+"-tags_suggested",(ae,ee)=>{fa(ae,{onPointerDown:k,onTouchStart:O,onClick:()=>{_(n(ee))},children:(pe,ce)=>{var te=Le();Ce(()=>it(te,n(ee))),h(pe,te)},$$slots:{default:!0}})}),h(j,G)};H(W,j=>{c()&&j(N)})}var L=D(W,2);{var J=j=>{fa(j,{onPointerDown:k,onTouchStart:O,onClick:()=>{_(n(l)),f(l,"")},children:(G,ne)=>{var ae=Le();Ce(()=>it(ae,n(l))),h(G,ae)},$$slots:{default:!0}})};H(L,j=>{n(l)!==""&&(e.mode!=="exit"||n(m).find(G=>G.toLowerCase()===n(l).toLowerCase()))&&j(J)})}var U=D(L,2);{var K=j=>{fa(j,{mode:"empty",onPointerDown:k,onTouchStart:O,onClick:()=>{c(!0)},children:(G,ne)=>{var ae=Sf(),ee=C(ae);ue(ee,()=>({"--size":"12px"})),me(ee.lastChild,{name:"plus"});var pe=D(ee,2);pt(pe,{children:(ce,te)=>{var Q=Le("add tag");h(ce,Q)}}),h(G,ae)},$$slots:{default:!0}})};H(U,j=>{c()||j(K)})}var Z=D(U,2);{var X=j=>{fa(j,{mode:"empty",onPointerDown:k,onTouchStart:O,get onClick(){return e.onUsePreviousTags},children:(G,ne)=>{var ae=Cf(),ee=C(ae);ue(ee,()=>({"--size":"12px"})),me(ee.lastChild,{name:"back"});var pe=D(ee,2);pt(pe,{children:(ce,te)=>{var Q=Le("use previous tags");h(ce,Q)}}),h(G,ae)},$$slots:{default:!0}})};H(Z,j=>{e.previousTagsEnabled&&e.onUsePreviousTags&&j(X)})}var V=D(Z,2);{var ge=j=>{fa(j,{mode:"empty",onPointerDown:k,onTouchStart:O,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:(G,ne)=>{var ae=Tf(),ee=C(ae);{var pe=te=>{var Q=kf(),re=M(Q);ue(re,()=>({"--size":"12px"})),Ia(re.lastChild,{}),h(te,Q)},ce=te=>{var Q=xf(),re=M(Q);ue(re,()=>({"--size":"12px","--rotate":"180deg"})),me(re.lastChild,{name:"stars"});var be=D(re,2);pt(be,{children:(Se,Te)=>{var Ie=Le("gen tags");h(Se,Ie)}}),h(te,Q)};H(ee,te=>{e.generatingTags?te(pe):te(ce,!1)})}h(G,ae)},$$slots:{default:!0}})};H(V,j=>{e.genTagsEnabled&&e.onGenTags&&j(ge)})}var he=D(T,2);{var $=j=>{var G=Ef(),ne=C(G),ae=C(ne);Cr(ae,{placeholder:"tag",get ref(){return n(i)},set ref(pe){f(i,pe,!0)},get value(){return n(l)},set value(pe){f(l,pe,!0)}});var ee=D(ne,2);ee.__pointerdown=k,ee.__touchstart=O,ee.__click=()=>{n(i)?.blur(),n(l)!==""&&_(n(l)),c(!1),f(l,"")},ln("submit",G,w),h(j,G)};H(he,j=>{c()&&j($)})}Je(y,j=>f(d,j),()=>n(d)),h(t,y),ve()}vt(["pointerdown","touchstart","click"]);var Nf=P('<div class="c p-y9ylet"><!> <!></div>'),Af=P('<div class="b p-y9ylet">Change tags for selected notes</div> <!> <!>',1),Mf=P('<form class="a p-y9ylet"><!></form>');function Df(t,e){fe(e,!0);const{changeTags:a,getNoteById:r}=zt(),{getSelectedTags:o}=jn(),{getSelectedNotes:s}=la(),{getFiltredNotes:i}=Ma();let l=I(!1),d=I(!1),u,c=!1,v=I(!1),p=e.nextFocusRef,_=(()=>{const N=[...o()],L=s();if(L.size===0)return N;const J=Array.from(L);let U=new Set(r(J[0])?.data.tags||[]);for(let K=1;K<J.length;K++){const Z=new Set(r(J[K])?.data.tags||[]),X=new Set([]);Z.forEach(V=>{U.has(V)&&X.add(V)}),U=X}return Array.from(U)})(),x=I(dt(_));we(()=>()=>{u&&clearTimeout(u)});const w=()=>{u=setTimeout(()=>{f(d,!0)},250)},k=()=>{f(l,!0)},O=async()=>{const N=_,L=new Set(s()),J=L.size?[...L]:i().map(U=>U.id);try{w();const{cancel:U}=await a([...N],n(x),J);ct("Tags changed",{cancel:{nextFocusRef:p,onCancel:async()=>{await U(),setTimeout(()=>{const{prev:K}=wt(p);K?.focus()},16)}}}),c=!0}finally{f(l,!0)}},y=N=>{N.key==="Escape"&&n(v)&&(f(v,!1),N.preventDefault(),N.stopPropagation())};we(()=>(document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)));const T=()=>{e.onClosed?.(c)},R=N=>{f(x,N,!0)},W=N=>{N.preventDefault(),O()};Dr(t,{get blocked(){return n(d)},get startClose(){return n(l)},onClosed:T,children:(N,L)=>{var J=Mf(),U=C(J);{var K=X=>{Ia(X,{})},Z=X=>{var V=Af(),ge=D(M(V),2);ul(ge,{get selectedTags(){return n(x)},onChangeTags:R,get shownTagInput(){return n(v)},set shownTagInput(j){f(v,j,!0)}});var he=D(ge,2);{var $=j=>{var G=Nf(),ne=C(G);It(ne,{onClick:k,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(ee,pe)=>{var ce=Le("Cancel");h(ee,ce)},$$slots:{default:!0}});var ae=D(ne,2);It(ae,{onClick:O,fullWidth:!0,withoutMinWidth:!0,children:(ee,pe)=>{var ce=Le("OK");h(ee,ce)},$$slots:{default:!0}}),h(j,G)};H(he,j=>{n(v)||j($)})}h(X,V)};H(U,X=>{n(d)?X(K):X(Z,!1)})}ln("submit",J,W),h(N,J)},$$slots:{default:!0}}),ve()}var If=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),Lf=P('<li class="p-antir2"><!></li>'),Rf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),Of=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),Ff=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),zf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Bf=P('<li class="p-antir2"><!></li> <li class="p-antir2"><!></li>',1),jf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Hf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),Uf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),Wf=P('<li class="p-antir2"><!></li>'),Vf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),qf=P('<li class="p-antir2"><!></li>'),Kf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),Yf=P('<li class="p-antir2"><!></li> <li class="p-antir2"><!></li> <!> <li class="p-antir2"><!></li>',1),Gf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),Xf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),Jf=P('<li class="p-antir2"><!></li> <li class="p-antir2"><!></li>',1),Zf=P('<!> <!> <li class="p-antir2"><!></li> <li class="p-antir2"><!></li> <!> <!> <!>',1),Qf=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),$f=P('<div class="a p-antir2"><!></div> <!> <!> <!>',1);function ev(t,e){fe(e,!0);const{getSelectedTags:a,setSelectedTags:r,clearTags:o}=jn(),{moveNotesToBin:s,moveNotesToArchive:i,moveNotesFromArchive:l,restoreNotesFromBin:d,deleteNotes:u}=zt(),{getFiltredNotes:c}=Ma(),{getMode:v,changeMode:p,getSelectedNotes:m,setSelectedNotes:_,clearNotes:x}=la();let w=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),k=A(a),O=I(!1),y=I(!1),T=I(!1),R=I(!1),W=I(null),N=I(null);const L=()=>{n(O)||f(O,!0)},J=()=>{f(O,!1),f(y,!1)};ze(()=>{!n(O)&&!n(T)&&!n(R)&&f(W,wt(n(N)).next,!0)}),we(()=>{const le=g=>{g.key==="Escape"&&n(O)&&n(N)?.focus()};return window.addEventListener("keydown",le),()=>{window.removeEventListener("keydown",le)}});let U=()=>{};const K=()=>{f(y,!0),f(T,!0);let le=n(N);U=()=>{f(T,!1),setTimeout(()=>{le?.focus()},16)}};let Z=()=>{};const X=()=>{f(y,!0),f(R,!0);let le=n(N);Z=()=>{f(R,!1),setTimeout(()=>{le?.focus()},16)}},V=async()=>{const le=Array.from(n(k)),g=new Set(m()),b=g.size?[...g]:c().map(E=>E.id),{cancel:S}=await s({noteIds:b});o(),x(),ct("Notes moved to bin",{cancel:{nextFocusRef:n(W),onCancel:async()=>{await S(),r(new Set(le)),_(g),setTimeout(()=>{const{prev:E}=wt(n(W));E?.focus()},16)}}}),f(y,!0)},ge=async()=>{const le=Array.from(n(k)),g=new Set(m()),b=g.size?[...g]:c().map(E=>E.id),{cancel:S}=await i({noteIds:b});o(),x(),ct("Notes moved to archive",{cancel:{nextFocusRef:n(W),onCancel:async()=>{await S(),r(new Set(le)),_(g),setTimeout(()=>{const{prev:E}=wt(n(W));E?.focus()},16)}}}),f(y,!0)},he=async()=>{const le=Array.from(n(k)),g=new Set(m()),b=g.size?[...g]:c().map(E=>E.id),{cancel:S}=await l({noteIds:b});o(),x(),ct("Notes moved from archive",{cancel:{nextFocusRef:n(W),onCancel:async()=>{await S(),r(new Set(le)),_(g),setTimeout(()=>{const{prev:E}=wt(n(W));E?.focus()},16)}}}),f(y,!0)},$=async()=>{const le=Array.from(n(k)),g=new Set(m()),b=g.size?[...g]:c().map(E=>E.id),{cancel:S}=await d({noteIds:b});o(),x(),ct("Notes restored",{cancel:{nextFocusRef:n(W),onCancel:async()=>{await S(),r(new Set(le)),_(g),setTimeout(()=>{const{prev:E}=wt(n(W));E?.focus()},16)}}}),f(y,!0)},j=()=>{const le=new Set(m()),g=le.size?[...le]:c().map(b=>b.id);f(y,!0),Va({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{f(y,!0),o(),x(),await u({noteIds:g})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(N)?.focus()},16)}})},G=()=>{const le=c(),g=Array.from(m()),b=[];for(const E of le)E.data&&E.data?.link&&Rs(E.data?.link.url)&&(g.includes(E.id)||g.length===0)&&b.push(E.data?.link.url);const S=()=>{for(const E of b)if(!window.open(E,"_blank")){Va({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(N)?.focus()},16)}});break}};b.length<=10?S():Va({title:`Are you sure to open ${b.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{S()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(N)?.focus()},16)}}),f(y,!0)},ne=()=>{const le=c(),g=Array.from(m());let b="";for(const S of le)S.data&&S.data?.link&&Rs(S.data?.link.url)&&(g.includes(S.id)||g.length===0)&&(b+=S.data?.link.url+`
`);navigator.clipboard.writeText(b),ct("Copied links"),f(y,!0)},ae=()=>{const le=c(),g=Array.from(m());let b="";for(const S of le)S.data&&(g.includes(S.id)||g.length===0)&&(S.data?.link?.url&&(b+=S.data?.link.url+`
`),S.data?.text&&(b+=`
`+S.data?.text+`
`),b+=`---------------------

`);navigator.clipboard.writeText(b),ct("Copied"),f(y,!0)},ee=()=>{const le=c(),g=Array.from(m());let b="";for(const S of le)S.data&&(g.includes(S.id)||g.length===0)&&S.data?.link?.url&&(b+=S.data?.link.url+`

`);navigator.share({text:b}).catch(S=>{console.error("Error sharing",S)}),f(y,!0)},pe=()=>{const le=c(),g=Array.from(m());let b="";for(const S of le)S.data&&(g.includes(S.id)||g.length===0)&&(S.data?.link?.url&&(b+=S.data?.link.url+`
`),S.data?.text&&(b+=`
`+S.data?.text+`
`),b+=`---------------------

`);navigator.share({text:b}).catch(S=>{console.error("Error sharing",S)}),f(y,!0)};let ce=ia||Ea;var te=$f(),Q=M(te),re=C(Q);_f(re,{title:"notes menu",onClick:L,get ref(){return n(N)},set ref(le){f(N,le,!0)}});var be=D(Q,2);{var Se=le=>{var g=Qf(),b=M(g);ue(b,()=>({"--right":"0","--top":"44px"})),Ir(b.lastChild,{get startClose(){return n(y)},onClosed:J,get isMobile(){return ce},children:(S,E)=>{var F=Zf(),B=M(F);{var oe=xe=>{var Me=Lf(),Ne=C(Me);qe(Ne,{onClick:G,get dialogMode(){return ce},children:(Ue,gt)=>{var je=If(),Ke=M(je);ue(Ke,()=>({"--size":"20px"})),me(Ke.lastChild,{name:"open"}),h(Ue,je)},$$slots:{default:!0}}),h(xe,Me)};H(B,xe=>{ia||Ea||xe(oe)})}var ke=D(B,2);H(ke,xe=>{});var ie=D(ke,2),q=C(ie);qe(q,{onClick:ne,get dialogMode(){return ce},children:(xe,Me)=>{var Ne=Rf(),Ue=M(Ne);ue(Ue,()=>({"--size":"20px"})),me(Ue.lastChild,{name:"copy"}),h(xe,Ne)},$$slots:{default:!0}});var Y=D(ie,2),se=C(Y);qe(se,{onClick:ae,get dialogMode(){return ce},children:(xe,Me)=>{var Ne=Of(),Ue=M(Ne);ue(Ue,()=>({"--size":"20px"})),me(Ue.lastChild,{name:""}),h(xe,Ne)},$$slots:{default:!0}});var _e=D(Y,2);{var Ve=xe=>{var Me=Bf(),Ne=M(Me),Ue=C(Ne);qe(Ue,{onClick:ee,get dialogMode(){return ce},children:(Ke,ht)=>{var $e=Ff(),ot=M($e);ue(ot,()=>({"--size":"20px"})),me(ot.lastChild,{name:"share"}),h(Ke,$e)},$$slots:{default:!0}});var gt=D(Ne,2),je=C(gt);qe(je,{onClick:pe,get dialogMode(){return ce},children:(Ke,ht)=>{var $e=zf(),ot=M($e);ue(ot,()=>({"--size":"20px"})),me(ot.lastChild,{name:""}),h(Ke,$e)},$$slots:{default:!0}}),h(xe,Me)};H(_e,xe=>{w&&xe(Ve)})}var Fe=D(_e,2);{var Ae=xe=>{var Me=Yf(),Ne=M(Me),Ue=C(Ne);qe(Ue,{onClick:K,get dialogMode(){return ce},children:(st,yt)=>{var lt=jf(),St=M(lt);ue(St,()=>({"--size":"20px","--rotate":"45deg"})),me(St.lastChild,{name:"close"}),h(st,lt)},$$slots:{default:!0}});var gt=D(Ne,2),je=C(gt);qe(je,{onClick:X,get dialogMode(){return ce},children:(st,yt)=>{var lt=Hf(),St=M(lt);ue(St,()=>({"--size":"20px"})),me(St.lastChild,{name:""}),h(st,lt)},$$slots:{default:!0}});var Ke=D(gt,2);{var ht=st=>{var yt=Wf(),lt=C(yt);qe(lt,{onClick:ge,get dialogMode(){return ce},children:(St,La)=>{var da=Uf(),ua=M(da);ue(ua,()=>({"--size":"20px"})),me(ua.lastChild,{name:"archive"}),h(St,da)},$$slots:{default:!0}}),h(st,yt)},$e=st=>{var yt=qf(),lt=C(yt);qe(lt,{onClick:he,get dialogMode(){return ce},children:(St,La)=>{var da=Vf(),ua=M(da);ue(ua,()=>({"--size":"20px"})),me(ua.lastChild,{name:"archive-cancel"}),h(St,da)},$$slots:{default:!0}}),h(st,yt)};H(Ke,st=>{e.mode==="notes"?st(ht):st($e,!1)})}var ot=D(Ke,2),Bt=C(ot);qe(Bt,{onClick:V,get dialogMode(){return ce},dangerous:!0,children:(st,yt)=>{var lt=Kf(),St=M(lt);ue(St,()=>({"--size":"20px"})),me(St.lastChild,{name:"bin"}),h(st,lt)},$$slots:{default:!0}}),h(xe,Me)};H(Fe,xe=>{(e.mode==="notes"||e.mode==="archive")&&xe(Ae)})}var mt=D(Fe,2);{var He=xe=>{var Me=Jf(),Ne=M(Me),Ue=C(Ne);qe(Ue,{onClick:$,get dialogMode(){return ce},children:(Ke,ht)=>{var $e=Gf(),ot=M($e);ue(ot,()=>({"--size":"20px"})),me(ot.lastChild,{name:"bin-cancel"}),h(Ke,$e)},$$slots:{default:!0}});var gt=D(Ne,2),je=C(gt);qe(je,{onClick:j,get dialogMode(){return ce},dangerous:!0,children:(Ke,ht)=>{var $e=Xf(),ot=M($e);ue(ot,()=>({"--size":"20px"})),me(ot.lastChild,{name:"bin"}),h(Ke,$e)},$$slots:{default:!0}}),h(xe,Me)};H(mt,xe=>{e.mode==="bin"&&xe(He)})}h(S,F)},$$slots:{default:!0}}),h(le,g)};H(be,le=>{n(O)&&le(Se)})}var Te=D(be,2);{var Ie=le=>{bf(le,{get nextFocusRef(){return n(W)},onClosed:g=>{U(g)}})};H(Te,le=>{n(T)&&le(Ie)})}var Oe=D(Te,2);{var Ee=le=>{Df(le,{get nextFocusRef(){return n(W)},onClosed:g=>{Z(g)}})};H(Oe,le=>{n(R)&&le(Ee)})}h(t,te),ve()}var tv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),nv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),av=P('<li class="p-1ljon4s"><!></li>'),rv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),ov=P('<li class="p-1ljon4s"><!></li>'),sv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),iv=P('<li class="p-1ljon4s"><!></li>'),lv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),cv=P('<li class="p-1ljon4s"><!></li>'),dv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),uv=P('<li class="p-1ljon4s"><!></li>'),fv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),vv=P('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),gv=P('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),hv=P('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),pv=P(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),mv=P('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),_v=P('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!>',1),wv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function yv(t,e){fe(e,!0);const{checkMobileSize:a}=Da(),{getMode:r,getSelectedNotes:o,changeMode:s,addNote:i,removeNote:l}=la(),{moveNoteToBin:d,moveNoteFromArchive:u,moveNoteToArchive:c,deleteNote:v,pinNote:p,restoreNoteFromBin:m}=zt();let _=Pe(e,"mode",3,"notes"),x=Pe(e,"shownMenu",15),w=I(!1),k=I(!1),O=I(!1),y=I(!1),T=I(!1),R=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const W=async()=>{d(e.noteId),ct("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{m(e.noteId)}}})},N=async()=>{c(e.noteId),ct("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{u(e.noteId)}}})},L=async()=>{u(e.noteId),ct("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{c(e.noteId)}}})},J=()=>{m(e.noteId),ct("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(e.noteId)}}})},U=()=>{e.noteData.pinned?(p(e.noteId,!1),ct("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!0)}}})):(p(e.noteId,!0),ct("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!1)}}})),f(w,!0)},K=()=>{n(k)?(f(k,!1),W()):n(T)?(f(T,!1),J()):n(O)?(f(O,!1),N()):n(y)&&(f(y,!1),L()),x(!1),f(w,!1)},Z=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),ct("Copied link"),f(w,!0))},X=()=>{let pe="";e.noteData.link?.url&&(pe+=e.noteData.link.url+`
`),e.noteData.text&&(pe+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(pe),ct("Copied"),f(w,!0)},V=()=>{f(w,!0),Va({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await v(e.noteId)},onCancel:async()=>{}})},ge=()=>{if(navigator.share){const pe={};let ce="";e.noteData.link?.url&&(ce+=e.noteData.link.url+`
`),e.noteData.text&&(ce+=`
`+e.noteData.text+`
`),pe.text=ce,navigator.share(pe).catch(te=>{console.error("Error sharing",te)})}f(w,!0)},he=()=>{if(navigator.share){const pe={};e.noteData.link?.url&&(pe.url=e.noteData.link.url),e.noteData.link?.title&&(pe.title=e.noteData.link.title),navigator.share(pe).catch(ce=>{console.error("Error sharing",ce)})}f(w,!0)};let $=ia||Ea,j=A(a),G=A(()=>r()==="multiple"&&o().has(e.noteId));var ne=de(),ae=M(ne);{var ee=pe=>{var ce=wv(),te=M(ce);ue(te,()=>({"--bottom":e.showMenuUp?"calc(100% + 4px)":"auto","--top":e.showMenuUp?"auto":"calc(100% + 4px)","--right":"10px"})),Ir(te.lastChild,{get startClose(){return n(w)},onClosed:K,get isMobile(){return $},children:(Q,re)=>{var be=_v(),Se=M(be),Te=C(Se);qe(Te,{onClick:U,get dialogMode(){return $},children:(q,Y)=>{var se=tv(),_e=M(se);{let Fe=A(()=>e.noteData.pinned?"pin-cancel":"pin");ue(_e,()=>({"--size":"20px"})),me(_e.lastChild,{get name(){return n(Fe)}})}var Ve=D(_e);Ce(()=>it(Ve,` ${e.noteData.pinned?"Unpin":"Pin"}`)),h(q,se)},$$slots:{default:!0}});var Ie=D(Se,2);{var Oe=q=>{var Y=av(),se=C(Y);qe(se,{onClick:Z,get dialogMode(){return $},children:(_e,Ve)=>{var Fe=nv(),Ae=M(Fe);ue(Ae,()=>({"--size":"20px"})),me(Ae.lastChild,{name:"copy"}),h(_e,Fe)},$$slots:{default:!0}}),h(q,Y)};H(Ie,q=>{n(j)&&e.noteData.link?.url&&q(Oe)})}var Ee=D(Ie,2);{var le=q=>{var Y=ov(),se=C(Y);qe(se,{onClick:X,get dialogMode(){return $},children:(_e,Ve)=>{var Fe=rv(),Ae=M(Fe);ue(Ae,()=>({"--size":"20px"})),me(Ae.lastChild,{name:"copy"}),h(_e,Fe)},$$slots:{default:!0}}),h(q,Y)};H(Ee,q=>{e.noteData.text&&q(le)})}var g=D(Ee,2);{var b=q=>{var Y=iv(),se=C(Y);qe(se,{onClick:ge,get dialogMode(){return $},children:(_e,Ve)=>{var Fe=sv(),Ae=M(Fe);ue(Ae,()=>({"--size":"20px"})),me(Ae.lastChild,{name:"share"}),h(_e,Fe)},$$slots:{default:!0}}),h(q,Y)};H(g,q=>{R&&e.noteData.text&&q(b)})}var S=D(g,2);{var E=q=>{var Y=cv(),se=C(Y);qe(se,{onClick:he,get dialogMode(){return $},children:(_e,Ve)=>{var Fe=lv(),Ae=M(Fe);ue(Ae,()=>({"--size":"20px"})),me(Ae.lastChild,{name:"share"}),h(_e,Fe)},$$slots:{default:!0}}),h(q,Y)};H(S,q=>{R&&e.noteData.link?.url&&q(E)})}var F=D(S,2);{var B=q=>{var Y=uv(),se=C(Y);qe(se,{onClick:()=>{f(w,!0),r()!=="multiple"&&s("multiple"),i(e.noteId)},get dialogMode(){return $},children:(_e,Ve)=>{var Fe=dv(),Ae=M(Fe);ue(Ae,()=>({"--size":"20px"})),me(Ae.lastChild,{name:"check"}),h(_e,Fe)},$$slots:{default:!0}}),h(q,Y)};H(F,q=>{n(G)||q(B)})}var oe=D(F,2);{var ke=q=>{var Y=gv(),se=M(Y),_e=C(se);qe(_e,{onClick:()=>{f(O,_()==="notes"),f(y,_()==="archive"),f(w,!0)},get dialogMode(){return $},children:(Ae,mt)=>{var He=fv(),xe=M(He);{let Ne=A(()=>_()==="archive"?"archive-cancel":"archive");ue(xe,()=>({"--size":"20px"})),me(xe.lastChild,{get name(){return n(Ne)}})}var Me=D(xe);Ce(()=>it(Me,` ${_()==="archive"?"Unarchive":"Archive"}`)),h(Ae,He)},$$slots:{default:!0}});var Ve=D(se,2),Fe=C(Ve);qe(Fe,{onClick:()=>{f(k,!0),f(w,!0)},get dialogMode(){return $},dangerous:!0,children:(Ae,mt)=>{var He=vv(),xe=M(He),Me=C(xe);ue(Me,()=>({"--size":"20px"})),me(Me.lastChild,{name:"bin"}),h(Ae,He)},$$slots:{default:!0}}),h(q,Y)},ie=q=>{var Y=mv(),se=M(Y),_e=C(se);qe(_e,{onClick:()=>{f(T,!0),f(w,!0)},get dialogMode(){return $},children:(Ae,mt)=>{var He=hv(),xe=M(He),Me=C(xe);ue(Me,()=>({"--size":"20px"})),me(Me.lastChild,{name:"bin-cancel"}),h(Ae,He)},$$slots:{default:!0}});var Ve=D(se,2),Fe=C(Ve);qe(Fe,{onClick:V,get dialogMode(){return $},dangerous:!0,children:(Ae,mt)=>{var He=pv(),xe=M(He),Me=C(xe);ue(Me,()=>({"--size":"20px"})),me(Me.lastChild,{name:"bin"}),h(Ae,He)},$$slots:{default:!0}}),h(q,Y)};H(oe,q=>{_()==="notes"||_()==="archive"?q(ke):q(ie,!1)})}h(Q,be)},$$slots:{default:!0}}),h(pe,ce)};H(ae,pe=>{x()&&pe(ee)})}h(t,ne),ve()}var bv=P('<div class="a p-1hg9kpf"></div>'),Sv=P('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function fl(t,e){fe(e,!0);const a=u=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(u).host}.ico`}catch{return""}};let r=I(!1),o=A(()=>a(e.url));var s=de(),i=M(s);{var l=u=>{var c=bv();h(u,c)},d=u=>{var c=Sv();Ce(v=>at(c,"src",v),[()=>a(e.url)]),ln("error",c,()=>{f(r,!0)}),h(u,c)};H(i,u=>{n(r)||!n(o)?u(l):u(d,!1)})}h(t,s),ve()}var Cv=P('<a target="_blank" rel="noopener noreferrer" class="a p-11racoy"><!> <!></a>'),kv=P('<button class="a p-11racoy"><!> <!></button>');function Nn(t,e){fe(e,!0);let a=Pe(e,"tabindex",3,0),r=Pe(e,"onclick",3,()=>{}),o=Pe(e,"ref",15);var s=de(),i=M(s);{var l=u=>{var c=Cv();c.__click=function(...m){r()?.apply(this,m)};var v=C(c);De(v,()=>e.children);var p=D(v,2);pt(p,{children:(m,_)=>{var x=Le();Ce(()=>it(x,e.title)),h(m,x)}}),Je(c,m=>o(m),()=>o()),Ce(()=>{at(c,"href",e.href),at(c,"tabindex",a())}),h(u,c)},d=u=>{var c=de(),v=M(c);{var p=m=>{var _=kv();_.__click=function(...k){r()?.apply(this,k)};var x=C(_);De(x,()=>e.children);var w=D(x,2);pt(w,{children:(k,O)=>{var y=Le();Ce(()=>it(y,e.title)),h(k,y)}}),Je(_,k=>o(k),()=>o()),Ce(()=>at(_,"tabindex",a())),h(m,_)};H(v,m=>{e.elem==="button"&&m(p)},!0)}h(u,c)};H(i,u=>{e.elem==="a"?u(l):u(d,!1)})}h(t,s),ve()}vt(["click"]);let ho=I(!1),po=I(!1),wn=I(void 0),Zr={};const xv=()=>{f(po,!0)},Tv=()=>{f(po,!1)},Ev=()=>{f(ho,!0)},Pv=()=>{f(ho,!1)},Nv=()=>n(po),Go=()=>n(ho),Tn=t=>{f(wn,t,!0)},Kr=()=>n(wn),Os=()=>{const t=Zr[n(wn)||""]?.next;if(t)return f(wn,t,!0),t},Fs=()=>{const t=Zr[n(wn)||""]?.prev;if(t)return f(wn,t,!0),t};var Av=P('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),Mv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Dv=P('<div class="b p-rxwzp0"><!></div>'),Iv=P('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Lv=P('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Rv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Ov=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Fv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),zv=P("<!> <!> <!>",1),Bv=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),jv=P("<li><!> <!> <!> <div><!> <!></div> <!></li>");function Hv(t,e){fe(e,!0);const{pushDialogPage:a}=Jt(),{getFaviconEnabled:r,getRecordMode:o}=er(),{getMode:s,getSelectedNotes:i,addNote:l,removeNote:d}=la(),{getSearchParams:u,getHref:c}=qt();let v=Pe(e,"mode",3,"notes"),p="unknown";ze(()=>(Zr[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete Zr[e.noteId]}));let m=I(!1),_=I(!1),x=A(r),w=A(o),k=I(null),O=I(null),y=I(null);const{checkMobileSize:T}=Da(),R=()=>{f(m,!0)},W=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),ct("copied"))};ze(()=>{n(wn)===e.noteId?f(_,!0):f(_,!1)});const N=Q=>{Q.preventDefault(),a(`${ye.Note}?id=${encodeURIComponent(e.noteId)}`)},L=A(()=>e.noteData.link?.url||"");let J=A(()=>n(m)&&n(k)?wt(n(k)).next:null);const U=Q=>{Q?l(e.noteId):d(e.noteId)},K=()=>{const Q=new URLSearchParams(u());return Q.set(en,`${ye.Note}?id=${encodeURIComponent(e.noteId)}`),c(Q)};let Z=A(()=>s()==="multiple"&&i().has(e.noteId));we(()=>{const Q=re=>{if(p="keyboard",n(wn)===e.noteId&&(re.key==="Enter"&&n(po)&&(n(w)==="note"?(re.preventDefault(),setTimeout(()=>{a(`${ye.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(w)==="bookmark"&&n(L)&&window.open(n(L),"_blank","noopener")),re.key==="Tab"&&n(ho)&&(Pv(),n(y)))){const be=wt(n(y));re.shiftKey?be.prev?.focus():be?.next?.focus()}};return document.addEventListener("keydown",Q),()=>{document.removeEventListener("keydown",Q)}});var X=jv();X.__focusin=()=>{p==="keyboard"&&f(wn,e.noteId,!0)};var V=C(X);{var ge=Q=>{var re=Av(),be=C(re);ue(be,()=>({"--size":"18px"})),me(be.lastChild,{name:"pin"}),h(Q,re)};H(V,Q=>{e.noteData.pinned&&Q(ge)})}var he=D(V,2);{var $=Q=>{var re=Dv(),be=C(re);{var Se=Ie=>{fl(Ie,{get url(){return n(L)}})},Te=Ie=>{var Oe=Mv(),Ee=M(Oe);ue(Ee,()=>({"--size":"16px"})),me(Ee.lastChild,{name:"note"}),h(Ie,Oe)};H(be,Ie=>{n(L)?Ie(Se):Ie(Te,!1)})}h(Q,re)};H(he,Q=>{n(x)&&Q($)})}var j=D(he,2);{var G=Q=>{var re=Iv();re.__keydown=Se=>{Se.key==="Enter"&&(p="keyboard")},re.__mousedown=()=>{p="mouse"},re.__click=Se=>{console.log(p),p==="mouse"&&Tn(void 0),Se.preventDefault(),s()==="multiple"?U(!n(Z)):N(Se)};var be=C(re);Je(re,Se=>f(y,Se),()=>n(y)),Ce((Se,Te)=>{at(re,"tabindex",e.focusHidden?-1:0),at(re,"href",Se),it(be,Te)},[K,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),ln("focus",re,()=>{}),h(Q,re)},ne=Q=>{var re=Lv();re.__keydown=Se=>{Se.key==="Enter"&&(p="keyboard")},re.__mousedown=()=>{p="mouse"},re.__click=Se=>{s()==="multiple"&&(Se.preventDefault(),U(!n(Z)))};var be=C(re);Je(re,Se=>f(y,Se),()=>n(y)),Ce(Se=>{at(re,"tabindex",e.focusHidden?-1:0),at(re,"href",n(L)),it(be,Se)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),ln("focus",re,()=>{}),h(Q,re)};H(j,Q=>{n(w)==="note"||!n(L)?Q(G):Q(ne,!1)})}var ae=D(j,2),ee=C(ae);{var pe=Q=>{var re=zv(),be=M(re);{var Se=le=>{{let g=A(K),b=A(()=>e.focusHidden?-1:0);Nn(le,{title:"edit",elem:"a",get href(){return n(g)},get tabindex(){return n(b)},onclick:N,children:(S,E)=>{var F=Rv(),B=M(F);ue(B,()=>({"--size":"18px"})),me(B.lastChild,{name:"pen"}),h(S,F)},$$slots:{default:!0}})}};H(be,le=>{(n(w)==="bookmark"||s()==="multiple")&&le(Se)})}var Te=D(be,2);{var Ie=le=>{{let g=A(()=>e.focusHidden?-1:0),b=A(()=>e.noteData.link?.title||"unknown");Nn(le,{elem:"a",get href(){return n(L)},get tabindex(){return n(g)},get title(){return n(b)},children:(S,E)=>{var F=Ov(),B=M(F);ue(B,()=>({"--size":"18px"})),me(B.lastChild,{name:"open"}),h(S,F)},$$slots:{default:!0}})}};H(Te,le=>{(n(w)==="note"||s()==="multiple")&&le(Ie)})}var Oe=D(Te,2);{var Ee=le=>{{let g=A(()=>e.focusHidden?-1:0);Nn(le,{elem:"button",onclick:W,get tabindex(){return n(g)},title:"copy link",children:(b,S)=>{var E=Fv(),F=M(E);ue(F,()=>({"--size":"20px"})),me(F.lastChild,{name:"copy"}),h(b,E)},$$slots:{default:!0}})}};H(Oe,le=>{T()||le(Ee)})}h(Q,re)};H(ee,Q=>{n(L)&&Q(pe)})}var ce=D(ee,2);{let Q=A(()=>e.focusHidden?-1:0);Nn(ce,{title:"show menu",elem:"button",get tabindex(){return n(Q)},onclick:R,get ref(){return n(k)},set ref(re){f(k,re,!0)},children:(re,be)=>{var Se=Bv(),Te=M(Se);ue(Te,()=>({"--size":"18px","--rotate":"90deg"})),me(Te.lastChild,{name:"menu"}),h(re,Se)},$$slots:{default:!0}})}var te=D(ae,2);yv(te,{get nextFocusRef(){return n(J)},get mode(){return v()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(m)},set shownMenu(Q){f(m,Q,!0)}}),Je(X,Q=>f(O,Q),()=>n(O)),Ce(()=>{tt(X,1,rt({d:!0,e:n(_),f:n(Z)||n(wn)===e.noteId}),"p-rxwzp0"),tt(ae,1,rt({g:!0,h:n(_)}),"p-rxwzp0")}),h(t,X),ve()}vt(["focusin","keydown","mousedown","click"]);var Uv=P('<div class="g e p-cyw3p4"><button class="d p-cyw3p4" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),Wv=P('<div class="g p-cyw3p4"><button class="d p-cyw3p4" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),Vv=P('<a class="i j p-cyw3p4"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),qv=P('<div class="h p-cyw3p4"><!> <!></div>'),Kv=P('<!> <div class="p p-cyw3p4"><!></div>',1),Yv=P('<button class="t p-cyw3p4">All</button>'),Gv=P('<button class="t p-cyw3p4"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),Xv=P('<div class="r p-cyw3p4"><div class="s p-cyw3p4"><!> <span> </span> <!></div> <button class="t u p-cyw3p4"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),Jv=P('<div class="a p-cyw3p4"><div class="b p-cyw3p4"><div class="c p-cyw3p4"><a class="d p-cyw3p4"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-cyw3p4"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-cyw3p4"><!></div> <div class="f p-cyw3p4"><!></div></div> <div class="k p-cyw3p4"><div class="l p-cyw3p4"><!></div> <div class="m p-cyw3p4"><div class="n p-cyw3p4"><div class="o p-cyw3p4"><!></div> <!></div> <div class="q p-cyw3p4"><!></div></div></div></div>');function Zv(t,e){fe(e,!0);const{getFeedSearch:a,setFeedSearch:r}=rs(),{getScrollContainer:o}=go();let s=A(o);const{emptyBin:i,checkNotesInBin:l,checkNotesInArchive:d,checkNotes:u}=zt(),{replaceSearchParams:c}=qt(),{createDialogPageHref:v,createHandleClickDialogPage:p,getDialogPages:m}=Jt(),{checkExistedDialog:_}=Zt(),{getMode:x,clearNotes:w,setSelectedNotes:k,getSelectedNotes:O,changeMode:y}=la(),{checkMobileSize:T}=Da(),{getFiltredNotes:R}=Ma(),{getSelectedMetaTags:W}=vo();let N=A(W),L=I(null);const J=A(l);let K=A(()=>{const ie=R()||[],q=O();return ie.every(Y=>q.has(Y.id))});const Z=()=>{Va({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await i(),c("")},onCancel:async()=>{}})};let X=A(()=>m().length===0);ze(()=>{n(X)});const V=()=>{m().length===0&&!_()&&n(L)?.focus()};we(()=>Sr({key:"k",meta:!0,action:V})),we(()=>Sr({key:"k",ctrl:!0,action:V})),we(()=>{}),ze(()=>{const ie=R()||[];Ft(()=>{const q=O();k(new Set(ie.filter(Y=>q.has(Y.id)).map(Y=>Y.id)))})});let ge=A(()=>n(N).has(Qe.ARCHIVED)?"archive":n(N).has(Qe.BIN)?"bin":"notes");we(()=>{n(L)&&n(L).addEventListener("keydown",ie=>{ie.key==="Tab"&&Kr()&&ie.preventDefault()})}),ze(()=>{Go()&&setTimeout(()=>{n(L)?.focus(),n(L)?.setSelectionRange(n(L).value.length,n(L).value.length)},0)});var he=Jv(),$=C(he),j=C($),G=C(j),ne=A(()=>p(ye.Settings));G.__click=function(...ie){n(ne)?.apply(this,ie)};var ae=C(G);ue(ae,()=>({"--rotate":"30deg","--size":"20px"})),me(ae.lastChild,{name:"settings"});var ee=D(G,2),pe=A(()=>p(ye.Sync));ee.__click=function(...ie){n(pe)?.apply(this,ie)};var ce=C(ee);ue(ce,()=>({"--size":"20px"})),me(ce.lastChild,{name:"sync"});var te=D(j,2),Q=C(te);ll(Q,{});var re=D(te,2),be=C(re);{var Se=ie=>{var q=de(),Y=M(q);{var se=_e=>{var Ve=de(),Fe=M(Ve);{var Ae=He=>{var xe=Uv(),Me=C(xe);Me.__click=Z;var Ne=C(Me);ue(Ne,()=>({"--scale":"1.2","--size":"20px"})),me(Ne.lastChild,{name:"clear"});var Ue=D(Ne);pt(Ue,{children:(gt,je)=>{var Ke=Le("Empty bin");h(gt,Ke)}}),h(He,xe)},mt=He=>{var xe=Wv(),Me=C(xe);Me.__click=Z;var Ne=C(Me);ue(Ne,()=>({"--scale":"0.9","--size":"20px"})),me(Ne.lastChild,{name:"clear"}),h(He,xe)};H(Fe,He=>{T()?He(Ae):He(mt,!1)})}h(_e,Ve)};H(Y,_e=>{n(J)&&_e(se)})}h(ie,q)},Te=ie=>{var q=de(),Y=M(q);{var se=_e=>{var Ve=qv(),Fe=C(Ve);{var Ae=He=>{var xe=Vv();xe.__click=function(...Ue){e.onOpenWindow?.apply(this,Ue)};var Me=C(xe);ue(Me,()=>({"--scale":"0.7","--size":"32px"})),me(Me.lastChild,{name:"open-window"});var Ne=D(Me,2);pt(Ne,{children:(Ue,gt)=>{var je=Le("open window");h(Ue,je)}}),Ce(()=>at(xe,"href",e.openWindowHref)),h(He,xe)};H(Fe,He=>{e.onOpenWindow&&He(Ae)})}var mt=D(Fe,2);Ru(mt,{}),h(_e,Ve)};H(Y,_e=>{n(ge)==="notes"&&_e(se)},!0)}h(ie,q)};H(be,ie=>{n(ge)==="bin"?ie(Se):ie(Te,!1)})}var Ie=D($,2),Oe=C(Ie),Ee=C(Oe);pf(Ee,{});var le=D(Oe,2),g=C(le),b=C(g),S=C(b);{let ie=A(a);zo(S,{placeholder:"Search",onFocus:()=>{ia||Ea||(xv(),n(L)?.setSelectionRange(n(L).value.length,n(L).value.length))},onBlur:()=>{Tv()},get value(){return n(ie)},onChange:q=>{console.log("Search value changed:",q),Tn(void 0),n(s)&&n(s).scrollTo({top:0}),r(q)},onEscape:()=>{Tn(void 0)},get ref(){return n(L)},set ref(q){f(L,q,!0)}})}var E=D(b,2);{var F=ie=>{var q=Kv(),Y=M(q);Eu(Y,{});var se=D(Y,2),_e=C(se);ev(_e,{get mode(){return n(ge)}}),h(ie,q)};H(E,ie=>{(n(ge)==="notes"&&u()||n(ge)==="bin"&&l()||n(ge)==="archive"&&d())&&ie(F)})}var B=D(g,2),oe=C(B);{var ke=ie=>{var q=de(),Y=M(q);{var se=_e=>{var Ve=Xv(),Fe=C(Ve),Ae=C(Fe);{var mt=je=>{var Ke=Yv();Ke.__click=ht=>{ht.preventDefault();const $e=R()||[];k(new Set($e.map(ot=>ot.id)))},h(je,Ke)};H(Ae,je=>{n(K)||je(mt)})}var He=D(Ae,2),xe=C(He),Me=D(He,2);{var Ne=je=>{var Ke=Gv();Ke.__click=$e=>{$e.preventDefault(),w()};var ht=C(Ke);ue(ht,()=>({"--size":"16px"})),me(ht.lastChild,{name:"close"}),h(je,Ke)};H(Me,je=>{O().size>0&&je(Ne)})}var Ue=D(Fe,2);Ue.__click=je=>{je.preventDefault(),y("single")};var gt=C(Ue);ue(gt,()=>({"--size":"16px"})),me(gt.lastChild,{name:"close"}),Ce(je=>it(xe,`Selected ${je??""}`),[()=>O().size]),h(_e,Ve)};H(Y,_e=>{x()==="multiple"&&_e(se)})}h(ie,q)};H(oe,ie=>{(n(ge)==="notes"&&u()||n(ge)==="bin"&&l()||n(ge)==="archive"&&d())&&ie(ke)})}Ce((ie,q)=>{at(G,"href",ie),at(ee,"href",q)},[()=>v(ye.Settings),()=>v(ye.Sync)]),h(t,he),ve()}vt(["click"]);var Qv=P('<div class="p-gkgqyo"><!></div>');function bt(t,e){fe(e,!0);const{setDialogPageHeight:a}=ls();let r=I(null);we(()=>{n(r);const i=new ResizeObserver(l=>{for(let d of l){const u=d.contentRect.height;a(u)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=Qv(),s=C(o);De(s,()=>e.children),Je(o,i=>f(r,i),()=>n(r)),h(t,o),ve()}var $v=P('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function eg(t,e){fe(e,!1);const{replaceSearchParams:a,getHref:r}=qt(),o=l=>{l.preventDefault(),a("")};as();var s=$v(),i=D(C(s),2);{let l=Pr(()=>r(""));It(i,{element:"a",get href(){return n(l)},onClick:o,children:(d,u)=>{var c=Le("close");h(d,c)},$$slots:{default:!0}})}h(t,s),ve()}var tg=P('<h1 class="p-1n0ziuh"><!></h1>');function ng(t,e){var a=tg(),r=C(a);De(r,()=>e.children),h(t,a)}var ag=P('<!> <div class="b p-193tby9"><!> <!></div>',1),rg=P('<div class="a p-193tby9"><!></div>');function og(t,e){fe(e,!0);const{blockDialog:a,setLeftEnd:r}=Zt(),{pushDialogPage:o}=Jt(),{initLocalAccount:s}=ss(),{replaceSearchParams:i}=qt(),l=Hn(),d=()=>{o(ye.Auth)},u=async()=>{l.duration=0,l.swipingRatio=-25,requestAnimationFrame(()=>{l.duration=ra().duration,l.swipingRatio=ra().swipingRatio,s(),a(!1),r(!0),i("")})};var c=rg(),v=C(c);{var p=m=>{var _=ag(),x=M(_);ng(x,{children:(y,T)=>{var R=Le("Welcome");h(y,R)}});var w=D(x,2),k=C(w);It(k,{onClick:d,fullWidth:!0,children:(y,T)=>{var R=Le("Cloud account");h(y,R)},$$slots:{default:!0}});var O=D(k,2);It(O,{onClick:u,fullWidth:!0,type:"secondary",children:(y,T)=>{var R=Le("Local account");h(y,R)},$$slots:{default:!0}}),h(m,_)};H(v,m=>{m(p)})}h(t,c),ve()}var sg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Edit',1),ig=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),lg=P('<li class="p-1jbq6g9"><!></li> <li class="p-1jbq6g9"><!></li>',1),cg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function dg(t,e){fe(e,!0);let a=Pe(e,"shownMenu",15),r=I(!1),o=I(!1),s=I(!1);const i=async()=>{e.onEdit()},l=()=>{n(o)?(f(o,!1),i()):n(s)&&(f(s,!1),e.onDelete()),a(!1),f(r,!1)};let d=ia||Ea;var u=de(),c=M(u);{var v=p=>{var m=cg(),_=M(m);ue(_,()=>({"--top":"90%","--right":"0px"})),Ir(_.lastChild,{get startClose(){return n(r)},onClosed:l,get isMobile(){return d},children:(x,w)=>{var k=lg(),O=M(k),y=C(O);qe(y,{onClick:()=>{f(o,!0),f(r,!0)},get dialogMode(){return d},children:(W,N)=>{var L=sg(),J=M(L);ue(J,()=>({"--size":"20px"})),me(J.lastChild,{name:"pen"}),h(W,L)},$$slots:{default:!0}});var T=D(O,2),R=C(T);qe(R,{onClick:()=>{f(s,!0),f(r,!0)},get dialogMode(){return d},children:(W,N)=>{var L=ig(),J=M(L);ue(J,()=>({"--size":"20px"})),me(J.lastChild,{name:"bin"}),h(W,L)},$$slots:{default:!0}}),h(x,k)},$$slots:{default:!0}}),h(p,m)};H(c,p=>{a()&&p(v)})}h(t,u),ve()}var ug=P('<div class="b p-7wvhwg"><!> <!> <div class="c p-7wvhwg"><button class="p-7wvhwg">Cancel</button> <button class="p-7wvhwg">Done</button></div></div>'),fg=P('<div class="e p-7wvhwg"><!></div>'),vg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),hg=P('<div class="d p-7wvhwg"><div><!> <a class="f p-7wvhwg" target="_blank" rel="noopener noreferrer"> </a> <div><!> <!></div> <!></div></div>'),pg=P('<div class="a p-7wvhwg"><!></div>');function mg(t,e){fe(e,!0);let a=Pe(e,"shownUrlInput",15);const{getFaviconEnabled:r}=er();let o=A(r),s=I(null),i=I(null),l=I(dt(e.url)),d=I(dt(e.title)),u=I(null),c=I(null),v=I(!1);const p=T=>{f(l,T.target.value||"",!0)},m=T=>{f(d,T.target.value||"",!0)};ze(()=>{a()&&n(s)?.focus()});const _=()=>{f(v,!0)},x=()=>{e.url&&(navigator.clipboard.writeText(e.url),ct("copied"))};var w=pg(),k=C(w);{var O=T=>{var R=ug(),W=C(R);Cr(W,{get value(){return n(l)},onInput:p,placeholder:"url",get ref(){return n(s)},set ref(K){f(s,K,!0)}});var N=D(W,2);Cr(N,{get value(){return n(d)},onInput:m,placeholder:"title"});var L=D(N,2),J=C(L);J.__click=()=>{f(l,e.url,!0),f(d,e.title,!0),a(!1)};var U=D(J,2);U.__click=()=>{let K=n(l).trim();K!==""&&/^[[a-zA-Z]+?:\/\//.test(K)===!1&&(K="https://"+K,f(l,K,!0)),e.onChangeUrl(K,n(d)),a(!1)},h(T,R)},y=T=>{var R=de(),W=M(R);{var N=J=>{var U=hg(),K=C(U);tt(K,1,rt({i:!0}),"p-7wvhwg");var Z=C(K);{var X=ne=>{var ae=fg(),ee=C(ae);fl(ee,{get url(){return e.url}}),h(ne,ae)};H(Z,ne=>{n(o)&&ne(X)})}var V=D(Z,2),ge=C(V),he=D(V,2);tt(he,1,rt({j:!0}),"p-7wvhwg");var $=C(he);Nn($,{title:"copy link",elem:"button",onclick:x,children:(ne,ae)=>{var ee=vg(),pe=M(ee);ue(pe,()=>({"--size":"20px"})),me(pe.lastChild,{name:"copy"}),h(ne,ee)},$$slots:{default:!0}});var j=D($,2);Nn(j,{title:"show menu",elem:"button",onclick:_,get ref(){return n(c)},set ref(ne){f(c,ne,!0)},children:(ne,ae)=>{var ee=gg(),pe=M(ee);ue(pe,()=>({"--size":"18px","--rotate":"90deg"})),me(pe.lastChild,{name:"menu"}),h(ne,ee)},$$slots:{default:!0}});var G=D(he,2);dg(G,{onDelete:()=>{f(d,""),f(l,""),e.onDeleteUrl()},onEdit:()=>{a(!0)},get shownMenu(){return n(v)},set shownMenu(ne){f(v,ne,!0)}}),Je(K,ne=>f(u,ne),()=>n(u)),Ce(()=>{at(V,"href",e.url),it(ge,e.title||"unknown")}),h(J,U)},L=J=>{};H(W,J=>{e.url?J(N):J(L,!1)})}h(T,R)};H(k,T=>{a()?T(O):T(y,!1)})}Je(w,T=>f(i,T),()=>n(i)),h(t,w),ve()}vt(["click"]);var _g=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),wg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),yg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),bg=P('<div class="g p-kjhysy">Note</div>'),Sg=P("<span> </span>"),Cg=P('<div class="k p-kjhysy"><!></div>'),kg=P('<div class="a p-kjhysy"><div class="b p-kjhysy"><!> <!></div></div> <!> <div class="c p-kjhysy"><div class="d"><div class="e"><div class="f p-kjhysy"><!> <div class="h p-kjhysy" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"> </div></div></div></div> <div class="i j p-kjhysy"><!> <div class="l p-kjhysy"><!></div></div></div>',1);function xg(t,e){fe(e,!0);const{checkMobileSize:a}=Da(),{getLlmTagsEnabled:r,getPrevTags:o,getPageDataForTagsEnabled:s}=er(),{pushDialogPage:i}=Jt();let l=Pe(e,"link",15,void 0),d=Pe(e,"text",15,""),u=Pe(e,"tags",31,()=>dt([])),c=Pe(e,"pinned",15,!1),v=I(null),p=I(!1),m=I(!1),_=I(dt(new Set)),x=I(!1);const w=g=>{let b="",S=!0;function E(F){for(let B=0;B<F.length;B++){const oe=F[B];if(oe.nodeName==="BR"){b+=`
`,S=!0;continue}oe.nodeName==="DIV"&&S===!1&&(b+=`
`),S=!1,oe.nodeType===3&&oe.textContent&&(b+=oe.textContent),E(oe.childNodes)}}E(g.currentTarget.childNodes),b===`
`&&(b=b.slice(0,-1)),d(b)},k=g=>{g.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(p)&&(f(p,!1),g.preventDefault(),g.stopPropagation()),n(m)&&(f(m,!1),g.preventDefault(),g.stopPropagation()))};we(()=>(a(),document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)));const O=(g,b)=>{l({url:g,title:b})},y=()=>{l(void 0)},T=g=>{u(g)},R=o(),W=()=>{u([...new Set([...u(),...R])])},N=d();we(()=>{if(n(v)&&(e.mode==="add"||!(ia||Ea))){n(v).focus();const g=document.createRange();g.selectNodeContents(n(v)),g.collapse(!1);const b=window.getSelection();b?.removeAllRanges(),b?.addRange(g)}});let L=I("unknown");const J=async()=>{if(typeof LanguageModel>"u"){f(L,"unavailable");return}f(L,await As().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),!0)};we(()=>{J()});let U=A(r),K=null;const Z=async()=>K||(K=await As().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),K),X=async()=>{if(n(L)==="downloadable"||n(L)==="downloading"){i(ye.Extension);return}f(x,!0);const g=await Z(),b={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},S=`
			Page information:
			Title: ${l()?.title||"N/A"}.
			URL: ${l()?.url||"N/A"}.
			Description: N/A.
			Note content: ${d()||"N/A"}.
			Dont return tags: ${[...n(_).size>0?Array.from(n(_)):[],...u().length>0?u():[]].join(", ")||"N/A"}.
			Page contents: N/A.
		`.slice(0,5e3),E=await g.prompt(S,{responseConstraint:b});u(Array.from(new Set([...u(),...(JSON.parse(E)?.tags||[]).map(F=>F.trim().toLowerCase()).filter(F=>F!=="")]))),f(x,!1)};var V=kg(),ge=M(V),he=C(ge),$=C(he);Nn($,{title:"menu",elem:"button",onclick:()=>{console.log("clicked")},children:(g,b)=>{var S=_g(),E=M(S);ue(E,()=>({"--size":"24px"})),me(E.lastChild,{name:"menu"}),h(g,S)},$$slots:{default:!0}});var j=D($,2);{var G=g=>{Nn(g,{title:"pin",elem:"button",onclick:()=>{c(!0)},children:(b,S)=>{var E=wg(),F=M(E);ue(F,()=>({"--size":"24px"})),me(F.lastChild,{name:"pin"}),h(b,E)},$$slots:{default:!0}})},ne=g=>{Nn(g,{title:"unpin",elem:"button",onclick:()=>{c(!1)},children:(b,S)=>{var E=yg(),F=M(E);ue(F,()=>({"--size":"24px"})),me(F.lastChild,{name:"pin-cancel"}),h(b,E)},$$slots:{default:!0}})};H(j,g=>{c()?g(ne,!1):g(G)})}var ae=D(ge,2);{let g=A(()=>l()?.url||""),b=A(()=>l()?.title||"");mg(ae,{get url(){return n(g)},get title(){return n(b)},onChangeUrl:O,onDeleteUrl:y,get shownUrlInput(){return n(m)},set shownUrlInput(S){f(m,S,!0)}})}var ee=D(ae,2),pe=C(ee),ce=C(pe),te=C(ce),Q=C(te);{var re=g=>{var b=bg();h(g,b)};H(Q,g=>{d()||g(re)})}var be=D(Q,2);be.__input=w;var Se=C(be);Je(be,g=>f(v,g),()=>n(v));var Te=D(pe,2),Ie=C(Te);{var Oe=g=>{var b=Cg(),S=C(b);{var E=F=>{var B=Sg(),oe=C(B);Ce(ke=>it(oe,`updated: ${ke??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),h(F,B)};H(S,F=>{e.updatedAt&&F(E)})}h(g,b)};H(Ie,g=>{e.mode==="edit"&&g(Oe)})}var Ee=D(Ie,2),le=C(Ee);{let g=A(()=>n(U)&&n(L)!=="unknown"&&n(L)!=="unavailable"),b=A(()=>e.mode==="add"&&R.length>0);ul(le,{get selectedTags(){return u()},onRejectedTag:S=>{f(_,new Set([...n(_),S]),!0)},onChangeTags:T,get genTagsEnabled(){return n(g)},onGenTags:X,get generatingTags(){return n(x)},onUsePreviousTags:W,get previousTagsEnabled(){return n(b)},get shownTagInput(){return n(p)},set shownTagInput(S){f(p,S,!0)}})}Ce(()=>it(Se,N)),h(t,V),ve()}vt(["input"]);function Tg(t,e){fe(e,!0);const{isInitedNotes:a,createNote:r,updateNote:o,deleteNote:s,getNoteById:i,pinNote:l}=zt(),{getViewMode:d,setPrevTags:u}=er(),{setSearchParam:c,deleteSearchParam:v,getSearchParams:p}=qt();let m=I("loading"),_=I("idle"),x=I(""),w=I(void 0),k=I(""),O=I(!1),y=I(dt([]));const T=()=>{{const U=p().get("url"),K=p().get("title"),Z=p().get("text");U&&f(w,{url:U,title:K||""},!0),Z&&f(k,Z,!0),v("url"),v("title"),v("text"),f(m,"finish");return}},R=A(()=>a()&&n(m)==="finish"),W=async()=>{if(n(w)?.title||n(w)?.url||n(k)||n(y).length>0){if(n(x)){const U=i(n(x));if(!U?.data)return;if((U.data.link?.url!==n(w)?.url||U.data.link?.title!==n(w)?.title||U.data.text!==n(k)||JSON.stringify(U.data.tags)!==JSON.stringify(n(y)))&&n(_)==="idle"){f(_,"loading");try{await o(n(x),{link:ga(n(w)),text:n(k),tags:n(y).slice()})}finally{f(_,"idle")}}}else if(n(_)==="idle"){f(_,"loading");try{f(x,await r({link:ga(n(w)),text:n(k),tags:n(y).slice()}),!0),c("noteId",n(x))}catch(U){console.error("Error creating note:",U)}finally{f(_,"idle")}}}else if(n(x)&&n(_)==="idle"){f(_,"loading");try{await s(n(x)),f(x,""),v("noteId")}finally{f(_,"idle")}}};ze(()=>{n(R)&&n(_)!=="loading"&&W()}),ze(()=>{n(R)&&n(_)!=="loading"&&n(x)&&(n(O),Ft(()=>{i(n(x))?.data.pinned!==n(O)&&l(n(x),n(O))}))}),we(()=>{T()}),we(()=>()=>{n(y).length>0&&u([...n(y)])}),we(()=>()=>{n(x)&&v("noteId")});var N=de(),L=M(N);{var J=U=>{xg(U,{mode:"add",get link(){return n(w)},set link(K){f(w,K,!0)},get text(){return n(k)},set text(K){f(k,K,!0)},get tags(){return n(y)},set tags(K){f(y,K,!0)},get pinned(){return n(O)},set pinned(K){f(O,K,!0)}})};H(L,U=>{n(R)&&U(J)})}h(t,N),ve()}const Eg="modulepreload",Pg=function(t){return"/"+t},zs={},kt=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let d=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");o=d(a.map(u=>{if(u=Pg(u),u in zs)return;zs[u]=!0;const c=u.endsWith(".css"),v=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${v}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":Eg,c||(p.as="script"),p.crossOrigin="",p.href=u,l&&p.setAttribute("nonce",l),document.head.appendChild(p),c)return new Promise((m,_)=>{p.addEventListener("load",m),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var Ng=P('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function Ag(t){var e=Ng(),a=D(C(e),2);It(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=Le("Reload");h(r,s)},$$slots:{default:!0}}),h(t,e)}var Mg=P('<div class="p-uzefkz"><!></div>');function Dg(t,e){fe(e,!0);let a=I(!1);const{getDialogPageHeight:r}=ls(),o=A(r);we(()=>{const d=setTimeout(()=>{f(a,!0)},250);return()=>{clearTimeout(d)}});var s=Mg(),i=C(s);{var l=d=>{Ia(d,{})};H(i,d=>{n(a)&&d(l)})}Ce(()=>$a(s,`min-height: ${n(o)??""}px;`)),h(t,s),ve()}function At(t,e){fe(e,!0);const a={},r=Object.assign({"./Pages/About.svelte":()=>kt(()=>import("./aC8tFh_2t.js"),__vite__mapDeps([0,1])),"./Pages/AccessKeys.svelte":()=>kt(()=>import("./aa5i5sX7f.js"),__vite__mapDeps([2,3,4,5])),"./Pages/Account.svelte":()=>kt(()=>import("./aCLuK-LO-.js"),__vite__mapDeps([6,3,7])),"./Pages/Auth.svelte":()=>kt(()=>import("./aD0aGCf9U.js"),__vite__mapDeps([8,9])),"./Pages/ChangeTags.svelte":()=>kt(()=>import("./aD3QHArN7.js"),[]),"./Pages/ConfirmAccessKey.svelte":()=>kt(()=>import("./altcAB6ym.js"),__vite__mapDeps([10,4,3,11,12])),"./Pages/Exit.svelte":()=>kt(()=>import("./aN0uO0GoH.js"),__vite__mapDeps([13,14])),"./Pages/ExportData.svelte":()=>kt(()=>import("./aDUOuLKRj.js"),__vite__mapDeps([15,16,17,18,19,20])),"./Pages/Extension.svelte":()=>kt(()=>import("./aDk-_3NDX.js"),__vite__mapDeps([21,18,19,22])),"./Pages/ImportData.svelte":()=>kt(()=>import("./ar2Gr3Y2Z.js"),__vite__mapDeps([23,24])),"./Pages/Install.svelte":()=>kt(()=>import("./aCM3gO_a_.js"),__vite__mapDeps([25,26])),"./Pages/InstallSuccess.svelte":()=>kt(()=>import("./aC1qkNCpj.js"),__vite__mapDeps([27,28])),"./Pages/Note.svelte":()=>kt(()=>import("./a6Pi4IEeB.js"),__vite__mapDeps([29,30])),"./Pages/Settings.svelte":()=>kt(()=>import("./aI7lqKR-d.js"),__vite__mapDeps([31,18,19,16,17,32])),"./Pages/Signin.svelte":()=>kt(()=>import("./aBRJ9mRdI.js"),__vite__mapDeps([33,4,3,11,34])),"./Pages/Signup.svelte":()=>kt(()=>import("./aCs_rTHGA.js"),__vite__mapDeps([35,11,4,3,34])),"./Pages/Subscription.svelte":()=>kt(()=>import("./aBcamt-sp.js"),__vite__mapDeps([36,37])),"./Pages/Sync.svelte":()=>kt(()=>import("./aDPKg83v4.js"),__vite__mapDeps([38,39]))}),o=async l=>{const d=`./Pages/${l[0].toUpperCase()+l.slice(1)}.svelte`;if(!a[l]){if(r[d]){const u=r[d]();return a[l]={promise:u},a[l].module=await u,a[l].module}throw new Error(`Page ${l} not found`)}return a[l].module||await a[l].promise};var s=de(),i=M(s);Wc(i,()=>o(e.page),l=>{Dg(l,{})},(l,d)=>{const u=A(()=>n(d).default);var c=de(),v=M(c);Yc(v,()=>n(u),(p,m)=>{m(p,{get params(){return e.params},get hidden(){return e.hidden}})}),h(l,c)},l=>{Ag(l)}),h(t,s),ve()}var nr,vl,gl;class Ig{constructor(e){Be(this,nr);Rt(this,"data");Rt(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),nt(this,nr,vl).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,nt(this,nr,gl).call(this)),e}isEmpty(){return this.data.length===0}}nr=new WeakSet,vl=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},gl=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class Lg{constructor(e,a){Rt(this,"heap");Rt(this,"done");Rt(this,"cache",[]);this.heap=new Ig(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var Rg=P("<span>Back to notes</span>"),Og=P('<div class="c p-1jdj5w3">No notes in bin</div> <div class="d p-1jdj5w3"><!></div>',1),Fg=P("<span>Back to notes</span>"),zg=P('<div class="c p-1jdj5w3">No notes in archive</div> <div class="d p-1jdj5w3"><!></div>',1),Bg=P('<p class="f">No notes in bin</p>'),jg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),Hg=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Ug=P('<div class="g p-1jdj5w3"><div class="d p-1jdj5w3"><!></div> <div>or</div> <div class="d p-1jdj5w3"><!></div></div>'),Wg=P('<div class="e p-1jdj5w3"><!></div>'),Vg=P('<div class="h"><div class="c p-1jdj5w3">No notes found</div></div>'),qg=P('<div class="i p-1jdj5w3"><ul class="p-1jdj5w3"></ul></div>'),Kg=P('<div class="a p-1jdj5w3"><div class="b p-1jdj5w3"><!></div></div>');function Yg(t,e){fe(e,!0);const{getCountDialog:a}=Zt(),{getScrollContainer:r}=go(),{createHandleClickDialogPage:o,createDialogPageHref:s}=Jt(),{getSelectedTags:i}=jn(),{getFeedOrder:l}=ji(),{checkNotesInArchive:d,checkNotesInBin:u,checkNotes:c,isInitedNotes:v}=zt(),{getSelectedMetaTags:p}=vo(),{replaceSearchParams:m,getHref:_}=qt();rs();const{getFiltredNotesLength:x,getFiltredNotes:w,getUpdatedFiltredNotesTimestamp:k}=Ma();let O=A(p),y=A(x),T=A(w),R=A(k),W=A(v),N=54,L=I(0),J=I(0),U=I(0),K=I(null),Z=A(r),X=null,V=null,ge=A(()=>n(O).has(Qe.ARCHIVED)?"archive":n(O).has(Qe.BIN)?"bin":"notes");const he=A(i);ze(()=>{n(he),n(ae),n(Z)?.scrollTo(0,0)});const{enable:$}=is(),j=()=>{$(),X||(X=requestAnimationFrame(()=>{const g=n(Z)?.scrollTop||0;f(U,g,!0);const b=Math.ceil(n(L)/N);f(J,Math.floor(g/(N*b))*(N*b)),X=null}))},G=()=>{V||(V=requestAnimationFrame(()=>{f(L,window.innerHeight-180||0,!0);const g=n(Z)?.scrollTop||0;f(U,g,!0);const b=Math.ceil(n(L)/N);f(J,Math.floor(g/(N*b))*(N*b)),V=null}))};we(()=>{const g=b=>{if(!(!Nv()&&Kr()===void 0)&&!(a()>0)&&(b.key==="ArrowDown"||b.key==="ArrowUp")){if(b.preventDefault(),b.key==="ArrowDown"){const S=Kr(),E=n(ce).findIndex(oe=>oe.id===S),F=be(),B=Se();if(!S||E===-1)Tn(F?.id);else if(E<=B.index&&E>=F.index)Os()&&E!==-1&&re(E+1)&&n(Z)&&(n(Z).scrollTop=Math.floor(n(Z).scrollTop/N)*N+N);else if(E>B.index&&!re(E-1)&&re(E)){n(Z)&&(n(Z).scrollTop=Math.ceil(n(Z).scrollTop/N)*N+N);const oe=Os();Tn(oe)}else Tn(F?.id)}else if(b.key==="ArrowUp"){const S=Kr(),E=n(ce).findIndex(oe=>oe.id===S),F=be(),B=Se();if(!S||E===-1)Tn(B?.id);else if(E<=B.index&&E>=F.index)Fs()&&E!==-1&&re(E-1)&&n(Z)&&(n(Z).scrollTop=Math.ceil(n(Z).scrollTop/N)*N-N);else if(E<F.index&&!re(E+1)&&re(E)){n(Z)&&(n(Z).scrollTop=n(Q)+E*N-N);const oe=Fs();Tn(oe)}else Tn(B?.id)}Go()||Ev()}};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}}),we(()=>{G(),j()});const ne=()=>{j()};ze(()=>(n(Z)?.addEventListener("scroll",ne),window.addEventListener("resize",G),()=>{n(Z)?.removeEventListener("scroll",ne),window.removeEventListener("resize",G)}));const ae=A(l);ze(()=>{n(ae),n(R),f(K,new Lg(n(T),(g,b)=>{if(!g||!b||!g.data||!b.data)return 0;if(g.data.pinned&&!b.data.pinned)return-1;if(!g.data.pinned&&b.data.pinned)return 1;if(g.data.pinned&&b.data.pinned){if(g.data.pinned<b.data.pinned)return 1;if(g.data.pinned>b.data.pinned)return-1}const S=(E,F)=>E.data.text||F.data.text?(E.data.text||"").localeCompare(F.data.text||""):(E.data.link?.title||"").localeCompare(F.data.link?.title||"");switch(n(ae)){case"newest":return g.data.createdAt<b.data.createdAt?1:g.data.createdAt>b.data.createdAt?-1:S(g,b);case"oldest":return g.data.createdAt>b.data.createdAt?1:g.data.createdAt<b.data.createdAt?-1:S(g,b);case"AtoZ":return S(g,b);case"ZtoA":return S(b,g);case"updatedNewest":return g.data.updatedAt<b.data.updatedAt?1:g.data.updatedAt>b.data.updatedAt?-1:S(g,b);case"updatedOldest":return g.data.updatedAt>b.data.updatedAt?1:g.data.updatedAt<b.data.updatedAt?-1:S(g,b);default:return 0}}),!0)});const ee=A(()=>n(y)*N);let ce=A(()=>{n(R);const g=Math.ceil(n(L)/N);let b=Math.floor(n(J)/N);return b=b-Math.min(b,g),n(K)?.get(b,b+g*3)||[]}),te=A(()=>N*Math.ceil(n(L)/N));const Q=A(()=>n(J)-Math.min(n(J),n(te))),re=g=>g*N<n(U)-n(Q)-N/2||g*N>n(U)-n(Q)+Math.floor(n(L)/N)*N,be=()=>{for(let g=0;g<n(ce).length;g++)if(!re(g))return{index:g,id:n(ce)[g].id};return{index:-1,id:void 0}},Se=()=>{for(let g=n(ce).length-1;g>=0;g--)if(!re(g))return{index:g,id:n(ce)[g].id};return{index:-1,id:void 0}};ze(()=>{console.log("focusMode",Go())});var Te=Kg(),Ie=C(Te),Oe=C(Ie);{var Ee=g=>{Ia(g,{})},le=g=>{var b=de(),S=M(b);{var E=B=>{var oe=Og(),ke=D(M(oe),2),ie=C(ke);{let q=A(()=>_(""));It(ie,{element:"a",get href(){return n(q)},onClick:Y=>{Y.preventDefault(),m("")},children:(Y,se)=>{var _e=Rg();h(Y,_e)},$$slots:{default:!0}})}h(B,oe)},F=B=>{var oe=de(),ke=M(oe);{var ie=Y=>{var se=zg(),_e=D(M(se),2),Ve=C(_e);{let Fe=A(()=>_(""));It(Ve,{element:"a",get href(){return n(Fe)},onClick:Ae=>{Ae.preventDefault(),m("")},children:(Ae,mt)=>{var He=Fg();h(Ae,He)},$$slots:{default:!0}})}h(Y,se)},q=Y=>{var se=de(),_e=M(se);{var Ve=Ae=>{var mt=Wg(),He=C(mt);{var xe=Ne=>{var Ue=Bg();h(Ne,Ue)},Me=Ne=>{var Ue=Ug(),gt=C(Ue),je=C(gt);{let $e=A(()=>s(ye.NewNote)),ot=A(()=>o(ye.NewNote));It(je,{element:"a",get href(){return n($e)},get onClick(){return n(ot)},children:(Bt,st)=>{var yt=jg(),lt=M(yt);ue(lt,()=>({"--size":"18px","--color":"#b0b0b0"})),me(lt.lastChild,{name:"plus"}),h(Bt,yt)},$$slots:{default:!0}})}var Ke=D(gt,4),ht=C(Ke);{let $e=A(()=>s(ye.ImportData)),ot=A(()=>o(ye.ImportData));It(ht,{element:"a",get href(){return n($e)},get onClick(){return n(ot)},children:(Bt,st)=>{var yt=Hg(),lt=M(yt);ue(lt,()=>({"--size":"18px","--color":"#b0b0b0"})),me(lt.lastChild,{name:"import"}),h(Bt,yt)},$$slots:{default:!0}})}h(Ne,Ue)};H(He,Ne=>{n(ge)==="bin"?Ne(xe):Ne(Me,!1)})}h(Ae,mt)},Fe=Ae=>{var mt=de(),He=M(mt);{var xe=Ne=>{var Ue=Vg();h(Ne,Ue)},Me=Ne=>{var Ue=qg(),gt=C(Ue);Rn(gt,23,()=>n(ce),je=>je.data,(je,Ke,ht)=>{var $e=de(),ot=M($e);{var Bt=st=>{{let yt=A(()=>n(ce)[n(ht)+1]?.id),lt=A(()=>n(ce)[n(ht)-1]?.id),St=A(()=>re(n(ht))),La=A(()=>(n(ht)+5)*N<n(U)-n(Q)-N/2||(n(ht)+5)*N>n(U)-n(Q)+Math.floor(n(L)/N)*N);Hv(st,{get nextNoteId(){return n(yt)},get prevNoteId(){return n(lt)},get mode(){return n(ge)},get focusHidden(){return n(St)},get showMenuUp(){return n(La)},get noteId(){return n(Ke).id},get noteData(){return n(Ke).data}})}};H(ot,st=>{n(Ke).data&&st(Bt)})}h(je,$e)}),Ce(je=>{$a(Ue,je),$a(gt,`transform: translateY(${n(Q)??""}px);`)},[()=>`--minHeight: ${Math.max((n(ee)>n(L),n(ee)),0)}px`]),h(Ne,Ue)};H(He,Ne=>{n(ce).length===0?Ne(xe):Ne(Me,!1)},!0)}h(Ae,mt)};H(_e,Ae=>{!u()&&!d()&&!c()?Ae(Ve):Ae(Fe,!1)},!0)}h(Y,se)};H(ke,Y=>{n(ge)==="archive"&&!d()?Y(ie):Y(q,!1)},!0)}h(B,oe)};H(S,B=>{n(ge)==="bin"&&!u()?B(E):B(F,!1)},!0)}h(g,b)};H(Oe,g=>{n(W)?g(le,!1):g(Ee)})}h(t,Te),ve()}var Gg=P('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Xg(t){var e=Gg(),a=D(M(e),2),r=C(a);Yg(r,{}),h(t,e)}function Jg(t,e){fe(e,!0);const a=Hn();let r=Pe(e,"animationRef",7),o=Pe(e,"dialog",7);dl(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let u=0,c=0,v=()=>1;if(r().current){r().current.pause();let m=Number(r().current.currentTime);br()&&(m=Number(m)+50,r().current.currentTime=Math.min(Math.max(On-1,m),m));const _=r().current.effect?.getComputedTiming().progress||0;v=()=>_,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(m=>requestAnimationFrame(m)),c=1-v();const p=c*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-c)*.1}`),a.swipingRatio=Math.abs(1-c)*25,a.isSwiping=!0,a.duration=0,o().style.transform=`translate3d(${p}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:u,currentPosition:p,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:u,width:c})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-u/c)*.1}`),o().style.transform=`translate3d(${u}px, 0, 0)`,a.swipingRatio=Math.abs(1-u/c)*25)},onFinish:({swipeVelocity:u,currentPosition:c,width:v,actionThreshold:p,initialPosition:m})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const _=()=>Math.abs(m+c)/v*100;let x=null;if(u<=-oa?x="open":u>=oa?x="close":x=Math.abs(_())>p?"close":"open",r().progress=cl(_()/100),x==="close"){const w=(1-(r().progress||0))*On;a.duration=w/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=0,e.onClose()}else{const w=(r().progress||1)*On;a.duration=w/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=25,e.onOpen()}}}),ve()}var Zg=P('<div class="d p-1y54onh"> </div>'),Qg=P('<button class="e f p-1y54onh"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),$g=P('<a class="e g p-1y54onh"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),eh=P('<div><div class="a p-1y54onh"><div class="b p-1y54onh"><div class="c p-1y54onh"><!> <!> <!></div></div></div> <!> <!></div>'),th=P("<dialog><!></dialog> <!>",1);function nh(t,e){fe(e,!0);const{isScrolling:a,enable:r}=is();let o=I(null),s=I(null),i={};const l=Hn(),{checkLeftEnd:d,checkLeftStart:u,setLeftEnd:c,setLeftStart:v,getCountDialog:p}=Zt(),m=A(u),_=A(d);let x=A(()=>l.working);const w=()=>{e.dialogState!=="opened"&&e.onStartOpening()},k=()=>{e.onClose()},O=()=>{e.onSwipe()},y=Z=>{Z.preventDefault(),k()};we(()=>(n(o)?.addEventListener("close",k),n(o)?.addEventListener("cancel",y),()=>{n(o)?.removeEventListener("close",k),n(o)?.removeEventListener("cancel",y)})),ze(()=>{p()>0&&(l.swipingRatio=25)}),ze(()=>{e.dialogState==="opening"?Ft(()=>{requestAnimationFrame(()=>{if(!n(o))return;const Z=(i.progress||1)*On,X=n(o).style.transform||`translate3d(${n(m)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const V=n(o)?.animate([{transform:X},{transform:"translate3d(0, 0, 0)"}],{duration:Z,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=V,V&&(V.onfinish=()=>{e.onOpened(),l.swipingRatio=25,n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=ra().duration,V.cancel(),i.current=void 0,i.progress=void 0,n(m)&&v(!1)})})}):e.dialogState==="closing"&&Ft(()=>{requestAnimationFrame(()=>{if(!n(o))return;l.swipingRatio=0;const Z=(1-(i.progress||0))*On,X=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const V=n(o)?.animate([{transform:X},{transform:`translate3d(${n(_)?"-100%":"100%"}, 0, 0)`}],{duration:Z,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=V,V&&(V.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=ra().duration,V.cancel(),i.current=void 0,i.progress=void 0,n(_)&&c(!1)})})})});const T=()=>{r()},R=A(a);we(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),br()&&n(o).getBoundingClientRect(),!n(x)){e.onOpened();return}e.onStartOpening()}});var W=th(),N=M(W),L=C(N);{var J=Z=>{var X=eh(),V=C(X),ge=C(V),he=C(ge),$=C(he);{var j=Q=>{var re=Zg(),be=C(re);Ce(()=>it(be,e.title)),h(Q,re)};H($,Q=>{e.title&&Q(j)})}var G=D($,2);{var ne=Q=>{var re=Qg();re.__click=k;var be=C(re);ue(be,()=>({"--size":"32px"})),me(be.lastChild,{name:"back"});var Se=D(be,2);pt(Se,{children:(Te,Ie)=>{var Oe=Le("back");h(Te,Oe)}}),h(Q,re)};H(G,Q=>{e.blocked||Q(ne)})}var ae=D(G,2);{var ee=Q=>{var re=$g();re.__click=function(...Te){e.onOpenWindow?.apply(this,Te)};var be=C(re);ue(be,()=>({"--scale":"0.7","--size":"32px"})),me(be.lastChild,{name:"open-window"});var Se=D(be,2);pt(Se,{children:(Te,Ie)=>{var Oe=Le("open window");h(Te,Oe)}}),Ce(()=>at(re,"href",e.openWindowHref)),h(Q,re)};H(ae,Q=>{e.onOpenWindow&&Q(ee)})}var pe=D(V,2);De(pe,()=>e.children);var ce=D(pe,2);{var te=Q=>{cs(Q,{})};H(ce,Q=>{e.dialogState==="opened"&&Q(te)})}Je(X,Q=>f(s,Q),()=>n(s)),Ce(()=>tt(X,1,rt({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-1y54onh")),ln("scroll",X,T),h(Z,X)};H(L,Z=>{e.dialogState!=="preOpening"&&Z(J)})}Je(N,Z=>f(o,Z),()=>n(o));var U=D(N,2);{var K=Z=>{Jg(Z,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:w,onClose:k,onSwipe:O,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};H(U,Z=>{n(s)&&!n(R)&&!e.blocked&&!e.hidden&&Z(K)})}Ce(()=>tt(N,1,rt({h:!0,i:n(x),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(m),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-1y54onh")),h(t,W),ve()}vt(["click"]);function ah(t,e){fe(e,!0);let a=Pe(e,"hidden",3,!1),r=Pe(e,"onClosed",3,()=>{}),o=I(0);we(()=>{const k=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",k),k(),()=>{window.removeEventListener("resize",k)}});const{dialogDec:s,dialogInc:i}=Zt(),l=Hn();we(()=>(i(),()=>{s()}));let d=I("closed");const u=()=>{f(d,"opening")},c=()=>{f(d,"swiping")},v=()=>{f(d,"opened")},p=()=>{e.onClose(),f(d,"closing")},m=()=>{f(d,"closed"),r()()};ze(()=>{e.shown&&n(d)==="closed"?f(d,"preOpening"):!e.shown&&n(d)==="opened"&&f(d,"closing")}),ze(()=>{n(d)==="closed"?(l.swipingRatio=0,l.duration=.2):(n(d)==="opened"||n(d)==="opening")&&(l.duration=.2,l.swipingRatio=25)});var _=de(),x=M(_);{var w=k=>{nh(k,{get dialogWidth(){return n(o)},get dialogState(){return n(d)},get title(){return e.title},onStartOpening:u,onOpened:v,onClose:p,onClosed:m,onSwipe:c,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(O,y)=>{var T=de(),R=M(T);De(R,()=>e.children),h(O,T)},$$slots:{default:!0}})};H(x,k=>{n(d)!=="closed"&&k(w)})}h(t,_),ve()}const rh=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};we(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),we(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var oh=P('<button class="d e p-rzygzf"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),sh=P('<div class="f p-rzygzf"> </div>'),ih=P('<button class="d g p-rzygzf"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),lh=P('<dialog><div class="a p-rzygzf"><div class="b p-rzygzf"><div class="c p-rzygzf"><div><!></div> <!> <div><!></div></div></div> <!></div></dialog> <!>',1);function ch(t,e){fe(e,!0);let a=Pe(e,"blockedDialog",3,!1),r=Pe(e,"hiddenDialog",3,!1),o=Pe(e,"isDesktopAnimationOff",3,!1),s=I(null),i=I(null),l=I(!1);rh({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const d=Hn();ze(()=>{e.stateDialog==="closing"&&(d.working?n(s)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const{getDialogPageHeight:u}=ls(),c=A(u);we(()=>{setTimeout(()=>{f(l,!0)},50)});var v=lh(),p=M(v),m=C(p),_=C(m),x=C(_),w=C(x),k=C(w);{var O=U=>{var K=oh();K.__click=()=>{e.onStartBack()};var Z=C(K);ue(Z,()=>({"--size":"28px"})),me(Z.lastChild,{name:"back"});var X=D(Z,2);pt(X,{children:(V,ge)=>{var he=Le("back");h(V,he)}}),h(U,K)};H(k,U=>{(!(a()||r())||a())&&e.onStartBack&&U(O)})}var y=D(w,2);{var T=U=>{var K=sh(),Z=C(K);Ce(()=>it(Z,e.title)),h(U,K)};H(y,U=>{e.title&&U(T)})}var R=D(y,2),W=C(R);{var N=U=>{var K=ih();K.__click=()=>{e.onStartClose()};var Z=C(K);ue(Z,()=>({"--size":"28px"})),me(Z.lastChild,{name:"close"});var X=D(Z,2);pt(X,{children:(V,ge)=>{var he=Le("close");h(V,he)}}),h(U,K)};H(W,U=>{a()||r()||U(N)})}var L=D(_,2);De(L,()=>e.children),Je(m,U=>f(i,U),()=>n(i)),Je(p,U=>f(s,U),()=>n(s));var J=D(p,2);ds(J,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose}}),Ce(()=>{$a(p,`height: ${n(c)+74}px`),tt(p,1,rt({h:!0,i:e.stateDialog==="open",j:n(l),k:d.working,l:o(),m:r()}),"p-rzygzf")}),h(t,v),ve()}vt(["click"]);const dh=({onStartClose:t,onClosed:e})=>{let a=I("close");return{get state(){return n(a)},set state(i){f(a,i,!0)},handleStartClose:(i=!1)=>{i||(f(a,"closing"),t?.())},handleOpen:()=>{f(a,"open")},handleClose:()=>{f(a,"close"),e?.()}}};function uh(t,e){fe(e,!0);let a=Pe(e,"blockedDialog",3,!1),r=Pe(e,"hiddenDialog",3,!1),o=Pe(e,"onStartClose",3,()=>{}),s=Pe(e,"onClosed",3,()=>{}),i=dh({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:l,dialogInc:d}=Zt();we(()=>(d(),()=>{l()})),ze(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const u=m=>{m.key==="Escape"&&a()&&(m.preventDefault(),m.stopPropagation())};we(()=>(document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}));var c=de(),v=M(c);{var p=m=>{ch(m,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(_,x)=>{var w=de(),k=M(w);De(k,()=>e.children),h(_,w)},$$slots:{default:!0}})};H(v,m=>{i.state!=="close"&&m(p)})}h(t,c),ve()}const Bs=(t,e=Ye,a=Ye,r)=>{let o=Pr(()=>Al(r?.(),!1));var s=de(),i=M(s);{var l=u=>{bt(u,{children:(c,v)=>{At(c,{get hidden(){return n(o)},get page(){return ye.Settings}})},$$slots:{default:!0}})},d=u=>{var c=de(),v=M(c);{var p=_=>{bt(_,{children:(x,w)=>{Tg(x,{})},$$slots:{default:!0}})},m=_=>{var x=de(),w=M(x);{var k=y=>{bt(y,{children:(T,R)=>{At(T,{get params(){return a()},get hidden(){return n(o)},get page(){return ye.Note}})},$$slots:{default:!0}})},O=y=>{var T=de(),R=M(T);{var W=L=>{bt(L,{children:(J,U)=>{At(J,{get hidden(){return n(o)},get page(){return ye.ImportData}})},$$slots:{default:!0}})},N=L=>{var J=de(),U=M(J);{var K=X=>{bt(X,{children:(V,ge)=>{At(V,{get hidden(){return n(o)},get page(){return ye.ExportData}})},$$slots:{default:!0}})},Z=X=>{var V=de(),ge=M(V);{var he=j=>{bt(j,{children:(G,ne)=>{og(G,{})},$$slots:{default:!0}})},$=j=>{var G=de(),ne=M(G);{var ae=pe=>{bt(pe,{children:(ce,te)=>{At(ce,{get hidden(){return n(o)},get page(){return ye.Install}})},$$slots:{default:!0}})},ee=pe=>{var ce=de(),te=M(ce);{var Q=be=>{bt(be,{children:(Se,Te)=>{At(Se,{get hidden(){return n(o)},get page(){return ye.InstallSuccess}})},$$slots:{default:!0}})},re=be=>{var Se=de(),Te=M(Se);{var Ie=Ee=>{bt(Ee,{children:(le,g)=>{At(le,{get hidden(){return n(o)},get page(){return ye.Auth}})},$$slots:{default:!0}})},Oe=Ee=>{var le=de(),g=M(le);{var b=E=>{bt(E,{children:(F,B)=>{At(F,{get hidden(){return n(o)},get page(){return ye.Signup}})},$$slots:{default:!0}})},S=E=>{var F=de(),B=M(F);{var oe=ie=>{bt(ie,{children:(q,Y)=>{At(q,{get hidden(){return n(o)},get page(){return ye.Signin}})},$$slots:{default:!0}})},ke=ie=>{var q=de(),Y=M(q);{var se=Ve=>{bt(Ve,{children:(Fe,Ae)=>{At(Fe,{get hidden(){return n(o)},get page(){return ye.AccessKeys}})},$$slots:{default:!0}})},_e=Ve=>{var Fe=de(),Ae=M(Fe);{var mt=xe=>{bt(xe,{children:(Me,Ne)=>{At(Me,{get hidden(){return n(o)},get page(){return ye.Account}})},$$slots:{default:!0}})},He=xe=>{var Me=de(),Ne=M(Me);{var Ue=je=>{bt(je,{children:(Ke,ht)=>{At(Ke,{get hidden(){return n(o)},get page(){return ye.ConfirmAccessKey}})},$$slots:{default:!0}})},gt=je=>{var Ke=de(),ht=M(Ke);{var $e=Bt=>{bt(Bt,{children:(st,yt)=>{At(st,{get hidden(){return n(o)},get page(){return ye.Exit}})},$$slots:{default:!0}})},ot=Bt=>{var st=de(),yt=M(st);{var lt=St=>{var La=de(),da=M(La);{var ua=Ra=>{bt(Ra,{children:(Lr,us)=>{At(Lr,{get hidden(){return n(o)},get page(){return ye.Sync}})},$$slots:{default:!0}})},hl=Ra=>{var Lr=de(),us=M(Lr);{var pl=Oa=>{bt(Oa,{children:(Rr,fs)=>{At(Rr,{get hidden(){return n(o)},get page(){return ye.Subscription}})},$$slots:{default:!0}})},ml=Oa=>{var Rr=de(),fs=M(Rr);{var _l=Fa=>{bt(Fa,{children:(mo,yl)=>{At(mo,{get hidden(){return n(o)},get page(){return ye.About}})},$$slots:{default:!0}})},wl=Fa=>{bt(Fa,{children:(mo,yl)=>{eg(mo,{})},$$slots:{default:!0}})};H(fs,Fa=>{e()===ye.About?Fa(_l):Fa(wl,!1)},!0)}h(Oa,Rr)};H(us,Oa=>{e()===ye.Subscription?Oa(pl):Oa(ml,!1)},!0)}h(Ra,Lr)};H(da,Ra=>{e()===ye.Sync?Ra(ua):Ra(hl,!1)},!0)}h(St,La)};H(yt,St=>{e(),ye.Extension,St(lt,!1)},!0)}h(Bt,st)};H(ht,Bt=>{e()===ye.Exit?Bt($e):Bt(ot,!1)},!0)}h(je,Ke)};H(Ne,je=>{e()===ye.ConfirmAccessKey?je(Ue):je(gt,!1)},!0)}h(xe,Me)};H(Ae,xe=>{e()===ye.Account?xe(mt):xe(He,!1)},!0)}h(Ve,Fe)};H(Y,Ve=>{e()===ye.AccessKeys?Ve(se):Ve(_e,!1)},!0)}h(ie,q)};H(B,ie=>{e()===ye.Signin?ie(oe):ie(ke,!1)},!0)}h(E,F)};H(g,E=>{e()===ye.Signup?E(b):E(S,!1)},!0)}h(Ee,le)};H(Te,Ee=>{e()===ye.Auth?Ee(Ie):Ee(Oe,!1)},!0)}h(be,Se)};H(te,be=>{e()===ye.InstallSuccess?be(Q):be(re,!1)},!0)}h(pe,ce)};H(ne,pe=>{e()===ye.Install?pe(ae):pe(ee,!1)},!0)}h(j,G)};H(ge,j=>{e()===ye.AccountSetup?j(he):j($,!1)},!0)}h(X,V)};H(U,X=>{e()===ye.ExportData?X(K):X(Z,!1)},!0)}h(L,J)};H(R,L=>{e()===ye.ImportData?L(W):L(N,!1)},!0)}h(y,T)};H(w,y=>{e()===ye.Note?y(k):y(O,!1)},!0)}h(_,x)};H(v,_=>{e()===ye.NewNote?_(p):_(m,!1)},!0)}h(u,c)};H(i,u=>{e()===ye.Settings?u(l):u(d,!1)})}h(t,s)};var fh=P("<!> <!>",1);function vh(t,e){fe(e,!0);let a=A(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:r,checkClosableDialog:o}=Zt(),{sidebarClose:s,getSidebarState:i}=Mr(),l=A(r),d=A(o),{getDialogPages:u}=Jt(),{getAccount:c}=ss();let v=A(u),p=A(()=>c()!==void 0);const{checkMobileSize:m}=Da();let _=I(dt([]));const x=A(m),{clearDialogPages:w,popDialogPage:k}=Jt(),{checkLeftStart:O}=Zt();let y=A(O);ze(()=>{u().length>0&&i()!=="closed"&&setTimeout(()=>{s()},60)});const T=()=>{k()},R=()=>{w()};ze(()=>{n(v),n(x),Ft(()=>{if(n(x))n(v).length>=n(_).length||n(y)?f(_,n(v).map(X=>({page:X,shown:!0})),!0):f(_,n(_).map((X,V)=>({page:X.page,shown:V<n(v).length})),!0);else if(n(v).length>=n(_).length)f(_,n(v).map(X=>({page:X,shown:!0})),!0);else{if(n(v).length===0){f(_,[{page:n(_)[n(_).length-1].page,shown:!1}],!0);return}f(_,n(v).map(X=>({page:X,shown:!0})),!0)}})});const W=()=>{f(_,n(v).map(X=>({page:X,shown:!0})),!0)};var N=fh(),L=M(N);{var J=X=>{Xg(X)};H(L,X=>{n(p)&&X(J)})}var U=D(L,2);{var K=X=>{var V=de(),ge=M(V);Rn(ge,19,()=>n(_),he=>he.page,(he,$,j)=>{const G=A(()=>n($).page.split("?")[1]),ne=A(()=>n($).page.split("?")[0]),ae=A(()=>n(j)!==n(_).length-1&&!!n(_)[n(j)+1]?.shown),ee=A(()=>n(j)===0);{let pe=A(()=>Ns[n(ne)]||""),ce=A(()=>n(l)||n(ee)&&!n(d));ah(he,Oo({get shown(){return n($).shown},get title(){return n(pe)},get hidden(){return n(ae)},get blocked(){return n(ce)},onClose:T,onClosed:W},()=>n(a),{children:(te,Q)=>{Bs(te,()=>n(ne),()=>n(G),()=>n(ae))},$$slots:{default:!0}}))}}),h(X,V)},Z=X=>{var V=de(),ge=M(V);{var he=$=>{const j=A(()=>n(_)[n(_).length-1].page.split("?")[1]),G=A(()=>n(_)[n(_).length-1].page.split("?")[0]),ne=A(()=>n(_)[n(_).length-1].shown),ae=A(()=>n(_).length===1);{let ee=A(()=>Ns[n(G)]||""),pe=A(()=>n(l)||!n(d)),ce=A(()=>n(l)||n(ae)?void 0:T);uh($,{get shownDialog(){return n(ne)},get title(){return n(ee)},get blockedDialog(){return n(pe)},hiddenDialog:!1,get onStartBack(){return n(ce)},onStartClose:R,onClosed:W,children:(te,Q)=>{Bs(te,()=>n(G),()=>n(j))},$$slots:{default:!0}})}};H(ge,$=>{n(_).length>0&&$(he)},!0)}h(X,V)};H(U,X=>{m()?X(K):X(Z,!1)})}h(t,N),ve()}function gh(t,e){fe(e,!1);let a=0;we(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),as(),ve()}const hh=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;var ph=P('<div><button class="d p-1521g4r"><!> <span class="e p-1521g4r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),mh=P('<!> <!> <!> <!> <main><div class="a p-1521g4r"><div class="b p-1521g4r"><!></div></div> <div class="c p-1521g4r"><!></div></main> <!>',1);function _h(t,e){fe(e,!0);const{replaceSearchParams:a,getHref:r,getSearchParams:o}=qt(),{hasDialogPage:s}=Jt(),{setScrollContainer:i}=go(),{getAccount:l,init:d}=ss(),{isInitedNotes:u}=zt(),{isInitedSettings:c}=er(),{getDialogPages:v}=Jt(),{createBroadcastChannel:p,tabId:m}=fo(),_=p(),{getSidebarState:x}=Mr(),{setClosableDialog:w}=Zt(),{getViewMode:k}=er(),O=()=>{hh()?a(`${en}=${ye.AccountSetup}`):a(`${en}=${ye.Install}`)};we(()=>{d(b=>{b===void 0?O():(s(ye.AccountSetup)&&a(""),b?f(N,b):f(N,null))});const g=async b=>{const S=JSON.parse(b.data);if(S.tabId&&S.tabId===m)return;const E=S;E.type==="initLocalAccount"||E.type==="initCloudAccount"||E.type==="updateAccount"||E.type==="disconnectCloudAccount"?a(""):E.type==="exit"&&O()};return _.addEventListener(g),()=>_.removeEventListener(g)});const y=Hn();we(async()=>{await new Promise(g=>setTimeout(g,60)),await Ni(),y.working=!0});let T=I(!1),R=0,W=A(()=>v().length>0),N=A(l),L=A(u),J=A(c),U=I(null);const K=()=>{n(U)&&n(U).scrollTo({top:0})};ze(()=>{w(n(N)!==void 0)}),ze(()=>{i(n(U))});const Z=()=>{if(n(U)){const g=n(U).scrollTop||0;g===0?f(T,!1):!n(T)&&R>g?f(T,!0):n(T)&&R+50<g&&f(T,!1),R=g}},X=()=>{Z()};ze(()=>(n(U)?.addEventListener("scroll",X),window.addEventListener("resize",X),()=>{n(U)?.removeEventListener("scroll",X),window.removeEventListener("resize",X)}));const V=A(x);let ge=A(()=>y.swipingRatio);const he=()=>{const g=new URLSearchParams(o());return r(g)},$=async()=>{};we(()=>{});const j=A(k),G=A(()=>n(j)==="popup"||n(j)==="sidebar"?{onOpenWindow:$,openWindowHref:he()}:{});var ne=mh(),ae=M(ne);gh(ae,{});var ee=D(ae,2);Iu(ee,{});var pe=D(ee,2);cs(pe,{});var ce=D(pe,2);ef(ce,{});var te=D(ce,2),Q=C(te),re=C(Q),be=C(re);{var Se=g=>{Zv(g,Oo(()=>n(G)))};H(be,g=>{n(J)&&n(N)!==void 0&&g(Se)})}var Te=D(Q,2),Ie=C(Te);{var Oe=g=>{vh(g,Oo(()=>n(G)))};H(Ie,g=>{n(L)&&n(J)&&g(Oe)})}Je(te,g=>f(U,g),()=>n(U));var Ee=D(te,2);{var le=g=>{var b=ph(),S=C(b);S.__click=K;var E=C(S);pt(E,{children:(oe,ke)=>{var ie=Le("top");h(oe,ie)}});var F=D(E,2),B=C(F);ue(B,()=>({"--rotate":"90deg","--size":"28px"})),me(B.lastChild,{name:"back"}),Ce(()=>{$a(b,`--swiping-ratio: ${n(ge)}; --transition-timing-default: ${y.duration}s;`),tt(b,1,rt({i:!0,g:y.working&&!y.isSwiping,j:n(W)||n(V)!=="closed"}),"p-1521g4r")}),h(g,b)};H(Ee,g=>{n(T)&&g(le)})}Ce(()=>{$a(te,`--swiping-ratio: ${n(ge)}; --transition-timing-default: ${y.duration}s;`),tt(te,1,rt({f:!0,g:y.working&&!y.isSwiping,h:n(V)!=="closed"}),"p-1521g4r")}),h(t,ne),ve()}vt(["click"]);function wh(t){ou(t,{children:(e,a)=>{_h(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||Bc(wh,{target:document.getElementById("app")});export{Ct as $,A,It as B,qt as C,ss as D,as as E,Cr as F,ln as G,ng as H,me as I,zt as J,Da as K,Ia as L,er as M,ul as N,As as O,ye as P,xh as Q,Kn as R,Je as S,Ph as T,Eh as U,pt as V,hu as W,pu as X,en as Y,br as Z,Ft as _,f as a,ga as a0,xg as a1,fo as a2,Ch as a3,kh as a4,hh as a5,Sh as a6,Pe as a7,$a as a8,Th as a9,I as b,C as c,ue as d,Rn as e,P as f,n as g,at as h,h as i,H as j,tt as k,rt as l,ve as m,M as n,we as o,fe as p,it as q,vt as r,D as s,Ce as t,Jt as u,Zt as v,dt as w,ze as x,de as y,Le as z};
