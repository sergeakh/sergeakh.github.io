const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/aBFK2OD0c.js","a/aCeYg3FOS.css","a/aKb-CCxMu.js","a/a9q_jSmK4.js","a/abA9hIFUQ.js","a/aBrkJtqMH.css","a/abNIc73T1.js","a/aDB02xhFr.css","a/aBWMkumg6.js","a/a54d_SC5m.css","a/a8AYUTgY9.js","a/aCpa8lgv9.js","a/afGUkjeV7.css","a/aD6qr25Bx.js","a/aiSyTfFbW.css","a/aDohM3usH.js","a/aD7osDIoR.js","a/aCpd7MTd8.css","a/aDO6isUbF.js","a/aenMKNzfI.css","a/aC969LWc5.css","a/aCbsXKhlE.js","a/aCeh8XjKC.css","a/asWMTxMv7.js","a/aCBPoPn5g.css","a/aDm_ouFG4.js","a/aK1a0NeEW.css","a/aB1OC1vIG.js","a/aBem4Ctjp.css","a/aDTV5J8_R.js","a/aBdnakgrk.css","a/aDY53p3fn.js","a/aDzsMVVo5.css","a/aBg_YOFdy.js","a/aCH18nfIo.css","a/aDRSS6QYD.js","a/aDizyi0XY.js","a/aCb6DfA6m.css","a/aB0rYZ7t7.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var Tl=Object.defineProperty;var gs=t=>{throw TypeError(t)};var Pl=(t,e,a)=>e in t?Tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var jt=(t,e,a)=>Pl(t,typeof e!="symbol"?e+"":e,a),yo=(t,e,a)=>e.has(t)||gs("Cannot "+a);var V=(t,e,a)=>(yo(t,e,"read from private field"),a?a.call(t):e.get(t)),Ke=(t,e,a)=>e.has(t)?gs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),Ue=(t,e,a,r)=>(yo(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),dt=(t,e,a)=>(yo(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const El=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};El(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const Nl=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};Nl();const xo=!1;var $o=Array.isArray,Al=Array.prototype.indexOf,no=Array.from,Dl=Object.defineProperty,aa=Object.getOwnPropertyDescriptor,Us=Object.getOwnPropertyDescriptors,Ws=Object.prototype,Ml=Array.prototype,ao=Object.getPrototypeOf,hs=Object.isExtensible;function sr(t){return typeof t=="function"}const Xe=()=>{};function Il(t){return typeof t?.then=="function"}function Ll(t){return t()}function To(t){for(var e=0;e<t.length;e++)t[e]()}function Vs(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function Rl(t,e,a=!1){return t===void 0?a?e():e:t}const Nt=2,es=4,ro=8,Fl=1<<24,Vn=16,Kn=32,Na=64,oo=128,fn=512,Lt=1024,qt=2048,Cn=4096,Jt=8192,Ln=16384,ts=32768,da=65536,ps=1<<17,Ks=1<<18,nr=1<<19,qs=1<<20,In=1<<25,Ta=32768,Po=1<<21,ns=1<<22,ra=1<<23,oa=Symbol("$state"),Gs=Symbol("legacy props"),Ol=Symbol(""),ja=new class extends Error{constructor(){super(...arguments);jt(this,"name","StaleReactionError");jt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ys(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function zl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Bl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function jl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Hl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Ul(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Wl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Vl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Kl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ql(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Gl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Yl=1,Xl=2,Xs=4,Jl=8,Zl=16,Ql=1,$l=2,ec=4,tc=8,nc=16,ac=1,rc=2,Pt=Symbol(),oc="http://www.w3.org/1999/xhtml";function sc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Js(t){return t===this.v}function ic(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Zs(t){return!ic(t,this.v)}let ar=!1,lc=!1;function cc(){ar=!0}const dc=[];function Ba(t,e=!1,a=!1){return Br(t,new Map,"",dc,null,a)}function Br(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if($o(t)){var l=Array(t.length);e.set(t,l),o!==null&&e.set(o,l);for(var d=0;d<t.length;d+=1){var c=t[d];d in t&&(l[d]=Br(c,e,a,r,null,s))}return l}if(ao(t)===Ws){l={},e.set(t,l),o!==null&&e.set(o,l);for(var u in t)l[u]=Br(t[u],e,a,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return Br(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let lt=null;function Ja(t){lt=t}function gt(t){return Qs().get(t)}function ht(t,e){return Qs().set(t,e),e}function Ce(t,e=!1,a){lt={p:lt,i:!1,c:null,e:null,s:t,x:null,l:ar&&!e?{s:null,u:null,$:[]}:null}}function ke(t){var e=lt,a=e.e;if(a!==null){e.e=null;for(var r of a)_i(r)}return t!==void 0&&(e.x=t),e.i=!0,lt=e.p,t??{}}function rr(){return!ar||lt!==null&&lt.l===null}function Qs(t){return lt===null&&Ys(),lt.c??(lt.c=new Map(uc(lt)||void 0))}function uc(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let ma=[];function $s(){var t=ma;ma=[],To(t)}function Aa(t){if(ma.length===0&&!Wa){var e=ma;queueMicrotask(()=>{e===ma&&$s()})}ma.push(t)}function fc(){for(;ma.length>0;)$s()}function ei(t){var e=Qe;if(e===null)return Ge.f|=ra,t;if((e.f&ts)===0){if((e.f&oo)===0)throw t;e.b.error(t)}else Za(t,e)}function Za(t,e){for(;e!==null;){if((e.f&oo)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Rr=new Set;let $e=null,jr=null,cn=null,on=[],so=null,Eo=!1,Wa=!1;var Ka,qa,_a,wa,kr,Ga,Ya,Et,No,lr,Ao,ti,ni;const Zr=class Zr{constructor(){Ke(this,Et);jt(this,"committed",!1);jt(this,"current",new Map);jt(this,"previous",new Map);Ke(this,Ka,new Set);Ke(this,qa,new Set);Ke(this,_a,0);Ke(this,wa,0);Ke(this,kr,null);Ke(this,Ga,new Set);Ke(this,Ya,new Set);jt(this,"skipped_effects",new Set);jt(this,"is_fork",!1)}is_deferred(){return this.is_fork||V(this,wa)>0}process(e){on=[],jr=null,this.apply();var a={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)dt(this,Et,No).call(this,r,a);this.is_fork||dt(this,Et,ti).call(this),this.is_deferred()?(dt(this,Et,lr).call(this,a.effects),dt(this,Et,lr).call(this,a.render_effects)):(jr=this,$e=null,ms(a.render_effects),ms(a.effects),jr=null,V(this,kr)?.resolve()),cn=null}capture(e,a){this.previous.has(e)||this.previous.set(e,a),(e.f&ra)===0&&(this.current.set(e,e.v),cn?.set(e,e.v))}activate(){$e=this,this.apply()}deactivate(){$e===this&&($e=null,cn=null)}flush(){if(this.activate(),on.length>0){if(ri(),$e!==null&&$e!==this)return}else V(this,_a)===0&&this.process([]);this.deactivate()}discard(){for(const e of V(this,qa))e(this);V(this,qa).clear()}increment(e){Ue(this,_a,V(this,_a)+1),e&&Ue(this,wa,V(this,wa)+1)}decrement(e){Ue(this,_a,V(this,_a)-1),e&&Ue(this,wa,V(this,wa)-1),this.revive()}revive(){for(const e of V(this,Ga))V(this,Ya).delete(e),Ft(e,qt),Pa(e);for(const e of V(this,Ya))Ft(e,Cn),Pa(e);this.flush()}oncommit(e){V(this,Ka).add(e)}ondiscard(e){V(this,qa).add(e)}settled(){return(V(this,kr)??Ue(this,kr,Vs())).promise}static ensure(){if($e===null){const e=$e=new Zr;Rr.add($e),Wa||Zr.enqueue(()=>{$e===e&&e.flush()})}return $e}static enqueue(e){Aa(e)}apply(){}};Ka=new WeakMap,qa=new WeakMap,_a=new WeakMap,wa=new WeakMap,kr=new WeakMap,Ga=new WeakMap,Ya=new WeakMap,Et=new WeakSet,No=function(e,a){e.f^=Lt;for(var r=e.first;r!==null;){var o=r.f,s=(o&(Kn|Na))!==0,i=s&&(o&Lt)!==0,l=i||(o&Jt)!==0||this.skipped_effects.has(r);if((r.f&oo)!==0&&r.b?.is_pending()&&(a={parent:a,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=Lt:(o&es)!==0?a.effects.push(r):Nr(r)&&((r.f&Vn)!==0&&V(this,Ga).add(r),_r(r));var d=r.first;if(d!==null){r=d;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===a.effect&&(dt(this,Et,lr).call(this,a.effects),dt(this,Et,lr).call(this,a.render_effects),a=a.parent),r=c.next,c=c.parent}},lr=function(e){for(const a of e)(a.f&qt)!==0?V(this,Ga).add(a):(a.f&Cn)!==0&&V(this,Ya).add(a),dt(this,Et,Ao).call(this,a.deps),Ft(a,Lt)},Ao=function(e){if(e!==null)for(const a of e)(a.f&Nt)===0||(a.f&Ta)===0||(a.f^=Ta,dt(this,Et,Ao).call(this,a.deps))},ti=function(){if(V(this,wa)===0){for(const e of V(this,Ka))e();V(this,Ka).clear()}V(this,_a)===0&&dt(this,Et,ni).call(this)},ni=function(){var s;if(Rr.size>1){this.previous.clear();var e=cn,a=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Rr){if(i===this){a=!1;continue}const l=[];for(const[c,u]of this.current){if(i.current.has(c))if(a&&u!==i.current.get(c))i.current.set(c,u);else continue;l.push(c)}if(l.length===0)continue;const d=[...i.current.keys()].filter(c=>!this.current.has(c));if(d.length>0){var o=on;on=[];const c=new Set,u=new Map;for(const v of l)oi(v,d,c,u);if(on.length>0){$e=i,i.apply();for(const v of on)dt(s=i,Et,No).call(s,v,r);i.deactivate()}on=o}}$e=null,cn=e}this.committed=!0,Rr.delete(this)};let wn=Zr;function ai(t){var e=Wa;Wa=!0;try{for(var a;;){if(fc(),on.length===0&&($e?.flush(),on.length===0))return so=null,a;ri()}}finally{Wa=e}}function ri(){var t=xa;Eo=!0;var e=null;try{var a=0;for(qr(!0);on.length>0;){var r=wn.ensure();if(a++>1e3){var o,s;vc()}r.process(on),sa.clear()}}finally{Eo=!1,qr(t),so=null}}function vc(){try{Ul()}catch(t){Za(t,so)}}let Nn=null;function ms(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Ln|Jt))===0&&Nr(r)&&(Nn=new Set,_r(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?bi(r):r.fn=null),Nn?.size>0)){sa.clear();for(const o of Nn){if((o.f&(Ln|Jt))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)Nn.has(i)&&(Nn.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const d=s[l];(d.f&(Ln|Jt))===0&&_r(d)}}Nn.clear()}}Nn=null}}function oi(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&Nt)!==0?oi(o,e,a,r):(s&(ns|Vn))!==0&&(s&qt)===0&&si(o,e,r)&&(Ft(o,qt),Pa(o))}}function si(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(e.includes(o))return!0;if((o.f&Nt)!==0&&si(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function Pa(t){for(var e=so=t;e.parent!==null;){e=e.parent;var a=e.f;if(Eo&&e===Qe&&(a&Vn)!==0&&(a&Ks)===0)return;if((a&(Na|Kn))!==0){if((a&Lt)===0)return;e.f^=Lt}}on.push(e)}function gc(t){let e=0,a=kn(0),r;return()=>{pr()&&(n(a),lo(()=>(e===0&&(r=Ot(()=>t(()=>ia(a)))),e+=1,()=>{Aa(()=>{e-=1,e===0&&(r?.(),r=void 0,ia(a))})})))}}var hc=da|nr|oo;function pc(t,e,a){new mc(t,e,a)}var nn,an,Qo,gn,ya,hn,rn,Wt,pn,Mn,Qn,ba,$n,Ca,ea,Qr,xt,_c,wc,Do,Hr,Ur,Mo;class mc{constructor(e,a,r){Ke(this,xt);jt(this,"parent");Ke(this,nn,!1);Ke(this,an);Ke(this,Qo,null);Ke(this,gn);Ke(this,ya);Ke(this,hn);Ke(this,rn,null);Ke(this,Wt,null);Ke(this,pn,null);Ke(this,Mn,null);Ke(this,Qn,null);Ke(this,ba,0);Ke(this,$n,0);Ke(this,Ca,!1);Ke(this,ea,null);Ke(this,Qr,gc(()=>(Ue(this,ea,kn(V(this,ba))),()=>{Ue(this,ea,null)})));Ue(this,an,e),Ue(this,gn,a),Ue(this,ya,r),this.parent=Qe.b,Ue(this,nn,!!V(this,gn).pending),Ue(this,hn,or(()=>{Qe.b=this;{var o=dt(this,xt,Do).call(this);try{Ue(this,rn,sn(()=>r(o)))}catch(s){this.error(s)}V(this,$n)>0?dt(this,xt,Ur).call(this):Ue(this,nn,!1)}return()=>{V(this,Qn)?.remove()}},hc))}is_pending(){return V(this,nn)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!V(this,gn).pending}update_pending_count(e){dt(this,xt,Mo).call(this,e),Ue(this,ba,V(this,ba)+e),V(this,ea)&&Rn(V(this,ea),V(this,ba))}get_effect_pending(){return V(this,Qr).call(this),n(V(this,ea))}error(e){var a=V(this,gn).onerror;let r=V(this,gn).failed;if(V(this,Ca)||!a&&!r)throw e;V(this,rn)&&(Kt(V(this,rn)),Ue(this,rn,null)),V(this,Wt)&&(Kt(V(this,Wt)),Ue(this,Wt,null)),V(this,pn)&&(Kt(V(this,pn)),Ue(this,pn,null));var o=!1,s=!1;const i=()=>{if(o){sc();return}o=!0,s&&Gl(),wn.ensure(),Ue(this,ba,0),V(this,pn)!==null&&Sa(V(this,pn),()=>{Ue(this,pn,null)}),Ue(this,nn,this.has_pending_snippet()),Ue(this,rn,dt(this,xt,Hr).call(this,()=>(Ue(this,Ca,!1),sn(()=>V(this,ya).call(this,V(this,an)))))),V(this,$n)>0?dt(this,xt,Ur).call(this):Ue(this,nn,!1)};var l=Ge;try{Vt(null),s=!0,a?.(e,i),s=!1}catch(d){Za(d,V(this,hn)&&V(this,hn).parent)}finally{Vt(l)}r&&Aa(()=>{Ue(this,pn,dt(this,xt,Hr).call(this,()=>{wn.ensure(),Ue(this,Ca,!0);try{return sn(()=>{r(V(this,an),()=>e,()=>i)})}catch(d){return Za(d,V(this,hn).parent),null}finally{Ue(this,Ca,!1)}}))})}}nn=new WeakMap,an=new WeakMap,Qo=new WeakMap,gn=new WeakMap,ya=new WeakMap,hn=new WeakMap,rn=new WeakMap,Wt=new WeakMap,pn=new WeakMap,Mn=new WeakMap,Qn=new WeakMap,ba=new WeakMap,$n=new WeakMap,Ca=new WeakMap,ea=new WeakMap,Qr=new WeakMap,xt=new WeakSet,_c=function(){try{Ue(this,rn,sn(()=>V(this,ya).call(this,V(this,an))))}catch(e){this.error(e)}Ue(this,nn,!1)},wc=function(){const e=V(this,gn).pending;e&&(Ue(this,Wt,sn(()=>e(V(this,an)))),wn.enqueue(()=>{var a=dt(this,xt,Do).call(this);Ue(this,rn,dt(this,xt,Hr).call(this,()=>(wn.ensure(),sn(()=>V(this,ya).call(this,a))))),V(this,$n)>0?dt(this,xt,Ur).call(this):(Sa(V(this,Wt),()=>{Ue(this,Wt,null)}),Ue(this,nn,!1))}))},Do=function(){var e=V(this,an);return V(this,nn)&&(Ue(this,Qn,Fn()),V(this,an).before(V(this,Qn)),e=V(this,Qn)),e},Hr=function(e){var a=Qe,r=Ge,o=lt;Sn(V(this,hn)),Vt(V(this,hn)),Ja(V(this,hn).ctx);try{return e()}catch(s){return ei(s),null}finally{Sn(a),Vt(r),Ja(o)}},Ur=function(){const e=V(this,gn).pending;V(this,rn)!==null&&(Ue(this,Mn,document.createDocumentFragment()),V(this,Mn).append(V(this,Qn)),Si(V(this,rn),V(this,Mn))),V(this,Wt)===null&&Ue(this,Wt,sn(()=>e(V(this,an))))},Mo=function(e){var a;if(!this.has_pending_snippet()){this.parent&&dt(a=this.parent,xt,Mo).call(a,e);return}Ue(this,$n,V(this,$n)+e),V(this,$n)===0&&(Ue(this,nn,!1),V(this,Wt)&&Sa(V(this,Wt),()=>{Ue(this,Wt,null)}),V(this,Mn)&&(V(this,an).before(V(this,Mn)),Ue(this,Mn,null)))};function yc(t,e,a,r){const o=rr()?Tr:Pr;if(a.length===0&&t.length===0){r(e.map(o));return}var s=$e,i=Qe,l=ii();function d(){Promise.all(a.map(c=>bc(c))).then(c=>{l();try{r([...e.map(o),...c])}catch(u){(i.f&Ln)===0&&Za(u,i)}s?.deactivate(),hr()}).catch(c=>{Za(c,i)})}t.length>0?Promise.all(t).then(()=>{l();try{return d()}finally{s?.deactivate(),hr()}}):d()}function ii(){var t=Qe,e=Ge,a=lt,r=$e;return function(s=!0){Sn(t),Vt(e),Ja(a),s&&r?.activate()}}function hr(){Sn(null),Vt(null),Ja(null)}function Tr(t){var e=Nt|qt,a=Ge!==null&&(Ge.f&Nt)!==0?Ge:null;return Qe!==null&&(Qe.f|=nr),{ctx:lt,deps:null,effects:null,equals:Js,f:e,fn:t,reactions:null,rv:0,v:Pt,wv:0,parent:a??Qe,ac:null}}function bc(t,e){let a=Qe;a===null&&zl();var r=a.b,o=void 0,s=kn(Pt),i=!Ge,l=new Map;return Mc(()=>{var d=Vs();o=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{c===$e&&c.committed&&c.deactivate(),hr()})}catch(h){d.reject(h),hr()}var c=$e;if(i){var u=!r.is_pending();r.update_pending_count(1),c.increment(u),l.get(c)?.reject(ja),l.delete(c),l.set(c,d)}const v=(h,p=void 0)=>{if(c.activate(),p)p!==ja&&(s.f|=ra,Rn(s,p));else{(s.f&ra)!==0&&(s.f^=ra),Rn(s,h);for(const[w,x]of l){if(l.delete(w),w===c)break;x.reject(ja)}}i&&(r.update_pending_count(-1),c.decrement(u))};d.promise.then(v,h=>v(null,h||"unknown"))}),mi(()=>{for(const d of l.values())d.reject(ja)}),new Promise(d=>{function c(u){function v(){u===o?d(s):c(o)}u.then(v,v)}c(o)})}function P(t){const e=Tr(t);return xi(e),e}function Pr(t){const e=Tr(t);return e.equals=Zs,e}function li(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)Kt(e[a])}}function Cc(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&Ln)===0?e:null;e=e.parent}return null}function as(t){var e,a=Qe;Sn(Cc(t));try{t.f&=~Ta,li(t),e=Ni(t)}finally{Sn(a)}return e}function ci(t){var e=as(t);if(t.equals(e)||($e?.is_fork||(t.v=e),t.wv=Pi()),!Da)if(cn!==null)(pr()||$e?.is_fork)&&cn.set(t,e);else{var a=(t.f&fn)===0?Cn:Lt;Ft(t,a)}}let Io=new Set;const sa=new Map;let di=!1;function kn(t,e){var a={f:0,v:t,reactions:null,equals:Js,rv:0,wv:0};return a}function R(t,e){const a=kn(t);return xi(a),a}function Lo(t,e=!1,a=!0){var o;const r=kn(t);return e||(r.equals=Zs),ar&&a&&lt!==null&&lt.l!==null&&((o=lt.l).s??(o.s=[])).push(r),r}function f(t,e,a=!1){Ge!==null&&(!yn||(Ge.f&ps)!==0)&&rr()&&(Ge.f&(Nt|Vn|ns|ps))!==0&&!On?.includes(t)&&ql();let r=a?ft(e):e;return Rn(t,r)}function Rn(t,e){if(!t.equals(e)){var a=t.v;Da?sa.set(t,e):sa.set(t,a),t.v=e;var r=wn.ensure();r.capture(t,a),(t.f&Nt)!==0&&((t.f&qt)!==0&&as(t),Ft(t,(t.f&fn)!==0?Lt:Cn)),t.wv=Pi(),ui(t,qt),rr()&&Qe!==null&&(Qe.f&Lt)!==0&&(Qe.f&(Kn|Na))===0&&(en===null?Rc([t]):en.push(t)),!r.is_fork&&Io.size>0&&!di&&kc()}return e}function kc(){di=!1;var t=xa;qr(!0);const e=Array.from(Io);try{for(const a of e)(a.f&Lt)!==0&&Ft(a,Cn),Nr(a)&&_r(a)}finally{qr(t)}Io.clear()}function ia(t){f(t,t.v+1)}function ui(t,e){var a=t.reactions;if(a!==null)for(var r=rr(),o=a.length,s=0;s<o;s++){var i=a[s],l=i.f;if(!(!r&&i===Qe)){var d=(l&qt)===0;if(d&&Ft(i,e),(l&Nt)!==0){var c=i;cn?.delete(c),(l&Ta)===0&&(l&fn&&(i.f|=Ta),ui(c,Cn))}else d&&((l&Vn)!==0&&Nn!==null&&Nn.add(i),Pa(i))}}}function ft(t){if(typeof t!="object"||t===null||oa in t)return t;const e=ao(t);if(e!==Ws&&e!==Ml)return t;var a=new Map,r=$o(t),o=R(0),s=zn,i=l=>{if(zn===s)return l();var d=Ge,c=zn;Vt(null),bs(s);var u=l();return Vt(d),bs(c),u};return r&&a.set("length",R(t.length)),new Proxy(t,{defineProperty(l,d,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Vl();var u=a.get(d);return u===void 0?u=i(()=>{var v=R(c.value);return a.set(d,v),v}):f(u,c.value,!0),!0},deleteProperty(l,d){var c=a.get(d);if(c===void 0){if(d in l){const u=i(()=>R(Pt));a.set(d,u),ia(o)}}else f(c,Pt),ia(o);return!0},get(l,d,c){if(d===oa)return t;var u=a.get(d),v=d in l;if(u===void 0&&(!v||aa(l,d)?.writable)&&(u=i(()=>{var p=ft(v?l[d]:Pt),w=R(p);return w}),a.set(d,u)),u!==void 0){var h=n(u);return h===Pt?void 0:h}return Reflect.get(l,d,c)},getOwnPropertyDescriptor(l,d){var c=Reflect.getOwnPropertyDescriptor(l,d);if(c&&"value"in c){var u=a.get(d);u&&(c.value=n(u))}else if(c===void 0){var v=a.get(d),h=v?.v;if(v!==void 0&&h!==Pt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(l,d){if(d===oa)return!0;var c=a.get(d),u=c!==void 0&&c.v!==Pt||Reflect.has(l,d);if(c!==void 0||Qe!==null&&(!u||aa(l,d)?.writable)){c===void 0&&(c=i(()=>{var h=u?ft(l[d]):Pt,p=R(h);return p}),a.set(d,c));var v=n(c);if(v===Pt)return!1}return u},set(l,d,c,u){var v=a.get(d),h=d in l;if(r&&d==="length")for(var p=c;p<v.v;p+=1){var w=a.get(p+"");w!==void 0?f(w,Pt):p in l&&(w=i(()=>R(Pt)),a.set(p+"",w))}if(v===void 0)(!h||aa(l,d)?.writable)&&(v=i(()=>R(void 0)),f(v,ft(c)),a.set(d,v));else{h=v.v!==Pt;var x=i(()=>ft(c));f(v,x)}var m=Reflect.getOwnPropertyDescriptor(l,d);if(m?.set&&m.set.call(u,c),!h){if(r&&typeof d=="string"){var C=a.get("length"),N=Number(d);Number.isInteger(N)&&N>=C.v&&f(C,N+1)}ia(o)}return!0},ownKeys(l){n(o);var d=Reflect.ownKeys(l).filter(v=>{var h=a.get(v);return h===void 0||h.v!==Pt});for(var[c,u]of a)u.v!==Pt&&!(c in l)&&d.push(c);return d},setPrototypeOf(){Kl()}})}var _s,fi,vi,gi;function Sc(){if(_s===void 0){_s=window,fi=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;vi=aa(e,"firstChild").get,gi=aa(e,"nextSibling").get,hs(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),hs(a)&&(a.__t=void 0)}}function Fn(t=""){return document.createTextNode(t)}function Qa(t){return vi.call(t)}function Er(t){return gi.call(t)}function b(t,e){return Qa(t)}function D(t,e=!1){{var a=Qa(t);return a instanceof Comment&&a.data===""?Er(a):a}}function M(t,e=1,a=!1){let r=t;for(;e--;)r=Er(r);return r}function xc(t){t.textContent=""}function hi(){return!1}let ws=!1;function Tc(){ws||(ws=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function io(t){var e=Ge,a=Qe;Vt(null),Sn(null);try{return t()}finally{Vt(e),Sn(a)}}function Pc(t,e,a,r=a){t.addEventListener(e,()=>io(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),Tc()}function pi(t){Qe===null&&(Ge===null&&Hl(),jl()),Da&&Bl()}function Ec(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function Tn(t,e,a){var r=Qe;r!==null&&(r.f&Jt)!==0&&(t|=Jt);var o={ctx:lt,deps:null,nodes:null,f:t|qt|fn,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{_r(o),o.f|=ts}catch(l){throw Kt(o),l}else e!==null&&Pa(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&nr)===0&&(s=s.first,(t&Vn)!==0&&(t&da)!==0&&s!==null&&(s.f|=da)),s!==null&&(s.parent=r,r!==null&&Ec(s,r),Ge!==null&&(Ge.f&Nt)!==0&&(t&Na)===0)){var i=Ge;(i.effects??(i.effects=[])).push(s)}return o}function pr(){return Ge!==null&&!yn}function mi(t){const e=Tn(ro,null,!1);return Ft(e,Lt),e.teardown=t,e}function Ve(t){pi();var e=Qe.f,a=!Ge&&(e&Kn)!==0&&(e&ts)===0;if(a){var r=lt;(r.e??(r.e=[])).push(t)}else return _i(t)}function _i(t){return Tn(es|qs,t,!1)}function Nc(t){return pi(),Tn(ro|qs,t,!0)}function Ac(t){wn.ensure();const e=Tn(Na|nr,t,!0);return(a={})=>new Promise(r=>{a.outro?Sa(e,()=>{Kt(e),r(void 0)}):(Kt(e),r(void 0))})}function Dc(t){return Tn(es,t,!1)}function Mc(t){return Tn(ns|nr,t,!0)}function lo(t,e=0){return Tn(ro|e,t,!0)}function Me(t,e=[],a=[],r=[]){yc(r,e,a,o=>{Tn(ro,()=>t(...o.map(n)),!0)})}function or(t,e=0){var a=Tn(Vn|e,t,!0);return a}function sn(t){return Tn(Kn|nr,t,!0)}function wi(t){var e=t.teardown;if(e!==null){const a=Da,r=Ge;ys(!0),Vt(null);try{e.call(null)}finally{ys(a),Vt(r)}}}function yi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&io(()=>{o.abort(ja)});var r=a.next;(a.f&Na)!==0?a.parent=null:Kt(a,e),a=r}}function Ic(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&Kn)===0&&Kt(e),e=a}}function Kt(t,e=!0){var a=!1;(e||(t.f&Ks)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Lc(t.nodes.start,t.nodes.end),a=!0),yi(t,e&&!a),Gr(t,0),Ft(t,Ln);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();wi(t);var o=t.parent;o!==null&&o.first!==null&&bi(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Lc(t,e){for(;t!==null;){var a=t===e?null:Er(t);t.remove(),t=a}}function bi(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function Sa(t,e,a=!0){var r=[];Ci(t,r,!0);var o=()=>{a&&Kt(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var l of r)l.out(i)}else o()}function Ci(t,e,a){if((t.f&Jt)===0){t.f^=Jt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||a)&&e.push(l);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&da)!==0||(o.f&Kn)!==0&&(t.f&Vn)!==0;Ci(o,e,i?a:!1),o=s}}}function rs(t){ki(t,!0)}function ki(t,e){if((t.f&Jt)!==0){t.f^=Jt,(t.f&Lt)===0&&(Ft(t,qt),Pa(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&da)!==0||(a.f&Kn)!==0;ki(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function Si(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Er(a);e.append(a),a=o}}let xa=!1;function qr(t){xa=t}let Da=!1;function ys(t){Da=t}let Ge=null,yn=!1;function Vt(t){Ge=t}let Qe=null;function Sn(t){Qe=t}let On=null;function xi(t){Ge!==null&&(On===null?On=[t]:On.push(t))}let Ht=null,Gt=0,en=null;function Rc(t){en=t}let Ti=1,mr=0,zn=mr;function bs(t){zn=t}function Pi(){return++Ti}function Nr(t){var e=t.f;if((e&qt)!==0)return!0;if(e&Nt&&(t.f&=~Ta),(e&Cn)!==0){var a=t.deps;if(a!==null)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(Nr(s)&&ci(s),s.wv>t.wv)return!0}(e&fn)!==0&&cn===null&&Ft(t,Lt)}return!1}function Ei(t,e,a=!0){var r=t.reactions;if(r!==null&&!On?.includes(t))for(var o=0;o<r.length;o++){var s=r[o];(s.f&Nt)!==0?Ei(s,e,!1):e===s&&(a?Ft(s,qt):(s.f&Lt)!==0&&Ft(s,Cn),Pa(s))}}function Ni(t){var w;var e=Ht,a=Gt,r=en,o=Ge,s=On,i=lt,l=yn,d=zn,c=t.f;Ht=null,Gt=0,en=null,Ge=(c&(Kn|Na))===0?t:null,On=null,Ja(t.ctx),yn=!1,zn=++mr,t.ac!==null&&(io(()=>{t.ac.abort(ja)}),t.ac=null);try{t.f|=Po;var u=t.fn,v=u(),h=t.deps;if(Ht!==null){var p;if(Gr(t,Gt),h!==null&&Gt>0)for(h.length=Gt+Ht.length,p=0;p<Ht.length;p++)h[Gt+p]=Ht[p];else t.deps=h=Ht;if(pr()&&(t.f&fn)!==0)for(p=Gt;p<h.length;p++)((w=h[p]).reactions??(w.reactions=[])).push(t)}else h!==null&&Gt<h.length&&(Gr(t,Gt),h.length=Gt);if(rr()&&en!==null&&!yn&&h!==null&&(t.f&(Nt|Cn|qt))===0)for(p=0;p<en.length;p++)Ei(en[p],t);return o!==null&&o!==t&&(mr++,en!==null&&(r===null?r=en:r.push(...en))),(t.f&ra)!==0&&(t.f^=ra),v}catch(x){return ei(x)}finally{t.f^=Po,Ht=e,Gt=a,en=r,Ge=o,On=s,Ja(i),yn=l,zn=d}}function Fc(t,e){let a=e.reactions;if(a!==null){var r=Al.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}a===null&&(e.f&Nt)!==0&&(Ht===null||!Ht.includes(e))&&(Ft(e,Cn),(e.f&fn)!==0&&(e.f^=fn,e.f&=~Ta),li(e),Gr(e,0))}function Gr(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Fc(t,a[r])}function _r(t){var e=t.f;if((e&Ln)===0){Ft(t,Lt);var a=Qe,r=xa;Qe=t,xa=!0;try{(e&(Vn|Fl))!==0?Ic(t):yi(t),wi(t);var o=Ni(t);t.teardown=typeof o=="function"?o:null,t.wv=Ti;var s;xo&&lc&&(t.f&qt)!==0&&t.deps}finally{xa=r,Qe=a}}}async function Ai(){await Promise.resolve(),ai()}function n(t){var e=t.f,a=(e&Nt)!==0;if(Ge!==null&&!yn){var r=Qe!==null&&(Qe.f&Ln)!==0;if(!r&&!On?.includes(t)){var o=Ge.deps;if((Ge.f&Po)!==0)t.rv<mr&&(t.rv=mr,Ht===null&&o!==null&&o[Gt]===t?Gt++:Ht===null?Ht=[t]:Ht.includes(t)||Ht.push(t));else{(Ge.deps??(Ge.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[Ge]:s.includes(Ge)||s.push(Ge)}}}if(Da){if(sa.has(t))return sa.get(t);if(a){var i=t,l=i.v;return((i.f&Lt)===0&&i.reactions!==null||Mi(i))&&(l=as(i)),sa.set(i,l),l}}else a&&(!cn?.has(t)||$e?.is_fork&&!pr())&&(i=t,Nr(i)&&ci(i),xa&&pr()&&(i.f&fn)===0&&Di(i));if(cn?.has(t))return cn.get(t);if((t.f&ra)!==0)throw t.v;return t.v}function Di(t){if(t.deps!==null){t.f^=fn;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&fn)===0&&Di(e)}}function Mi(t){if(t.v===Pt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(sa.has(e)||(e.f&Nt)!==0&&Mi(e))return!0;return!1}function Ot(t){var e=yn;try{return yn=!0,t()}finally{yn=e}}const Oc=-7169;function Ft(t,e){t.f=t.f&Oc|e}function zc(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(oa in t)Ro(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&oa in a&&Ro(a)}}}function Ro(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Ro(t[r],e)}catch{}const a=ao(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Us(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const Bc=["touchstart","touchmove"];function jc(t){return Bc.includes(t)}const Ii=new Set,Fo=new Set;function Hc(t,e,a,r={}){function o(s){if(r.capture||cr.call(e,s),!s.cancelBubble)return io(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Aa(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function Zt(t,e,a,r,o){var s={capture:r,passive:o},i=Hc(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&mi(()=>{e.removeEventListener(t,i,s)})}function pt(t){for(var e=0;e<t.length;e++)Ii.add(t[e]);for(var a of Fo)a(t)}let Cs=null;function cr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;Cs=t;var i=0,l=Cs===t&&t.__root;if(l){var d=o.indexOf(l);if(d!==-1&&(e===document||e===window)){t.__root=e;return}var c=o.indexOf(e);if(c===-1)return;d<=c&&(i=d)}if(s=o[i]||t.target,s!==e){Dl(t,"currentTarget",{configurable:!0,get(){return s||a}});var u=Ge,v=Qe;Vt(null),Sn(null);try{for(var h,p=[];s!==null;){var w=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+r];x!=null&&(!s.disabled||t.target===s)&&x.call(s,t)}catch(m){h?p.push(m):h=m}if(t.cancelBubble||w===e||w===null)break;s=w}if(h){for(let m of p)queueMicrotask(()=>{throw m});throw h}}finally{t.__root=e,delete t.currentTarget,Vt(u),Sn(v)}}}function Li(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function wr(t,e){var a=Qe;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function k(t,e){var a=(e&ac)!==0,r=(e&rc)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=Li(s?t:"<!>"+t),a||(o=Qa(o)));var i=r||fi?document.importNode(o,!0):o.cloneNode(!0);if(a){var l=Qa(i),d=i.lastChild;wr(l,d)}else wr(i,i);return i}}function Uc(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=Li(o),l=Qa(i);s=Qa(l)}var d=s.cloneNode(!0);return wr(d,d),d}}function Wc(t,e){return Uc(t,e,"svg")}function We(t=""){{var e=Fn(t+"");return wr(e,e),e}}function ye(){var t=document.createDocumentFragment(),e=document.createComment(""),a=Fn();return t.append(e,a),wr(e,a),t}function g(t,e){t!==null&&t.before(e)}function sp(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function vt(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Vc(t,e){return Kc(t,e)}const Oa=new Map;function Kc(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){Sc();var l=new Set,d=v=>{for(var h=0;h<v.length;h++){var p=v[h];if(!l.has(p)){l.add(p);var w=jc(p);e.addEventListener(p,cr,{passive:w});var x=Oa.get(p);x===void 0?(document.addEventListener(p,cr,{passive:w}),Oa.set(p,1)):Oa.set(p,x+1)}}};d(no(Ii)),Fo.add(d);var c=void 0,u=Ac(()=>{var v=a??e.appendChild(Fn());return pc(v,{pending:()=>{}},h=>{if(s){Ce({});var p=lt;p.c=s}o&&(r.$$events=o),c=t(h,r)||{},s&&ke()}),()=>{for(var h of l){e.removeEventListener(h,cr);var p=Oa.get(h);--p===0?(document.removeEventListener(h,cr),Oa.delete(h)):Oa.set(h,p)}Fo.delete(d),v!==a&&v.parentNode?.removeChild(v)}});return qc.set(c,u),c}let qc=new WeakMap;var dn,mn,Xt,ka,Sr,xr,$r;class co{constructor(e,a=!0){jt(this,"anchor");Ke(this,dn,new Map);Ke(this,mn,new Map);Ke(this,Xt,new Map);Ke(this,ka,new Set);Ke(this,Sr,!0);Ke(this,xr,()=>{var e=$e;if(V(this,dn).has(e)){var a=V(this,dn).get(e),r=V(this,mn).get(a);if(r)rs(r),V(this,ka).delete(a);else{var o=V(this,Xt).get(a);o&&(V(this,mn).set(a,o.effect),V(this,Xt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of V(this,dn)){if(V(this,dn).delete(s),s===e)break;const l=V(this,Xt).get(i);l&&(Kt(l.effect),V(this,Xt).delete(i))}for(const[s,i]of V(this,mn)){if(s===a||V(this,ka).has(s))continue;const l=()=>{if(Array.from(V(this,dn).values()).includes(s)){var c=document.createDocumentFragment();Si(i,c),c.append(Fn()),V(this,Xt).set(s,{effect:i,fragment:c})}else Kt(i);V(this,ka).delete(s),V(this,mn).delete(s)};V(this,Sr)||!r?(V(this,ka).add(s),Sa(i,l,!1)):l()}}});Ke(this,$r,e=>{V(this,dn).delete(e);const a=Array.from(V(this,dn).values());for(const[r,o]of V(this,Xt))a.includes(r)||(Kt(o.effect),V(this,Xt).delete(r))});this.anchor=e,Ue(this,Sr,a)}ensure(e,a){var r=$e,o=hi();if(a&&!V(this,mn).has(e)&&!V(this,Xt).has(e))if(o){var s=document.createDocumentFragment(),i=Fn();s.append(i),V(this,Xt).set(e,{effect:sn(()=>a(i)),fragment:s})}else V(this,mn).set(e,sn(()=>a(this.anchor)));if(V(this,dn).set(r,e),o){for(const[l,d]of V(this,mn))l===e?r.skipped_effects.delete(d):r.skipped_effects.add(d);for(const[l,d]of V(this,Xt))l===e?r.skipped_effects.delete(d.effect):r.skipped_effects.add(d.effect);r.oncommit(V(this,xr)),r.ondiscard(V(this,$r))}else V(this,xr).call(this)}}dn=new WeakMap,mn=new WeakMap,Xt=new WeakMap,ka=new WeakMap,Sr=new WeakMap,xr=new WeakMap,$r=new WeakMap;const Gc=0,bo=1;function Yc(t,e,a,r,o){var s=rr(),i=Pt,l=s?kn(i):Lo(i,!1,!1),d=s?kn(i):Lo(i,!1,!1),c=new co(t);or(()=>{var u=e(),v=!1;if(Il(u)){var h=ii(),p=!1;const w=x=>{if(!v){p=!0,h(!1),wn.ensure();try{x()}finally{hr(),Wa||ai()}}};u.then(x=>{w(()=>{Rn(l,x),c.ensure(bo,r&&(m=>r(m,l)))})},x=>{w(()=>{if(Rn(d,x),c.ensure(bo,o&&(m=>o(m,d))),!o)throw d.v})}),Aa(()=>{p||w(()=>{c.ensure(Gc,a)})})}else Rn(l,u),c.ensure(bo,r&&(w=>r(w,l)));return()=>{v=!0}})}function W(t,e,a=!1){var r=new co(t),o=a?da:0;function s(i,l){r.ensure(i,l)}or(()=>{var i=!1;e((l,d=!0)=>{i=!0,s(d,l)}),i||s(!1,null)},o)}function ge(t,e){lo(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Xc(t,e,a){for(var r=[],o=e.length,s,i=e.length,l=0;l<o;l++){let v=e[l];Sa(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var h=t.outrogroups;Oo(no(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var d=r.length===0&&a!==null;if(d){var c=a,u=c.parentNode;xc(u),u.append(c),t.items.clear()}Oo(e,!d)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function Oo(t,e=!0){for(var a=0;a<t.length;a++)Kt(t[a],e)}var ks;function Bn(t,e,a,r,o,s=null){var i=t,l=new Map,d=(e&Xs)!==0;if(d){var c=t;i=c.appendChild(Fn())}var u=null,v=Pr(()=>{var C=a();return $o(C)?C:C==null?[]:no(C)}),h,p=!0;function w(){m.fallback=u,Jc(m,h,i,e,r),u!==null&&(h.length===0?(u.f&In)===0?rs(u):(u.f^=In,dr(u,null,i)):Sa(u,()=>{u=null}))}var x=or(()=>{h=n(v);for(var C=h.length,N=new Set,_=$e,y=hi(),T=0;T<C;T+=1){var j=h[T],K=r(j,T),O=p?null:l.get(K);O?(O.v&&Rn(O.v,j),O.i&&Rn(O.i,T),y&&_.skipped_effects.delete(O.e)):(O=Zc(l,p?i:ks??(ks=Fn()),j,K,T,o,e,a),p||(O.e.f|=In),l.set(K,O)),N.add(K)}if(C===0&&s&&!u&&(p?u=sn(()=>s(i)):(u=sn(()=>s(ks??(ks=Fn()))),u.f|=In)),!p)if(y){for(const[z,ae]of l)N.has(z)||_.skipped_effects.add(ae.e);_.oncommit(w),_.ondiscard(()=>{})}else w();n(v)}),m={effect:x,items:l,outrogroups:null,fallback:u};p=!1}function Jc(t,e,a,r,o){var s=(r&Jl)!==0,i=e.length,l=t.items,d=t.effect.first,c,u=null,v,h=[],p=[],w,x,m,C;if(s)for(C=0;C<i;C+=1)w=e[C],x=o(w,C),m=l.get(x).e,(m.f&In)===0&&(m.nodes?.a?.measure(),(v??(v=new Set)).add(m));for(C=0;C<i;C+=1){if(w=e[C],x=o(w,C),m=l.get(x).e,t.outrogroups!==null)for(const ae of t.outrogroups)ae.pending.delete(m),ae.done.delete(m);if((m.f&In)!==0)if(m.f^=In,m===d)dr(m,null,a);else{var N=u?u.next:d;m===t.effect.last&&(t.effect.last=m.prev),m.prev&&(m.prev.next=m.next),m.next&&(m.next.prev=m.prev),Yn(t,u,m),Yn(t,m,N),dr(m,N,a),u=m,h=[],p=[],d=u.next;continue}if((m.f&Jt)!==0&&(rs(m),s&&(m.nodes?.a?.unfix(),(v??(v=new Set)).delete(m))),m!==d){if(c!==void 0&&c.has(m)){if(h.length<p.length){var _=p[0],y;u=_.prev;var T=h[0],j=h[h.length-1];for(y=0;y<h.length;y+=1)dr(h[y],_,a);for(y=0;y<p.length;y+=1)c.delete(p[y]);Yn(t,T.prev,j.next),Yn(t,u,T),Yn(t,j,_),d=_,u=j,C-=1,h=[],p=[]}else c.delete(m),dr(m,d,a),Yn(t,m.prev,m.next),Yn(t,m,u===null?t.effect.first:u.next),Yn(t,u,m),u=m;continue}for(h=[],p=[];d!==null&&d!==m;)(c??(c=new Set)).add(d),p.push(d),d=d.next;if(d===null)continue}(m.f&In)===0&&h.push(m),u=m,d=m.next}if(t.outrogroups!==null){for(const ae of t.outrogroups)ae.pending.size===0&&(Oo(no(ae.done)),t.outrogroups?.delete(ae));t.outrogroups.size===0&&(t.outrogroups=null)}if(d!==null||c!==void 0){var K=[];if(c!==void 0)for(m of c)(m.f&Jt)===0&&K.push(m);for(;d!==null;)(d.f&Jt)===0&&d!==t.fallback&&K.push(d),d=d.next;var O=K.length;if(O>0){var z=(r&Xs)!==0&&i===0?a:null;if(s){for(C=0;C<O;C+=1)K[C].nodes?.a?.measure();for(C=0;C<O;C+=1)K[C].nodes?.a?.fix()}Xc(t,K,z)}}s&&Aa(()=>{if(v!==void 0)for(m of v)m.nodes?.a?.apply()})}function Zc(t,e,a,r,o,s,i,l){var d=(i&Yl)!==0?(i&Zl)===0?Lo(a,!1,!1):kn(a):null,c=(i&Xl)!==0?kn(o):null;return{v:d,i:c,e:sn(()=>(s(e,d??a,c??o,l),()=>{t.delete(r)}))}}function dr(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&In)===0?e.nodes.start:a;r!==null;){var i=Er(r);if(s.before(r),r===o)return;r=i}}function Yn(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function je(t,e,...a){var r=new co(t);or(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},da)}function Qc(t,e,a){var r=new co(t);or(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},da)}function Ri(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=Ri(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function $c(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=Ri(t))&&(r&&(r+=" "),r+=e);return r}function at(t){return typeof t=="object"?$c(t):t??""}const Ss=[...` 	
\r\fÂ \v\uFEFF`];function ed(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||Ss.includes(r[i-1]))&&(l===r.length||Ss.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function td(t,e){return t==null?null:String(t)}function tt(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var l=ed(a,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=a}else if(s&&o!==s)for(var d in s){var c=!!s[d];(o==null||c!==!!o[d])&&t.classList.toggle(d,c)}return s}function $a(t,e,a,r){var o=t.__style;if(o!==e){var s=td(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const nd=Symbol("is custom element"),ad=Symbol("is html");function ip(t,e){var a=os(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function lp(t,e){var a=os(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function ut(t,e,a,r){var o=os(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Ol]=a),a==null?t.removeAttribute(e):typeof a!="string"&&rd(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function os(t){return t.__attributes??(t.__attributes={[nd]:t.nodeName.includes("-"),[ad]:t.namespaceURI===oc})}var xs=new Map;function rd(t){var e=t.getAttribute("is")||t.nodeName,a=xs.get(e);if(a)return a;xs.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=Us(o);for(var i in r)r[i].set&&a.push(i);o=ao(o)}return a}function Fi(t,e,a=e){var r=new WeakSet;Pc(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=Co(t)?ko(s):s,a(s),$e!==null&&r.add($e),await Ai(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,d=t.value.length;if(t.value=s??"",l!==null){var c=t.value.length;i===l&&l===d&&c>d?(t.selectionStart=c,t.selectionEnd=c):(t.selectionStart=i,t.selectionEnd=Math.min(l,c))}}}),Ot(e)==null&&t.value&&(a(Co(t)?ko(t.value):t.value),$e!==null&&r.add($e)),lo(()=>{var o=e();if(t===document.activeElement){var s=jr??$e;if(r.has(s))return}Co(t)&&o===ko(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function Co(t){var e=t.type;return e==="number"||e==="range"}function ko(t){return t===""?null:+t}function Ts(t,e){return t===e||t?.[oa]===e}function et(t={},e,a,r){return Dc(()=>{var o,s;return lo(()=>{o=s,s=[],Ot(()=>{t!==a(...s)&&(e(t,...s),o&&Ts(a(...o),t)&&e(null,...o))})}),()=>{Aa(()=>{s&&Ts(a(...s),t)&&e(null,...s)})}}),t}function ss(t=!1){const e=lt,a=e.l.u;if(!a)return;let r=()=>zc(e.s);if(t){let o=0,s={};const i=Tr(()=>{let l=!1;const d=e.s;for(const c in d)d[c]!==s[c]&&(s[c]=d[c],l=!0);return l&&o++,o});r=()=>n(i)}a.b.length&&Nc(()=>{Ps(e,r),To(a.b)}),Ve(()=>{const o=Ot(()=>a.m.map(Ll));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&Ve(()=>{Ps(e,r),To(a.a)})}function Ps(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let Fr=!1;function od(t){var e=Fr;try{return Fr=!1,[t(),Fr]}finally{Fr=e}}const sd={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];sr(o)&&(o=o());const s=aa(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=aa(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===oa||e===Gs)return!1;for(let a of t.props)if(sr(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(sr(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function zo(...t){return new Proxy({props:t},sd)}function ze(t,e,a,r){var o=!ar||(a&$l)!==0,s=(a&tc)!==0,i=(a&nc)!==0,l=r,d=!0,c=()=>(d&&(d=!1,l=i?Ot(r):r),l),u;if(s){var v=oa in t||Gs in t;u=aa(t,e)?.set??(v&&e in t?_=>t[e]=_:void 0)}var h,p=!1;s?[h,p]=od(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=c(),u&&(o&&Wl(),u(h)));var w;if(o?w=()=>{var _=t[e];return _===void 0?c():(d=!0,_)}:w=()=>{var _=t[e];return _!==void 0&&(l=void 0),_===void 0?l:_},o&&(a&ec)===0)return w;if(u){var x=t.$$legacy;return(function(_,y){return arguments.length>0?((!o||!y||x||p)&&u(y?w():_),_):w()})}var m=!1,C=((a&Ql)!==0?Tr:Pr)(()=>(m=!1,w()));s&&n(C);var N=Qe;return(function(_,y){if(arguments.length>0){const T=y?n(C):o&&s?ft(_):_;return f(C,T),m=!0,l!==void 0&&(l=T),_}return Da&&m||(N.f&Ln)!==0?C.v:n(C)})}function Pe(t){lt===null&&Ys(),ar&&lt.l!==null?id(lt).m.push(t):Ve(()=>{const e=Ot(t);if(typeof e=="function")return e})}function id(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const ld="5";var Hs;typeof window<"u"&&((Hs=window.__svelte??(window.__svelte={})).v??(Hs.v=new Set)).add(ld);cc();const Oi={};function cd(t){ht(Oi,t)}function Ea(){const t=gt(Oi);if(!t)throw new Error("No FeedSearchContext found");return t}const zi={};function dd(t){ht(zi,t)}function Bt(){const t=gt(zi);if(!t)throw new Error("No SearchParamsContext found");return t}function ud(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Bt(),s="feedSearch",i=P(()=>o().get(s)||""),l=P(()=>n(i));cd({getFeedSearch:()=>n(l),setFeedSearch:u=>{u===""?r(s):a(s,u)}});var d=ye(),c=D(d);je(c,()=>e.children??Xe),g(t,d),ke()}const Bi={};function fd(t){ht(Bi,t)}function vd(){const t=gt(Bi);if(!t)throw new Error("No TagsSearchContext found");return t}function gd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Bt(),s="tagsSearch",i=P(()=>o().get(s)||""),l=P(()=>n(i));fd({getTagsSearch:()=>n(l),setTagsSearch:u=>{u===""?r(s):a(s,u)}});var d=ye(),c=D(d);je(c,()=>e.children??Xe),g(t,d),ke()}const ji={};function hd(t){ht(ji,t)}function Hi(){const t=gt(ji);if(!t)throw new Error("No FeedOrderContext found");return t}function pd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Bt(),s="feedOrder",i=P(()=>o().get(s)||"newest"),l=P(()=>n(i));let d=["newest","oldest","AtoZ","ZtoA","updatedNewest"];hd({getFeedOrder:()=>n(l),setFeedOrder:v=>{v==="newest"||!d.includes(v)?r(s):a(s,v)}});var c=ye(),u=D(c);je(u,()=>e.children??Xe),g(t,c),ke()}const Ui={};function md(t){ht(Ui,t)}function Ar(){const t=gt(Ui);if(!t)throw new Error("No SidebarContext found");return t}function _d(t,e){Ce(e,!0);let a=R("closed");md({sidebarOpen:()=>{f(a,"preOpening")},sidebarClose:()=>{f(a,"closing")},getSidebarState:()=>n(a),setSidebarState:c=>{f(a,c,!0)}});var l=ye(),d=D(l);je(d,()=>e.children??Xe),g(t,l),ke()}const Wi={};function wd(t){ht(Wi,t)}function qn(){const t=gt(Wi);if(!t)throw new Error("No SelectedTagsContext found");return t}function yd(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Bt(),s=P(a),i="selectedTags";let l=P(()=>n(s).get(i)||""),d=P(()=>new Set(n(l).split(",").map(m=>decodeURIComponent(m)).filter(m=>m!=="")));wd({getSelectedTags:()=>n(d),addTag:m=>{n(d).has(m)||r(i,[...n(d),m].map(C=>encodeURIComponent(C)).join(","))},removeTag:m=>{n(d).has(m)&&n(d).size===1?o(i):n(d).has(m)&&r(i,[...n(d)].filter(C=>C!==m).map(C=>encodeURIComponent(C)).join(","))},clearTags:()=>{o(i)},setSelectedTags:m=>{m.size===0?o(i):r(i,[...m].map(C=>encodeURIComponent(C)).join(","))}});var w=ye(),x=D(w);je(x,()=>e.children??Xe),g(t,w),ke()}const Vi={};function bd(t){ht(Vi,t)}function ua(){const t=gt(Vi);if(!t)throw new Error("No SelectedNotesContext found");return t}var Cd=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],kd=["difference","intersection","symmetricDifference","union"],Es=!1,Xa,un,ta,eo,er,Ki,qi;const to=class to extends Set{constructor(a){super();Ke(this,er);Ke(this,Xa,new Map);Ke(this,un,R(0));Ke(this,ta,R(0));Ke(this,eo,zn||-1);if(a){for(var r of a)super.add(r);V(this,ta).v=super.size}Es||dt(this,er,qi).call(this)}has(a){var r=super.has(a),o=V(this,Xa),s=o.get(a);if(s===void 0){if(!r)return n(V(this,un)),!1;s=dt(this,er,Ki).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),f(V(this,ta),super.size),ia(V(this,un))),this}delete(a){var r=super.delete(a),o=V(this,Xa),s=o.get(a);return s!==void 0&&(o.delete(a),f(s,!1)),r&&(f(V(this,ta),super.size),ia(V(this,un))),r}clear(){if(super.size!==0){super.clear();var a=V(this,Xa);for(var r of a.values())f(r,!1);a.clear(),f(V(this,ta),0),ia(V(this,un))}}keys(){return this.values()}values(){return n(V(this,un)),super.values()}entries(){return n(V(this,un)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(V(this,ta))}};Xa=new WeakMap,un=new WeakMap,ta=new WeakMap,eo=new WeakMap,er=new WeakSet,Ki=function(a){return zn===V(this,eo)?R(a):kn(a)},qi=function(){Es=!0;var a=to.prototype,r=Set.prototype;for(const o of Cd)a[o]=function(...s){return n(V(this,un)),r[o].apply(this,s)};for(const o of kd)a[o]=function(...s){n(V(this,un));var i=r[o].apply(this,s);return new to(i)}};let Bo=to;function Sd(t,e){Ce(e,!0);let a=new Bo,r=R("single");const o=()=>a,s=p=>{a.clear(),p.forEach(w=>a.add(w))},i=p=>{a.add(p)},l=p=>{a.delete(p)},d=()=>{a.clear()};bd({getSelectedNotes:o,setSelectedNotes:s,addNote:i,removeNote:l,clearNotes:d,getMode:()=>n(r),changeMode:p=>{f(r,p,!0),p==="single"&&d()}});var v=ye(),h=D(v);je(h,()=>e.children??Xe),g(t,v),ke()}const Gi={};function xd(t){ht(Gi,t)}function is(){const t=gt(Gi);if(!t)throw new Error("No LocalDBContext found");return t}const Yi={};function Td(t){ht(Yi,t)}function Hn(){const t=gt(Yi);if(!t)throw new Error("No SettingsContext found");return t}const Xi={};function Pd(t){ht(Xi,t)}function uo(){const t=gt(Xi);if(!t)throw new Error("No BroadcastContext found");return t}const Ed="AppStorage",Nd=1,ur="account",Jn="settings",ot="notes",Ut="tags",Ad="syncLog",fa="success",Un="error",St=(t,e,a)=>{t?.addEventListener(e,a)},Ns=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();St(s,fa,()=>{const i=s?.result||[];a(i)}),St(s,Un,i=>{r(i)})}),Yr=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);St(i,fa,()=>{const l=i?.result?.data;r(l)}),St(i,Un,l=>{o(l)})}),_n=(t,e,a,r)=>new Promise((o,s)=>{const d=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});St(d,fa,()=>{o()}),St(d,Un,c=>{s(c)})}),yt=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((l,d)=>{St(i,fa,()=>{l()}),St(i,Un,c=>{d(c)})})}))},So=(t,e,a)=>new Promise((r,o)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);St(l,fa,()=>{r()}),St(l,Un,d=>{o(d)})}),ir=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((l,d)=>{St(i,fa,()=>{l()}),St(i,Un,c=>{d(c)})})}))},Ha=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();St(i,fa,()=>{a()}),St(i,Un,l=>{r(l)})});function Dd(t,e){Ce(e,!0);const{deleteSearchParam:a}=Bt(),r="viewMode";let s=ft((()=>{const B=new URLSearchParams(window.location.search).get(r)||"tab";return B==="popup"||B==="window"||B==="tab"||B==="sidebar"?B:"tab"})());Pe(()=>{a(r)});let i=R(!1),l=R(ft({showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:d}=is(),{createBroadcastChannel:c,tabId:u}=uo(),v=c(),h=P(d),p=async()=>{const G=await Yr(n(h),Jn,"default");G&&f(l,G,!0)},w=async()=>{await p(),f(i,!0)},x=async G=>{const B=JSON.parse(G.data),F=B;if(B.tabId&&B.tabId===u){F.type==="exit"&&(f(l,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),Ha(n(h),Jn));return}F.type==="updateSettings"?p():F.type==="exit"&&f(l,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},m=()=>n(l).showFavicon,C=()=>n(l).recordMode,N=async G=>{n(l).showFavicon=G,await _n(n(h),Jn,"default",Ba(n(l))),v.postMessage({type:"updateSettings"})},_=async G=>{n(l).recordMode=G,await _n(n(h),Jn,"default",Ba(n(l))),v.postMessage({type:"updateSettings"})},y=async G=>{n(l).tags.prev=G,await _n(n(h),Jn,"default",Ba(n(l))),v.postMessage({type:"updateSettings"})},T=()=>n(l).tags.prev||[],j=async G=>{n(l).tags.llm=G,await _n(n(h),Jn,"default",Ba(n(l))),v.postMessage({type:"updateSettings"})},K=()=>n(l).tags.llm,O=()=>n(l).tags.pageData,z=async G=>{n(l).tags.pageData=G,await _n(n(h),Jn,"default",Ba(n(l))),v.postMessage({type:"updateSettings"})};Pe(()=>(w(),v.addEventListener(x),()=>{v.removeEventListener(x)})),Td({getFaviconEnabled:m,getRecordMode:C,setRecordMode:_,setFaviconShown:N,isInitedSettings:()=>n(i),getViewMode:()=>s,setLlmTagsEnabled:j,getLlmTagsEnabled:K,setPrevTags:y,getPrevTags:T,getPageDataForTagsEnabled:O,setPageDataForTagsEnabled:z});var ae=ye(),le=D(ae);je(le,()=>e.children??Xe),g(t,ae),ke()}const Ji={};function Md(t){ht(Ji,t)}function ls(){const t=gt(Ji);if(!t)throw new Error("No AccountContext found");return t}function Id(t,e){Ce(e,!0);let a=R(void 0);const{getDB:r}=is(),{createBroadcastChannel:o,tabId:s}=uo(),i=P(r),l=o(),d=async()=>{const _=await Yr(n(i),ur,"default");f(a,_,!0)},c=_=>_n(n(i),ur,"default",_),u=async _=>{const y=await Yr(n(i),ur,"default");y!==void 0&&f(a,y,!0),_(y)},v=async _=>{const y=JSON.parse(_.data);if(y.tabId&&y.tabId===s)return;const T=y;T.type==="initLocalAccount"?f(a,null):T.type==="initCloudAccount"?d():T.type==="disconnectCloudAccount"?f(a,null):T.type==="exit"?f(a,void 0):T.type==="updateAccount"&&d()};Pe(()=>(l.addEventListener(v),()=>{l.removeEventListener(v)})),Md({init:u,getAccount:()=>n(a),initLocalAccount:async()=>{f(a,null),await c(null),l.postMessage({type:"initLocalAccount"})},initCloudAccount:async _=>{const y={encryptedClientKey:_.encryptedClientKey||"",subscriptionExpires:_.subscriptionExpires||-1,lastSync:-1};await c(y),f(a,y,!0),l.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{f(a,null),await c(null),l.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async _=>{if(!n(a))throw new Error("No account to update subscription for");const y={...n(a),subscriptionExpires:_};await c(y),l.postMessage({type:"updateAccount"})},exitApp:async()=>{f(a,void 0),l.postMessage({type:"exit"}),await Ha(n(i),ur)}});var C=ye(),N=D(C);je(N,()=>e.children??Xe),g(t,C),ke()}const Zi={};function Ld(t){ht(Zi,t)}function At(){const t=gt(Zi);if(!t)throw new Error("No NotesContext found");return t}const An=()=>crypto.randomUUID(),Rd=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},Qi=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}};async function cp(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{console.error("")}}const Ye=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t));function Fd(t,e){Ce(e,!0);const{getDB:a}=is(),{createBroadcastChannel:r,tabId:o}=uo(),s=P(a),i=r(),l=720*60*60*1e3;let d=R(!1),c=R(()=>new Map),u=R(()=>[]),v=R(()=>new Map),h=R(ft(new Map)),p=null,w=new Promise(I=>{p=I});const x=()=>n(d),m=()=>n(u)().some(I=>I.data&&!I.data.deletedAt&&!I.data.archivedAt),C=()=>n(u)().some(I=>I.data&&I.data.deletedAt),N=()=>n(u)().some(I=>I.data&&I.data.archivedAt&&!I.data.deletedAt),_=(I,A)=>{n(h).has(I)||n(h).set(I,new Set),n(h).get(I)?.add(A)},y=(I,A)=>{n(h).has(I)&&(n(h).get(I)?.delete(A),n(h).get(I)?.size===0&&n(h).delete(I))},T=I=>{if(!I)return!1;const A=n(v)().get(I);if(!A||!A.data?.link?.url)return!1;const S=n(h).get(A.data.link.url),L=[];return S?.forEach(U=>{if(U===I)return;const E=n(v)().get(U);(A.data?.archivedAt||0)==(E?.data?.archivedAt||0)&&(A.data?.deletedAt||0)==(E?.data?.deletedAt||0)&&L.push(U)}),L.length>0},j=I=>{const A=n(u)(),S=n(v)(),L=S.get(I.id);if(L){const U=L.data?.link?.url;L.data=I.data,U!==I.data?.link?.url&&(U&&y(U,I.id),I.data?.link?.url&&_(I.data.link.url,I.id))}else A.push(I),S.set(I.id,I),I.data?.link?.url&&_(I.data.link.url,I.id);f(u,()=>A),f(v,()=>S)},K=I=>{const A=n(u)(),S=n(v)(),L=S.get(I);S.has(I)&&S.delete(I),L&&L.data?.link?.url&&y(L.data.link.url,I),L&&(L.data=void 0),f(u,()=>A),f(v,()=>S)},O=I=>{const A=n(u)(),S=n(v)();for(const L of I){const U=S.get(L);S.has(L)&&S.delete(L),U&&U.data?.link?.url&&y(U.data.link.url,L),U&&(U.data=void 0)}f(u,()=>A),f(v,()=>S)},z=()=>{f(u,()=>[]),f(h,new Map,!0),f(c,()=>new Map),f(v,()=>new Map)},ae=()=>n(u),le=()=>n(v),G=I=>{const A=n(c)();for(const S of I)A.get(S)||A.set(S,{name:S});f(c,()=>A)},B=async()=>{const[I,A]=await Promise.all([Ns(n(s),ot),Ns(n(s),Ut).then(Y=>Y.reduce((J,ne)=>J.set(ne.id,ne.data),new Map))]),S=[],L=[],U=new Map;for(const Y of I)Y.data.deletedAt&&Date.now()-Y.data.deletedAt>l?S.push(Y.id):(L.push(Y),U.set(Y.id,Y),Y.data.link?.url&&_(Y.data.link?.url,Y.id));const E=Rd(L),ee=[],q=new Map(A);[...E.values()].forEach(Y=>{q.set(Y,{name:Y,pinned:A.get(Y)?.pinned||!1}),A.has(Y)||ee.push(Y)});const X=[];[...A.keys()].forEach(Y=>{E.has(Y)||X.push(Y)}),await ir(n(s),ot,S),await ir(n(s),Ut,X),await yt(n(s),Ut,ee.map(Y=>({id:Y,data:{pinned:q.get(Y)?.pinned||!1}}))),f(u,()=>L),f(v,()=>U),f(c,()=>q),f(d,!0),setTimeout(()=>{p?.()},0)},F=async I=>{const A=n(c)(),S=I.data.tags.filter(L=>!A.has(L))||[];return await _n(n(s),ot,I.id,{...I.data}),S.length>0&&(await yt(n(s),Ut,S.map(L=>({id:L,data:{pinned:!1}}))||[]),G(S)),j(I),i.postMessage({type:"putNote",data:{id:I.id}}),I.id},pe=async({link:I,text:A,tags:S,pinned:L})=>{const U={id:An(),data:{link:Ye(I),text:A,tags:Ye(S),versionId:An(),history:[],createdAt:Date.now(),updatedAt:Date.now(),pinned:L}};return await F(U),U.id},Se=async(I,{link:A,text:S,tags:L})=>{const U=re(I);if(!U||!U.data)return;const E={id:I,data:{...U.data,link:Ye(A),text:S,tags:Ye(L),updatedAt:Date.now()}};await F(E)},Z=async(I,{link:A,text:S,tags:L})=>{const U=re(I);if(!U||!U.data)return;const E={versionId:U.data.versionId,link:Ye(U.data.link),text:U.data.text,tags:Ye(U.data.tags),updatedAt:U.data.updatedAt},ee=[...(U.data.history||[]).slice(-9),E],q={id:I,data:{...U.data,versionId:An(),link:A,text:S,tags:L,updatedAt:Date.now(),history:ee}};return await F(q),{versionId:q.data.versionId,link:Ye(q.data.link),text:q.data.text,tags:Ye(q.data.tags),updatedAt:q.data.updatedAt}},H=async I=>{const A=re(I);if(!A||!A.data)return;const L=(E=>{const ee=`${A.data.link?.url||""}||${A.data.link?.title||""}||${A.data.text}||${A.data.tags.join(",")}`,q=new Set([ee]),X=[];for(const Y of E){const J=`${Y.link?.url||""}||${Y.link?.title||""}||${Y.text}||${Y.tags.join(",")}`;q.has(J)||(q.add(J),X.push(Y))}return X})([...A.data.history||[]]),U={id:I,data:{...A.data,history:L}};await F(U)},te=async(I,A)=>{const S=re(I);if(!S||!S.data)return;const L=S.data.history?.find?.(E=>E.versionId===A);if(!L)return;const U={id:I,data:{...S.data,versionId:L.versionId,link:Ye(L.link),text:L.text,tags:Ye(L.tags),updatedAt:L.updatedAt,history:S.data.history?.filter?.(E=>E.versionId!==A)||[]}};await F(U)},ve=async I=>{const S=n(v)().get(I);!S||!S.data||(K(I),await So(n(s),ot,I),i.postMessage({type:"deleteNote",data:{id:I}}))},ue=async()=>{await Ha(n(s),ot),await Ha(n(s),Ut),z(),i.postMessage({type:"clearNotes"})},re=I=>n(v)().get(I),oe=async(I,A)=>{const L=n(v)().get(I);if(!L||!L.data)return;const U={id:I,data:{...L.data,pinned:A}};F(U)},_e=async I=>{const S=n(v)().get(I);if(!S||!S.data)return;const L={id:I,data:{...S.data,deletedAt:Date.now()}};await F(L)},de=async I=>{const S=n(v)().get(I);if(!S||!S.data)return;const L={id:I,data:{...S.data,archivedAt:Date.now()}};await F(L)},se=async({noteIds:I})=>{const A=n(v)(),S=n(u)();for(const U of I){const E=A.get(U);E?.data&&(E.data.deletedAt=Date.now())}return await yt(n(s),ot,I.map(U=>{const E=A.get(U);return{id:U,data:E?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S),{cancel:async()=>{for(const U of I){const E=A.get(U);E?.data&&(E.data.deletedAt=0)}await yt(n(s),ot,I.map(U=>{const E=A.get(U);return{id:U,data:E?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S)}}},Q=async({noteIds:I})=>{const A=n(v)(),S=n(u)();for(const U of I){const E=A.get(U);E?.data&&(E.data.archivedAt=Date.now())}return await yt(n(s),ot,I.map(U=>{const E=A.get(U);return{id:U,data:E?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S),{cancel:async()=>{for(const U of I){const E=A.get(U);E?.data&&(E.data.archivedAt=0)}await yt(n(s),ot,I.map(U=>{const E=A.get(U);return{id:U,data:E?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S)}}},ie=async({noteIds:I})=>{const A=n(v)(),S=n(u)(),L=[];for(const E of I){const ee=A.get(E);ee?.data&&(L.push({id:E,data:Ye(ee.data)}),ee.data.archivedAt=0)}return await yt(n(s),ot,I.map(E=>{const ee=A.get(E);return{id:E,data:ee?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S),{cancel:async()=>{for(const E of L){const ee=A.get(E.id);ee?.data&&(ee.data=E.data)}await yt(n(s),ot,I.map(E=>{const ee=A.get(E);return{id:E,data:ee?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S)}}},fe=async({noteIds:I})=>{const A=n(v)(),S=n(u)(),L=[];for(const E of I){const ee=A.get(E);ee?.data&&(L.push({id:E,data:Ye(ee.data)}),ee.data.deletedAt=0)}return await yt(n(s),ot,I.map(E=>{const ee=A.get(E);return{id:E,data:ee?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S),{cancel:async()=>{for(const E of L){const ee=A.get(E.id);ee?.data&&(ee.data=E.data)}await yt(n(s),ot,I.map(E=>{const ee=A.get(E);return{id:E,data:ee?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>A),f(u,()=>S)}}},Ee=async I=>{const S=n(v)().get(I);if(!S||!S.data)return;const L={id:I,data:{...S.data,deletedAt:0}};await F(L)},Ae=async I=>{const S=n(v)().get(I);if(!S||!S.data)return;const L={id:I,data:{...S.data,archivedAt:0}};await F(L)},he=async(I,A)=>{const S=n(c)();S.set(I,{name:I,pinned:A}),await _n(n(s),Ut,I,{pinned:A}),i.postMessage({type:"pinTag",data:{tag:I,pinned:A}}),f(c,()=>S)},ce=async({noteIds:I})=>{const A=n(c)(),S=n(u)();O(I),await ir(n(s),ot,I),i.postMessage({type:"reloadNotes"}),f(u,()=>S),f(c,()=>A)},xe=async I=>{const A=n(v)(),S={};I.forEach(L=>{const U=A.get(L.id),E=[];if(U&&U.data){let ee=0,q=0;for(;ee<L.data.history.length&&q<U.data.history.length;){const X=L.data.history[ee],Y=U.data.history[q];X.versionId===Y.versionId?(X.updatedAt>Y.updatedAt?E.push(X):E.push(Y),ee+=1,q+=1):X.updatedAt<Y.updatedAt?(E.push(X),ee+=1):X.updatedAt>Y.updatedAt?(E.push(Y),q+=1):(E.push(Y),ee+=1,q+=1)}U.data.updatedAt>L.data.updatedAt?S[U.id]={id:U.id,data:{...U.data,history:E}}:S[L.id]={id:L.id,data:{...L.data,history:E}}}else S[L.id]=L}),await yt(n(s),ot,Object.values(S)),await B(),i.postMessage({type:"reloadNotes"})},we=async()=>{const I=[];n(u)().forEach(S=>{S&&S.data&&S.data.deletedAt&&I.push(S.id)}),await ir(n(s),ot,I),await B(),i.postMessage({type:"emptyBin"})},Le=async(I,A)=>{const S=n(v)(),L=n(u)(),U=[],E=[];for(const q of A){const X=S.get(q);X?.data&&(U.push({id:q,data:Ye(X.data)}),E.push({id:q,data:{...X.data,tags:X.data.tags.filter(Y=>Y!==I),versionId:An(),history:[...X.data.history||[],{versionId:X.data.versionId,link:Ye(X.data.link),text:X.data.text,tags:X.data.tags,updatedAt:Date.now()}]}}))}for(const q of E){const X=S.get(q.id);X?.data&&(X.data=q.data)}return await yt(n(s),ot,E.map(q=>({id:q.id,data:q.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(u,()=>L),{cancel:async()=>{for(const q of U){const X=S.get(q.id);X?.data&&(X.data=q.data)}await yt(n(s),ot,U.map(q=>({id:q.id,data:q.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(u,()=>L)}}},$=async(I,A,S)=>{const L=n(v)(),U=n(u)(),E=n(c)(),ee=[],q=[];for(const J of S){const ne=L.get(J);ne?.data&&(ee.push({id:J,data:Ye(ne.data)}),q.push({id:J,data:{...ne.data,tags:ne.data.tags.map(Ne=>Ne!==I?Ne:A),versionId:An(),history:[...ne.data.history||[],{versionId:ne.data.versionId,link:Ye(ne.data.link),text:ne.data.text,tags:ne.data.tags,updatedAt:Date.now()}]}}))}for(const J of q){const ne=L.get(J.id);ne?.data&&(ne.data=J.data)}const X=E.has(A);return await Promise.all([(async()=>{if(!X){const J=E.get(I)?.pinned||!1;E.set(A,{name:A,pinned:J}),await _n(n(s),Ut,A,{pinned:J})}})(),yt(n(s),ot,q.map(J=>({id:J.id,data:J.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(u,()=>U),f(c,()=>E),{cancel:async()=>{for(const J of ee){const ne=L.get(J.id);ne?.data&&(ne.data=J.data)}await Promise.all([(async()=>{X||(E.delete(A),await So(n(s),Ut,A))})(),yt(n(s),ot,ee.map(J=>({id:J.id,data:J.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(u,()=>U),f(c,()=>E)}}},be=async(I,A)=>{const S=n(v)(),L=n(u)(),U=n(c)(),E=[],ee=[];for(const Y of A){const J=S.get(Y);J?.data&&(E.push({id:Y,data:Ye(J.data)}),ee.push({id:Y,data:{...J.data,tags:[...new Set([...J.data.tags,I])],versionId:An(),history:[...J.data.history||[],{versionId:J.data.versionId,link:Ye(J.data.link),text:J.data.text,tags:J.data.tags,updatedAt:Date.now()}]}}))}for(const Y of ee){const J=S.get(Y.id);J?.data&&(J.data=Y.data)}const q=U.has(I);return await Promise.all([(async()=>{q||(U.set(I,{name:I,pinned:!1}),await _n(n(s),Ut,I,{pinned:!1}))})(),yt(n(s),ot,ee.map(Y=>({id:Y.id,data:Y.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(u,()=>L),f(c,()=>U),{cancel:async()=>{for(const Y of E){const J=S.get(Y.id);J?.data&&(J.data=Y.data)}await Promise.all([(async()=>{q||(U.delete(I),await So(n(s),Ut,I))})(),yt(n(s),ot,E.map(Y=>({id:Y.id,data:Y.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>S),f(u,()=>L),f(c,()=>U)}}},Fe=async(I,A,S)=>{const L=n(v)(),U=n(u)(),E=n(c)(),ee=[],q=[];for(const ne of S){const Ne=L.get(ne);Ne?.data&&(ee.push({id:ne,data:Ye(Ne.data)}),q.push({id:ne,data:{...Ne.data,tags:[...new Set([...Ne.data.tags.filter(De=>!I.includes(De)),...A])],versionId:An(),history:[...Ne.data.history||[],{versionId:Ne.data.versionId,link:Ye(Ne.data.link),text:Ne.data.text,tags:Ne.data.tags,updatedAt:Date.now()}]}}))}for(const ne of q){const Ne=L.get(ne.id);Ne?.data&&(Ne.data=ne.data)}const X=n(c)(),Y=A.filter(ne=>!X.has(ne));return await Promise.all([(async()=>{if(Y.length>0)return yt(n(s),Ut,Y.map(ne=>({id:ne,data:{pinned:!1}})))})(),yt(n(s),ot,q.map(ne=>({id:ne.id,data:ne.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(u,()=>U),f(c,()=>E),{cancel:async()=>{for(const ne of ee){const Ne=L.get(ne.id);Ne?.data&&(Ne.data=ne.data)}await Promise.all([(async()=>{if(Y.length>0){for(const ne of Y)E.delete(ne);return ir(n(s),Ut,Y)}})(),yt(n(s),ot,ee.map(ne=>({id:ne.id,data:ne.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>L),f(u,()=>U),f(c,()=>E)}}},Ie=async I=>{const A=JSON.parse(I.data),S=A;if(A.tabId&&A.tabId===o){S.type==="exit"&&(z(),await Ha(n(s),ot),await Ha(n(s),Ut));return}if(S.type==="putNote"){const U=S.data.id;if(!U)return;const E=await Yr(n(s),ot,U);if(!E)return;j({id:U,data:E})}else if(S.type==="deleteNote"){const L=S.data.id;if(!L)return;K(L)}else if(S.type==="pinTag"){const L=S.data.tag,U=S.data.pinned,E=n(c)();E.set(L,{name:L,pinned:U}),f(c,()=>E)}else S.type==="clearNotes"?z():S.type==="reloadNotes"||S.type==="emptyBin"?B():S.type==="exit"&&z()};Pe(()=>(B(),i.addEventListener(Ie),()=>{i.removeEventListener(Ie)})),Ld({isInitedNotes:x,createNote:pe,updateNote:Se,deleteNote:ve,saveNote:Z,zipNoteHistory:H,revertNote:te,pinNote:oe,moveNoteToBin:_e,moveNoteToArchive:de,getGetNotes:ae,getGetMapNotes:le,importNotes:xe,clearNotes:ue,getNoteById:re,getGetMapTags:()=>n(c),pinTag:he,restoreNoteFromBin:Ee,moveNoteFromArchive:Ae,checkNotes:m,checkNotesInBin:C,checkNotesInArchive:N,emptyBin:we,moveNotesToBin:se,moveNotesToArchive:Q,moveNotesFromArchive:ie,deleteNotes:ce,restoreNotesFromBin:fe,deleteTag:Le,renameTag:$,addTag:be,changeTags:Fe,checkDuplicatesExist:T,checkInitedNotes:async()=>w});var Je=ye(),qe=D(Je);je(qe,()=>e.children??Xe),g(t,Je),ke()}const $i={};function Od(t){ht($i,t)}function Ma(){const t=gt($i);if(!t)throw new Error("No FeedContext found");return t}const el={};var st=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(st||{});function zd(t){ht(el,t)}function fo(){const t=gt(el);if(!t)throw new Error("No SelectedMetaTagsContext found");return t}function Bd(t,e){Ce(e,!0);const a=Ea(),{getSelectedTags:r}=qn(),{getSelectedMetaTags:o}=fo(),{getGetNotes:s}=At();let i=P(r),l=P(o),d=R(0),c=[],u=R(0),v=P(()=>n(l).has(st.ARCHIVED)),h=P(()=>n(l).has(st.BIN));Ve(()=>{const x=s()()||[],m=[],C=Array.from(n(i).values());for(let N=x.length-1;N>=0;N--){if(!x[N]||!x[N].data)continue;const _=x[N];if(!n(v)&&!n(h)&&(_?.data.deletedAt||_?.data.archivedAt)||n(v)&&(_?.data.deletedAt||!_?.data.archivedAt)||n(h)&&!_?.data.deletedAt)continue;const y=a?.getFeedSearch().toLowerCase()||"";if(a){if(y.endsWith("$")){const T=y.slice(0,-1);if(!(_.data.link?.title.toLowerCase()===T||_.data.link?.url.toLowerCase()===T||_.data.text.toLowerCase()===T||_.data.tags.map(j=>j.toLowerCase()).includes(T)))continue}else if(!(_.data.link?.title.toLowerCase().includes(y)||_.data.link?.url.toLowerCase().includes(y)||_.data.text.toLowerCase().includes(y)||_.data.tags.map(T=>T.toLowerCase()).join(" ").includes(y)))continue}if(n(l).has(st.INBOX)){if(_.data.tags.length>0)continue}else if(n(i).size&&C.some(T=>!_.data.tags.includes(T)))continue;m.push(_)}f(d,m.length,!0),c=m,f(u,Date.now(),!0)}),Od({getFiltredNotesLength:()=>n(d),getFiltredNotes:()=>(n(u),c),getUpdatedFiltredNotesTimestamp:()=>n(u)});var p=ye(),w=D(p);je(w,()=>e.children??Xe),g(t,p),ke()}function jd(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Bt(),s=P(a),i="selectedMetaTags";let l=P(()=>n(s).get(i)||""),d=P(()=>new Set(n(l).split(",").map(m=>decodeURIComponent(m)).filter(m=>m!=="")));zd({getSelectedMetaTags:()=>n(d),addMetaTag:m=>{n(d).has(m)||r(i,[...n(d),m].map(C=>encodeURIComponent(C)).join(","))},removeMetaTag:m=>{n(d).has(m)&&n(d).size===1?o(i):n(d).has(m)&&r(i,[...n(d)].filter(C=>C!==m).map(C=>encodeURIComponent(C)).join(","))},clearSelectedMetaTags:()=>{o(i)},setSelectedMetaTags:m=>{m.size===0?o(i):r(i,[...m].map(C=>encodeURIComponent(C)).join(","))}});var w=ye(),x=D(w);je(x,()=>e.children??Xe),g(t,w),ke()}const tl={};function Hd(t){ht(tl,t)}function Ud(){const t=gt(tl);if(!t)throw new Error("No StartContext found");return t}const As=()=>chrome,nl=()=>LanguageModel;var Te=(t=>(t.NewNote="newNote",t.Note="note",t.Settings="settings",t.ImportData="importData",t.ExportData="exportData",t.Account="account",t.Sync="sync",t.AccountSetup="accountSetup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="accessKeys",t.ConfirmAccessKey="confirmAccessKey",t.Subscription="subscription",t.Exit="exit",t.NotFound="notFound",t.About="about",t.Install="install",t.InstallSuccess="installSuccess",t.Extension="extension",t))(Te||{});const Ds={settings:"Settings",importData:"Import",exportData:"Export",account:"Account",sync:"Sync",accountSetup:"",auth:"Auth",signin:"Sign in",signup:"Sign up",confirmAccessKey:"Confirm access key",accessKeys:"Access keys",subscription:"Subscription",exit:"Exit",notFound:"",about:"About",install:"Install app",installSuccess:"Install success",extension:"Extension"},tn="dialogPages",al={};function Wd(t){ht(al,t)}function zt(){const t=gt(al);if(!t)throw new Error("No DialogPagesContext found");return t}function Vd(t,e){Ce(e,!0);const{clearDialogPages:a,getDialogPages:r,replaceDialogPage:o}=zt(),{replaceSearchParams:s}=Bt(),{getViewMode:i}=Hn(),{checkInitedNotes:l,getGetNotes:d}=At(),{setFeedSearch:c}=Ea();i();let u=R(!1);const v=async()=>{const x=r().at(-1)||"";x.startsWith(Te.NewNote+"?id=")&&o(x.replace(Te.NewNote,Te.Note)),f(u,!0)};Pe(()=>{v()}),Pe(()=>{}),Hd({isInited:()=>n(u)});var h=ye(),p=D(h);je(p,()=>e.children??Xe),g(t,h),ke()}const rl={},la=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function Kd(t){ht(rl,t)}function Gn(){const t=gt(rl);if(!t)throw new Error("No AnimationSettingsContext found");return t}function qd(t,e){Ce(e,!0);let a=ft(la());Kd(a);var r=ye(),o=D(r);je(o,()=>e.children??Xe),g(t,r),ke()}const ol={};function Gd(t){ht(ol,t)}function cs(){const t=gt(ol);if(!t)throw new Error("No ScrollingContext found");return t}function Yd(t,e){Ce(e,!0);let a=R(!1);const r=()=>n(a),o=Qi(()=>{f(a,!1)},100);Gd({isScrolling:r,enable:()=>{f(a,!0),o()}});var i=ye(),l=D(i);je(l,()=>e.children??Xe),g(t,i),ke()}const sl={};function Xd(t){ht(sl,t)}function va(){const t=gt(sl);if(!t)throw new Error("No MobileSizeContext found");return t}function Jd(t,e){Ce(e,!0);const a=()=>window.matchMedia("(max-width: 767px)").matches;let r=R(ft(a())),o=Gn();const s=Qi(()=>{o.working=!0},16),i=()=>{o.working=!1,s(),requestAnimationFrame(()=>{f(r,a(),!0)})};Xd({checkMobileSize:()=>n(r)}),Pe(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)));var d=ye(),c=D(d);je(c,()=>e.children??Xe),g(t,d),ke()}const il={};function Zd(t){ht(il,t)}function Qt(){const t=gt(il);if(!t)throw new Error("No DialogContext found");return t}function Qd(t,e){Ce(e,!0);let a=R(0),r=R(!1),o=R(!0),s=R(!1),i=R(!1);Zd({checkExistedDialog:()=>n(a)>0,dialogInc:()=>{f(a,n(a)+1)},dialogDec:()=>{f(a,n(a)-1)},blockDialog:T=>{f(r,T,!0)},checkBlockedDialog:()=>n(r),setClosableDialog:T=>{f(o,T,!0)},checkClosableDialog:()=>n(o),checkLeftStart:()=>n(s),checkLeftEnd:()=>n(i),setLeftStart:T=>{f(s,T,!0)},setLeftEnd:T=>{f(i,T,!0)},getCountDialog:()=>n(a)});var _=ye(),y=D(_);je(y,()=>e.children??Xe),g(t,_),ke()}const ll={};function $d(t){ht(ll,t)}function vo(){const t=gt(ll);if(!t)throw new Error("No ScrollContainerContext found");return t}function eu(t,e){Ce(e,!0);let a=R(null);$d({setScrollContainer:l=>{f(a,l,!0)},getScrollContainer:()=>n(a)});var s=ye(),i=D(s);je(i,()=>e.children??Xe),g(t,s),ke()}const cl={};function tu(t){ht(cl,t)}function ds(){const t=gt(cl);if(!t)throw new Error("No DialogPageHeightContext found");return t}function nu(t,e){Ce(e,!0);let a=R(200);tu({setDialogPageHeight:l=>{f(a,l,!0)},getDialogPageHeight:()=>n(a)});var s=ye(),i=D(s);je(i,()=>e.children??Xe),g(t,s),ke()}const au=[ur,Jn,ot,Ut,Ad];function ru(){return new Promise((t,e)=>{const a=indexedDB.open(Ed,Nd);St(a,"upgradeneeded",()=>{const r=a.result;for(const o of au)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),St(a,fa,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),St(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),St(a,Un,()=>{e(),console.error(Un,a.error)})})}function ou(t,e){Ce(e,!0);let a=R(null);Pe(()=>{ru().then(l=>{f(a,l,!0)}).catch(l=>{console.error("Failed to initialize LocalDB:",l)})}),xd({getDB:()=>n(a)});var o=ye(),s=D(o);{var i=l=>{var d=ye(),c=D(d);je(c,()=>e.children??Xe),g(l,d)};W(s,l=>{n(a)&&l(i)})}g(t,o),ke()}function su(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Bt(),s=P(a);let i=P(()=>n(s).get(tn)||""),l=P(()=>n(i).split(",").map(_=>decodeURIComponent(_)).filter(_=>_!==""));const d=()=>n(l),c=_=>{if(_.length===0){o(tn);return}r(tn,_.map(y=>encodeURIComponent(y)).join(","))},u=_=>{r(tn,[...n(l),_].map(y=>encodeURIComponent(y)).join(","))};Wd({setDialogPages:c,getDialogPages:d,pushDialogPage:u,popDialogPage:()=>{const _=n(l)[n(l).length-1];return n(l).length<=1?(o(tn),_):(r(tn,n(l).slice(0,-1).map(y=>encodeURIComponent(y)).join(",")),_)},replaceDialogPage:_=>{r(tn,[...n(l).slice(0,-1),_].map(y=>encodeURIComponent(y)).join(","))},hasDialogPage:_=>n(l).find(y=>{const[T]=y.split("?");return T===_})!==void 0,clearDialogPages:()=>{o(tn)},createDialogPageHref:_=>{const y=new URLSearchParams(n(s).toString());return y.set(tn,[...d(),_].map(T=>encodeURIComponent(T)).join(",")),`${window.location.pathname}?${y.toString()}`},createHandleClickDialogPage:_=>y=>{y.preventDefault(),u(_)}});var C=ye(),N=D(C);je(N,()=>e.children??Xe),g(t,C),ke()}function iu(t,e){Ce(e,!0);let a=R(ft(new URLSearchParams(window.location.search)));const r=v=>{const h=window.location.pathname;f(a,v,!0),window.history.replaceState(null,"",`${h}${v.size>0?`?${v.toString()}`:""}`)};dd({getSearchParams:()=>n(a),replaceSearchParams:v=>{const h=new URLSearchParams(v);r(h)},setSearchParam:(v,h)=>{const p=new URLSearchParams(n(a));p.set(v,h),r(p)},deleteSearchParam:v=>{const h=new URLSearchParams(n(a));h.delete(v),r(h)},getHref:(v=n(a))=>{const h=new URLSearchParams(v);return`${window.location.pathname}${h.toString().length>0?`?${h.toString()}`:""}`},clearSearchParams:()=>{r(new URLSearchParams)}});var c=ye(),u=D(c);je(u,()=>e.children??Xe),g(t,c),ke()}const dl={};function lu(t){ht(dl,t)}function cu(){const t=gt(dl);if(!t)throw new Error("No KeyboardVisibleContext found");return t}function du(t,e){Ce(e,!0);let a=ft({value:!1});const r=()=>a.value,o=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";Pe(()=>{const l=()=>{setTimeout(()=>{o()?a.value=!0:a.value=!1},0)};return l(),document.addEventListener("focusin",l),document.addEventListener("focusout",l),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",l)}}),lu({getIsKeyboardVisible:r});var s=ye(),i=D(s);je(i,()=>e.children??Xe),g(t,s),ke()}function uu(t,e){Ce(e,!0);const a=crypto.randomUUID(),r=(i,l)=>{i.postMessage(JSON.stringify({...l,tabId:a}))};Pd({tabId:a,createBroadcastChannel:()=>{const i=new BroadcastChannel("app");return{postMessage:l=>r(i,l),addEventListener:l=>{i.addEventListener("message",l)},removeEventListener:l=>{i.removeEventListener("message",l)}}}});var o=ye(),s=D(o);je(s,()=>e.children??Xe),g(t,o),ke()}function fu(t,e){ou(t,{children:(a,r)=>{uu(a,{children:(o,s)=>{qd(o,{children:(i,l)=>{Yd(i,{children:(d,c)=>{Jd(d,{children:(u,v)=>{Qd(u,{children:(h,p)=>{eu(h,{children:(w,x)=>{nu(w,{children:(m,C)=>{du(m,{children:(N,_)=>{iu(N,{children:(y,T)=>{su(y,{children:(j,K)=>{var O=ye(),z=D(O);je(z,()=>e.children??Xe),g(j,O)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function vu(t,e){fu(t,{children:(a,r)=>{gd(a,{children:(o,s)=>{ud(o,{children:(i,l)=>{pd(i,{children:(d,c)=>{_d(d,{children:(u,v)=>{jd(u,{children:(h,p)=>{yd(h,{children:(w,x)=>{Sd(w,{children:(m,C)=>{Dd(m,{children:(N,_)=>{Id(N,{children:(y,T)=>{Fd(y,{children:(j,K)=>{Bd(j,{children:(O,z)=>{Vd(O,{children:(ae,le)=>{var G=ye(),B=D(G);je(B,()=>e.children??Xe),g(ae,G)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}const ul=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),bt=t=>{const e=ul(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let It=R(""),En=R(null),Ua=R(null),Dn=R(null),Xn=R(ft([])),Or=R(null),Zn=null;function nt(t,e){f(It,""),Zn=null,f(Ua,null),f(Dn,null),setTimeout(()=>{f(It,t,!0),e?.onFinish&&f(Ua,e.onFinish,!0),e?.cancel&&(f(Dn,e.cancel.onCancel,!0),Zn=e.cancel.nextFocusRef)},16)}var gu=k('<button type="button" class="c p-146w2pd">undo</button>'),hu=k('<div class="a p-146w2pd"><div class="b p-146w2pd"><span> </span> <!></div></div>'),pu=k("<div><!></div>");function go(t,e){Ce(e,!0);let a=ze(e,"ref",15,null);const r=An();Ve(()=>{a(n(En))}),Pe(()=>(f(Xn,[...n(Xn),r],!0),()=>{const c=n(Xn).indexOf(r);c!==-1&&f(Xn,n(Xn).filter((u,v)=>v!==c),!0)}));const o=c=>{if(c.key==="Tab"&&c.shiftKey){if(Zn&&n(It)){c.preventDefault();const{prev:u}=bt(Zn);u?.focus(),f(It,"")}}else if(c.key==="Tab"&&!c.shiftKey)Zn&&n(It)&&(c.preventDefault(),f(It,""),Zn?.focus());else if(c.key==="Escape"&&n(It)){if(c.preventDefault(),Zn){const{prev:u}=bt(Zn);u?.focus()}f(It,"")}};Pe(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)})),Ve(()=>{n(It);const c=n(Dn)?2e3:800;n(It)&&(n(En)?.getBoundingClientRect(),n(En)?.style.setProperty("opacity","1"));const u=setTimeout(()=>{n(En)?.style.removeProperty("opacity")},c),v=setTimeout(()=>{f(It,""),n(Ua)&&n(Ua)(),f(Ua,null),f(Dn,null),n(En)?.style.removeProperty("opacity")},c+400);return()=>{clearTimeout(u),clearTimeout(v)}});const s=c=>{c.preventDefault(),n(Dn)&&(f(Ua,null),n(Dn)(),f(Dn,null)),f(It,""),n(En)?.style.removeProperty("opacity")};Ve(()=>{n(It)&&n(Dn)&&n(Or)&&setTimeout(()=>{n(Or)?.focus()},151)}),Ve(()=>{n(Xn),Ot(()=>{f(It,""),n(En)?.style.removeProperty("opacity")})});var i=pu(),l=b(i);{var d=c=>{var u=hu(),v=b(u),h=b(v),p=b(h),w=M(h,2);{var x=m=>{var C=gu();C.__click=s,et(C,N=>f(Or,N),()=>n(Or)),g(m,C)};W(w,m=>{n(Dn)&&m(x)})}et(v,m=>f(En,m),()=>n(En)),Me(()=>vt(p,n(It))),g(c,u)};W(l,c=>{n(It)&&n(Xn)[n(Xn).length-1]===r&&c(d)})}g(t,i),ke()}pt(["click"]);var mu=k('<span class="a p-lxk90o"><!></span>');function _t(t,e){var a=mu(),r=b(a);je(r,()=>e.children),g(t,a)}var _u=Wc('<svg class="p-1yv1ibq"><use></use></svg>');function me(t,e){let a=ze(e,"name",8,"");var r=_u(),o=b(r);Me(()=>ut(o,"href",`#icon-${a()??""}`)),g(t,r)}var wu=k('<button class="a p-1cnj0y3"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function fl(t,e){Ce(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Ar(),{getDialogPages:s}=zt(),{checkExistedDialog:i}=Qt();let l=P(()=>s().length>0||i());const d=h=>{if(h.preventDefault(),n(l))return;const p=r();p==="closed"?a():p==="opened"&&o()};var c=wu();c.__click=d;var u=b(c);ge(u,()=>({"--size":"28px"})),me(u.lastChild,{name:"sidebarMenu"});var v=M(u,2);_t(v,{children:(h,p)=>{var w=We("Menu");g(h,w)}}),g(t,c),ke()}pt(["click"]);var yu=k('<button class="b p-3z9gmw"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),bu=k('<div class="a p-3z9gmw"><input class="p-3z9gmw"/> <!></div>');function jo(t,e){Ce(e,!0);let a=ze(e,"value",15,""),r=ze(e,"ref",15,null);const o=c=>{c.key==="Escape"&&(c.stopPropagation(),r()&&(e.onEscape?.(),r().blur()))};Pe(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=bu(),i=b(s);i.__input=c=>e.onChange?.(c.target?.value||""),et(i,c=>r(c),()=>r());var l=M(i,2);{var d=c=>{var u=yu();u.__click=()=>{a(""),e.onChange?.("")};var v=b(u);ge(v,()=>({"--size":"20px"})),me(v.lastChild,{name:"close"});var h=M(v,2);_t(h,{children:(p,w)=>{var x=We("Clear");g(p,x)}}),g(c,u)};W(l,c=>{a()&&c(d)})}Me(()=>ut(i,"placeholder",e.placeholder)),Zt("focus",i,function(...c){e.onFocus?.apply(this,c)}),Zt("blur",i,function(...c){e.onBlur?.apply(this,c)}),Fi(i,a),g(t,s),ke()}pt(["input","click"]);function us(t,e){Ce(e,!0);let a=ze(e,"notificationRef",11,null);Pe(()=>{const r=o=>{o.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==o.target&&!e.dialogInner.contains(o.target)&&a()!==o.target&&!a()?.contains(o.target)&&e.onClose()};return document.addEventListener("mousedown",r,{capture:!0}),()=>{document.removeEventListener("mousedown",r,{capture:!0})}}),ke()}function Cu(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const xn=Cu(),ku=()=>{const t=navigator.userAgent;return/android/i.test(t)},Wn=ku(),dp=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},up=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},yr=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))};let za=R(ft([]));var Su=k("<dialog><div><!></div></dialog> <!>",1);function Dr(t,e){Ce(e,!0);const a=An(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;Pe(()=>(f(za,[...n(za),a],!0),()=>{const _=n(za).indexOf(a);_!==-1&&f(za,n(za).filter((y,T)=>T!==_),!0)}));let o=ze(e,"onClosed",3,()=>{}),s=ze(e,"blocked",3,!1),i=R(null),l=R(null),d=R(!1),{dialogInc:c,dialogDec:u}=Qt();const v=()=>{const _=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(_),o()()},{once:!0}),f(d,!1)};Ve(()=>{e.startClose&&v()}),Pe(()=>{n(i)?.showModal(),n(i)?.getClientRects(),f(d,!0);const _=y=>{y?.preventDefault(),s()||v()};return n(i)?.addEventListener("cancel",_),n(i)?.addEventListener("close",_),()=>{n(i)?.removeEventListener("cancel",_),n(i)?.removeEventListener("close",_)}}),Pe(()=>(c(),()=>{u()})),Pe(()=>{const _=y=>{y.key==="Escape"&&s()&&y.preventDefault()};return window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}});function h(){setTimeout(()=>{if(xn||!n(i)||!n(l))return;const _=window.visualViewport;if(_)if(_.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},0)}Pe(()=>(h(),window.visualViewport?.addEventListener("resize",h),window.visualViewport?.addEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h),()=>{window.visualViewport?.removeEventListener("resize",h),window.visualViewport?.removeEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h)}));var p=Su(),w=D(p),x=b(w),m=b(x);je(m,()=>e.children),et(x,_=>f(l,_),()=>n(l)),et(w,_=>f(i,_),()=>n(i));var C=M(w,2);{var N=_=>{us(_,{get dialog(){return n(i)},get dialogInner(){return n(l)},onClose:v})};W(C,_=>{n(i)&&n(l)&&!s()&&_(N)})}Me(()=>{tt(w,1,at({a:!0,b:n(d),c:n(za).length>1}),"p-1x14yml"),tt(x,1,at({d:!0,b:n(d)}),"p-1x14yml")}),g(t,p),ke()}var xu=k("<div><!></div>");function Tu(t,e){Ce(e,!0);let a=R(!1),r=R(null),o=null;const s=()=>{const v=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(v),e.onClosed()},{once:!0}),f(a,!1)},i=v=>{v.target!==n(r)&&!n(r)?.contains(v.target)&&s()},l=v=>{v.target!==n(r)&&!n(r)?.contains(v.target)&&s()},d=v=>{if(v.key==="Escape"&&(v.preventDefault(),s()),v.key==="ArrowUp"||v.key==="ArrowDown"){if(!n(r))return;v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation();const h=ul(n(r));if(o){const p=h.indexOf(o),w=h[p-1],x=h[p+1];v.key==="ArrowUp"&&w?(w.focus(),o=w):v.key==="ArrowDown"&&x&&(x.focus(),o=x)}else v.key==="ArrowUp"?(h[h.length-1].focus(),o=h[h.length-1]):v.key==="ArrowDown"&&(h[0].focus(),o=h[0])}};Pe(()=>{n(r)?.getClientRects(),f(a,!0);const v=setTimeout(()=>{document.addEventListener("focusin",i),document.addEventListener("click",l),document.addEventListener("keydown",d,{capture:!0})},0);return()=>{clearTimeout(v),document.removeEventListener("focusin",i),document.removeEventListener("click",l),document.removeEventListener("keydown",d,{capture:!0})}}),Ve(()=>{e.startClose&&s()});var c=xu(),u=b(c);je(u,()=>e.children),et(c,v=>f(r,v),()=>n(r)),Me(()=>tt(c,1,at({a:!0,b:n(a)}),"p-1unpq18")),g(t,c),ke()}var Pu=k("<ul><!></ul>"),Eu=k("<ul><!></ul>");function Mr(t,e){Ce(e,!0);let a=ze(e,"ref",15);var r=ye(),o=D(r);{var s=l=>{Dr(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(d,c)=>{var u=Pu(),v=b(u);je(v,()=>e.children),et(u,h=>a(h),()=>a()),Me(()=>tt(u,1,at({a:!0,b:e.isMobile}),"p-6pddb9")),g(d,u)},$$slots:{default:!0}})},i=l=>{Tu(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(d,c)=>{var u=Eu(),v=b(u);je(v,()=>e.children),et(u,h=>a(h),()=>a()),Me(()=>tt(u,1,at({a:!0,b:e.isMobile}),"p-6pddb9")),g(d,u)},$$slots:{default:!0}})};W(o,l=>{e.isMobile?l(s):l(i,!1)})}g(t,r),ke()}var Nu=k("<button><!></button>"),Au=k("<a><!></a>");function He(t,e){let a=ze(e,"dangerous",3,!1),r=ze(e,"type",3,"button"),o=ze(e,"href",3,"");var s=ye(),i=D(s);{var l=c=>{var u=Nu();u.__click=function(...h){e.onClick?.apply(this,h)},u.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=b(u);je(v,()=>e.children??Xe),Me(()=>tt(u,1,at({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")),g(c,u)},d=c=>{var u=Au();u.__click=function(...h){e.onClick?.apply(this,h)},u.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=b(u);je(v,()=>e.children??Xe),Me(()=>{ut(u,"href",o()),tt(u,1,at({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")}),g(c,u)};W(i,c=>{r()==="button"?c(l):c(d,!1)})}g(t,s)}pt(["click","keydown"]);var Du=k('<li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li>',1),Mu=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Iu=k('<div class="a p-108u1na"><button><!> <!></button> <!></div>');function Lu(t,e){Ce(e,!0);let a=R(!1),r=R(!1);const{getFeedOrder:o,setFeedOrder:s}=Hi();let i=xn||Wn,l=P(o);const d=()=>{n(a)||f(a,!0)},c=C=>{f(r,!0),s(C)},u=()=>{f(a,!1),f(r,!1)};Pe(()=>{const C=N=>{N.key==="Escape"&&f(r,!0)};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)});var v=Iu(),h=b(v);h.__click=d,tt(h,1,at({b:!0,c:!0}),"p-108u1na");var p=b(h);me(p,{name:"filter"});var w=M(p,2);_t(w,{children:(C,N)=>{var _=We("show feed order menu");g(C,_)}});var x=M(h,2);{var m=C=>{var N=Mu(),_=D(N);ge(_,()=>({"--right":"0px","--top":"44px"})),Mr(_.lastChild,{get startClose(){return n(r)},onClosed:u,get isMobile(){return i},children:(y,T)=>{var j=Du(),K=D(j),O=b(K);{let Z=P(()=>n(l)==="newest");He(O,{get active(){return n(Z)},get dialogMode(){return i},onClick:()=>c("newest"),children:(H,te)=>{var ve=We("Newest");g(H,ve)},$$slots:{default:!0}})}var z=M(K,2),ae=b(z);{let Z=P(()=>n(l)==="oldest");He(ae,{get active(){return n(Z)},get dialogMode(){return i},onClick:()=>c("oldest"),children:(H,te)=>{var ve=We("Oldest");g(H,ve)},$$slots:{default:!0}})}var le=M(z,2),G=b(le);{let Z=P(()=>n(l)==="AtoZ");He(G,{get active(){return n(Z)},get dialogMode(){return i},onClick:()=>c("AtoZ"),children:(H,te)=>{var ve=We("A to Z");g(H,ve)},$$slots:{default:!0}})}var B=M(le,2),F=b(B);{let Z=P(()=>n(l)==="ZtoA");He(F,{get active(){return n(Z)},get dialogMode(){return i},onClick:()=>c("ZtoA"),children:(H,te)=>{var ve=We("Z to A");g(H,ve)},$$slots:{default:!0}})}var pe=M(B,2),Se=b(pe);{let Z=P(()=>n(l)==="updatedNewest");He(Se,{get active(){return n(Z)},get dialogMode(){return i},onClick:()=>c("updatedNewest"),children:(H,te)=>{var ve=We("Updated");g(H,ve)},$$slots:{default:!0}})}g(y,j)},$$slots:{default:!0}}),g(C,N)};W(x,C=>{n(a)&&C(m)})}g(t,v),ke()}pt(["click"]);var Ru=k('<div><!> <div class="a p-y3zt6o"></div></div>');function Ia(t,e){Ce(e,!0);let a=R(!1);Pe(()=>{const s=setTimeout(()=>{f(a,!0)},200);return()=>{clearTimeout(s)}});var r=Ru(),o=b(r);je(o,()=>e.children??Xe),Me(()=>tt(r,1,at({b:!0,c:n(a)}),"p-y3zt6o")),g(t,r),ke()}var Fu=k("<a><!></a>"),Ou=k("<button><!></button>");function Rt(t,e){let a=ze(e,"type",3,"standard"),r=ze(e,"typeButton",3,"button"),o=ze(e,"element",3,"button"),s=ze(e,"href",3,""),i=ze(e,"fullWidth",3,!1),l=ze(e,"withoutMinWidth",3,!1);var d=ye(),c=D(d);{var u=h=>{var p=Fu();p.__click=function(...x){e.onClick?.apply(this,x)};var w=b(p);je(w,()=>e.children??Xe),Me(()=>{ut(p,"target",e.target),ut(p,"rel",e.rel),ut(p,"href",s()),tt(p,1,at({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,p)},v=h=>{var p=Ou();p.__click=function(...x){e.onClick?.apply(this,x)};var w=b(p);je(w,()=>e.children??Xe),Me(()=>{ut(p,"type",r()),tt(p,1,at({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,p)};W(c,h=>{o()==="a"?h(u):h(v,!1)})}g(t,d)}pt(["click"]);let Ho=R(!1),zr=R(!1),Uo=R(""),Wo=R("Cancel"),Vo=R("Confirm"),Ko,Wr=R(void 0),qo,Go=R("dangerous");function Va(t){f(Ho,!0),f(Uo,t.title,!0),t.buttonCancelTitle&&f(Wo,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&f(Vo,t.buttonConfirmTitle,!0),Ko=t.onConfirm,f(Wr,t.onCancel,!0),qo=t.onClosed,t.type?f(Go,t.type,!0):f(Go,"dangerous")}var zu=k('<span class="b p-1jg69ok"> </span> <div class="c p-1jg69ok"><!> <!></div>',1),Bu=k('<div class="a p-1jg69ok"><!></div>');function ju(t,e){Ce(e,!0);let a=R(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{f(a,!0)},250)};Pe(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(Wr)?.(),f(zr,!0)},l=async()=>{s(),await Ko?.(),f(zr,!0),o=!0},d=()=>{clearTimeout(r),f(a,!1),f(Ho,!1),f(zr,!1),f(Uo,""),f(Wo,"Cancel"),f(Vo,"Confirm"),f(Wr,void 0),Ko=void 0,qo&&qo(o),o=!1};var c=ye(),u=D(c);{var v=h=>{Dr(h,{get blocked(){return n(a)},get startClose(){return n(zr)},onClosed:d,children:(p,w)=>{var x=Bu(),m=b(x);{var C=_=>{Ia(_,{})},N=_=>{var y=zu(),T=D(y),j=b(T),K=M(T,2),O=b(K);{var z=le=>{Rt(le,{size:"small",onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(G,B)=>{var F=We();Me(()=>vt(F,n(Wo))),g(G,F)},$$slots:{default:!0}})};W(O,le=>{n(Wr)&&le(z)})}var ae=M(O,2);Rt(ae,{size:"small",onClick:l,fullWidth:!0,withoutMinWidth:!0,get type(){return n(Go)},children:(le,G)=>{var B=We();Me(()=>vt(B,n(Vo))),g(le,B)},$$slots:{default:!0}}),Me(()=>vt(j,n(Uo))),g(_,y)};W(m,_=>{n(a)?_(C):_(N,!1)})}g(p,x)},$$slots:{default:!0}})};W(u,h=>{n(Ho)&&h(v)})}g(t,c),ke()}const br=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,l=a.ctrlKey,d=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!l&&!!t.shift==!!d){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var Hu=k('<div class="a p-6qmscy"><a class="b p-6qmscy"><span class="c p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function Uu(t,e){Ce(e,!1);const{createDialogPageHref:a,createHandleClickDialogPage:r,getDialogPages:o,pushDialogPage:s}=zt(),{checkExistedDialog:i}=Qt(),l=()=>{o.length===0&&!i()&&s(Te.NewNote)};Pe(()=>br({key:"n",action:l})),ss();var d=Hu(),c=b(d),u=P(()=>r(Te.NewNote));c.__click=function(...m){n(u)?.apply(this,m)};var v=b(c),h=b(v);ge(h,()=>({"--size":"28px","--color":"#b0b0b0"})),me(h.lastChild,{name:"add"});var p=M(h,2);_t(p,{children:(m,C)=>{var N=We("Add note");g(m,N)}});var w=M(v,2),x=b(w);ge(x,()=>({"--size":"16px","--color":"#b0b0b0"})),me(x.lastChild,{name:"plus"}),Me(m=>ut(c,"href",m),[()=>a(Te.NewNote)]),g(t,d),ke()}pt(["click"]);var Wu=k("<button><!></button>");function ga(t,e){Ce(e,!0);let a=ze(e,"type",3,"button"),r=!1,o=R(null);Ve(()=>{e.onRef&&e.onRef(n(o))});const s=u=>{(u.key==="Enter"||u.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},l=u=>{(u.pointerType==="mouse"&&u.button===0||u.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(u)};var d=Wu();d.__keydown=s,d.__click=i,d.__pointerdown=l,d.__touchstart=function(...u){e.onTouchStart?.apply(this,u)};var c=b(d);je(c,()=>e.children??Xe),et(d,u=>f(o,u),()=>n(o)),Me(()=>{ut(d,"type",a()),d.disabled=e.disabled,tt(d,1,at({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty"}),"p-19nhjik")}),g(t,d),ke()}pt(["keydown","click","pointerdown","touchstart"]);var Vu=k('<div class="b p-1pt17hy"> </div>'),Ku=k('<div class="a p-1pt17hy"><input/> <!></div>');function Cr(t,e){Ce(e,!0);let a=ze(e,"value",15,""),r=ze(e,"error",3,""),o=ze(e,"ref",15,null);var s=Ku(),i=b(s);i.__input=function(...u){e.onInput?.apply(this,u)};let l;et(i,u=>o(u),()=>o());var d=M(i,2);{var c=u=>{var v=Vu(),h=b(v);Me(()=>vt(h,r())),g(u,v)};W(d,u=>{r()&&u(c)})}Me(()=>{ut(i,"placeholder",e.placeholder),l=tt(i,1,"p-1pt17hy",null,l,{error:!!r()})}),Zt("blur",i,function(...u){e.onBlur?.apply(this,u)}),Zt("focus",i,function(...u){e.onFocus?.apply(this,u)}),Fi(i,a),g(t,s),ke()}pt(["input"]);var qu=k('<div class="b p-z67y1l"> </div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Gu=k('<form class="a p-z67y1l"><!></form>');function Yu(t,e){Ce(e,!0);const{renameTag:a}=At(),{getSelectedTags:r,setSelectedTags:o}=qn(),{getSelectedNotes:s,setSelectedNotes:i,clearNotes:l}=ua(),{getFiltredNotes:d}=Ma();let c=R(!1),u=R(!1),v,h=!1,p=R(null),w=R(ft(e.tag)),x=e.nextFocusRef;Pe(()=>(n(p)&&n(p).focus(),()=>{v&&clearTimeout(v)}));const m=()=>{v=setTimeout(()=>{f(u,!0)},250)},C=()=>{f(c,!0)},N=async()=>{if(n(w).trim()===e.tag){C();return}if(n(w).trim()!=="")try{m();const T=r(),j=[...T].map(le=>le===e.tag?n(w).trim():le),K=new Set(s()),O=d(),z=K.size?[...K]:O.map(le=>le.id),{cancel:ae}=await a(e.tag,n(w).trim(),z);l(),o(new Set(j)),nt("Tag renamed",{cancel:{nextFocusRef:x,onCancel:async()=>{await ae(),o(T),i(K),setTimeout(()=>{const{prev:le}=bt(x);le?.focus()},16)}}}),h=!0}finally{f(c,!0)}},_=()=>{e.onClosed?.(h)},y=T=>{T.preventDefault(),N()};Dr(t,{get blocked(){return n(u)},get startClose(){return n(c)},onClosed:_,children:(T,j)=>{var K=Gu(),O=b(K);{var z=le=>{Ia(le,{})},ae=le=>{var G=qu(),B=D(G),F=b(B),pe=M(B,2);Cr(pe,{placeholder:"Enter new tag name",get ref(){return n(p)},set ref(te){f(p,te,!0)},get value(){return n(w)},set value(te){f(w,te,!0)}});var Se=M(pe,2),Z=b(Se);Rt(Z,{size:"small",onClick:C,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(te,ve)=>{var ue=We("Cancel");g(te,ue)},$$slots:{default:!0}});var H=M(Z,2);Rt(H,{size:"small",onClick:N,fullWidth:!0,withoutMinWidth:!0,children:(te,ve)=>{var ue=We("OK");g(te,ue)},$$slots:{default:!0}}),Me(()=>vt(F,`Rename "${e.tag??""}" for selected notes`)),g(le,G)};W(O,le=>{n(u)?le(z):le(ae,!1)})}Zt("submit",K,y),g(T,K)},$$slots:{default:!0}}),ke()}let na=R(!1),ha=R(!1),Yt=R(""),pa=R(0),fr=R(0),vr=R(0),Vr,Xr=()=>({bottom:0,right:0,height:0}),$t=R(null),Yo=R(null);function Xu(t){if(n(na)){f(ha,!0),n(Yt)!==t.tag&&(Vr=()=>{const a=t.getRect();f(na,!0),f(Yt,t.tag,!0),f(pa,a.bottom,!0),f(fr,a.right,!0),f(vr,a.height,!0),Xr=t.getRect,f($t,t.focusRef,!0)});return}const e=t.getRect();f(na,!0),f(Yt,t.tag,!0),f(pa,e.bottom,!0),f(fr,e.right,!0),f(vr,e.height,!0),Xr=t.getRect,f($t,t.focusRef,!0)}const Ju=()=>n(na),Zu=()=>n(Yo);var Qu=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),$u=k('<li class="p-16hbyw2"><!></li>'),ef=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),tf=k('<li class="p-16hbyw2"><!></li>'),nf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),af=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),rf=k('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),of=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),sf=k("<!> <!>",1);function lf(t,e){Ce(e,!0);const{getScrollContainer:a}=vo(),{pinTag:r,getGetMapTags:o,deleteTag:s}=At(),{checkMobileSize:i}=va(),{getSelectedTags:l,removeTag:d,setSelectedTags:c}=qn(),{getSelectedNotes:u,setSelectedNotes:v,clearNotes:h}=ua(),{getFiltredNotes:p}=Ma();let w=R(!1);Ve(()=>{n(na),Ot(()=>{f(w,o()().get(n(Yt))?.pinned||!1,!0)})});let x=R(!1);const m=()=>{r(n(Yt),!0),f(ha,!0);let Z=n($t),H=bt(Z)?.next;nt("Tag pinned",{cancel:{nextFocusRef:H,onCancel:async()=>{r(n(Yt),!1),setTimeout(()=>{const{prev:te}=bt(H);te?.focus()},16)}}})},C=()=>{r(n(Yt),!1),f(ha,!0);let Z=n($t),H=bt(Z)?.next;nt("Tag unpinned",{cancel:{nextFocusRef:H,onCancel:async()=>{r(n(Yt),!0),setTimeout(()=>{const{prev:te}=bt(H);te?.focus()},16)}}})},N=()=>{f(na,!1),f(ha,!1),f(pa,0),f(fr,0),f(vr,0),Xr=()=>({bottom:0,right:0,height:0}),f($t,null),Vr&&setTimeout(()=>{Vr?.(),Vr=void 0})};let _=P(()=>window.innerHeight-n(pa)<100?n(pa)-n(vr)-98+"px":n(pa)+5+"px"),y=P(a);const T=Z=>{Z.key==="Tab"&&Z.shiftKey&&(Z.preventDefault(),n($t)?.focus())},j=Z=>{Z.key==="Tab"&&!Z.shiftKey&&n($t)&&(Z.preventDefault(),bt(n($t))?.next?.focus())};Pe(()=>{const Z=H=>{H.key==="Escape"&&n(na)&&n($t)?.focus()};return window.addEventListener("keydown",Z),()=>{window.removeEventListener("keydown",Z)}});const K=()=>{f(ha,!0);let Z=n($t),H=bt(Z)?.next;Va({title:`Are you sure to delete "${n(Yt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const te=Array.from(n(ae)),ve=new Set(u()),ue=p(),re=ve.size?[...ve]:ue.map(_e=>_e.id);n(ae).has(n(Yt))&&(ve.size===0||ue.length===ve.size)&&d(n(Yt)),h();const{cancel:oe}=await s(n(Yt),re);nt("Tag deleted",{cancel:{nextFocusRef:H,onCancel:async()=>{await oe(),c(new Set(te)),v(new Set(ve)),setTimeout(()=>{const{prev:_e}=bt(H);_e?.focus()},16)}}})},onCancel:async()=>{},onClosed:te=>{setTimeout(()=>{te||Z?.focus()},16)}})};let O=()=>{};const z=()=>{f(ha,!0),f(x,!0);let Z=n($t);O=()=>{f(x,!1),setTimeout(()=>{Z?.focus()},16)}};Ve(()=>{const Z=()=>{const H=Xr();f(pa,H.bottom,!0),f(fr,H.right,!0),f(vr,H.height,!0)};return n(y)?.addEventListener("scroll",Z),window.addEventListener("resize",Z),()=>{n(y)?.removeEventListener("scroll",Z),window.removeEventListener("resize",Z)}});let ae=P(l),le=P(i);var G=sf(),B=D(G);{var F=Z=>{var H=of(),te=D(H);ge(te,()=>({"--left":n(fr)-36+"px","--top":n(_),"--transform-origin":"top left"})),Mr(te.lastChild,{get startClose(){return n(ha)},onClosed:N,get isMobile(){return n(le)},get ref(){return n(Yo)},set ref(ve){f(Yo,ve,!0)},children:(ve,ue)=>{var re=rf(),oe=D(re);{var _e=Ee=>{var Ae=$u(),he=b(Ae);He(he,{onClick:m,onKeydown:T,get dialogMode(){return n(le)},children:(ce,xe)=>{var we=Qu(),Le=D(we);ge(Le,()=>({"--size":"20px"})),me(Le.lastChild,{name:"pin"}),g(ce,we)},$$slots:{default:!0}}),g(Ee,Ae)},de=Ee=>{var Ae=tf(),he=b(Ae);He(he,{onClick:C,onKeydown:T,get dialogMode(){return n(le)},children:(ce,xe)=>{var we=ef(),Le=D(we);ge(Le,()=>({"--size":"20px"})),me(Le.lastChild,{name:"pin-cancel"}),g(ce,we)},$$slots:{default:!0}}),g(Ee,Ae)};W(oe,Ee=>{n(w)?Ee(de,!1):Ee(_e)})}var se=M(oe,2),Q=b(se);He(Q,{onClick:z,get dialogMode(){return n(le)},children:(Ee,Ae)=>{var he=nf(),ce=D(he);ge(ce,()=>({"--size":"20px","--scale":"0.9"})),me(ce.lastChild,{name:"pen"}),g(Ee,he)},$$slots:{default:!0}});var ie=M(se,2),fe=b(ie);He(fe,{onClick:K,onKeydown:j,get dialogMode(){return n(le)},children:(Ee,Ae)=>{var he=af(),ce=D(he);ge(ce,()=>({"--size":"20px"})),me(ce.lastChild,{name:"bin"}),g(Ee,he)},$$slots:{default:!0}}),g(ve,re)},$$slots:{default:!0}}),g(Z,H)};W(B,Z=>{n(na)&&Z(F)})}var pe=M(B,2);{var Se=Z=>{{let H=P(()=>bt(n($t))?.next||null);Yu(Z,{get tag(){return n(Yt)},get nextFocusRef(){return n(H)},onClosed:te=>{O(te)}})}};W(pe,Z=>{n(x)&&Z(Se)})}g(t,G),ke()}var cf=k('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),df=k('<button><span class="b p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),uf=k("<!> <span> </span> <!>",1),ff=k('<div class="a p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function gr(t,e){Ce(e,!0);let{getGetMapTags:a}=At(),r=R(null),o=P(Ju);const s=()=>{if(n(r)){const v=n(r).getBoundingClientRect();return{bottom:v.bottom,right:v.right,height:v.height}}return{bottom:0,right:0,height:0}},i=v=>{v.stopPropagation(),v.preventDefault(),Xu({tag:e.tag,getRect:s,focusRef:n(r)})},l=v=>{v.key==="Tab"&&!v.shiftKey&&n(o)&&(v.preventDefault(),Zu()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let d=P(()=>a()().get(e.tag)?.pinned||!1);var c=ff(),u=b(c);ge(u,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),ga(u.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(v,h)=>{var p=uf(),w=D(p);{var x=y=>{var T=cf(),j=b(T);ge(j,()=>({"--size":"18px"})),me(j.lastChild,{name:"pin"}),g(y,T)};W(w,y=>{n(d)&&y(x)})}var m=M(w,2),C=b(m),N=M(m,2);{var _=y=>{var T=df();T.__click=i,T.__keydown=l;var j=b(T),K=b(j);ge(K,()=>({"--size":"16px"})),me(K.lastChild,{name:"menu"});var O=M(K,2);_t(O,{children:(z,ae)=>{var le=We("Tag options");g(z,le)}}),et(T,z=>f(r,z),()=>n(r)),Me(()=>tt(T,1,at({c:!0,d:e.type==="selected"}),"p-9jjlcl")),g(y,T)};W(N,y=>{e.hideMenu||y(_)})}Me(()=>vt(C,e.tag)),g(v,p)},$$slots:{default:!0}}),g(t,c),ke()}pt(["click","keydown"]);var vf=k('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function Ms(t,e){Ce(e,!0);let a=ze(e,"mobile",3,!1);const{getGetMapTags:r}=At();let s=P(()=>{const p=r()();return[...e.tags].sort((w,x)=>p.get(w)?.pinned?-1:p.get(x)?.pinned?1:w.localeCompare(x))}),i=P(()=>n(s).filter(p=>r()().get(p)?.pinned)),l=P(()=>n(s).filter(p=>!r()().get(p)?.pinned));var d=vf(),c=b(d),u=b(c);Bn(u,16,()=>n(i),p=>p,(p,w)=>{gr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return w},onClick:()=>{e.handleTagClick(w)}})});var v=M(u,2);Bn(v,17,()=>e.metaTags,p=>"meta"+p,(p,w)=>{gr(p,{hideMenu:!0,get tag(){return n(w)},onClick:()=>{e.handleMetaTagClick(n(w))}})});var h=M(v,2);Bn(h,16,()=>n(l),p=>p,(p,w)=>{gr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return w},onClick:()=>{e.handleTagClick(w)}})}),Me(()=>tt(c,1,at({b:!0,c:a()}),"p-lawyrs")),g(t,d),ke()}var gf=k('<div class="b c p-32813r"><div class="d p-32813r"><button class="e p-32813r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),hf=k('<div class="a p-32813r"><!></div>');function Is(t,e){Ce(e,!0);let a=R(null);const r=d=>{f(a,d,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};Ve(()=>{n(a)&&n(a).focus()});var s=hf(),i=b(s);{var l=d=>{var c=gf(),u=b(c),v=b(u);v.__click=o;var h=b(v);ge(h,()=>({"--size":"20px"})),me(h.lastChild,{name:"close"});var p=M(h,2);_t(p,{children:(m,C)=>{var N=We("Clear");g(m,N)}});var w=M(u,2);Bn(w,19,()=>e.metaTags,m=>"meta_"+m,(m,C,N)=>{{let _=P(()=>n(N)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);gr(m,{hideMenu:!0,type:"selected",get tag(){return n(C)},onClick:()=>{e.handleMetaTagClick(n(C))},get onRef(){return n(_)}})}});var x=M(w,2);Bn(x,18,()=>e.selectedTags,m=>m,(m,C,N)=>{{let _=P(()=>n(N)===e.selectedTags.size-1?r:void 0);gr(m,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return C},onClick:()=>{e.handleSelectedTagClick(C)},get onRef(){return n(_)}})}}),g(d,c)};W(i,d=>{e.selectedTags.size+e.metaTags.size>0&&d(l)})}g(t,s),ke()}pt(["click"]);const Xo=(t,e,a,r)=>{if(t.has(st.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const l of i?.data?.tags||[])o.includes(l)||o.push(l);continue}if(i.data&&s.every(l=>i.data?.tags.includes(l)))for(const l of i.data.tags||[])!e.has(l)&&!o.includes(l)&&o.push(l)}return o},jn=200,pf=t=>t<.5?2*t*t:-1+(4-2*t)*t,vl=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,pf(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},mf=t=>{const{getIsKeyboardVisible:a}=cu();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},l=v=>({x:v.clientX,y:v.clientY,time:performance.now()}),d=v=>{r=[l(v.touches[0])],o=!0},c=v=>{if(!o||s)return;r.push(l(v.touches[0]));const h=performance.now()-150;r=r.filter(K=>K.time>=h);const p=r.at(-1),w=r[0];if(!p||!w)return;const x=w.x,m=w.y,C=p.x,N=p.y,_=C-x,y=N-m,T=Math.abs(_)>Math.abs(y),j=Math.abs(_)>3;T&&j&&!a()&&(s=!0,v.preventDefault(),t([...r]),i())},u=()=>{i()};Pe(()=>(document.addEventListener("touchstart",d,{passive:!0}),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",u,{passive:!0}),document.addEventListener("touchcancel",u,{passive:!0}),()=>{document.removeEventListener("touchstart",d),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",u),document.removeEventListener("touchcancel",u)}))},Ls=5,Rs=.6,ca=.3;function gl(t,e){Ce(e,!0);let a=[],r=0,o=!1,s=0,i=0,l=0,d=0,c=0,u=null,v=null;const h=()=>{a=[],r=0,o=!1,s=0,i=0,l=0,d=0,c=0,u!==null&&(cancelAnimationFrame(u),u=null),v&&(clearTimeout(v),v=null)},p=()=>{e.onCancel(),h()},w=()=>{v&&clearTimeout(v),v=setTimeout(p,5e3)};mf(async j=>{if(!o)try{const K=j.at(-1);if(!K)throw new Error("No points available for swipe initialization");const O=await e.onInit();if(!O)return;s=O.initialPosition,i=O.currentPosition,l=O.minPosition,d=O.maxPosition,c=O.width,r=K.x,a=j,o=!0,w()}catch(K){console.error("Error during swipe initialization:",K),h()}});const m=j=>Math.max(l,Math.min(d,j)),C=()=>{if(u=null,!o){h();return}const j=a.at(-1),K=a[0];if(!j||!K)return;let O=j.x-r;r=j.x;const z=m(i+O);z!==i&&(i=z,e.onUpdate({initialPosition:s,newPosition:z,width:c,minPosition:l,maxPosition:d}))},N=j=>{if(!o){h();return}a.push({x:j.touches[0].clientX,y:j.touches[0].clientY,time:performance.now()});const K=performance.now()-150;a=a.filter(le=>le.time>=K),u===null&&(u=requestAnimationFrame(C)),w();const O=j.touches[0].clientX-a[0].x,z=j.touches[0].clientY-a[0].y;Math.abs(O)>Math.abs(z)&&j.cancelable&&j.preventDefault()},_=j=>{const K=Math.abs(j);if(K>=Rs)return Ls;if(K>=ca){const O=(K-ca)/(Rs-ca);return e.baseActionThreshold-O*(e.baseActionThreshold-Ls)}else return e.baseActionThreshold},y=j=>{if(!o){h();return}let K=0;a.push({x:j.changedTouches[0].clientX,y:j.changedTouches[0].clientY,time:performance.now()}),C(),u!==null&&(cancelAnimationFrame(u),u=null);const O=a[0],z=a[a.length-1],ae=z.x-O.x,le=z.time-O.time;le>0&&(K=ae/le);const G=_(K);e.onFinish({swipeVelocity:K,currentPosition:i,minPosition:l,maxPosition:d,initialPosition:s,width:c,actionThreshold:G}),h()},T=()=>{p()};Pe(()=>(document.addEventListener("touchmove",N,{passive:!1}),document.addEventListener("touchend",y,{passive:!0}),document.addEventListener("touchcancel",T,{passive:!0}),()=>{document.removeEventListener("touchmove",N),document.removeEventListener("touchend",y),document.removeEventListener("touchcancel",T),u!==null&&cancelAnimationFrame(u),v&&clearTimeout(v)})),ke()}function _f(t,e){Ce(e,!0);const a=Gn();let r=ze(e,"animationRef",7),o=ze(e,"dialog",7);gl(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const c=-e.dialogWidth*.7,u=0;let v=e.sidebarState==="closed"?c:u,h=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let x=()=>1;if(r().current){r().current.pause();let m=Number(r().current.currentTime);yr()&&(m=Number(m)+50,r().current.currentTime=Math.min(Math.max(jn-1,m),m));const C=r().current.effect?.getComputedTiming().progress||0;x=()=>C,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(m=>requestAnimationFrame(m)),h=Math.abs(1-x())}h=e.sidebarState==="closed"?h:1-h,o().style.setProperty("--backdrop-bg",`${h*.1}`),o()&&!o().open&&(o().showModal(),yr()&&o().getBoundingClientRect()),a.isSwiping=!0,a.duration=0,a.swipingRatio=h*-25;const p=h*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let w=e.sidebarState==="closed"?c:u;return e.sidebarState==="opened"||e.sidebarState==="closed"||(w=p),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:v,currentPosition:w,minPosition:c,maxPosition:u,width:e.dialogWidth}},onCancel:()=>{a.isSwiping=!1,e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:c,width:u})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const v=1-Math.abs(c/u)/7*10;o().style.transform=`translate3d(${c}px, 0, 0)`,a.swipingRatio=v*-25,o().style.setProperty("--backdrop-bg",`${v*.1}`)},onFinish:({swipeVelocity:c,currentPosition:u,initialPosition:v,width:h,actionThreshold:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let w="close";const x=Math.abs(u-v)/h*100/7*10;if(x===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(x===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?w=Math.abs(x)>p||c>ca?"open":"close":e.sidebarState==="swipingClose"&&(w=Math.abs(x)>p&&c<=ca||c<-ca?"close":"open");let m=vl(Math.abs(x)/100);e.sidebarState==="swipingClose"&&w==="close"&&(m=1-m);const C=(w==="open"?1-m:m)*jn;a.duration=C/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),o().style.setProperty("--backdrop-bg",`${w==="open"?.1:0}`),w==="open"?e.onOpen():w==="close"&&e.onClose()}}),ke()}var wf=k("<dialog><div><!> <!></div></dialog> <!> <!>",1);function yf(t,e){Ce(e,!0);const{getSidebarState:a,setSidebarState:r}=Ar();let o=R(0);Pe(()=>{const F=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",F),F(),()=>{window.removeEventListener("resize",F)}});const s=Gn(),{isScrolling:i}=cs();let l=R(null),d=R(null),c={},u=P(a);const v=()=>{e.blocked||r("closing")},h=F=>{r(F==="open"?"swipingOpen":"swipingClose")},p=()=>{r("opened")},w=()=>{r("preOpening")},x=()=>{n(l)?.close(),r("closed")},m=F=>{F.preventDefault(),v()};Pe(()=>(n(l)?.addEventListener("close",x),n(l)?.addEventListener("cancel",m),()=>{n(l)?.removeEventListener("close",x),n(l)?.removeEventListener("cancel",m)}));const C=P(i);let N=P(()=>s.working);const _=F=>{F?(r("opened"),s.swipingRatio=-25):(r("closed"),s.swipingRatio=0,n(l)?.close()),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=la().duration};Ve(()=>{n(u)==="opening"?Ot(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=-25,n(l).style.removeProperty("--backdrop-bg");const F=n(l).style.transform||"translate3d(-100%, 0, 0)";n(l).style.transform="";const pe=n(l)?.animate([{transform:F},{transform:"translate3d(0, 0, 0)"}],{duration:s.duration*1e3||jn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});c.current=pe,pe&&(pe.onfinish=()=>{p(),s.swipingRatio=-25,n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=la().duration,pe.cancel(),c.current=void 0})})}):n(u)==="closing"&&Ot(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=0,n(l).style.removeProperty("--backdrop-bg");const F=n(l).style.transform||"translate3d(0, 0, 0)";n(l).style.transform="";const pe=n(l)?.animate([{transform:F},{transform:"translate3d(-100%, 0, 0)"}],{duration:s.duration*1e3||jn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});c.current=pe,pe&&(pe.onfinish=()=>{x(),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=la().duration,pe.cancel(),c.current=void 0})})})}),Ve(()=>{n(u)==="preOpening"&&(n(l)?.open||(n(l)?.showModal(),yr()&&n(l)?.getBoundingClientRect()),r("opening"))}),Pe(()=>{n(u)==="opened"&&r("preOpening")});var y=wf(),T=D(y),j=b(T),K=b(j);je(K,()=>e.children);var O=M(K,2);{var z=F=>{go(F,{})};W(O,F=>{n(u)==="opened"&&F(z)})}et(j,F=>f(d,F),()=>n(d)),et(T,F=>f(l,F),()=>n(l));var ae=M(T,2);{var le=F=>{us(F,{get dialog(){return n(l)},get dialogInner(){return n(d)},onClose:v})};W(ae,F=>{n(d)&&n(u)==="opened"&&!e.blocked&&F(le)})}var G=M(ae,2);{var B=F=>{_f(F,{onCancelSwipe:_,onOpen:w,onClose:v,onSwipe:h,get dialogWidth(){return n(o)},get animationRef(){return c},get dialog(){return n(l)},get sidebarState(){return n(u)}})};W(G,F=>{!n(C)&&!e.blocked&&F(B)})}Me(()=>{tt(T,1,at({a:!0,b:n(N),c:n(u)==="opened"||n(u)==="opening"||n(u)==="closing"||n(u)==="swipingClose",d:n(u)==="opened"||n(u)==="opening"||n(u)==="swipingOpen"}),"p-1gucilc"),tt(j,1,at({e:!0,f:n(u)==="swipingOpen",g:n(u)!=="opened"}),"p-1gucilc")}),g(t,y),ke()}var bf=k('<div class="a p-1lsyiiu"><div class="b p-1lsyiiu"><!> <div class="c p-1lsyiiu"><a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <div class="e p-1lsyiiu"><!></div> <!></div> <!>',1),Cf=k('<div class="f p-1lsyiiu"><div class="e p-1lsyiiu"><!></div> <div class="g p-1lsyiiu"><div class="a p-1lsyiiu"><!></div> <!></div></div>');function kf(t,e){Ce(e,!0);const{checkMobileSize:a}=va(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Ar(),{getDialogPages:i,createDialogPageHref:l,createHandleClickDialogPage:d}=zt(),{getTagsSearch:c,setTagsSearch:u}=vd(),{getSelectedTags:v,addTag:h,removeTag:p,clearTags:w}=qn(),{getSelectedMetaTags:x,addMetaTag:m,removeMetaTag:C,clearSelectedMetaTags:N}=fo();let _=P(v),y=P(x);const{getGetNotes:T,checkNotesInArchive:j,checkNotesInBin:K}=At(),O=P(T),z=de=>{h(de)},ae=de=>{m(de)},le=de=>{p(de)},G=de=>{C(de)};let B=P(()=>n(_).size===0&&!n(y).has(st.INBOX)&&(n(O)()||[]).some(de=>(!n(y).has(st.ARCHIVED)&&!n(y).has(st.BIN)&&de?.data&&!de.data.deletedAt&&!de.data.archivedAt||n(y).has(st.ARCHIVED)&&de?.data&&!de.data.deletedAt&&de.data.archivedAt||n(y).has(st.BIN)&&de?.data&&de.data.deletedAt)&&de?.data?.tags.length===0)),F=P(()=>Xo(n(y),n(_),n(O)()||[],de=>!(de?.data&&(de.data.deletedAt||de.data.archivedAt)&&!n(y).has(st.ARCHIVED)&&!n(y).has(st.BIN)||de?.data&&(de.data.deletedAt||!de.data.archivedAt)&&n(y).has(st.ARCHIVED)||de?.data&&!de.data.deletedAt&&n(y).has(st.BIN)))),pe=P(()=>n(F).filter(de=>c()===""||de.toLowerCase().indexOf(c().toLowerCase())!==-1)),Se=P(a);const{checkExistedDialog:Z}=Qt();let H=P(()=>i().length>0||Z());const te=()=>{if(n(Se)){if(n(H))return;o()==="opened"?r():o()==="closed"&&s()}};Pe(()=>br({key:"b",meta:!0,action:te})),Pe(()=>br({key:"b",ctrl:!0,action:te}));let ve=P(()=>[...n(B)&&n(y).size===0?[st.INBOX]:[],...n(y).size===0?[...j()&&n(_).size===0?[st.ARCHIVED]:[],...K()&&n(_).size===0?[st.BIN]:[]]:[]].filter(de=>c()===""||de.toLowerCase().indexOf(c().toLowerCase())!==-1).sort((de,se)=>de===st.INBOX?-1:se===st.INBOX?1:de.localeCompare(se)));var ue=ye(),re=D(ue);{var oe=de=>{yf(de,{get blocked(){return n(H)},children:(se,Q)=>{var ie=bf(),fe=D(ie),Ee=b(fe),Ae=b(Ee);fl(Ae,{});var he=M(Ae,2),ce=b(he),xe=P(()=>d(Te.Settings));ce.__click=function(...A){n(xe)?.apply(this,A)};var we=b(ce);ge(we,()=>({"--size":"24px"})),me(we.lastChild,{name:"settings"});var Le=M(we,2);_t(Le,{children:(A,S)=>{var L=We("Settings");g(A,L)}});var $=M(ce,2),be=P(()=>d(Te.Sync));$.__click=function(...A){n(be)?.apply(this,A)};var Fe=b($);ge(Fe,()=>({"--size":"24px"})),me(Fe.lastChild,{name:"sync"});var Ie=M(Fe,2);_t(Ie,{children:(A,S)=>{var L=We("Sync");g(A,L)}});var Ze=M(Ee,2),Je=b(Ze);{let A=P(c);jo(Je,{placeholder:"Search tag",get value(){return n(A)},onChange:S=>{u(S)}})}var qe=M(Ze,2);{let A=P(()=>n(y).has(st.BIN));Is(qe,{get clearTags(){return w},get clearMetaTags(){return N},get hideTagMenu(){return n(A)},handleMetaTagClick:G,get metaTags(){return n(y)},get selectedTags(){return n(_)},handleSelectedTagClick:le})}var I=M(fe,2);{let A=P(()=>n(y).has(st.BIN));Ms(I,{get hideTagMenu(){return n(A)},get metaTags(){return n(ve)},get tags(){return n(pe)},handleMetaTagClick:ae,handleTagClick:z,mobile:!0})}Me((A,S)=>{ut(ce,"href",A),ut($,"href",S)},[()=>l(Te.Settings),()=>l(Te.Sync)]),g(se,ie)},$$slots:{default:!0}})},_e=de=>{var se=Cf(),Q=b(se),ie=b(Q);{let ce=P(c);jo(ie,{placeholder:"Search tag",get value(){return n(ce)},onChange:xe=>{u(xe)}})}var fe=M(Q,2),Ee=b(fe),Ae=b(Ee);{let ce=P(()=>n(y).has(st.BIN));Is(Ae,{get metaTags(){return n(y)},get clearTags(){return w},get clearMetaTags(){return N},get hideTagMenu(){return n(ce)},get selectedTags(){return n(_)},handleMetaTagClick:G,handleSelectedTagClick:le})}var he=M(Ee,2);{let ce=P(()=>n(y).has(st.BIN));Ms(he,{get metaTags(){return n(ve)},get hideTagMenu(){return n(ce)},get tags(){return n(pe)},handleMetaTagClick:ae,handleTagClick:z})}g(de,se)};W(re,de=>{n(Se)?de(oe):de(_e,!1)})}g(t,ue),ke()}pt(["click"]);var Sf=k('<button class="a p-tddkdb"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function xf(t,e){Ce(e,!0);let a=ze(e,"ref",15);var r=Sf();r.__click=function(...i){e.onClick?.apply(this,i)};var o=b(r);ge(o,()=>({"--rotate":"-90deg"})),me(o.lastChild,{name:"menu"});var s=M(o,2);_t(s,{children:(i,l)=>{var d=We();Me(()=>vt(d,e.title)),g(i,d)}}),et(r,i=>a(i),()=>a()),g(t,r),ke()}pt(["click"]);const Jo=t=>{try{new URL(t)}catch{return!1}return!0};var Tf=k('<div class="b p-z67y1l">Add tag for selected notes</div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Pf=k('<form class="a p-z67y1l"><!></form>');function Ef(t,e){Ce(e,!0);const{addTag:a}=At(),{getSelectedTags:r}=qn(),{getSelectedNotes:o}=ua(),{getFiltredNotes:s}=Ma();let i=R(!1),l=R(!1),d,c=!1,u=R(null),v=R(""),h=e.nextFocusRef;Pe(()=>(n(u)&&n(u).focus(),()=>{d&&clearTimeout(d)}));const p=()=>{d=setTimeout(()=>{f(l,!0)},250)},w=()=>{f(i,!0)},x=async()=>{if(r().has(n(v).trim())){w();return}if(n(v).trim()!=="")try{p();const _=new Set(o()),y=_.size?[..._]:s().map(j=>j.id),{cancel:T}=await a(n(v).trim(),y);nt("Tag added",{cancel:{nextFocusRef:h,onCancel:async()=>{await T(),setTimeout(()=>{const{prev:j}=bt(h);j?.focus()},16)}}}),c=!0}finally{f(i,!0)}},m=()=>{e.onClosed?.(c)},C=N=>{N.preventDefault(),x()};Dr(t,{get blocked(){return n(l)},get startClose(){return n(i)},onClosed:m,children:(N,_)=>{var y=Pf(),T=b(y);{var j=O=>{Ia(O,{})},K=O=>{var z=Tf(),ae=M(D(z),2);Cr(ae,{placeholder:"Enter new tag name",get ref(){return n(u)},set ref(F){f(u,F,!0)},get value(){return n(v)},set value(F){f(v,F,!0)}});var le=M(ae,2),G=b(le);Rt(G,{size:"small",onClick:w,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(F,pe)=>{var Se=We("Cancel");g(F,Se)},$$slots:{default:!0}});var B=M(G,2);Rt(B,{size:"small",onClick:x,fullWidth:!0,withoutMinWidth:!0,children:(F,pe)=>{var Se=We("OK");g(F,Se)},$$slots:{default:!0}}),g(O,z)};W(T,O=>{n(l)?O(j):O(K,!1)})}Zt("submit",y,C),g(N,y)},$$slots:{default:!0}}),ke()}var Nf=k('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Af=k('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Df=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Mf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),If=k("<div><!></div>"),Lf=k('<form class="c p-r3if1j"><div class="d p-r3if1j"><!></div> <button type="button" class="e p-r3if1j">Done</button></form>'),Rf=k('<div class="a"><div class="b p-r3if1j"><!> <!> <!> <!> <!> <!></div> <!></div>');function hl(t,e){Ce(e,!0);const{isInitedNotes:a,getGetMapTags:r,getGetNotes:o}=At(),{getSelectedTags:s}=qn();let i=R(null),l=R(""),d=R(null);const c=P(a);let u=ze(e,"shownTagInput",15);const v=()=>n(c)?e.mode==="exit"?Xo(new Set,new Set(e.selectedTags),o()()||[]):[...r()().keys()]:[];let p=P(()=>{const H=s(),te=new Set(Xo(new Set,new Set(e.selectedTags.length>0?e.selectedTags:H),o()()||[]));return v().filter(ue=>e.selectedTags.some(re=>ue===re)?!1:n(l)===""||ue.toLowerCase().indexOf(n(l).toLowerCase())===0).sort((ue,re)=>H.has(ue)&&H.has(re)?ue.localeCompare(re):H.has(ue)?-1:H.has(re)?1:te.has(ue)&&te.has(re)?ue.localeCompare(re):te.has(ue)?-1:te.has(re)?1:0)});const w=H=>{if(!e.selectedTags.includes(H)){if(e.mode!=="exit"||n(p).includes(H)){e.onChangeTags([...e.selectedTags,H]),f(l,"");return}n(i)?.focus()}},x=H=>{const te=e.selectedTags.filter(ve=>ve!==H);e.onRejectedTag&&e.onRejectedTag(H),te.length===0?e.onChangeTags([]):e.onChangeTags(te)},m=H=>{H.preventDefault(),n(l)!==""?w(n(l)):u(!1)};Ve(()=>{n(i)&&u()&&n(i).focus(),u()||f(l,"")});const C=H=>{H.preventDefault()},N=H=>{H.preventDefault(),H.stopPropagation(),H.stopImmediatePropagation()};var _=Rf(),y=b(_),T=b(y);Bn(T,17,()=>e.selectedTags,H=>H+"-tags_selected",(H,te)=>{ga(H,{onPointerDown:C,onTouchStart:N,onClick:()=>{x(n(te))},type:"button",style:"selected",children:(ve,ue)=>{var re=We();Me(()=>vt(re,n(te))),g(ve,re)},$$slots:{default:!0}})});var j=M(T,2);{var K=H=>{var te=ye(),ve=D(te);Bn(ve,17,()=>n(p).filter(ue=>ue.toLowerCase()!==n(l).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),ue=>ue+"-tags_suggested",(ue,re)=>{ga(ue,{onPointerDown:C,onTouchStart:N,onClick:()=>{w(n(re))},children:(oe,_e)=>{var de=We();Me(()=>vt(de,n(re))),g(oe,de)},$$slots:{default:!0}})}),g(H,te)};W(j,H=>{u()&&H(K)})}var O=M(j,2);{var z=H=>{ga(H,{onPointerDown:C,onTouchStart:N,onClick:()=>{w(n(l)),f(l,"")},children:(te,ve)=>{var ue=We();Me(()=>vt(ue,n(l))),g(te,ue)},$$slots:{default:!0}})};W(O,H=>{n(l)!==""&&(e.mode!=="exit"||n(p).find(te=>te.toLowerCase()===n(l).toLowerCase()))&&H(z)})}var ae=M(O,2);{var le=H=>{ga(H,{mode:"empty",onPointerDown:C,onTouchStart:N,onClick:()=>{u(!0)},children:(te,ve)=>{var ue=Nf(),re=b(ue);ge(re,()=>({"--size":"12px"})),me(re.lastChild,{name:"plus"});var oe=M(re,2);_t(oe,{children:(_e,de)=>{var se=We("add tag");g(_e,se)}}),g(te,ue)},$$slots:{default:!0}})};W(ae,H=>{u()||H(le)})}var G=M(ae,2);{var B=H=>{ga(H,{mode:"empty",onPointerDown:C,onTouchStart:N,get onClick(){return e.onUsePreviousTags},children:(te,ve)=>{var ue=Af(),re=b(ue);ge(re,()=>({"--size":"12px"})),me(re.lastChild,{name:"back"});var oe=M(re,2);_t(oe,{children:(_e,de)=>{var se=We("use previous tags");g(_e,se)}}),g(te,ue)},$$slots:{default:!0}})};W(G,H=>{e.previousTagsEnabled&&e.onUsePreviousTags&&H(B)})}var F=M(G,2);{var pe=H=>{ga(H,{mode:"empty",onPointerDown:C,onTouchStart:N,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:(te,ve)=>{var ue=If(),re=b(ue);{var oe=de=>{var se=Df(),Q=D(se);ge(Q,()=>({"--size":"12px"})),Ia(Q.lastChild,{}),g(de,se)},_e=de=>{var se=Mf(),Q=D(se);ge(Q,()=>({"--size":"12px","--rotate":"180deg"})),me(Q.lastChild,{name:"stars"});var ie=M(Q,2);_t(ie,{children:(fe,Ee)=>{var Ae=We("gen tags");g(fe,Ae)}}),g(de,se)};W(re,de=>{e.generatingTags?de(oe):de(_e,!1)})}g(te,ue)},$$slots:{default:!0}})};W(F,H=>{e.genTagsEnabled&&e.onGenTags&&H(pe)})}var Se=M(y,2);{var Z=H=>{var te=Lf(),ve=b(te),ue=b(ve);Cr(ue,{placeholder:"tag",get ref(){return n(i)},set ref(oe){f(i,oe,!0)},get value(){return n(l)},set value(oe){f(l,oe,!0)}});var re=M(ve,2);re.__pointerdown=C,re.__touchstart=N,re.__click=()=>{n(i)?.blur(),n(l)!==""&&w(n(l)),u(!1),f(l,"")},Zt("submit",te,m),g(H,te)};W(Se,H=>{u()&&H(Z)})}et(_,H=>f(d,H),()=>n(d)),g(t,_),ke()}pt(["pointerdown","touchstart","click"]);var Ff=k('<div class="c p-z67y1l"><!> <!></div>'),Of=k('<div class="b p-z67y1l">Change tags for selected notes</div> <!> <!>',1),zf=k('<form class="a p-z67y1l"><!></form>');function Bf(t,e){Ce(e,!0);const{changeTags:a,getNoteById:r}=At(),{getSelectedTags:o}=qn(),{getSelectedNotes:s}=ua(),{getFiltredNotes:i}=Ma();let l=R(!1),d=R(!1),c,u=!1,v=R(!1),h=e.nextFocusRef,w=(()=>{const K=[...o()],O=s();if(O.size===0)return K;const z=Array.from(O);let ae=new Set(r(z[0])?.data.tags||[]);for(let le=1;le<z.length;le++){const G=new Set(r(z[le])?.data.tags||[]),B=new Set([]);G.forEach(F=>{ae.has(F)&&B.add(F)}),ae=B}return Array.from(ae)})(),x=R(ft(w));Pe(()=>()=>{c&&clearTimeout(c)});const m=()=>{c=setTimeout(()=>{f(d,!0)},250)},C=()=>{f(l,!0)},N=async()=>{const K=w,O=new Set(s()),z=O.size?[...O]:i().map(ae=>ae.id);try{m();const{cancel:ae}=await a([...K],n(x),z);nt("Tags changed",{cancel:{nextFocusRef:h,onCancel:async()=>{await ae(),setTimeout(()=>{const{prev:le}=bt(h);le?.focus()},16)}}}),u=!0}finally{f(l,!0)}},_=K=>{K.key==="Escape"&&n(v)&&(f(v,!1),K.preventDefault(),K.stopPropagation())};Pe(()=>(document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)));const y=()=>{e.onClosed?.(u)},T=K=>{f(x,K,!0)},j=K=>{K.preventDefault(),N()};Dr(t,{get blocked(){return n(d)},get startClose(){return n(l)},onClosed:y,children:(K,O)=>{var z=zf(),ae=b(z);{var le=B=>{Ia(B,{})},G=B=>{var F=Of(),pe=M(D(F),2);hl(pe,{get selectedTags(){return n(x)},onChangeTags:T,get shownTagInput(){return n(v)},set shownTagInput(H){f(v,H,!0)}});var Se=M(pe,2);{var Z=H=>{var te=Ff(),ve=b(te);Rt(ve,{size:"small",onClick:C,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(re,oe)=>{var _e=We("Cancel");g(re,_e)},$$slots:{default:!0}});var ue=M(ve,2);Rt(ue,{size:"small",onClick:N,fullWidth:!0,withoutMinWidth:!0,children:(re,oe)=>{var _e=We("OK");g(re,_e)},$$slots:{default:!0}}),g(H,te)};W(Se,H=>{n(v)||H(Z)})}g(B,F)};W(ae,B=>{n(d)?B(le):B(G,!1)})}Zt("submit",z,j),g(K,z)},$$slots:{default:!0}}),ke()}var jf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),Hf=k('<li class="p-66dk2x"><!></li>'),Uf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),Wf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),Vf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Kf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),qf=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),Gf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Yf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),Xf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),Jf=k('<li class="p-66dk2x"><!></li>'),Zf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),Qf=k('<li class="p-66dk2x"><!></li>'),$f=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),ev=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <li class="p-66dk2x"><!></li>',1),tv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),nv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),av=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),rv=k('<!> <!> <li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <!> <!>',1),ov=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),sv=k('<div class="a p-66dk2x"><!></div> <!> <!> <!>',1);function iv(t,e){Ce(e,!0);const{getSelectedTags:a,setSelectedTags:r,clearTags:o}=qn(),{moveNotesToBin:s,moveNotesToArchive:i,moveNotesFromArchive:l,restoreNotesFromBin:d,deleteNotes:c}=At(),{getFiltredNotes:u}=Ma(),{getSelectedNotes:v,setSelectedNotes:h,clearNotes:p}=ua();let w=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),x=P(a),m=R(!1),C=R(!1),N=R(!1),_=R(!1),y=R(null),T=R(null);const j=()=>{n(m)||f(m,!0)},K=()=>{f(m,!1),f(C,!1)};Ve(()=>{!n(m)&&!n(N)&&!n(_)&&f(y,bt(n(T)).next,!0)}),Pe(()=>{const he=ce=>{ce.key==="Escape"&&n(m)&&n(T)?.focus()};return window.addEventListener("keydown",he),()=>{window.removeEventListener("keydown",he)}});let O=()=>{};const z=()=>{f(C,!0),f(N,!0);let he=n(T);O=()=>{f(N,!1),setTimeout(()=>{he?.focus()},16)}};let ae=()=>{};const le=()=>{f(C,!0),f(_,!0);let he=n(T);ae=()=>{f(_,!1),setTimeout(()=>{he?.focus()},16)}},G=async()=>{const he=Array.from(n(x)),ce=new Set(v()),xe=ce.size?[...ce]:u().map(Le=>Le.id),{cancel:we}=await s({noteIds:xe});o(),p(),nt("Notes moved to bin",{cancel:{nextFocusRef:n(y),onCancel:async()=>{await we(),r(new Set(he)),h(ce),setTimeout(()=>{const{prev:Le}=bt(n(y));Le?.focus()},16)}}}),f(C,!0)},B=async()=>{const he=Array.from(n(x)),ce=new Set(v()),xe=ce.size?[...ce]:u().map(Le=>Le.id),{cancel:we}=await i({noteIds:xe});o(),p(),nt("Notes moved to archive",{cancel:{nextFocusRef:n(y),onCancel:async()=>{await we(),r(new Set(he)),h(ce),setTimeout(()=>{const{prev:Le}=bt(n(y));Le?.focus()},16)}}}),f(C,!0)},F=async()=>{const he=Array.from(n(x)),ce=new Set(v()),xe=ce.size?[...ce]:u().map(Le=>Le.id),{cancel:we}=await l({noteIds:xe});o(),p(),nt("Notes moved from archive",{cancel:{nextFocusRef:n(y),onCancel:async()=>{await we(),r(new Set(he)),h(ce),setTimeout(()=>{const{prev:Le}=bt(n(y));Le?.focus()},16)}}}),f(C,!0)},pe=async()=>{const he=Array.from(n(x)),ce=new Set(v()),xe=ce.size?[...ce]:u().map(Le=>Le.id),{cancel:we}=await d({noteIds:xe});o(),p(),nt("Notes restored",{cancel:{nextFocusRef:n(y),onCancel:async()=>{await we(),r(new Set(he)),h(ce),setTimeout(()=>{const{prev:Le}=bt(n(y));Le?.focus()},16)}}}),f(C,!0)},Se=()=>{const he=new Set(v()),ce=he.size?[...he]:u().map(xe=>xe.id);f(C,!0),Va({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{f(C,!0),o(),p(),await c({noteIds:ce})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(T)?.focus()},16)}})},Z=()=>{const he=u(),ce=Array.from(v()),xe=[];for(const Le of he)Le.data&&Le.data?.link&&Jo(Le.data?.link.url)&&(ce.includes(Le.id)||ce.length===0)&&xe.push(Le.data?.link.url);const we=()=>{for(const Le of xe)if(!window.open(Le,"_blank")){Va({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(T)?.focus()},16)}});break}};xe.length<=10?we():Va({title:`Are you sure to open ${xe.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{we()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(T)?.focus()},16)}}),f(C,!0)},H=()=>{const he=u(),ce=Array.from(v());let xe="";for(const we of he)we.data&&we.data?.link&&Jo(we.data?.link.url)&&(ce.includes(we.id)||ce.length===0)&&(xe+=we.data?.link.url+`
`);navigator.clipboard.writeText(xe),nt("Copied links"),f(C,!0)},te=()=>{const he=u(),ce=Array.from(v());let xe="";for(const we of he)we.data&&(ce.includes(we.id)||ce.length===0)&&(we.data?.link?.url&&(xe+=we.data?.link.url+`
`),we.data?.text&&(xe+=`
`+we.data?.text+`
`),xe+=`---------------------

`);navigator.clipboard.writeText(xe),nt("Copied notes"),f(C,!0)},ve=()=>{const he=u(),ce=Array.from(v());let xe="";for(const we of he)we.data&&(ce.includes(we.id)||ce.length===0)&&we.data?.link?.url&&(xe+=we.data?.link.url+`

`);navigator.share({text:xe}).catch(we=>{we.name!=="AbortError"&&console.error("Error sharing",we)}),f(C,!0)},ue=()=>{const he=u(),ce=Array.from(v());let xe="";for(const we of he)we.data&&(ce.includes(we.id)||ce.length===0)&&(we.data?.link?.url&&(xe+=we.data?.link.url+`
`),we.data?.text&&(xe+=`
`+we.data?.text+`
`),xe+=`---------------------

`);navigator.share({text:xe}).catch(we=>{we.name!=="AbortError"&&console.error("Error sharing",we)}),f(C,!0)};let re=xn||Wn;var oe=sv(),_e=D(oe),de=b(_e);xf(de,{title:"notes menu",onClick:j,get ref(){return n(T)},set ref(he){f(T,he,!0)}});var se=M(_e,2);{var Q=he=>{var ce=ov(),xe=D(ce);ge(xe,()=>({"--right":"0","--top":"44px"})),Mr(xe.lastChild,{get startClose(){return n(C)},onClosed:K,get isMobile(){return re},children:(we,Le)=>{var $=rv(),be=D($);{var Fe=q=>{var X=Hf(),Y=b(X);He(Y,{onClick:Z,get dialogMode(){return re},children:(J,ne)=>{var Ne=jf(),De=D(Ne);ge(De,()=>({"--size":"20px","--scale":"0.9"})),me(De.lastChild,{name:"open"}),g(J,Ne)},$$slots:{default:!0}}),g(q,X)};W(be,q=>{xn||Wn||q(Fe)})}var Ie=M(be,2);W(Ie,q=>{});var Ze=M(Ie,2),Je=b(Ze);He(Je,{onClick:te,get dialogMode(){return re},children:(q,X)=>{var Y=Uf(),J=D(Y);ge(J,()=>({"--size":"20px"})),me(J.lastChild,{name:"copy"}),g(q,Y)},$$slots:{default:!0}});var qe=M(Ze,2),I=b(qe);He(I,{onClick:H,get dialogMode(){return re},children:(q,X)=>{var Y=Wf(),J=D(Y);ge(J,()=>({"--size":"20px"})),me(J.lastChild,{name:""}),g(q,Y)},$$slots:{default:!0}});var A=M(qe,2);{var S=q=>{var X=qf(),Y=D(X),J=b(Y);He(J,{onClick:ue,get dialogMode(){return re},children:(De,Re)=>{var Oe=Vf(),Be=D(Oe);ge(Be,()=>({"--size":"20px"})),me(Be.lastChild,{name:"share"}),g(De,Oe)},$$slots:{default:!0}});var ne=M(Y,2),Ne=b(ne);He(Ne,{onClick:ve,get dialogMode(){return re},children:(De,Re)=>{var Oe=Kf(),Be=D(Oe);ge(Be,()=>({"--size":"20px"})),me(Be.lastChild,{name:""}),g(De,Oe)},$$slots:{default:!0}}),g(q,X)};W(A,q=>{w&&q(S)})}var L=M(A,2);{var U=q=>{var X=ev(),Y=D(X),J=b(Y);He(J,{onClick:z,get dialogMode(){return re},children:(rt,it)=>{var ct=Gf(),mt=D(ct);ge(mt,()=>({"--size":"20px"})),me(mt.lastChild,{name:"add"}),g(rt,ct)},$$slots:{default:!0}});var ne=M(Y,2),Ne=b(ne);He(Ne,{onClick:le,get dialogMode(){return re},children:(rt,it)=>{var ct=Yf(),mt=D(ct);ge(mt,()=>({"--size":"20px"})),me(mt.lastChild,{name:""}),g(rt,ct)},$$slots:{default:!0}});var De=M(ne,2);{var Re=rt=>{var it=Jf(),ct=b(it);He(ct,{onClick:B,get dialogMode(){return re},children:(mt,Pn)=>{var Tt=Xf(),Dt=D(Tt);ge(Dt,()=>({"--size":"20px","--scale":"0.9"})),me(Dt.lastChild,{name:"archive"}),g(mt,Tt)},$$slots:{default:!0}}),g(rt,it)},Oe=rt=>{var it=Qf(),ct=b(it);He(ct,{onClick:F,get dialogMode(){return re},children:(mt,Pn)=>{var Tt=Zf(),Dt=D(Tt);ge(Dt,()=>({"--size":"20px","--scale":"0.9"})),me(Dt.lastChild,{name:"archive-cancel"}),g(mt,Tt)},$$slots:{default:!0}}),g(rt,it)};W(De,rt=>{e.mode==="notes"?rt(Re):rt(Oe,!1)})}var Be=M(De,2),wt=b(Be);He(wt,{onClick:G,get dialogMode(){return re},children:(rt,it)=>{var ct=$f(),mt=D(ct);ge(mt,()=>({"--size":"20px"})),me(mt.lastChild,{name:"bin"}),g(rt,ct)},$$slots:{default:!0}}),g(q,X)};W(L,q=>{(e.mode==="notes"||e.mode==="archive")&&q(U)})}var E=M(L,2);{var ee=q=>{var X=av(),Y=D(X),J=b(Y);He(J,{onClick:pe,get dialogMode(){return re},children:(De,Re)=>{var Oe=tv(),Be=D(Oe);ge(Be,()=>({"--size":"20px"})),me(Be.lastChild,{name:"bin-cancel"}),g(De,Oe)},$$slots:{default:!0}});var ne=M(Y,2),Ne=b(ne);He(Ne,{onClick:Se,get dialogMode(){return re},dangerous:!0,children:(De,Re)=>{var Oe=nv(),Be=D(Oe);ge(Be,()=>({"--size":"20px"})),me(Be.lastChild,{name:"bin"}),g(De,Oe)},$$slots:{default:!0}}),g(q,X)};W(E,q=>{e.mode==="bin"&&q(ee)})}g(we,$)},$$slots:{default:!0}}),g(he,ce)};W(se,he=>{n(m)&&he(Q)})}var ie=M(se,2);{var fe=he=>{Ef(he,{get nextFocusRef(){return n(y)},onClosed:ce=>{O(ce)}})};W(ie,he=>{n(N)&&he(fe)})}var Ee=M(ie,2);{var Ae=he=>{Bf(he,{get nextFocusRef(){return n(y)},onClosed:ce=>{ae(ce)}})};W(Ee,he=>{n(_)&&he(Ae)})}g(t,oe),ke()}var lv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),cv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),dv=k('<li class="p-1ljon4s"><!></li>'),uv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),fv=k('<li class="p-1ljon4s"><!></li>'),vv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),gv=k('<li class="p-1ljon4s"><!></li>'),hv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),pv=k('<li class="p-1ljon4s"><!></li>'),mv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),_v=k('<li class="p-1ljon4s"><!></li>'),wv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),yv=k('<li class="p-1ljon4s"><!></li>'),bv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Cv=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),kv=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Sv=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),xv=k(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Tv=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Pv=k('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!> <!>',1),Ev=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Nv(t,e){Ce(e,!0);const{checkMobileSize:a}=va(),{getMode:r,getSelectedNotes:o,changeMode:s,addNote:i}=ua(),{clearDialogPages:l}=zt(),{setFeedSearch:d}=Ea(),{moveNoteToBin:c,moveNoteFromArchive:u,moveNoteToArchive:v,deleteNote:h,pinNote:p,restoreNoteFromBin:w,checkDuplicatesExist:x}=At();let m=ze(e,"mode",3,"notes"),C=ze(e,"shownMenu",15),N=R(!1),_=R(!1),y=R(!1),T=R(!1),j=R(!1),K=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const O=async()=>{c(e.noteId),nt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{w(e.noteId)}}})},z=async()=>{v(e.noteId),nt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{u(e.noteId)}}})},ae=async()=>{u(e.noteId),nt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{v(e.noteId)}}})},le=()=>{w(e.noteId),nt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{c(e.noteId)}}})},G=()=>{e.noteData.pinned?(p(e.noteId,!1),nt("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!0)}}})):(p(e.noteId,!0),nt("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!1)}}})),f(N,!0)},B=()=>{n(_)?(f(_,!1),O()):n(j)?(f(j,!1),le()):n(y)?(f(y,!1),z()):n(T)&&(f(T,!1),ae()),C(!1),f(N,!1)},F=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),nt("Copied link"),f(N,!0))},pe=()=>{let se="";e.noteData.link?.url&&(se+=e.noteData.link.url+`
`),e.noteData.text&&(se+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(se),nt("Copied"),f(N,!0)},Se=()=>{f(N,!0),Va({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await h(e.noteId)},onCancel:async()=>{}})},Z=()=>{if(navigator.share){const se={};let Q="";e.noteData.link?.url&&(Q+=e.noteData.link.url+`
`),e.noteData.text&&(Q+=`
`+e.noteData.text+`
`),se.text=Q,navigator.share(se).catch(ie=>{ie.name!=="AbortError"&&console.error("Error sharing",ie)})}f(N,!0)},H=()=>{if(navigator.share){const se={};e.noteData.link?.url&&(se.url=e.noteData.link.url),e.noteData.link?.title&&(se.title=e.noteData.link.title),navigator.share(se).catch(Q=>{Q.name!=="AbortError"&&console.error("Error sharing",Q)})}f(N,!0)},te=()=>{f(N,!0),e.noteData.link?.url&&(l(),d(e.noteData.link?.url+"$"))};let ve=xn||Wn,ue=P(a),re=P(()=>r()==="multiple"&&o().has(e.noteId));var oe=ye(),_e=D(oe);{var de=se=>{var Q=Ev(),ie=D(Q);ge(ie,()=>({"--bottom":e.showMenuUp?"calc(100%)":"auto","--top":e.showMenuUp?"auto":"calc(100%)","--right":"10px"})),Mr(ie.lastChild,{get startClose(){return n(N)},onClosed:B,get isMobile(){return ve},children:(fe,Ee)=>{var Ae=Pv(),he=D(Ae),ce=b(he);He(ce,{onClick:G,get dialogMode(){return ve},children:(E,ee)=>{var q=lv(),X=D(q);{let J=P(()=>e.noteData.pinned?"pin-cancel":"pin");ge(X,()=>({"--size":"20px"})),me(X.lastChild,{get name(){return n(J)}})}var Y=M(X);Me(()=>vt(Y,` ${e.noteData.pinned?"Unpin":"Pin"}`)),g(E,q)},$$slots:{default:!0}});var xe=M(he,2);{var we=E=>{var ee=dv(),q=b(ee);He(q,{onClick:pe,get dialogMode(){return ve},children:(X,Y)=>{var J=cv(),ne=D(J);ge(ne,()=>({"--size":"20px"})),me(ne.lastChild,{name:"copy"}),g(X,J)},$$slots:{default:!0}}),g(E,ee)};W(xe,E=>{e.noteData.text&&E(we)})}var Le=M(xe,2);{var $=E=>{var ee=fv(),q=b(ee);He(q,{onClick:F,get dialogMode(){return ve},children:(X,Y)=>{var J=uv(),ne=D(J);ge(ne,()=>({"--size":"20px"})),me(ne.lastChild,{name:"copy"}),g(X,J)},$$slots:{default:!0}}),g(E,ee)};W(Le,E=>{n(ue)&&e.noteData.link?.url&&E($)})}var be=M(Le,2);{var Fe=E=>{var ee=gv(),q=b(ee);He(q,{onClick:Z,get dialogMode(){return ve},children:(X,Y)=>{var J=vv(),ne=D(J);ge(ne,()=>({"--size":"20px"})),me(ne.lastChild,{name:"share"}),g(X,J)},$$slots:{default:!0}}),g(E,ee)};W(be,E=>{K&&e.noteData.text&&E(Fe)})}var Ie=M(be,2);{var Ze=E=>{var ee=pv(),q=b(ee);He(q,{onClick:H,get dialogMode(){return ve},children:(X,Y)=>{var J=hv(),ne=D(J);{let Ne=P(()=>e.noteData.text?"":"share");ge(ne,()=>({"--size":"20px"})),me(ne.lastChild,{get name(){return n(Ne)}})}g(X,J)},$$slots:{default:!0}}),g(E,ee)};W(Ie,E=>{K&&e.noteData.link?.url&&E(Ze)})}var Je=M(Ie,2);{var qe=E=>{var ee=_v(),q=b(ee);He(q,{onClick:()=>{f(N,!0),r()!=="multiple"&&s("multiple"),i(e.noteId)},get dialogMode(){return ve},children:(X,Y)=>{var J=mv(),ne=D(J);ge(ne,()=>({"--size":"20px"})),me(ne.lastChild,{name:"check"}),g(X,J)},$$slots:{default:!0}}),g(E,ee)};W(Je,E=>{n(re)||E(qe)})}var I=M(Je,2);{var A=E=>{var ee=yv(),q=b(ee);He(q,{onClick:te,get dialogMode(){return ve},children:(X,Y)=>{var J=wv(),ne=D(J);ge(ne,()=>({"--size":"20px"})),me(ne.lastChild,{name:""}),g(X,J)},$$slots:{default:!0}}),g(E,ee)};W(I,E=>{e.noteData.link?.url&&x(e.noteId)&&E(A)})}var S=M(I,2);{var L=E=>{var ee=kv(),q=D(ee),X=b(q);He(X,{onClick:()=>{f(y,m()==="notes"),f(T,m()==="archive"),f(N,!0)},get dialogMode(){return ve},children:(ne,Ne)=>{var De=bv(),Re=D(De);{let Be=P(()=>m()==="archive"?"archive-cancel":"archive");ge(Re,()=>({"--size":"20px","--scale":"0.9"})),me(Re.lastChild,{get name(){return n(Be)}})}var Oe=M(Re);Me(()=>vt(Oe,` ${m()==="archive"?"Unarchive":"Archive"}`)),g(ne,De)},$$slots:{default:!0}});var Y=M(q,2),J=b(Y);He(J,{onClick:()=>{f(_,!0),f(N,!0)},get dialogMode(){return ve},children:(ne,Ne)=>{var De=Cv(),Re=D(De),Oe=b(Re);ge(Oe,()=>({"--size":"20px"})),me(Oe.lastChild,{name:"bin"}),g(ne,De)},$$slots:{default:!0}}),g(E,ee)},U=E=>{var ee=Tv(),q=D(ee),X=b(q);He(X,{onClick:()=>{f(j,!0),f(N,!0)},get dialogMode(){return ve},children:(ne,Ne)=>{var De=Sv(),Re=D(De),Oe=b(Re);ge(Oe,()=>({"--size":"20px"})),me(Oe.lastChild,{name:"bin-cancel"}),g(ne,De)},$$slots:{default:!0}});var Y=M(q,2),J=b(Y);He(J,{onClick:Se,get dialogMode(){return ve},dangerous:!0,children:(ne,Ne)=>{var De=xv(),Re=D(De),Oe=b(Re);ge(Oe,()=>({"--size":"20px"})),me(Oe.lastChild,{name:"bin"}),g(ne,De)},$$slots:{default:!0}}),g(E,ee)};W(S,E=>{m()==="notes"||m()==="archive"?E(L):E(U,!1)})}g(fe,Ae)},$$slots:{default:!0}}),g(se,Q)};W(_e,se=>{C()&&se(de)})}g(t,oe),ke()}var Av=k('<div class="a p-1hg9kpf"></div>'),Dv=k('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function pl(t,e){Ce(e,!0);const a=c=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(c).host}.ico`}catch{return""}};let r=R(!1),o=P(()=>a(e.url));var s=ye(),i=D(s);{var l=c=>{var u=Av();g(c,u)},d=c=>{var u=Dv();Me(v=>ut(u,"src",v),[()=>a(e.url)]),Zt("error",u,()=>{f(r,!0)}),g(c,u)};W(i,c=>{n(r)||!n(o)?c(l):c(d,!1)})}g(t,s),ke()}var Mv=k('<a target="_blank" rel="noopener noreferrer"><!> <!></a>'),Iv=k("<button><!> <!></button>");function ln(t,e){Ce(e,!0);let a=ze(e,"tabindex",3,0),r=ze(e,"onclick",3,()=>{}),o=ze(e,"ref",15),s=ze(e,"disabled",3,!1);var i=ye(),l=D(i);{var d=u=>{var v=Mv();v.__click=function(...w){r()?.apply(this,w)};var h=b(v);je(h,()=>e.children);var p=M(h,2);_t(p,{children:(w,x)=>{var m=We();Me(()=>vt(m,e.title)),g(w,m)}}),et(v,w=>o(w),()=>o()),Me(()=>{ut(v,"href",e.href),ut(v,"tabindex",s()?-1:a()),tt(v,1,at({a:!0,b:s()}),"p-62et9t")}),g(u,v)},c=u=>{var v=ye(),h=D(v);{var p=w=>{var x=Iv();x.__click=function(...N){r()?.apply(this,N)};var m=b(x);je(m,()=>e.children);var C=M(m,2);_t(C,{children:(N,_)=>{var y=We();Me(()=>vt(y,e.title)),g(N,y)}}),et(x,N=>o(N),()=>o()),Me(()=>{ut(x,"tabindex",s()?-1:a()),tt(x,1,at({a:!0,b:s()}),"p-62et9t"),x.disabled=s()}),g(w,x)};W(h,w=>{e.elem==="button"&&w(p)},!0)}g(u,v)};W(l,u=>{e.elem==="a"?u(d):u(c,!1)})}g(t,i),ke()}pt(["click"]);let ho=R(!1),po=R(!1),bn=R(void 0),Jr={};const Lv=()=>{xn||Wn||f(po,!0)},Rv=()=>{f(po,!1)},Zo=()=>{xn||Wn||f(ho,!0)},Fv=()=>{f(ho,!1)},Ov=()=>n(po),ml=()=>n(ho),vn=t=>{xn||Wn||f(bn,t,!0)},Kr=()=>n(bn),Fs=()=>{const t=Jr[n(bn)||""]?.next;if(t)return f(bn,t,!0),t},Os=()=>{const t=Jr[n(bn)||""]?.prev;if(t)return f(bn,t,!0),t};var zv=k('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),Bv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),jv=k('<div class="b p-rxwzp0"><!></div>'),Hv=k('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Uv=k('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Wv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Vv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Kv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),qv=k("<!> <!>",1),Gv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Yv=k("<li><!> <!> <!> <div><!> <!> <!></div> <!></li>");function Xv(t,e){Ce(e,!0);const{pushDialogPage:a}=zt(),{getFaviconEnabled:r,getRecordMode:o}=Hn(),{getMode:s,getSelectedNotes:i,addNote:l,removeNote:d}=ua(),{getSearchParams:c,getHref:u}=Bt();let v=ze(e,"mode",3,"notes"),h="unknown";Ve(()=>(Jr[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete Jr[e.noteId]}));let p=R(!1),w=R(!1),x=P(r),m=P(o),C=R(null),N=R(null),_=R(null);const{checkMobileSize:y}=va(),T=()=>{f(p,!0)},j=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),nt("Copied link"))};Ve(()=>{n(bn)===e.noteId?f(w,!0):f(w,!1)});const K=ie=>{ie.preventDefault(),a(`${Te.Note}?id=${encodeURIComponent(e.noteId)}`)},O=P(()=>e.noteData.link?.url||"");let z=P(()=>n(p)&&n(C)?bt(n(C)).next:null);const ae=ie=>{ie?l(e.noteId):d(e.noteId)},le=()=>{const ie=new URLSearchParams(c());return ie.set(tn,`${Te.Note}?id=${encodeURIComponent(e.noteId)}`),u(ie)};let G=P(()=>s()==="multiple"&&i().has(e.noteId));Pe(()=>{const ie=fe=>{if(h="keyboard",n(bn)===e.noteId&&(fe.key==="Enter"&&n(po)&&(n(m)==="note"?(fe.preventDefault(),setTimeout(()=>{a(`${Te.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(m)==="bookmark"&&n(O)&&window.open(n(O),"_blank","noopener")),fe.key==="Tab"&&n(ho)&&(Fv(),n(_)))){const Ee=bt(n(_));fe.shiftKey?Ee.prev?.focus():Ee?.next?.focus()}};return document.addEventListener("keydown",ie),()=>{document.removeEventListener("keydown",ie)}});var B=Yv();B.__focusin=()=>{h==="keyboard"&&f(bn,e.noteId,!0)};var F=b(B);{var pe=ie=>{var fe=zv(),Ee=b(fe);ge(Ee,()=>({"--size":"18px"})),me(Ee.lastChild,{name:"pin"}),g(ie,fe)};W(F,ie=>{e.noteData.pinned&&ie(pe)})}var Se=M(F,2);{var Z=ie=>{var fe=jv(),Ee=b(fe);{var Ae=ce=>{pl(ce,{get url(){return n(O)}})},he=ce=>{var xe=Bv(),we=D(xe);ge(we,()=>({"--size":"16px"})),me(we.lastChild,{name:"note"}),g(ce,xe)};W(Ee,ce=>{n(O)?ce(Ae):ce(he,!1)})}g(ie,fe)};W(Se,ie=>{n(x)&&ie(Z)})}var H=M(Se,2);{var te=ie=>{var fe=Hv();fe.__keydown=Ae=>{Ae.key==="Enter"&&(h="keyboard")},fe.__mousedown=()=>{h="mouse"},fe.__click=Ae=>{h==="mouse"&&vn(void 0),Ae.preventDefault(),s()==="multiple"?ae(!n(G)):K(Ae)};var Ee=b(fe);et(fe,Ae=>f(_,Ae),()=>n(_)),Me((Ae,he)=>{ut(fe,"tabindex",e.focusHidden?-1:0),ut(fe,"href",Ae),vt(Ee,he)},[le,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Zt("focus",fe,()=>{}),g(ie,fe)},ve=ie=>{var fe=Uv();fe.__keydown=Ae=>{Ae.key==="Enter"&&(h="keyboard")},fe.__mousedown=()=>{h="mouse"},fe.__click=Ae=>{s()==="multiple"&&(Ae.preventDefault(),ae(!n(G)))};var Ee=b(fe);et(fe,Ae=>f(_,Ae),()=>n(_)),Me(Ae=>{ut(fe,"tabindex",e.focusHidden?-1:0),ut(fe,"href",n(O)),vt(Ee,Ae)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Zt("focus",fe,()=>{}),g(ie,fe)};W(H,ie=>{n(m)==="note"||!n(O)?ie(te):ie(ve,!1)})}var ue=M(H,2),re=b(ue);{var oe=ie=>{{let fe=P(le),Ee=P(()=>e.focusHidden?-1:0);ln(ie,{title:"edit",elem:"a",get href(){return n(fe)},get tabindex(){return n(Ee)},onclick:K,children:(Ae,he)=>{var ce=Wv(),xe=D(ce);ge(xe,()=>({"--size":"18px"})),me(xe.lastChild,{name:"pen"}),g(Ae,ce)},$$slots:{default:!0}})}};W(re,ie=>{(n(m)==="bookmark"||s()==="multiple")&&ie(oe)})}var _e=M(re,2);{var de=ie=>{var fe=qv(),Ee=D(fe);{var Ae=xe=>{{let we=P(()=>e.focusHidden?-1:0),Le=P(()=>e.noteData.link?.title||"unknown");ln(xe,{elem:"a",get href(){return n(O)},get tabindex(){return n(we)},get title(){return n(Le)},children:($,be)=>{var Fe=Vv(),Ie=D(Fe);ge(Ie,()=>({"--size":"18px"})),me(Ie.lastChild,{name:"open"}),g($,Fe)},$$slots:{default:!0}})}};W(Ee,xe=>{(n(m)==="note"||s()==="multiple")&&xe(Ae)})}var he=M(Ee,2);{var ce=xe=>{{let we=P(()=>e.focusHidden?-1:0);ln(xe,{elem:"button",onclick:j,get tabindex(){return n(we)},title:"copy link",children:(Le,$)=>{var be=Kv(),Fe=D(be);ge(Fe,()=>({"--size":"20px"})),me(Fe.lastChild,{name:"copy"}),g(Le,be)},$$slots:{default:!0}})}};W(he,xe=>{y()||xe(ce)})}g(ie,fe)};W(_e,ie=>{n(O)&&ie(de)})}var se=M(_e,2);{let ie=P(()=>e.focusHidden?-1:0);ln(se,{title:"show menu",elem:"button",get tabindex(){return n(ie)},onclick:T,get ref(){return n(C)},set ref(fe){f(C,fe,!0)},children:(fe,Ee)=>{var Ae=Gv(),he=D(Ae);ge(he,()=>({"--size":"18px","--rotate":"90deg"})),me(he.lastChild,{name:"menu"}),g(fe,Ae)},$$slots:{default:!0}})}var Q=M(ue,2);Nv(Q,{get nextFocusRef(){return n(z)},get mode(){return v()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(p)},set shownMenu(ie){f(p,ie,!0)}}),et(B,ie=>f(N,ie),()=>n(N)),Me(()=>{tt(B,1,at({d:!0,e:n(w),f:n(G)||n(bn)===e.noteId}),"p-rxwzp0"),tt(ue,1,at({g:!0,h:n(w)}),"p-rxwzp0")}),g(t,B),ke()}pt(["focusin","keydown","mousedown","click"]);var Jv=k('<div class="g e p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),Zv=k('<div class="g p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),Qv=k('<a class="i j p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),$v=k('<div class="h p-12ns0yc"><!> <!></div>'),eg=k('<!> <div class="q p-12ns0yc"><!></div>',1),tg=k('<button class="u p-12ns0yc">All</button>'),ng=k('<button class="u p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),ag=k('<div class="s p-12ns0yc"><div class="t p-12ns0yc"><!> <span> </span> <!></div> <button class="u v p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),rg=k('<div class="a p-12ns0yc"><div class="b p-12ns0yc"><div class="c p-12ns0yc"><a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-12ns0yc"><!></div> <div class="f p-12ns0yc"><!></div></div> <div class="k p-12ns0yc"><div class="l p-12ns0yc"><!></div> <div class="m p-12ns0yc"><div class="n p-12ns0yc"><div class="o p-12ns0yc"><!></div> <div class="p p-12ns0yc"><!></div></div> <div class="r p-12ns0yc"><!></div></div></div></div>');function og(t,e){Ce(e,!0);const{getFeedSearch:a,setFeedSearch:r}=Ea(),{getScrollContainer:o}=vo();let s=P(o);const{emptyBin:i,checkNotesInBin:l,checkNotesInArchive:d,checkNotes:c}=At(),{replaceSearchParams:u}=Bt(),{createDialogPageHref:v,createHandleClickDialogPage:h,getDialogPages:p}=zt(),{checkExistedDialog:w}=Qt(),{getMode:x,clearNotes:m,setSelectedNotes:C,getSelectedNotes:N,changeMode:_}=ua(),{checkMobileSize:y}=va(),{getFiltredNotes:T}=Ma(),{getSelectedMetaTags:j}=fo(),{getViewMode:K}=Hn();let O=P(j),z=R(null);const ae=P(l);let G=P(()=>{const A=T()||[],S=N();return A.every(L=>S.has(L.id))});const B=()=>{Va({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await i(),u("")},onCancel:async()=>{}})};let F=P(()=>p().length===0);Ve(()=>{n(F)});const pe=()=>{p().length===0&&!w()&&n(z)?.focus()};Pe(()=>br({key:"k",meta:!0,action:pe})),Pe(()=>br({key:"k",ctrl:!0,action:pe})),Pe(()=>{}),Ve(()=>{const A=T()||[];Ot(()=>{const S=N();C(new Set(A.filter(L=>S.has(L.id)).map(L=>L.id)))})});let Se=P(()=>n(O).has(st.ARCHIVED)?"archive":n(O).has(st.BIN)?"bin":"notes");Pe(()=>{n(z)&&n(z).addEventListener("keydown",A=>{A.key==="Tab"&&Kr()&&A.preventDefault()})}),Ve(()=>{ml()&&setTimeout(()=>{n(z)?.focus(),n(z)?.setSelectionRange(n(z).value.length,n(z).value.length)},0)}),Pe(()=>{});var Z=rg(),H=b(Z),te=b(H),ve=b(te),ue=P(()=>h(Te.Settings));ve.__click=function(...A){n(ue)?.apply(this,A)};var re=b(ve);ge(re,()=>({"--rotate":"30deg","--size":"20px"})),me(re.lastChild,{name:"settings"});var oe=M(ve,2),_e=P(()=>h(Te.Sync));oe.__click=function(...A){n(_e)?.apply(this,A)};var de=b(oe);ge(de,()=>({"--size":"20px"})),me(de.lastChild,{name:"sync"});var se=M(te,2),Q=b(se);fl(Q,{});var ie=M(se,2),fe=b(ie);{var Ee=A=>{var S=ye(),L=D(S);{var U=E=>{var ee=ye(),q=D(ee);{var X=J=>{var ne=Jv(),Ne=b(ne);Ne.__click=B;var De=b(Ne);ge(De,()=>({"--scale":"1.2","--size":"20px"})),me(De.lastChild,{name:"clear"});var Re=M(De);_t(Re,{children:(Oe,Be)=>{var wt=We("Empty bin");g(Oe,wt)}}),g(J,ne)},Y=J=>{var ne=Zv(),Ne=b(ne);Ne.__click=B;var De=b(Ne);ge(De,()=>({"--scale":"0.9","--size":"20px"})),me(De.lastChild,{name:"clear"}),g(J,ne)};W(q,J=>{y()?J(X):J(Y,!1)})}g(E,ee)};W(L,E=>{n(ae)&&E(U)})}g(A,S)},Ae=A=>{var S=ye(),L=D(S);{var U=E=>{var ee=$v(),q=b(ee);{var X=J=>{var ne=Qv();ne.__click=function(...Re){e.onOpenWindow?.apply(this,Re)};var Ne=b(ne);ge(Ne,()=>({"--scale":"0.7","--size":"26px"})),me(Ne.lastChild,{name:"open-window"});var De=M(Ne,2);_t(De,{children:(Re,Oe)=>{var Be=We("open window");g(Re,Be)}}),Me(()=>ut(ne,"href",e.openWindowHref)),g(J,ne)};W(q,J=>{e.onOpenWindow&&J(X)})}var Y=M(q,2);Uu(Y,{}),g(E,ee)};W(L,E=>{n(Se)==="notes"&&E(U)},!0)}g(A,S)};W(fe,A=>{n(Se)==="bin"?A(Ee):A(Ae,!1)})}var he=M(H,2),ce=b(he),xe=b(ce);kf(xe,{});var we=M(ce,2),Le=b(we),$=b(Le),be=b($);{let A=P(a);jo(be,{placeholder:"Search",onFocus:()=>{xn||Wn||(Lv(),Zo(),n(z)?.setSelectionRange(n(z).value.length,n(z).value.length))},onBlur:()=>{Rv()},get value(){return n(A)},onChange:S=>{vn(void 0),n(s)&&n(s).scrollTo({top:0}),r(S)},onEscape:()=>{vn(void 0)},get ref(){return n(z)},set ref(S){f(z,S,!0)}})}var Fe=M($,2),Ie=b(Fe);{var Ze=A=>{var S=eg(),L=D(S);Lu(L,{});var U=M(L,2),E=b(U);iv(E,{get mode(){return n(Se)}}),g(A,S)};W(Ie,A=>{(n(Se)==="notes"&&c()||n(Se)==="bin"&&l()||n(Se)==="archive"&&d())&&A(Ze)})}var Je=M(Le,2),qe=b(Je);{var I=A=>{var S=ye(),L=D(S);{var U=E=>{var ee=ag(),q=b(ee),X=b(q);{var Y=Be=>{var wt=tg();wt.__click=rt=>{rt.preventDefault();const it=T()||[];C(new Set(it.map(ct=>ct.id)))},g(Be,wt)};W(X,Be=>{n(G)||Be(Y)})}var J=M(X,2),ne=b(J),Ne=M(J,2);{var De=Be=>{var wt=ng();wt.__click=it=>{it.preventDefault(),m()};var rt=b(wt);ge(rt,()=>({"--size":"16px"})),me(rt.lastChild,{name:"close"}),g(Be,wt)};W(Ne,Be=>{N().size>0&&Be(De)})}var Re=M(q,2);Re.__click=Be=>{Be.preventDefault(),_("single")};var Oe=b(Re);ge(Oe,()=>({"--size":"16px"})),me(Oe.lastChild,{name:"close"}),Me(Be=>vt(ne,`Selected ${Be??""}`),[()=>N().size]),g(E,ee)};W(L,E=>{x()==="multiple"&&E(U)})}g(A,S)};W(qe,A=>{(n(Se)==="notes"&&c()||n(Se)==="bin"&&l()||n(Se)==="archive"&&d())&&A(I)})}Me((A,S)=>{ut(ve,"href",A),ut(oe,"href",S)},[()=>v(Te.Settings),()=>v(Te.Sync)]),g(t,Z),ke()}pt(["click"]);var sg=k('<div class="a p-11shdp8"><!></div>');function Ct(t,e){Ce(e,!0);const{setDialogPageHeight:a}=ds();let r=R(null);Pe(()=>{n(r);const i=new ResizeObserver(l=>{for(let d of l){const c=d.contentRect.height;a(c)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=sg(),s=b(o);je(s,()=>e.children),et(o,i=>f(r,i),()=>n(r)),g(t,o),ke()}var ig=k('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function lg(t,e){Ce(e,!1);const{replaceSearchParams:a,getHref:r}=Bt(),o=l=>{l.preventDefault(),a("")};ss();var s=ig(),i=M(b(s),2);{let l=Pr(()=>r(""));Rt(i,{element:"a",get href(){return n(l)},onClick:o,children:(d,c)=>{var u=We("close");g(d,u)},$$slots:{default:!0}})}g(t,s),ke()}var cg=k('<h1 class="p-1n0ziuh"><!></h1>');function dg(t,e){var a=cg(),r=b(a);je(r,()=>e.children),g(t,a)}var ug=k('<!> <div class="b p-193tby9"><!> <!></div>',1),fg=k('<div class="a p-193tby9"><!></div>');function vg(t,e){Ce(e,!0);const{blockDialog:a,setLeftEnd:r}=Qt(),{pushDialogPage:o}=zt(),{initLocalAccount:s}=ls(),{replaceSearchParams:i}=Bt(),l=Gn(),d=()=>{o(Te.Auth)},c=async()=>{l.duration=0,l.swipingRatio=-25,requestAnimationFrame(()=>{l.duration=la().duration,l.swipingRatio=la().swipingRatio,s(),a(!1),r(!0),i("")})};var u=fg(),v=b(u);{var h=p=>{var w=ug(),x=D(w);dg(x,{children:(_,y)=>{var T=We("Welcome");g(_,T)}});var m=M(x,2),C=b(m);Rt(C,{onClick:d,fullWidth:!0,children:(_,y)=>{var T=We("Cloud account");g(_,T)},$$slots:{default:!0}});var N=M(C,2);Rt(N,{onClick:c,fullWidth:!0,type:"secondary",children:(_,y)=>{var T=We("Local account");g(_,T)},$$slots:{default:!0}}),g(p,w)};W(v,p=>{p(h)})}g(t,u),ke()}var gg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),hg=k('<form class="b p-10m9vsg"><!> <!> <div class="c p-10m9vsg"><div class="d p-10m9vsg"><button type="button" class="p-10m9vsg">Cancel</button> <button type="submit" class="p-10m9vsg">Done</button></div> <!></div></form>'),pg=k('<div class="f p-10m9vsg"><!></div>'),mg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),_g=k('<div class="e p-10m9vsg"><div><!> <a class="g p-10m9vsg" target="_blank" rel="noopener noreferrer"> </a> <div><!></div></div></div>'),wg=k('<div class="a p-10m9vsg"><!></div>');function yg(t,e){Ce(e,!0);let a=ze(e,"shownUrlInput",15);const{getFaviconEnabled:r}=Hn();let o=P(r),s=R(null),i=R(null),l=R(null),d=R(ft(e.url)),c=R(ft(e.title)),u=R(null);const v=_=>{f(d,_.target.value||"",!0)},h=_=>{f(c,_.target.value||"",!0)};Ve(()=>{a()&&n(s)?.focus()});const p=()=>{e.url&&(navigator.clipboard.writeText(e.url),nt("Copied link"))},w=()=>{f(c,""),f(d,""),e.onDeleteUrl(),a(!1)};var x=wg(),m=b(x);{var C=_=>{var y=hg(),T=b(y);Cr(T,{get value(){return n(d)},onInput:v,placeholder:"url",get ref(){return n(s)},set ref(G){f(s,G,!0)}});var j=M(T,2);Cr(j,{get value(){return n(c)},onInput:h,placeholder:"title",get ref(){return n(i)},set ref(G){f(i,G,!0)}});var K=M(j,2),O=b(K),z=b(O);z.__click=()=>{f(d,e.url,!0),f(c,e.title,!0),a(!1)};var ae=M(O,2);{var le=G=>{ln(G,{title:"delete link",elem:"button",onclick:w,children:(B,F)=>{var pe=gg(),Se=D(pe);ge(Se,()=>({"--size":"20px"})),me(Se.lastChild,{name:"bin"}),g(B,pe)},$$slots:{default:!0}})};W(ae,G=>{(e.url||e.title)&&G(le)})}Zt("submit",y,G=>{if(G.preventDefault(),document.activeElement===n(s)){n(i)?.focus();return}let B=n(d).trim();B!==""&&/^[[a-zA-Z]+?:\/\//.test(B)===!1&&(B="https://"+B,f(d,B,!0)),e.onChangeUrl(B,n(c)),a(!1)}),g(_,y)},N=_=>{var y=ye(),T=D(y);{var j=K=>{var O=_g(),z=b(O);tt(z,1,at({h:!0}),"p-10m9vsg");var ae=b(z);{var le=Se=>{var Z=pg(),H=b(Z);pl(H,{get url(){return e.url}}),g(Se,Z)};W(ae,Se=>{n(o)&&Se(le)})}var G=M(ae,2),B=b(G),F=M(G,2);tt(F,1,at({i:!0}),"p-10m9vsg");var pe=b(F);ln(pe,{title:"copy link",elem:"button",onclick:p,children:(Se,Z)=>{var H=mg(),te=D(H);ge(te,()=>({"--size":"20px"})),me(te.lastChild,{name:"copy"}),g(Se,H)},$$slots:{default:!0}}),et(z,Se=>f(u,Se),()=>n(u)),Me(()=>{ut(G,"href",e.url),vt(B,e.title||"unknown")}),g(K,O)};W(T,K=>{e.url&&K(j)},!0)}g(_,y)};W(m,_=>{a()?_(C):_(N,!1)})}et(x,_=>f(l,_),()=>n(l)),g(t,x),ke()}pt(["click"]);const bg=t=>{let e="",a=!0;function r(o){for(let s=0;s<o.length;s++){const i=o[s];if(i.nodeName==="BR"){e+=`
`,a=!0;continue}i.nodeName==="DIV"&&a===!1&&(e+=`
`),a=!1,i.nodeType===3&&i.textContent&&(e+=i.textContent),r(i.childNodes)}}return r(t),e===`
`&&(e=e.slice(0,-1)),e},Cg=()=>{const t=()=>{const a=new Set(["script","style","noscript","iframe","svg","canvas","meta","link","input","button","form"]),r=d=>{if(d.childNodes.length===0)return!1;for(const c of d.childNodes)if(c.nodeType===Node.TEXT_NODE&&c.textContent?.trim())return!0;return!1},o=Array.from({length:10},()=>({priority:0,text:""})),s=(d,c)=>({main:d.main||c.tagName.toLowerCase()==="main",article:d.article||c.tagName.toLowerCase()==="article",h1:d.h1||c.tagName.toLowerCase()==="h1",h2:d.h2||c.tagName.toLowerCase()==="h2",h3:d.h3||c.tagName.toLowerCase()==="h3"}),i=d=>{let c=0;return d.main&&(c+=1e3),d.article&&(c+=1e4),d.h1&&(c+=10),d.h2&&(c+=5),d.h3&&(c+=1),c},l=(d=document.body,c={main:!1,article:!1,h1:!1,h2:!1,h3:!1})=>{for(const u of d.childNodes)if(u.nodeType===Node.ELEMENT_NODE){if(a.has(u.tagName.toLowerCase()))continue;if(r(u)){const v=u.textContent;if(!v)continue;for(let h=0;h<o.length&&!o[h].text.includes(v||"");h++)if(v&&i(s(c,u))+v.length>o[h].priority){o.splice(h,0,{priority:i(s(c,u))+v.length,text:v.trim()}),o.pop();break}}else l(u,s(c,u))}};return l(),o};return{title:document.title||"",desctiption:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",topTextContents:t()}},kg=async()=>await nl().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),Sg=async()=>typeof LanguageModel>"u"?"unavailable":await nl().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),xg=t=>new Promise(e=>{As().tabs.query({active:!0,currentWindow:!0},async a=>{const r=a[0];if(!r||!r.id){e(void 0);return}if(r.url!==t){e(void 0);return}const s=(await As().scripting.executeScript({target:{tabId:r.id},world:"MAIN",func:Cg}))[0]?.result;e(s)})}),Tg=async({llmSession:t,rejectedTags:e,accessPageData:a,text:r,link:o,tags:s})=>{const i=a&&o?.url?await xg(o.url):void 0,l={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},d=`
			Page information:
			Title: ${o?.title||"N/A"}.
			URL: ${o?.url||"N/A"}.
			Description: ${i?.desctiption||"N/A"}.
			Note content: ${r||"N/A"}.
			Dont return tags: ${[...e.length>0?e:[],...s.length>0?s:[]].join(", ")||"N/A"}.
			Page contents: ${i?.topTextContents?i.topTextContents.slice(0,5).map(({priority:v,text:h})=>`priority: ${v}; text: ${h}

`).join(""):"N/A"}.
		`.slice(0,5e3),c=await t.prompt(d,{responseConstraint:l});return Array.from(new Set([...s,...(JSON.parse(c)?.tags||[]).map(v=>v.trim().toLowerCase()).filter(v=>v!=="")]))};var Pg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Add link',1),Eg=k('<li class="p-1ljon4s"><!></li>'),Ng=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Edit link',1),Ag=k('<li class="p-1ljon4s"><!></li>'),Dg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),Mg=k('<li class="p-1ljon4s"><!></li>'),Ig=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),Lg=k('<li class="p-1ljon4s"><!></li>'),Rg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Fg=k('<li class="p-1ljon4s"><!></li>'),Og=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Make copy',1),zg=k('<li class="p-1ljon4s"><!></li>'),Bg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),jg=k('<li class="p-1ljon4s"><!></li>'),Hg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Ug=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),Wg=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Vg=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),Kg=k(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),qg=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Gg=k("<!> <!> <!> <!> <!> <!> <!>",1),Yg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function zs(t,e){Ce(e,!0);const{moveNoteToBin:a,moveNoteFromArchive:r,moveNoteToArchive:o,deleteNote:s,restoreNoteFromBin:i,checkDuplicatesExist:l,createNote:d}=At(),{clearDialogPages:c,replaceDialogPage:u,pushDialogPage:v}=zt(),{setFeedSearch:h}=Ea(),{checkMobileSize:p}=va();let w=ze(e,"mode",3,"notes"),x=ze(e,"shownMenu",15),m=R(!1),C=R(!1),N=R(!1),_=R(!1),y=R(!1),T=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const j=async()=>{requestAnimationFrame(()=>{c(),setTimeout(()=>{a(e.noteId),nt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i(e.noteId),v(`${Te.Note}?id=${e.noteId}`)}}})},300)})},K=async()=>{o(e.noteId),nt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{r(e.noteId)}}})},O=async()=>{r(e.noteId),nt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{o(e.noteId)}}})},z=()=>{i(e.noteId),nt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a(e.noteId)}}})},ae=()=>{n(C)?(f(C,!1),j()):n(y)?(f(y,!1),z()):n(N)?(f(N,!1),K()):n(_)&&(f(_,!1),O()),x(!1),f(m,!1)},le=()=>{let ue="";e.link?.url&&(ue+=e.link.url+`
`),e.text&&(ue+=`
`+e.text+`
`),navigator.clipboard.writeText(ue),nt("Copied"),f(m,!0)},G=async()=>{f(m,!0),requestAnimationFrame(()=>{c(),setTimeout(()=>{s(e.noteId)},100)})},B=()=>{if(navigator.share){const ue={};let re="";e.link?.url&&(re+=e.link.url+`
`),e.text&&(re+=`
`+e.text+`
`),ue.text=re,navigator.share(ue).catch(oe=>{oe.name!=="AbortError"&&console.error("Error sharing",oe)})}f(m,!0)},F=()=>{if(navigator.share){const ue={};e.link?.url&&(ue.url=e.link.url),e.link?.title&&(ue.title=e.link.title),navigator.share(ue).catch(re=>{re.name!=="AbortError"&&console.error("Error sharing",re)})}f(m,!0)},pe=async()=>{f(m,!0);const ue=e.noteId,re=await d({link:Ye(e.link),text:e.text||"",tags:e.tags?Ye(e.tags):[]});u(`${Te.Note}?id=${re}`),nt("copy made",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{u(`${Te.Note}?id=${ue}`),setTimeout(()=>{s(re)})}}})},Se=()=>{f(m,!0),e.link?.url&&(c(),h(e.link?.url+"$"))};let Z=!1;var H=ye(),te=D(H);{var ve=ue=>{var re=Yg(),oe=D(re);{let _e=P(()=>`calc(100% - ${p()?"0px":"16px"})`),de=P(()=>p()?"auto":"10px"),se=P(()=>p()?"10px":"auto");ge(oe,()=>({"--bottom":"auto","--top":n(_e),"--left":n(de),"--right":n(se)})),Mr(oe.lastChild,{get startClose(){return n(m)},onClosed:ae,isMobile:Z,children:(Q,ie)=>{var fe=Gg(),Ee=D(fe);{var Ae=S=>{var L=Eg(),U=b(L);He(U,{onClick:E=>{e.onAddLinkClick(E),f(m,!0)},dialogMode:Z,children:(E,ee)=>{var q=Pg(),X=D(q);ge(X,()=>({"--size":"20px"})),me(X.lastChild,{name:"add"}),g(E,q)},$$slots:{default:!0}}),g(S,L)},he=S=>{var L=Ag(),U=b(L);He(U,{onClick:E=>{e.onEditLinkClick(E),f(m,!0)},dialogMode:Z,children:(E,ee)=>{var q=Ng(),X=D(q);ge(X,()=>({"--size":"20px","--scale":"0.9"})),me(X.lastChild,{name:"pen"}),g(E,q)},$$slots:{default:!0}}),g(S,L)};W(Ee,S=>{e.link?.url?S(he,!1):S(Ae)})}var ce=M(Ee,2);{var xe=S=>{var L=Mg(),U=b(L);He(U,{onClick:le,dialogMode:Z,children:(E,ee)=>{var q=Dg(),X=D(q);ge(X,()=>({"--size":"20px"})),me(X.lastChild,{name:"copy"}),g(E,q)},$$slots:{default:!0}}),g(S,L)};W(ce,S=>{e.text&&S(xe)})}var we=M(ce,2);{var Le=S=>{var L=Lg(),U=b(L);He(U,{onClick:F,dialogMode:Z,children:(E,ee)=>{var q=Ig(),X=D(q);{let Y=P(()=>e.text?"":"share");ge(X,()=>({"--size":"20px"})),me(X.lastChild,{get name(){return n(Y)}})}g(E,q)},$$slots:{default:!0}}),g(S,L)};W(we,S=>{T&&e.link?.url&&S(Le)})}var $=M(we,2);{var be=S=>{var L=Fg(),U=b(L);He(U,{onClick:B,dialogMode:Z,children:(E,ee)=>{var q=Rg(),X=D(q);ge(X,()=>({"--size":"20px"})),me(X.lastChild,{name:"share"}),g(E,q)},$$slots:{default:!0}}),g(S,L)};W($,S=>{T&&e.text&&S(be)})}var Fe=M($,2);{var Ie=S=>{var L=zg(),U=b(L);He(U,{onClick:pe,dialogMode:Z,children:(E,ee)=>{var q=Og(),X=D(q);ge(X,()=>({"--size":"20px","--scale":"0.8"})),me(X.lastChild,{name:"note"}),g(E,q)},$$slots:{default:!0}}),g(S,L)};W(Fe,S=>{e.formMode==="edit"&&(e.text||e.link?.url)&&S(Ie)})}var Ze=M(Fe,2);{var Je=S=>{var L=jg(),U=b(L);He(U,{onClick:Se,dialogMode:Z,children:(E,ee)=>{var q=Bg(),X=D(q);ge(X,()=>({"--size":"20px"})),me(X.lastChild,{name:""}),g(E,q)},$$slots:{default:!0}}),g(S,L)};W(Ze,S=>{e.link?.url&&l(e.noteId)&&S(Je)})}var qe=M(Ze,2);{var I=S=>{var L=ye(),U=D(L);{var E=ee=>{var q=Wg(),X=D(q),Y=b(X);He(Y,{onClick:()=>{f(N,w()==="notes"),f(_,w()==="archive"),f(m,!0)},dialogMode:Z,children:(Ne,De)=>{var Re=Hg(),Oe=D(Re);{let wt=P(()=>w()==="archive"?"archive-cancel":"archive");ge(Oe,()=>({"--size":"20px","--scale":"0.9"})),me(Oe.lastChild,{get name(){return n(wt)}})}var Be=M(Oe);Me(()=>vt(Be,` ${w()==="archive"?"Unarchive":"Archive"}`)),g(Ne,Re)},$$slots:{default:!0}});var J=M(X,2),ne=b(J);He(ne,{onClick:()=>{f(C,!0),f(m,!0)},dialogMode:Z,children:(Ne,De)=>{var Re=Ug(),Oe=D(Re),Be=b(Oe);ge(Be,()=>({"--size":"20px"})),me(Be.lastChild,{name:"bin"}),g(Ne,Re)},$$slots:{default:!0}}),g(ee,q)};W(U,ee=>{(e.text||e.link?.url)&&ee(E)})}g(S,L)},A=S=>{var L=qg(),U=D(L),E=b(U);He(E,{onClick:()=>{f(y,!0),f(m,!0)},dialogMode:Z,children:(X,Y)=>{var J=Vg(),ne=D(J),Ne=b(ne);ge(Ne,()=>({"--size":"20px"})),me(Ne.lastChild,{name:"bin-cancel"}),g(X,J)},$$slots:{default:!0}});var ee=M(U,2),q=b(ee);He(q,{onClick:G,dialogMode:Z,dangerous:!0,children:(X,Y)=>{var J=Kg(),ne=D(J),Ne=b(ne);ge(Ne,()=>({"--size":"20px"})),me(Ne.lastChild,{name:"bin"}),g(X,J)},$$slots:{default:!0}}),g(S,L)};W(qe,S=>{w()==="notes"||w()==="archive"?S(I):S(A,!1)})}g(Q,fe)},$$slots:{default:!0}})}g(ue,re)};W(te,ue=>{x()&&ue(ve)})}g(t,H),ke()}var Xg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Jg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Zg=k("<!> <!> <!> <!>",1),Qg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),$g=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),eh=k("<!> <!> <!>",1),th=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),nh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ah=k('<div class="a p-5sjfv5"><div class="b p-5sjfv5"><!></div> <div class="c p-5sjfv5"><!> <!></div></div>');function rh(t,e){Ce(e,!0);const{checkMobileSize:a}=va(),{getSearchParams:r,getHref:o}=Bt(),{getViewMode:s}=Hn();let i=R(!1);const l=()=>!e.deletedAt&&!e.archivedAt?"notes":e.archivedAt?"archive":"bin";var d=ah(),c=b(d),u=b(c);{var v=m=>{var C=Zg(),N=D(C);{let j=P(()=>e.pinned?"unpin":"pin");ln(N,{get title(){return n(j)},elem:"button",onclick:()=>{e.onPinnedChange(!e.pinned)},children:(K,O)=>{var z=Xg(),ae=D(z);{let le=P(()=>e.pinned?"pin-cancel":"pin");ge(ae,()=>({"--size":"20px"})),me(ae.lastChild,{get name(){return n(le)}})}g(K,z)},$$slots:{default:!0}})}var _=M(N,2);ln(_,{title:"menu",elem:"button",onclick:()=>{f(i,!0)},children:(j,K)=>{var O=Jg(),z=D(O);ge(z,()=>({"--size":"20px","--rotate":"90deg"})),me(z.lastChild,{name:"menu"}),g(j,O)},$$slots:{default:!0}});var y=M(_,2);{let j=P(l);zs(y,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(j)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(i)},set shownMenu(K){f(i,K,!0)}})}var T=M(y,2);W(T,j=>{}),g(m,C)},h=m=>{var C=eh(),N=D(C);ln(N,{title:"menu",elem:"button",onclick:()=>{f(i,!0)},children:(T,j)=>{var K=Qg(),O=D(K);ge(O,()=>({"--size":"24px","--rotate":"90deg"})),me(O.lastChild,{name:"menu"}),g(T,K)},$$slots:{default:!0}});var _=M(N,2);{let T=P(l);zs(_,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(T)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(i)},set shownMenu(j){f(i,j,!0)}})}var y=M(_,2);{let T=P(()=>e.pinned?"unpin":"pin");ln(y,{get title(){return n(T)},elem:"button",onclick:()=>{e.onPinnedChange(!e.pinned)},children:(j,K)=>{var O=$g(),z=D(O);{let ae=P(()=>e.pinned?"pin-cancel":"pin");ge(z,()=>({"--size":"24px"})),me(z.lastChild,{get name(){return n(ae)}})}g(j,O)},$$slots:{default:!0}})}g(m,C)};W(u,m=>{a()?m(v):m(h,!1)})}var p=M(c,2),w=b(p);{let m=P(()=>!e.canPrev);ln(w,{title:"previous",elem:"button",get disabled(){return n(m)},onclick:C=>{C.preventDefault(),e.onPrev&&e.onPrev()},children:(C,N)=>{var _=th(),y=D(_);ge(y,()=>({"--size":"20px"})),me(y.lastChild,{name:"prev"}),g(C,_)},$$slots:{default:!0}})}var x=M(w,2);{let m=P(()=>!e.canNext);ln(x,{title:"next",elem:"button",get disabled(){return n(m)},onclick:C=>{C.preventDefault(),e.onNext&&e.onNext()},children:(C,N)=>{var _=nh(),y=D(_);ge(y,()=>({"--size":"20px"})),me(y.lastChild,{name:"next"}),g(C,_)},$$slots:{default:!0}})}g(t,d),ke()}var oh=k('<div class="e p-lklx2e">Note</div>'),sh=k("<span> </span>"),ih=k('<div class="i p-lklx2e"><!></div>'),lh=k('<!> <!> <div class="a p-lklx2e"><div class="b"><div class="c"><div class="d p-lklx2e"><!> <div class="f p-lklx2e" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"></div></div></div></div> <div class="g h p-lklx2e"><!> <div class="j p-lklx2e"><!></div></div></div>',1);function ch(t,e){Ce(e,!0);const{getLlmTagsEnabled:a,getPrevTags:r,getPageDataForTagsEnabled:o}=Hn(),{pushDialogPage:s}=zt();let i=R(null),l=R(!1),d=R(!1),c=R(ft(new Set)),u=R(""),v=R(!1);const h=oe=>{const _e=bg(oe.currentTarget.childNodes);e.onChangeText(_e),f(u,_e,!0)},p=oe=>{oe.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(l)&&(f(l,!1),oe.preventDefault(),oe.stopPropagation()),n(d)&&(f(d,!1),oe.preventDefault(),oe.stopPropagation()))};Pe(()=>(document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)));const w=(oe,_e)=>{e.onChangeLink({url:oe,title:_e})},x=()=>{e.onChangeLink(void 0)},m=r(),C=()=>{e.onChangeTags([...new Set([...e.tags,...m])])};Ve(()=>{n(i)&&n(u)!==e.text&&(n(i).textContent=e.text,f(u,e.text,!0))}),Pe(()=>{if(n(i)){if((xn||Wn)&&(e.mode==="edit"||navigator.userActivation.isActive===!1))return;n(i).focus();const oe=document.createRange();oe.selectNodeContents(n(i)),oe.collapse(!1);const _e=window.getSelection();_e?.removeAllRanges(),_e?.addRange(oe)}});let N=R("unknown");Pe(()=>{(async()=>f(N,await Sg(),!0))()});let _=P(a),y=null;const T=async()=>y||(y=await kg(),y),j=async()=>{if(n(N)==="downloadable"||n(N)==="downloading"){s(Te.Extension);return}f(v,!0);const oe=await T(),_e=await Tg({llmSession:oe,text:e.text,link:e.link,accessPageData:o(),rejectedTags:Array.from(n(c)),tags:e.tags});e.onChangeTags([...new Set([...e.tags,..._e])]),f(v,!1)};Pe(()=>{const oe=_e=>{if(!n(i)||document.activeElement!==n(i)||(_e.preventDefault(),!_e.clipboardData))return;const de=_e.clipboardData.getData("text/plain");e.onChangeText(de);const se=window.getSelection();if(se&&se.rangeCount>0){const Q=se.getRangeAt(0);Q.deleteContents(),Q.insertNode(document.createTextNode(de)),Q.collapse(!1),se.removeAllRanges(),se.addRange(Q)}};return document.addEventListener("paste",oe),()=>{document.removeEventListener("paste",oe)}});var K=lh(),O=D(K);rh(O,{get noteId(){return e.noteId},get link(){return e.link},get pinned(){return e.pinned},get onPinnedChange(){return e.onPinnedChange},get text(){return e.text},get tags(){return e.tags},get deletedAt(){return e.deletedAt},get archivedAt(){return e.archivedAt},onAddLinkClick:()=>{f(d,!0)},onEditLinkClick:()=>{f(d,!0)},get canNext(){return e.canNext},get canPrev(){return e.canPrev},get onNext(){return e.onNext},get onPrev(){return e.onPrev},get formMode(){return e.mode}});var z=M(O,2);{var ae=oe=>{{let _e=P(()=>e.link?.url||""),de=P(()=>e.link?.title||"");yg(oe,{get url(){return n(_e)},get title(){return n(de)},onChangeUrl:w,onDeleteUrl:x,get shownUrlInput(){return n(d)},set shownUrlInput(se){f(d,se,!0)}})}};W(z,oe=>{(n(d)||e.link?.url)&&oe(ae)})}var le=M(z,2),G=b(le),B=b(G),F=b(B),pe=b(F);{var Se=oe=>{var _e=oh();g(oe,_e)};W(pe,oe=>{e.text||oe(Se)})}var Z=M(pe,2);Z.__input=h,et(Z,oe=>f(i,oe),()=>n(i));var H=M(G,2),te=b(H);{var ve=oe=>{var _e=ih(),de=b(_e);{var se=Q=>{var ie=sh(),fe=b(ie);Me(Ee=>vt(fe,`updated: ${Ee??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),g(Q,ie)};W(de,Q=>{e.updatedAt&&Q(se)})}g(oe,_e)};W(te,oe=>{e.mode==="edit"&&oe(ve)})}var ue=M(te,2),re=b(ue);{let oe=P(()=>n(_)&&n(N)!=="unknown"&&n(N)!=="unavailable"),_e=P(()=>e.mode==="add"&&m.length>0);hl(re,{get selectedTags(){return e.tags},onRejectedTag:de=>{f(c,new Set([...n(c),de]),!0)},get onChangeTags(){return e.onChangeTags},get genTagsEnabled(){return n(oe)},onGenTags:j,get generatingTags(){return n(v)},onUsePreviousTags:C,get previousTagsEnabled(){return n(_e)},get shownTagInput(){return n(l)},set shownTagInput(de){f(l,de,!0)}})}g(t,K),ke()}pt(["input"]);function dh(t,e){Ce(e,!0);const{isInitedNotes:a,createNote:r,updateNote:o,deleteNote:s,getNoteById:i,getGetMapNotes:l,pinNote:d}=At(),{getViewMode:c,setPrevTags:u}=Hn(),{deleteSearchParam:v,getSearchParams:h}=Bt(),{replaceDialogPage:p}=zt();let w=R("loading"),x=R("idle"),m=R(""),C=R(!1),N=R(void 0),_=R(""),y=R(ft([])),T=R(-1),j=R(ft([])),K=R("unknown"),O=R(null);const z=()=>{n(j).push({link:Ba(n(N)),text:n(_),tags:n(y).slice(),updatedAt:Date.now()}),f(T,0),(n(N)?.title||n(N)?.url||n(_)||n(y).length>0)&&f(O,{link:n(N),text:n(_),tags:n(y).slice()},!0),f(w,"finish")},ae=()=>{{const Q=h().get("url"),ie=h().get("title"),fe=h().get("text");Q&&f(N,{url:Q,title:ie||""},!0),fe&&(!Q&&Jo(fe)?f(N,{url:fe,title:ie||new URL(fe).hostname},!0):f(_,fe,!0)),v("url"),v("title"),v("text"),z();return}},le=P(()=>a()&&n(w)==="finish"),G=async Q=>{f(x,"loading");try{n(m)?await o(n(m),{link:Q.link,text:Q.text,tags:Q.tags.slice()}):(f(m,await r({link:Q.link,text:Q.text,tags:Q.tags.slice(),pinned:n(C)}),!0),p(`${Te.NewNote}?id=${n(m)}`))}finally{f(x,"idle")}},B=async()=>{f(x,"loading");try{await s(n(m)),f(m,""),p(`${Te.NewNote}`)}finally{f(x,"idle")}},F=Q=>{f(C,Q,!0),n(m)&&d(n(m),Q)};Pe(()=>{ae()}),Pe(()=>()=>{n(y).length>0&&u([...n(y)])});const pe=()=>{f(O,{link:n(N),text:n(_),tags:n(y).slice()},!0)},Se=Q=>{f(N,Q,!0),f(j,n(j).slice(0,n(T)+1),!0),f(K,"unknown"),n(j).push({link:Ye(n(N)),text:n(_),tags:Ye(n(y)),updatedAt:Date.now()}),f(T,n(j).length-1),pe()},Z=Q=>{f(y,Q,!0),f(j,n(j).slice(0,n(T)+1),!0),f(K,"unknown"),n(j).push({link:Ye(n(N)),text:n(_),tags:Ye(n(y)),updatedAt:Date.now()}),f(T,n(j).length-1),pe()},H=Q=>{f(_,Q,!0),f(j,n(j).slice(0,n(T)+1),!0),n(K)!=="text"?(n(j).push({link:Ye(n(N)),text:n(_),tags:Ye(n(y)),updatedAt:Date.now()}),f(T,n(j).length-1)):(n(j)[n(T)].text=n(_),n(j)[n(T)].updatedAt=Date.now()),f(K,"text"),pe()};let te=P(()=>n(T)>0),ve=P(()=>n(T)<n(j).length-1);const ue=()=>{if(n(T)<=0)return;f(T,n(T)-1);const Q=n(j)[n(T)];f(N,Ye(Q.link),!0),f(_,Q.text,!0),f(y,Ye(Q.tags),!0),f(K,"unknown"),pe()},re=()=>{if(n(T)>=n(j).length-1)return;f(T,n(T)+1);const Q=n(j)[n(T)];f(N,Ye(Q.link),!0),f(_,Q.text,!0),f(y,Ye(Q.tags),!0),f(K,"unknown"),pe()};let oe=P(l);Ve(()=>{if(!n(le)||n(x)==="loading"||!n(m))return;const Q=n(oe)().get(n(m));Ot(()=>{Q?.data&&(Q.data.pinned!==n(C)&&f(C,!!Q.data.pinned),Q.data.text!==n(_)&&H(Q.data.text),(Q.data.link?.url!==n(N)?.url||Q.data.link?.title!==n(N)?.title)&&Se(Ye(Q.data.link)),JSON.stringify(Q.data.tags)!==JSON.stringify(n(y))&&Z(Ye(Q.data.tags)))})}),Ve(()=>{n(x)!=="loading"&&n(O)&&Ot(()=>{n(O)&&(n(m)&&!n(O)?.link?.title&&!n(O)?.link?.url&&!n(O)?.text&&n(O)?.tags.length===0?B():(console.log("save update",n(O)),G(n(O))),f(O,null))})});var _e=ye(),de=D(_e);{var se=Q=>{{let ie=P(()=>i(n(m))?.data.deletedAt),fe=P(()=>i(n(m))?.data.archivedAt);ch(Q,{get deletedAt(){return n(ie)},get archivedAt(){return n(fe)},get noteId(){return n(m)},get canNext(){return n(ve)},get canPrev(){return n(te)},onPrev:ue,onNext:re,mode:"add",get link(){return n(N)},onChangeLink:Se,get text(){return n(_)},onChangeText:H,get tags(){return n(y)},onChangeTags:Z,get pinned(){return n(C)},onPinnedChange:F})}};W(de,Q=>{n(le)&&Q(se)})}g(t,_e),ke()}const uh="modulepreload",fh=function(t){return"/"+t},Bs={},kt=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");o=d(a.map(c=>{if(c=fh(c),c in Bs)return;Bs[c]=!0;const u=c.endsWith(".css"),v=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${v}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":uh,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((p,w)=>{h.addEventListener("load",p),h.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var vh=k('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function gh(t){var e=vh(),a=M(b(e),2);Rt(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=We("Reload");g(r,s)},$$slots:{default:!0}}),g(t,e)}var hh=k('<div class="p-uzefkz"><!></div>');function ph(t,e){Ce(e,!0);let a=R(!1);const{getDialogPageHeight:r}=ds(),o=P(r);Pe(()=>{const d=setTimeout(()=>{f(a,!0)},250);return()=>{clearTimeout(d)}});var s=hh(),i=b(s);{var l=d=>{Ia(d,{})};W(i,d=>{n(a)&&d(l)})}Me(()=>$a(s,`min-height: ${n(o)??""}px;`)),g(t,s),ke()}function Mt(t,e){Ce(e,!0);const a={},r=Object.assign({"./Pages/About.svelte":()=>kt(()=>import("./aBFK2OD0c.js"),__vite__mapDeps([0,1])),"./Pages/AccessKeys.svelte":()=>kt(()=>import("./aKb-CCxMu.js"),__vite__mapDeps([2,3,4,5])),"./Pages/Account.svelte":()=>kt(()=>import("./abNIc73T1.js"),__vite__mapDeps([6,3,7])),"./Pages/Auth.svelte":()=>kt(()=>import("./aBWMkumg6.js"),__vite__mapDeps([8,9])),"./Pages/ChangeTags.svelte":()=>kt(()=>import("./aDBjCV8na.js"),[]),"./Pages/ConfirmAccessKey.svelte":()=>kt(()=>import("./a8AYUTgY9.js"),__vite__mapDeps([10,4,3,11,12])),"./Pages/Exit.svelte":()=>kt(()=>import("./aD6qr25Bx.js"),__vite__mapDeps([13,14])),"./Pages/ExportData.svelte":()=>kt(()=>import("./aDohM3usH.js"),__vite__mapDeps([15,16,17,18,19,20])),"./Pages/Extension.svelte":()=>kt(()=>import("./aCbsXKhlE.js"),__vite__mapDeps([21,18,19,22])),"./Pages/ImportData.svelte":()=>kt(()=>import("./asWMTxMv7.js"),__vite__mapDeps([23,24])),"./Pages/Install.svelte":()=>kt(()=>import("./aDm_ouFG4.js"),__vite__mapDeps([25,26])),"./Pages/InstallSuccess.svelte":()=>kt(()=>import("./aB1OC1vIG.js"),__vite__mapDeps([27,28])),"./Pages/Note.svelte":()=>kt(()=>import("./aDTV5J8_R.js"),__vite__mapDeps([29,30])),"./Pages/Settings.svelte":()=>kt(()=>import("./aDY53p3fn.js"),__vite__mapDeps([31,18,19,16,17,32])),"./Pages/Signin.svelte":()=>kt(()=>import("./aBg_YOFdy.js"),__vite__mapDeps([33,4,3,11,34])),"./Pages/Signup.svelte":()=>kt(()=>import("./aDRSS6QYD.js"),__vite__mapDeps([35,11,4,3,34])),"./Pages/Subscription.svelte":()=>kt(()=>import("./aDizyi0XY.js"),__vite__mapDeps([36,37])),"./Pages/Sync.svelte":()=>kt(()=>import("./aB0rYZ7t7.js"),__vite__mapDeps([38,39]))}),o=async l=>{const d=`./Pages/${l[0].toUpperCase()+l.slice(1)}.svelte`;if(!a[l]){if(r[d]){const c=r[d]();return a[l]={promise:c},a[l].module=await c,a[l].module}throw new Error(`Page ${l} not found`)}return a[l].module||await a[l].promise};var s=ye(),i=D(s);Yc(i,()=>o(e.page),l=>{ph(l,{})},(l,d)=>{const c=P(()=>n(d).default);var u=ye(),v=D(u);Qc(v,()=>n(c),(h,p)=>{p(h,{get params(){return e.params},get hidden(){return e.hidden}})}),g(l,u)},l=>{gh(l)}),g(t,s),ke()}var tr,_l,wl;class mh{constructor(e){Ke(this,tr);jt(this,"data");jt(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),dt(this,tr,_l).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,dt(this,tr,wl).call(this)),e}isEmpty(){return this.data.length===0}}tr=new WeakSet,_l=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},wl=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class _h{constructor(e,a){jt(this,"heap");jt(this,"done");jt(this,"cache",[]);this.heap=new mh(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var wh=k("<span>Back to notes</span>"),yh=k('<div class="c p-130fajz">No notes in bin</div> <div class="d p-130fajz"><!></div>',1),bh=k("<span>Back to notes</span>"),Ch=k('<div class="c p-130fajz">No notes in archive</div> <div class="d p-130fajz"><!></div>',1),kh=k('<p class="f">No notes in bin</p>'),Sh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),xh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Th=k('<div class="g p-130fajz"><div class="d p-130fajz"><!></div> <div>or</div> <div class="d p-130fajz"><!></div></div>'),Ph=k('<div class="e p-130fajz"><!></div>'),Eh=k('<div class="h"><div class="c p-130fajz">No notes found</div></div>'),Nh=k('<div class="i p-130fajz"><ul class="p-130fajz"></ul></div>'),Ah=k('<div class="a p-130fajz"><div class="b p-130fajz"><!></div></div>');function Dh(t,e){Ce(e,!0);const{getCountDialog:a}=Qt(),{getScrollContainer:r}=vo(),{createHandleClickDialogPage:o,createDialogPageHref:s}=zt(),{getSelectedTags:i}=qn(),{getFeedOrder:l}=Hi(),{checkNotesInArchive:d,checkNotesInBin:c,checkNotes:u,isInitedNotes:v}=At(),{getSelectedMetaTags:h}=fo(),{replaceSearchParams:p,getHref:w}=Bt();Ea();const{getFiltredNotesLength:x,getFiltredNotes:m,getUpdatedFiltredNotesTimestamp:C}=Ma(),{getFeedSearch:N}=Ea();let _="keyboard",y=P(h),T=P(x),j=P(m),K=P(C),O=P(v),z=54,ae=R(0),le=R(0),G=R(0),B=R(null),F=P(r),pe=null,Se=null,Z=P(()=>n(y).has(st.ARCHIVED)?"archive":n(y).has(st.BIN)?"bin":"notes");const H=P(i);Ve(()=>{n(H),n(oe),n(F)?.scrollTo(0,0)});const{enable:te}=cs(),ve=()=>{te(),pe||(pe=requestAnimationFrame(()=>{const $=n(F)?.scrollTop||0;f(G,$,!0);const be=Math.ceil(n(ae)/z);f(le,Math.floor($/(z*be))*(z*be)),pe=null}))},ue=()=>{Se||(Se=requestAnimationFrame(()=>{f(ae,window.innerHeight-180||0,!0);const $=n(F)?.scrollTop||0;f(G,$,!0);const be=Math.ceil(n(ae)/z);f(le,Math.floor($/(z*be))*(z*be)),Se=null}))};Pe(()=>{const $=be=>{if(!(!Ov()&&Kr()===void 0)&&!(a()>0)&&(be.key==="ArrowDown"||be.key==="ArrowUp")){if(be.preventDefault(),be.key==="ArrowDown"){const Fe=Kr(),Ie=n(se).findIndex(qe=>qe.id===Fe),Ze=Ee(),Je=Ae();if(!Fe||Ie===-1)vn(Ze?.id);else if(Ie<=Je.index&&Ie>=Ze.index)Fs()&&Ie!==-1&&fe(Ie+1)&&n(F)&&(n(F).scrollTop=Math.floor(n(F).scrollTop/z)*z+z);else if(Ie>Je.index&&!fe(Ie-1)&&fe(Ie)){n(F)&&(n(F).scrollTop=Math.ceil(n(F).scrollTop/z)*z+z);const qe=Fs();vn(qe)}else vn(Ze?.id)}else if(be.key==="ArrowUp"){const Fe=Kr(),Ie=n(se).findIndex(qe=>qe.id===Fe),Ze=Ee(),Je=Ae();if(!Fe||Ie===-1)vn(Je?.id);else if(Ie<=Je.index&&Ie>=Ze.index)Os()&&Ie!==-1&&fe(Ie-1)&&n(F)&&(n(F).scrollTop=Math.ceil(n(F).scrollTop/z)*z-z);else if(Ie<Ze.index&&!fe(Ie+1)&&fe(Ie)){n(F)&&(n(F).scrollTop=n(ie)+Ie*z-z);const qe=Os();vn(qe)}else vn(Je?.id)}ml()||Zo()}};return document.addEventListener("keydown",$),()=>{document.removeEventListener("keydown",$)}}),Pe(()=>{ue(),ve()});const re=()=>{ve()};Ve(()=>{N()!==""&&_==="keyboard"&&(vn(Ee().id),Zo())}),Ve(()=>(n(F)?.addEventListener("scroll",re),window.addEventListener("resize",ue),()=>{n(F)?.removeEventListener("scroll",re),window.removeEventListener("resize",ue)}));const oe=P(l);Ve(()=>{n(oe),n(K),f(B,new _h(n(j),($,be)=>{if(!$||!be||!$.data||!be.data)return 0;if($.data.pinned&&!be.data.pinned)return-1;if(!$.data.pinned&&be.data.pinned)return 1;if($.data.pinned&&be.data.pinned){if($.data.pinned<be.data.pinned)return 1;if($.data.pinned>be.data.pinned)return-1}const Fe=(Ie,Ze)=>Ie.data.text||Ze.data.text?(Ie.data.text||"").localeCompare(Ze.data.text||""):(Ie.data.link?.title||"").localeCompare(Ze.data.link?.title||"");switch(n(oe)){case"newest":return $.data.createdAt<be.data.createdAt?1:$.data.createdAt>be.data.createdAt?-1:Fe($,be);case"oldest":return $.data.createdAt>be.data.createdAt?1:$.data.createdAt<be.data.createdAt?-1:Fe($,be);case"AtoZ":return Fe($,be);case"ZtoA":return Fe(be,$);case"updatedNewest":return $.data.updatedAt<be.data.updatedAt?1:$.data.updatedAt>be.data.updatedAt?-1:Fe($,be);default:return 0}}),!0)});const _e=P(()=>n(T)*z);let se=P(()=>{n(K);const $=Math.ceil(n(ae)/z);let be=Math.floor(n(le)/z);return be=be-Math.min(be,$),n(B)?.get(be,be+$*3)||[]}),Q=P(()=>z*Math.ceil(n(ae)/z));const ie=P(()=>n(le)-Math.min(n(le),n(Q))),fe=$=>$*z<n(G)-n(ie)-z/2||$*z>n(G)-n(ie)+Math.floor(n(ae)/z)*z,Ee=()=>{for(let $=0;$<n(se).length;$++)if(!fe($))return{index:$,id:n(se)[$].id};return{index:-1,id:void 0}},Ae=()=>{for(let $=n(se).length-1;$>=0;$--)if(!fe($))return{index:$,id:n(se)[$].id};return{index:-1,id:void 0}};Pe(()=>{document.addEventListener("mousemove",()=>{_="mouse"}),document.addEventListener("keydown",()=>{_="keyboard"})});var he=Ah(),ce=b(he),xe=b(ce);{var we=$=>{Ia($,{})},Le=$=>{var be=ye(),Fe=D(be);{var Ie=Je=>{var qe=yh(),I=M(D(qe),2),A=b(I);{let S=P(()=>w(""));Rt(A,{element:"a",get href(){return n(S)},onClick:L=>{L.preventDefault(),p("")},children:(L,U)=>{var E=wh();g(L,E)},$$slots:{default:!0}})}g(Je,qe)},Ze=Je=>{var qe=ye(),I=D(qe);{var A=L=>{var U=Ch(),E=M(D(U),2),ee=b(E);{let q=P(()=>w(""));Rt(ee,{element:"a",get href(){return n(q)},onClick:X=>{X.preventDefault(),p("")},children:(X,Y)=>{var J=bh();g(X,J)},$$slots:{default:!0}})}g(L,U)},S=L=>{var U=ye(),E=D(U);{var ee=X=>{var Y=Ph(),J=b(Y);{var ne=De=>{var Re=kh();g(De,Re)},Ne=De=>{var Re=Th(),Oe=b(Re),Be=b(Oe);{let it=P(()=>s(Te.NewNote)),ct=P(()=>o(Te.NewNote));Rt(Be,{element:"a",get href(){return n(it)},get onClick(){return n(ct)},children:(mt,Pn)=>{var Tt=Sh(),Dt=D(Tt);ge(Dt,()=>({"--size":"18px","--color":"#b0b0b0"})),me(Dt.lastChild,{name:"plus"}),g(mt,Tt)},$$slots:{default:!0}})}var wt=M(Oe,4),rt=b(wt);{let it=P(()=>s(Te.ImportData)),ct=P(()=>o(Te.ImportData));Rt(rt,{element:"a",get href(){return n(it)},get onClick(){return n(ct)},children:(mt,Pn)=>{var Tt=xh(),Dt=D(Tt);ge(Dt,()=>({"--size":"18px","--color":"#b0b0b0"})),me(Dt.lastChild,{name:"import"}),g(mt,Tt)},$$slots:{default:!0}})}g(De,Re)};W(J,De=>{n(Z)==="bin"?De(ne):De(Ne,!1)})}g(X,Y)},q=X=>{var Y=ye(),J=D(Y);{var ne=De=>{var Re=Eh();g(De,Re)},Ne=De=>{var Re=Nh(),Oe=b(Re);Bn(Oe,23,()=>n(se),Be=>Be.data,(Be,wt,rt)=>{var it=ye(),ct=D(it);{var mt=Pn=>{{let Tt=P(()=>n(se)[n(rt)+1]?.id),Dt=P(()=>n(se)[n(rt)-1]?.id),mo=P(()=>fe(n(rt))),_o=P(()=>(n(rt)+5)*z<n(G)-n(ie)-z/2||(n(rt)+5)*z>n(G)-n(ie)+Math.floor(n(ae)/z)*z);Xv(Pn,{get nextNoteId(){return n(Tt)},get prevNoteId(){return n(Dt)},get mode(){return n(Z)},get focusHidden(){return n(mo)},get showMenuUp(){return n(_o)},get noteId(){return n(wt).id},get noteData(){return n(wt).data}})}};W(ct,Pn=>{n(wt).data&&Pn(mt)})}g(Be,it)}),Me(Be=>{$a(Re,Be),$a(Oe,`transform: translateY(${n(ie)??""}px);`)},[()=>`--minHeight: ${Math.max((n(_e)>n(ae),n(_e)),0)}px`]),g(De,Re)};W(J,De=>{n(se).length===0?De(ne):De(Ne,!1)},!0)}g(X,Y)};W(E,X=>{!c()&&!d()&&!u()?X(ee):X(q,!1)},!0)}g(L,U)};W(I,L=>{n(Z)==="archive"&&!d()?L(A):L(S,!1)},!0)}g(Je,qe)};W(Fe,Je=>{n(Z)==="bin"&&!c()?Je(Ie):Je(Ze,!1)},!0)}g($,be)};W(xe,$=>{n(O)?$(Le,!1):$(we)})}g(t,he),ke()}var Mh=k('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Ih(t){var e=Mh(),a=M(D(e),2),r=b(a);Dh(r,{}),g(t,e)}function Lh(t,e){Ce(e,!0);const a=Gn();let r=ze(e,"animationRef",7),o=ze(e,"dialog",7);gl(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let c=0,u=0,v=()=>1;if(r().current){r().current.pause();let p=Number(r().current.currentTime);yr()&&(p=Number(p)+50,r().current.currentTime=Math.min(Math.max(jn-1,p),p));const w=r().current.effect?.getComputedTiming().progress||0;v=()=>w,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(p=>requestAnimationFrame(p)),u=1-v();const h=u*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-u)*.1}`),a.swipingRatio=Math.abs(1-u)*25,a.isSwiping=!0,a.duration=0,o().style.transform=`translate3d(${h}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:c,currentPosition:h,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:c,width:u})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-c/u)*.1}`),o().style.transform=`translate3d(${c}px, 0, 0)`,a.swipingRatio=Math.abs(1-c/u)*25)},onFinish:({swipeVelocity:c,currentPosition:u,width:v,actionThreshold:h,initialPosition:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const w=()=>Math.abs(p+u)/v*100;let x=null;if(c<=-ca?x="open":c>=ca?x="close":x=Math.abs(w())>h?"close":"open",r().progress=vl(w()/100),x==="close"){const m=(1-(r().progress||0))*jn;a.duration=m/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=0,e.onClose()}else{const m=(r().progress||1)*jn;a.duration=m/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=25,e.onOpen()}}}),ke()}var Rh=k('<div class="d p-8xr118"> </div>'),Fh=k('<button class="e f p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Oh=k('<a class="e g p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),zh=k('<div><div class="a p-8xr118"><div class="b p-8xr118"><div class="c p-8xr118"><!> <!> <!></div></div></div> <!> <!></div>'),Bh=k("<dialog><!></dialog> <!>",1);function jh(t,e){Ce(e,!0);const{isScrolling:a,enable:r}=cs();let o=R(null),s=R(null),i={};const l=Gn(),{checkLeftEnd:d,checkLeftStart:c,setLeftEnd:u,setLeftStart:v,getCountDialog:h}=Qt(),p=P(c),w=P(d);let x=P(()=>l.working);const m=()=>{e.dialogState!=="opened"&&e.onStartOpening()},C=()=>{e.onClose()},N=()=>{e.onSwipe()},_=G=>{G.preventDefault(),C()};Pe(()=>(n(o)?.addEventListener("close",C),n(o)?.addEventListener("cancel",_),()=>{n(o)?.removeEventListener("close",C),n(o)?.removeEventListener("cancel",_)})),Ve(()=>{h()>0&&(l.swipingRatio=25)}),Ve(()=>{e.dialogState==="opening"?Ot(()=>{requestAnimationFrame(()=>{if(!n(o))return;const G=(i.progress||1)*jn,B=n(o).style.transform||`translate3d(${n(p)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const F=n(o)?.animate([{transform:B},{transform:"translate3d(0, 0, 0)"}],{duration:G,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=F,F&&(F.onfinish=()=>{e.onOpened(),l.swipingRatio=25,n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=la().duration,F.cancel(),i.current=void 0,i.progress=void 0,n(p)&&v(!1)})})}):e.dialogState==="closing"&&Ot(()=>{requestAnimationFrame(()=>{if(!n(o))return;l.swipingRatio=0;const G=(1-(i.progress||0))*jn,B=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const F=n(o)?.animate([{transform:B},{transform:`translate3d(${n(w)?"-100%":"100%"}, 0, 0)`}],{duration:G,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=F,F&&(F.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=la().duration,F.cancel(),i.current=void 0,i.progress=void 0,n(w)&&u(!1)})})})});const y=()=>{r()},T=P(a);Pe(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),yr()&&n(o).getBoundingClientRect(),!n(x)){e.onOpened();return}e.onStartOpening()}});var j=Bh(),K=D(j),O=b(K);{var z=G=>{var B=zh(),F=b(B),pe=b(F),Se=b(pe),Z=b(Se);{var H=se=>{var Q=Rh(),ie=b(Q);Me(()=>vt(ie,e.title)),g(se,Q)};W(Z,se=>{e.title&&se(H)})}var te=M(Z,2);{var ve=se=>{var Q=Fh();Q.__click=C;var ie=b(Q);ge(ie,()=>({"--size":"28px"})),me(ie.lastChild,{name:"back"});var fe=M(ie,2);_t(fe,{children:(Ee,Ae)=>{var he=We("back");g(Ee,he)}}),g(se,Q)};W(te,se=>{e.blocked||se(ve)})}var ue=M(te,2);{var re=se=>{var Q=Oh();Q.__click=function(...Ee){e.onOpenWindow?.apply(this,Ee)};var ie=b(Q);ge(ie,()=>({"--scale":"0.7","--size":"28px"})),me(ie.lastChild,{name:"open-window"});var fe=M(ie,2);_t(fe,{children:(Ee,Ae)=>{var he=We("open window");g(Ee,he)}}),Me(()=>ut(Q,"href",e.openWindowHref)),g(se,Q)};W(ue,se=>{e.onOpenWindow&&se(re)})}var oe=M(F,2);je(oe,()=>e.children);var _e=M(oe,2);{var de=se=>{go(se,{})};W(_e,se=>{e.dialogState==="opened"&&se(de)})}et(B,se=>f(s,se),()=>n(s)),Me(()=>tt(B,1,at({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-8xr118")),Zt("scroll",B,y),g(G,B)};W(O,G=>{e.dialogState!=="preOpening"&&G(z)})}et(K,G=>f(o,G),()=>n(o));var ae=M(K,2);{var le=G=>{Lh(G,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:m,onClose:C,onSwipe:N,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};W(ae,G=>{n(s)&&!n(T)&&!e.blocked&&!e.hidden&&G(le)})}Me(()=>tt(K,1,at({h:!0,i:n(x),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(p),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-8xr118")),g(t,j),ke()}pt(["click"]);function Hh(t,e){Ce(e,!0);let a=ze(e,"hidden",3,!1),r=ze(e,"onClosed",3,()=>{}),o=R(0);Pe(()=>{const C=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",C),C(),()=>{window.removeEventListener("resize",C)}});const{dialogDec:s,dialogInc:i}=Qt(),l=Gn();Pe(()=>(i(),()=>{s()}));let d=R("closed");const c=()=>{f(d,"opening")},u=()=>{f(d,"swiping")},v=()=>{f(d,"opened")},h=()=>{e.onClose(),f(d,"closing")},p=()=>{f(d,"closed"),r()()};Ve(()=>{e.shown&&n(d)==="closed"?f(d,"preOpening"):!e.shown&&n(d)==="opened"&&f(d,"closing")}),Ve(()=>{n(d)==="closed"?(l.swipingRatio=0,l.duration=.2):(n(d)==="opened"||n(d)==="opening")&&(l.duration=.2,l.swipingRatio=25)});var w=ye(),x=D(w);{var m=C=>{jh(C,{get dialogWidth(){return n(o)},get dialogState(){return n(d)},get title(){return e.title},onStartOpening:c,onOpened:v,onClose:h,onClosed:p,onSwipe:u,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(N,_)=>{var y=ye(),T=D(y);je(T,()=>e.children),g(N,y)},$$slots:{default:!0}})};W(x,C=>{n(d)!=="closed"&&C(m)})}g(t,w),ke()}const Uh=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};Pe(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),Pe(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var Wh=k('<button class="c d p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Vh=k('<div class="e p-phkj9l"> </div>'),Kh=k('<button class="c f p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),qh=k('<dialog><div><div class="a p-phkj9l"><div class="b p-phkj9l"><div><!></div> <!> <div><!></div></div></div> <div class="g p-phkj9l"><!></div></div> <!></dialog> <!>',1);function Gh(t,e){Ce(e,!0);let a=ze(e,"blockedDialog",3,!1),r=ze(e,"hiddenDialog",3,!1),o=ze(e,"isDesktopAnimationOff",3,!1),s=R(null),i=R(null),l=R(!1),d=R(null);Uh({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const c=Gn();Ve(()=>{e.stateDialog==="closing"&&(c.working?n(i)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const{getDialogPageHeight:u}=ds(),v=P(u);Pe(()=>{setTimeout(()=>{f(l,!0)},50)});var h=qh(),p=D(h),w=b(p),x=b(w),m=b(x),C=b(m),N=b(C);{var _=B=>{var F=Wh();F.__click=()=>{e.onStartBack()};var pe=b(F);ge(pe,()=>({"--size":"24px"})),me(pe.lastChild,{name:"back"});var Se=M(pe,2);_t(Se,{children:(Z,H)=>{var te=We("back");g(Z,te)}}),g(B,F)};W(N,B=>{(!(a()||r())||a())&&e.onStartBack&&B(_)})}var y=M(C,2);{var T=B=>{var F=Vh(),pe=b(F);Me(()=>vt(pe,e.title)),g(B,F)};W(y,B=>{e.title&&B(T)})}var j=M(y,2),K=b(j);{var O=B=>{var F=Kh();F.__click=()=>{e.onStartClose()};var pe=b(F);ge(pe,()=>({"--size":"24px"})),me(pe.lastChild,{name:"close"});var Se=M(pe,2);_t(Se,{children:(Z,H)=>{var te=We("close");g(Z,te)}}),g(B,F)};W(K,B=>{a()||r()||B(O)})}var z=M(x,2),ae=b(z);je(ae,()=>e.children),et(w,B=>f(i,B),()=>n(i));var le=M(w,2);go(le,{get ref(){return n(d)},set ref(B){f(d,B,!0)}}),et(p,B=>f(s,B),()=>n(s));var G=M(p,2);us(G,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose},get notificationRef(){return n(d)},set notificationRef(B){f(d,B,!0)}}),Me(()=>{tt(p,1,at({h:!0,i:e.stateDialog==="open",j:n(l),k:c.working,l:o(),m:r()}),"p-phkj9l"),$a(w,`height: ${n(v)+74}px`),tt(w,1,at({n:!0,i:e.stateDialog==="open",j:n(l),k:c.working,l:o()}),"p-phkj9l")}),g(t,h),ke()}pt(["click"]);const Yh=({onStartClose:t,onClosed:e})=>{let a=R("close");return{get state(){return n(a)},set state(i){f(a,i,!0)},handleStartClose:(i=!1)=>{i||(f(a,"closing"),t?.())},handleOpen:()=>{f(a,"open")},handleClose:()=>{f(a,"close"),e?.()}}};function Xh(t,e){Ce(e,!0);let a=ze(e,"blockedDialog",3,!1),r=ze(e,"hiddenDialog",3,!1),o=ze(e,"onStartClose",3,()=>{}),s=ze(e,"onClosed",3,()=>{}),i=Yh({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:l,dialogInc:d}=Qt();Pe(()=>(d(),()=>{l()})),Ve(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const c=p=>{p.key==="Escape"&&a()&&(p.preventDefault(),p.stopPropagation())};Pe(()=>(document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}));var u=ye(),v=D(u);{var h=p=>{Gh(p,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(w,x)=>{var m=ye(),C=D(m);je(C,()=>e.children),g(w,m)},$$slots:{default:!0}})};W(v,p=>{i.state!=="close"&&p(h)})}g(t,u),ke()}const js=(t,e=Xe,a=Xe,r)=>{let o=Pr(()=>Rl(r?.(),!1));var s=ye(),i=D(s);{var l=c=>{Ct(c,{children:(u,v)=>{Mt(u,{get hidden(){return n(o)},get page(){return Te.Settings}})},$$slots:{default:!0}})},d=c=>{var u=ye(),v=D(u);{var h=w=>{Ct(w,{children:(x,m)=>{dh(x,{})},$$slots:{default:!0}})},p=w=>{var x=ye(),m=D(x);{var C=_=>{Ct(_,{children:(y,T)=>{Mt(y,{get params(){return a()},get hidden(){return n(o)},get page(){return Te.Note}})},$$slots:{default:!0}})},N=_=>{var y=ye(),T=D(y);{var j=O=>{Ct(O,{children:(z,ae)=>{Mt(z,{get hidden(){return n(o)},get page(){return Te.ImportData}})},$$slots:{default:!0}})},K=O=>{var z=ye(),ae=D(z);{var le=B=>{Ct(B,{children:(F,pe)=>{Mt(F,{get hidden(){return n(o)},get page(){return Te.ExportData}})},$$slots:{default:!0}})},G=B=>{var F=ye(),pe=D(F);{var Se=H=>{Ct(H,{children:(te,ve)=>{vg(te,{})},$$slots:{default:!0}})},Z=H=>{var te=ye(),ve=D(te);{var ue=oe=>{Ct(oe,{children:(_e,de)=>{Mt(_e,{get hidden(){return n(o)},get page(){return Te.Install}})},$$slots:{default:!0}})},re=oe=>{var _e=ye(),de=D(_e);{var se=ie=>{Ct(ie,{children:(fe,Ee)=>{Mt(fe,{get hidden(){return n(o)},get page(){return Te.InstallSuccess}})},$$slots:{default:!0}})},Q=ie=>{var fe=ye(),Ee=D(fe);{var Ae=ce=>{Ct(ce,{children:(xe,we)=>{Mt(xe,{get hidden(){return n(o)},get page(){return Te.Auth}})},$$slots:{default:!0}})},he=ce=>{var xe=ye(),we=D(xe);{var Le=be=>{Ct(be,{children:(Fe,Ie)=>{Mt(Fe,{get hidden(){return n(o)},get page(){return Te.Signup}})},$$slots:{default:!0}})},$=be=>{var Fe=ye(),Ie=D(Fe);{var Ze=qe=>{Ct(qe,{children:(I,A)=>{Mt(I,{get hidden(){return n(o)},get page(){return Te.Signin}})},$$slots:{default:!0}})},Je=qe=>{var I=ye(),A=D(I);{var S=U=>{Ct(U,{children:(E,ee)=>{Mt(E,{get hidden(){return n(o)},get page(){return Te.AccessKeys}})},$$slots:{default:!0}})},L=U=>{var E=ye(),ee=D(E);{var q=Y=>{Ct(Y,{children:(J,ne)=>{Mt(J,{get hidden(){return n(o)},get page(){return Te.Account}})},$$slots:{default:!0}})},X=Y=>{var J=ye(),ne=D(J);{var Ne=Re=>{Ct(Re,{children:(Oe,Be)=>{Mt(Oe,{get hidden(){return n(o)},get page(){return Te.ConfirmAccessKey}})},$$slots:{default:!0}})},De=Re=>{var Oe=ye(),Be=D(Oe);{var wt=it=>{Ct(it,{children:(ct,mt)=>{Mt(ct,{get hidden(){return n(o)},get page(){return Te.Exit}})},$$slots:{default:!0}})},rt=it=>{var ct=ye(),mt=D(ct);{var Pn=Tt=>{var Dt=ye(),mo=D(Dt);{var _o=La=>{Ct(La,{children:(Ir,fs)=>{Mt(Ir,{get hidden(){return n(o)},get page(){return Te.Sync}})},$$slots:{default:!0}})},yl=La=>{var Ir=ye(),fs=D(Ir);{var bl=Ra=>{Ct(Ra,{children:(Lr,vs)=>{Mt(Lr,{get hidden(){return n(o)},get page(){return Te.Subscription}})},$$slots:{default:!0}})},Cl=Ra=>{var Lr=ye(),vs=D(Lr);{var kl=Fa=>{Ct(Fa,{children:(wo,xl)=>{Mt(wo,{get hidden(){return n(o)},get page(){return Te.About}})},$$slots:{default:!0}})},Sl=Fa=>{Ct(Fa,{children:(wo,xl)=>{lg(wo,{})},$$slots:{default:!0}})};W(vs,Fa=>{e()===Te.About?Fa(kl):Fa(Sl,!1)},!0)}g(Ra,Lr)};W(fs,Ra=>{e()===Te.Subscription?Ra(bl):Ra(Cl,!1)},!0)}g(La,Ir)};W(mo,La=>{e()===Te.Sync?La(_o):La(yl,!1)},!0)}g(Tt,Dt)};W(mt,Tt=>{e(),Te.Extension,Tt(Pn,!1)},!0)}g(it,ct)};W(Be,it=>{e()===Te.Exit?it(wt):it(rt,!1)},!0)}g(Re,Oe)};W(ne,Re=>{e()===Te.ConfirmAccessKey?Re(Ne):Re(De,!1)},!0)}g(Y,J)};W(ee,Y=>{e()===Te.Account?Y(q):Y(X,!1)},!0)}g(U,E)};W(A,U=>{e()===Te.AccessKeys?U(S):U(L,!1)},!0)}g(qe,I)};W(Ie,qe=>{e()===Te.Signin?qe(Ze):qe(Je,!1)},!0)}g(be,Fe)};W(we,be=>{e()===Te.Signup?be(Le):be($,!1)},!0)}g(ce,xe)};W(Ee,ce=>{e()===Te.Auth?ce(Ae):ce(he,!1)},!0)}g(ie,fe)};W(de,ie=>{e()===Te.InstallSuccess?ie(se):ie(Q,!1)},!0)}g(oe,_e)};W(ve,oe=>{e()===Te.Install?oe(ue):oe(re,!1)},!0)}g(H,te)};W(pe,H=>{e()===Te.AccountSetup?H(Se):H(Z,!1)},!0)}g(B,F)};W(ae,B=>{e()===Te.ExportData?B(le):B(G,!1)},!0)}g(O,z)};W(T,O=>{e()===Te.ImportData?O(j):O(K,!1)},!0)}g(_,y)};W(m,_=>{e()===Te.Note?_(C):_(N,!1)},!0)}g(w,x)};W(v,w=>{e()===Te.NewNote?w(h):w(p,!1)},!0)}g(c,u)};W(i,c=>{e()===Te.Settings?c(l):c(d,!1)})}g(t,s)};var Jh=k("<!> <!>",1);function Zh(t,e){Ce(e,!0);let a=P(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:r,checkClosableDialog:o}=Qt(),{sidebarClose:s,getSidebarState:i}=Ar(),l=P(r),d=P(o),{getDialogPages:c}=zt(),{getAccount:u}=ls();let v=P(c),h=P(()=>u()!==void 0);const{checkMobileSize:p}=va();let w=R(ft([]));const x=P(p),{clearDialogPages:m,popDialogPage:C}=zt(),{checkLeftStart:N}=Qt();let _=P(N);Ve(()=>{c().length>0&&i()!=="closed"&&setTimeout(()=>{s()},60)});const y=()=>{C()},T=()=>{m()};Ve(()=>{n(v),n(x),Ot(()=>{if(n(x))n(v).length>=n(w).length||n(_)?f(w,n(v).map(B=>({page:B,shown:!0})),!0):f(w,n(w).map((B,F)=>({page:B.page,shown:F<n(v).length})),!0);else if(n(v).length>=n(w).length)f(w,n(v).map(B=>({page:B,shown:!0})),!0);else{if(n(v).length===0){f(w,[{page:n(w)[n(w).length-1].page,shown:!1}],!0);return}f(w,n(v).map(B=>({page:B,shown:!0})),!0)}})});const j=()=>{f(w,n(v).map(B=>({page:B,shown:!0})),!0)};var K=Jh(),O=D(K);{var z=B=>{Ih(B)};W(O,B=>{n(h)&&B(z)})}var ae=M(O,2);{var le=B=>{var F=ye(),pe=D(F);Bn(pe,19,()=>n(w),Se=>Se.page.split("?")[0],(Se,Z,H)=>{const te=P(()=>n(Z).page.split("?")[1]),ve=P(()=>n(Z).page.split("?")[0]),ue=P(()=>n(H)!==n(w).length-1&&!!n(w)[n(H)+1]?.shown),re=P(()=>n(H)===0);{let oe=P(()=>Ds[n(ve)]||""),_e=P(()=>n(l)||n(re)&&!n(d)),de=P(()=>({...n(ve)!==Te.NewNote&&n(ve)!==Te.Note?n(a):{}}));Hh(Se,zo({get shown(){return n(Z).shown},get title(){return n(oe)},get hidden(){return n(ue)},get blocked(){return n(_e)},onClose:y,onClosed:j},()=>n(de),{children:(se,Q)=>{js(se,()=>n(ve),()=>n(te),()=>n(ue))},$$slots:{default:!0}}))}}),g(B,F)},G=B=>{var F=ye(),pe=D(F);{var Se=Z=>{const H=P(()=>n(w)[n(w).length-1].page.split("?")[1]),te=P(()=>n(w)[n(w).length-1].page.split("?")[0]),ve=P(()=>n(w)[n(w).length-1].shown),ue=P(()=>n(w).length===1);{let re=P(()=>Ds[n(te)]||""),oe=P(()=>n(l)||!n(d)),_e=P(()=>n(l)||n(ue)?void 0:y);Xh(Z,{get shownDialog(){return n(ve)},get title(){return n(re)},get blockedDialog(){return n(oe)},hiddenDialog:!1,get onStartBack(){return n(_e)},onStartClose:T,onClosed:j,children:(de,se)=>{js(de,()=>n(te),()=>n(H))},$$slots:{default:!0}})}};W(pe,Z=>{n(w).length>0&&Z(Se)},!0)}g(B,F)};W(ae,B=>{p()?B(le):B(G,!1)})}g(t,K),ke()}function Qh(t,e){Ce(e,!1);let a=0;Pe(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),ss(),ke()}const $h=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;var ep=k('<div><button class="d p-bn1wva"><!> <span class="e p-bn1wva"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),tp=k('<!> <!> <!> <!> <main><div class="a p-bn1wva"><div class="b p-bn1wva"><!></div></div> <div class="c p-bn1wva"><!></div></main> <!>',1);function np(t,e){Ce(e,!0);const{replaceSearchParams:a,getHref:r,getSearchParams:o}=Bt(),{hasDialogPage:s}=zt(),{setScrollContainer:i}=vo(),{getAccount:l,init:d}=ls(),{isInitedNotes:c}=At(),{isInitedSettings:u}=Hn(),{isInited:v}=Ud(),{getDialogPages:h}=zt(),{createBroadcastChannel:p,tabId:w}=uo(),x=p(),{getSidebarState:m}=Ar(),{setClosableDialog:C}=Qt(),{getViewMode:N}=Hn(),_=()=>{$h()?a(`${tn}=${Te.AccountSetup}`):a(`${tn}=${Te.Install}`)};Pe(()=>{d(be=>{be===void 0?_():(s(Te.AccountSetup)&&a(""),be?f(O,be):f(O,null))});const $=async be=>{const Fe=JSON.parse(be.data);if(Fe.tabId&&Fe.tabId===w)return;const Ie=Fe;Ie.type==="initLocalAccount"||Ie.type==="initCloudAccount"||Ie.type==="updateAccount"||Ie.type==="disconnectCloudAccount"?a(""):Ie.type==="exit"&&_()};return x.addEventListener($),()=>x.removeEventListener($)});const y=Gn();Pe(async()=>{await new Promise($=>setTimeout($,60)),await Ai(),y.working=!0});let T=R(!1),j=0,K=P(()=>h().length>0),O=P(l),z=P(c),ae=P(u),le=P(v),G=R(null);const B=()=>{n(G)&&n(G).scrollTo({top:0})};Ve(()=>{C(n(O)!==void 0)}),Ve(()=>{i(n(G))});const F=()=>{if(n(G)){const $=n(G).scrollTop||0;$===0?f(T,!1):!n(T)&&j>$?f(T,!0):n(T)&&j+50<$&&f(T,!1),j=$}},pe=()=>{F()};Ve(()=>(n(G)?.addEventListener("scroll",pe),window.addEventListener("resize",pe),()=>{n(G)?.removeEventListener("scroll",pe),window.removeEventListener("resize",pe)}));const Se=P(m);let Z=P(()=>y.swipingRatio);const H=()=>{const $=new URLSearchParams(o());return r($)},te=async $=>{$.preventDefault()},ve=P(N),ue=P(()=>n(ve)==="popup"?{onOpenWindow:te,openWindowHref:H()}:{});var re=tp(),oe=D(re);Qh(oe,{});var _e=M(oe,2);ju(_e,{});var de=M(_e,2);go(de,{});var se=M(de,2);lf(se,{});var Q=M(se,2),ie=b(Q),fe=b(ie),Ee=b(fe);{var Ae=$=>{og($,zo(()=>n(ue)))};W(Ee,$=>{n(le)&&n(ae)&&n(O)!==void 0&&$(Ae)})}var he=M(ie,2),ce=b(he);{var xe=$=>{Zh($,zo(()=>n(ue)))};W(ce,$=>{n(z)&&n(ae)&&n(le)&&$(xe)})}et(Q,$=>f(G,$),()=>n(G));var we=M(Q,2);{var Le=$=>{var be=ep(),Fe=b(be);Fe.__click=B;var Ie=b(Fe);_t(Ie,{children:(qe,I)=>{var A=We("top");g(qe,A)}});var Ze=M(Ie,2),Je=b(Ze);ge(Je,()=>({"--rotate":"90deg","--size":"28px"})),me(Je.lastChild,{name:"back"}),Me(()=>{$a(be,`--swiping-ratio: ${n(Z)}; --transition-timing-default: ${y.duration}s;`),tt(be,1,at({i:!0,g:y.working&&!y.isSwiping,j:n(K)||n(Se)!=="closed"}),"p-bn1wva")}),g($,be)};W(we,$=>{n(T)&&$(Le)})}Me(()=>{$a(Q,`--swiping-ratio: ${n(Z)}; --transition-timing-default: ${y.duration}s;`),tt(Q,1,at({f:!0,g:y.working&&!y.isSwiping,h:n(Se)!=="closed"}),"p-bn1wva")}),g(t,re),ke()}pt(["click"]);function ap(t){vu(t,{children:(e,a)=>{np(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||Vc(ap,{target:document.getElementById("app")});export{Ye as $,P as A,Rt as B,Bt as C,ls as D,ss as E,Cr as F,Zt as G,dg as H,me as I,At as J,va as K,Ia as L,Hn as M,hl as N,nl as O,Te as P,As as Q,An as R,et as S,up as T,dp as U,_t as V,Cu as W,ku as X,tn as Y,yr as Z,Ot as _,f as a,ch as a0,uo as a1,ip as a2,lp as a3,$h as a4,sp as a5,ze as a6,$a as a7,cp as a8,R as b,b as c,ge as d,Bn as e,k as f,n as g,ut as h,g as i,W as j,tt as k,at as l,ke as m,D as n,Pe as o,Ce as p,vt as q,pt as r,M as s,Me as t,zt as u,Qt as v,ft as w,Ve as x,ye as y,We as z};
