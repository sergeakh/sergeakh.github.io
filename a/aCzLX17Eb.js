import{a0 as _e,a1 as pe,a2 as ge,p as ne,a3 as J,N as ve,y as ce,n as T,j as S,i as d,m as re,f as h,d as W,a4 as he,a5 as se,I as Q,g as s,A as X,a as r,b as C,c as i,s as x,Z as be,w as ee,x as me,R as le,J as oe,k as ie,l as de,a6 as ue,t as te,h as we,q as ae,r as fe,a7 as ye,a8 as xe,o as Ce,O as ke,B as Me,z as Ie}from"./aDxdVuYxT.js";const Ne=[];function We(t,e=!1,v=!1){return K(t,new Map,"",Ne,null,v)}function K(t,e,v,b,m=null,w=!1){if(typeof t=="object"&&t!==null){var z=e.get(t);if(z!==void 0)return z;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(_e(t)){var n=Array(t.length);e.set(t,n),m!==null&&e.set(m,n);for(var u=0;u<t.length;u+=1){var E=t[u];u in t&&(n[u]=K(E,e,v,b,null,w))}return n}if(pe(t)===ge){n={},e.set(t,n),m!==null&&e.set(m,n);for(var k in t)n[k]=K(t[k],e,v,b,null,w);return n}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!w)return K(t.toJSON(),e,v,b,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}var ze=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Edit',1),Ee=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),Te=h('<li class="p-1jbq6g9"><!></li> <li class="p-1jbq6g9"><!></li>',1),qe=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Ue(t,e){ne(e,!0);let v=J(e,"shownMenu",15),b=C(!1),m=C(!1),w=C(!1);const{checkMobileSize:z}=ve(),n=async()=>{e.onEdit()},u=()=>{s(m)?(r(m,!1),n()):s(w)&&(r(w,!1),e.onDelete()),v(!1),r(b,!1)};let E=X(z);var k=ce(),q=T(k);{var V=A=>{var B=qe(),L=T(B);W(L,()=>({"--top":"90%","--right":"0px"})),he(L.lastChild,{get startClose(){return s(b)},onClosed:u,children:(U,G)=>{var P=Te(),O=T(P),f=i(O);se(f,{onClick:()=>{r(m,!0),r(b,!0)},get dialogMode(){return s(E)},children:(M,F)=>{var c=ze(),_=T(c);W(_,()=>({"--size":"20px"})),Q(_.lastChild,{name:"pen"}),d(M,c)},$$slots:{default:!0}});var N=x(O,2),j=i(N);se(j,{onClick:()=>{r(w,!0),r(b,!0)},get dialogMode(){return s(E)},children:(M,F)=>{var c=Ee(),_=T(c);W(_,()=>({"--size":"20px"})),Q(_.lastChild,{name:"bin"}),d(M,c)},$$slots:{default:!0}}),d(U,P)},$$slots:{default:!0}}),d(A,B)};S(q,A=>{v()&&A(V)})}d(t,k),re()}var je=h('<div class="b p-ptbuqy"><!> <!> <div class="c p-ptbuqy"><button class="p-ptbuqy">Cancel</button> <button class="p-ptbuqy">Done</button></div></div>'),De=h('<div class="e p-ptbuqy"><!></div>'),Se=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Ae=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Le=h('<div class="d p-ptbuqy"><div><!> <a class="f p-ptbuqy" target="_blank" rel="noopener noreferrer"> </a> <div><!> <!></div> <!></div></div>'),Pe=h('<div class="g p-ptbuqy"><button class="h p-ptbuqy">Add link</button></div>'),Fe=h('<div class="a p-ptbuqy"><!></div>');function Re(t,e){ne(e,!0);let v=J(e,"shownUrlInput",15);const{getFaviconEnabled:b}=be();let m=X(b),w=C(null),z=C(null),n=C(ee(e.url)),u=C(ee(e.title)),E=C(null),k=C(null),q=C(!1);const V=f=>{r(n,f.target.value||"",!0)},A=f=>{r(u,f.target.value||"",!0)};me(()=>{v()&&s(w)?.focus()});const B=()=>{r(q,!0)},L=()=>{e.url&&(navigator.clipboard.writeText(e.url),ye("copied"))};var U=Fe(),G=i(U);{var P=f=>{var N=je(),j=i(N);oe(j,{get value(){return s(n)},onInput:V,placeholder:"url",get ref(){return s(w)},set ref(p){r(w,p,!0)}});var M=x(j,2);oe(M,{get value(){return s(u)},onInput:A,placeholder:"title"});var F=x(M,2),c=i(F);c.__click=()=>{r(n,e.url,!0),r(u,e.title,!0),v(!1)};var _=x(c,2);_.__click=()=>{let p=s(n).trim();p!==""&&/^[[a-zA-Z]+?:\/\//.test(p)===!1&&(p="https://"+p,r(n,p,!0)),e.onChangeUrl(p,s(u)),v(!1)},d(f,N)},O=f=>{var N=ce(),j=T(N);{var M=c=>{var _=Le(),p=i(_);ie(p,1,de({i:!0}),"p-ptbuqy");var H=i(p);{var Y=o=>{var y=De(),g=i(y);xe(g,{get url(){return e.url}}),d(o,y)};S(H,o=>{s(m)&&o(Y)})}var Z=x(H,2),$=i(Z),a=x(Z,2);ie(a,1,de({j:!0}),"p-ptbuqy");var l=i(a);ue(l,{title:"copy link",elem:"button",onclick:L,children:(o,y)=>{var g=Se(),R=T(g);W(R,()=>({"--size":"20px"})),Q(R.lastChild,{name:"copy"}),d(o,g)},$$slots:{default:!0}});var I=x(l,2);ue(I,{title:"show menu",elem:"button",onclick:B,get ref(){return s(k)},set ref(o){r(k,o,!0)},children:(o,y)=>{var g=Ae(),R=T(g);W(R,()=>({"--size":"18px","--rotate":"90deg"})),Q(R.lastChild,{name:"menu"}),d(o,g)},$$slots:{default:!0}});var D=x(a,2);Ue(D,{onDelete:()=>{r(u,""),r(n,""),e.onDeleteUrl()},onEdit:()=>{v(!0)},get shownMenu(){return s(q)},set shownMenu(o){r(q,o,!0)}}),le(p,o=>r(E,o),()=>s(E)),te(()=>{we(Z,"href",e.url),ae($,e.title||"unknown")}),d(c,_)},F=c=>{var _=Pe(),p=i(_);p.__click=()=>{v(!0)},d(c,_)};S(j,c=>{e.url?c(M):c(F,!1)})}d(f,N)};S(G,f=>{v()?f(P):f(O,!1)})}le(U,f=>r(z,f),()=>s(z)),d(t,U),re()}fe(["click"]);var Be=h('<div class="e p-1jda1zs">Note</div>'),Oe=h("<span> </span>"),Je=h('<div class="i p-1jda1zs"><!></div>'),Ve=h('<div class="k p-1jda1zs"><!></div>'),He=h('<!> <div class="a p-1jda1zs"><div class="b"><div class="c"><div class="d p-1jda1zs"><!> <div class="f p-1jda1zs" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"> </div></div></div></div> <div class="g h p-1jda1zs"><!> <div class="j p-1jda1zs"><!></div> <!></div></div>',1);function Ge(t,e){ne(e,!0);const{checkMobileSize:v}=ve();let b=J(e,"link",15,void 0),m=J(e,"text",15,""),w=J(e,"tags",31,()=>ee([])),z=J(e,"autoSaveMode",3,!0),n=C(!1),u=C(!1);const E=a=>{let l="",I=!0;function D(o){for(let y=0;y<o.length;y++){const g=o[y];if(g.nodeName==="BR"){l+=`
`,I=!0;continue}g.nodeName==="DIV"&&I===!1&&(l+=`
`),I=!1,g.nodeType===3&&g.textContent&&(l+=g.textContent),D(g.childNodes)}}D(a.currentTarget.childNodes),l===`
`&&(l=l.slice(0,-1)),m(l)},k=a=>{a.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(s(n)&&(r(n,!1),a.preventDefault(),a.stopPropagation()),s(u)&&(r(u,!1),a.preventDefault(),a.stopPropagation()))};Ce(()=>(v(),document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)));const q=(a,l)=>{b({url:a,title:l})},V=()=>{b(void 0)},A=a=>{w(a)},B=m();var L=He(),U=T(L);{let a=X(()=>b()?.url||""),l=X(()=>b()?.title||"");Re(U,{get url(){return s(a)},get title(){return s(l)},onChangeUrl:q,onDeleteUrl:V,get shownUrlInput(){return s(u)},set shownUrlInput(I){r(u,I,!0)}})}var G=x(U,2),P=i(G),O=i(P),f=i(O),N=i(f);{var j=a=>{var l=Be();d(a,l)};S(N,a=>{m()||a(j)})}var M=x(N,2);M.__input=E;var F=i(M),c=x(P,2),_=i(c);{var p=a=>{var l=Je(),I=i(l);{var D=o=>{var y=Oe(),g=i(y);te(R=>ae(g,`updated: ${R??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),d(o,y)};S(I,o=>{e.updatedAt&&o(D)})}d(a,l)};S(_,a=>{e.mode==="edit"&&a(p)})}var H=x(_,2),Y=i(H);ke(Y,{get selectedTags(){return w()},onChangeTags:A,get shownTagInput(){return s(n)},set shownTagInput(a){r(n,a,!0)}});var Z=x(H,2);{var $=a=>{var l=Ve(),I=i(l);Me(I,{fullWidth:!0,get onClick(){return e.onSubmit},children:(D,o)=>{var y=Ie("Add");d(D,y)},$$slots:{default:!0}}),d(a,l)};S(Z,a=>{!z()&&!s(n)&&a($)})}te(()=>ae(F,B)),d(t,L),re()}fe(["input"]);export{Ge as N,We as s};
