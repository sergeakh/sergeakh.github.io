const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/aw4kASr-B.js","a/aCeYg3FOS.css","a/aDplMqvZQ.js","a/a9q_jSmK4.js","a/abA9hIFUQ.js","a/aBrkJtqMH.css","a/aiIi5JvW7.js","a/aDB02xhFr.css","a/aCq9_alPV.js","a/a54d_SC5m.css","a/a9XZmAV6P.js","a/aCpa8lgv9.js","a/afGUkjeV7.css","a/aD3UDnbAb.js","a/aiSyTfFbW.css","a/aBh-tNMbI.js","a/aBFs996GX.js","a/aCpd7MTd8.css","a/aCt_rEA0O.js","a/aenMKNzfI.css","a/aC969LWc5.css","a/aCGHeoltM.js","a/aCeh8XjKC.css","a/aDDjC-2Zz.js","a/aCBPoPn5g.css","a/aBBuIJP2O.js","a/aK1a0NeEW.css","a/aCPmGDszg.js","a/aBem4Ctjp.css","a/aCZPy_Lak.js","a/aBdnakgrk.css","a/aNRzpmI33.js","a/aDzsMVVo5.css","a/aBJBLIUxz.js","a/aCH18nfIo.css","a/aBmhEtPzn.js","a/aLIGApDiW.js","a/aCb6DfA6m.css","a/aug266W1p.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var Tl=Object.defineProperty;var gs=t=>{throw TypeError(t)};var Pl=(t,e,a)=>e in t?Tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var jt=(t,e,a)=>Pl(t,typeof e!="symbol"?e+"":e,a),yo=(t,e,a)=>e.has(t)||gs("Cannot "+a);var K=(t,e,a)=>(yo(t,e,"read from private field"),a?a.call(t):e.get(t)),Ge=(t,e,a)=>e.has(t)?gs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),qe=(t,e,a,r)=>(yo(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),ct=(t,e,a)=>(yo(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const El=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};El(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const Nl=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};Nl();const xo=!1;var $o=Array.isArray,Al=Array.prototype.indexOf,no=Array.from,Dl=Object.defineProperty,ra=Object.getOwnPropertyDescriptor,Us=Object.getOwnPropertyDescriptors,Ws=Object.prototype,Ml=Array.prototype,ao=Object.getPrototypeOf,hs=Object.isExtensible;function sr(t){return typeof t=="function"}const Xe=()=>{};function Il(t){return typeof t?.then=="function"}function Ll(t){return t()}function To(t){for(var e=0;e<t.length;e++)t[e]()}function Vs(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function Rl(t,e,a=!1){return t===void 0?a?e():e:t}const Nt=2,es=4,ro=8,Fl=1<<24,Vn=16,qn=32,Aa=64,oo=128,fn=512,Lt=1024,Kt=2048,Sn=4096,Jt=8192,Ln=16384,ts=32768,ua=65536,ps=1<<17,qs=1<<18,nr=1<<19,Ks=1<<20,In=1<<25,Pa=32768,Po=1<<21,ns=1<<22,oa=1<<23,sa=Symbol("$state"),Gs=Symbol("legacy props"),Ol=Symbol(""),ja=new class extends Error{constructor(){super(...arguments);jt(this,"name","StaleReactionError");jt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ys(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function zl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Bl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function jl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Hl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Ul(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Wl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Vl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ql(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Kl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Gl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Yl=1,Xl=2,Xs=4,Jl=8,Zl=16,Ql=1,$l=2,ec=4,tc=8,nc=16,ac=1,rc=2,Pt=Symbol(),oc="http://www.w3.org/1999/xhtml";function sc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Js(t){return t===this.v}function ic(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Zs(t){return!ic(t,this.v)}let ar=!1,lc=!1;function cc(){ar=!0}const dc=[];function _n(t,e=!1,a=!1){return Br(t,new Map,"",dc,null,a)}function Br(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if($o(t)){var l=Array(t.length);e.set(t,l),o!==null&&e.set(o,l);for(var u=0;u<t.length;u+=1){var c=t[u];u in t&&(l[u]=Br(c,e,a,r,null,s))}return l}if(ao(t)===Ws){l={},e.set(t,l),o!==null&&e.set(o,l);for(var d in t)l[d]=Br(t[d],e,a,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return Br(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let it=null;function Ja(t){it=t}function gt(t){return Qs().get(t)}function ht(t,e){return Qs().set(t,e),e}function ye(t,e=!1,a){it={p:it,i:!1,c:null,e:null,s:t,x:null,l:ar&&!e?{s:null,u:null,$:[]}:null}}function be(t){var e=it,a=e.e;if(a!==null){e.e=null;for(var r of a)_i(r)}return t!==void 0&&(e.x=t),e.i=!0,it=e.p,t??{}}function rr(){return!ar||it!==null&&it.l===null}function Qs(t){return it===null&&Ys(),it.c??(it.c=new Map(uc(it)||void 0))}function uc(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let _a=[];function $s(){var t=_a;_a=[],To(t)}function Da(t){if(_a.length===0&&!Wa){var e=_a;queueMicrotask(()=>{e===_a&&$s()})}_a.push(t)}function fc(){for(;_a.length>0;)$s()}function ei(t){var e=Ze;if(e===null)return Ye.f|=oa,t;if((e.f&ts)===0){if((e.f&oo)===0)throw t;e.b.error(t)}else Za(t,e)}function Za(t,e){for(;e!==null;){if((e.f&oo)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Rr=new Set;let Qe=null,jr=null,cn=null,on=[],so=null,Eo=!1,Wa=!1;var qa,Ka,wa,ya,Sr,Ga,Ya,Et,No,lr,Ao,ti,ni;const Zr=class Zr{constructor(){Ge(this,Et);jt(this,"committed",!1);jt(this,"current",new Map);jt(this,"previous",new Map);Ge(this,qa,new Set);Ge(this,Ka,new Set);Ge(this,wa,0);Ge(this,ya,0);Ge(this,Sr,null);Ge(this,Ga,new Set);Ge(this,Ya,new Set);jt(this,"skipped_effects",new Set);jt(this,"is_fork",!1)}is_deferred(){return this.is_fork||K(this,ya)>0}process(e){on=[],jr=null,this.apply();var a={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)ct(this,Et,No).call(this,r,a);this.is_fork||ct(this,Et,ti).call(this),this.is_deferred()?(ct(this,Et,lr).call(this,a.effects),ct(this,Et,lr).call(this,a.render_effects)):(jr=this,Qe=null,ms(a.render_effects),ms(a.effects),jr=null,K(this,Sr)?.resolve()),cn=null}capture(e,a){this.previous.has(e)||this.previous.set(e,a),(e.f&oa)===0&&(this.current.set(e,e.v),cn?.set(e,e.v))}activate(){Qe=this,this.apply()}deactivate(){Qe===this&&(Qe=null,cn=null)}flush(){if(this.activate(),on.length>0){if(ri(),Qe!==null&&Qe!==this)return}else K(this,wa)===0&&this.process([]);this.deactivate()}discard(){for(const e of K(this,Ka))e(this);K(this,Ka).clear()}increment(e){qe(this,wa,K(this,wa)+1),e&&qe(this,ya,K(this,ya)+1)}decrement(e){qe(this,wa,K(this,wa)-1),e&&qe(this,ya,K(this,ya)-1),this.revive()}revive(){for(const e of K(this,Ga))K(this,Ya).delete(e),Ft(e,Kt),Ea(e);for(const e of K(this,Ya))Ft(e,Sn),Ea(e);this.flush()}oncommit(e){K(this,qa).add(e)}ondiscard(e){K(this,Ka).add(e)}settled(){return(K(this,Sr)??qe(this,Sr,Vs())).promise}static ensure(){if(Qe===null){const e=Qe=new Zr;Rr.add(Qe),Wa||Zr.enqueue(()=>{Qe===e&&e.flush()})}return Qe}static enqueue(e){Da(e)}apply(){}};qa=new WeakMap,Ka=new WeakMap,wa=new WeakMap,ya=new WeakMap,Sr=new WeakMap,Ga=new WeakMap,Ya=new WeakMap,Et=new WeakSet,No=function(e,a){e.f^=Lt;for(var r=e.first;r!==null;){var o=r.f,s=(o&(qn|Aa))!==0,i=s&&(o&Lt)!==0,l=i||(o&Jt)!==0||this.skipped_effects.has(r);if((r.f&oo)!==0&&r.b?.is_pending()&&(a={parent:a,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=Lt:(o&es)!==0?a.effects.push(r):Nr(r)&&((r.f&Vn)!==0&&K(this,Ga).add(r),_r(r));var u=r.first;if(u!==null){r=u;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===a.effect&&(ct(this,Et,lr).call(this,a.effects),ct(this,Et,lr).call(this,a.render_effects),a=a.parent),r=c.next,c=c.parent}},lr=function(e){for(const a of e)(a.f&Kt)!==0?K(this,Ga).add(a):(a.f&Sn)!==0&&K(this,Ya).add(a),ct(this,Et,Ao).call(this,a.deps),Ft(a,Lt)},Ao=function(e){if(e!==null)for(const a of e)(a.f&Nt)===0||(a.f&Pa)===0||(a.f^=Pa,ct(this,Et,Ao).call(this,a.deps))},ti=function(){if(K(this,ya)===0){for(const e of K(this,qa))e();K(this,qa).clear()}K(this,wa)===0&&ct(this,Et,ni).call(this)},ni=function(){var s;if(Rr.size>1){this.previous.clear();var e=cn,a=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Rr){if(i===this){a=!1;continue}const l=[];for(const[c,d]of this.current){if(i.current.has(c))if(a&&d!==i.current.get(c))i.current.set(c,d);else continue;l.push(c)}if(l.length===0)continue;const u=[...i.current.keys()].filter(c=>!this.current.has(c));if(u.length>0){var o=on;on=[];const c=new Set,d=new Map;for(const v of l)oi(v,u,c,d);if(on.length>0){Qe=i,i.apply();for(const v of on)ct(s=i,Et,No).call(s,v,r);i.deactivate()}on=o}}Qe=null,cn=e}this.committed=!0,Rr.delete(this)};let yn=Zr;function ai(t){var e=Wa;Wa=!0;try{for(var a;;){if(fc(),on.length===0&&(Qe?.flush(),on.length===0))return so=null,a;ri()}}finally{Wa=e}}function ri(){var t=Ta;Eo=!0;var e=null;try{var a=0;for(Kr(!0);on.length>0;){var r=yn.ensure();if(a++>1e3){var o,s;vc()}r.process(on),ia.clear()}}finally{Eo=!1,Kr(t),so=null}}function vc(){try{Ul()}catch(t){Za(t,so)}}let An=null;function ms(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Ln|Jt))===0&&Nr(r)&&(An=new Set,_r(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?bi(r):r.fn=null),An?.size>0)){ia.clear();for(const o of An){if((o.f&(Ln|Jt))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)An.has(i)&&(An.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const u=s[l];(u.f&(Ln|Jt))===0&&_r(u)}}An.clear()}}An=null}}function oi(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&Nt)!==0?oi(o,e,a,r):(s&(ns|Vn))!==0&&(s&Kt)===0&&si(o,e,r)&&(Ft(o,Kt),Ea(o))}}function si(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(e.includes(o))return!0;if((o.f&Nt)!==0&&si(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function Ea(t){for(var e=so=t;e.parent!==null;){e=e.parent;var a=e.f;if(Eo&&e===Ze&&(a&Vn)!==0&&(a&qs)===0)return;if((a&(Aa|qn))!==0){if((a&Lt)===0)return;e.f^=Lt}}on.push(e)}function gc(t){let e=0,a=kn(0),r;return()=>{pr()&&(n(a),lo(()=>(e===0&&(r=Ot(()=>t(()=>la(a)))),e+=1,()=>{Da(()=>{e-=1,e===0&&(r?.(),r=void 0,la(a))})})))}}var hc=ua|nr|oo;function pc(t,e,a){new mc(t,e,a)}var nn,an,Qo,gn,ba,hn,rn,Wt,pn,Mn,$n,Ca,ea,Sa,ta,Qr,xt,_c,wc,Do,Hr,Ur,Mo;class mc{constructor(e,a,r){Ge(this,xt);jt(this,"parent");Ge(this,nn,!1);Ge(this,an);Ge(this,Qo,null);Ge(this,gn);Ge(this,ba);Ge(this,hn);Ge(this,rn,null);Ge(this,Wt,null);Ge(this,pn,null);Ge(this,Mn,null);Ge(this,$n,null);Ge(this,Ca,0);Ge(this,ea,0);Ge(this,Sa,!1);Ge(this,ta,null);Ge(this,Qr,gc(()=>(qe(this,ta,kn(K(this,Ca))),()=>{qe(this,ta,null)})));qe(this,an,e),qe(this,gn,a),qe(this,ba,r),this.parent=Ze.b,qe(this,nn,!!K(this,gn).pending),qe(this,hn,or(()=>{Ze.b=this;{var o=ct(this,xt,Do).call(this);try{qe(this,rn,sn(()=>r(o)))}catch(s){this.error(s)}K(this,ea)>0?ct(this,xt,Ur).call(this):qe(this,nn,!1)}return()=>{K(this,$n)?.remove()}},hc))}is_pending(){return K(this,nn)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!K(this,gn).pending}update_pending_count(e){ct(this,xt,Mo).call(this,e),qe(this,Ca,K(this,Ca)+e),K(this,ta)&&Rn(K(this,ta),K(this,Ca))}get_effect_pending(){return K(this,Qr).call(this),n(K(this,ta))}error(e){var a=K(this,gn).onerror;let r=K(this,gn).failed;if(K(this,Sa)||!a&&!r)throw e;K(this,rn)&&(qt(K(this,rn)),qe(this,rn,null)),K(this,Wt)&&(qt(K(this,Wt)),qe(this,Wt,null)),K(this,pn)&&(qt(K(this,pn)),qe(this,pn,null));var o=!1,s=!1;const i=()=>{if(o){sc();return}o=!0,s&&Gl(),yn.ensure(),qe(this,Ca,0),K(this,pn)!==null&&xa(K(this,pn),()=>{qe(this,pn,null)}),qe(this,nn,this.has_pending_snippet()),qe(this,rn,ct(this,xt,Hr).call(this,()=>(qe(this,Sa,!1),sn(()=>K(this,ba).call(this,K(this,an)))))),K(this,ea)>0?ct(this,xt,Ur).call(this):qe(this,nn,!1)};var l=Ye;try{Vt(null),s=!0,a?.(e,i),s=!1}catch(u){Za(u,K(this,hn)&&K(this,hn).parent)}finally{Vt(l)}r&&Da(()=>{qe(this,pn,ct(this,xt,Hr).call(this,()=>{yn.ensure(),qe(this,Sa,!0);try{return sn(()=>{r(K(this,an),()=>e,()=>i)})}catch(u){return Za(u,K(this,hn).parent),null}finally{qe(this,Sa,!1)}}))})}}nn=new WeakMap,an=new WeakMap,Qo=new WeakMap,gn=new WeakMap,ba=new WeakMap,hn=new WeakMap,rn=new WeakMap,Wt=new WeakMap,pn=new WeakMap,Mn=new WeakMap,$n=new WeakMap,Ca=new WeakMap,ea=new WeakMap,Sa=new WeakMap,ta=new WeakMap,Qr=new WeakMap,xt=new WeakSet,_c=function(){try{qe(this,rn,sn(()=>K(this,ba).call(this,K(this,an))))}catch(e){this.error(e)}qe(this,nn,!1)},wc=function(){const e=K(this,gn).pending;e&&(qe(this,Wt,sn(()=>e(K(this,an)))),yn.enqueue(()=>{var a=ct(this,xt,Do).call(this);qe(this,rn,ct(this,xt,Hr).call(this,()=>(yn.ensure(),sn(()=>K(this,ba).call(this,a))))),K(this,ea)>0?ct(this,xt,Ur).call(this):(xa(K(this,Wt),()=>{qe(this,Wt,null)}),qe(this,nn,!1))}))},Do=function(){var e=K(this,an);return K(this,nn)&&(qe(this,$n,Fn()),K(this,an).before(K(this,$n)),e=K(this,$n)),e},Hr=function(e){var a=Ze,r=Ye,o=it;xn(K(this,hn)),Vt(K(this,hn)),Ja(K(this,hn).ctx);try{return e()}catch(s){return ei(s),null}finally{xn(a),Vt(r),Ja(o)}},Ur=function(){const e=K(this,gn).pending;K(this,rn)!==null&&(qe(this,Mn,document.createDocumentFragment()),K(this,Mn).append(K(this,$n)),ki(K(this,rn),K(this,Mn))),K(this,Wt)===null&&qe(this,Wt,sn(()=>e(K(this,an))))},Mo=function(e){var a;if(!this.has_pending_snippet()){this.parent&&ct(a=this.parent,xt,Mo).call(a,e);return}qe(this,ea,K(this,ea)+e),K(this,ea)===0&&(qe(this,nn,!1),K(this,Wt)&&xa(K(this,Wt),()=>{qe(this,Wt,null)}),K(this,Mn)&&(K(this,an).before(K(this,Mn)),qe(this,Mn,null)))};function yc(t,e,a,r){const o=rr()?Tr:Pr;if(a.length===0&&t.length===0){r(e.map(o));return}var s=Qe,i=Ze,l=ii();function u(){Promise.all(a.map(c=>bc(c))).then(c=>{l();try{r([...e.map(o),...c])}catch(d){(i.f&Ln)===0&&Za(d,i)}s?.deactivate(),hr()}).catch(c=>{Za(c,i)})}t.length>0?Promise.all(t).then(()=>{l();try{return u()}finally{s?.deactivate(),hr()}}):u()}function ii(){var t=Ze,e=Ye,a=it,r=Qe;return function(s=!0){xn(t),Vt(e),Ja(a),s&&r?.activate()}}function hr(){xn(null),Vt(null),Ja(null)}function Tr(t){var e=Nt|Kt,a=Ye!==null&&(Ye.f&Nt)!==0?Ye:null;return Ze!==null&&(Ze.f|=nr),{ctx:it,deps:null,effects:null,equals:Js,f:e,fn:t,reactions:null,rv:0,v:Pt,wv:0,parent:a??Ze,ac:null}}function bc(t,e){let a=Ze;a===null&&zl();var r=a.b,o=void 0,s=kn(Pt),i=!Ye,l=new Map;return Mc(()=>{var u=Vs();o=u.promise;try{Promise.resolve(t()).then(u.resolve,u.reject).then(()=>{c===Qe&&c.committed&&c.deactivate(),hr()})}catch(h){u.reject(h),hr()}var c=Qe;if(i){var d=!r.is_pending();r.update_pending_count(1),c.increment(d),l.get(c)?.reject(ja),l.delete(c),l.set(c,u)}const v=(h,p=void 0)=>{if(c.activate(),p)p!==ja&&(s.f|=oa,Rn(s,p));else{(s.f&oa)!==0&&(s.f^=oa),Rn(s,h);for(const[m,k]of l){if(l.delete(m),m===c)break;k.reject(ja)}}i&&(r.update_pending_count(-1),c.decrement(d))};u.promise.then(v,h=>v(null,h||"unknown"))}),mi(()=>{for(const u of l.values())u.reject(ja)}),new Promise(u=>{function c(d){function v(){d===o?u(s):c(o)}d.then(v,v)}c(o)})}function x(t){const e=Tr(t);return xi(e),e}function Pr(t){const e=Tr(t);return e.equals=Zs,e}function li(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)qt(e[a])}}function Cc(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&Ln)===0?e:null;e=e.parent}return null}function as(t){var e,a=Ze;xn(Cc(t));try{t.f&=~Pa,li(t),e=Ni(t)}finally{xn(a)}return e}function ci(t){var e=as(t);if(t.equals(e)||(Qe?.is_fork||(t.v=e),t.wv=Pi()),!Ma)if(cn!==null)(pr()||Qe?.is_fork)&&cn.set(t,e);else{var a=(t.f&fn)===0?Sn:Lt;Ft(t,a)}}let Io=new Set;const ia=new Map;let di=!1;function kn(t,e){var a={f:0,v:t,reactions:null,equals:Js,rv:0,wv:0};return a}function I(t,e){const a=kn(t);return xi(a),a}function Lo(t,e=!1,a=!0){var o;const r=kn(t);return e||(r.equals=Zs),ar&&a&&it!==null&&it.l!==null&&((o=it.l).s??(o.s=[])).push(r),r}function f(t,e,a=!1){Ye!==null&&(!bn||(Ye.f&ps)!==0)&&rr()&&(Ye.f&(Nt|Vn|ns|ps))!==0&&!On?.includes(t)&&Kl();let r=a?ft(e):e;return Rn(t,r)}function Rn(t,e){if(!t.equals(e)){var a=t.v;Ma?ia.set(t,e):ia.set(t,a),t.v=e;var r=yn.ensure();r.capture(t,a),(t.f&Nt)!==0&&((t.f&Kt)!==0&&as(t),Ft(t,(t.f&fn)!==0?Lt:Sn)),t.wv=Pi(),ui(t,Kt),rr()&&Ze!==null&&(Ze.f&Lt)!==0&&(Ze.f&(qn|Aa))===0&&(en===null?Rc([t]):en.push(t)),!r.is_fork&&Io.size>0&&!di&&Sc()}return e}function Sc(){di=!1;var t=Ta;Kr(!0);const e=Array.from(Io);try{for(const a of e)(a.f&Lt)!==0&&Ft(a,Sn),Nr(a)&&_r(a)}finally{Kr(t)}Io.clear()}function la(t){f(t,t.v+1)}function ui(t,e){var a=t.reactions;if(a!==null)for(var r=rr(),o=a.length,s=0;s<o;s++){var i=a[s],l=i.f;if(!(!r&&i===Ze)){var u=(l&Kt)===0;if(u&&Ft(i,e),(l&Nt)!==0){var c=i;cn?.delete(c),(l&Pa)===0&&(l&fn&&(i.f|=Pa),ui(c,Sn))}else u&&((l&Vn)!==0&&An!==null&&An.add(i),Ea(i))}}}function ft(t){if(typeof t!="object"||t===null||sa in t)return t;const e=ao(t);if(e!==Ws&&e!==Ml)return t;var a=new Map,r=$o(t),o=I(0),s=zn,i=l=>{if(zn===s)return l();var u=Ye,c=zn;Vt(null),bs(s);var d=l();return Vt(u),bs(c),d};return r&&a.set("length",I(t.length)),new Proxy(t,{defineProperty(l,u,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Vl();var d=a.get(u);return d===void 0?d=i(()=>{var v=I(c.value);return a.set(u,v),v}):f(d,c.value,!0),!0},deleteProperty(l,u){var c=a.get(u);if(c===void 0){if(u in l){const d=i(()=>I(Pt));a.set(u,d),la(o)}}else f(c,Pt),la(o);return!0},get(l,u,c){if(u===sa)return t;var d=a.get(u),v=u in l;if(d===void 0&&(!v||ra(l,u)?.writable)&&(d=i(()=>{var p=ft(v?l[u]:Pt),m=I(p);return m}),a.set(u,d)),d!==void 0){var h=n(d);return h===Pt?void 0:h}return Reflect.get(l,u,c)},getOwnPropertyDescriptor(l,u){var c=Reflect.getOwnPropertyDescriptor(l,u);if(c&&"value"in c){var d=a.get(u);d&&(c.value=n(d))}else if(c===void 0){var v=a.get(u),h=v?.v;if(v!==void 0&&h!==Pt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(l,u){if(u===sa)return!0;var c=a.get(u),d=c!==void 0&&c.v!==Pt||Reflect.has(l,u);if(c!==void 0||Ze!==null&&(!d||ra(l,u)?.writable)){c===void 0&&(c=i(()=>{var h=d?ft(l[u]):Pt,p=I(h);return p}),a.set(u,c));var v=n(c);if(v===Pt)return!1}return d},set(l,u,c,d){var v=a.get(u),h=u in l;if(r&&u==="length")for(var p=c;p<v.v;p+=1){var m=a.get(p+"");m!==void 0?f(m,Pt):p in l&&(m=i(()=>I(Pt)),a.set(p+"",m))}if(v===void 0)(!h||ra(l,u)?.writable)&&(v=i(()=>I(void 0)),f(v,ft(c)),a.set(u,v));else{h=v.v!==Pt;var k=i(()=>ft(c));f(v,k)}var _=Reflect.getOwnPropertyDescriptor(l,u);if(_?.set&&_.set.call(d,c),!h){if(r&&typeof u=="string"){var y=a.get("length"),E=Number(u);Number.isInteger(E)&&E>=y.v&&f(y,E+1)}la(o)}return!0},ownKeys(l){n(o);var u=Reflect.ownKeys(l).filter(v=>{var h=a.get(v);return h===void 0||h.v!==Pt});for(var[c,d]of a)d.v!==Pt&&!(c in l)&&u.push(c);return u},setPrototypeOf(){ql()}})}var _s,fi,vi,gi;function kc(){if(_s===void 0){_s=window,fi=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;vi=ra(e,"firstChild").get,gi=ra(e,"nextSibling").get,hs(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),hs(a)&&(a.__t=void 0)}}function Fn(t=""){return document.createTextNode(t)}function Qa(t){return vi.call(t)}function Er(t){return gi.call(t)}function C(t,e){return Qa(t)}function P(t,e=!1){{var a=Qa(t);return a instanceof Comment&&a.data===""?Er(a):a}}function A(t,e=1,a=!1){let r=t;for(;e--;)r=Er(r);return r}function xc(t){t.textContent=""}function hi(){return!1}let ws=!1;function Tc(){ws||(ws=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function io(t){var e=Ye,a=Ze;Vt(null),xn(null);try{return t()}finally{Vt(e),xn(a)}}function Pc(t,e,a,r=a){t.addEventListener(e,()=>io(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),Tc()}function pi(t){Ze===null&&(Ye===null&&Hl(),jl()),Ma&&Bl()}function Ec(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function Pn(t,e,a){var r=Ze;r!==null&&(r.f&Jt)!==0&&(t|=Jt);var o={ctx:it,deps:null,nodes:null,f:t|Kt|fn,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{_r(o),o.f|=ts}catch(l){throw qt(o),l}else e!==null&&Ea(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&nr)===0&&(s=s.first,(t&Vn)!==0&&(t&ua)!==0&&s!==null&&(s.f|=ua)),s!==null&&(s.parent=r,r!==null&&Ec(s,r),Ye!==null&&(Ye.f&Nt)!==0&&(t&Aa)===0)){var i=Ye;(i.effects??(i.effects=[])).push(s)}return o}function pr(){return Ye!==null&&!bn}function mi(t){const e=Pn(ro,null,!1);return Ft(e,Lt),e.teardown=t,e}function Ue(t){pi();var e=Ze.f,a=!Ye&&(e&qn)!==0&&(e&ts)===0;if(a){var r=it;(r.e??(r.e=[])).push(t)}else return _i(t)}function _i(t){return Pn(es|Ks,t,!1)}function Nc(t){return pi(),Pn(ro|Ks,t,!0)}function Ac(t){yn.ensure();const e=Pn(Aa|nr,t,!0);return(a={})=>new Promise(r=>{a.outro?xa(e,()=>{qt(e),r(void 0)}):(qt(e),r(void 0))})}function Dc(t){return Pn(es,t,!1)}function Mc(t){return Pn(ns|nr,t,!0)}function lo(t,e=0){return Pn(ro|e,t,!0)}function De(t,e=[],a=[],r=[]){yc(r,e,a,o=>{Pn(ro,()=>t(...o.map(n)),!0)})}function or(t,e=0){var a=Pn(Vn|e,t,!0);return a}function sn(t){return Pn(qn|nr,t,!0)}function wi(t){var e=t.teardown;if(e!==null){const a=Ma,r=Ye;ys(!0),Vt(null);try{e.call(null)}finally{ys(a),Vt(r)}}}function yi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&io(()=>{o.abort(ja)});var r=a.next;(a.f&Aa)!==0?a.parent=null:qt(a,e),a=r}}function Ic(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&qn)===0&&qt(e),e=a}}function qt(t,e=!0){var a=!1;(e||(t.f&qs)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Lc(t.nodes.start,t.nodes.end),a=!0),yi(t,e&&!a),Gr(t,0),Ft(t,Ln);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();wi(t);var o=t.parent;o!==null&&o.first!==null&&bi(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Lc(t,e){for(;t!==null;){var a=t===e?null:Er(t);t.remove(),t=a}}function bi(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function xa(t,e,a=!0){var r=[];Ci(t,r,!0);var o=()=>{a&&qt(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var l of r)l.out(i)}else o()}function Ci(t,e,a){if((t.f&Jt)===0){t.f^=Jt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||a)&&e.push(l);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&ua)!==0||(o.f&qn)!==0&&(t.f&Vn)!==0;Ci(o,e,i?a:!1),o=s}}}function rs(t){Si(t,!0)}function Si(t,e){if((t.f&Jt)!==0){t.f^=Jt,(t.f&Lt)===0&&(Ft(t,Kt),Ea(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&ua)!==0||(a.f&qn)!==0;Si(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function ki(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Er(a);e.append(a),a=o}}let Ta=!1;function Kr(t){Ta=t}let Ma=!1;function ys(t){Ma=t}let Ye=null,bn=!1;function Vt(t){Ye=t}let Ze=null;function xn(t){Ze=t}let On=null;function xi(t){Ye!==null&&(On===null?On=[t]:On.push(t))}let Ht=null,Gt=0,en=null;function Rc(t){en=t}let Ti=1,mr=0,zn=mr;function bs(t){zn=t}function Pi(){return++Ti}function Nr(t){var e=t.f;if((e&Kt)!==0)return!0;if(e&Nt&&(t.f&=~Pa),(e&Sn)!==0){var a=t.deps;if(a!==null)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(Nr(s)&&ci(s),s.wv>t.wv)return!0}(e&fn)!==0&&cn===null&&Ft(t,Lt)}return!1}function Ei(t,e,a=!0){var r=t.reactions;if(r!==null&&!On?.includes(t))for(var o=0;o<r.length;o++){var s=r[o];(s.f&Nt)!==0?Ei(s,e,!1):e===s&&(a?Ft(s,Kt):(s.f&Lt)!==0&&Ft(s,Sn),Ea(s))}}function Ni(t){var m;var e=Ht,a=Gt,r=en,o=Ye,s=On,i=it,l=bn,u=zn,c=t.f;Ht=null,Gt=0,en=null,Ye=(c&(qn|Aa))===0?t:null,On=null,Ja(t.ctx),bn=!1,zn=++mr,t.ac!==null&&(io(()=>{t.ac.abort(ja)}),t.ac=null);try{t.f|=Po;var d=t.fn,v=d(),h=t.deps;if(Ht!==null){var p;if(Gr(t,Gt),h!==null&&Gt>0)for(h.length=Gt+Ht.length,p=0;p<Ht.length;p++)h[Gt+p]=Ht[p];else t.deps=h=Ht;if(pr()&&(t.f&fn)!==0)for(p=Gt;p<h.length;p++)((m=h[p]).reactions??(m.reactions=[])).push(t)}else h!==null&&Gt<h.length&&(Gr(t,Gt),h.length=Gt);if(rr()&&en!==null&&!bn&&h!==null&&(t.f&(Nt|Sn|Kt))===0)for(p=0;p<en.length;p++)Ei(en[p],t);return o!==null&&o!==t&&(mr++,en!==null&&(r===null?r=en:r.push(...en))),(t.f&oa)!==0&&(t.f^=oa),v}catch(k){return ei(k)}finally{t.f^=Po,Ht=e,Gt=a,en=r,Ye=o,On=s,Ja(i),bn=l,zn=u}}function Fc(t,e){let a=e.reactions;if(a!==null){var r=Al.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}a===null&&(e.f&Nt)!==0&&(Ht===null||!Ht.includes(e))&&(Ft(e,Sn),(e.f&fn)!==0&&(e.f^=fn,e.f&=~Pa),li(e),Gr(e,0))}function Gr(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Fc(t,a[r])}function _r(t){var e=t.f;if((e&Ln)===0){Ft(t,Lt);var a=Ze,r=Ta;Ze=t,Ta=!0;try{(e&(Vn|Fl))!==0?Ic(t):yi(t),wi(t);var o=Ni(t);t.teardown=typeof o=="function"?o:null,t.wv=Ti;var s;xo&&lc&&(t.f&Kt)!==0&&t.deps}finally{Ta=r,Ze=a}}}async function Ai(){await Promise.resolve(),ai()}function n(t){var e=t.f,a=(e&Nt)!==0;if(Ye!==null&&!bn){var r=Ze!==null&&(Ze.f&Ln)!==0;if(!r&&!On?.includes(t)){var o=Ye.deps;if((Ye.f&Po)!==0)t.rv<mr&&(t.rv=mr,Ht===null&&o!==null&&o[Gt]===t?Gt++:Ht===null?Ht=[t]:Ht.includes(t)||Ht.push(t));else{(Ye.deps??(Ye.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[Ye]:s.includes(Ye)||s.push(Ye)}}}if(Ma){if(ia.has(t))return ia.get(t);if(a){var i=t,l=i.v;return((i.f&Lt)===0&&i.reactions!==null||Mi(i))&&(l=as(i)),ia.set(i,l),l}}else a&&(!cn?.has(t)||Qe?.is_fork&&!pr())&&(i=t,Nr(i)&&ci(i),Ta&&pr()&&(i.f&fn)===0&&Di(i));if(cn?.has(t))return cn.get(t);if((t.f&oa)!==0)throw t.v;return t.v}function Di(t){if(t.deps!==null){t.f^=fn;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&fn)===0&&Di(e)}}function Mi(t){if(t.v===Pt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ia.has(e)||(e.f&Nt)!==0&&Mi(e))return!0;return!1}function Ot(t){var e=bn;try{return bn=!0,t()}finally{bn=e}}const Oc=-7169;function Ft(t,e){t.f=t.f&Oc|e}function zc(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(sa in t)Ro(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&sa in a&&Ro(a)}}}function Ro(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Ro(t[r],e)}catch{}const a=ao(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Us(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const Bc=["touchstart","touchmove"];function jc(t){return Bc.includes(t)}const Ii=new Set,Fo=new Set;function Hc(t,e,a,r={}){function o(s){if(r.capture||cr.call(e,s),!s.cancelBubble)return io(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Da(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function Zt(t,e,a,r,o){var s={capture:r,passive:o},i=Hc(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&mi(()=>{e.removeEventListener(t,i,s)})}function pt(t){for(var e=0;e<t.length;e++)Ii.add(t[e]);for(var a of Fo)a(t)}let Cs=null;function cr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;Cs=t;var i=0,l=Cs===t&&t.__root;if(l){var u=o.indexOf(l);if(u!==-1&&(e===document||e===window)){t.__root=e;return}var c=o.indexOf(e);if(c===-1)return;u<=c&&(i=u)}if(s=o[i]||t.target,s!==e){Dl(t,"currentTarget",{configurable:!0,get(){return s||a}});var d=Ye,v=Ze;Vt(null),xn(null);try{for(var h,p=[];s!==null;){var m=s.assignedSlot||s.parentNode||s.host||null;try{var k=s["__"+r];k!=null&&(!s.disabled||t.target===s)&&k.call(s,t)}catch(_){h?p.push(_):h=_}if(t.cancelBubble||m===e||m===null)break;s=m}if(h){for(let _ of p)queueMicrotask(()=>{throw _});throw h}}finally{t.__root=e,delete t.currentTarget,Vt(d),xn(v)}}}function Li(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function wr(t,e){var a=Ze;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function S(t,e){var a=(e&ac)!==0,r=(e&rc)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=Li(s?t:"<!>"+t),a||(o=Qa(o)));var i=r||fi?document.importNode(o,!0):o.cloneNode(!0);if(a){var l=Qa(i),u=i.lastChild;wr(l,u)}else wr(i,i);return i}}function Uc(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=Li(o),l=Qa(i);s=Qa(l)}var u=s.cloneNode(!0);return wr(u,u),u}}function Wc(t,e){return Uc(t,e,"svg")}function Ke(t=""){{var e=Fn(t+"");return wr(e,e),e}}function we(){var t=document.createDocumentFragment(),e=document.createComment(""),a=Fn();return t.append(e,a),wr(e,a),t}function g(t,e){t!==null&&t.before(e)}function sp(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function vt(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Vc(t,e){return qc(t,e)}const za=new Map;function qc(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){kc();var l=new Set,u=v=>{for(var h=0;h<v.length;h++){var p=v[h];if(!l.has(p)){l.add(p);var m=jc(p);e.addEventListener(p,cr,{passive:m});var k=za.get(p);k===void 0?(document.addEventListener(p,cr,{passive:m}),za.set(p,1)):za.set(p,k+1)}}};u(no(Ii)),Fo.add(u);var c=void 0,d=Ac(()=>{var v=a??e.appendChild(Fn());return pc(v,{pending:()=>{}},h=>{if(s){ye({});var p=it;p.c=s}o&&(r.$$events=o),c=t(h,r)||{},s&&be()}),()=>{for(var h of l){e.removeEventListener(h,cr);var p=za.get(h);--p===0?(document.removeEventListener(h,cr),za.delete(h)):za.set(h,p)}Fo.delete(u),v!==a&&v.parentNode?.removeChild(v)}});return Kc.set(c,d),c}let Kc=new WeakMap;var dn,mn,Xt,ka,kr,xr,$r;class co{constructor(e,a=!0){jt(this,"anchor");Ge(this,dn,new Map);Ge(this,mn,new Map);Ge(this,Xt,new Map);Ge(this,ka,new Set);Ge(this,kr,!0);Ge(this,xr,()=>{var e=Qe;if(K(this,dn).has(e)){var a=K(this,dn).get(e),r=K(this,mn).get(a);if(r)rs(r),K(this,ka).delete(a);else{var o=K(this,Xt).get(a);o&&(K(this,mn).set(a,o.effect),K(this,Xt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of K(this,dn)){if(K(this,dn).delete(s),s===e)break;const l=K(this,Xt).get(i);l&&(qt(l.effect),K(this,Xt).delete(i))}for(const[s,i]of K(this,mn)){if(s===a||K(this,ka).has(s))continue;const l=()=>{if(Array.from(K(this,dn).values()).includes(s)){var c=document.createDocumentFragment();ki(i,c),c.append(Fn()),K(this,Xt).set(s,{effect:i,fragment:c})}else qt(i);K(this,ka).delete(s),K(this,mn).delete(s)};K(this,kr)||!r?(K(this,ka).add(s),xa(i,l,!1)):l()}}});Ge(this,$r,e=>{K(this,dn).delete(e);const a=Array.from(K(this,dn).values());for(const[r,o]of K(this,Xt))a.includes(r)||(qt(o.effect),K(this,Xt).delete(r))});this.anchor=e,qe(this,kr,a)}ensure(e,a){var r=Qe,o=hi();if(a&&!K(this,mn).has(e)&&!K(this,Xt).has(e))if(o){var s=document.createDocumentFragment(),i=Fn();s.append(i),K(this,Xt).set(e,{effect:sn(()=>a(i)),fragment:s})}else K(this,mn).set(e,sn(()=>a(this.anchor)));if(K(this,dn).set(r,e),o){for(const[l,u]of K(this,mn))l===e?r.skipped_effects.delete(u):r.skipped_effects.add(u);for(const[l,u]of K(this,Xt))l===e?r.skipped_effects.delete(u.effect):r.skipped_effects.add(u.effect);r.oncommit(K(this,xr)),r.ondiscard(K(this,$r))}else K(this,xr).call(this)}}dn=new WeakMap,mn=new WeakMap,Xt=new WeakMap,ka=new WeakMap,kr=new WeakMap,xr=new WeakMap,$r=new WeakMap;const Gc=0,bo=1;function Yc(t,e,a,r,o){var s=rr(),i=Pt,l=s?kn(i):Lo(i,!1,!1),u=s?kn(i):Lo(i,!1,!1),c=new co(t);or(()=>{var d=e(),v=!1;if(Il(d)){var h=ii(),p=!1;const m=k=>{if(!v){p=!0,h(!1),yn.ensure();try{k()}finally{hr(),Wa||ai()}}};d.then(k=>{m(()=>{Rn(l,k),c.ensure(bo,r&&(_=>r(_,l)))})},k=>{m(()=>{if(Rn(u,k),c.ensure(bo,o&&(_=>o(_,u))),!o)throw u.v})}),Da(()=>{p||m(()=>{c.ensure(Gc,a)})})}else Rn(l,d),c.ensure(bo,r&&(m=>r(m,l)));return()=>{v=!0}})}function H(t,e,a=!1){var r=new co(t),o=a?ua:0;function s(i,l){r.ensure(i,l)}or(()=>{var i=!1;e((l,u=!0)=>{i=!0,s(u,l)}),i||s(!1,null)},o)}function ve(t,e){lo(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Xc(t,e,a){for(var r=[],o=e.length,s,i=e.length,l=0;l<o;l++){let v=e[l];xa(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var h=t.outrogroups;Oo(no(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var u=r.length===0&&a!==null;if(u){var c=a,d=c.parentNode;xc(d),d.append(c),t.items.clear()}Oo(e,!u)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function Oo(t,e=!0){for(var a=0;a<t.length;a++)qt(t[a],e)}var Ss;function Bn(t,e,a,r,o,s=null){var i=t,l=new Map,u=(e&Xs)!==0;if(u){var c=t;i=c.appendChild(Fn())}var d=null,v=Pr(()=>{var y=a();return $o(y)?y:y==null?[]:no(y)}),h,p=!0;function m(){_.fallback=d,Jc(_,h,i,e,r),d!==null&&(h.length===0?(d.f&In)===0?rs(d):(d.f^=In,dr(d,null,i)):xa(d,()=>{d=null}))}var k=or(()=>{h=n(v);for(var y=h.length,E=new Set,w=Qe,b=hi(),T=0;T<y;T+=1){var X=h[T],U=r(X,T),q=p?null:l.get(U);q?(q.v&&Rn(q.v,X),q.i&&Rn(q.i,T),b&&w.skipped_effects.delete(q.e)):(q=Zc(l,p?i:Ss??(Ss=Fn()),X,U,T,o,e,a),p||(q.e.f|=In),l.set(U,q)),E.add(U)}if(y===0&&s&&!d&&(p?d=sn(()=>s(i)):(d=sn(()=>s(Ss??(Ss=Fn()))),d.f|=In)),!p)if(b){for(const[R,ee]of l)E.has(R)||w.skipped_effects.add(ee.e);w.oncommit(m),w.ondiscard(()=>{})}else m();n(v)}),_={effect:k,items:l,outrogroups:null,fallback:d};p=!1}function Jc(t,e,a,r,o){var s=(r&Jl)!==0,i=e.length,l=t.items,u=t.effect.first,c,d=null,v,h=[],p=[],m,k,_,y;if(s)for(y=0;y<i;y+=1)m=e[y],k=o(m,y),_=l.get(k).e,(_.f&In)===0&&(_.nodes?.a?.measure(),(v??(v=new Set)).add(_));for(y=0;y<i;y+=1){if(m=e[y],k=o(m,y),_=l.get(k).e,t.outrogroups!==null)for(const ee of t.outrogroups)ee.pending.delete(_),ee.done.delete(_);if((_.f&In)!==0)if(_.f^=In,_===u)dr(_,null,a);else{var E=d?d.next:u;_===t.effect.last&&(t.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),Yn(t,d,_),Yn(t,_,E),dr(_,E,a),d=_,h=[],p=[],u=d.next;continue}if((_.f&Jt)!==0&&(rs(_),s&&(_.nodes?.a?.unfix(),(v??(v=new Set)).delete(_))),_!==u){if(c!==void 0&&c.has(_)){if(h.length<p.length){var w=p[0],b;d=w.prev;var T=h[0],X=h[h.length-1];for(b=0;b<h.length;b+=1)dr(h[b],w,a);for(b=0;b<p.length;b+=1)c.delete(p[b]);Yn(t,T.prev,X.next),Yn(t,d,T),Yn(t,X,w),u=w,d=X,y-=1,h=[],p=[]}else c.delete(_),dr(_,u,a),Yn(t,_.prev,_.next),Yn(t,_,d===null?t.effect.first:d.next),Yn(t,d,_),d=_;continue}for(h=[],p=[];u!==null&&u!==_;)(c??(c=new Set)).add(u),p.push(u),u=u.next;if(u===null)continue}(_.f&In)===0&&h.push(_),d=_,u=_.next}if(t.outrogroups!==null){for(const ee of t.outrogroups)ee.pending.size===0&&(Oo(no(ee.done)),t.outrogroups?.delete(ee));t.outrogroups.size===0&&(t.outrogroups=null)}if(u!==null||c!==void 0){var U=[];if(c!==void 0)for(_ of c)(_.f&Jt)===0&&U.push(_);for(;u!==null;)(u.f&Jt)===0&&u!==t.fallback&&U.push(u),u=u.next;var q=U.length;if(q>0){var R=(r&Xs)!==0&&i===0?a:null;if(s){for(y=0;y<q;y+=1)U[y].nodes?.a?.measure();for(y=0;y<q;y+=1)U[y].nodes?.a?.fix()}Xc(t,U,R)}}s&&Da(()=>{if(v!==void 0)for(_ of v)_.nodes?.a?.apply()})}function Zc(t,e,a,r,o,s,i,l){var u=(i&Yl)!==0?(i&Zl)===0?Lo(a,!1,!1):kn(a):null,c=(i&Xl)!==0?kn(o):null;return{v:u,i:c,e:sn(()=>(s(e,u??a,c??o,l),()=>{t.delete(r)}))}}function dr(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&In)===0?e.nodes.start:a;r!==null;){var i=Er(r);if(s.before(r),r===o)return;r=i}}function Yn(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function He(t,e,...a){var r=new co(t);or(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},ua)}function Qc(t,e,a){var r=new co(t);or(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},ua)}function Ri(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=Ri(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function $c(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=Ri(t))&&(r&&(r+=" "),r+=e);return r}function nt(t){return typeof t=="object"?$c(t):t??""}const ks=[...` 	
\r\fÂ \v\uFEFF`];function ed(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||ks.includes(r[i-1]))&&(l===r.length||ks.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function td(t,e){return t==null?null:String(t)}function et(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var l=ed(a,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=a}else if(s&&o!==s)for(var u in s){var c=!!s[u];(o==null||c!==!!o[u])&&t.classList.toggle(u,c)}return s}function $a(t,e,a,r){var o=t.__style;if(o!==e){var s=td(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const nd=Symbol("is custom element"),ad=Symbol("is html");function ip(t,e){var a=os(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function lp(t,e){var a=os(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function dt(t,e,a,r){var o=os(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Ol]=a),a==null?t.removeAttribute(e):typeof a!="string"&&rd(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function os(t){return t.__attributes??(t.__attributes={[nd]:t.nodeName.includes("-"),[ad]:t.namespaceURI===oc})}var xs=new Map;function rd(t){var e=t.getAttribute("is")||t.nodeName,a=xs.get(e);if(a)return a;xs.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=Us(o);for(var i in r)r[i].set&&a.push(i);o=ao(o)}return a}function Fi(t,e,a=e){var r=new WeakSet;Pc(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=Co(t)?So(s):s,a(s),Qe!==null&&r.add(Qe),await Ai(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,u=t.value.length;if(t.value=s??"",l!==null){var c=t.value.length;i===l&&l===u&&c>u?(t.selectionStart=c,t.selectionEnd=c):(t.selectionStart=i,t.selectionEnd=Math.min(l,c))}}}),Ot(e)==null&&t.value&&(a(Co(t)?So(t.value):t.value),Qe!==null&&r.add(Qe)),lo(()=>{var o=e();if(t===document.activeElement){var s=jr??Qe;if(r.has(s))return}Co(t)&&o===So(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function Co(t){var e=t.type;return e==="number"||e==="range"}function So(t){return t===""?null:+t}function Ts(t,e){return t===e||t?.[sa]===e}function $e(t={},e,a,r){return Dc(()=>{var o,s;return lo(()=>{o=s,s=[],Ot(()=>{t!==a(...s)&&(e(t,...s),o&&Ts(a(...o),t)&&e(null,...o))})}),()=>{Da(()=>{s&&Ts(a(...s),t)&&e(null,...s)})}}),t}function ss(t=!1){const e=it,a=e.l.u;if(!a)return;let r=()=>zc(e.s);if(t){let o=0,s={};const i=Tr(()=>{let l=!1;const u=e.s;for(const c in u)u[c]!==s[c]&&(s[c]=u[c],l=!0);return l&&o++,o});r=()=>n(i)}a.b.length&&Nc(()=>{Ps(e,r),To(a.b)}),Ue(()=>{const o=Ot(()=>a.m.map(Ll));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&Ue(()=>{Ps(e,r),To(a.a)})}function Ps(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let Fr=!1;function od(t){var e=Fr;try{return Fr=!1,[t(),Fr]}finally{Fr=e}}const sd={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];sr(o)&&(o=o());const s=ra(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=ra(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===sa||e===Gs)return!1;for(let a of t.props)if(sr(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(sr(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function zo(...t){return new Proxy({props:t},sd)}function Fe(t,e,a,r){var o=!ar||(a&$l)!==0,s=(a&tc)!==0,i=(a&nc)!==0,l=r,u=!0,c=()=>(u&&(u=!1,l=i?Ot(r):r),l),d;if(s){var v=sa in t||Gs in t;d=ra(t,e)?.set??(v&&e in t?w=>t[e]=w:void 0)}var h,p=!1;s?[h,p]=od(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=c(),d&&(o&&Wl(),d(h)));var m;if(o?m=()=>{var w=t[e];return w===void 0?c():(u=!0,w)}:m=()=>{var w=t[e];return w!==void 0&&(l=void 0),w===void 0?l:w},o&&(a&ec)===0)return m;if(d){var k=t.$$legacy;return(function(w,b){return arguments.length>0?((!o||!b||k||p)&&d(b?m():w),w):m()})}var _=!1,y=((a&Ql)!==0?Tr:Pr)(()=>(_=!1,m()));s&&n(y);var E=Ze;return(function(w,b){if(arguments.length>0){const T=b?n(y):o&&s?ft(w):w;return f(y,T),_=!0,l!==void 0&&(l=T),w}return Ma&&_||(E.f&Ln)!==0?y.v:n(y)})}function Pe(t){it===null&&Ys(),ar&&it.l!==null?id(it).m.push(t):Ue(()=>{const e=Ot(t);if(typeof e=="function")return e})}function id(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const ld="5";var Hs;typeof window<"u"&&((Hs=window.__svelte??(window.__svelte={})).v??(Hs.v=new Set)).add(ld);cc();const Oi={};function cd(t){ht(Oi,t)}function Na(){const t=gt(Oi);if(!t)throw new Error("No FeedSearchContext found");return t}const zi={};function dd(t){ht(zi,t)}function Bt(){const t=gt(zi);if(!t)throw new Error("No SearchParamsContext found");return t}function ud(t,e){ye(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Bt(),s="feedSearch",i=x(()=>o().get(s)||""),l=x(()=>n(i));cd({getFeedSearch:()=>n(l),setFeedSearch:d=>{d===""?r(s):a(s,d)}});var u=we(),c=P(u);He(c,()=>e.children??Xe),g(t,u),be()}const Bi={};function fd(t){ht(Bi,t)}function vd(){const t=gt(Bi);if(!t)throw new Error("No TagsSearchContext found");return t}function gd(t,e){ye(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Bt(),s="tagsSearch",i=x(()=>o().get(s)||""),l=x(()=>n(i));fd({getTagsSearch:()=>n(l),setTagsSearch:d=>{d===""?r(s):a(s,d)}});var u=we(),c=P(u);He(c,()=>e.children??Xe),g(t,u),be()}const ji={};function hd(t){ht(ji,t)}function Hi(){const t=gt(ji);if(!t)throw new Error("No FeedOrderContext found");return t}function pd(t,e){ye(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=Bt(),s="feedOrder",i=x(()=>o().get(s)||"newest"),l=x(()=>n(i));let u=["newest","oldest","AtoZ","ZtoA","updatedNewest"];hd({getFeedOrder:()=>n(l),setFeedOrder:v=>{v==="newest"||!u.includes(v)?r(s):a(s,v)}});var c=we(),d=P(c);He(d,()=>e.children??Xe),g(t,c),be()}const Ui={};function md(t){ht(Ui,t)}function Ar(){const t=gt(Ui);if(!t)throw new Error("No SidebarContext found");return t}function _d(t,e){ye(e,!0);let a=I("closed");md({sidebarOpen:()=>{f(a,"preOpening")},sidebarClose:()=>{f(a,"closing")},getSidebarState:()=>n(a),setSidebarState:c=>{f(a,c,!0)}});var l=we(),u=P(l);He(u,()=>e.children??Xe),g(t,l),be()}const Wi={};function wd(t){ht(Wi,t)}function Kn(){const t=gt(Wi);if(!t)throw new Error("No SelectedTagsContext found");return t}function yd(t,e){ye(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Bt(),s=x(a),i="selectedTags";let l=x(()=>n(s).get(i)||""),u=x(()=>new Set(n(l).split(",").map(_=>decodeURIComponent(_)).filter(_=>_!=="")));wd({getSelectedTags:()=>n(u),addTag:_=>{n(u).has(_)||r(i,[...n(u),_].map(y=>encodeURIComponent(y)).join(","))},removeTag:_=>{n(u).has(_)&&n(u).size===1?o(i):n(u).has(_)&&r(i,[...n(u)].filter(y=>y!==_).map(y=>encodeURIComponent(y)).join(","))},clearTags:()=>{o(i)},setSelectedTags:_=>{_.size===0?o(i):r(i,[..._].map(y=>encodeURIComponent(y)).join(","))}});var m=we(),k=P(m);He(k,()=>e.children??Xe),g(t,m),be()}const Vi={};function bd(t){ht(Vi,t)}function fa(){const t=gt(Vi);if(!t)throw new Error("No SelectedNotesContext found");return t}var Cd=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Sd=["difference","intersection","symmetricDifference","union"],Es=!1,Xa,un,na,eo,er,qi,Ki;const to=class to extends Set{constructor(a){super();Ge(this,er);Ge(this,Xa,new Map);Ge(this,un,I(0));Ge(this,na,I(0));Ge(this,eo,zn||-1);if(a){for(var r of a)super.add(r);K(this,na).v=super.size}Es||ct(this,er,Ki).call(this)}has(a){var r=super.has(a),o=K(this,Xa),s=o.get(a);if(s===void 0){if(!r)return n(K(this,un)),!1;s=ct(this,er,qi).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),f(K(this,na),super.size),la(K(this,un))),this}delete(a){var r=super.delete(a),o=K(this,Xa),s=o.get(a);return s!==void 0&&(o.delete(a),f(s,!1)),r&&(f(K(this,na),super.size),la(K(this,un))),r}clear(){if(super.size!==0){super.clear();var a=K(this,Xa);for(var r of a.values())f(r,!1);a.clear(),f(K(this,na),0),la(K(this,un))}}keys(){return this.values()}values(){return n(K(this,un)),super.values()}entries(){return n(K(this,un)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(K(this,na))}};Xa=new WeakMap,un=new WeakMap,na=new WeakMap,eo=new WeakMap,er=new WeakSet,qi=function(a){return zn===K(this,eo)?I(a):kn(a)},Ki=function(){Es=!0;var a=to.prototype,r=Set.prototype;for(const o of Cd)a[o]=function(...s){return n(K(this,un)),r[o].apply(this,s)};for(const o of Sd)a[o]=function(...s){n(K(this,un));var i=r[o].apply(this,s);return new to(i)}};let Bo=to;function kd(t,e){ye(e,!0);let a=new Bo,r=I("single");const o=()=>a,s=p=>{a.clear(),p.forEach(m=>a.add(m))},i=p=>{a.add(p)},l=p=>{a.delete(p)},u=()=>{a.clear()};bd({getSelectedNotes:o,setSelectedNotes:s,addNote:i,removeNote:l,clearNotes:u,getMode:()=>n(r),changeMode:p=>{f(r,p,!0),p==="single"&&u()}});var v=we(),h=P(v);He(h,()=>e.children??Xe),g(t,v),be()}const Gi={};function xd(t){ht(Gi,t)}function is(){const t=gt(Gi);if(!t)throw new Error("No LocalDBContext found");return t}const Yi={};function Td(t){ht(Yi,t)}function Hn(){const t=gt(Yi);if(!t)throw new Error("No SettingsContext found");return t}const Xi={};function Pd(t){ht(Xi,t)}function uo(){const t=gt(Xi);if(!t)throw new Error("No BroadcastContext found");return t}const Ed="AppStorage",Nd=1,ur="account",Jn="settings",rt="notes",Ut="tags",Ad="syncLog",va="success",Un="error",kt=(t,e,a)=>{t?.addEventListener(e,a)},Ns=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();kt(s,va,()=>{const i=s?.result||[];a(i)}),kt(s,Un,i=>{r(i)})}),Yr=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);kt(i,va,()=>{const l=i?.result?.data;r(l)}),kt(i,Un,l=>{o(l)})}),wn=(t,e,a,r)=>new Promise((o,s)=>{const u=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});kt(u,va,()=>{o()}),kt(u,Un,c=>{s(c)})}),yt=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((l,u)=>{kt(i,va,()=>{l()}),kt(i,Un,c=>{u(c)})})}))},ko=(t,e,a)=>new Promise((r,o)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);kt(l,va,()=>{r()}),kt(l,Un,u=>{o(u)})}),ir=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((l,u)=>{kt(i,va,()=>{l()}),kt(i,Un,c=>{u(c)})})}))},Ha=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();kt(i,va,()=>{a()}),kt(i,Un,l=>{r(l)})});function Dd(t,e){ye(e,!0);const{deleteSearchParam:a}=Bt(),r="viewMode";let s=ft((()=>{const F=new URLSearchParams(window.location.search).get(r)||"tab";return F==="popup"||F==="window"||F==="tab"||F==="sidebar"?F:"tab"})());Pe(()=>{a(r)});let i=I(!1),l=I(ft({showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:u}=is(),{createBroadcastChannel:c,tabId:d}=uo(),v=c(),h=x(u),p=async()=>{const Y=await Yr(n(h),Jn,"default");Y&&f(l,Y,!0)},m=async()=>{await p(),f(i,!0)},k=async Y=>{const F=JSON.parse(Y.data),z=F;if(F.tabId&&F.tabId===d){z.type==="exit"&&(f(l,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),Ha(n(h),Jn));return}z.type==="updateSettings"?p():z.type==="exit"&&f(l,{showFavicon:!0,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},_=()=>n(l).showFavicon,y=()=>n(l).recordMode,E=async Y=>{n(l).showFavicon=Y,await wn(n(h),Jn,"default",_n(n(l))),v.postMessage({type:"updateSettings"})},w=async Y=>{n(l).recordMode=Y,await wn(n(h),Jn,"default",_n(n(l))),v.postMessage({type:"updateSettings"})},b=async Y=>{n(l).tags.prev=Y,await wn(n(h),Jn,"default",_n(n(l))),v.postMessage({type:"updateSettings"})},T=()=>n(l).tags.prev||[],X=async Y=>{n(l).tags.llm=Y,await wn(n(h),Jn,"default",_n(n(l))),v.postMessage({type:"updateSettings"})},U=()=>n(l).tags.llm,q=()=>n(l).tags.pageData,R=async Y=>{n(l).tags.pageData=Y,await wn(n(h),Jn,"default",_n(n(l))),v.postMessage({type:"updateSettings"})};Pe(()=>(m(),v.addEventListener(k),()=>{v.removeEventListener(k)})),Td({getFaviconEnabled:_,getRecordMode:y,setRecordMode:w,setFaviconShown:E,isInitedSettings:()=>n(i),getViewMode:()=>s,setLlmTagsEnabled:X,getLlmTagsEnabled:U,setPrevTags:b,getPrevTags:T,getPageDataForTagsEnabled:q,setPageDataForTagsEnabled:R});var ee=we(),re=P(ee);He(re,()=>e.children??Xe),g(t,ee),be()}const Ji={};function Md(t){ht(Ji,t)}function ls(){const t=gt(Ji);if(!t)throw new Error("No AccountContext found");return t}function Id(t,e){ye(e,!0);let a=I(void 0);const{getDB:r}=is(),{createBroadcastChannel:o,tabId:s}=uo(),i=x(r),l=o(),u=async()=>{const w=await Yr(n(i),ur,"default");f(a,w,!0)},c=w=>wn(n(i),ur,"default",w),d=async w=>{const b=await Yr(n(i),ur,"default");b!==void 0&&f(a,b,!0),w(b)},v=async w=>{const b=JSON.parse(w.data);if(b.tabId&&b.tabId===s)return;const T=b;T.type==="initLocalAccount"?f(a,null):T.type==="initCloudAccount"?u():T.type==="disconnectCloudAccount"?f(a,null):T.type==="exit"?f(a,void 0):T.type==="updateAccount"&&u()};Pe(()=>(l.addEventListener(v),()=>{l.removeEventListener(v)})),Md({init:d,getAccount:()=>n(a),initLocalAccount:async()=>{f(a,null),await c(null),l.postMessage({type:"initLocalAccount"})},initCloudAccount:async w=>{const b={encryptedClientKey:w.encryptedClientKey||"",subscriptionExpires:w.subscriptionExpires||-1,lastSync:-1};await c(b),f(a,b,!0),l.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{f(a,null),await c(null),l.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async w=>{if(!n(a))throw new Error("No account to update subscription for");const b={...n(a),subscriptionExpires:w};await c(b),l.postMessage({type:"updateAccount"})},exitApp:async()=>{f(a,void 0),l.postMessage({type:"exit"}),await Ha(n(i),ur)}});var y=we(),E=P(y);He(E,()=>e.children??Xe),g(t,y),be()}const Zi={};function Ld(t){ht(Zi,t)}function At(){const t=gt(Zi);if(!t)throw new Error("No NotesContext found");return t}const Zn=()=>crypto.randomUUID(),Rd=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},Qi=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}};async function cp(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{console.error("")}}const ut=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t));function Fd(t,e){ye(e,!0);const{getDB:a}=is(),{createBroadcastChannel:r,tabId:o}=uo(),s=x(a),i=r(),l=720*60*60*1e3;let u=I(!1),c=I(()=>new Map),d=I(()=>[]),v=I(()=>new Map),h=I(ft(new Map)),p=null,m=new Promise(N=>{p=N});const k=()=>n(u),_=()=>n(d)().some(N=>N.data&&!N.data.deletedAt&&!N.data.archivedAt),y=()=>n(d)().some(N=>N.data&&N.data.deletedAt),E=()=>n(d)().some(N=>N.data&&N.data.archivedAt&&!N.data.deletedAt),w=(N,W)=>{n(h).has(N)||n(h).set(N,new Set),n(h).get(N)?.add(W)},b=(N,W)=>{n(h).has(N)&&(n(h).get(N)?.delete(W),n(h).get(N)?.size===0&&n(h).delete(N))},T=N=>{if(!N)return!1;const W=n(v)().get(N);if(!W||!W.data?.link?.url)return!1;const V=n(h).get(W.data.link.url),M=[];return V?.forEach(D=>{if(D===N)return;const L=n(v)().get(D);(W.data?.archivedAt||0)==(L?.data?.archivedAt||0)&&(W.data?.deletedAt||0)==(L?.data?.deletedAt||0)&&M.push(D)}),M.length>0},X=N=>{const W=n(d)(),V=n(v)(),M=V.get(N.id);if(M){const D=M.data?.link?.url;M.data=N.data,D!==N.data?.link?.url&&(D&&b(D,N.id),N.data?.link?.url&&w(N.data.link.url,N.id))}else W.push(N),V.set(N.id,N),N.data?.link?.url&&w(N.data.link.url,N.id);f(d,()=>W),f(v,()=>V)},U=N=>{const W=n(d)(),V=n(v)(),M=V.get(N);V.has(N)&&V.delete(N),M&&M.data?.link?.url&&b(M.data.link.url,N),M&&(M.data=void 0),f(d,()=>W),f(v,()=>V)},q=N=>{const W=n(d)(),V=n(v)();for(const M of N){const D=V.get(M);V.has(M)&&V.delete(M),D&&D.data?.link?.url&&b(D.data.link.url,M),D&&(D.data=void 0)}f(d,()=>W),f(v,()=>V)},R=()=>{f(d,()=>[]),f(h,new Map,!0),f(c,()=>new Map),f(v,()=>new Map)},ee=()=>n(d),re=N=>{const W=n(c)();for(const V of N)W.get(V)||W.set(V,{name:V});f(c,()=>W)},Y=async()=>{const[N,W]=await Promise.all([Ns(n(s),rt),Ns(n(s),Ut).then(B=>B.reduce((Z,oe)=>Z.set(oe.id,oe.data),new Map))]),V=[],M=[],D=new Map;for(const B of N)B.data.deletedAt&&Date.now()-B.data.deletedAt>l?V.push(B.id):(M.push(B),D.set(B.id,B),B.data.link?.url&&w(B.data.link?.url,B.id));const L=Rd(M),le=[],J=new Map(W);[...L.values()].forEach(B=>{J.set(B,{name:B,pinned:W.get(B)?.pinned||!1}),W.has(B)||le.push(B)});const fe=[];[...W.keys()].forEach(B=>{L.has(B)||fe.push(B)}),await ir(n(s),rt,V),await ir(n(s),Ut,fe),await yt(n(s),Ut,le.map(B=>({id:B,data:{pinned:J.get(B)?.pinned||!1}}))),f(d,()=>M),f(v,()=>D),f(c,()=>J),f(u,!0),setTimeout(()=>{p?.()},0)},F=async N=>{const W=n(c)(),V=N.data.tags.filter(M=>!W.has(M))||[];return await wn(n(s),rt,N.id,{...N.data}),V.length>0&&(await yt(n(s),Ut,V.map(M=>({id:M,data:{pinned:!1}}))||[]),re(V)),X(N),i.postMessage({type:"putNote",data:{id:N.id}}),N.id},z=async({link:N,text:W,tags:V})=>{const M={id:Zn(),data:{link:ut(N),text:W,tags:ut(V),history:[],createdAt:Date.now(),updatedAt:Date.now()}};return await F(M),M.id},me=async(N,{link:W,text:V,tags:M})=>{const D=ne(N);if(!D||!D.data)return;const L={id:N,data:{...D.data,link:ut(W),text:V,tags:ut(M),updatedAt:Date.now()}};await F(L)},Se=async(N,{link:W,text:V,tags:M})=>{const D=ne(N);if(!D||!D.data)return;const L=Zn(),le={id:N,data:{...D.data,link:W,text:V,tags:M,updatedAt:Date.now(),history:[...(D.data.history||[]).slice(-49),{id:L,link:ut(D.data.link),text:D.data.text,tags:ut(D.data.tags),updatedAt:D.data.updatedAt}]}};return await F(le),L},j=async(N,W)=>{const V=ne(N);if(!V||!V.data)return;const M=V.data.history?.find?.(L=>L.id===W);if(!M)return;const D={id:N,data:{...V.data,link:ut(M.link),text:M.text,tags:ut(M.tags),updatedAt:M.updatedAt,history:V.data.history?.filter?.(L=>L.id!==W)||[]}};await F(D)},O=async N=>{const V=n(v)().get(N);!V||!V.data||(U(N),await ko(n(s),rt,N),i.postMessage({type:"deleteNote",data:{id:N}}))},Q=async()=>{await Ha(n(s),rt),await Ha(n(s),Ut),R(),i.postMessage({type:"clearNotes"})},ne=N=>n(v)().get(N),ie=async(N,W)=>{const M=n(v)().get(N);if(!M||!M.data)return;const D={id:N,data:{...M.data,pinned:W}};F(D)},se=async N=>{const V=n(v)().get(N);if(!V||!V.data)return;const M={id:N,data:{...V.data,deletedAt:Date.now()}};await F(M)},Ee=async N=>{const V=n(v)().get(N);if(!V||!V.data)return;const M={id:N,data:{...V.data,archivedAt:Date.now()}};await F(M)},Le=async({noteIds:N})=>{const W=n(v)(),V=n(d)();for(const D of N){const L=W.get(D);L?.data&&(L.data.deletedAt=Date.now())}return await yt(n(s),rt,N.map(D=>{const L=W.get(D);return{id:D,data:L?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V),{cancel:async()=>{for(const D of N){const L=W.get(D);L?.data&&(L.data.deletedAt=0)}await yt(n(s),rt,N.map(D=>{const L=W.get(D);return{id:D,data:L?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V)}}},ge=async({noteIds:N})=>{const W=n(v)(),V=n(d)();for(const D of N){const L=W.get(D);L?.data&&(L.data.archivedAt=Date.now())}return await yt(n(s),rt,N.map(D=>{const L=W.get(D);return{id:D,data:L?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V),{cancel:async()=>{for(const D of N){const L=W.get(D);L?.data&&(L.data.archivedAt=0)}await yt(n(s),rt,N.map(D=>{const L=W.get(D);return{id:D,data:L?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V)}}},ue=async({noteIds:N})=>{const W=n(v)(),V=n(d)(),M=[];for(const L of N){const le=W.get(L);le?.data&&(M.push({id:L,data:ut(le.data)}),le.data.archivedAt=0)}return await yt(n(s),rt,N.map(L=>{const le=W.get(L);return{id:L,data:le?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V),{cancel:async()=>{for(const L of M){const le=W.get(L.id);le?.data&&(le.data=L.data)}await yt(n(s),rt,N.map(L=>{const le=W.get(L);return{id:L,data:le?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V)}}},Ae=async({noteIds:N})=>{const W=n(v)(),V=n(d)(),M=[];for(const L of N){const le=W.get(L);le?.data&&(M.push({id:L,data:ut(le.data)}),le.data.deletedAt=0)}return await yt(n(s),rt,N.map(L=>{const le=W.get(L);return{id:L,data:le?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V),{cancel:async()=>{for(const L of M){const le=W.get(L.id);le?.data&&(le.data=L.data)}await yt(n(s),rt,N.map(L=>{const le=W.get(L);return{id:L,data:le?.data}})),i.postMessage({type:"reloadNotes"}),f(v,()=>W),f(d,()=>V)}}},G=async N=>{const V=n(v)().get(N);if(!V||!V.data)return;const M={id:N,data:{...V.data,deletedAt:0}};await F(M)},te=async N=>{const V=n(v)().get(N);if(!V||!V.data)return;const M={id:N,data:{...V.data,archivedAt:0}};await F(M)},Ce=async(N,W)=>{const V=n(c)();V.set(N,{name:N,pinned:W}),await wn(n(s),Ut,N,{pinned:W}),i.postMessage({type:"pinTag",data:{tag:N,pinned:W}}),f(c,()=>V)},xe=async({noteIds:N})=>{const W=n(c)(),V=n(d)();q(N),await ir(n(s),rt,N),i.postMessage({type:"reloadNotes"}),f(d,()=>V),f(c,()=>W)},ce=async N=>{const W=n(v)(),V={};N.forEach(M=>{const D=W.get(M.id),L=[];if(D&&D.data){let le=0,J=0;for(;le<M.data.history.length&&J<D.data.history.length;){const fe=M.data.history[le],B=D.data.history[J];fe.id===B.id?(fe.updatedAt>B.updatedAt?L.push(fe):L.push(B),le+=1,J+=1):fe.updatedAt<B.updatedAt?(L.push(fe),le+=1):fe.updatedAt>B.updatedAt?(L.push(B),J+=1):(L.push(B),le+=1,J+=1)}D.data.updatedAt>M.data.updatedAt?V[D.id]={id:D.id,data:{...D.data,history:L}}:V[M.id]={id:M.id,data:{...M.data,history:L}}}else V[M.id]=M}),await yt(n(s),rt,Object.values(V)),await Y(),i.postMessage({type:"reloadNotes"})},ae=async()=>{const N=[];n(d)().forEach(V=>{V&&V.data&&V.data.deletedAt&&N.push(V.id)}),await ir(n(s),rt,N),await Y(),i.postMessage({type:"emptyBin"})},ke=async(N,W)=>{const V=n(v)(),M=n(d)(),D=[],L=[];for(const J of W){const fe=V.get(J);fe?.data&&(D.push({id:J,data:ut(fe.data)}),L.push({id:J,data:{...fe.data,tags:fe.data.tags.filter(B=>B!==N),history:[...fe.data.history||[],{id:Zn(),link:ut(fe.data.link),text:fe.data.text,tags:fe.data.tags,updatedAt:Date.now()}]}}))}for(const J of L){const fe=V.get(J.id);fe?.data&&(fe.data=J.data)}return await yt(n(s),rt,L.map(J=>({id:J.id,data:J.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>M),{cancel:async()=>{for(const J of D){const fe=V.get(J.id);fe?.data&&(fe.data=J.data)}await yt(n(s),rt,D.map(J=>({id:J.id,data:J.data}))),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>M)}}},pe=async(N,W,V)=>{const M=n(v)(),D=n(d)(),L=n(c)(),le=[],J=[];for(const Z of V){const oe=M.get(Z);oe?.data&&(le.push({id:Z,data:ut(oe.data)}),J.push({id:Z,data:{...oe.data,tags:oe.data.tags.map(de=>de!==N?de:W),history:[...oe.data.history||[],{id:Zn(),link:ut(oe.data.link),text:oe.data.text,tags:oe.data.tags,updatedAt:Date.now()}]}}))}for(const Z of J){const oe=M.get(Z.id);oe?.data&&(oe.data=Z.data)}const fe=L.has(W);return await Promise.all([(async()=>{if(!fe){const Z=L.get(N)?.pinned||!1;L.set(W,{name:W,pinned:Z}),await wn(n(s),Ut,W,{pinned:Z})}})(),yt(n(s),rt,J.map(Z=>({id:Z.id,data:Z.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>M),f(d,()=>D),f(c,()=>L),{cancel:async()=>{for(const Z of le){const oe=M.get(Z.id);oe?.data&&(oe.data=Z.data)}await Promise.all([(async()=>{fe||(L.delete(W),await ko(n(s),Ut,W))})(),yt(n(s),rt,le.map(Z=>({id:Z.id,data:Z.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>M),f(d,()=>D),f(c,()=>L)}}},Re=async(N,W)=>{const V=n(v)(),M=n(d)(),D=n(c)(),L=[],le=[];for(const B of W){const Z=V.get(B);Z?.data&&(L.push({id:B,data:ut(Z.data)}),le.push({id:B,data:{...Z.data,tags:[...new Set([...Z.data.tags,N])],history:[...Z.data.history||[],{id:Zn(),link:ut(Z.data.link),text:Z.data.text,tags:Z.data.tags,updatedAt:Date.now()}]}}))}for(const B of le){const Z=V.get(B.id);Z?.data&&(Z.data=B.data)}const J=D.has(N);return await Promise.all([(async()=>{J||(D.set(N,{name:N,pinned:!1}),await wn(n(s),Ut,N,{pinned:!1}))})(),yt(n(s),rt,le.map(B=>({id:B.id,data:B.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>M),f(c,()=>D),{cancel:async()=>{for(const B of L){const Z=V.get(B.id);Z?.data&&(Z.data=B.data)}await Promise.all([(async()=>{J||(D.delete(N),await ko(n(s),Ut,N))})(),yt(n(s),rt,L.map(B=>({id:B.id,data:B.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>V),f(d,()=>M),f(c,()=>D)}}},$=async(N,W,V)=>{const M=n(v)(),D=n(d)(),L=n(c)(),le=[],J=[];for(const oe of V){const de=M.get(oe);de?.data&&(le.push({id:oe,data:ut(de.data)}),J.push({id:oe,data:{...de.data,tags:[...new Set([...de.data.tags.filter(Ne=>!N.includes(Ne)),...W])],history:[...de.data.history||[],{id:Zn(),link:ut(de.data.link),text:de.data.text,tags:de.data.tags,updatedAt:Date.now()}]}}))}for(const oe of J){const de=M.get(oe.id);de?.data&&(de.data=oe.data)}const fe=n(c)(),B=W.filter(oe=>!fe.has(oe));return await Promise.all([(async()=>{if(B.length>0)return yt(n(s),Ut,B.map(oe=>({id:oe,data:{pinned:!1}})))})(),yt(n(s),rt,J.map(oe=>({id:oe.id,data:oe.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>M),f(d,()=>D),f(c,()=>L),{cancel:async()=>{for(const oe of le){const de=M.get(oe.id);de?.data&&(de.data=oe.data)}await Promise.all([(async()=>{if(B.length>0){for(const oe of B)L.delete(oe);return ir(n(s),Ut,B)}})(),yt(n(s),rt,le.map(oe=>({id:oe.id,data:oe.data})))]),i.postMessage({type:"reloadNotes"}),f(v,()=>M),f(d,()=>D),f(c,()=>L)}}},_e=async N=>{const W=JSON.parse(N.data),V=W;if(W.tabId&&W.tabId===o){V.type==="exit"&&(R(),await Ha(n(s),rt),await Ha(n(s),Ut));return}if(V.type==="putNote"){const D=V.data.id;if(!D)return;const L=await Yr(n(s),rt,D);if(!L)return;X({id:D,data:L})}else if(V.type==="deleteNote"){const M=V.data.id;if(!M)return;U(M)}else if(V.type==="pinTag"){const M=V.data.tag,D=V.data.pinned,L=n(c)();L.set(M,{name:M,pinned:D}),f(c,()=>L)}else V.type==="clearNotes"?R():V.type==="reloadNotes"||V.type==="emptyBin"?Y():V.type==="exit"&&R()};Pe(()=>(Y(),i.addEventListener(_e),()=>{i.removeEventListener(_e)})),Ld({isInitedNotes:k,createNote:z,updateNote:me,deleteNote:O,saveNote:Se,revertNote:j,pinNote:ie,moveNoteToBin:se,moveNoteToArchive:Ee,getGetNotes:ee,importNotes:ce,clearNotes:Q,getNoteById:ne,getGetMapTags:()=>n(c),pinTag:Ce,restoreNoteFromBin:G,moveNoteFromArchive:te,checkNotes:_,checkNotesInBin:y,checkNotesInArchive:E,emptyBin:ae,moveNotesToBin:Le,moveNotesToArchive:ge,moveNotesFromArchive:ue,deleteNotes:xe,restoreNotesFromBin:Ae,deleteTag:ke,renameTag:pe,addTag:Re,changeTags:$,checkDuplicatesExist:T,checkInitedNotes:async()=>m});var Me=we(),Je=P(Me);He(Je,()=>e.children??Xe),g(t,Me),be()}const $i={};function Od(t){ht($i,t)}function Ia(){const t=gt($i);if(!t)throw new Error("No FeedContext found");return t}const el={};var ot=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(ot||{});function zd(t){ht(el,t)}function fo(){const t=gt(el);if(!t)throw new Error("No SelectedMetaTagsContext found");return t}function Bd(t,e){ye(e,!0);const a=Na(),{getSelectedTags:r}=Kn(),{getSelectedMetaTags:o}=fo(),{getGetNotes:s}=At();let i=x(r),l=x(o),u=I(0),c=[],d=I(0),v=x(()=>n(l).has(ot.ARCHIVED)),h=x(()=>n(l).has(ot.BIN));Ue(()=>{const k=s()()||[],_=[],y=Array.from(n(i).values());for(let E=k.length-1;E>=0;E--){if(!k[E]||!k[E].data)continue;const w=k[E];if(!n(v)&&!n(h)&&(w?.data.deletedAt||w?.data.archivedAt)||n(v)&&(w?.data.deletedAt||!w?.data.archivedAt)||n(h)&&!w?.data.deletedAt)continue;const b=a?.getFeedSearch().toLowerCase()||"";if(a){if(b.endsWith("$")){const T=b.slice(0,-1);if(!(w.data.link?.title.toLowerCase()===T||w.data.link?.url.toLowerCase()===T||w.data.text.toLowerCase()===T||w.data.tags.map(X=>X.toLowerCase()).includes(T)))continue}else if(!(w.data.link?.title.toLowerCase().includes(b)||w.data.link?.url.toLowerCase().includes(b)||w.data.text.toLowerCase().includes(b)||w.data.tags.map(T=>T.toLowerCase()).join(" ").includes(b)))continue}if(n(l).has(ot.INBOX)){if(w.data.tags.length>0)continue}else if(n(i).size&&y.some(T=>!w.data.tags.includes(T)))continue;_.push(w)}f(u,_.length,!0),c=_,f(d,Date.now(),!0)}),Od({getFiltredNotesLength:()=>n(u),getFiltredNotes:()=>(n(d),c),getUpdatedFiltredNotesTimestamp:()=>n(d)});var p=we(),m=P(p);He(m,()=>e.children??Xe),g(t,p),be()}function jd(t,e){ye(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Bt(),s=x(a),i="selectedMetaTags";let l=x(()=>n(s).get(i)||""),u=x(()=>new Set(n(l).split(",").map(_=>decodeURIComponent(_)).filter(_=>_!=="")));zd({getSelectedMetaTags:()=>n(u),addMetaTag:_=>{n(u).has(_)||r(i,[...n(u),_].map(y=>encodeURIComponent(y)).join(","))},removeMetaTag:_=>{n(u).has(_)&&n(u).size===1?o(i):n(u).has(_)&&r(i,[...n(u)].filter(y=>y!==_).map(y=>encodeURIComponent(y)).join(","))},clearSelectedMetaTags:()=>{o(i)},setSelectedMetaTags:_=>{_.size===0?o(i):r(i,[..._].map(y=>encodeURIComponent(y)).join(","))}});var m=we(),k=P(m);He(k,()=>e.children??Xe),g(t,m),be()}const tl={};function Hd(t){ht(tl,t)}function Ud(){const t=gt(tl);if(!t)throw new Error("No StartContext found");return t}const As=()=>chrome,nl=()=>LanguageModel;var Te=(t=>(t.NewNote="newNote",t.Note="note",t.Settings="settings",t.ImportData="importData",t.ExportData="exportData",t.Account="account",t.Sync="sync",t.AccountSetup="accountSetup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="accessKeys",t.ConfirmAccessKey="confirmAccessKey",t.Subscription="subscription",t.Exit="exit",t.NotFound="notFound",t.About="about",t.Install="install",t.InstallSuccess="installSuccess",t.Extension="extension",t))(Te||{});const Ds={settings:"Settings",importData:"Import",exportData:"Export",account:"Account",sync:"Sync",accountSetup:"",auth:"Auth",signin:"Sign in",signup:"Sign up",confirmAccessKey:"Confirm access key",accessKeys:"Access keys",subscription:"Subscription",exit:"Exit",notFound:"",about:"About",install:"Install app",installSuccess:"Install success",extension:"Extension"},tn="dialogPages",al={};function Wd(t){ht(al,t)}function zt(){const t=gt(al);if(!t)throw new Error("No DialogPagesContext found");return t}function Vd(t,e){ye(e,!0);const{clearDialogPages:a,getDialogPages:r,replaceDialogPage:o}=zt(),{replaceSearchParams:s}=Bt(),{getViewMode:i}=Hn(),{checkInitedNotes:l,getGetNotes:u}=At(),{setFeedSearch:c}=Na();i();let d=I(!1);const v=async()=>{const k=r().at(-1)||"";k.startsWith(Te.NewNote+"?id=")&&o(k.replace(Te.NewNote,Te.Note)),f(d,!0)};Pe(()=>{v()}),Pe(()=>{}),Hd({isInited:()=>n(d)});var h=we(),p=P(h);He(p,()=>e.children??Xe),g(t,h),be()}const rl={},ca=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function qd(t){ht(rl,t)}function Gn(){const t=gt(rl);if(!t)throw new Error("No AnimationSettingsContext found");return t}function Kd(t,e){ye(e,!0);let a=ft(ca());qd(a);var r=we(),o=P(r);He(o,()=>e.children??Xe),g(t,r),be()}const ol={};function Gd(t){ht(ol,t)}function cs(){const t=gt(ol);if(!t)throw new Error("No ScrollingContext found");return t}function Yd(t,e){ye(e,!0);let a=I(!1);const r=()=>n(a),o=Qi(()=>{f(a,!1)},100);Gd({isScrolling:r,enable:()=>{f(a,!0),o()}});var i=we(),l=P(i);He(l,()=>e.children??Xe),g(t,i),be()}const sl={};function Xd(t){ht(sl,t)}function ga(){const t=gt(sl);if(!t)throw new Error("No MobileSizeContext found");return t}function Jd(t,e){ye(e,!0);const a=()=>window.matchMedia("(max-width: 767px)").matches;let r=I(ft(a())),o=Gn();const s=Qi(()=>{o.working=!0},16),i=()=>{o.working=!1,s(),requestAnimationFrame(()=>{f(r,a(),!0)})};Xd({checkMobileSize:()=>n(r)}),Pe(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)));var u=we(),c=P(u);He(c,()=>e.children??Xe),g(t,u),be()}const il={};function Zd(t){ht(il,t)}function Qt(){const t=gt(il);if(!t)throw new Error("No DialogContext found");return t}function Qd(t,e){ye(e,!0);let a=I(0),r=I(!1),o=I(!0),s=I(!1),i=I(!1);Zd({checkExistedDialog:()=>n(a)>0,dialogInc:()=>{f(a,n(a)+1)},dialogDec:()=>{f(a,n(a)-1)},blockDialog:T=>{f(r,T,!0)},checkBlockedDialog:()=>n(r),setClosableDialog:T=>{f(o,T,!0)},checkClosableDialog:()=>n(o),checkLeftStart:()=>n(s),checkLeftEnd:()=>n(i),setLeftStart:T=>{f(s,T,!0)},setLeftEnd:T=>{f(i,T,!0)},getCountDialog:()=>n(a)});var w=we(),b=P(w);He(b,()=>e.children??Xe),g(t,w),be()}const ll={};function $d(t){ht(ll,t)}function vo(){const t=gt(ll);if(!t)throw new Error("No ScrollContainerContext found");return t}function eu(t,e){ye(e,!0);let a=I(null);$d({setScrollContainer:l=>{f(a,l,!0)},getScrollContainer:()=>n(a)});var s=we(),i=P(s);He(i,()=>e.children??Xe),g(t,s),be()}const cl={};function tu(t){ht(cl,t)}function ds(){const t=gt(cl);if(!t)throw new Error("No DialogPageHeightContext found");return t}function nu(t,e){ye(e,!0);let a=I(200);tu({setDialogPageHeight:l=>{f(a,l,!0)},getDialogPageHeight:()=>n(a)});var s=we(),i=P(s);He(i,()=>e.children??Xe),g(t,s),be()}const au=[ur,Jn,rt,Ut,Ad];function ru(){return new Promise((t,e)=>{const a=indexedDB.open(Ed,Nd);kt(a,"upgradeneeded",()=>{const r=a.result;for(const o of au)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),kt(a,va,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),kt(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),kt(a,Un,()=>{e(),console.error(Un,a.error)})})}function ou(t,e){ye(e,!0);let a=I(null);Pe(()=>{ru().then(l=>{f(a,l,!0)}).catch(l=>{console.error("Failed to initialize LocalDB:",l)})}),xd({getDB:()=>n(a)});var o=we(),s=P(o);{var i=l=>{var u=we(),c=P(u);He(c,()=>e.children??Xe),g(l,u)};H(s,l=>{n(a)&&l(i)})}g(t,o),be()}function su(t,e){ye(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=Bt(),s=x(a);let i=x(()=>n(s).get(tn)||""),l=x(()=>n(i).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!==""));const u=()=>n(l),c=w=>{if(w.length===0){o(tn);return}r(tn,w.map(b=>encodeURIComponent(b)).join(","))},d=w=>{r(tn,[...n(l),w].map(b=>encodeURIComponent(b)).join(","))};Wd({setDialogPages:c,getDialogPages:u,pushDialogPage:d,popDialogPage:()=>{const w=n(l)[n(l).length-1];return n(l).length<=1?(o(tn),w):(r(tn,n(l).slice(0,-1).map(b=>encodeURIComponent(b)).join(",")),w)},replaceDialogPage:w=>{r(tn,[...n(l).slice(0,-1),w].map(b=>encodeURIComponent(b)).join(","))},hasDialogPage:w=>n(l).find(b=>{const[T]=b.split("?");return T===w})!==void 0,clearDialogPages:()=>{o(tn)},createDialogPageHref:w=>{const b=new URLSearchParams(n(s).toString());return b.set(tn,[...u(),w].map(T=>encodeURIComponent(T)).join(",")),`${window.location.pathname}?${b.toString()}`},createHandleClickDialogPage:w=>b=>{b.preventDefault(),d(w)}});var y=we(),E=P(y);He(E,()=>e.children??Xe),g(t,y),be()}function iu(t,e){ye(e,!0);let a=I(ft(new URLSearchParams(window.location.search)));const r=v=>{const h=window.location.pathname;f(a,v,!0),window.history.replaceState(null,"",`${h}${v.size>0?`?${v.toString()}`:""}`)};dd({getSearchParams:()=>n(a),replaceSearchParams:v=>{const h=new URLSearchParams(v);r(h)},setSearchParam:(v,h)=>{const p=new URLSearchParams(n(a));p.set(v,h),r(p)},deleteSearchParam:v=>{const h=new URLSearchParams(n(a));h.delete(v),r(h)},getHref:(v=n(a))=>{const h=new URLSearchParams(v);return`${window.location.pathname}${h.toString().length>0?`?${h.toString()}`:""}`},clearSearchParams:()=>{r(new URLSearchParams)}});var c=we(),d=P(c);He(d,()=>e.children??Xe),g(t,c),be()}const dl={};function lu(t){ht(dl,t)}function cu(){const t=gt(dl);if(!t)throw new Error("No KeyboardVisibleContext found");return t}function du(t,e){ye(e,!0);let a=ft({value:!1});const r=()=>a.value,o=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";Pe(()=>{const l=()=>{setTimeout(()=>{o()?a.value=!0:a.value=!1},0)};return l(),document.addEventListener("focusin",l),document.addEventListener("focusout",l),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",l)}}),lu({getIsKeyboardVisible:r});var s=we(),i=P(s);He(i,()=>e.children??Xe),g(t,s),be()}function uu(t,e){ye(e,!0);const a=crypto.randomUUID(),r=(i,l)=>{i.postMessage(JSON.stringify({...l,tabId:a}))};Pd({tabId:a,createBroadcastChannel:()=>{const i=new BroadcastChannel("app");return{postMessage:l=>r(i,l),addEventListener:l=>{i.addEventListener("message",l)},removeEventListener:l=>{i.removeEventListener("message",l)}}}});var o=we(),s=P(o);He(s,()=>e.children??Xe),g(t,o),be()}function fu(t,e){ou(t,{children:(a,r)=>{uu(a,{children:(o,s)=>{Kd(o,{children:(i,l)=>{Yd(i,{children:(u,c)=>{Jd(u,{children:(d,v)=>{Qd(d,{children:(h,p)=>{eu(h,{children:(m,k)=>{nu(m,{children:(_,y)=>{du(_,{children:(E,w)=>{iu(E,{children:(b,T)=>{su(b,{children:(X,U)=>{var q=we(),R=P(q);He(R,()=>e.children??Xe),g(X,q)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function vu(t,e){fu(t,{children:(a,r)=>{gd(a,{children:(o,s)=>{ud(o,{children:(i,l)=>{pd(i,{children:(u,c)=>{_d(u,{children:(d,v)=>{jd(d,{children:(h,p)=>{yd(h,{children:(m,k)=>{kd(m,{children:(_,y)=>{Dd(_,{children:(E,w)=>{Id(E,{children:(b,T)=>{Fd(b,{children:(X,U)=>{Bd(X,{children:(q,R)=>{Vd(q,{children:(ee,re)=>{var Y=we(),F=P(Y);He(F,()=>e.children??Xe),g(ee,Y)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}const ul=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),bt=t=>{const e=ul(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let It=I(""),Nn=I(null),Ua=I(null),Dn=I(null),Xn=I(ft([])),Or=I(null),Qn=null;function tt(t,e){f(It,""),Qn=null,f(Ua,null),f(Dn,null),setTimeout(()=>{f(It,t,!0),e?.onFinish&&f(Ua,e.onFinish,!0),e?.cancel&&(f(Dn,e.cancel.onCancel,!0),Qn=e.cancel.nextFocusRef)},16)}var gu=S('<button type="button" class="c p-146w2pd">undo</button>'),hu=S('<div class="a p-146w2pd"><div class="b p-146w2pd"><span> </span> <!></div></div>'),pu=S("<div><!></div>");function go(t,e){ye(e,!0);let a=Fe(e,"ref",15,null);const r=Zn();Ue(()=>{a(n(Nn))}),Pe(()=>(f(Xn,[...n(Xn),r],!0),()=>{const c=n(Xn).indexOf(r);c!==-1&&f(Xn,n(Xn).filter((d,v)=>v!==c),!0)}));const o=c=>{if(c.key==="Tab"&&c.shiftKey){if(Qn&&n(It)){c.preventDefault();const{prev:d}=bt(Qn);d?.focus(),f(It,"")}}else if(c.key==="Tab"&&!c.shiftKey)Qn&&n(It)&&(c.preventDefault(),f(It,""),Qn?.focus());else if(c.key==="Escape"&&n(It)){if(c.preventDefault(),Qn){const{prev:d}=bt(Qn);d?.focus()}f(It,"")}};Pe(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)})),Ue(()=>{n(It);const c=n(Dn)?2e3:800;n(It)&&(n(Nn)?.getBoundingClientRect(),n(Nn)?.style.setProperty("opacity","1"));const d=setTimeout(()=>{n(Nn)?.style.removeProperty("opacity")},c),v=setTimeout(()=>{f(It,""),n(Ua)&&n(Ua)(),f(Ua,null),f(Dn,null),n(Nn)?.style.removeProperty("opacity")},c+400);return()=>{clearTimeout(d),clearTimeout(v)}});const s=c=>{c.preventDefault(),n(Dn)&&(f(Ua,null),n(Dn)(),f(Dn,null)),f(It,""),n(Nn)?.style.removeProperty("opacity")};Ue(()=>{n(It)&&n(Dn)&&n(Or)&&setTimeout(()=>{n(Or)?.focus()},151)}),Ue(()=>{n(Xn),Ot(()=>{f(It,""),n(Nn)?.style.removeProperty("opacity")})});var i=pu(),l=C(i);{var u=c=>{var d=hu(),v=C(d),h=C(v),p=C(h),m=A(h,2);{var k=_=>{var y=gu();y.__click=s,$e(y,E=>f(Or,E),()=>n(Or)),g(_,y)};H(m,_=>{n(Dn)&&_(k)})}$e(v,_=>f(Nn,_),()=>n(Nn)),De(()=>vt(p,n(It))),g(c,d)};H(l,c=>{n(It)&&n(Xn)[n(Xn).length-1]===r&&c(u)})}g(t,i),be()}pt(["click"]);var mu=S('<span class="a p-lxk90o"><!></span>');function _t(t,e){var a=mu(),r=C(a);He(r,()=>e.children),g(t,a)}var _u=Wc('<svg class="p-1yv1ibq"><use></use></svg>');function he(t,e){let a=Fe(e,"name",8,"");var r=_u(),o=C(r);De(()=>dt(o,"href",`#icon-${a()??""}`)),g(t,r)}var wu=S('<button class="a p-1cnj0y3"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function fl(t,e){ye(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Ar(),{getDialogPages:s}=zt(),{checkExistedDialog:i}=Qt();let l=x(()=>s().length>0||i());const u=h=>{if(h.preventDefault(),n(l))return;const p=r();p==="closed"?a():p==="opened"&&o()};var c=wu();c.__click=u;var d=C(c);ve(d,()=>({"--size":"28px"})),he(d.lastChild,{name:"sidebarMenu"});var v=A(d,2);_t(v,{children:(h,p)=>{var m=Ke("Menu");g(h,m)}}),g(t,c),be()}pt(["click"]);var yu=S('<button class="b p-3z9gmw"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),bu=S('<div class="a p-3z9gmw"><input class="p-3z9gmw"/> <!></div>');function jo(t,e){ye(e,!0);let a=Fe(e,"value",15,""),r=Fe(e,"ref",15,null);const o=c=>{c.key==="Escape"&&(c.stopPropagation(),r()&&(e.onEscape?.(),r().blur()))};Pe(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=bu(),i=C(s);i.__input=c=>e.onChange?.(c.target?.value||""),$e(i,c=>r(c),()=>r());var l=A(i,2);{var u=c=>{var d=yu();d.__click=()=>{a(""),e.onChange?.("")};var v=C(d);ve(v,()=>({"--size":"20px"})),he(v.lastChild,{name:"close"});var h=A(v,2);_t(h,{children:(p,m)=>{var k=Ke("Clear");g(p,k)}}),g(c,d)};H(l,c=>{a()&&c(u)})}De(()=>dt(i,"placeholder",e.placeholder)),Zt("focus",i,function(...c){e.onFocus?.apply(this,c)}),Zt("blur",i,function(...c){e.onBlur?.apply(this,c)}),Fi(i,a),g(t,s),be()}pt(["input","click"]);function us(t,e){ye(e,!0);let a=Fe(e,"notificationRef",11,null);Pe(()=>{const r=o=>{o.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==o.target&&!e.dialogInner.contains(o.target)&&a()!==o.target&&!a()?.contains(o.target)&&e.onClose()};return document.addEventListener("mousedown",r,{capture:!0}),()=>{document.removeEventListener("mousedown",r,{capture:!0})}}),be()}function Cu(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const Tn=Cu(),Su=()=>{const t=navigator.userAgent;return/android/i.test(t)},Wn=Su(),dp=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},up=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},yr=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))};let Ba=I(ft([]));var ku=S("<dialog><div><!></div></dialog> <!>",1);function Dr(t,e){ye(e,!0);const a=Zn(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;Pe(()=>(f(Ba,[...n(Ba),a],!0),()=>{const w=n(Ba).indexOf(a);w!==-1&&f(Ba,n(Ba).filter((b,T)=>T!==w),!0)}));let o=Fe(e,"onClosed",3,()=>{}),s=Fe(e,"blocked",3,!1),i=I(null),l=I(null),u=I(!1),{dialogInc:c,dialogDec:d}=Qt();const v=()=>{const w=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(w),o()()},{once:!0}),f(u,!1)};Ue(()=>{e.startClose&&v()}),Pe(()=>{n(i)?.showModal(),n(i)?.getClientRects(),f(u,!0);const w=b=>{b?.preventDefault(),s()||v()};return n(i)?.addEventListener("cancel",w),n(i)?.addEventListener("close",w),()=>{n(i)?.removeEventListener("cancel",w),n(i)?.removeEventListener("close",w)}}),Pe(()=>(c(),()=>{d()})),Pe(()=>{const w=b=>{b.key==="Escape"&&s()&&b.preventDefault()};return window.addEventListener("keydown",w),()=>{window.removeEventListener("keydown",w)}});function h(){setTimeout(()=>{if(Tn||!n(i)||!n(l))return;const w=window.visualViewport;if(w)if(w.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},0)}Pe(()=>(h(),window.visualViewport?.addEventListener("resize",h),window.visualViewport?.addEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h),()=>{window.visualViewport?.removeEventListener("resize",h),window.visualViewport?.removeEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h)}));var p=ku(),m=P(p),k=C(m),_=C(k);He(_,()=>e.children),$e(k,w=>f(l,w),()=>n(l)),$e(m,w=>f(i,w),()=>n(i));var y=A(m,2);{var E=w=>{us(w,{get dialog(){return n(i)},get dialogInner(){return n(l)},onClose:v})};H(y,w=>{n(i)&&n(l)&&!s()&&w(E)})}De(()=>{et(m,1,nt({a:!0,b:n(u),c:n(Ba).length>1}),"p-1x14yml"),et(k,1,nt({d:!0,b:n(u)}),"p-1x14yml")}),g(t,p),be()}var xu=S("<div><!></div>");function Tu(t,e){ye(e,!0);let a=I(!1),r=I(null),o=null;const s=()=>{const v=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(v),e.onClosed()},{once:!0}),f(a,!1)},i=v=>{v.target!==n(r)&&!n(r)?.contains(v.target)&&s()},l=v=>{v.target!==n(r)&&!n(r)?.contains(v.target)&&s()},u=v=>{if(v.key==="Escape"&&(v.preventDefault(),s()),v.key==="ArrowUp"||v.key==="ArrowDown"){if(!n(r))return;v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation();const h=ul(n(r));if(o){const p=h.indexOf(o),m=h[p-1],k=h[p+1];v.key==="ArrowUp"&&m?(m.focus(),o=m):v.key==="ArrowDown"&&k&&(k.focus(),o=k)}else v.key==="ArrowUp"?(h[h.length-1].focus(),o=h[h.length-1]):v.key==="ArrowDown"&&(h[0].focus(),o=h[0])}};Pe(()=>{n(r)?.getClientRects(),f(a,!0);const v=setTimeout(()=>{document.addEventListener("focusin",i),document.addEventListener("click",l),document.addEventListener("keydown",u,{capture:!0})},0);return()=>{clearTimeout(v),document.removeEventListener("focusin",i),document.removeEventListener("click",l),document.removeEventListener("keydown",u,{capture:!0})}}),Ue(()=>{e.startClose&&s()});var c=xu(),d=C(c);He(d,()=>e.children),$e(c,v=>f(r,v),()=>n(r)),De(()=>et(c,1,nt({a:!0,b:n(a)}),"p-1unpq18")),g(t,c),be()}var Pu=S("<ul><!></ul>"),Eu=S("<ul><!></ul>");function Mr(t,e){ye(e,!0);let a=Fe(e,"ref",15);var r=we(),o=P(r);{var s=l=>{Dr(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(u,c)=>{var d=Pu(),v=C(d);He(v,()=>e.children),$e(d,h=>a(h),()=>a()),De(()=>et(d,1,nt({a:!0,b:e.isMobile}),"p-6pddb9")),g(u,d)},$$slots:{default:!0}})},i=l=>{Tu(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(u,c)=>{var d=Eu(),v=C(d);He(v,()=>e.children),$e(d,h=>a(h),()=>a()),De(()=>et(d,1,nt({a:!0,b:e.isMobile}),"p-6pddb9")),g(u,d)},$$slots:{default:!0}})};H(o,l=>{e.isMobile?l(s):l(i,!1)})}g(t,r),be()}var Nu=S("<button><!></button>"),Au=S("<a><!></a>");function We(t,e){let a=Fe(e,"dangerous",3,!1),r=Fe(e,"type",3,"button"),o=Fe(e,"href",3,"");var s=we(),i=P(s);{var l=c=>{var d=Nu();d.__click=function(...h){e.onClick?.apply(this,h)},d.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=C(d);He(v,()=>e.children??Xe),De(()=>et(d,1,nt({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")),g(c,d)},u=c=>{var d=Au();d.__click=function(...h){e.onClick?.apply(this,h)},d.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=C(d);He(v,()=>e.children??Xe),De(()=>{dt(d,"href",o()),et(d,1,nt({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")}),g(c,d)};H(i,c=>{r()==="button"?c(l):c(u,!1)})}g(t,s)}pt(["click","keydown"]);var Du=S('<li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li>',1),Mu=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Iu=S('<div class="a p-108u1na"><button><!> <!></button> <!></div>');function Lu(t,e){ye(e,!0);let a=I(!1),r=I(!1);const{getFeedOrder:o,setFeedOrder:s}=Hi();let i=Tn||Wn,l=x(o);const u=()=>{n(a)||f(a,!0)},c=y=>{f(r,!0),s(y)},d=()=>{f(a,!1),f(r,!1)};Pe(()=>{const y=E=>{E.key==="Escape"&&f(r,!0)};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)});var v=Iu(),h=C(v);h.__click=u,et(h,1,nt({b:!0,c:!0}),"p-108u1na");var p=C(h);he(p,{name:"filter"});var m=A(p,2);_t(m,{children:(y,E)=>{var w=Ke("show feed order menu");g(y,w)}});var k=A(h,2);{var _=y=>{var E=Mu(),w=P(E);ve(w,()=>({"--right":"0px","--top":"44px"})),Mr(w.lastChild,{get startClose(){return n(r)},onClosed:d,get isMobile(){return i},children:(b,T)=>{var X=Du(),U=P(X),q=C(U);{let j=x(()=>n(l)==="newest");We(q,{get active(){return n(j)},get dialogMode(){return i},onClick:()=>c("newest"),children:(O,Q)=>{var ne=Ke("Newest");g(O,ne)},$$slots:{default:!0}})}var R=A(U,2),ee=C(R);{let j=x(()=>n(l)==="oldest");We(ee,{get active(){return n(j)},get dialogMode(){return i},onClick:()=>c("oldest"),children:(O,Q)=>{var ne=Ke("Oldest");g(O,ne)},$$slots:{default:!0}})}var re=A(R,2),Y=C(re);{let j=x(()=>n(l)==="AtoZ");We(Y,{get active(){return n(j)},get dialogMode(){return i},onClick:()=>c("AtoZ"),children:(O,Q)=>{var ne=Ke("A to Z");g(O,ne)},$$slots:{default:!0}})}var F=A(re,2),z=C(F);{let j=x(()=>n(l)==="ZtoA");We(z,{get active(){return n(j)},get dialogMode(){return i},onClick:()=>c("ZtoA"),children:(O,Q)=>{var ne=Ke("Z to A");g(O,ne)},$$slots:{default:!0}})}var me=A(F,2),Se=C(me);{let j=x(()=>n(l)==="updatedNewest");We(Se,{get active(){return n(j)},get dialogMode(){return i},onClick:()=>c("updatedNewest"),children:(O,Q)=>{var ne=Ke("Updated");g(O,ne)},$$slots:{default:!0}})}g(b,X)},$$slots:{default:!0}}),g(y,E)};H(k,y=>{n(a)&&y(_)})}g(t,v),be()}pt(["click"]);var Ru=S('<div><!> <div class="a p-y3zt6o"></div></div>');function La(t,e){ye(e,!0);let a=I(!1);Pe(()=>{const s=setTimeout(()=>{f(a,!0)},200);return()=>{clearTimeout(s)}});var r=Ru(),o=C(r);He(o,()=>e.children??Xe),De(()=>et(r,1,nt({b:!0,c:n(a)}),"p-y3zt6o")),g(t,r),be()}var Fu=S("<a><!></a>"),Ou=S("<button><!></button>");function Rt(t,e){let a=Fe(e,"type",3,"standard"),r=Fe(e,"typeButton",3,"button"),o=Fe(e,"element",3,"button"),s=Fe(e,"href",3,""),i=Fe(e,"fullWidth",3,!1),l=Fe(e,"withoutMinWidth",3,!1);var u=we(),c=P(u);{var d=h=>{var p=Fu();p.__click=function(...k){e.onClick?.apply(this,k)};var m=C(p);He(m,()=>e.children??Xe),De(()=>{dt(p,"target",e.target),dt(p,"rel",e.rel),dt(p,"href",s()),et(p,1,nt({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,p)},v=h=>{var p=Ou();p.__click=function(...k){e.onClick?.apply(this,k)};var m=C(p);He(m,()=>e.children??Xe),De(()=>{dt(p,"type",r()),et(p,1,nt({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,p)};H(c,h=>{o()==="a"?h(d):h(v,!1)})}g(t,u)}pt(["click"]);let Ho=I(!1),zr=I(!1),Uo=I(""),Wo=I("Cancel"),Vo=I("Confirm"),qo,Wr=I(void 0),Ko,Go=I("dangerous");function Va(t){f(Ho,!0),f(Uo,t.title,!0),t.buttonCancelTitle&&f(Wo,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&f(Vo,t.buttonConfirmTitle,!0),qo=t.onConfirm,f(Wr,t.onCancel,!0),Ko=t.onClosed,t.type?f(Go,t.type,!0):f(Go,"dangerous")}var zu=S('<span class="b p-1jg69ok"> </span> <div class="c p-1jg69ok"><!> <!></div>',1),Bu=S('<div class="a p-1jg69ok"><!></div>');function ju(t,e){ye(e,!0);let a=I(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{f(a,!0)},250)};Pe(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(Wr)?.(),f(zr,!0)},l=async()=>{s(),await qo?.(),f(zr,!0),o=!0},u=()=>{clearTimeout(r),f(a,!1),f(Ho,!1),f(zr,!1),f(Uo,""),f(Wo,"Cancel"),f(Vo,"Confirm"),f(Wr,void 0),qo=void 0,Ko&&Ko(o),o=!1};var c=we(),d=P(c);{var v=h=>{Dr(h,{get blocked(){return n(a)},get startClose(){return n(zr)},onClosed:u,children:(p,m)=>{var k=Bu(),_=C(k);{var y=w=>{La(w,{})},E=w=>{var b=zu(),T=P(b),X=C(T),U=A(T,2),q=C(U);{var R=re=>{Rt(re,{size:"small",onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Y,F)=>{var z=Ke();De(()=>vt(z,n(Wo))),g(Y,z)},$$slots:{default:!0}})};H(q,re=>{n(Wr)&&re(R)})}var ee=A(q,2);Rt(ee,{size:"small",onClick:l,fullWidth:!0,withoutMinWidth:!0,get type(){return n(Go)},children:(re,Y)=>{var F=Ke();De(()=>vt(F,n(Vo))),g(re,F)},$$slots:{default:!0}}),De(()=>vt(X,n(Uo))),g(w,b)};H(_,w=>{n(a)?w(y):w(E,!1)})}g(p,k)},$$slots:{default:!0}})};H(d,h=>{n(Ho)&&h(v)})}g(t,c),be()}const br=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,l=a.ctrlKey,u=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!l&&!!t.shift==!!u){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var Hu=S('<div class="a p-6qmscy"><a class="b p-6qmscy"><span class="c p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function Uu(t,e){ye(e,!1);const{createDialogPageHref:a,createHandleClickDialogPage:r,getDialogPages:o,pushDialogPage:s}=zt(),{checkExistedDialog:i}=Qt(),l=()=>{o.length===0&&!i()&&s(Te.NewNote)};Pe(()=>br({key:"n",action:l})),ss();var u=Hu(),c=C(u),d=x(()=>r(Te.NewNote));c.__click=function(..._){n(d)?.apply(this,_)};var v=C(c),h=C(v);ve(h,()=>({"--size":"28px","--color":"#b0b0b0"})),he(h.lastChild,{name:"add"});var p=A(h,2);_t(p,{children:(_,y)=>{var E=Ke("Add note");g(_,E)}});var m=A(v,2),k=C(m);ve(k,()=>({"--size":"16px","--color":"#b0b0b0"})),he(k.lastChild,{name:"plus"}),De(_=>dt(c,"href",_),[()=>a(Te.NewNote)]),g(t,u),be()}pt(["click"]);var Wu=S("<button><!></button>");function ha(t,e){ye(e,!0);let a=Fe(e,"type",3,"button"),r=!1,o=I(null);Ue(()=>{e.onRef&&e.onRef(n(o))});const s=d=>{(d.key==="Enter"||d.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},l=d=>{(d.pointerType==="mouse"&&d.button===0||d.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(d)};var u=Wu();u.__keydown=s,u.__click=i,u.__pointerdown=l,u.__touchstart=function(...d){e.onTouchStart?.apply(this,d)};var c=C(u);He(c,()=>e.children??Xe),$e(u,d=>f(o,d),()=>n(o)),De(()=>{dt(u,"type",a()),u.disabled=e.disabled,et(u,1,nt({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty"}),"p-19nhjik")}),g(t,u),be()}pt(["keydown","click","pointerdown","touchstart"]);var Vu=S('<div class="b p-1pt17hy"> </div>'),qu=S('<div class="a p-1pt17hy"><input/> <!></div>');function Cr(t,e){ye(e,!0);let a=Fe(e,"value",15,""),r=Fe(e,"error",3,""),o=Fe(e,"ref",15,null);var s=qu(),i=C(s);i.__input=function(...d){e.onInput?.apply(this,d)};let l;$e(i,d=>o(d),()=>o());var u=A(i,2);{var c=d=>{var v=Vu(),h=C(v);De(()=>vt(h,r())),g(d,v)};H(u,d=>{r()&&d(c)})}De(()=>{dt(i,"placeholder",e.placeholder),l=et(i,1,"p-1pt17hy",null,l,{error:!!r()})}),Zt("blur",i,function(...d){e.onBlur?.apply(this,d)}),Zt("focus",i,function(...d){e.onFocus?.apply(this,d)}),Fi(i,a),g(t,s),be()}pt(["input"]);var Ku=S('<div class="b p-z67y1l"> </div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Gu=S('<form class="a p-z67y1l"><!></form>');function Yu(t,e){ye(e,!0);const{renameTag:a}=At(),{getSelectedTags:r,setSelectedTags:o}=Kn(),{getSelectedNotes:s,setSelectedNotes:i,clearNotes:l}=fa(),{getFiltredNotes:u}=Ia();let c=I(!1),d=I(!1),v,h=!1,p=I(null),m=I(ft(e.tag)),k=e.nextFocusRef;Pe(()=>(n(p)&&n(p).focus(),()=>{v&&clearTimeout(v)}));const _=()=>{v=setTimeout(()=>{f(d,!0)},250)},y=()=>{f(c,!0)},E=async()=>{if(n(m).trim()===e.tag){y();return}if(n(m).trim()!=="")try{_();const T=r(),X=[...T].map(re=>re===e.tag?n(m).trim():re),U=new Set(s()),q=u(),R=U.size?[...U]:q.map(re=>re.id),{cancel:ee}=await a(e.tag,n(m).trim(),R);l(),o(new Set(X)),tt("Tag renamed",{cancel:{nextFocusRef:k,onCancel:async()=>{await ee(),o(T),i(U),setTimeout(()=>{const{prev:re}=bt(k);re?.focus()},16)}}}),h=!0}finally{f(c,!0)}},w=()=>{e.onClosed?.(h)},b=T=>{T.preventDefault(),E()};Dr(t,{get blocked(){return n(d)},get startClose(){return n(c)},onClosed:w,children:(T,X)=>{var U=Gu(),q=C(U);{var R=re=>{La(re,{})},ee=re=>{var Y=Ku(),F=P(Y),z=C(F),me=A(F,2);Cr(me,{placeholder:"Enter new tag name",get ref(){return n(p)},set ref(Q){f(p,Q,!0)},get value(){return n(m)},set value(Q){f(m,Q,!0)}});var Se=A(me,2),j=C(Se);Rt(j,{size:"small",onClick:y,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Q,ne)=>{var ie=Ke("Cancel");g(Q,ie)},$$slots:{default:!0}});var O=A(j,2);Rt(O,{size:"small",onClick:E,fullWidth:!0,withoutMinWidth:!0,children:(Q,ne)=>{var ie=Ke("OK");g(Q,ie)},$$slots:{default:!0}}),De(()=>vt(z,`Rename "${e.tag??""}" for selected notes`)),g(re,Y)};H(q,re=>{n(d)?re(R):re(ee,!1)})}Zt("submit",U,b),g(T,U)},$$slots:{default:!0}}),be()}let aa=I(!1),pa=I(!1),Yt=I(""),ma=I(0),fr=I(0),vr=I(0),Vr,Xr=()=>({bottom:0,right:0,height:0}),$t=I(null),Yo=I(null);function Xu(t){if(n(aa)){f(pa,!0),n(Yt)!==t.tag&&(Vr=()=>{const a=t.getRect();f(aa,!0),f(Yt,t.tag,!0),f(ma,a.bottom,!0),f(fr,a.right,!0),f(vr,a.height,!0),Xr=t.getRect,f($t,t.focusRef,!0)});return}const e=t.getRect();f(aa,!0),f(Yt,t.tag,!0),f(ma,e.bottom,!0),f(fr,e.right,!0),f(vr,e.height,!0),Xr=t.getRect,f($t,t.focusRef,!0)}const Ju=()=>n(aa),Zu=()=>n(Yo);var Qu=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),$u=S('<li class="p-16hbyw2"><!></li>'),ef=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),tf=S('<li class="p-16hbyw2"><!></li>'),nf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),af=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),rf=S('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),of=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),sf=S("<!> <!>",1);function lf(t,e){ye(e,!0);const{getScrollContainer:a}=vo(),{pinTag:r,getGetMapTags:o,deleteTag:s}=At(),{checkMobileSize:i}=ga(),{getSelectedTags:l,removeTag:u,setSelectedTags:c}=Kn(),{getSelectedNotes:d,setSelectedNotes:v,clearNotes:h}=fa(),{getFiltredNotes:p}=Ia();let m=I(!1);Ue(()=>{n(aa),Ot(()=>{f(m,o()().get(n(Yt))?.pinned||!1,!0)})});let k=I(!1);const _=()=>{r(n(Yt),!0),f(pa,!0);let j=n($t),O=bt(j)?.next;tt("Tag pinned",{cancel:{nextFocusRef:O,onCancel:async()=>{r(n(Yt),!1),setTimeout(()=>{const{prev:Q}=bt(O);Q?.focus()},16)}}})},y=()=>{r(n(Yt),!1),f(pa,!0);let j=n($t),O=bt(j)?.next;tt("Tag unpinned",{cancel:{nextFocusRef:O,onCancel:async()=>{r(n(Yt),!0),setTimeout(()=>{const{prev:Q}=bt(O);Q?.focus()},16)}}})},E=()=>{f(aa,!1),f(pa,!1),f(ma,0),f(fr,0),f(vr,0),Xr=()=>({bottom:0,right:0,height:0}),f($t,null),Vr&&setTimeout(()=>{Vr?.(),Vr=void 0})};let w=x(()=>window.innerHeight-n(ma)<100?n(ma)-n(vr)-98+"px":n(ma)+5+"px"),b=x(a);const T=j=>{j.key==="Tab"&&j.shiftKey&&(j.preventDefault(),n($t)?.focus())},X=j=>{j.key==="Tab"&&!j.shiftKey&&n($t)&&(j.preventDefault(),bt(n($t))?.next?.focus())};Pe(()=>{const j=O=>{O.key==="Escape"&&n(aa)&&n($t)?.focus()};return window.addEventListener("keydown",j),()=>{window.removeEventListener("keydown",j)}});const U=()=>{f(pa,!0);let j=n($t),O=bt(j)?.next;Va({title:`Are you sure to delete "${n(Yt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const Q=Array.from(n(ee)),ne=new Set(d()),ie=p(),se=ne.size?[...ne]:ie.map(Le=>Le.id);n(ee).has(n(Yt))&&(ne.size===0||ie.length===ne.size)&&u(n(Yt)),h();const{cancel:Ee}=await s(n(Yt),se);tt("Tag deleted",{cancel:{nextFocusRef:O,onCancel:async()=>{await Ee(),c(new Set(Q)),v(new Set(ne)),setTimeout(()=>{const{prev:Le}=bt(O);Le?.focus()},16)}}})},onCancel:async()=>{},onClosed:Q=>{setTimeout(()=>{Q||j?.focus()},16)}})};let q=()=>{};const R=()=>{f(pa,!0),f(k,!0);let j=n($t);q=()=>{f(k,!1),setTimeout(()=>{j?.focus()},16)}};Ue(()=>{const j=()=>{const O=Xr();f(ma,O.bottom,!0),f(fr,O.right,!0),f(vr,O.height,!0)};return n(b)?.addEventListener("scroll",j),window.addEventListener("resize",j),()=>{n(b)?.removeEventListener("scroll",j),window.removeEventListener("resize",j)}});let ee=x(l),re=x(i);var Y=sf(),F=P(Y);{var z=j=>{var O=of(),Q=P(O);ve(Q,()=>({"--left":n(fr)-36+"px","--top":n(w),"--transform-origin":"top left"})),Mr(Q.lastChild,{get startClose(){return n(pa)},onClosed:E,get isMobile(){return n(re)},get ref(){return n(Yo)},set ref(ne){f(Yo,ne,!0)},children:(ne,ie)=>{var se=rf(),Ee=P(se);{var Le=Ce=>{var xe=$u(),ce=C(xe);We(ce,{onClick:_,onKeydown:T,get dialogMode(){return n(re)},children:(ae,ke)=>{var pe=Qu(),Re=P(pe);ve(Re,()=>({"--size":"20px"})),he(Re.lastChild,{name:"pin"}),g(ae,pe)},$$slots:{default:!0}}),g(Ce,xe)},ge=Ce=>{var xe=tf(),ce=C(xe);We(ce,{onClick:y,onKeydown:T,get dialogMode(){return n(re)},children:(ae,ke)=>{var pe=ef(),Re=P(pe);ve(Re,()=>({"--size":"20px"})),he(Re.lastChild,{name:"pin-cancel"}),g(ae,pe)},$$slots:{default:!0}}),g(Ce,xe)};H(Ee,Ce=>{n(m)?Ce(ge,!1):Ce(Le)})}var ue=A(Ee,2),Ae=C(ue);We(Ae,{onClick:R,get dialogMode(){return n(re)},children:(Ce,xe)=>{var ce=nf(),ae=P(ce);ve(ae,()=>({"--size":"20px","--scale":"0.9"})),he(ae.lastChild,{name:"pen"}),g(Ce,ce)},$$slots:{default:!0}});var G=A(ue,2),te=C(G);We(te,{onClick:U,onKeydown:X,get dialogMode(){return n(re)},children:(Ce,xe)=>{var ce=af(),ae=P(ce);ve(ae,()=>({"--size":"20px"})),he(ae.lastChild,{name:"bin"}),g(Ce,ce)},$$slots:{default:!0}}),g(ne,se)},$$slots:{default:!0}}),g(j,O)};H(F,j=>{n(aa)&&j(z)})}var me=A(F,2);{var Se=j=>{{let O=x(()=>bt(n($t))?.next||null);Yu(j,{get tag(){return n(Yt)},get nextFocusRef(){return n(O)},onClosed:Q=>{q(Q)}})}};H(me,j=>{n(k)&&j(Se)})}g(t,Y),be()}var cf=S('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),df=S('<button><span class="b p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),uf=S("<!> <span> </span> <!>",1),ff=S('<div class="a p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function gr(t,e){ye(e,!0);let{getGetMapTags:a}=At(),r=I(null),o=x(Ju);const s=()=>{if(n(r)){const v=n(r).getBoundingClientRect();return{bottom:v.bottom,right:v.right,height:v.height}}return{bottom:0,right:0,height:0}},i=v=>{v.stopPropagation(),v.preventDefault(),Xu({tag:e.tag,getRect:s,focusRef:n(r)})},l=v=>{v.key==="Tab"&&!v.shiftKey&&n(o)&&(v.preventDefault(),Zu()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let u=x(()=>a()().get(e.tag)?.pinned||!1);var c=ff(),d=C(c);ve(d,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),ha(d.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(v,h)=>{var p=uf(),m=P(p);{var k=b=>{var T=cf(),X=C(T);ve(X,()=>({"--size":"18px"})),he(X.lastChild,{name:"pin"}),g(b,T)};H(m,b=>{n(u)&&b(k)})}var _=A(m,2),y=C(_),E=A(_,2);{var w=b=>{var T=df();T.__click=i,T.__keydown=l;var X=C(T),U=C(X);ve(U,()=>({"--size":"16px"})),he(U.lastChild,{name:"menu"});var q=A(U,2);_t(q,{children:(R,ee)=>{var re=Ke("Tag options");g(R,re)}}),$e(T,R=>f(r,R),()=>n(r)),De(()=>et(T,1,nt({c:!0,d:e.type==="selected"}),"p-9jjlcl")),g(b,T)};H(E,b=>{e.hideMenu||b(w)})}De(()=>vt(y,e.tag)),g(v,p)},$$slots:{default:!0}}),g(t,c),be()}pt(["click","keydown"]);var vf=S('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function Ms(t,e){ye(e,!0);let a=Fe(e,"mobile",3,!1);const{getGetMapTags:r}=At();let s=x(()=>{const p=r()();return[...e.tags].sort((m,k)=>p.get(m)?.pinned?-1:p.get(k)?.pinned?1:m.localeCompare(k))}),i=x(()=>n(s).filter(p=>r()().get(p)?.pinned)),l=x(()=>n(s).filter(p=>!r()().get(p)?.pinned));var u=vf(),c=C(u),d=C(c);Bn(d,16,()=>n(i),p=>p,(p,m)=>{gr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return m},onClick:()=>{e.handleTagClick(m)}})});var v=A(d,2);Bn(v,17,()=>e.metaTags,p=>"meta"+p,(p,m)=>{gr(p,{hideMenu:!0,get tag(){return n(m)},onClick:()=>{e.handleMetaTagClick(n(m))}})});var h=A(v,2);Bn(h,16,()=>n(l),p=>p,(p,m)=>{gr(p,{get hideMenu(){return e.hideTagMenu},get tag(){return m},onClick:()=>{e.handleTagClick(m)}})}),De(()=>et(c,1,nt({b:!0,c:a()}),"p-lawyrs")),g(t,u),be()}var gf=S('<div class="b c p-32813r"><div class="d p-32813r"><button class="e p-32813r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),hf=S('<div class="a p-32813r"><!></div>');function Is(t,e){ye(e,!0);let a=I(null);const r=u=>{f(a,u,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};Ue(()=>{n(a)&&n(a).focus()});var s=hf(),i=C(s);{var l=u=>{var c=gf(),d=C(c),v=C(d);v.__click=o;var h=C(v);ve(h,()=>({"--size":"20px"})),he(h.lastChild,{name:"close"});var p=A(h,2);_t(p,{children:(_,y)=>{var E=Ke("Clear");g(_,E)}});var m=A(d,2);Bn(m,19,()=>e.metaTags,_=>"meta_"+_,(_,y,E)=>{{let w=x(()=>n(E)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);gr(_,{hideMenu:!0,type:"selected",get tag(){return n(y)},onClick:()=>{e.handleMetaTagClick(n(y))},get onRef(){return n(w)}})}});var k=A(m,2);Bn(k,18,()=>e.selectedTags,_=>_,(_,y,E)=>{{let w=x(()=>n(E)===e.selectedTags.size-1?r:void 0);gr(_,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return y},onClick:()=>{e.handleSelectedTagClick(y)},get onRef(){return n(w)}})}}),g(u,c)};H(i,u=>{e.selectedTags.size+e.metaTags.size>0&&u(l)})}g(t,s),be()}pt(["click"]);const Xo=(t,e,a,r)=>{if(t.has(ot.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const l of i?.data?.tags||[])o.includes(l)||o.push(l);continue}if(i.data&&s.every(l=>i.data?.tags.includes(l)))for(const l of i.data.tags||[])!e.has(l)&&!o.includes(l)&&o.push(l)}return o},jn=200,pf=t=>t<.5?2*t*t:-1+(4-2*t)*t,vl=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,pf(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},mf=t=>{const{getIsKeyboardVisible:a}=cu();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},l=v=>({x:v.clientX,y:v.clientY,time:performance.now()}),u=v=>{r=[l(v.touches[0])],o=!0},c=v=>{if(!o||s)return;r.push(l(v.touches[0]));const h=performance.now()-150;r=r.filter(U=>U.time>=h);const p=r.at(-1),m=r[0];if(!p||!m)return;const k=m.x,_=m.y,y=p.x,E=p.y,w=y-k,b=E-_,T=Math.abs(w)>Math.abs(b),X=Math.abs(w)>3;T&&X&&!a()&&(s=!0,v.preventDefault(),t([...r]),i())},d=()=>{i()};Pe(()=>(document.addEventListener("touchstart",u,{passive:!0}),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",d,{passive:!0}),document.addEventListener("touchcancel",d,{passive:!0}),()=>{document.removeEventListener("touchstart",u),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d),document.removeEventListener("touchcancel",d)}))},Ls=5,Rs=.6,da=.3;function gl(t,e){ye(e,!0);let a=[],r=0,o=!1,s=0,i=0,l=0,u=0,c=0,d=null,v=null;const h=()=>{a=[],r=0,o=!1,s=0,i=0,l=0,u=0,c=0,d!==null&&(cancelAnimationFrame(d),d=null),v&&(clearTimeout(v),v=null)},p=()=>{e.onCancel(),h()},m=()=>{v&&clearTimeout(v),v=setTimeout(p,5e3)};mf(async X=>{if(!o)try{const U=X.at(-1);if(!U)throw new Error("No points available for swipe initialization");const q=await e.onInit();if(!q)return;s=q.initialPosition,i=q.currentPosition,l=q.minPosition,u=q.maxPosition,c=q.width,r=U.x,a=X,o=!0,m()}catch(U){console.error("Error during swipe initialization:",U),h()}});const _=X=>Math.max(l,Math.min(u,X)),y=()=>{if(d=null,!o){h();return}const X=a.at(-1),U=a[0];if(!X||!U)return;let q=X.x-r;r=X.x;const R=_(i+q);R!==i&&(i=R,e.onUpdate({initialPosition:s,newPosition:R,width:c,minPosition:l,maxPosition:u}))},E=X=>{if(!o){h();return}a.push({x:X.touches[0].clientX,y:X.touches[0].clientY,time:performance.now()});const U=performance.now()-150;a=a.filter(re=>re.time>=U),d===null&&(d=requestAnimationFrame(y)),m();const q=X.touches[0].clientX-a[0].x,R=X.touches[0].clientY-a[0].y;Math.abs(q)>Math.abs(R)&&X.cancelable&&X.preventDefault()},w=X=>{const U=Math.abs(X);if(U>=Rs)return Ls;if(U>=da){const q=(U-da)/(Rs-da);return e.baseActionThreshold-q*(e.baseActionThreshold-Ls)}else return e.baseActionThreshold},b=X=>{if(!o){h();return}let U=0;a.push({x:X.changedTouches[0].clientX,y:X.changedTouches[0].clientY,time:performance.now()}),y(),d!==null&&(cancelAnimationFrame(d),d=null);const q=a[0],R=a[a.length-1],ee=R.x-q.x,re=R.time-q.time;re>0&&(U=ee/re);const Y=w(U);e.onFinish({swipeVelocity:U,currentPosition:i,minPosition:l,maxPosition:u,initialPosition:s,width:c,actionThreshold:Y}),h()},T=()=>{p()};Pe(()=>(document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("touchend",b,{passive:!0}),document.addEventListener("touchcancel",T,{passive:!0}),()=>{document.removeEventListener("touchmove",E),document.removeEventListener("touchend",b),document.removeEventListener("touchcancel",T),d!==null&&cancelAnimationFrame(d),v&&clearTimeout(v)})),be()}function _f(t,e){ye(e,!0);const a=Gn();let r=Fe(e,"animationRef",7),o=Fe(e,"dialog",7);gl(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const c=-e.dialogWidth*.7,d=0;let v=e.sidebarState==="closed"?c:d,h=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let k=()=>1;if(r().current){r().current.pause();let _=Number(r().current.currentTime);yr()&&(_=Number(_)+50,r().current.currentTime=Math.min(Math.max(jn-1,_),_));const y=r().current.effect?.getComputedTiming().progress||0;k=()=>y,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(_=>requestAnimationFrame(_)),h=Math.abs(1-k())}h=e.sidebarState==="closed"?h:1-h,o().style.setProperty("--backdrop-bg",`${h*.1}`),o()&&!o().open&&(o().showModal(),yr()&&o().getBoundingClientRect()),a.isSwiping=!0,a.duration=0,a.swipingRatio=h*-25;const p=h*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let m=e.sidebarState==="closed"?c:d;return e.sidebarState==="opened"||e.sidebarState==="closed"||(m=p),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:v,currentPosition:m,minPosition:c,maxPosition:d,width:e.dialogWidth}},onCancel:()=>{a.isSwiping=!1,e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:c,width:d})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const v=1-Math.abs(c/d)/7*10;o().style.transform=`translate3d(${c}px, 0, 0)`,a.swipingRatio=v*-25,o().style.setProperty("--backdrop-bg",`${v*.1}`)},onFinish:({swipeVelocity:c,currentPosition:d,initialPosition:v,width:h,actionThreshold:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let m="close";const k=Math.abs(d-v)/h*100/7*10;if(k===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(k===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?m=Math.abs(k)>p||c>da?"open":"close":e.sidebarState==="swipingClose"&&(m=Math.abs(k)>p&&c<=da||c<-da?"close":"open");let _=vl(Math.abs(k)/100);e.sidebarState==="swipingClose"&&m==="close"&&(_=1-_);const y=(m==="open"?1-_:_)*jn;a.duration=y/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),o().style.setProperty("--backdrop-bg",`${m==="open"?.1:0}`),m==="open"?e.onOpen():m==="close"&&e.onClose()}}),be()}var wf=S("<dialog><div><!> <!></div></dialog> <!> <!>",1);function yf(t,e){ye(e,!0);const{getSidebarState:a,setSidebarState:r}=Ar();let o=I(0);Pe(()=>{const z=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",z),z(),()=>{window.removeEventListener("resize",z)}});const s=Gn(),{isScrolling:i}=cs();let l=I(null),u=I(null),c={},d=x(a);const v=()=>{e.blocked||r("closing")},h=z=>{r(z==="open"?"swipingOpen":"swipingClose")},p=()=>{r("opened")},m=()=>{r("preOpening")},k=()=>{n(l)?.close(),r("closed")},_=z=>{z.preventDefault(),v()};Pe(()=>(n(l)?.addEventListener("close",k),n(l)?.addEventListener("cancel",_),()=>{n(l)?.removeEventListener("close",k),n(l)?.removeEventListener("cancel",_)}));const y=x(i);let E=x(()=>s.working);const w=z=>{z?(r("opened"),s.swipingRatio=-25):(r("closed"),s.swipingRatio=0,n(l)?.close()),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ca().duration};Ue(()=>{n(d)==="opening"?Ot(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=-25,n(l).style.removeProperty("--backdrop-bg");const z=n(l).style.transform||"translate3d(-100%, 0, 0)";n(l).style.transform="";const me=n(l)?.animate([{transform:z},{transform:"translate3d(0, 0, 0)"}],{duration:s.duration*1e3||jn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});c.current=me,me&&(me.onfinish=()=>{p(),s.swipingRatio=-25,n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ca().duration,me.cancel(),c.current=void 0})})}):n(d)==="closing"&&Ot(()=>{requestAnimationFrame(()=>{if(!n(l))return;s.swipingRatio=0,n(l).style.removeProperty("--backdrop-bg");const z=n(l).style.transform||"translate3d(0, 0, 0)";n(l).style.transform="";const me=n(l)?.animate([{transform:z},{transform:"translate3d(-100%, 0, 0)"}],{duration:s.duration*1e3||jn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});c.current=me,me&&(me.onfinish=()=>{k(),n(l)&&(n(l).style.removeProperty("--transition-timing-dialog"),n(l).style.removeProperty("--backdrop-bg")),s.duration=ca().duration,me.cancel(),c.current=void 0})})})}),Ue(()=>{n(d)==="preOpening"&&(n(l)?.open||(n(l)?.showModal(),yr()&&n(l)?.getBoundingClientRect()),r("opening"))}),Pe(()=>{n(d)==="opened"&&r("preOpening")});var b=wf(),T=P(b),X=C(T),U=C(X);He(U,()=>e.children);var q=A(U,2);{var R=z=>{go(z,{})};H(q,z=>{n(d)==="opened"&&z(R)})}$e(X,z=>f(u,z),()=>n(u)),$e(T,z=>f(l,z),()=>n(l));var ee=A(T,2);{var re=z=>{us(z,{get dialog(){return n(l)},get dialogInner(){return n(u)},onClose:v})};H(ee,z=>{n(u)&&n(d)==="opened"&&!e.blocked&&z(re)})}var Y=A(ee,2);{var F=z=>{_f(z,{onCancelSwipe:w,onOpen:m,onClose:v,onSwipe:h,get dialogWidth(){return n(o)},get animationRef(){return c},get dialog(){return n(l)},get sidebarState(){return n(d)}})};H(Y,z=>{!n(y)&&!e.blocked&&z(F)})}De(()=>{et(T,1,nt({a:!0,b:n(E),c:n(d)==="opened"||n(d)==="opening"||n(d)==="closing"||n(d)==="swipingClose",d:n(d)==="opened"||n(d)==="opening"||n(d)==="swipingOpen"}),"p-1gucilc"),et(X,1,nt({e:!0,f:n(d)==="swipingOpen",g:n(d)!=="opened"}),"p-1gucilc")}),g(t,b),be()}var bf=S('<div class="a p-1lsyiiu"><div class="b p-1lsyiiu"><!> <div class="c p-1lsyiiu"><a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <div class="e p-1lsyiiu"><!></div> <!></div> <!>',1),Cf=S('<div class="f p-1lsyiiu"><div class="e p-1lsyiiu"><!></div> <div class="g p-1lsyiiu"><div class="a p-1lsyiiu"><!></div> <!></div></div>');function Sf(t,e){ye(e,!0);const{checkMobileSize:a}=ga(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Ar(),{getDialogPages:i,createDialogPageHref:l,createHandleClickDialogPage:u}=zt(),{getTagsSearch:c,setTagsSearch:d}=vd(),{getSelectedTags:v,addTag:h,removeTag:p,clearTags:m}=Kn(),{getSelectedMetaTags:k,addMetaTag:_,removeMetaTag:y,clearSelectedMetaTags:E}=fo();let w=x(v),b=x(k);const{getGetNotes:T,checkNotesInArchive:X,checkNotesInBin:U}=At(),q=x(T),R=ge=>{h(ge)},ee=ge=>{_(ge)},re=ge=>{p(ge)},Y=ge=>{y(ge)};let F=x(()=>n(w).size===0&&!n(b).has(ot.INBOX)&&(n(q)()||[]).some(ge=>(!n(b).has(ot.ARCHIVED)&&!n(b).has(ot.BIN)&&ge?.data&&!ge.data.deletedAt&&!ge.data.archivedAt||n(b).has(ot.ARCHIVED)&&ge?.data&&!ge.data.deletedAt&&ge.data.archivedAt||n(b).has(ot.BIN)&&ge?.data&&ge.data.deletedAt)&&ge?.data?.tags.length===0)),z=x(()=>Xo(n(b),n(w),n(q)()||[],ge=>!(ge?.data&&(ge.data.deletedAt||ge.data.archivedAt)&&!n(b).has(ot.ARCHIVED)&&!n(b).has(ot.BIN)||ge?.data&&(ge.data.deletedAt||!ge.data.archivedAt)&&n(b).has(ot.ARCHIVED)||ge?.data&&!ge.data.deletedAt&&n(b).has(ot.BIN)))),me=x(()=>n(z).filter(ge=>c()===""||ge.toLowerCase().indexOf(c().toLowerCase())!==-1)),Se=x(a);const{checkExistedDialog:j}=Qt();let O=x(()=>i().length>0||j());const Q=()=>{if(n(Se)){if(n(O))return;o()==="opened"?r():o()==="closed"&&s()}};Pe(()=>br({key:"b",meta:!0,action:Q})),Pe(()=>br({key:"b",ctrl:!0,action:Q}));let ne=x(()=>[...n(F)&&n(b).size===0?[ot.INBOX]:[],...n(b).size===0?[...X()&&n(w).size===0?[ot.ARCHIVED]:[],...U()&&n(w).size===0?[ot.BIN]:[]]:[]].filter(ge=>c()===""||ge.toLowerCase().indexOf(c().toLowerCase())!==-1).sort((ge,ue)=>ge===ot.INBOX?-1:ue===ot.INBOX?1:ge.localeCompare(ue)));var ie=we(),se=P(ie);{var Ee=ge=>{yf(ge,{get blocked(){return n(O)},children:(ue,Ae)=>{var G=bf(),te=P(G),Ce=C(te),xe=C(Ce);fl(xe,{});var ce=A(xe,2),ae=C(ce),ke=x(()=>u(Te.Settings));ae.__click=function(...M){n(ke)?.apply(this,M)};var pe=C(ae);ve(pe,()=>({"--size":"24px"})),he(pe.lastChild,{name:"settings"});var Re=A(pe,2);_t(Re,{children:(M,D)=>{var L=Ke("Settings");g(M,L)}});var $=A(ae,2),_e=x(()=>u(Te.Sync));$.__click=function(...M){n(_e)?.apply(this,M)};var Be=C($);ve(Be,()=>({"--size":"24px"})),he(Be.lastChild,{name:"sync"});var Me=A(Be,2);_t(Me,{children:(M,D)=>{var L=Ke("Sync");g(M,L)}});var Je=A(Ce,2),N=C(Je);{let M=x(c);jo(N,{placeholder:"Search tag",get value(){return n(M)},onChange:D=>{d(D)}})}var W=A(Je,2);{let M=x(()=>n(b).has(ot.BIN));Is(W,{get clearTags(){return m},get clearMetaTags(){return E},get hideTagMenu(){return n(M)},handleMetaTagClick:Y,get metaTags(){return n(b)},get selectedTags(){return n(w)},handleSelectedTagClick:re})}var V=A(te,2);{let M=x(()=>n(b).has(ot.BIN));Ms(V,{get hideTagMenu(){return n(M)},get metaTags(){return n(ne)},get tags(){return n(me)},handleMetaTagClick:ee,handleTagClick:R,mobile:!0})}De((M,D)=>{dt(ae,"href",M),dt($,"href",D)},[()=>l(Te.Settings),()=>l(Te.Sync)]),g(ue,G)},$$slots:{default:!0}})},Le=ge=>{var ue=Cf(),Ae=C(ue),G=C(Ae);{let ae=x(c);jo(G,{placeholder:"Search tag",get value(){return n(ae)},onChange:ke=>{d(ke)}})}var te=A(Ae,2),Ce=C(te),xe=C(Ce);{let ae=x(()=>n(b).has(ot.BIN));Is(xe,{get metaTags(){return n(b)},get clearTags(){return m},get clearMetaTags(){return E},get hideTagMenu(){return n(ae)},get selectedTags(){return n(w)},handleMetaTagClick:Y,handleSelectedTagClick:re})}var ce=A(Ce,2);{let ae=x(()=>n(b).has(ot.BIN));Ms(ce,{get metaTags(){return n(ne)},get hideTagMenu(){return n(ae)},get tags(){return n(me)},handleMetaTagClick:ee,handleTagClick:R})}g(ge,ue)};H(se,ge=>{n(Se)?ge(Ee):ge(Le,!1)})}g(t,ie),be()}pt(["click"]);var kf=S('<button class="a p-tddkdb"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function xf(t,e){ye(e,!0);let a=Fe(e,"ref",15);var r=kf();r.__click=function(...i){e.onClick?.apply(this,i)};var o=C(r);ve(o,()=>({"--rotate":"-90deg"})),he(o.lastChild,{name:"menu"});var s=A(o,2);_t(s,{children:(i,l)=>{var u=Ke();De(()=>vt(u,e.title)),g(i,u)}}),$e(r,i=>a(i),()=>a()),g(t,r),be()}pt(["click"]);const Jo=t=>{try{new URL(t)}catch{return!1}return!0};var Tf=S('<div class="b p-z67y1l">Add tag for selected notes</div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Pf=S('<form class="a p-z67y1l"><!></form>');function Ef(t,e){ye(e,!0);const{addTag:a}=At(),{getSelectedTags:r}=Kn(),{getSelectedNotes:o}=fa(),{getFiltredNotes:s}=Ia();let i=I(!1),l=I(!1),u,c=!1,d=I(null),v=I(""),h=e.nextFocusRef;Pe(()=>(n(d)&&n(d).focus(),()=>{u&&clearTimeout(u)}));const p=()=>{u=setTimeout(()=>{f(l,!0)},250)},m=()=>{f(i,!0)},k=async()=>{if(r().has(n(v).trim())){m();return}if(n(v).trim()!=="")try{p();const w=new Set(o()),b=w.size?[...w]:s().map(X=>X.id),{cancel:T}=await a(n(v).trim(),b);tt("Tag added",{cancel:{nextFocusRef:h,onCancel:async()=>{await T(),setTimeout(()=>{const{prev:X}=bt(h);X?.focus()},16)}}}),c=!0}finally{f(i,!0)}},_=()=>{e.onClosed?.(c)},y=E=>{E.preventDefault(),k()};Dr(t,{get blocked(){return n(l)},get startClose(){return n(i)},onClosed:_,children:(E,w)=>{var b=Pf(),T=C(b);{var X=q=>{La(q,{})},U=q=>{var R=Tf(),ee=A(P(R),2);Cr(ee,{placeholder:"Enter new tag name",get ref(){return n(d)},set ref(z){f(d,z,!0)},get value(){return n(v)},set value(z){f(v,z,!0)}});var re=A(ee,2),Y=C(re);Rt(Y,{size:"small",onClick:m,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(z,me)=>{var Se=Ke("Cancel");g(z,Se)},$$slots:{default:!0}});var F=A(Y,2);Rt(F,{size:"small",onClick:k,fullWidth:!0,withoutMinWidth:!0,children:(z,me)=>{var Se=Ke("OK");g(z,Se)},$$slots:{default:!0}}),g(q,R)};H(T,q=>{n(l)?q(X):q(U,!1)})}Zt("submit",b,y),g(E,b)},$$slots:{default:!0}}),be()}var Nf=S('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Af=S('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Df=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Mf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),If=S("<div><!></div>"),Lf=S('<form class="c p-r3if1j"><div class="d p-r3if1j"><!></div> <button type="button" class="e p-r3if1j">Done</button></form>'),Rf=S('<div class="a"><div class="b p-r3if1j"><!> <!> <!> <!> <!> <!></div> <!></div>');function hl(t,e){ye(e,!0);const{isInitedNotes:a,getGetMapTags:r,getGetNotes:o}=At(),{getSelectedTags:s}=Kn();let i=I(null),l=I(""),u=I(null);const c=x(a);let d=Fe(e,"shownTagInput",15);const v=()=>n(c)?e.mode==="exit"?Xo(new Set,new Set(e.selectedTags),o()()||[]):[...r()().keys()]:[];let p=x(()=>{const O=s(),Q=new Set(Xo(new Set,new Set(e.selectedTags.length>0?e.selectedTags:O),o()()||[]));return v().filter(ie=>e.selectedTags.some(se=>ie===se)?!1:n(l)===""||ie.toLowerCase().indexOf(n(l).toLowerCase())===0).sort((ie,se)=>O.has(ie)&&O.has(se)?ie.localeCompare(se):O.has(ie)?-1:O.has(se)?1:Q.has(ie)&&Q.has(se)?ie.localeCompare(se):Q.has(ie)?-1:Q.has(se)?1:0)});const m=O=>{if(!e.selectedTags.includes(O)){if(e.mode!=="exit"||n(p).includes(O)){e.onChangeTags([...e.selectedTags,O]),f(l,"");return}n(i)?.focus()}},k=O=>{const Q=e.selectedTags.filter(ne=>ne!==O);e.onRejectedTag&&e.onRejectedTag(O),Q.length===0?e.onChangeTags([]):e.onChangeTags(Q)},_=O=>{O.preventDefault(),n(l)!==""?m(n(l)):d(!1)};Ue(()=>{n(i)&&d()&&n(i).focus(),d()||f(l,"")});const y=O=>{O.preventDefault()},E=O=>{O.preventDefault(),O.stopPropagation(),O.stopImmediatePropagation()};var w=Rf(),b=C(w),T=C(b);Bn(T,17,()=>e.selectedTags,O=>O+"-tags_selected",(O,Q)=>{ha(O,{onPointerDown:y,onTouchStart:E,onClick:()=>{k(n(Q))},type:"button",style:"selected",children:(ne,ie)=>{var se=Ke();De(()=>vt(se,n(Q))),g(ne,se)},$$slots:{default:!0}})});var X=A(T,2);{var U=O=>{var Q=we(),ne=P(Q);Bn(ne,17,()=>n(p).filter(ie=>ie.toLowerCase()!==n(l).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),ie=>ie+"-tags_suggested",(ie,se)=>{ha(ie,{onPointerDown:y,onTouchStart:E,onClick:()=>{m(n(se))},children:(Ee,Le)=>{var ge=Ke();De(()=>vt(ge,n(se))),g(Ee,ge)},$$slots:{default:!0}})}),g(O,Q)};H(X,O=>{d()&&O(U)})}var q=A(X,2);{var R=O=>{ha(O,{onPointerDown:y,onTouchStart:E,onClick:()=>{m(n(l)),f(l,"")},children:(Q,ne)=>{var ie=Ke();De(()=>vt(ie,n(l))),g(Q,ie)},$$slots:{default:!0}})};H(q,O=>{n(l)!==""&&(e.mode!=="exit"||n(p).find(Q=>Q.toLowerCase()===n(l).toLowerCase()))&&O(R)})}var ee=A(q,2);{var re=O=>{ha(O,{mode:"empty",onPointerDown:y,onTouchStart:E,onClick:()=>{d(!0)},children:(Q,ne)=>{var ie=Nf(),se=C(ie);ve(se,()=>({"--size":"12px"})),he(se.lastChild,{name:"plus"});var Ee=A(se,2);_t(Ee,{children:(Le,ge)=>{var ue=Ke("add tag");g(Le,ue)}}),g(Q,ie)},$$slots:{default:!0}})};H(ee,O=>{d()||O(re)})}var Y=A(ee,2);{var F=O=>{ha(O,{mode:"empty",onPointerDown:y,onTouchStart:E,get onClick(){return e.onUsePreviousTags},children:(Q,ne)=>{var ie=Af(),se=C(ie);ve(se,()=>({"--size":"12px"})),he(se.lastChild,{name:"back"});var Ee=A(se,2);_t(Ee,{children:(Le,ge)=>{var ue=Ke("use previous tags");g(Le,ue)}}),g(Q,ie)},$$slots:{default:!0}})};H(Y,O=>{e.previousTagsEnabled&&e.onUsePreviousTags&&O(F)})}var z=A(Y,2);{var me=O=>{ha(O,{mode:"empty",onPointerDown:y,onTouchStart:E,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:(Q,ne)=>{var ie=If(),se=C(ie);{var Ee=ge=>{var ue=Df(),Ae=P(ue);ve(Ae,()=>({"--size":"12px"})),La(Ae.lastChild,{}),g(ge,ue)},Le=ge=>{var ue=Mf(),Ae=P(ue);ve(Ae,()=>({"--size":"12px","--rotate":"180deg"})),he(Ae.lastChild,{name:"stars"});var G=A(Ae,2);_t(G,{children:(te,Ce)=>{var xe=Ke("gen tags");g(te,xe)}}),g(ge,ue)};H(se,ge=>{e.generatingTags?ge(Ee):ge(Le,!1)})}g(Q,ie)},$$slots:{default:!0}})};H(z,O=>{e.genTagsEnabled&&e.onGenTags&&O(me)})}var Se=A(b,2);{var j=O=>{var Q=Lf(),ne=C(Q),ie=C(ne);Cr(ie,{placeholder:"tag",get ref(){return n(i)},set ref(Ee){f(i,Ee,!0)},get value(){return n(l)},set value(Ee){f(l,Ee,!0)}});var se=A(ne,2);se.__pointerdown=y,se.__touchstart=E,se.__click=()=>{n(i)?.blur(),n(l)!==""&&m(n(l)),d(!1),f(l,"")},Zt("submit",Q,_),g(O,Q)};H(Se,O=>{d()&&O(j)})}$e(w,O=>f(u,O),()=>n(u)),g(t,w),be()}pt(["pointerdown","touchstart","click"]);var Ff=S('<div class="c p-z67y1l"><!> <!></div>'),Of=S('<div class="b p-z67y1l">Change tags for selected notes</div> <!> <!>',1),zf=S('<form class="a p-z67y1l"><!></form>');function Bf(t,e){ye(e,!0);const{changeTags:a,getNoteById:r}=At(),{getSelectedTags:o}=Kn(),{getSelectedNotes:s}=fa(),{getFiltredNotes:i}=Ia();let l=I(!1),u=I(!1),c,d=!1,v=I(!1),h=e.nextFocusRef,m=(()=>{const U=[...o()],q=s();if(q.size===0)return U;const R=Array.from(q);let ee=new Set(r(R[0])?.data.tags||[]);for(let re=1;re<R.length;re++){const Y=new Set(r(R[re])?.data.tags||[]),F=new Set([]);Y.forEach(z=>{ee.has(z)&&F.add(z)}),ee=F}return Array.from(ee)})(),k=I(ft(m));Pe(()=>()=>{c&&clearTimeout(c)});const _=()=>{c=setTimeout(()=>{f(u,!0)},250)},y=()=>{f(l,!0)},E=async()=>{const U=m,q=new Set(s()),R=q.size?[...q]:i().map(ee=>ee.id);try{_();const{cancel:ee}=await a([...U],n(k),R);tt("Tags changed",{cancel:{nextFocusRef:h,onCancel:async()=>{await ee(),setTimeout(()=>{const{prev:re}=bt(h);re?.focus()},16)}}}),d=!0}finally{f(l,!0)}},w=U=>{U.key==="Escape"&&n(v)&&(f(v,!1),U.preventDefault(),U.stopPropagation())};Pe(()=>(document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)));const b=()=>{e.onClosed?.(d)},T=U=>{f(k,U,!0)},X=U=>{U.preventDefault(),E()};Dr(t,{get blocked(){return n(u)},get startClose(){return n(l)},onClosed:b,children:(U,q)=>{var R=zf(),ee=C(R);{var re=F=>{La(F,{})},Y=F=>{var z=Of(),me=A(P(z),2);hl(me,{get selectedTags(){return n(k)},onChangeTags:T,get shownTagInput(){return n(v)},set shownTagInput(O){f(v,O,!0)}});var Se=A(me,2);{var j=O=>{var Q=Ff(),ne=C(Q);Rt(ne,{size:"small",onClick:y,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(se,Ee)=>{var Le=Ke("Cancel");g(se,Le)},$$slots:{default:!0}});var ie=A(ne,2);Rt(ie,{size:"small",onClick:E,fullWidth:!0,withoutMinWidth:!0,children:(se,Ee)=>{var Le=Ke("OK");g(se,Le)},$$slots:{default:!0}}),g(O,Q)};H(Se,O=>{n(v)||O(j)})}g(F,z)};H(ee,F=>{n(u)?F(re):F(Y,!1)})}Zt("submit",R,X),g(U,R)},$$slots:{default:!0}}),be()}var jf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),Hf=S('<li class="p-66dk2x"><!></li>'),Uf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),Wf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),Vf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),qf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),Kf=S('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),Gf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Yf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),Xf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),Jf=S('<li class="p-66dk2x"><!></li>'),Zf=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),Qf=S('<li class="p-66dk2x"><!></li>'),$f=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),ev=S('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <li class="p-66dk2x"><!></li>',1),tv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),nv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),av=S('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),rv=S('<!> <!> <li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <!> <!>',1),ov=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),sv=S('<div class="a p-66dk2x"><!></div> <!> <!> <!>',1);function iv(t,e){ye(e,!0);const{getSelectedTags:a,setSelectedTags:r,clearTags:o}=Kn(),{moveNotesToBin:s,moveNotesToArchive:i,moveNotesFromArchive:l,restoreNotesFromBin:u,deleteNotes:c}=At(),{getFiltredNotes:d}=Ia(),{getSelectedNotes:v,setSelectedNotes:h,clearNotes:p}=fa();let m=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),k=x(a),_=I(!1),y=I(!1),E=I(!1),w=I(!1),b=I(null),T=I(null);const X=()=>{n(_)||f(_,!0)},U=()=>{f(_,!1),f(y,!1)};Ue(()=>{!n(_)&&!n(E)&&!n(w)&&f(b,bt(n(T)).next,!0)}),Pe(()=>{const ce=ae=>{ae.key==="Escape"&&n(_)&&n(T)?.focus()};return window.addEventListener("keydown",ce),()=>{window.removeEventListener("keydown",ce)}});let q=()=>{};const R=()=>{f(y,!0),f(E,!0);let ce=n(T);q=()=>{f(E,!1),setTimeout(()=>{ce?.focus()},16)}};let ee=()=>{};const re=()=>{f(y,!0),f(w,!0);let ce=n(T);ee=()=>{f(w,!1),setTimeout(()=>{ce?.focus()},16)}},Y=async()=>{const ce=Array.from(n(k)),ae=new Set(v()),ke=ae.size?[...ae]:d().map(Re=>Re.id),{cancel:pe}=await s({noteIds:ke});o(),p(),tt("Notes moved to bin",{cancel:{nextFocusRef:n(b),onCancel:async()=>{await pe(),r(new Set(ce)),h(ae),setTimeout(()=>{const{prev:Re}=bt(n(b));Re?.focus()},16)}}}),f(y,!0)},F=async()=>{const ce=Array.from(n(k)),ae=new Set(v()),ke=ae.size?[...ae]:d().map(Re=>Re.id),{cancel:pe}=await i({noteIds:ke});o(),p(),tt("Notes moved to archive",{cancel:{nextFocusRef:n(b),onCancel:async()=>{await pe(),r(new Set(ce)),h(ae),setTimeout(()=>{const{prev:Re}=bt(n(b));Re?.focus()},16)}}}),f(y,!0)},z=async()=>{const ce=Array.from(n(k)),ae=new Set(v()),ke=ae.size?[...ae]:d().map(Re=>Re.id),{cancel:pe}=await l({noteIds:ke});o(),p(),tt("Notes moved from archive",{cancel:{nextFocusRef:n(b),onCancel:async()=>{await pe(),r(new Set(ce)),h(ae),setTimeout(()=>{const{prev:Re}=bt(n(b));Re?.focus()},16)}}}),f(y,!0)},me=async()=>{const ce=Array.from(n(k)),ae=new Set(v()),ke=ae.size?[...ae]:d().map(Re=>Re.id),{cancel:pe}=await u({noteIds:ke});o(),p(),tt("Notes restored",{cancel:{nextFocusRef:n(b),onCancel:async()=>{await pe(),r(new Set(ce)),h(ae),setTimeout(()=>{const{prev:Re}=bt(n(b));Re?.focus()},16)}}}),f(y,!0)},Se=()=>{const ce=new Set(v()),ae=ce.size?[...ce]:d().map(ke=>ke.id);f(y,!0),Va({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{f(y,!0),o(),p(),await c({noteIds:ae})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(T)?.focus()},16)}})},j=()=>{const ce=d(),ae=Array.from(v()),ke=[];for(const Re of ce)Re.data&&Re.data?.link&&Jo(Re.data?.link.url)&&(ae.includes(Re.id)||ae.length===0)&&ke.push(Re.data?.link.url);const pe=()=>{for(const Re of ke)if(!window.open(Re,"_blank")){Va({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(T)?.focus()},16)}});break}};ke.length<=10?pe():Va({title:`Are you sure to open ${ke.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{pe()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(T)?.focus()},16)}}),f(y,!0)},O=()=>{const ce=d(),ae=Array.from(v());let ke="";for(const pe of ce)pe.data&&pe.data?.link&&Jo(pe.data?.link.url)&&(ae.includes(pe.id)||ae.length===0)&&(ke+=pe.data?.link.url+`
`);navigator.clipboard.writeText(ke),tt("Copied links"),f(y,!0)},Q=()=>{const ce=d(),ae=Array.from(v());let ke="";for(const pe of ce)pe.data&&(ae.includes(pe.id)||ae.length===0)&&(pe.data?.link?.url&&(ke+=pe.data?.link.url+`
`),pe.data?.text&&(ke+=`
`+pe.data?.text+`
`),ke+=`---------------------

`);navigator.clipboard.writeText(ke),tt("Copied notes"),f(y,!0)},ne=()=>{const ce=d(),ae=Array.from(v());let ke="";for(const pe of ce)pe.data&&(ae.includes(pe.id)||ae.length===0)&&pe.data?.link?.url&&(ke+=pe.data?.link.url+`

`);navigator.share({text:ke}).catch(pe=>{pe.name!=="AbortError"&&console.error("Error sharing",pe)}),f(y,!0)},ie=()=>{const ce=d(),ae=Array.from(v());let ke="";for(const pe of ce)pe.data&&(ae.includes(pe.id)||ae.length===0)&&(pe.data?.link?.url&&(ke+=pe.data?.link.url+`
`),pe.data?.text&&(ke+=`
`+pe.data?.text+`
`),ke+=`---------------------

`);navigator.share({text:ke}).catch(pe=>{pe.name!=="AbortError"&&console.error("Error sharing",pe)}),f(y,!0)};let se=Tn||Wn;var Ee=sv(),Le=P(Ee),ge=C(Le);xf(ge,{title:"notes menu",onClick:X,get ref(){return n(T)},set ref(ce){f(T,ce,!0)}});var ue=A(Le,2);{var Ae=ce=>{var ae=ov(),ke=P(ae);ve(ke,()=>({"--right":"0","--top":"44px"})),Mr(ke.lastChild,{get startClose(){return n(y)},onClosed:U,get isMobile(){return se},children:(pe,Re)=>{var $=rv(),_e=P($);{var Be=B=>{var Z=Hf(),oe=C(Z);We(oe,{onClick:j,get dialogMode(){return se},children:(de,Ne)=>{var Ve=jf(),Ie=P(Ve);ve(Ie,()=>({"--size":"20px","--scale":"0.9"})),he(Ie.lastChild,{name:"open"}),g(de,Ve)},$$slots:{default:!0}}),g(B,Z)};H(_e,B=>{Tn||Wn||B(Be)})}var Me=A(_e,2);H(Me,B=>{});var Je=A(Me,2),N=C(Je);We(N,{onClick:Q,get dialogMode(){return se},children:(B,Z)=>{var oe=Uf(),de=P(oe);ve(de,()=>({"--size":"20px"})),he(de.lastChild,{name:"copy"}),g(B,oe)},$$slots:{default:!0}});var W=A(Je,2),V=C(W);We(V,{onClick:O,get dialogMode(){return se},children:(B,Z)=>{var oe=Wf(),de=P(oe);ve(de,()=>({"--size":"20px"})),he(de.lastChild,{name:""}),g(B,oe)},$$slots:{default:!0}});var M=A(W,2);{var D=B=>{var Z=Kf(),oe=P(Z),de=C(oe);We(de,{onClick:ie,get dialogMode(){return se},children:(Ie,Oe)=>{var ze=Vf(),je=P(ze);ve(je,()=>({"--size":"20px"})),he(je.lastChild,{name:"share"}),g(Ie,ze)},$$slots:{default:!0}});var Ne=A(oe,2),Ve=C(Ne);We(Ve,{onClick:ne,get dialogMode(){return se},children:(Ie,Oe)=>{var ze=qf(),je=P(ze);ve(je,()=>({"--size":"20px"})),he(je.lastChild,{name:""}),g(Ie,ze)},$$slots:{default:!0}}),g(B,Z)};H(M,B=>{m&&B(D)})}var L=A(M,2);{var le=B=>{var Z=ev(),oe=P(Z),de=C(oe);We(de,{onClick:R,get dialogMode(){return se},children:(at,st)=>{var lt=Gf(),mt=P(lt);ve(mt,()=>({"--size":"20px"})),he(mt.lastChild,{name:"add"}),g(at,lt)},$$slots:{default:!0}});var Ne=A(oe,2),Ve=C(Ne);We(Ve,{onClick:re,get dialogMode(){return se},children:(at,st)=>{var lt=Yf(),mt=P(lt);ve(mt,()=>({"--size":"20px"})),he(mt.lastChild,{name:""}),g(at,lt)},$$slots:{default:!0}});var Ie=A(Ne,2);{var Oe=at=>{var st=Jf(),lt=C(st);We(lt,{onClick:F,get dialogMode(){return se},children:(mt,En)=>{var Tt=Xf(),Dt=P(Tt);ve(Dt,()=>({"--size":"20px","--scale":"0.9"})),he(Dt.lastChild,{name:"archive"}),g(mt,Tt)},$$slots:{default:!0}}),g(at,st)},ze=at=>{var st=Qf(),lt=C(st);We(lt,{onClick:z,get dialogMode(){return se},children:(mt,En)=>{var Tt=Zf(),Dt=P(Tt);ve(Dt,()=>({"--size":"20px","--scale":"0.9"})),he(Dt.lastChild,{name:"archive-cancel"}),g(mt,Tt)},$$slots:{default:!0}}),g(at,st)};H(Ie,at=>{e.mode==="notes"?at(Oe):at(ze,!1)})}var je=A(Ie,2),wt=C(je);We(wt,{onClick:Y,get dialogMode(){return se},children:(at,st)=>{var lt=$f(),mt=P(lt);ve(mt,()=>({"--size":"20px"})),he(mt.lastChild,{name:"bin"}),g(at,lt)},$$slots:{default:!0}}),g(B,Z)};H(L,B=>{(e.mode==="notes"||e.mode==="archive")&&B(le)})}var J=A(L,2);{var fe=B=>{var Z=av(),oe=P(Z),de=C(oe);We(de,{onClick:me,get dialogMode(){return se},children:(Ie,Oe)=>{var ze=tv(),je=P(ze);ve(je,()=>({"--size":"20px"})),he(je.lastChild,{name:"bin-cancel"}),g(Ie,ze)},$$slots:{default:!0}});var Ne=A(oe,2),Ve=C(Ne);We(Ve,{onClick:Se,get dialogMode(){return se},dangerous:!0,children:(Ie,Oe)=>{var ze=nv(),je=P(ze);ve(je,()=>({"--size":"20px"})),he(je.lastChild,{name:"bin"}),g(Ie,ze)},$$slots:{default:!0}}),g(B,Z)};H(J,B=>{e.mode==="bin"&&B(fe)})}g(pe,$)},$$slots:{default:!0}}),g(ce,ae)};H(ue,ce=>{n(_)&&ce(Ae)})}var G=A(ue,2);{var te=ce=>{Ef(ce,{get nextFocusRef(){return n(b)},onClosed:ae=>{q(ae)}})};H(G,ce=>{n(E)&&ce(te)})}var Ce=A(G,2);{var xe=ce=>{Bf(ce,{get nextFocusRef(){return n(b)},onClosed:ae=>{ee(ae)}})};H(Ce,ce=>{n(w)&&ce(xe)})}g(t,Ee),be()}var lv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),cv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),dv=S('<li class="p-1ljon4s"><!></li>'),uv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),fv=S('<li class="p-1ljon4s"><!></li>'),vv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),gv=S('<li class="p-1ljon4s"><!></li>'),hv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),pv=S('<li class="p-1ljon4s"><!></li>'),mv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),_v=S('<li class="p-1ljon4s"><!></li>'),wv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),yv=S('<li class="p-1ljon4s"><!></li>'),bv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Cv=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),Sv=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),kv=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),xv=S(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Tv=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Pv=S('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!> <!>',1),Ev=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Nv(t,e){ye(e,!0);const{checkMobileSize:a}=ga(),{getMode:r,getSelectedNotes:o,changeMode:s,addNote:i}=fa(),{clearDialogPages:l}=zt(),{setFeedSearch:u}=Na(),{moveNoteToBin:c,moveNoteFromArchive:d,moveNoteToArchive:v,deleteNote:h,pinNote:p,restoreNoteFromBin:m,checkDuplicatesExist:k}=At();let _=Fe(e,"mode",3,"notes"),y=Fe(e,"shownMenu",15),E=I(!1),w=I(!1),b=I(!1),T=I(!1),X=I(!1),U=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const q=async()=>{c(e.noteId),tt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{m(e.noteId)}}})},R=async()=>{v(e.noteId),tt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(e.noteId)}}})},ee=async()=>{d(e.noteId),tt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{v(e.noteId)}}})},re=()=>{m(e.noteId),tt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{c(e.noteId)}}})},Y=()=>{e.noteData.pinned?(p(e.noteId,!1),tt("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!0)}}})):(p(e.noteId,!0),tt("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{p(e.noteId,!1)}}})),f(E,!0)},F=()=>{n(w)?(f(w,!1),q()):n(X)?(f(X,!1),re()):n(b)?(f(b,!1),R()):n(T)&&(f(T,!1),ee()),y(!1),f(E,!1)},z=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),tt("Copied link"),f(E,!0))},me=()=>{let ue="";e.noteData.link?.url&&(ue+=e.noteData.link.url+`
`),e.noteData.text&&(ue+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(ue),tt("Copied"),f(E,!0)},Se=()=>{f(E,!0),Va({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await h(e.noteId)},onCancel:async()=>{}})},j=()=>{if(navigator.share){const ue={};let Ae="";e.noteData.link?.url&&(Ae+=e.noteData.link.url+`
`),e.noteData.text&&(Ae+=`
`+e.noteData.text+`
`),ue.text=Ae,navigator.share(ue).catch(G=>{G.name!=="AbortError"&&console.error("Error sharing",G)})}f(E,!0)},O=()=>{if(navigator.share){const ue={};e.noteData.link?.url&&(ue.url=e.noteData.link.url),e.noteData.link?.title&&(ue.title=e.noteData.link.title),navigator.share(ue).catch(Ae=>{Ae.name!=="AbortError"&&console.error("Error sharing",Ae)})}f(E,!0)},Q=()=>{f(E,!0),e.noteData.link?.url&&(l(),u(e.noteData.link?.url+"$"))};let ne=Tn||Wn,ie=x(a),se=x(()=>r()==="multiple"&&o().has(e.noteId));var Ee=we(),Le=P(Ee);{var ge=ue=>{var Ae=Ev(),G=P(Ae);ve(G,()=>({"--bottom":e.showMenuUp?"calc(100%)":"auto","--top":e.showMenuUp?"auto":"calc(100%)","--right":"10px"})),Mr(G.lastChild,{get startClose(){return n(E)},onClosed:F,get isMobile(){return ne},children:(te,Ce)=>{var xe=Pv(),ce=P(xe),ae=C(ce);We(ae,{onClick:Y,get dialogMode(){return ne},children:(J,fe)=>{var B=lv(),Z=P(B);{let de=x(()=>e.noteData.pinned?"pin-cancel":"pin");ve(Z,()=>({"--size":"20px"})),he(Z.lastChild,{get name(){return n(de)}})}var oe=A(Z);De(()=>vt(oe,` ${e.noteData.pinned?"Unpin":"Pin"}`)),g(J,B)},$$slots:{default:!0}});var ke=A(ce,2);{var pe=J=>{var fe=dv(),B=C(fe);We(B,{onClick:me,get dialogMode(){return ne},children:(Z,oe)=>{var de=cv(),Ne=P(de);ve(Ne,()=>({"--size":"20px"})),he(Ne.lastChild,{name:"copy"}),g(Z,de)},$$slots:{default:!0}}),g(J,fe)};H(ke,J=>{e.noteData.text&&J(pe)})}var Re=A(ke,2);{var $=J=>{var fe=fv(),B=C(fe);We(B,{onClick:z,get dialogMode(){return ne},children:(Z,oe)=>{var de=uv(),Ne=P(de);ve(Ne,()=>({"--size":"20px"})),he(Ne.lastChild,{name:"copy"}),g(Z,de)},$$slots:{default:!0}}),g(J,fe)};H(Re,J=>{n(ie)&&e.noteData.link?.url&&J($)})}var _e=A(Re,2);{var Be=J=>{var fe=gv(),B=C(fe);We(B,{onClick:j,get dialogMode(){return ne},children:(Z,oe)=>{var de=vv(),Ne=P(de);ve(Ne,()=>({"--size":"20px"})),he(Ne.lastChild,{name:"share"}),g(Z,de)},$$slots:{default:!0}}),g(J,fe)};H(_e,J=>{U&&e.noteData.text&&J(Be)})}var Me=A(_e,2);{var Je=J=>{var fe=pv(),B=C(fe);We(B,{onClick:O,get dialogMode(){return ne},children:(Z,oe)=>{var de=hv(),Ne=P(de);{let Ve=x(()=>e.noteData.text?"":"share");ve(Ne,()=>({"--size":"20px"})),he(Ne.lastChild,{get name(){return n(Ve)}})}g(Z,de)},$$slots:{default:!0}}),g(J,fe)};H(Me,J=>{U&&e.noteData.link?.url&&J(Je)})}var N=A(Me,2);{var W=J=>{var fe=_v(),B=C(fe);We(B,{onClick:()=>{f(E,!0),r()!=="multiple"&&s("multiple"),i(e.noteId)},get dialogMode(){return ne},children:(Z,oe)=>{var de=mv(),Ne=P(de);ve(Ne,()=>({"--size":"20px"})),he(Ne.lastChild,{name:"check"}),g(Z,de)},$$slots:{default:!0}}),g(J,fe)};H(N,J=>{n(se)||J(W)})}var V=A(N,2);{var M=J=>{var fe=yv(),B=C(fe);We(B,{onClick:Q,get dialogMode(){return ne},children:(Z,oe)=>{var de=wv(),Ne=P(de);ve(Ne,()=>({"--size":"20px"})),he(Ne.lastChild,{name:""}),g(Z,de)},$$slots:{default:!0}}),g(J,fe)};H(V,J=>{e.noteData.link?.url&&k(e.noteId)&&J(M)})}var D=A(V,2);{var L=J=>{var fe=Sv(),B=P(fe),Z=C(B);We(Z,{onClick:()=>{f(b,_()==="notes"),f(T,_()==="archive"),f(E,!0)},get dialogMode(){return ne},children:(Ne,Ve)=>{var Ie=bv(),Oe=P(Ie);{let je=x(()=>_()==="archive"?"archive-cancel":"archive");ve(Oe,()=>({"--size":"20px","--scale":"0.9"})),he(Oe.lastChild,{get name(){return n(je)}})}var ze=A(Oe);De(()=>vt(ze,` ${_()==="archive"?"Unarchive":"Archive"}`)),g(Ne,Ie)},$$slots:{default:!0}});var oe=A(B,2),de=C(oe);We(de,{onClick:()=>{f(w,!0),f(E,!0)},get dialogMode(){return ne},children:(Ne,Ve)=>{var Ie=Cv(),Oe=P(Ie),ze=C(Oe);ve(ze,()=>({"--size":"20px"})),he(ze.lastChild,{name:"bin"}),g(Ne,Ie)},$$slots:{default:!0}}),g(J,fe)},le=J=>{var fe=Tv(),B=P(fe),Z=C(B);We(Z,{onClick:()=>{f(X,!0),f(E,!0)},get dialogMode(){return ne},children:(Ne,Ve)=>{var Ie=kv(),Oe=P(Ie),ze=C(Oe);ve(ze,()=>({"--size":"20px"})),he(ze.lastChild,{name:"bin-cancel"}),g(Ne,Ie)},$$slots:{default:!0}});var oe=A(B,2),de=C(oe);We(de,{onClick:Se,get dialogMode(){return ne},dangerous:!0,children:(Ne,Ve)=>{var Ie=xv(),Oe=P(Ie),ze=C(Oe);ve(ze,()=>({"--size":"20px"})),he(ze.lastChild,{name:"bin"}),g(Ne,Ie)},$$slots:{default:!0}}),g(J,fe)};H(D,J=>{_()==="notes"||_()==="archive"?J(L):J(le,!1)})}g(te,xe)},$$slots:{default:!0}}),g(ue,Ae)};H(Le,ue=>{y()&&ue(ge)})}g(t,Ee),be()}var Av=S('<div class="a p-1hg9kpf"></div>'),Dv=S('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function pl(t,e){ye(e,!0);const a=c=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(c).host}.ico`}catch{return""}};let r=I(!1),o=x(()=>a(e.url));var s=we(),i=P(s);{var l=c=>{var d=Av();g(c,d)},u=c=>{var d=Dv();De(v=>dt(d,"src",v),[()=>a(e.url)]),Zt("error",d,()=>{f(r,!0)}),g(c,d)};H(i,c=>{n(r)||!n(o)?c(l):c(u,!1)})}g(t,s),be()}var Mv=S('<a target="_blank" rel="noopener noreferrer"><!> <!></a>'),Iv=S("<button><!> <!></button>");function ln(t,e){ye(e,!0);let a=Fe(e,"tabindex",3,0),r=Fe(e,"onclick",3,()=>{}),o=Fe(e,"ref",15),s=Fe(e,"disabled",3,!1);var i=we(),l=P(i);{var u=d=>{var v=Mv();v.__click=function(...m){r()?.apply(this,m)};var h=C(v);He(h,()=>e.children);var p=A(h,2);_t(p,{children:(m,k)=>{var _=Ke();De(()=>vt(_,e.title)),g(m,_)}}),$e(v,m=>o(m),()=>o()),De(()=>{dt(v,"href",e.href),dt(v,"tabindex",s()?-1:a()),et(v,1,nt({a:!0,b:s()}),"p-62et9t")}),g(d,v)},c=d=>{var v=we(),h=P(v);{var p=m=>{var k=Iv();k.__click=function(...E){r()?.apply(this,E)};var _=C(k);He(_,()=>e.children);var y=A(_,2);_t(y,{children:(E,w)=>{var b=Ke();De(()=>vt(b,e.title)),g(E,b)}}),$e(k,E=>o(E),()=>o()),De(()=>{dt(k,"tabindex",s()?-1:a()),et(k,1,nt({a:!0,b:s()}),"p-62et9t"),k.disabled=s()}),g(m,k)};H(h,m=>{e.elem==="button"&&m(p)},!0)}g(d,v)};H(l,d=>{e.elem==="a"?d(u):d(c,!1)})}g(t,i),be()}pt(["click"]);let ho=I(!1),po=I(!1),Cn=I(void 0),Jr={};const Lv=()=>{Tn||Wn||f(po,!0)},Rv=()=>{f(po,!1)},Zo=()=>{Tn||Wn||f(ho,!0)},Fv=()=>{f(ho,!1)},Ov=()=>n(po),ml=()=>n(ho),vn=t=>{Tn||Wn||f(Cn,t,!0)},qr=()=>n(Cn),Fs=()=>{const t=Jr[n(Cn)||""]?.next;if(t)return f(Cn,t,!0),t},Os=()=>{const t=Jr[n(Cn)||""]?.prev;if(t)return f(Cn,t,!0),t};var zv=S('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),Bv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),jv=S('<div class="b p-rxwzp0"><!></div>'),Hv=S('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Uv=S('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Wv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Vv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),qv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Kv=S("<!> <!>",1),Gv=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Yv=S("<li><!> <!> <!> <div><!> <!> <!></div> <!></li>");function Xv(t,e){ye(e,!0);const{pushDialogPage:a}=zt(),{getFaviconEnabled:r,getRecordMode:o}=Hn(),{getMode:s,getSelectedNotes:i,addNote:l,removeNote:u}=fa(),{getSearchParams:c,getHref:d}=Bt();let v=Fe(e,"mode",3,"notes"),h="unknown";Ue(()=>(Jr[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete Jr[e.noteId]}));let p=I(!1),m=I(!1),k=x(r),_=x(o),y=I(null),E=I(null),w=I(null);const{checkMobileSize:b}=ga(),T=()=>{f(p,!0)},X=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),tt("Copied link"))};Ue(()=>{n(Cn)===e.noteId?f(m,!0):f(m,!1)});const U=G=>{G.preventDefault(),a(`${Te.Note}?id=${encodeURIComponent(e.noteId)}`)},q=x(()=>e.noteData.link?.url||"");let R=x(()=>n(p)&&n(y)?bt(n(y)).next:null);const ee=G=>{G?l(e.noteId):u(e.noteId)},re=()=>{const G=new URLSearchParams(c());return G.set(tn,`${Te.Note}?id=${encodeURIComponent(e.noteId)}`),d(G)};let Y=x(()=>s()==="multiple"&&i().has(e.noteId));Pe(()=>{const G=te=>{if(h="keyboard",n(Cn)===e.noteId&&(te.key==="Enter"&&n(po)&&(n(_)==="note"?(te.preventDefault(),setTimeout(()=>{a(`${Te.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(_)==="bookmark"&&n(q)&&window.open(n(q),"_blank","noopener")),te.key==="Tab"&&n(ho)&&(Fv(),n(w)))){const Ce=bt(n(w));te.shiftKey?Ce.prev?.focus():Ce?.next?.focus()}};return document.addEventListener("keydown",G),()=>{document.removeEventListener("keydown",G)}});var F=Yv();F.__focusin=()=>{h==="keyboard"&&f(Cn,e.noteId,!0)};var z=C(F);{var me=G=>{var te=zv(),Ce=C(te);ve(Ce,()=>({"--size":"18px"})),he(Ce.lastChild,{name:"pin"}),g(G,te)};H(z,G=>{e.noteData.pinned&&G(me)})}var Se=A(z,2);{var j=G=>{var te=jv(),Ce=C(te);{var xe=ae=>{pl(ae,{get url(){return n(q)}})},ce=ae=>{var ke=Bv(),pe=P(ke);ve(pe,()=>({"--size":"16px"})),he(pe.lastChild,{name:"note"}),g(ae,ke)};H(Ce,ae=>{n(q)?ae(xe):ae(ce,!1)})}g(G,te)};H(Se,G=>{n(k)&&G(j)})}var O=A(Se,2);{var Q=G=>{var te=Hv();te.__keydown=xe=>{xe.key==="Enter"&&(h="keyboard")},te.__mousedown=()=>{h="mouse"},te.__click=xe=>{h==="mouse"&&vn(void 0),xe.preventDefault(),s()==="multiple"?ee(!n(Y)):U(xe)};var Ce=C(te);$e(te,xe=>f(w,xe),()=>n(w)),De((xe,ce)=>{dt(te,"tabindex",e.focusHidden?-1:0),dt(te,"href",xe),vt(Ce,ce)},[re,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Zt("focus",te,()=>{}),g(G,te)},ne=G=>{var te=Uv();te.__keydown=xe=>{xe.key==="Enter"&&(h="keyboard")},te.__mousedown=()=>{h="mouse"},te.__click=xe=>{s()==="multiple"&&(xe.preventDefault(),ee(!n(Y)))};var Ce=C(te);$e(te,xe=>f(w,xe),()=>n(w)),De(xe=>{dt(te,"tabindex",e.focusHidden?-1:0),dt(te,"href",n(q)),vt(Ce,xe)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Zt("focus",te,()=>{}),g(G,te)};H(O,G=>{n(_)==="note"||!n(q)?G(Q):G(ne,!1)})}var ie=A(O,2),se=C(ie);{var Ee=G=>{{let te=x(re),Ce=x(()=>e.focusHidden?-1:0);ln(G,{title:"edit",elem:"a",get href(){return n(te)},get tabindex(){return n(Ce)},onclick:U,children:(xe,ce)=>{var ae=Wv(),ke=P(ae);ve(ke,()=>({"--size":"18px"})),he(ke.lastChild,{name:"pen"}),g(xe,ae)},$$slots:{default:!0}})}};H(se,G=>{(n(_)==="bookmark"||s()==="multiple")&&G(Ee)})}var Le=A(se,2);{var ge=G=>{var te=Kv(),Ce=P(te);{var xe=ke=>{{let pe=x(()=>e.focusHidden?-1:0),Re=x(()=>e.noteData.link?.title||"unknown");ln(ke,{elem:"a",get href(){return n(q)},get tabindex(){return n(pe)},get title(){return n(Re)},children:($,_e)=>{var Be=Vv(),Me=P(Be);ve(Me,()=>({"--size":"18px"})),he(Me.lastChild,{name:"open"}),g($,Be)},$$slots:{default:!0}})}};H(Ce,ke=>{(n(_)==="note"||s()==="multiple")&&ke(xe)})}var ce=A(Ce,2);{var ae=ke=>{{let pe=x(()=>e.focusHidden?-1:0);ln(ke,{elem:"button",onclick:X,get tabindex(){return n(pe)},title:"copy link",children:(Re,$)=>{var _e=qv(),Be=P(_e);ve(Be,()=>({"--size":"20px"})),he(Be.lastChild,{name:"copy"}),g(Re,_e)},$$slots:{default:!0}})}};H(ce,ke=>{b()||ke(ae)})}g(G,te)};H(Le,G=>{n(q)&&G(ge)})}var ue=A(Le,2);{let G=x(()=>e.focusHidden?-1:0);ln(ue,{title:"show menu",elem:"button",get tabindex(){return n(G)},onclick:T,get ref(){return n(y)},set ref(te){f(y,te,!0)},children:(te,Ce)=>{var xe=Gv(),ce=P(xe);ve(ce,()=>({"--size":"18px","--rotate":"90deg"})),he(ce.lastChild,{name:"menu"}),g(te,xe)},$$slots:{default:!0}})}var Ae=A(ie,2);Nv(Ae,{get nextFocusRef(){return n(R)},get mode(){return v()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(p)},set shownMenu(G){f(p,G,!0)}}),$e(F,G=>f(E,G),()=>n(E)),De(()=>{et(F,1,nt({d:!0,e:n(m),f:n(Y)||n(Cn)===e.noteId}),"p-rxwzp0"),et(ie,1,nt({g:!0,h:n(m)}),"p-rxwzp0")}),g(t,F),be()}pt(["focusin","keydown","mousedown","click"]);var Jv=S('<div class="g e p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),Zv=S('<div class="g p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),Qv=S('<a class="i j p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),$v=S('<div class="h p-12ns0yc"><!> <!></div>'),eg=S('<!> <div class="q p-12ns0yc"><!></div>',1),tg=S('<button class="u p-12ns0yc">All</button>'),ng=S('<button class="u p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),ag=S('<div class="s p-12ns0yc"><div class="t p-12ns0yc"><!> <span> </span> <!></div> <button class="u v p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),rg=S('<div class="a p-12ns0yc"><div class="b p-12ns0yc"><div class="c p-12ns0yc"><a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-12ns0yc"><!></div> <div class="f p-12ns0yc"><!></div></div> <div class="k p-12ns0yc"><div class="l p-12ns0yc"><!></div> <div class="m p-12ns0yc"><div class="n p-12ns0yc"><div class="o p-12ns0yc"><!></div> <div class="p p-12ns0yc"><!></div></div> <div class="r p-12ns0yc"><!></div></div></div></div>');function og(t,e){ye(e,!0);const{getFeedSearch:a,setFeedSearch:r}=Na(),{getScrollContainer:o}=vo();let s=x(o);const{emptyBin:i,checkNotesInBin:l,checkNotesInArchive:u,checkNotes:c}=At(),{replaceSearchParams:d}=Bt(),{createDialogPageHref:v,createHandleClickDialogPage:h,getDialogPages:p}=zt(),{checkExistedDialog:m}=Qt(),{getMode:k,clearNotes:_,setSelectedNotes:y,getSelectedNotes:E,changeMode:w}=fa(),{checkMobileSize:b}=ga(),{getFiltredNotes:T}=Ia(),{getSelectedMetaTags:X}=fo(),{getViewMode:U}=Hn();let q=x(X),R=I(null);const ee=x(l);let Y=x(()=>{const M=T()||[],D=E();return M.every(L=>D.has(L.id))});const F=()=>{Va({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await i(),d("")},onCancel:async()=>{}})};let z=x(()=>p().length===0);Ue(()=>{n(z)});const me=()=>{p().length===0&&!m()&&n(R)?.focus()};Pe(()=>br({key:"k",meta:!0,action:me})),Pe(()=>br({key:"k",ctrl:!0,action:me})),Pe(()=>{}),Ue(()=>{const M=T()||[];Ot(()=>{const D=E();y(new Set(M.filter(L=>D.has(L.id)).map(L=>L.id)))})});let Se=x(()=>n(q).has(ot.ARCHIVED)?"archive":n(q).has(ot.BIN)?"bin":"notes");Pe(()=>{n(R)&&n(R).addEventListener("keydown",M=>{M.key==="Tab"&&qr()&&M.preventDefault()})}),Ue(()=>{ml()&&setTimeout(()=>{n(R)?.focus(),n(R)?.setSelectionRange(n(R).value.length,n(R).value.length)},0)}),Pe(()=>{});var j=rg(),O=C(j),Q=C(O),ne=C(Q),ie=x(()=>h(Te.Settings));ne.__click=function(...M){n(ie)?.apply(this,M)};var se=C(ne);ve(se,()=>({"--rotate":"30deg","--size":"20px"})),he(se.lastChild,{name:"settings"});var Ee=A(ne,2),Le=x(()=>h(Te.Sync));Ee.__click=function(...M){n(Le)?.apply(this,M)};var ge=C(Ee);ve(ge,()=>({"--size":"20px"})),he(ge.lastChild,{name:"sync"});var ue=A(Q,2),Ae=C(ue);fl(Ae,{});var G=A(ue,2),te=C(G);{var Ce=M=>{var D=we(),L=P(D);{var le=J=>{var fe=we(),B=P(fe);{var Z=de=>{var Ne=Jv(),Ve=C(Ne);Ve.__click=F;var Ie=C(Ve);ve(Ie,()=>({"--scale":"1.2","--size":"20px"})),he(Ie.lastChild,{name:"clear"});var Oe=A(Ie);_t(Oe,{children:(ze,je)=>{var wt=Ke("Empty bin");g(ze,wt)}}),g(de,Ne)},oe=de=>{var Ne=Zv(),Ve=C(Ne);Ve.__click=F;var Ie=C(Ve);ve(Ie,()=>({"--scale":"0.9","--size":"20px"})),he(Ie.lastChild,{name:"clear"}),g(de,Ne)};H(B,de=>{b()?de(Z):de(oe,!1)})}g(J,fe)};H(L,J=>{n(ee)&&J(le)})}g(M,D)},xe=M=>{var D=we(),L=P(D);{var le=J=>{var fe=$v(),B=C(fe);{var Z=de=>{var Ne=Qv();Ne.__click=function(...Oe){e.onOpenWindow?.apply(this,Oe)};var Ve=C(Ne);ve(Ve,()=>({"--scale":"0.7","--size":"26px"})),he(Ve.lastChild,{name:"open-window"});var Ie=A(Ve,2);_t(Ie,{children:(Oe,ze)=>{var je=Ke("open window");g(Oe,je)}}),De(()=>dt(Ne,"href",e.openWindowHref)),g(de,Ne)};H(B,de=>{e.onOpenWindow&&de(Z)})}var oe=A(B,2);Uu(oe,{}),g(J,fe)};H(L,J=>{n(Se)==="notes"&&J(le)},!0)}g(M,D)};H(te,M=>{n(Se)==="bin"?M(Ce):M(xe,!1)})}var ce=A(O,2),ae=C(ce),ke=C(ae);Sf(ke,{});var pe=A(ae,2),Re=C(pe),$=C(Re),_e=C($);{let M=x(a);jo(_e,{placeholder:"Search",onFocus:()=>{Tn||Wn||(Lv(),Zo(),n(R)?.setSelectionRange(n(R).value.length,n(R).value.length))},onBlur:()=>{Rv()},get value(){return n(M)},onChange:D=>{vn(void 0),n(s)&&n(s).scrollTo({top:0}),r(D)},onEscape:()=>{vn(void 0)},get ref(){return n(R)},set ref(D){f(R,D,!0)}})}var Be=A($,2),Me=C(Be);{var Je=M=>{var D=eg(),L=P(D);Lu(L,{});var le=A(L,2),J=C(le);iv(J,{get mode(){return n(Se)}}),g(M,D)};H(Me,M=>{(n(Se)==="notes"&&c()||n(Se)==="bin"&&l()||n(Se)==="archive"&&u())&&M(Je)})}var N=A(Re,2),W=C(N);{var V=M=>{var D=we(),L=P(D);{var le=J=>{var fe=ag(),B=C(fe),Z=C(B);{var oe=je=>{var wt=tg();wt.__click=at=>{at.preventDefault();const st=T()||[];y(new Set(st.map(lt=>lt.id)))},g(je,wt)};H(Z,je=>{n(Y)||je(oe)})}var de=A(Z,2),Ne=C(de),Ve=A(de,2);{var Ie=je=>{var wt=ng();wt.__click=st=>{st.preventDefault(),_()};var at=C(wt);ve(at,()=>({"--size":"16px"})),he(at.lastChild,{name:"close"}),g(je,wt)};H(Ve,je=>{E().size>0&&je(Ie)})}var Oe=A(B,2);Oe.__click=je=>{je.preventDefault(),w("single")};var ze=C(Oe);ve(ze,()=>({"--size":"16px"})),he(ze.lastChild,{name:"close"}),De(je=>vt(Ne,`Selected ${je??""}`),[()=>E().size]),g(J,fe)};H(L,J=>{k()==="multiple"&&J(le)})}g(M,D)};H(W,M=>{(n(Se)==="notes"&&c()||n(Se)==="bin"&&l()||n(Se)==="archive"&&u())&&M(V)})}De((M,D)=>{dt(ne,"href",M),dt(Ee,"href",D)},[()=>v(Te.Settings),()=>v(Te.Sync)]),g(t,j),be()}pt(["click"]);var sg=S('<div class="a p-11shdp8"><!></div>');function Ct(t,e){ye(e,!0);const{setDialogPageHeight:a}=ds();let r=I(null);Pe(()=>{n(r);const i=new ResizeObserver(l=>{for(let u of l){const c=u.contentRect.height;a(c)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=sg(),s=C(o);He(s,()=>e.children),$e(o,i=>f(r,i),()=>n(r)),g(t,o),be()}var ig=S('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function lg(t,e){ye(e,!1);const{replaceSearchParams:a,getHref:r}=Bt(),o=l=>{l.preventDefault(),a("")};ss();var s=ig(),i=A(C(s),2);{let l=Pr(()=>r(""));Rt(i,{element:"a",get href(){return n(l)},onClick:o,children:(u,c)=>{var d=Ke("close");g(u,d)},$$slots:{default:!0}})}g(t,s),be()}var cg=S('<h1 class="p-1n0ziuh"><!></h1>');function dg(t,e){var a=cg(),r=C(a);He(r,()=>e.children),g(t,a)}var ug=S('<!> <div class="b p-193tby9"><!> <!></div>',1),fg=S('<div class="a p-193tby9"><!></div>');function vg(t,e){ye(e,!0);const{blockDialog:a,setLeftEnd:r}=Qt(),{pushDialogPage:o}=zt(),{initLocalAccount:s}=ls(),{replaceSearchParams:i}=Bt(),l=Gn(),u=()=>{o(Te.Auth)},c=async()=>{l.duration=0,l.swipingRatio=-25,requestAnimationFrame(()=>{l.duration=ca().duration,l.swipingRatio=ca().swipingRatio,s(),a(!1),r(!0),i("")})};var d=fg(),v=C(d);{var h=p=>{var m=ug(),k=P(m);dg(k,{children:(w,b)=>{var T=Ke("Welcome");g(w,T)}});var _=A(k,2),y=C(_);Rt(y,{onClick:u,fullWidth:!0,children:(w,b)=>{var T=Ke("Cloud account");g(w,T)},$$slots:{default:!0}});var E=A(y,2);Rt(E,{onClick:c,fullWidth:!0,type:"secondary",children:(w,b)=>{var T=Ke("Local account");g(w,T)},$$slots:{default:!0}}),g(p,m)};H(v,p=>{p(h)})}g(t,d),be()}var gg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),hg=S('<form class="b p-10m9vsg"><!> <!> <div class="c p-10m9vsg"><div class="d p-10m9vsg"><button type="button" class="p-10m9vsg">Cancel</button> <button type="submit" class="p-10m9vsg">Done</button></div> <!></div></form>'),pg=S('<div class="f p-10m9vsg"><!></div>'),mg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),_g=S('<div class="e p-10m9vsg"><div><!> <a class="g p-10m9vsg" target="_blank" rel="noopener noreferrer"> </a> <div><!></div></div></div>'),wg=S('<div class="a p-10m9vsg"><!></div>');function yg(t,e){ye(e,!0);let a=Fe(e,"shownUrlInput",15);const{getFaviconEnabled:r}=Hn();let o=x(r),s=I(null),i=I(null),l=I(null),u=I(ft(e.url)),c=I(ft(e.title)),d=I(null);const v=w=>{f(u,w.target.value||"",!0)},h=w=>{f(c,w.target.value||"",!0)};Ue(()=>{a()&&n(s)?.focus()});const p=()=>{e.url&&(navigator.clipboard.writeText(e.url),tt("Copied link"))},m=()=>{f(c,""),f(u,""),e.onDeleteUrl(),a(!1)};var k=wg(),_=C(k);{var y=w=>{var b=hg(),T=C(b);Cr(T,{get value(){return n(u)},onInput:v,placeholder:"url",get ref(){return n(s)},set ref(Y){f(s,Y,!0)}});var X=A(T,2);Cr(X,{get value(){return n(c)},onInput:h,placeholder:"title",get ref(){return n(i)},set ref(Y){f(i,Y,!0)}});var U=A(X,2),q=C(U),R=C(q);R.__click=()=>{f(u,e.url,!0),f(c,e.title,!0),a(!1)};var ee=A(q,2);{var re=Y=>{ln(Y,{title:"delete link",elem:"button",onclick:m,children:(F,z)=>{var me=gg(),Se=P(me);ve(Se,()=>({"--size":"20px"})),he(Se.lastChild,{name:"bin"}),g(F,me)},$$slots:{default:!0}})};H(ee,Y=>{(e.url||e.title)&&Y(re)})}Zt("submit",b,Y=>{if(Y.preventDefault(),document.activeElement===n(s)){n(i)?.focus();return}let F=n(u).trim();F!==""&&/^[[a-zA-Z]+?:\/\//.test(F)===!1&&(F="https://"+F,f(u,F,!0)),e.onChangeUrl(F,n(c)),a(!1)}),g(w,b)},E=w=>{var b=we(),T=P(b);{var X=U=>{var q=_g(),R=C(q);et(R,1,nt({h:!0}),"p-10m9vsg");var ee=C(R);{var re=Se=>{var j=pg(),O=C(j);pl(O,{get url(){return e.url}}),g(Se,j)};H(ee,Se=>{n(o)&&Se(re)})}var Y=A(ee,2),F=C(Y),z=A(Y,2);et(z,1,nt({i:!0}),"p-10m9vsg");var me=C(z);ln(me,{title:"copy link",elem:"button",onclick:p,children:(Se,j)=>{var O=mg(),Q=P(O);ve(Q,()=>({"--size":"20px"})),he(Q.lastChild,{name:"copy"}),g(Se,O)},$$slots:{default:!0}}),$e(R,Se=>f(d,Se),()=>n(d)),De(()=>{dt(Y,"href",e.url),vt(F,e.title||"unknown")}),g(U,q)};H(T,U=>{e.url&&U(X)},!0)}g(w,b)};H(_,w=>{a()?w(y):w(E,!1)})}$e(k,w=>f(l,w),()=>n(l)),g(t,k),be()}pt(["click"]);const bg=t=>{let e="",a=!0;function r(o){for(let s=0;s<o.length;s++){const i=o[s];if(i.nodeName==="BR"){e+=`
`,a=!0;continue}i.nodeName==="DIV"&&a===!1&&(e+=`
`),a=!1,i.nodeType===3&&i.textContent&&(e+=i.textContent),r(i.childNodes)}}return r(t),e===`
`&&(e=e.slice(0,-1)),e},Cg=()=>{const t=()=>{const a=new Set(["script","style","noscript","iframe","svg","canvas","meta","link","input","button","form"]),r=u=>{if(u.childNodes.length===0)return!1;for(const c of u.childNodes)if(c.nodeType===Node.TEXT_NODE&&c.textContent?.trim())return!0;return!1},o=Array.from({length:10},()=>({priority:0,text:""})),s=(u,c)=>({main:u.main||c.tagName.toLowerCase()==="main",article:u.article||c.tagName.toLowerCase()==="article",h1:u.h1||c.tagName.toLowerCase()==="h1",h2:u.h2||c.tagName.toLowerCase()==="h2",h3:u.h3||c.tagName.toLowerCase()==="h3"}),i=u=>{let c=0;return u.main&&(c+=1e3),u.article&&(c+=1e4),u.h1&&(c+=10),u.h2&&(c+=5),u.h3&&(c+=1),c},l=(u=document.body,c={main:!1,article:!1,h1:!1,h2:!1,h3:!1})=>{for(const d of u.childNodes)if(d.nodeType===Node.ELEMENT_NODE){if(a.has(d.tagName.toLowerCase()))continue;if(r(d)){const v=d.textContent;if(!v)continue;for(let h=0;h<o.length&&!o[h].text.includes(v||"");h++)if(v&&i(s(c,d))+v.length>o[h].priority){o.splice(h,0,{priority:i(s(c,d))+v.length,text:v.trim()}),o.pop();break}}else l(d,s(c,d))}};return l(),o};return{title:document.title||"",desctiption:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",topTextContents:t()}},Sg=async()=>await nl().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),kg=async()=>typeof LanguageModel>"u"?"unavailable":await nl().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),xg=t=>new Promise(e=>{As().tabs.query({active:!0,currentWindow:!0},async a=>{const r=a[0];if(!r||!r.id){e(void 0);return}if(r.url!==t){e(void 0);return}const s=(await As().scripting.executeScript({target:{tabId:r.id},world:"MAIN",func:Cg}))[0]?.result;e(s)})}),Tg=async({llmSession:t,rejectedTags:e,accessPageData:a,text:r,link:o,tags:s})=>{const i=a&&o?.url?await xg(o.url):void 0,l={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},u=`
			Page information:
			Title: ${o?.title||"N/A"}.
			URL: ${o?.url||"N/A"}.
			Description: ${i?.desctiption||"N/A"}.
			Note content: ${r||"N/A"}.
			Dont return tags: ${[...e.length>0?e:[],...s.length>0?s:[]].join(", ")||"N/A"}.
			Page contents: ${i?.topTextContents?i.topTextContents.slice(0,5).map(({priority:v,text:h})=>`priority: ${v}; text: ${h}

`).join(""):"N/A"}.
		`.slice(0,5e3),c=await t.prompt(u,{responseConstraint:l});return Array.from(new Set([...s,...(JSON.parse(c)?.tags||[]).map(v=>v.trim().toLowerCase()).filter(v=>v!=="")]))};var Pg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Add link',1),Eg=S('<li class="p-1ljon4s"><!></li>'),Ng=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Edit link',1),Ag=S('<li class="p-1ljon4s"><!></li>'),Dg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),Mg=S('<li class="p-1ljon4s"><!></li>'),Ig=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),Lg=S('<li class="p-1ljon4s"><!></li>'),Rg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Fg=S('<li class="p-1ljon4s"><!></li>'),Og=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Make copy',1),zg=S('<li class="p-1ljon4s"><!></li>'),Bg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),jg=S('<li class="p-1ljon4s"><!></li>'),Hg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Ug=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),Wg=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Vg=S('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),qg=S(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Kg=S('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Gg=S("<!> <!> <!> <!> <!> <!> <!>",1),Yg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function zs(t,e){ye(e,!0);const{moveNoteToBin:a,moveNoteFromArchive:r,moveNoteToArchive:o,deleteNote:s,restoreNoteFromBin:i,checkDuplicatesExist:l,createNote:u}=At(),{clearDialogPages:c,replaceDialogPage:d,pushDialogPage:v}=zt(),{setFeedSearch:h}=Na(),{checkMobileSize:p}=ga();let m=Fe(e,"mode",3,"notes"),k=Fe(e,"shownMenu",15),_=I(!1),y=I(!1),E=I(!1),w=I(!1),b=I(!1),T=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const X=async()=>{requestAnimationFrame(()=>{c(),setTimeout(()=>{a(e.noteId),tt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i(e.noteId),v(`${Te.Note}?id=${e.noteId}`)}}})},300)})},U=async()=>{o(e.noteId),tt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{r(e.noteId)}}})},q=async()=>{r(e.noteId),tt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{o(e.noteId)}}})},R=()=>{i(e.noteId),tt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a(e.noteId)}}})},ee=()=>{n(y)?(f(y,!1),X()):n(b)?(f(b,!1),R()):n(E)?(f(E,!1),U()):n(w)&&(f(w,!1),q()),k(!1),f(_,!1)},re=()=>{let ie="";e.link?.url&&(ie+=e.link.url+`
`),e.text&&(ie+=`
`+e.text+`
`),navigator.clipboard.writeText(ie),tt("Copied"),f(_,!0)},Y=async()=>{f(_,!0),requestAnimationFrame(()=>{c(),setTimeout(()=>{s(e.noteId)},100)})},F=()=>{if(navigator.share){const ie={};let se="";e.link?.url&&(se+=e.link.url+`
`),e.text&&(se+=`
`+e.text+`
`),ie.text=se,navigator.share(ie).catch(Ee=>{Ee.name!=="AbortError"&&console.error("Error sharing",Ee)})}f(_,!0)},z=()=>{if(navigator.share){const ie={};e.link?.url&&(ie.url=e.link.url),e.link?.title&&(ie.title=e.link.title),navigator.share(ie).catch(se=>{se.name!=="AbortError"&&console.error("Error sharing",se)})}f(_,!0)},me=async()=>{f(_,!0);const ie=e.noteId,se=await u({link:ut(e.link),text:e.text||"",tags:e.tags?ut(e.tags):[]});d(`${Te.Note}?id=${se}`),tt("copy made",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(`${Te.Note}?id=${ie}`),setTimeout(()=>{s(se)})}}})},Se=()=>{f(_,!0),e.link?.url&&(c(),h(e.link?.url+"$"))};let j=!1;var O=we(),Q=P(O);{var ne=ie=>{var se=Yg(),Ee=P(se);{let Le=x(()=>`calc(100% - ${p()?"0px":"16px"})`),ge=x(()=>p()?"auto":"10px"),ue=x(()=>p()?"10px":"auto");ve(Ee,()=>({"--bottom":"auto","--top":n(Le),"--left":n(ge),"--right":n(ue)})),Mr(Ee.lastChild,{get startClose(){return n(_)},onClosed:ee,isMobile:j,children:(Ae,G)=>{var te=Gg(),Ce=P(te);{var xe=D=>{var L=Eg(),le=C(L);We(le,{onClick:J=>{e.onAddLinkClick(J),f(_,!0)},dialogMode:j,children:(J,fe)=>{var B=Pg(),Z=P(B);ve(Z,()=>({"--size":"20px"})),he(Z.lastChild,{name:"add"}),g(J,B)},$$slots:{default:!0}}),g(D,L)},ce=D=>{var L=Ag(),le=C(L);We(le,{onClick:J=>{e.onEditLinkClick(J),f(_,!0)},dialogMode:j,children:(J,fe)=>{var B=Ng(),Z=P(B);ve(Z,()=>({"--size":"20px","--scale":"0.9"})),he(Z.lastChild,{name:"pen"}),g(J,B)},$$slots:{default:!0}}),g(D,L)};H(Ce,D=>{e.link?.url?D(ce,!1):D(xe)})}var ae=A(Ce,2);{var ke=D=>{var L=Mg(),le=C(L);We(le,{onClick:re,dialogMode:j,children:(J,fe)=>{var B=Dg(),Z=P(B);ve(Z,()=>({"--size":"20px"})),he(Z.lastChild,{name:"copy"}),g(J,B)},$$slots:{default:!0}}),g(D,L)};H(ae,D=>{e.text&&D(ke)})}var pe=A(ae,2);{var Re=D=>{var L=Lg(),le=C(L);We(le,{onClick:z,dialogMode:j,children:(J,fe)=>{var B=Ig(),Z=P(B);{let oe=x(()=>e.text?"":"share");ve(Z,()=>({"--size":"20px"})),he(Z.lastChild,{get name(){return n(oe)}})}g(J,B)},$$slots:{default:!0}}),g(D,L)};H(pe,D=>{T&&e.link?.url&&D(Re)})}var $=A(pe,2);{var _e=D=>{var L=Fg(),le=C(L);We(le,{onClick:F,dialogMode:j,children:(J,fe)=>{var B=Rg(),Z=P(B);ve(Z,()=>({"--size":"20px"})),he(Z.lastChild,{name:"share"}),g(J,B)},$$slots:{default:!0}}),g(D,L)};H($,D=>{T&&e.text&&D(_e)})}var Be=A($,2);{var Me=D=>{var L=zg(),le=C(L);We(le,{onClick:me,dialogMode:j,children:(J,fe)=>{var B=Og(),Z=P(B);ve(Z,()=>({"--size":"20px","--scale":"0.8"})),he(Z.lastChild,{name:"note"}),g(J,B)},$$slots:{default:!0}}),g(D,L)};H(Be,D=>{e.formMode==="edit"&&(e.text||e.link?.url)&&D(Me)})}var Je=A(Be,2);{var N=D=>{var L=jg(),le=C(L);We(le,{onClick:Se,dialogMode:j,children:(J,fe)=>{var B=Bg(),Z=P(B);ve(Z,()=>({"--size":"20px"})),he(Z.lastChild,{name:""}),g(J,B)},$$slots:{default:!0}}),g(D,L)};H(Je,D=>{e.link?.url&&l(e.noteId)&&D(N)})}var W=A(Je,2);{var V=D=>{var L=we(),le=P(L);{var J=fe=>{var B=Wg(),Z=P(B),oe=C(Z);We(oe,{onClick:()=>{f(E,m()==="notes"),f(w,m()==="archive"),f(_,!0)},dialogMode:j,children:(Ve,Ie)=>{var Oe=Hg(),ze=P(Oe);{let wt=x(()=>m()==="archive"?"archive-cancel":"archive");ve(ze,()=>({"--size":"20px","--scale":"0.9"})),he(ze.lastChild,{get name(){return n(wt)}})}var je=A(ze);De(()=>vt(je,` ${m()==="archive"?"Unarchive":"Archive"}`)),g(Ve,Oe)},$$slots:{default:!0}});var de=A(Z,2),Ne=C(de);We(Ne,{onClick:()=>{f(y,!0),f(_,!0)},dialogMode:j,children:(Ve,Ie)=>{var Oe=Ug(),ze=P(Oe),je=C(ze);ve(je,()=>({"--size":"20px"})),he(je.lastChild,{name:"bin"}),g(Ve,Oe)},$$slots:{default:!0}}),g(fe,B)};H(le,fe=>{(e.text||e.link?.url)&&fe(J)})}g(D,L)},M=D=>{var L=Kg(),le=P(L),J=C(le);We(J,{onClick:()=>{f(b,!0),f(_,!0)},dialogMode:j,children:(Z,oe)=>{var de=Vg(),Ne=P(de),Ve=C(Ne);ve(Ve,()=>({"--size":"20px"})),he(Ve.lastChild,{name:"bin-cancel"}),g(Z,de)},$$slots:{default:!0}});var fe=A(le,2),B=C(fe);We(B,{onClick:Y,dialogMode:j,dangerous:!0,children:(Z,oe)=>{var de=qg(),Ne=P(de),Ve=C(Ne);ve(Ve,()=>({"--size":"20px"})),he(Ve.lastChild,{name:"bin"}),g(Z,de)},$$slots:{default:!0}}),g(D,L)};H(W,D=>{m()==="notes"||m()==="archive"?D(V):D(M,!1)})}g(Ae,te)},$$slots:{default:!0}})}g(ie,se)};H(Q,ie=>{k()&&ie(ne)})}g(t,O),be()}var Xg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Jg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Zg=S("<!> <!> <!> <!>",1),Qg=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),$g=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),eh=S("<!> <!> <!>",1),th=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),nh=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ah=S('<div class="a p-5sjfv5"><div class="b p-5sjfv5"><!></div> <div class="c p-5sjfv5"><!> <!></div></div>');function rh(t,e){ye(e,!0);let a=Fe(e,"pinned",15,!1);const{checkMobileSize:r}=ga(),{getSearchParams:o,getHref:s}=Bt(),{getViewMode:i}=Hn();let l=I(!1);const u=()=>!e.deletedAt&&!e.archivedAt?"notes":e.archivedAt?"archive":"bin";var c=ah(),d=C(c),v=C(d);{var h=y=>{var E=Zg(),w=P(E);{let U=x(()=>a()?"unpin":"pin");ln(w,{get title(){return n(U)},elem:"button",onclick:()=>{a(!a())},children:(q,R)=>{var ee=Xg(),re=P(ee);{let Y=x(()=>a()?"pin-cancel":"pin");ve(re,()=>({"--size":"20px"})),he(re.lastChild,{get name(){return n(Y)}})}g(q,ee)},$$slots:{default:!0}})}var b=A(w,2);ln(b,{title:"menu",elem:"button",onclick:()=>{f(l,!0)},children:(U,q)=>{var R=Jg(),ee=P(R);ve(ee,()=>({"--size":"20px","--rotate":"90deg"})),he(ee.lastChild,{name:"menu"}),g(U,R)},$$slots:{default:!0}});var T=A(b,2);{let U=x(u);zs(T,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(U)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(l)},set shownMenu(q){f(l,q,!0)}})}var X=A(T,2);H(X,U=>{}),g(y,E)},p=y=>{var E=eh(),w=P(E);ln(w,{title:"menu",elem:"button",onclick:()=>{f(l,!0)},children:(X,U)=>{var q=Qg(),R=P(q);ve(R,()=>({"--size":"24px","--rotate":"90deg"})),he(R.lastChild,{name:"menu"}),g(X,q)},$$slots:{default:!0}});var b=A(w,2);{let X=x(u);zs(b,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(X)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(l)},set shownMenu(U){f(l,U,!0)}})}var T=A(b,2);{let X=x(()=>a()?"unpin":"pin");ln(T,{get title(){return n(X)},elem:"button",onclick:()=>{a(!a())},children:(U,q)=>{var R=$g(),ee=P(R);{let re=x(()=>a()?"pin-cancel":"pin");ve(ee,()=>({"--size":"24px"})),he(ee.lastChild,{get name(){return n(re)}})}g(U,R)},$$slots:{default:!0}})}g(y,E)};H(v,y=>{r()?y(h):y(p,!1)})}var m=A(d,2),k=C(m);{let y=x(()=>!e.canPrev);ln(k,{title:"previous",elem:"button",get disabled(){return n(y)},onclick:E=>{E.preventDefault(),e.onPrev&&e.onPrev()},children:(E,w)=>{var b=th(),T=P(b);ve(T,()=>({"--size":"20px"})),he(T.lastChild,{name:"prev"}),g(E,b)},$$slots:{default:!0}})}var _=A(k,2);{let y=x(()=>!e.canNext);ln(_,{title:"next",elem:"button",get disabled(){return n(y)},onclick:E=>{E.preventDefault(),e.onNext&&e.onNext()},children:(E,w)=>{var b=nh(),T=P(b);ve(T,()=>({"--size":"20px"})),he(T.lastChild,{name:"next"}),g(E,b)},$$slots:{default:!0}})}g(t,c),be()}var oh=S('<div class="e p-lklx2e">Note</div>'),sh=S("<span> </span>"),ih=S('<div class="i p-lklx2e"><!></div>'),lh=S('<!> <!> <div class="a p-lklx2e"><div class="b"><div class="c"><div class="d p-lklx2e"><!> <div class="f p-lklx2e" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"></div></div></div></div> <div class="g h p-lklx2e"><!> <div class="j p-lklx2e"><!></div></div></div>',1);function ch(t,e){ye(e,!0);const{getLlmTagsEnabled:a,getPrevTags:r,getPageDataForTagsEnabled:o}=Hn(),{pushDialogPage:s}=zt();let i=Fe(e,"link",15,void 0),l=Fe(e,"text",15,""),u=Fe(e,"tags",31,()=>ft([])),c=Fe(e,"pinned",11,!1),d=I(null),v=I(!1),h=I(!1),p=I(ft(new Set)),m=I(""),k=I(!1);const _=G=>{const te=bg(G.currentTarget.childNodes);l(te),f(m,te,!0)},y=G=>{G.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(v)&&(f(v,!1),G.preventDefault(),G.stopPropagation()),n(h)&&(f(h,!1),G.preventDefault(),G.stopPropagation()))};Pe(()=>(document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)));const E=(G,te)=>{i({url:G,title:te})},w=()=>{i(void 0)},b=G=>{u(G)},T=r(),X=()=>{u([...new Set([...u(),...T])])};Ue(()=>{n(d)&&n(m)!==l()&&(n(d).textContent=l(),f(m,l(),!0))}),Pe(()=>{if(n(d)){if((Tn||Wn)&&(e.mode==="edit"||navigator.userActivation.isActive===!1))return;n(d).focus();const G=document.createRange();G.selectNodeContents(n(d)),G.collapse(!1);const te=window.getSelection();te?.removeAllRanges(),te?.addRange(G)}});let U=I("unknown");Pe(()=>{(async()=>f(U,await kg(),!0))()});let q=x(a),R=null;const ee=async()=>R||(R=await Sg(),R),re=async()=>{if(n(U)==="downloadable"||n(U)==="downloading"){s(Te.Extension);return}f(k,!0);const G=await ee();u(await Tg({llmSession:G,text:l(),link:i(),accessPageData:o(),rejectedTags:Array.from(n(p)),tags:u()})),f(k,!1)};Pe(()=>{const G=te=>{if(te.preventDefault(),!te.clipboardData)return;l(te.clipboardData.getData("text/plain"));const Ce=window.getSelection();if(Ce&&Ce.rangeCount>0){const xe=Ce.getRangeAt(0);xe.deleteContents(),xe.insertNode(document.createTextNode(l())),xe.collapse(!1),Ce.removeAllRanges(),Ce.addRange(xe)}};return document.addEventListener("paste",G),()=>{document.removeEventListener("paste",G)}});var Y=lh(),F=P(Y);rh(F,{get noteId(){return e.noteId},get link(){return i()},get pinned(){return c()},get text(){return l()},get tags(){return u()},get deletedAt(){return e.deletedAt},get archivedAt(){return e.archivedAt},onAddLinkClick:()=>{f(h,!0)},onEditLinkClick:()=>{f(h,!0)},get canNext(){return e.canNext},get canPrev(){return e.canPrev},get onNext(){return e.onNext},get onPrev(){return e.onPrev},get formMode(){return e.mode}});var z=A(F,2);{var me=G=>{{let te=x(()=>i()?.url||""),Ce=x(()=>i()?.title||"");yg(G,{get url(){return n(te)},get title(){return n(Ce)},onChangeUrl:E,onDeleteUrl:w,get shownUrlInput(){return n(h)},set shownUrlInput(xe){f(h,xe,!0)}})}};H(z,G=>{(n(h)||i()?.url)&&G(me)})}var Se=A(z,2),j=C(Se),O=C(j),Q=C(O),ne=C(Q);{var ie=G=>{var te=oh();g(G,te)};H(ne,G=>{l()||G(ie)})}var se=A(ne,2);se.__input=_,$e(se,G=>f(d,G),()=>n(d));var Ee=A(j,2),Le=C(Ee);{var ge=G=>{var te=ih(),Ce=C(te);{var xe=ce=>{var ae=sh(),ke=C(ae);De(pe=>vt(ke,`updated: ${pe??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),g(ce,ae)};H(Ce,ce=>{e.updatedAt&&ce(xe)})}g(G,te)};H(Le,G=>{e.mode==="edit"&&G(ge)})}var ue=A(Le,2),Ae=C(ue);{let G=x(()=>n(q)&&n(U)!=="unknown"&&n(U)!=="unavailable"),te=x(()=>e.mode==="add"&&T.length>0);hl(Ae,{get selectedTags(){return u()},onRejectedTag:Ce=>{f(p,new Set([...n(p),Ce]),!0)},onChangeTags:b,get genTagsEnabled(){return n(G)},onGenTags:re,get generatingTags(){return n(k)},onUsePreviousTags:X,get previousTagsEnabled(){return n(te)},get shownTagInput(){return n(v)},set shownTagInput(Ce){f(v,Ce,!0)}})}g(t,Y),be()}pt(["input"]);function dh(t,e){ye(e,!0);const{isInitedNotes:a,createNote:r,updateNote:o,deleteNote:s,getNoteById:i,pinNote:l}=At(),{getViewMode:u,setPrevTags:c}=Hn(),{deleteSearchParam:d,getSearchParams:v}=Bt(),{replaceDialogPage:h}=zt();let p=I("loading"),m=I("idle"),k=I(""),_=I(!1),y=I(void 0),E=I(""),w=I(ft([])),b=I(-1),T=I(ft([]));const X=()=>{{const j=v().get("url"),O=v().get("title"),Q=v().get("text");j&&f(y,{url:j,title:O||""},!0),Q&&(!j&&Jo(Q)?f(y,{url:Q,title:O||new URL(Q).hostname},!0):f(E,Q,!0)),d("url"),d("title"),d("text"),R();return}},U=x(()=>a()&&n(p)==="finish"),q=async()=>{if(n(y)?.title||n(y)?.url||n(E)||n(w).length>0){if(n(k)){const j=i(n(k));if(!j?.data)return;if((j.data.link?.url!==n(y)?.url||j.data.link?.title!==n(y)?.title||j.data.text!==n(E)||JSON.stringify(j.data.tags)!==JSON.stringify(n(w)))&&n(m)==="idle"){f(m,"loading");try{await o(n(k),{link:_n(n(y)),text:n(E),tags:n(w).slice()})}finally{f(m,"idle")}}}else if(n(m)==="idle"){f(m,"loading");try{f(k,await r({link:_n(n(y)),text:n(E),tags:n(w).slice()}),!0),h(`${Te.NewNote}?id=${n(k)}`)}catch(j){console.error("Error creating note:",j)}finally{f(m,"idle")}}}else if(n(k)&&n(m)==="idle"){f(m,"loading");try{await s(n(k)),f(k,""),h(`${Te.NewNote}`)}finally{f(m,"idle")}}};Ue(()=>{n(U)&&n(m)!=="loading"&&q()});const R=()=>{n(T).push({link:_n(n(y)),text:n(E),tags:n(w).slice()}),f(b,0),f(p,"finish")};Ue(()=>{n(U)&&n(m)!=="loading"&&n(p)==="finish"&&(n(E),n(y),n(w),Ot(()=>{const j=n(T)[0];j.link?.url!==n(y)?.url||j.link?.title!==n(y)?.title||j.text!==n(E)||JSON.stringify(j.tags)!==JSON.stringify(n(w))?(n(T)[1]={link:_n(n(y)),text:n(E),tags:n(w).slice()},f(b,1)):n(b)===1&&(f(T,n(T).slice(0,1),!0),f(b,0))}))}),Ue(()=>{n(U)&&n(m)!=="loading"&&n(k)&&(n(_),Ot(()=>{i(n(k))?.data.pinned!==n(_)&&l(n(k),n(_))}))}),Pe(()=>{X()}),Pe(()=>()=>{n(w).length>0&&c([...n(w)])});let ee=x(()=>n(b)>0),re=x(()=>n(b)<n(T).length-1);const Y=()=>{f(b,0);const j=n(T)[0];f(y,ut(j.link),!0),f(E,j.text,!0),f(w,ut(j.tags),!0)},F=()=>{if(n(b)>=n(T).length-1)return;f(b,1);const j=n(T)[n(b)];f(y,ut(j.link),!0),f(E,j.text,!0),f(w,ut(j.tags),!0)};Ue(()=>{console.log("historyIndex",n(b)),console.log("history",_n(n(T)))});var z=we(),me=P(z);{var Se=j=>{{let O=x(()=>i(n(k))?.data.deletedAt),Q=x(()=>i(n(k))?.data.archivedAt);ch(j,{get deletedAt(){return n(O)},get archivedAt(){return n(Q)},get noteId(){return n(k)},get canNext(){return n(re)},get canPrev(){return n(ee)},onPrev:Y,onNext:F,mode:"add",get link(){return n(y)},set link(ne){f(y,ne,!0)},get text(){return n(E)},set text(ne){f(E,ne,!0)},get tags(){return n(w)},set tags(ne){f(w,ne,!0)},get pinned(){return n(_)},set pinned(ne){f(_,ne,!0)}})}};H(me,j=>{n(U)&&j(Se)})}g(t,z),be()}const uh="modulepreload",fh=function(t){return"/"+t},Bs={},St=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let u=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");o=u(a.map(c=>{if(c=fh(c),c in Bs)return;Bs[c]=!0;const d=c.endsWith(".css"),v=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${v}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":uh,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var vh=S('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function gh(t){var e=vh(),a=A(C(e),2);Rt(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=Ke("Reload");g(r,s)},$$slots:{default:!0}}),g(t,e)}var hh=S('<div class="p-uzefkz"><!></div>');function ph(t,e){ye(e,!0);let a=I(!1);const{getDialogPageHeight:r}=ds(),o=x(r);Pe(()=>{const u=setTimeout(()=>{f(a,!0)},250);return()=>{clearTimeout(u)}});var s=hh(),i=C(s);{var l=u=>{La(u,{})};H(i,u=>{n(a)&&u(l)})}De(()=>$a(s,`min-height: ${n(o)??""}px;`)),g(t,s),be()}function Mt(t,e){ye(e,!0);const a={},r=Object.assign({"./Pages/About.svelte":()=>St(()=>import("./aw4kASr-B.js"),__vite__mapDeps([0,1])),"./Pages/AccessKeys.svelte":()=>St(()=>import("./aDplMqvZQ.js"),__vite__mapDeps([2,3,4,5])),"./Pages/Account.svelte":()=>St(()=>import("./aiIi5JvW7.js"),__vite__mapDeps([6,3,7])),"./Pages/Auth.svelte":()=>St(()=>import("./aCq9_alPV.js"),__vite__mapDeps([8,9])),"./Pages/ChangeTags.svelte":()=>St(()=>import("./aA7EQr1_o.js"),[]),"./Pages/ConfirmAccessKey.svelte":()=>St(()=>import("./a9XZmAV6P.js"),__vite__mapDeps([10,4,3,11,12])),"./Pages/Exit.svelte":()=>St(()=>import("./aD3UDnbAb.js"),__vite__mapDeps([13,14])),"./Pages/ExportData.svelte":()=>St(()=>import("./aBh-tNMbI.js"),__vite__mapDeps([15,16,17,18,19,20])),"./Pages/Extension.svelte":()=>St(()=>import("./aCGHeoltM.js"),__vite__mapDeps([21,18,19,22])),"./Pages/ImportData.svelte":()=>St(()=>import("./aDDjC-2Zz.js"),__vite__mapDeps([23,24])),"./Pages/Install.svelte":()=>St(()=>import("./aBBuIJP2O.js"),__vite__mapDeps([25,26])),"./Pages/InstallSuccess.svelte":()=>St(()=>import("./aCPmGDszg.js"),__vite__mapDeps([27,28])),"./Pages/Note.svelte":()=>St(()=>import("./aCZPy_Lak.js"),__vite__mapDeps([29,30])),"./Pages/Settings.svelte":()=>St(()=>import("./aNRzpmI33.js"),__vite__mapDeps([31,18,19,16,17,32])),"./Pages/Signin.svelte":()=>St(()=>import("./aBJBLIUxz.js"),__vite__mapDeps([33,4,3,11,34])),"./Pages/Signup.svelte":()=>St(()=>import("./aBmhEtPzn.js"),__vite__mapDeps([35,11,4,3,34])),"./Pages/Subscription.svelte":()=>St(()=>import("./aLIGApDiW.js"),__vite__mapDeps([36,37])),"./Pages/Sync.svelte":()=>St(()=>import("./aug266W1p.js"),__vite__mapDeps([38,39]))}),o=async l=>{const u=`./Pages/${l[0].toUpperCase()+l.slice(1)}.svelte`;if(!a[l]){if(r[u]){const c=r[u]();return a[l]={promise:c},a[l].module=await c,a[l].module}throw new Error(`Page ${l} not found`)}return a[l].module||await a[l].promise};var s=we(),i=P(s);Yc(i,()=>o(e.page),l=>{ph(l,{})},(l,u)=>{const c=x(()=>n(u).default);var d=we(),v=P(d);Qc(v,()=>n(c),(h,p)=>{p(h,{get params(){return e.params},get hidden(){return e.hidden}})}),g(l,d)},l=>{gh(l)}),g(t,s),be()}var tr,_l,wl;class mh{constructor(e){Ge(this,tr);jt(this,"data");jt(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),ct(this,tr,_l).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,ct(this,tr,wl).call(this)),e}isEmpty(){return this.data.length===0}}tr=new WeakSet,_l=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},wl=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class _h{constructor(e,a){jt(this,"heap");jt(this,"done");jt(this,"cache",[]);this.heap=new mh(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var wh=S("<span>Back to notes</span>"),yh=S('<div class="c p-130fajz">No notes in bin</div> <div class="d p-130fajz"><!></div>',1),bh=S("<span>Back to notes</span>"),Ch=S('<div class="c p-130fajz">No notes in archive</div> <div class="d p-130fajz"><!></div>',1),Sh=S('<p class="f">No notes in bin</p>'),kh=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),xh=S('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Th=S('<div class="g p-130fajz"><div class="d p-130fajz"><!></div> <div>or</div> <div class="d p-130fajz"><!></div></div>'),Ph=S('<div class="e p-130fajz"><!></div>'),Eh=S('<div class="h"><div class="c p-130fajz">No notes found</div></div>'),Nh=S('<div class="i p-130fajz"><ul class="p-130fajz"></ul></div>'),Ah=S('<div class="a p-130fajz"><div class="b p-130fajz"><!></div></div>');function Dh(t,e){ye(e,!0);const{getCountDialog:a}=Qt(),{getScrollContainer:r}=vo(),{createHandleClickDialogPage:o,createDialogPageHref:s}=zt(),{getSelectedTags:i}=Kn(),{getFeedOrder:l}=Hi(),{checkNotesInArchive:u,checkNotesInBin:c,checkNotes:d,isInitedNotes:v}=At(),{getSelectedMetaTags:h}=fo(),{replaceSearchParams:p,getHref:m}=Bt();Na();const{getFiltredNotesLength:k,getFiltredNotes:_,getUpdatedFiltredNotesTimestamp:y}=Ia(),{getFeedSearch:E}=Na();let w="keyboard",b=x(h),T=x(k),X=x(_),U=x(y),q=x(v),R=54,ee=I(0),re=I(0),Y=I(0),F=I(null),z=x(r),me=null,Se=null,j=x(()=>n(b).has(ot.ARCHIVED)?"archive":n(b).has(ot.BIN)?"bin":"notes");const O=x(i);Ue(()=>{n(O),n(Ee),n(z)?.scrollTo(0,0)});const{enable:Q}=cs(),ne=()=>{Q(),me||(me=requestAnimationFrame(()=>{const $=n(z)?.scrollTop||0;f(Y,$,!0);const _e=Math.ceil(n(ee)/R);f(re,Math.floor($/(R*_e))*(R*_e)),me=null}))},ie=()=>{Se||(Se=requestAnimationFrame(()=>{f(ee,window.innerHeight-180||0,!0);const $=n(z)?.scrollTop||0;f(Y,$,!0);const _e=Math.ceil(n(ee)/R);f(re,Math.floor($/(R*_e))*(R*_e)),Se=null}))};Pe(()=>{const $=_e=>{if(!(!Ov()&&qr()===void 0)&&!(a()>0)&&(_e.key==="ArrowDown"||_e.key==="ArrowUp")){if(_e.preventDefault(),_e.key==="ArrowDown"){const Be=qr(),Me=n(ue).findIndex(W=>W.id===Be),Je=Ce(),N=xe();if(!Be||Me===-1)vn(Je?.id);else if(Me<=N.index&&Me>=Je.index)Fs()&&Me!==-1&&te(Me+1)&&n(z)&&(n(z).scrollTop=Math.floor(n(z).scrollTop/R)*R+R);else if(Me>N.index&&!te(Me-1)&&te(Me)){n(z)&&(n(z).scrollTop=Math.ceil(n(z).scrollTop/R)*R+R);const W=Fs();vn(W)}else vn(Je?.id)}else if(_e.key==="ArrowUp"){const Be=qr(),Me=n(ue).findIndex(W=>W.id===Be),Je=Ce(),N=xe();if(!Be||Me===-1)vn(N?.id);else if(Me<=N.index&&Me>=Je.index)Os()&&Me!==-1&&te(Me-1)&&n(z)&&(n(z).scrollTop=Math.ceil(n(z).scrollTop/R)*R-R);else if(Me<Je.index&&!te(Me+1)&&te(Me)){n(z)&&(n(z).scrollTop=n(G)+Me*R-R);const W=Os();vn(W)}else vn(N?.id)}ml()||Zo()}};return document.addEventListener("keydown",$),()=>{document.removeEventListener("keydown",$)}}),Pe(()=>{ie(),ne()});const se=()=>{ne()};Ue(()=>{E()!==""&&w==="keyboard"&&(vn(Ce().id),Zo())}),Ue(()=>(n(z)?.addEventListener("scroll",se),window.addEventListener("resize",ie),()=>{n(z)?.removeEventListener("scroll",se),window.removeEventListener("resize",ie)}));const Ee=x(l);Ue(()=>{n(Ee),n(U),f(F,new _h(n(X),($,_e)=>{if(!$||!_e||!$.data||!_e.data)return 0;if($.data.pinned&&!_e.data.pinned)return-1;if(!$.data.pinned&&_e.data.pinned)return 1;if($.data.pinned&&_e.data.pinned){if($.data.pinned<_e.data.pinned)return 1;if($.data.pinned>_e.data.pinned)return-1}const Be=(Me,Je)=>Me.data.text||Je.data.text?(Me.data.text||"").localeCompare(Je.data.text||""):(Me.data.link?.title||"").localeCompare(Je.data.link?.title||"");switch(n(Ee)){case"newest":return $.data.createdAt<_e.data.createdAt?1:$.data.createdAt>_e.data.createdAt?-1:Be($,_e);case"oldest":return $.data.createdAt>_e.data.createdAt?1:$.data.createdAt<_e.data.createdAt?-1:Be($,_e);case"AtoZ":return Be($,_e);case"ZtoA":return Be(_e,$);case"updatedNewest":return $.data.updatedAt<_e.data.updatedAt?1:$.data.updatedAt>_e.data.updatedAt?-1:Be($,_e);default:return 0}}),!0)});const Le=x(()=>n(T)*R);let ue=x(()=>{n(U);const $=Math.ceil(n(ee)/R);let _e=Math.floor(n(re)/R);return _e=_e-Math.min(_e,$),n(F)?.get(_e,_e+$*3)||[]}),Ae=x(()=>R*Math.ceil(n(ee)/R));const G=x(()=>n(re)-Math.min(n(re),n(Ae))),te=$=>$*R<n(Y)-n(G)-R/2||$*R>n(Y)-n(G)+Math.floor(n(ee)/R)*R,Ce=()=>{for(let $=0;$<n(ue).length;$++)if(!te($))return{index:$,id:n(ue)[$].id};return{index:-1,id:void 0}},xe=()=>{for(let $=n(ue).length-1;$>=0;$--)if(!te($))return{index:$,id:n(ue)[$].id};return{index:-1,id:void 0}};Pe(()=>{document.addEventListener("mousemove",()=>{w="mouse"}),document.addEventListener("keydown",()=>{w="keyboard"})});var ce=Ah(),ae=C(ce),ke=C(ae);{var pe=$=>{La($,{})},Re=$=>{var _e=we(),Be=P(_e);{var Me=N=>{var W=yh(),V=A(P(W),2),M=C(V);{let D=x(()=>m(""));Rt(M,{element:"a",get href(){return n(D)},onClick:L=>{L.preventDefault(),p("")},children:(L,le)=>{var J=wh();g(L,J)},$$slots:{default:!0}})}g(N,W)},Je=N=>{var W=we(),V=P(W);{var M=L=>{var le=Ch(),J=A(P(le),2),fe=C(J);{let B=x(()=>m(""));Rt(fe,{element:"a",get href(){return n(B)},onClick:Z=>{Z.preventDefault(),p("")},children:(Z,oe)=>{var de=bh();g(Z,de)},$$slots:{default:!0}})}g(L,le)},D=L=>{var le=we(),J=P(le);{var fe=Z=>{var oe=Ph(),de=C(oe);{var Ne=Ie=>{var Oe=Sh();g(Ie,Oe)},Ve=Ie=>{var Oe=Th(),ze=C(Oe),je=C(ze);{let st=x(()=>s(Te.NewNote)),lt=x(()=>o(Te.NewNote));Rt(je,{element:"a",get href(){return n(st)},get onClick(){return n(lt)},children:(mt,En)=>{var Tt=kh(),Dt=P(Tt);ve(Dt,()=>({"--size":"18px","--color":"#b0b0b0"})),he(Dt.lastChild,{name:"plus"}),g(mt,Tt)},$$slots:{default:!0}})}var wt=A(ze,4),at=C(wt);{let st=x(()=>s(Te.ImportData)),lt=x(()=>o(Te.ImportData));Rt(at,{element:"a",get href(){return n(st)},get onClick(){return n(lt)},children:(mt,En)=>{var Tt=xh(),Dt=P(Tt);ve(Dt,()=>({"--size":"18px","--color":"#b0b0b0"})),he(Dt.lastChild,{name:"import"}),g(mt,Tt)},$$slots:{default:!0}})}g(Ie,Oe)};H(de,Ie=>{n(j)==="bin"?Ie(Ne):Ie(Ve,!1)})}g(Z,oe)},B=Z=>{var oe=we(),de=P(oe);{var Ne=Ie=>{var Oe=Eh();g(Ie,Oe)},Ve=Ie=>{var Oe=Nh(),ze=C(Oe);Bn(ze,23,()=>n(ue),je=>je.data,(je,wt,at)=>{var st=we(),lt=P(st);{var mt=En=>{{let Tt=x(()=>n(ue)[n(at)+1]?.id),Dt=x(()=>n(ue)[n(at)-1]?.id),mo=x(()=>te(n(at))),_o=x(()=>(n(at)+5)*R<n(Y)-n(G)-R/2||(n(at)+5)*R>n(Y)-n(G)+Math.floor(n(ee)/R)*R);Xv(En,{get nextNoteId(){return n(Tt)},get prevNoteId(){return n(Dt)},get mode(){return n(j)},get focusHidden(){return n(mo)},get showMenuUp(){return n(_o)},get noteId(){return n(wt).id},get noteData(){return n(wt).data}})}};H(lt,En=>{n(wt).data&&En(mt)})}g(je,st)}),De(je=>{$a(Oe,je),$a(ze,`transform: translateY(${n(G)??""}px);`)},[()=>`--minHeight: ${Math.max((n(Le)>n(ee),n(Le)),0)}px`]),g(Ie,Oe)};H(de,Ie=>{n(ue).length===0?Ie(Ne):Ie(Ve,!1)},!0)}g(Z,oe)};H(J,Z=>{!c()&&!u()&&!d()?Z(fe):Z(B,!1)},!0)}g(L,le)};H(V,L=>{n(j)==="archive"&&!u()?L(M):L(D,!1)},!0)}g(N,W)};H(Be,N=>{n(j)==="bin"&&!c()?N(Me):N(Je,!1)},!0)}g($,_e)};H(ke,$=>{n(q)?$(Re,!1):$(pe)})}g(t,ce),be()}var Mh=S('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Ih(t){var e=Mh(),a=A(P(e),2),r=C(a);Dh(r,{}),g(t,e)}function Lh(t,e){ye(e,!0);const a=Gn();let r=Fe(e,"animationRef",7),o=Fe(e,"dialog",7);gl(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let c=0,d=0,v=()=>1;if(r().current){r().current.pause();let p=Number(r().current.currentTime);yr()&&(p=Number(p)+50,r().current.currentTime=Math.min(Math.max(jn-1,p),p));const m=r().current.effect?.getComputedTiming().progress||0;v=()=>m,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(p=>requestAnimationFrame(p)),d=1-v();const h=d*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-d)*.1}`),a.swipingRatio=Math.abs(1-d)*25,a.isSwiping=!0,a.duration=0,o().style.transform=`translate3d(${h}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:c,currentPosition:h,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:c,width:d})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-c/d)*.1}`),o().style.transform=`translate3d(${c}px, 0, 0)`,a.swipingRatio=Math.abs(1-c/d)*25)},onFinish:({swipeVelocity:c,currentPosition:d,width:v,actionThreshold:h,initialPosition:p})=>{if(a.isSwiping=!1,!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const m=()=>Math.abs(p+d)/v*100;let k=null;if(c<=-da?k="open":c>=da?k="close":k=Math.abs(m())>h?"close":"open",r().progress=vl(m()/100),k==="close"){const _=(1-(r().progress||0))*jn;a.duration=_/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=0,e.onClose()}else{const _=(r().progress||1)*jn;a.duration=_/1e3,o().style.setProperty("--transition-timing-dialog",`${a.duration}s`),a.swipingRatio=25,e.onOpen()}}}),be()}var Rh=S('<div class="d p-8xr118"> </div>'),Fh=S('<button class="e f p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Oh=S('<a class="e g p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),zh=S('<div><div class="a p-8xr118"><div class="b p-8xr118"><div class="c p-8xr118"><!> <!> <!></div></div></div> <!> <!></div>'),Bh=S("<dialog><!></dialog> <!>",1);function jh(t,e){ye(e,!0);const{isScrolling:a,enable:r}=cs();let o=I(null),s=I(null),i={};const l=Gn(),{checkLeftEnd:u,checkLeftStart:c,setLeftEnd:d,setLeftStart:v,getCountDialog:h}=Qt(),p=x(c),m=x(u);let k=x(()=>l.working);const _=()=>{e.dialogState!=="opened"&&e.onStartOpening()},y=()=>{e.onClose()},E=()=>{e.onSwipe()},w=Y=>{Y.preventDefault(),y()};Pe(()=>(n(o)?.addEventListener("close",y),n(o)?.addEventListener("cancel",w),()=>{n(o)?.removeEventListener("close",y),n(o)?.removeEventListener("cancel",w)})),Ue(()=>{h()>0&&(l.swipingRatio=25)}),Ue(()=>{e.dialogState==="opening"?Ot(()=>{requestAnimationFrame(()=>{if(!n(o))return;const Y=(i.progress||1)*jn,F=n(o).style.transform||`translate3d(${n(p)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const z=n(o)?.animate([{transform:F},{transform:"translate3d(0, 0, 0)"}],{duration:Y,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=z,z&&(z.onfinish=()=>{e.onOpened(),l.swipingRatio=25,n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=ca().duration,z.cancel(),i.current=void 0,i.progress=void 0,n(p)&&v(!1)})})}):e.dialogState==="closing"&&Ot(()=>{requestAnimationFrame(()=>{if(!n(o))return;l.swipingRatio=0;const Y=(1-(i.progress||0))*jn,F=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const z=n(o)?.animate([{transform:F},{transform:`translate3d(${n(m)?"-100%":"100%"}, 0, 0)`}],{duration:Y,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=z,z&&(z.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l.duration=ca().duration,z.cancel(),i.current=void 0,i.progress=void 0,n(m)&&d(!1)})})})});const b=()=>{r()},T=x(a);Pe(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),yr()&&n(o).getBoundingClientRect(),!n(k)){e.onOpened();return}e.onStartOpening()}});var X=Bh(),U=P(X),q=C(U);{var R=Y=>{var F=zh(),z=C(F),me=C(z),Se=C(me),j=C(Se);{var O=ue=>{var Ae=Rh(),G=C(Ae);De(()=>vt(G,e.title)),g(ue,Ae)};H(j,ue=>{e.title&&ue(O)})}var Q=A(j,2);{var ne=ue=>{var Ae=Fh();Ae.__click=y;var G=C(Ae);ve(G,()=>({"--size":"28px"})),he(G.lastChild,{name:"back"});var te=A(G,2);_t(te,{children:(Ce,xe)=>{var ce=Ke("back");g(Ce,ce)}}),g(ue,Ae)};H(Q,ue=>{e.blocked||ue(ne)})}var ie=A(Q,2);{var se=ue=>{var Ae=Oh();Ae.__click=function(...Ce){e.onOpenWindow?.apply(this,Ce)};var G=C(Ae);ve(G,()=>({"--scale":"0.7","--size":"28px"})),he(G.lastChild,{name:"open-window"});var te=A(G,2);_t(te,{children:(Ce,xe)=>{var ce=Ke("open window");g(Ce,ce)}}),De(()=>dt(Ae,"href",e.openWindowHref)),g(ue,Ae)};H(ie,ue=>{e.onOpenWindow&&ue(se)})}var Ee=A(z,2);He(Ee,()=>e.children);var Le=A(Ee,2);{var ge=ue=>{go(ue,{})};H(Le,ue=>{e.dialogState==="opened"&&ue(ge)})}$e(F,ue=>f(s,ue),()=>n(s)),De(()=>et(F,1,nt({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-8xr118")),Zt("scroll",F,b),g(Y,F)};H(q,Y=>{e.dialogState!=="preOpening"&&Y(R)})}$e(U,Y=>f(o,Y),()=>n(o));var ee=A(U,2);{var re=Y=>{Lh(Y,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:_,onClose:y,onSwipe:E,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};H(ee,Y=>{n(s)&&!n(T)&&!e.blocked&&!e.hidden&&Y(re)})}De(()=>et(U,1,nt({h:!0,i:n(k),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(p),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-8xr118")),g(t,X),be()}pt(["click"]);function Hh(t,e){ye(e,!0);let a=Fe(e,"hidden",3,!1),r=Fe(e,"onClosed",3,()=>{}),o=I(0);Pe(()=>{const y=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",y),y(),()=>{window.removeEventListener("resize",y)}});const{dialogDec:s,dialogInc:i}=Qt(),l=Gn();Pe(()=>(i(),()=>{s()}));let u=I("closed");const c=()=>{f(u,"opening")},d=()=>{f(u,"swiping")},v=()=>{f(u,"opened")},h=()=>{e.onClose(),f(u,"closing")},p=()=>{f(u,"closed"),r()()};Ue(()=>{e.shown&&n(u)==="closed"?f(u,"preOpening"):!e.shown&&n(u)==="opened"&&f(u,"closing")}),Ue(()=>{n(u)==="closed"?(l.swipingRatio=0,l.duration=.2):(n(u)==="opened"||n(u)==="opening")&&(l.duration=.2,l.swipingRatio=25)});var m=we(),k=P(m);{var _=y=>{jh(y,{get dialogWidth(){return n(o)},get dialogState(){return n(u)},get title(){return e.title},onStartOpening:c,onOpened:v,onClose:h,onClosed:p,onSwipe:d,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(E,w)=>{var b=we(),T=P(b);He(T,()=>e.children),g(E,b)},$$slots:{default:!0}})};H(k,y=>{n(u)!=="closed"&&y(_)})}g(t,m),be()}const Uh=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};Pe(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),Pe(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var Wh=S('<button class="c d p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Vh=S('<div class="e p-phkj9l"> </div>'),qh=S('<button class="c f p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Kh=S('<dialog><div><div class="a p-phkj9l"><div class="b p-phkj9l"><div><!></div> <!> <div><!></div></div></div> <div class="g p-phkj9l"><!></div></div> <!></dialog> <!>',1);function Gh(t,e){ye(e,!0);let a=Fe(e,"blockedDialog",3,!1),r=Fe(e,"hiddenDialog",3,!1),o=Fe(e,"isDesktopAnimationOff",3,!1),s=I(null),i=I(null),l=I(!1),u=I(null);Uh({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const c=Gn();Ue(()=>{e.stateDialog==="closing"&&(c.working?n(i)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const{getDialogPageHeight:d}=ds(),v=x(d);Pe(()=>{setTimeout(()=>{f(l,!0)},50)});var h=Kh(),p=P(h),m=C(p),k=C(m),_=C(k),y=C(_),E=C(y);{var w=F=>{var z=Wh();z.__click=()=>{e.onStartBack()};var me=C(z);ve(me,()=>({"--size":"24px"})),he(me.lastChild,{name:"back"});var Se=A(me,2);_t(Se,{children:(j,O)=>{var Q=Ke("back");g(j,Q)}}),g(F,z)};H(E,F=>{(!(a()||r())||a())&&e.onStartBack&&F(w)})}var b=A(y,2);{var T=F=>{var z=Vh(),me=C(z);De(()=>vt(me,e.title)),g(F,z)};H(b,F=>{e.title&&F(T)})}var X=A(b,2),U=C(X);{var q=F=>{var z=qh();z.__click=()=>{e.onStartClose()};var me=C(z);ve(me,()=>({"--size":"24px"})),he(me.lastChild,{name:"close"});var Se=A(me,2);_t(Se,{children:(j,O)=>{var Q=Ke("close");g(j,Q)}}),g(F,z)};H(U,F=>{a()||r()||F(q)})}var R=A(k,2),ee=C(R);He(ee,()=>e.children),$e(m,F=>f(i,F),()=>n(i));var re=A(m,2);go(re,{get ref(){return n(u)},set ref(F){f(u,F,!0)}}),$e(p,F=>f(s,F),()=>n(s));var Y=A(p,2);us(Y,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose},get notificationRef(){return n(u)},set notificationRef(F){f(u,F,!0)}}),De(()=>{et(p,1,nt({h:!0,i:e.stateDialog==="open",j:n(l),k:c.working,l:o(),m:r()}),"p-phkj9l"),$a(m,`height: ${n(v)+74}px`),et(m,1,nt({n:!0,i:e.stateDialog==="open",j:n(l),k:c.working,l:o()}),"p-phkj9l")}),g(t,h),be()}pt(["click"]);const Yh=({onStartClose:t,onClosed:e})=>{let a=I("close");return{get state(){return n(a)},set state(i){f(a,i,!0)},handleStartClose:(i=!1)=>{i||(f(a,"closing"),t?.())},handleOpen:()=>{f(a,"open")},handleClose:()=>{f(a,"close"),e?.()}}};function Xh(t,e){ye(e,!0);let a=Fe(e,"blockedDialog",3,!1),r=Fe(e,"hiddenDialog",3,!1),o=Fe(e,"onStartClose",3,()=>{}),s=Fe(e,"onClosed",3,()=>{}),i=Yh({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:l,dialogInc:u}=Qt();Pe(()=>(u(),()=>{l()})),Ue(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const c=p=>{p.key==="Escape"&&a()&&(p.preventDefault(),p.stopPropagation())};Pe(()=>(document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}));var d=we(),v=P(d);{var h=p=>{Gh(p,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(m,k)=>{var _=we(),y=P(_);He(y,()=>e.children),g(m,_)},$$slots:{default:!0}})};H(v,p=>{i.state!=="close"&&p(h)})}g(t,d),be()}const js=(t,e=Xe,a=Xe,r)=>{let o=Pr(()=>Rl(r?.(),!1));var s=we(),i=P(s);{var l=c=>{Ct(c,{children:(d,v)=>{Mt(d,{get hidden(){return n(o)},get page(){return Te.Settings}})},$$slots:{default:!0}})},u=c=>{var d=we(),v=P(d);{var h=m=>{Ct(m,{children:(k,_)=>{dh(k,{})},$$slots:{default:!0}})},p=m=>{var k=we(),_=P(k);{var y=w=>{Ct(w,{children:(b,T)=>{Mt(b,{get params(){return a()},get hidden(){return n(o)},get page(){return Te.Note}})},$$slots:{default:!0}})},E=w=>{var b=we(),T=P(b);{var X=q=>{Ct(q,{children:(R,ee)=>{Mt(R,{get hidden(){return n(o)},get page(){return Te.ImportData}})},$$slots:{default:!0}})},U=q=>{var R=we(),ee=P(R);{var re=F=>{Ct(F,{children:(z,me)=>{Mt(z,{get hidden(){return n(o)},get page(){return Te.ExportData}})},$$slots:{default:!0}})},Y=F=>{var z=we(),me=P(z);{var Se=O=>{Ct(O,{children:(Q,ne)=>{vg(Q,{})},$$slots:{default:!0}})},j=O=>{var Q=we(),ne=P(Q);{var ie=Ee=>{Ct(Ee,{children:(Le,ge)=>{Mt(Le,{get hidden(){return n(o)},get page(){return Te.Install}})},$$slots:{default:!0}})},se=Ee=>{var Le=we(),ge=P(Le);{var ue=G=>{Ct(G,{children:(te,Ce)=>{Mt(te,{get hidden(){return n(o)},get page(){return Te.InstallSuccess}})},$$slots:{default:!0}})},Ae=G=>{var te=we(),Ce=P(te);{var xe=ae=>{Ct(ae,{children:(ke,pe)=>{Mt(ke,{get hidden(){return n(o)},get page(){return Te.Auth}})},$$slots:{default:!0}})},ce=ae=>{var ke=we(),pe=P(ke);{var Re=_e=>{Ct(_e,{children:(Be,Me)=>{Mt(Be,{get hidden(){return n(o)},get page(){return Te.Signup}})},$$slots:{default:!0}})},$=_e=>{var Be=we(),Me=P(Be);{var Je=W=>{Ct(W,{children:(V,M)=>{Mt(V,{get hidden(){return n(o)},get page(){return Te.Signin}})},$$slots:{default:!0}})},N=W=>{var V=we(),M=P(V);{var D=le=>{Ct(le,{children:(J,fe)=>{Mt(J,{get hidden(){return n(o)},get page(){return Te.AccessKeys}})},$$slots:{default:!0}})},L=le=>{var J=we(),fe=P(J);{var B=oe=>{Ct(oe,{children:(de,Ne)=>{Mt(de,{get hidden(){return n(o)},get page(){return Te.Account}})},$$slots:{default:!0}})},Z=oe=>{var de=we(),Ne=P(de);{var Ve=Oe=>{Ct(Oe,{children:(ze,je)=>{Mt(ze,{get hidden(){return n(o)},get page(){return Te.ConfirmAccessKey}})},$$slots:{default:!0}})},Ie=Oe=>{var ze=we(),je=P(ze);{var wt=st=>{Ct(st,{children:(lt,mt)=>{Mt(lt,{get hidden(){return n(o)},get page(){return Te.Exit}})},$$slots:{default:!0}})},at=st=>{var lt=we(),mt=P(lt);{var En=Tt=>{var Dt=we(),mo=P(Dt);{var _o=Ra=>{Ct(Ra,{children:(Ir,fs)=>{Mt(Ir,{get hidden(){return n(o)},get page(){return Te.Sync}})},$$slots:{default:!0}})},yl=Ra=>{var Ir=we(),fs=P(Ir);{var bl=Fa=>{Ct(Fa,{children:(Lr,vs)=>{Mt(Lr,{get hidden(){return n(o)},get page(){return Te.Subscription}})},$$slots:{default:!0}})},Cl=Fa=>{var Lr=we(),vs=P(Lr);{var Sl=Oa=>{Ct(Oa,{children:(wo,xl)=>{Mt(wo,{get hidden(){return n(o)},get page(){return Te.About}})},$$slots:{default:!0}})},kl=Oa=>{Ct(Oa,{children:(wo,xl)=>{lg(wo,{})},$$slots:{default:!0}})};H(vs,Oa=>{e()===Te.About?Oa(Sl):Oa(kl,!1)},!0)}g(Fa,Lr)};H(fs,Fa=>{e()===Te.Subscription?Fa(bl):Fa(Cl,!1)},!0)}g(Ra,Ir)};H(mo,Ra=>{e()===Te.Sync?Ra(_o):Ra(yl,!1)},!0)}g(Tt,Dt)};H(mt,Tt=>{e(),Te.Extension,Tt(En,!1)},!0)}g(st,lt)};H(je,st=>{e()===Te.Exit?st(wt):st(at,!1)},!0)}g(Oe,ze)};H(Ne,Oe=>{e()===Te.ConfirmAccessKey?Oe(Ve):Oe(Ie,!1)},!0)}g(oe,de)};H(fe,oe=>{e()===Te.Account?oe(B):oe(Z,!1)},!0)}g(le,J)};H(M,le=>{e()===Te.AccessKeys?le(D):le(L,!1)},!0)}g(W,V)};H(Me,W=>{e()===Te.Signin?W(Je):W(N,!1)},!0)}g(_e,Be)};H(pe,_e=>{e()===Te.Signup?_e(Re):_e($,!1)},!0)}g(ae,ke)};H(Ce,ae=>{e()===Te.Auth?ae(xe):ae(ce,!1)},!0)}g(G,te)};H(ge,G=>{e()===Te.InstallSuccess?G(ue):G(Ae,!1)},!0)}g(Ee,Le)};H(ne,Ee=>{e()===Te.Install?Ee(ie):Ee(se,!1)},!0)}g(O,Q)};H(me,O=>{e()===Te.AccountSetup?O(Se):O(j,!1)},!0)}g(F,z)};H(ee,F=>{e()===Te.ExportData?F(re):F(Y,!1)},!0)}g(q,R)};H(T,q=>{e()===Te.ImportData?q(X):q(U,!1)},!0)}g(w,b)};H(_,w=>{e()===Te.Note?w(y):w(E,!1)},!0)}g(m,k)};H(v,m=>{e()===Te.NewNote?m(h):m(p,!1)},!0)}g(c,d)};H(i,c=>{e()===Te.Settings?c(l):c(u,!1)})}g(t,s)};var Jh=S("<!> <!>",1);function Zh(t,e){ye(e,!0);let a=x(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:r,checkClosableDialog:o}=Qt(),{sidebarClose:s,getSidebarState:i}=Ar(),l=x(r),u=x(o),{getDialogPages:c}=zt(),{getAccount:d}=ls();let v=x(c),h=x(()=>d()!==void 0);const{checkMobileSize:p}=ga();let m=I(ft([]));const k=x(p),{clearDialogPages:_,popDialogPage:y}=zt(),{checkLeftStart:E}=Qt();let w=x(E);Ue(()=>{c().length>0&&i()!=="closed"&&setTimeout(()=>{s()},60)});const b=()=>{y()},T=()=>{_()};Ue(()=>{n(v),n(k),Ot(()=>{if(n(k))n(v).length>=n(m).length||n(w)?f(m,n(v).map(F=>({page:F,shown:!0})),!0):f(m,n(m).map((F,z)=>({page:F.page,shown:z<n(v).length})),!0);else if(n(v).length>=n(m).length)f(m,n(v).map(F=>({page:F,shown:!0})),!0);else{if(n(v).length===0){f(m,[{page:n(m)[n(m).length-1].page,shown:!1}],!0);return}f(m,n(v).map(F=>({page:F,shown:!0})),!0)}})});const X=()=>{f(m,n(v).map(F=>({page:F,shown:!0})),!0)};var U=Jh(),q=P(U);{var R=F=>{Ih(F)};H(q,F=>{n(h)&&F(R)})}var ee=A(q,2);{var re=F=>{var z=we(),me=P(z);Bn(me,19,()=>n(m),Se=>Se.page.split("?")[0],(Se,j,O)=>{const Q=x(()=>n(j).page.split("?")[1]),ne=x(()=>n(j).page.split("?")[0]),ie=x(()=>n(O)!==n(m).length-1&&!!n(m)[n(O)+1]?.shown),se=x(()=>n(O)===0);{let Ee=x(()=>Ds[n(ne)]||""),Le=x(()=>n(l)||n(se)&&!n(u)),ge=x(()=>({...n(ne)!==Te.NewNote&&n(ne)!==Te.Note?n(a):{}}));Hh(Se,zo({get shown(){return n(j).shown},get title(){return n(Ee)},get hidden(){return n(ie)},get blocked(){return n(Le)},onClose:b,onClosed:X},()=>n(ge),{children:(ue,Ae)=>{js(ue,()=>n(ne),()=>n(Q),()=>n(ie))},$$slots:{default:!0}}))}}),g(F,z)},Y=F=>{var z=we(),me=P(z);{var Se=j=>{const O=x(()=>n(m)[n(m).length-1].page.split("?")[1]),Q=x(()=>n(m)[n(m).length-1].page.split("?")[0]),ne=x(()=>n(m)[n(m).length-1].shown),ie=x(()=>n(m).length===1);{let se=x(()=>Ds[n(Q)]||""),Ee=x(()=>n(l)||!n(u)),Le=x(()=>n(l)||n(ie)?void 0:b);Xh(j,{get shownDialog(){return n(ne)},get title(){return n(se)},get blockedDialog(){return n(Ee)},hiddenDialog:!1,get onStartBack(){return n(Le)},onStartClose:T,onClosed:X,children:(ge,ue)=>{js(ge,()=>n(Q),()=>n(O))},$$slots:{default:!0}})}};H(me,j=>{n(m).length>0&&j(Se)},!0)}g(F,z)};H(ee,F=>{p()?F(re):F(Y,!1)})}g(t,U),be()}function Qh(t,e){ye(e,!1);let a=0;Pe(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),ss(),be()}const $h=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;var ep=S('<div><button class="d p-bn1wva"><!> <span class="e p-bn1wva"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),tp=S('<!> <!> <!> <!> <main><div class="a p-bn1wva"><div class="b p-bn1wva"><!></div></div> <div class="c p-bn1wva"><!></div></main> <!>',1);function np(t,e){ye(e,!0);const{replaceSearchParams:a,getHref:r,getSearchParams:o}=Bt(),{hasDialogPage:s}=zt(),{setScrollContainer:i}=vo(),{getAccount:l,init:u}=ls(),{isInitedNotes:c}=At(),{isInitedSettings:d}=Hn(),{isInited:v}=Ud(),{getDialogPages:h}=zt(),{createBroadcastChannel:p,tabId:m}=uo(),k=p(),{getSidebarState:_}=Ar(),{setClosableDialog:y}=Qt(),{getViewMode:E}=Hn(),w=()=>{$h()?a(`${tn}=${Te.AccountSetup}`):a(`${tn}=${Te.Install}`)};Pe(()=>{u(_e=>{_e===void 0?w():(s(Te.AccountSetup)&&a(""),_e?f(q,_e):f(q,null))});const $=async _e=>{const Be=JSON.parse(_e.data);if(Be.tabId&&Be.tabId===m)return;const Me=Be;Me.type==="initLocalAccount"||Me.type==="initCloudAccount"||Me.type==="updateAccount"||Me.type==="disconnectCloudAccount"?a(""):Me.type==="exit"&&w()};return k.addEventListener($),()=>k.removeEventListener($)});const b=Gn();Pe(async()=>{await new Promise($=>setTimeout($,60)),await Ai(),b.working=!0});let T=I(!1),X=0,U=x(()=>h().length>0),q=x(l),R=x(c),ee=x(d),re=x(v),Y=I(null);const F=()=>{n(Y)&&n(Y).scrollTo({top:0})};Ue(()=>{y(n(q)!==void 0)}),Ue(()=>{i(n(Y))});const z=()=>{if(n(Y)){const $=n(Y).scrollTop||0;$===0?f(T,!1):!n(T)&&X>$?f(T,!0):n(T)&&X+50<$&&f(T,!1),X=$}},me=()=>{z()};Ue(()=>(n(Y)?.addEventListener("scroll",me),window.addEventListener("resize",me),()=>{n(Y)?.removeEventListener("scroll",me),window.removeEventListener("resize",me)}));const Se=x(_);let j=x(()=>b.swipingRatio);const O=()=>{const $=new URLSearchParams(o());return r($)},Q=async $=>{$.preventDefault()},ne=x(E),ie=x(()=>n(ne)==="popup"?{onOpenWindow:Q,openWindowHref:O()}:{});var se=tp(),Ee=P(se);Qh(Ee,{});var Le=A(Ee,2);ju(Le,{});var ge=A(Le,2);go(ge,{});var ue=A(ge,2);lf(ue,{});var Ae=A(ue,2),G=C(Ae),te=C(G),Ce=C(te);{var xe=$=>{og($,zo(()=>n(ie)))};H(Ce,$=>{n(re)&&n(ee)&&n(q)!==void 0&&$(xe)})}var ce=A(G,2),ae=C(ce);{var ke=$=>{Zh($,zo(()=>n(ie)))};H(ae,$=>{n(R)&&n(ee)&&n(re)&&$(ke)})}$e(Ae,$=>f(Y,$),()=>n(Y));var pe=A(Ae,2);{var Re=$=>{var _e=ep(),Be=C(_e);Be.__click=F;var Me=C(Be);_t(Me,{children:(W,V)=>{var M=Ke("top");g(W,M)}});var Je=A(Me,2),N=C(Je);ve(N,()=>({"--rotate":"90deg","--size":"28px"})),he(N.lastChild,{name:"back"}),De(()=>{$a(_e,`--swiping-ratio: ${n(j)}; --transition-timing-default: ${b.duration}s;`),et(_e,1,nt({i:!0,g:b.working&&!b.isSwiping,j:n(U)||n(Se)!=="closed"}),"p-bn1wva")}),g($,_e)};H(pe,$=>{n(T)&&$(Re)})}De(()=>{$a(Ae,`--swiping-ratio: ${n(j)}; --transition-timing-default: ${b.duration}s;`),et(Ae,1,nt({f:!0,g:b.working&&!b.isSwiping,h:n(Se)!=="closed"}),"p-bn1wva")}),g(t,se),be()}pt(["click"]);function ap(t){vu(t,{children:(e,a)=>{np(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||Vc(ap,{target:document.getElementById("app")});export{ut as $,x as A,Rt as B,Bt as C,ls as D,ss as E,Cr as F,Zt as G,dg as H,he as I,At as J,ga as K,La as L,Hn as M,hl as N,nl as O,Te as P,As as Q,Zn as R,$e as S,up as T,dp as U,_t as V,Cu as W,Su as X,tn as Y,yr as Z,Ot as _,f as a,_n as a0,ch as a1,uo as a2,ip as a3,lp as a4,$h as a5,sp as a6,Fe as a7,$a as a8,cp as a9,I as b,C as c,ve as d,Bn as e,S as f,n as g,dt as h,g as i,H as j,et as k,nt as l,be as m,P as n,Pe as o,ye as p,vt as q,pt as r,A as s,De as t,zt as u,Qt as v,ft as w,Ue as x,we as y,Ke as z};
