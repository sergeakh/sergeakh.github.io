const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/aDgnYCfnY.js","a/aDWMAZur3.css","a/ays5xQXqF.js","a/a9q_jSmK4.js","a/agMDNaL23.js","a/aBrkJtqMH.css","a/aCYJjaWal.js","a/aDB02xhFr.css","a/aCX5WfDvF.js","a/a54d_SC5m.css","a/aB8F5tlht.js","a/afGUkjeV7.css","a/aDXxo9PBJ.js","a/aiSyTfFbW.css","a/aDAnbn2kO.js","a/a3HMLpT7s.js","a/aenMKNzfI.css","a/aBsesnmW0.js","a/aCpd7MTd8.css","a/aC969LWc5.css","a/aCdZ96SLM.js","a/aCeh8XjKC.css","a/agAN_g5qO.js","a/aCBPoPn5g.css","a/aEr-7mI7t.js","a/aBem4Ctjp.css","a/aC3V1N5Nb.js","a/aK1a0NeEW.css","a/aBattIXcC.js","a/aBdnakgrk.css","a/aBpLx_8XO.js","a/aDzsMVVo5.css","a/aCsyAmorL.js","a/aCH18nfIo.css","a/aBz-97OBh.js","a/atfCB4r7e.js","a/aCb6DfA6m.css","a/aBYo95QHi.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var gc=Object.defineProperty;var Os=t=>{throw TypeError(t)};var hc=(t,e,a)=>e in t?gc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var Nt=(t,e,a)=>hc(t,typeof e!="symbol"?e+"":e,a),Io=(t,e,a)=>e.has(t)||Os("Cannot "+a);var I=(t,e,a)=>(Io(t,e,"read from private field"),a?a.call(t):e.get(t)),De=(t,e,a)=>e.has(t)?Os("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),Re=(t,e,a,r)=>(Io(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),ut=(t,e,a)=>(Io(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const pc=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};pc(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const mc=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};mc();const Fo=!1;var ds=Array.isArray,_c=Array.prototype.indexOf,tr=Array.prototype.includes,po=Array.from,wc=Object.defineProperty,na=Object.getOwnPropertyDescriptor,gi=Object.getOwnPropertyDescriptors,hi=Object.prototype,yc=Array.prototype,mo=Object.getPrototypeOf,zs=Object.isExtensible;function gr(t){return typeof t=="function"}const Ue=()=>{};function bc(t){return typeof t?.then=="function"}function Sc(t){return t()}function Oo(t){for(var e=0;e<t.length;e++)t[e]()}function pi(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function kc(t,e,a=!1){return t===void 0?a?e():e:t}const bt=2,oo=4,Ir=8,mi=1<<24,Vn=16,dn=32,Aa=64,us=128,$t=512,wt=1024,St=2048,cn=4096,Ut=8192,Ln=16384,fs=32768,la=65536,Bs=1<<17,_i=1<<18,lr=1<<19,wi=1<<20,Mn=1<<25,Pa=32768,zo=1<<21,vs=1<<22,aa=1<<23,ra=Symbol("$state"),yi=Symbol("legacy props"),Cc=Symbol(""),Ua=new class extends Error{constructor(){super(...arguments);Nt(this,"name","StaleReactionError");Nt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function bi(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function xc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Tc(t,e,a){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Ec(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Nc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Pc(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Ac(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Dc(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ic(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Mc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Lc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Rc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Fc=1,Oc=2,Si=4,zc=8,Bc=16,jc=1,Hc=2,Uc=4,Wc=8,Vc=16,qc=1,Kc=2,mt=Symbol(),Gc="http://www.w3.org/1999/xhtml";function ki(t){return t===this.v}function Yc(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ci(t){return!Yc(t,this.v)}let cr=!1,Xc=!1;function Jc(){cr=!0}const Zc=[];function pa(t,e=!1,a=!1){return Qr(t,new Map,"",Zc,null,a)}function Qr(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(ds(t)){var c=Array(t.length);e.set(t,c),o!==null&&e.set(o,c);for(var l=0;l<t.length;l+=1){var d=t[l];l in t&&(c[l]=Qr(d,e,a,r,null,s))}return c}if(mo(t)===hi){c={},e.set(t,c),o!==null&&e.set(o,c);for(var u in t)c[u]=Qr(t[u],e,a,r,null,s);return c}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return Qr(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let $e=null;function nr(t){$e=t}function rt(t){return xi().get(t)}function ot(t,e){return xi().set(t,e),e}function ge(t,e=!1,a){$e={p:$e,i:!1,c:null,e:null,s:t,x:null,l:cr&&!e?{s:null,u:null,$:[]}:null}}function he(t){var e=$e,a=e.e;if(a!==null){e.e=null;for(var r of a)Gi(r)}return t!==void 0&&(e.x=t),e.i=!0,$e=e.p,t??{}}function dr(){return!cr||$e!==null&&$e.l===null}function xi(t){return $e===null&&bi(),$e.c??($e.c=new Map(Qc($e)||void 0))}function Qc(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let wa=[];function Ti(){var t=wa;wa=[],Oo(t)}function wn(t){if(wa.length===0&&!qa){var e=wa;queueMicrotask(()=>{e===wa&&Ti()})}wa.push(t)}function $c(){for(;wa.length>0;)Ti()}function Ei(t){var e=We;if(e===null)return ze.f|=aa,t;if((e.f&fs)===0){if((e.f&us)===0)throw t;e.b.error(t)}else ar(t,e)}function ar(t,e){for(;e!==null;){if((e.f&us)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const ed=-7169;function lt(t,e){t.f=t.f&ed|e}function gs(t){(t.f&$t)!==0||t.deps===null?lt(t,wt):lt(t,cn)}function Ni(t){if(t!==null)for(const e of t)(e.f&bt)===0||(e.f&Pa)===0||(e.f^=Pa,Ni(e.deps))}function Pi(t,e,a){(t.f&St)!==0?e.add(t):(t.f&cn)!==0&&a.add(t),Ni(t.deps),lt(t,wt)}const Yr=new Set;let qe=null,Bo=null,on=null,Mt=[],_o=null,jo=!1,qa=!1;var Ga,Ya,ba,Xa,Nr,Pr,Sa,An,Ja,Sn,Ho,Uo,Ai;const Ts=class Ts{constructor(){De(this,Sn);Nt(this,"committed",!1);Nt(this,"current",new Map);Nt(this,"previous",new Map);De(this,Ga,new Set);De(this,Ya,new Set);De(this,ba,0);De(this,Xa,0);De(this,Nr,null);De(this,Pr,new Set);De(this,Sa,new Set);De(this,An,new Map);Nt(this,"is_fork",!1);De(this,Ja,!1)}is_deferred(){return this.is_fork||I(this,Xa)>0}skip_effect(e){I(this,An).has(e)||I(this,An).set(e,{d:[],m:[]})}unskip_effect(e){var a=I(this,An).get(e);if(a){I(this,An).delete(e);for(var r of a.d)lt(r,St),sn(r);for(r of a.m)lt(r,cn),sn(r)}}process(e){Mt=[],this.apply();var a=[],r=[];for(const o of e)ut(this,Sn,Ho).call(this,o,a,r);if(this.is_deferred()){ut(this,Sn,Uo).call(this,r),ut(this,Sn,Uo).call(this,a);for(const[o,s]of I(this,An))Ri(o,s)}else{for(const o of I(this,Ga))o();I(this,Ga).clear(),I(this,ba)===0&&ut(this,Sn,Ai).call(this),Bo=this,qe=null,js(r),js(a),Bo=null,I(this,Nr)?.resolve()}on=null}capture(e,a){a!==mt&&!this.previous.has(e)&&this.previous.set(e,a),(e.f&aa)===0&&(this.current.set(e,e.v),on?.set(e,e.v))}activate(){qe=this,this.apply()}deactivate(){qe===this&&(qe=null,on=null)}flush(){if(this.activate(),Mt.length>0){if(Ii(),qe!==null&&qe!==this)return}else I(this,ba)===0&&this.process([]);this.deactivate()}discard(){for(const e of I(this,Ya))e(this);I(this,Ya).clear()}increment(e){Re(this,ba,I(this,ba)+1),e&&Re(this,Xa,I(this,Xa)+1)}decrement(e){Re(this,ba,I(this,ba)-1),e&&Re(this,Xa,I(this,Xa)-1),!I(this,Ja)&&(Re(this,Ja,!0),wn(()=>{Re(this,Ja,!1),this.is_deferred()?Mt.length>0&&this.flush():this.revive()}))}revive(){for(const e of I(this,Pr))I(this,Sa).delete(e),lt(e,St),sn(e);for(const e of I(this,Sa))lt(e,cn),sn(e);this.flush()}oncommit(e){I(this,Ga).add(e)}ondiscard(e){I(this,Ya).add(e)}settled(){return(I(this,Nr)??Re(this,Nr,pi())).promise}static ensure(){if(qe===null){const e=qe=new Ts;Yr.add(qe),qa||wn(()=>{qe===e&&e.flush()})}return qe}apply(){}};Ga=new WeakMap,Ya=new WeakMap,ba=new WeakMap,Xa=new WeakMap,Nr=new WeakMap,Pr=new WeakMap,Sa=new WeakMap,An=new WeakMap,Ja=new WeakMap,Sn=new WeakSet,Ho=function(e,a,r){e.f^=wt;for(var o=e.first,s=null;o!==null;){var i=o.f,c=(i&(dn|Aa))!==0,l=c&&(i&wt)!==0,d=l||(i&Ut)!==0||I(this,An).has(o);if(!d&&o.fn!==null){c?o.f^=wt:s!==null&&(i&(oo|Ir|mi))!==0?s.b.defer_effect(o):(i&oo)!==0?a.push(o):Fr(o)&&((i&Vn)!==0&&I(this,Sa).add(o),kr(o));var u=o.first;if(u!==null){o=u;continue}}var f=o.parent;for(o=o.next;o===null&&f!==null;)f===s&&(s=null),o=f.next,f=f.parent}},Uo=function(e){for(var a=0;a<e.length;a+=1)Pi(e[a],I(this,Pr),I(this,Sa))},Ai=function(){var o;if(Yr.size>1){this.previous.clear();var e=on,a=!0;for(const s of Yr){if(s===this){a=!1;continue}const i=[];for(const[l,d]of this.current){if(s.current.has(l))if(a&&d!==s.current.get(l))s.current.set(l,d);else continue;i.push(l)}if(i.length===0)continue;const c=[...s.current.keys()].filter(l=>!this.current.has(l));if(c.length>0){var r=Mt;Mt=[];const l=new Set,d=new Map;for(const u of i)Mi(u,c,l,d);if(Mt.length>0){qe=s,s.apply();for(const u of Mt)ut(o=s,Sn,Ho).call(o,u,[],[]);s.deactivate()}Mt=r}}qe=null,on=e}this.committed=!0,Yr.delete(this)};let Rn=Ts;function Di(t){var e=qa;qa=!0;try{for(var a;;){if($c(),Mt.length===0&&(qe?.flush(),Mt.length===0))return _o=null,a;Ii()}}finally{qa=e}}function Ii(){jo=!0;var t=null;try{for(var e=0;Mt.length>0;){var a=Rn.ensure();if(e++>1e3){var r,o;td()}a.process(Mt),oa.clear()}}finally{Mt=[],jo=!1,_o=null}}function td(){try{Ac()}catch(t){ar(t,_o)}}let Nn=null;function js(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Ln|Ut))===0&&Fr(r)&&(Nn=new Set,kr(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Ji(r):r.fn=null),Nn?.size>0)){oa.clear();for(const o of Nn){if((o.f&(Ln|Ut))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)Nn.has(i)&&(Nn.delete(i),s.push(i)),i=i.parent;for(let c=s.length-1;c>=0;c--){const l=s[c];(l.f&(Ln|Ut))===0&&kr(l)}}Nn.clear()}}Nn=null}}function Mi(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&bt)!==0?Mi(o,e,a,r):(s&(vs|Vn))!==0&&(s&St)===0&&Li(o,e,r)&&(lt(o,St),sn(o))}}function Li(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(tr.call(e,o))return!0;if((o.f&bt)!==0&&Li(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function sn(t){for(var e=_o=t;e.parent!==null;){e=e.parent;var a=e.f;if(jo&&e===We&&(a&Vn)!==0&&(a&_i)===0)return;if((a&(Aa|dn))!==0){if((a&wt)===0)return;e.f^=wt}}Mt.push(e)}function Ri(t,e){if(!((t.f&dn)!==0&&(t.f&wt)!==0)){(t.f&St)!==0?e.d.push(t):(t.f&cn)!==0&&e.m.push(t),lt(t,wt);for(var a=t.first;a!==null;)Ri(a,e),a=a.next}}function nd(t){let e=0,a=yn(0),r;return()=>{ps()&&(n(a),yo(()=>(e===0&&(r=ht(()=>t(()=>sa(a)))),e+=1,()=>{wn(()=>{e-=1,e===0&&(r?.(),r=void 0,sa(a))})})))}}var ad=la|lr|us;function rd(t,e,a){new od(t,e,a)}var Xt,cs,gn,ka,hn,Jt,It,pn,Dn,Qn,Ca,$n,Za,xa,Qa,$a,In,fo,yt,sd,id,Wo,$r,eo,Vo;class od{constructor(e,a,r){De(this,yt);Nt(this,"parent");Nt(this,"is_pending",!1);De(this,Xt);De(this,cs,null);De(this,gn);De(this,ka);De(this,hn);De(this,Jt,null);De(this,It,null);De(this,pn,null);De(this,Dn,null);De(this,Qn,null);De(this,Ca,0);De(this,$n,0);De(this,Za,!1);De(this,xa,!1);De(this,Qa,new Set);De(this,$a,new Set);De(this,In,null);De(this,fo,nd(()=>(Re(this,In,yn(I(this,Ca))),()=>{Re(this,In,null)})));Re(this,Xt,e),Re(this,gn,a),Re(this,ka,r),this.parent=We.b,this.is_pending=!!I(this,gn).pending,Re(this,hn,ur(()=>{We.b=this;{var o=ut(this,yt,Wo).call(this);try{Re(this,Jt,Zt(()=>r(o)))}catch(s){this.error(s)}I(this,$n)>0?ut(this,yt,eo).call(this):this.is_pending=!1}return()=>{I(this,Qn)?.remove()}},ad))}defer_effect(e){Pi(e,I(this,Qa),I(this,$a))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!I(this,gn).pending}update_pending_count(e){ut(this,yt,Vo).call(this,e),Re(this,Ca,I(this,Ca)+e),!(!I(this,In)||I(this,Za))&&(Re(this,Za,!0),wn(()=>{Re(this,Za,!1),I(this,In)&&Fn(I(this,In),I(this,Ca))}))}get_effect_pending(){return I(this,fo).call(this),n(I(this,In))}error(e){var a=I(this,gn).onerror;let r=I(this,gn).failed;if(I(this,xa)||!a&&!r)throw e;I(this,Jt)&&(Ft(I(this,Jt)),Re(this,Jt,null)),I(this,It)&&(Ft(I(this,It)),Re(this,It,null)),I(this,pn)&&(Ft(I(this,pn)),Re(this,pn,null));var o=!1,s=!1;const i=()=>{if(o){return}o=!0,s&&Rc(),Rn.ensure(),Re(this,Ca,0),I(this,pn)!==null&&Ea(I(this,pn),()=>{Re(this,pn,null)}),this.is_pending=this.has_pending_snippet(),Re(this,Jt,ut(this,yt,$r).call(this,()=>(Re(this,xa,!1),Zt(()=>I(this,ka).call(this,I(this,Xt)))))),I(this,$n)>0?ut(this,yt,eo).call(this):this.is_pending=!1};wn(()=>{try{s=!0,a?.(e,i),s=!1}catch(c){ar(c,I(this,hn)&&I(this,hn).parent)}r&&Re(this,pn,ut(this,yt,$r).call(this,()=>{Rn.ensure(),Re(this,xa,!0);try{return Zt(()=>{r(I(this,Xt),()=>e,()=>i)})}catch(c){return ar(c,I(this,hn).parent),null}finally{Re(this,xa,!1)}}))})}}Xt=new WeakMap,cs=new WeakMap,gn=new WeakMap,ka=new WeakMap,hn=new WeakMap,Jt=new WeakMap,It=new WeakMap,pn=new WeakMap,Dn=new WeakMap,Qn=new WeakMap,Ca=new WeakMap,$n=new WeakMap,Za=new WeakMap,xa=new WeakMap,Qa=new WeakMap,$a=new WeakMap,In=new WeakMap,fo=new WeakMap,yt=new WeakSet,sd=function(){try{Re(this,Jt,Zt(()=>I(this,ka).call(this,I(this,Xt))))}catch(e){this.error(e)}},id=function(){const e=I(this,gn).pending;e&&(Re(this,It,Zt(()=>e(I(this,Xt)))),wn(()=>{var a=ut(this,yt,Wo).call(this);Re(this,Jt,ut(this,yt,$r).call(this,()=>(Rn.ensure(),Zt(()=>I(this,ka).call(this,a))))),I(this,$n)>0?ut(this,yt,eo).call(this):(Ea(I(this,It),()=>{Re(this,It,null)}),this.is_pending=!1)}))},Wo=function(){var e=I(this,Xt);return this.is_pending&&(Re(this,Qn,On()),I(this,Xt).before(I(this,Qn)),e=I(this,Qn)),e},$r=function(e){var a=We,r=ze,o=$e;bn(I(this,hn)),tn(I(this,hn)),nr(I(this,hn).ctx);try{return e()}catch(s){return Ei(s),null}finally{bn(a),tn(r),nr(o)}},eo=function(){const e=I(this,gn).pending;I(this,Jt)!==null&&(Re(this,Dn,document.createDocumentFragment()),I(this,Dn).append(I(this,Qn)),$i(I(this,Jt),I(this,Dn))),I(this,It)===null&&Re(this,It,Zt(()=>e(I(this,Xt))))},Vo=function(e){var a;if(!this.has_pending_snippet()){this.parent&&ut(a=this.parent,yt,Vo).call(a,e);return}if(Re(this,$n,I(this,$n)+e),I(this,$n)===0){this.is_pending=!1;for(const r of I(this,Qa))lt(r,St),sn(r);for(const r of I(this,$a))lt(r,cn),sn(r);I(this,Qa).clear(),I(this,$a).clear(),I(this,It)&&Ea(I(this,It),()=>{Re(this,It,null)}),I(this,Dn)&&(I(this,Xt).before(I(this,Dn)),Re(this,Dn,null))}};function ld(t,e,a,r){const o=dr()?Mr:Lr;var s=t.filter(h=>!h.settled);if(a.length===0&&s.length===0){r(e.map(o));return}var i=qe,c=We,l=Fi(),d=s.length===1?s[0].promise:s.length>1?Promise.all(s.map(h=>h.promise)):null;function u(h){l();try{r(h)}catch(m){(c.f&Ln)===0&&ar(m,c)}i?.deactivate(),so()}if(a.length===0){d.then(()=>u(e.map(o)));return}function f(){l(),Promise.all(a.map(h=>cd(h))).then(h=>u([...e.map(o),...h])).catch(h=>ar(h,c))}d?d.then(f):f()}function Fi(){var t=We,e=ze,a=$e,r=qe;return function(s=!0){bn(t),tn(e),nr(a),s&&r?.activate()}}function so(){bn(null),tn(null),nr(null)}function Mr(t){var e=bt|St,a=ze!==null&&(ze.f&bt)!==0?ze:null;return We!==null&&(We.f|=lr),{ctx:$e,deps:null,effects:null,equals:ki,f:e,fn:t,reactions:null,rv:0,v:mt,wv:0,parent:a??We,ac:null}}function cd(t,e,a){let r=We;r===null&&xc();var o=r.b,s=void 0,i=yn(mt),c=!ze,l=new Map;return yd(()=>{var d=pi();s=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{u===qe&&u.committed&&u.deactivate(),so()})}catch(m){d.reject(m),so()}var u=qe;if(c){var f=o.is_rendered();o.update_pending_count(1),u.increment(f),l.get(u)?.reject(Ua),l.delete(u),l.set(u,d)}const h=(m,g=void 0)=>{if(u.activate(),g)g!==Ua&&(i.f|=aa,Fn(i,g));else{(i.f&aa)!==0&&(i.f^=aa),Fn(i,m);for(const[w,_]of l){if(l.delete(w),w===u)break;_.reject(Ua)}}c&&(o.update_pending_count(-1),u.decrement(f))};d.promise.then(h,m=>h(null,m||"unknown"))}),Ki(()=>{for(const d of l.values())d.reject(Ua)}),new Promise(d=>{function u(f){function h(){f===s?d(i):u(s)}f.then(h,h)}u(s)})}function T(t){const e=Mr(t);return el(e),e}function Lr(t){const e=Mr(t);return e.equals=Ci,e}function Oi(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)Ft(e[a])}}function dd(t){for(var e=t.parent;e!==null;){if((e.f&bt)===0)return(e.f&Ln)===0?e:null;e=e.parent}return null}function hs(t){var e,a=We;bn(dd(t));try{t.f&=~Pa,Oi(t),e=rl(t)}finally{bn(a)}return e}function zi(t){var e=hs(t);if(!t.equals(e)&&(t.wv=nl(),(!qe?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){lt(t,wt);return}ca||(on!==null?(ps()||qe?.is_fork)&&on.set(t,e):gs(t))}let qo=new Set;const oa=new Map;let Bi=!1;function yn(t,e){var a={f:0,v:t,reactions:null,equals:ki,rv:0,wv:0};return a}function A(t,e){const a=yn(t);return el(a),a}function Ko(t,e=!1,a=!0){var o;const r=yn(t);return e||(r.equals=Ci),cr&&a&&$e!==null&&$e.l!==null&&((o=$e.l).s??(o.s=[])).push(r),r}function v(t,e,a=!1){ze!==null&&(!ln||(ze.f&Bs)!==0)&&dr()&&(ze.f&(bt|Vn|vs|Bs))!==0&&(en===null||!tr.call(en,t))&&Lc();let r=a?et(e):e;return Fn(t,r)}function Fn(t,e){if(!t.equals(e)){var a=t.v;ca?oa.set(t,e):oa.set(t,a),t.v=e;var r=Rn.ensure();if(r.capture(t,a),(t.f&bt)!==0){const o=t;(t.f&St)!==0&&hs(o),gs(o)}t.wv=nl(),ji(t,St),dr()&&We!==null&&(We.f&wt)!==0&&(We.f&(dn|Aa))===0&&(Yt===null?kd([t]):Yt.push(t)),!r.is_fork&&qo.size>0&&!Bi&&ud()}return e}function ud(){Bi=!1;for(const t of qo)(t.f&wt)!==0&&lt(t,cn),Fr(t)&&kr(t);qo.clear()}function sa(t){v(t,t.v+1)}function ji(t,e){var a=t.reactions;if(a!==null)for(var r=dr(),o=a.length,s=0;s<o;s++){var i=a[s],c=i.f;if(!(!r&&i===We)){var l=(c&St)===0;if(l&&lt(i,e),(c&bt)!==0){var d=i;on?.delete(d),(c&Pa)===0&&(c&$t&&(i.f|=Pa),ji(d,cn))}else l&&((c&Vn)!==0&&Nn!==null&&Nn.add(i),sn(i))}}}function et(t){if(typeof t!="object"||t===null||ra in t)return t;const e=mo(t);if(e!==hi&&e!==yc)return t;var a=new Map,r=ds(t),o=A(0),s=zn,i=c=>{if(zn===s)return c();var l=ze,d=zn;tn(null),Vs(s);var u=c();return tn(l),Vs(d),u};return r&&a.set("length",A(t.length)),new Proxy(t,{defineProperty(c,l,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Ic();var u=a.get(l);return u===void 0?u=i(()=>{var f=A(d.value);return a.set(l,f),f}):v(u,d.value,!0),!0},deleteProperty(c,l){var d=a.get(l);if(d===void 0){if(l in c){const u=i(()=>A(mt));a.set(l,u),sa(o)}}else v(d,mt),sa(o);return!0},get(c,l,d){if(l===ra)return t;var u=a.get(l),f=l in c;if(u===void 0&&(!f||na(c,l)?.writable)&&(u=i(()=>{var m=et(f?c[l]:mt),g=A(m);return g}),a.set(l,u)),u!==void 0){var h=n(u);return h===mt?void 0:h}return Reflect.get(c,l,d)},getOwnPropertyDescriptor(c,l){var d=Reflect.getOwnPropertyDescriptor(c,l);if(d&&"value"in d){var u=a.get(l);u&&(d.value=n(u))}else if(d===void 0){var f=a.get(l),h=f?.v;if(f!==void 0&&h!==mt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(c,l){if(l===ra)return!0;var d=a.get(l),u=d!==void 0&&d.v!==mt||Reflect.has(c,l);if(d!==void 0||We!==null&&(!u||na(c,l)?.writable)){d===void 0&&(d=i(()=>{var h=u?et(c[l]):mt,m=A(h);return m}),a.set(l,d));var f=n(d);if(f===mt)return!1}return u},set(c,l,d,u){var f=a.get(l),h=l in c;if(r&&l==="length")for(var m=d;m<f.v;m+=1){var g=a.get(m+"");g!==void 0?v(g,mt):m in c&&(g=i(()=>A(mt)),a.set(m+"",g))}if(f===void 0)(!h||na(c,l)?.writable)&&(f=i(()=>A(void 0)),v(f,et(d)),a.set(l,f));else{h=f.v!==mt;var w=i(()=>et(d));v(f,w)}var _=Reflect.getOwnPropertyDescriptor(c,l);if(_?.set&&_.set.call(u,d),!h){if(r&&typeof l=="string"){var x=a.get("length"),K=Number(l);Number.isInteger(K)&&K>=x.v&&v(x,K+1)}sa(o)}return!0},ownKeys(c){n(o);var l=Reflect.ownKeys(c).filter(f=>{var h=a.get(f);return h===void 0||h.v!==mt});for(var[d,u]of a)u.v!==mt&&!(d in c)&&l.push(d);return l},setPrototypeOf(){Mc()}})}var Hs,Hi,Ui,Wi;function fd(){if(Hs===void 0){Hs=window,Hi=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;Ui=na(e,"firstChild").get,Wi=na(e,"nextSibling").get,zs(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),zs(a)&&(a.__t=void 0)}}function On(t=""){return document.createTextNode(t)}function rr(t){return Ui.call(t)}function Rr(t){return Wi.call(t)}function y(t,e){return rr(t)}function E(t,e=!1){{var a=rr(t);return a instanceof Comment&&a.data===""?Rr(a):a}}function P(t,e=1,a=!1){let r=t;for(;e--;)r=Rr(r);return r}function vd(t){t.textContent=""}function Vi(){return!1}let Us=!1;function gd(){Us||(Us=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function wo(t){var e=ze,a=We;tn(null),bn(null);try{return t()}finally{tn(e),bn(a)}}function hd(t,e,a,r=a){t.addEventListener(e,()=>wo(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),gd()}function qi(t){We===null&&(ze===null&&Pc(),Nc()),ca&&Ec()}function pd(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function kn(t,e,a){var r=We;r!==null&&(r.f&Ut)!==0&&(t|=Ut);var o={ctx:$e,deps:null,nodes:null,f:t|St|$t,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{kr(o),o.f|=fs}catch(c){throw Ft(o),c}else e!==null&&sn(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&lr)===0&&(s=s.first,(t&Vn)!==0&&(t&la)!==0&&s!==null&&(s.f|=la)),s!==null&&(s.parent=r,r!==null&&pd(s,r),ze!==null&&(ze.f&bt)!==0&&(t&Aa)===0)){var i=ze;(i.effects??(i.effects=[])).push(s)}return o}function ps(){return ze!==null&&!ln}function Ki(t){const e=kn(Ir,null,!1);return lt(e,wt),e.teardown=t,e}function Le(t){qi();var e=We.f,a=!ze&&(e&dn)!==0&&(e&fs)===0;if(a){var r=$e;(r.e??(r.e=[])).push(t)}else return Gi(t)}function Gi(t){return kn(oo|wi,t,!1)}function md(t){return qi(),kn(Ir|wi,t,!0)}function _d(t){Rn.ensure();const e=kn(Aa|lr,t,!0);return(a={})=>new Promise(r=>{a.outro?Ea(e,()=>{Ft(e),r(void 0)}):(Ft(e),r(void 0))})}function wd(t){return kn(oo,t,!1)}function yd(t){return kn(vs|lr,t,!0)}function yo(t,e=0){return kn(Ir|e,t,!0)}function ke(t,e=[],a=[],r=[]){ld(r,e,a,o=>{kn(Ir,()=>t(...o.map(n)),!0)})}function ur(t,e=0){var a=kn(Vn|e,t,!0);return a}function Zt(t){return kn(dn|lr,t,!0)}function Yi(t){var e=t.teardown;if(e!==null){const a=ca,r=ze;Ws(!0),tn(null);try{e.call(null)}finally{Ws(a),tn(r)}}}function Xi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&wo(()=>{o.abort(Ua)});var r=a.next;(a.f&Aa)!==0?a.parent=null:Ft(a,e),a=r}}function bd(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&dn)===0&&Ft(e),e=a}}function Ft(t,e=!0){var a=!1;(e||(t.f&_i)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Sd(t.nodes.start,t.nodes.end),a=!0),Xi(t,e&&!a),io(t,0),lt(t,Ln);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();Yi(t);var o=t.parent;o!==null&&o.first!==null&&Ji(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Sd(t,e){for(;t!==null;){var a=t===e?null:Rr(t);t.remove(),t=a}}function Ji(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function Ea(t,e,a=!0){var r=[];Zi(t,r,!0);var o=()=>{a&&Ft(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var c of r)c.out(i)}else o()}function Zi(t,e,a){if((t.f&Ut)===0){t.f^=Ut;var r=t.nodes&&t.nodes.t;if(r!==null)for(const c of r)(c.is_global||a)&&e.push(c);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&la)!==0||(o.f&dn)!==0&&(t.f&Vn)!==0;Zi(o,e,i?a:!1),o=s}}}function ms(t){Qi(t,!0)}function Qi(t,e){if((t.f&Ut)!==0){t.f^=Ut,(t.f&wt)===0&&(lt(t,St),sn(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&la)!==0||(a.f&dn)!==0;Qi(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function $i(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Rr(a);e.append(a),a=o}}let to=!1,ca=!1;function Ws(t){ca=t}let ze=null,ln=!1;function tn(t){ze=t}let We=null;function bn(t){We=t}let en=null;function el(t){ze!==null&&(en===null?en=[t]:en.push(t))}let Lt=null,zt=0,Yt=null;function kd(t){Yt=t}let tl=1,ya=0,zn=ya;function Vs(t){zn=t}function nl(){return++tl}function Fr(t){var e=t.f;if((e&St)!==0)return!0;if(e&bt&&(t.f&=~Pa),(e&cn)!==0){for(var a=t.deps,r=a.length,o=0;o<r;o++){var s=a[o];if(Fr(s)&&zi(s),s.wv>t.wv)return!0}(e&$t)!==0&&on===null&&lt(t,wt)}return!1}function al(t,e,a=!0){var r=t.reactions;if(r!==null&&!(en!==null&&tr.call(en,t)))for(var o=0;o<r.length;o++){var s=r[o];(s.f&bt)!==0?al(s,e,!1):e===s&&(a?lt(s,St):(s.f&wt)!==0&&lt(s,cn),sn(s))}}function rl(t){var w;var e=Lt,a=zt,r=Yt,o=ze,s=en,i=$e,c=ln,l=zn,d=t.f;Lt=null,zt=0,Yt=null,ze=(d&(dn|Aa))===0?t:null,en=null,nr(t.ctx),ln=!1,zn=++ya,t.ac!==null&&(wo(()=>{t.ac.abort(Ua)}),t.ac=null);try{t.f|=zo;var u=t.fn,f=u(),h=t.deps,m=qe?.is_fork;if(Lt!==null){var g;if(m||io(t,zt),h!==null&&zt>0)for(h.length=zt+Lt.length,g=0;g<Lt.length;g++)h[zt+g]=Lt[g];else t.deps=h=Lt;if(ps()&&(t.f&$t)!==0)for(g=zt;g<h.length;g++)((w=h[g]).reactions??(w.reactions=[])).push(t)}else!m&&h!==null&&zt<h.length&&(io(t,zt),h.length=zt);if(dr()&&Yt!==null&&!ln&&h!==null&&(t.f&(bt|cn|St))===0)for(g=0;g<Yt.length;g++)al(Yt[g],t);if(o!==null&&o!==t){if(ya++,o.deps!==null)for(let _=0;_<a;_+=1)o.deps[_].rv=ya;if(e!==null)for(const _ of e)_.rv=ya;Yt!==null&&(r===null?r=Yt:r.push(...Yt))}return(t.f&aa)!==0&&(t.f^=aa),f}catch(_){return Ei(_)}finally{t.f^=zo,Lt=e,zt=a,Yt=r,ze=o,en=s,nr(i),ln=c,zn=l}}function Cd(t,e){let a=e.reactions;if(a!==null){var r=_c.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}if(a===null&&(e.f&bt)!==0&&(Lt===null||!tr.call(Lt,e))){var s=e;(s.f&$t)!==0&&(s.f^=$t,s.f&=~Pa),gs(s),Oi(s),io(s,0)}}function io(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Cd(t,a[r])}function kr(t){var e=t.f;if((e&Ln)===0){lt(t,wt);var a=We,r=to;We=t,to=!0;try{(e&(Vn|mi))!==0?bd(t):Xi(t),Yi(t);var o=rl(t);t.teardown=typeof o=="function"?o:null,t.wv=tl;var s;Fo&&Xc&&(t.f&St)!==0&&t.deps}finally{to=r,We=a}}}async function xd(){await Promise.resolve(),Di()}function n(t){var e=t.f,a=(e&bt)!==0;if(ze!==null&&!ln){var r=We!==null&&(We.f&Ln)!==0;if(!r&&(en===null||!tr.call(en,t))){var o=ze.deps;if((ze.f&zo)!==0)t.rv<ya&&(t.rv=ya,Lt===null&&o!==null&&o[zt]===t?zt++:Lt===null?Lt=[t]:Lt.push(t));else{(ze.deps??(ze.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[ze]:tr.call(s,ze)||s.push(ze)}}}if(ca&&oa.has(t))return oa.get(t);if(a){var i=t;if(ca){var c=i.v;return((i.f&wt)===0&&i.reactions!==null||sl(i))&&(c=hs(i)),oa.set(i,c),c}var l=(i.f&$t)===0&&!ln&&ze!==null&&(to||(ze.f&$t)!==0),d=i.deps===null;Fr(i)&&(l&&(i.f|=$t),zi(i)),l&&!d&&ol(i)}if(on?.has(t))return on.get(t);if((t.f&aa)!==0)throw t.v;return t.v}function ol(t){if(t.deps!==null){t.f|=$t;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&bt)!==0&&(e.f&$t)===0&&ol(e)}}function sl(t){if(t.v===mt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(oa.has(e)||(e.f&bt)!==0&&sl(e))return!0;return!1}function ht(t){var e=ln;try{return ln=!0,t()}finally{ln=e}}function Td(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ra in t)Go(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&ra in a&&Go(a)}}}function Go(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Go(t[r],e)}catch{}const a=mo(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=gi(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const Ed=["touchstart","touchmove"];function Nd(t){return Ed.includes(t)}const il=new Set,Yo=new Set;function Pd(t,e,a,r={}){function o(s){if(r.capture||pr.call(e,s),!s.cancelBubble)return wo(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?wn(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function Wt(t,e,a,r,o){var s={capture:r,passive:o},i=Pd(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Ki(()=>{e.removeEventListener(t,i,s)})}function st(t){for(var e=0;e<t.length;e++)il.add(t[e]);for(var a of Yo)a(t)}let qs=null;function pr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;qs=t;var i=0,c=qs===t&&t.__root;if(c){var l=o.indexOf(c);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var d=o.indexOf(e);if(d===-1)return;l<=d&&(i=l)}if(s=o[i]||t.target,s!==e){wc(t,"currentTarget",{configurable:!0,get(){return s||a}});var u=ze,f=We;tn(null),bn(null);try{for(var h,m=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var w=s["__"+r];w!=null&&(!s.disabled||t.target===s)&&w.call(s,t)}catch(_){h?m.push(_):h=_}if(t.cancelBubble||g===e||g===null)break;s=g}if(h){for(let _ of m)queueMicrotask(()=>{throw _});throw h}}finally{t.__root=e,delete t.currentTarget,tn(u),bn(f)}}}function ll(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Cr(t,e){var a=We;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function k(t,e){var a=(e&qc)!==0,r=(e&Kc)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=ll(s?t:"<!>"+t),a||(o=rr(o)));var i=r||Hi?document.importNode(o,!0):o.cloneNode(!0);if(a){var c=rr(i),l=i.lastChild;Cr(c,l)}else Cr(i,i);return i}}function Ad(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=ll(o),c=rr(i);s=rr(c)}var l=s.cloneNode(!0);return Cr(l,l),l}}function Dd(t,e){return Ad(t,e,"svg")}function Me(t=""){{var e=On(t+"");return Cr(e,e),e}}function fe(){var t=document.createDocumentFragment(),e=document.createComment(""),a=On();return t.append(e,a),Cr(e,a),t}function p(t,e){t!==null&&t.before(e)}function Cm(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function at(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Id(t,e){return Md(t,e)}const ja=new Map;function Md(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){fd();var c=new Set,l=f=>{for(var h=0;h<f.length;h++){var m=f[h];if(!c.has(m)){c.add(m);var g=Nd(m);e.addEventListener(m,pr,{passive:g});var w=ja.get(m);w===void 0?(document.addEventListener(m,pr,{passive:g}),ja.set(m,1)):ja.set(m,w+1)}}};l(po(il)),Yo.add(l);var d=void 0,u=_d(()=>{var f=a??e.appendChild(On());return rd(f,{pending:()=>{}},h=>{ge({});var m=$e;s&&(m.c=s),o&&(r.$$events=o),d=t(h,r)||{},he()}),()=>{for(var h of c){e.removeEventListener(h,pr);var m=ja.get(h);--m===0?(document.removeEventListener(h,pr),ja.delete(h)):ja.set(h,m)}Yo.delete(l),f!==a&&f.parentNode?.removeChild(f)}});return Ld.set(d,u),d}let Ld=new WeakMap;var nn,mn,jt,Ta,Ar,Dr,vo;class bo{constructor(e,a=!0){Nt(this,"anchor");De(this,nn,new Map);De(this,mn,new Map);De(this,jt,new Map);De(this,Ta,new Set);De(this,Ar,!0);De(this,Dr,()=>{var e=qe;if(I(this,nn).has(e)){var a=I(this,nn).get(e),r=I(this,mn).get(a);if(r)ms(r),I(this,Ta).delete(a);else{var o=I(this,jt).get(a);o&&(I(this,mn).set(a,o.effect),I(this,jt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of I(this,nn)){if(I(this,nn).delete(s),s===e)break;const c=I(this,jt).get(i);c&&(Ft(c.effect),I(this,jt).delete(i))}for(const[s,i]of I(this,mn)){if(s===a||I(this,Ta).has(s))continue;const c=()=>{if(Array.from(I(this,nn).values()).includes(s)){var d=document.createDocumentFragment();$i(i,d),d.append(On()),I(this,jt).set(s,{effect:i,fragment:d})}else Ft(i);I(this,Ta).delete(s),I(this,mn).delete(s)};I(this,Ar)||!r?(I(this,Ta).add(s),Ea(i,c,!1)):c()}}});De(this,vo,e=>{I(this,nn).delete(e);const a=Array.from(I(this,nn).values());for(const[r,o]of I(this,jt))a.includes(r)||(Ft(o.effect),I(this,jt).delete(r))});this.anchor=e,Re(this,Ar,a)}ensure(e,a){var r=qe,o=Vi();if(a&&!I(this,mn).has(e)&&!I(this,jt).has(e))if(o){var s=document.createDocumentFragment(),i=On();s.append(i),I(this,jt).set(e,{effect:Zt(()=>a(i)),fragment:s})}else I(this,mn).set(e,Zt(()=>a(this.anchor)));if(I(this,nn).set(r,e),o){for(const[c,l]of I(this,mn))c===e?r.unskip_effect(l):r.skip_effect(l);for(const[c,l]of I(this,jt))c===e?r.unskip_effect(l.effect):r.skip_effect(l.effect);r.oncommit(I(this,Dr)),r.ondiscard(I(this,vo))}else I(this,Dr).call(this)}}nn=new WeakMap,mn=new WeakMap,jt=new WeakMap,Ta=new WeakMap,Ar=new WeakMap,Dr=new WeakMap,vo=new WeakMap;const Rd=0,Mo=1;function Fd(t,e,a,r,o){var s=dr(),i=mt,c=s?yn(i):Ko(i,!1,!1),l=s?yn(i):Ko(i,!1,!1),d=new bo(t);ur(()=>{var u=e(),f=!1;if(bc(u)){var h=Fi(),m=!1;const g=w=>{if(!f){m=!0,h(!1),Rn.ensure();try{w()}finally{so(),qa||Di()}}};u.then(w=>{g(()=>{Fn(c,w),d.ensure(Mo,r&&(_=>r(_,c)))})},w=>{g(()=>{if(Fn(l,w),d.ensure(Mo,o&&(_=>o(_,l))),!o)throw l.v})}),wn(()=>{m||g(()=>{d.ensure(Rd,a)})})}else Fn(c,u),d.ensure(Mo,r&&(g=>r(g,c)));return()=>{f=!0}})}function H(t,e,a=!1){var r=new bo(t),o=a?la:0;function s(i,c){r.ensure(i,c)}ur(()=>{var i=!1;e((c,l=!0)=>{i=!0,s(l,c)}),i||s(!1,null)},o)}function le(t,e){yo(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Od(t,e,a){for(var r=[],o=e.length,s,i=e.length,c=0;c<o;c++){let f=e[c];Ea(f,()=>{if(s){if(s.pending.delete(f),s.done.add(f),s.pending.size===0){var h=t.outrogroups;Xo(po(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var l=r.length===0&&a!==null;if(l){var d=a,u=d.parentNode;vd(u),u.append(d),t.items.clear()}Xo(e,!l)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function Xo(t,e=!0){for(var a=0;a<t.length;a++)Ft(t[a],e)}var Ks;function Bn(t,e,a,r,o,s=null){var i=t,c=new Map,l=(e&Si)!==0;if(l){var d=t;i=d.appendChild(On())}var u=null,f=Lr(()=>{var x=a();return ds(x)?x:x==null?[]:po(x)}),h,m=!0;function g(){_.fallback=u,zd(_,h,i,e,r),u!==null&&(h.length===0?(u.f&Mn)===0?ms(u):(u.f^=Mn,mr(u,null,i)):Ea(u,()=>{u=null}))}var w=ur(()=>{h=n(f);for(var x=h.length,K=new Set,C=qe,N=Vi(),O=0;O<x;O+=1){var U=h[O],B=r(U,O),X=m?null:c.get(B);X?(X.v&&Fn(X.v,U),X.i&&Fn(X.i,O),N&&C.unskip_effect(X.e)):(X=Bd(c,m?i:Ks??(Ks=On()),U,B,O,o,e,a),m||(X.e.f|=Mn),c.set(B,X)),K.add(B)}if(x===0&&s&&!u&&(m?u=Zt(()=>s(i)):(u=Zt(()=>s(Ks??(Ks=On()))),u.f|=Mn)),x>K.size&&Tc(),!m)if(N){for(const[Q,R]of c)K.has(Q)||C.skip_effect(R.e);C.oncommit(g),C.ondiscard(()=>{})}else g();n(f)}),_={effect:w,items:c,outrogroups:null,fallback:u};m=!1}function hr(t){for(;t!==null&&(t.f&dn)===0;)t=t.next;return t}function zd(t,e,a,r,o){var s=(r&zc)!==0,i=e.length,c=t.items,l=hr(t.effect.first),d,u=null,f,h=[],m=[],g,w,_,x;if(s)for(x=0;x<i;x+=1)g=e[x],w=o(g,x),_=c.get(w).e,(_.f&Mn)===0&&(_.nodes?.a?.measure(),(f??(f=new Set)).add(_));for(x=0;x<i;x+=1){if(g=e[x],w=o(g,x),_=c.get(w).e,t.outrogroups!==null)for(const R of t.outrogroups)R.pending.delete(_),R.done.delete(_);if((_.f&Mn)!==0)if(_.f^=Mn,_===l)mr(_,null,a);else{var K=u?u.next:l;_===t.effect.last&&(t.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),Yn(t,u,_),Yn(t,_,K),mr(_,K,a),u=_,h=[],m=[],l=hr(u.next);continue}if((_.f&Ut)!==0&&(ms(_),s&&(_.nodes?.a?.unfix(),(f??(f=new Set)).delete(_))),_!==l){if(d!==void 0&&d.has(_)){if(h.length<m.length){var C=m[0],N;u=C.prev;var O=h[0],U=h[h.length-1];for(N=0;N<h.length;N+=1)mr(h[N],C,a);for(N=0;N<m.length;N+=1)d.delete(m[N]);Yn(t,O.prev,U.next),Yn(t,u,O),Yn(t,U,C),l=C,u=U,x-=1,h=[],m=[]}else d.delete(_),mr(_,l,a),Yn(t,_.prev,_.next),Yn(t,_,u===null?t.effect.first:u.next),Yn(t,u,_),u=_;continue}for(h=[],m=[];l!==null&&l!==_;)(d??(d=new Set)).add(l),m.push(l),l=hr(l.next);if(l===null)continue}(_.f&Mn)===0&&h.push(_),u=_,l=hr(_.next)}if(t.outrogroups!==null){for(const R of t.outrogroups)R.pending.size===0&&(Xo(po(R.done)),t.outrogroups?.delete(R));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||d!==void 0){var B=[];if(d!==void 0)for(_ of d)(_.f&Ut)===0&&B.push(_);for(;l!==null;)(l.f&Ut)===0&&l!==t.fallback&&B.push(l),l=hr(l.next);var X=B.length;if(X>0){var Q=(r&Si)!==0&&i===0?a:null;if(s){for(x=0;x<X;x+=1)B[x].nodes?.a?.measure();for(x=0;x<X;x+=1)B[x].nodes?.a?.fix()}Od(t,B,Q)}}s&&wn(()=>{if(f!==void 0)for(_ of f)_.nodes?.a?.apply()})}function Bd(t,e,a,r,o,s,i,c){var l=(i&Fc)!==0?(i&Bc)===0?Ko(a,!1,!1):yn(a):null,d=(i&Oc)!==0?yn(o):null;return{v:l,i:d,e:Zt(()=>(s(e,l??a,d??o,c),()=>{t.delete(r)}))}}function mr(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&Mn)===0?e.nodes.start:a;r!==null;){var i=Rr(r);if(s.before(r),r===o)return;r=i}}function Yn(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function Ae(t,e,...a){var r=new bo(t);ur(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},la)}function jd(t,e,a){var r=new bo(t);ur(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},la)}function cl(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=cl(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function Hd(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=cl(t))&&(r&&(r+=" "),r+=e);return r}function Xe(t){return typeof t=="object"?Hd(t):t??""}const Gs=[...` 	
\r\fÂ \v\uFEFF`];function Ud(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var c=i+s;(i===0||Gs.includes(r[i-1]))&&(c===r.length||Gs.includes(r[c]))?r=(i===0?"":r.substring(0,i))+r.substring(c+1):i=c}}return r===""?null:r}function Wd(t,e){return t==null?null:String(t)}function Ge(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var c=Ud(a,r,s);c==null?t.removeAttribute("class"):t.className=c,t.__className=a}else if(s&&o!==s)for(var l in s){var d=!!s[l];(o==null||d!==!!o[l])&&t.classList.toggle(l,d)}return s}function or(t,e,a,r){var o=t.__style;if(o!==e){var s=Wd(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const Vd=Symbol("is custom element"),qd=Symbol("is html");function xm(t,e){var a=_s(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Tm(t,e){var a=_s(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function tt(t,e,a,r){var o=_s(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Cc]=a),a==null?t.removeAttribute(e):typeof a!="string"&&Kd(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function _s(t){return t.__attributes??(t.__attributes={[Vd]:t.nodeName.includes("-"),[qd]:t.namespaceURI===Gc})}var Ys=new Map;function Kd(t){var e=t.getAttribute("is")||t.nodeName,a=Ys.get(e);if(a)return a;Ys.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=gi(o);for(var i in r)r[i].set&&a.push(i);o=mo(o)}return a}function dl(t,e,a=e){var r=new WeakSet;hd(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=Lo(t)?Ro(s):s,a(s),qe!==null&&r.add(qe),await xd(),s!==(s=e())){var i=t.selectionStart,c=t.selectionEnd,l=t.value.length;if(t.value=s??"",c!==null){var d=t.value.length;i===c&&c===l&&d>l?(t.selectionStart=d,t.selectionEnd=d):(t.selectionStart=i,t.selectionEnd=Math.min(c,d))}}}),ht(e)==null&&t.value&&(a(Lo(t)?Ro(t.value):t.value),qe!==null&&r.add(qe)),yo(()=>{var o=e();if(t===document.activeElement){var s=Bo??qe;if(r.has(s))return}Lo(t)&&o===Ro(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function Lo(t){var e=t.type;return e==="number"||e==="range"}function Ro(t){return t===""?null:+t}function Xs(t,e){return t===e||t?.[ra]===e}function Ke(t={},e,a,r){return wd(()=>{var o,s;return yo(()=>{o=s,s=[],ht(()=>{t!==a(...s)&&(e(t,...s),o&&Xs(a(...o),t)&&e(null,...o))})}),()=>{wn(()=>{s&&Xs(a(...s),t)&&e(null,...s)})}}),t}function ws(t=!1){const e=$e,a=e.l.u;if(!a)return;let r=()=>Td(e.s);if(t){let o=0,s={};const i=Mr(()=>{let c=!1;const l=e.s;for(const d in l)l[d]!==s[d]&&(s[d]=l[d],c=!0);return c&&o++,o});r=()=>n(i)}a.b.length&&md(()=>{Js(e,r),Oo(a.b)}),Le(()=>{const o=ht(()=>a.m.map(Sc));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&Le(()=>{Js(e,r),Oo(a.a)})}function Js(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let Xr=!1;function Gd(t){var e=Xr;try{return Xr=!1,[t(),Xr]}finally{Xr=e}}const Yd={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(gr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];gr(o)&&(o=o());const s=na(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(gr(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=na(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===ra||e===yi)return!1;for(let a of t.props)if(gr(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(gr(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function Jo(...t){return new Proxy({props:t},Yd)}function Ne(t,e,a,r){var o=!cr||(a&Hc)!==0,s=(a&Wc)!==0,i=(a&Vc)!==0,c=r,l=!0,d=()=>(l&&(l=!1,c=i?ht(r):r),c),u;if(s){var f=ra in t||yi in t;u=na(t,e)?.set??(f&&e in t?C=>t[e]=C:void 0)}var h,m=!1;s?[h,m]=Gd(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=d(),u&&(o&&Dc(),u(h)));var g;if(o?g=()=>{var C=t[e];return C===void 0?d():(l=!0,C)}:g=()=>{var C=t[e];return C!==void 0&&(c=void 0),C===void 0?c:C},o&&(a&Uc)===0)return g;if(u){var w=t.$$legacy;return(function(C,N){return arguments.length>0?((!o||!N||w||m)&&u(N?g():C),C):g()})}var _=!1,x=((a&jc)!==0?Mr:Lr)(()=>(_=!1,g()));s&&n(x);var K=We;return(function(C,N){if(arguments.length>0){const O=N?n(x):o&&s?et(C):C;return v(x,O),_=!0,c!==void 0&&(c=O),C}return ca&&_||(K.f&Ln)!==0?x.v:n(x)})}function we(t){$e===null&&bi(),cr&&$e.l!==null?Xd($e).m.push(t):Le(()=>{const e=ht(t);if(typeof e=="function")return e})}function Xd(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const Jd="5";var vi;typeof window<"u"&&((vi=window.__svelte??(window.__svelte={})).v??(vi.v=new Set)).add(Jd);Jc();const ul={};function Zd(t){ot(ul,t)}function Qd(){const t=rt(ul);if(!t)throw new Error("No StartContext found");return t}const fl={};function $d(t){ot(fl,t)}function kt(){const t=rt(fl);if(!t)throw new Error("No NotesStoreContext found");return t}const vl={};function eu(t){ot(vl,t)}function So(){const t=rt(vl);if(!t)throw new Error("No BroadcastContext found");return t}const tu=()=>{const t=crypto.randomUUID(),e=(r,o)=>{r.postMessage(JSON.stringify({msg:o,tabId:t}))};return{tabId:t,createChannel:()=>{const r=new BroadcastChannel("app");return{postMessage:o=>e(r,o),addEventListener:o=>{r.addEventListener("message",o)},removeEventListener:o=>{r.removeEventListener("message",o)}}}}};function nu(t,e){ge(e,!0),eu(tu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const gl={};function au(t){ot(gl,t)}function ys(){const t=rt(gl);if(!t)throw new Error("No LocalDBContext found");return t}const ru="AppStorage",ou=1,_r="account",En="settings",Qe="notes",Rt="tags",su="urls",iu="syncLog",da="success",ua="error",_t=(t,e,a)=>{t?.addEventListener(e,a)},Zs=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();_t(s,da,()=>{const i=s?.result||[];a(i)}),_t(s,ua,i=>{r(i)})}),lo=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);_t(i,da,()=>{const c=i?.result?.data;r(c)}),_t(i,ua,c=>{o(c)})}),rn=(t,e,a,r)=>new Promise((o,s)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});_t(l,da,()=>{o()}),_t(l,ua,d=>{s(d)})}),vt=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((c,l)=>{_t(i,da,()=>{c()}),_t(i,ua,d=>{l(d)})})}))},bs=(t,e,a)=>new Promise((r,o)=>{const c=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);_t(c,da,()=>{r()}),_t(c,ua,l=>{o(l)})}),wr=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((c,l)=>{_t(i,da,()=>{c()}),_t(i,ua,d=>{l(d)})})}))},Wa=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();_t(i,da,()=>{a()}),_t(i,ua,c=>{r(c)})}),Qs=()=>chrome,hl=()=>LanguageModel,jn=()=>crypto.randomUUID(),pl=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}},Em=(t,e,a={})=>{let r=null,o=null;return(...s)=>{o=s,!r&&(t(...o),o=null,r=setTimeout(()=>{if(r=null,a.trailing&&o){t(...o);return}},e))}},je=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t)),lu=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},cu=async({newTag:t,noteIds:e,notes:a,notesMap:r,tagsMap:o,db:s,updateNotes:i,updateTagsMap:c,sendMsgReloadNotes:l})=>{const d=[],u=[];for(const m of e){const g=r.get(m);g?.data&&(d.push({id:m,data:je(g.data)}),u.push({id:m,data:{...g.data,tags:[...new Set([...g.data.tags,t])],versionId:jn(),history:[...g.data.history||[],{versionId:g.data.versionId,link:je(g.data.link),text:g.data.text,tags:g.data.tags,updatedAt:Date.now()}]}}))}for(const m of u){const g=r.get(m.id);g?.data&&(g.data=m.data)}const f=o.has(t);return await Promise.all([(async()=>{f||(o.set(t,{name:t,pinned:!1}),await rn(s,Rt,t,{pinned:!1}))})(),vt(s,Qe,u.map(m=>({id:m.id,data:m.data})))]),l(),i(a,r),c(o),{cancel:async()=>{for(const m of d){const g=r.get(m.id);g?.data&&(g.data=m.data)}await Promise.all([(async()=>{f||(o.delete(t),await bs(s,Rt,t))})(),vt(s,Qe,d.map(m=>({id:m.id,data:m.data})))]),l(),i(a,r),c(o)}}},du=async({noteIds:t,prevTags:e,newTags:a,notes:r,notesMap:o,tagsMap:s,db:i,updateNotes:c,updateTagsMap:l,sendMsgReloadNotes:d})=>{const u=[],f=[];for(const g of t){const w=o.get(g);w?.data&&(u.push({id:g,data:je(w.data)}),f.push({id:g,data:{...w.data,tags:[...new Set([...w.data.tags.filter(_=>!e.includes(_)),...a])],versionId:jn(),history:[...w.data.history||[],{versionId:w.data.versionId,link:je(w.data.link),text:w.data.text,tags:w.data.tags,updatedAt:Date.now()}]}}))}for(const g of f){const w=o.get(g.id);w?.data&&(w.data=g.data)}const h=a.filter(g=>!s.has(g));return await Promise.all([(async()=>{if(h.length>0)return vt(i,Rt,h.map(g=>({id:g,data:{pinned:!1}})))})(),vt(i,Qe,f.map(g=>({id:g.id,data:g.data})))]),d(),c(r,o),l(s),{cancel:async()=>{for(const g of u){const w=o.get(g.id);w?.data&&(w.data=g.data)}await Promise.all([(async()=>{if(h.length>0){for(const g of h)s.delete(g);return wr(i,Rt,h)}})(),vt(i,Qe,u.map(g=>({id:g.id,data:g.data})))]),d(),c(r,o),l(s)}}},uu=async({tag:t,noteIds:e,notes:a,notesMap:r,db:o,updateNotes:s,sendMsgReloadNotes:i})=>{const c=[],l=[];for(const u of e){const f=r.get(u);f?.data&&(c.push({id:u,data:je(f.data)}),l.push({id:u,data:{...f.data,tags:f.data.tags.filter(h=>h!==t),versionId:jn(),history:[...f.data.history||[],{versionId:f.data.versionId,link:je(f.data.link),text:f.data.text,tags:f.data.tags,updatedAt:Date.now()}]}}))}for(const u of l){const f=r.get(u.id);f?.data&&(f.data=u.data)}return await vt(o,Qe,l.map(u=>({id:u.id,data:u.data}))),i(),s(a,r),{cancel:async()=>{for(const u of c){const f=r.get(u.id);f?.data&&(f.data=u.data)}await vt(o,Qe,c.map(u=>({id:u.id,data:u.data}))),i(),s(a,r)}}},fu=async({newNotes:t,notesMap:e,db:a,init:r,sendMsgReloadNotes:o})=>{const s={};t.forEach(i=>{const c=e.get(i.id),l=[];if(c&&c.data){let d=0,u=0;for(;d<i.data.history.length&&u<c.data.history.length;){const f=i.data.history[d],h=c.data.history[u];f.versionId===h.versionId?(f.updatedAt>h.updatedAt?l.push(f):l.push(h),d+=1,u+=1):f.updatedAt<h.updatedAt?(l.push(f),d+=1):f.updatedAt>h.updatedAt?(l.push(h),u+=1):(l.push(h),d+=1,u+=1)}c.data.updatedAt>i.data.updatedAt?s[c.id]={id:c.id,data:{...c.data,history:l}}:s[i.id]={id:i.id,data:{...i.data,history:l}}}else s[i.id]=i}),await vt(a,Qe,Object.values(s)),await r(),o()},vu=async(t,e,a)=>{const r=t.get(e);if(!r||!r.data)return;const o={id:e,data:{...r.data,deletedAt:Date.now()}};return a(o)},gu=async({noteIds:t,notes:e,notesMap:a,db:r,updateNotes:o,sendMsgReloadNotes:s})=>{const i=[];for(const l of t){const d=a.get(l);d?.data&&(i.push({id:l,data:je(d.data)}),d.data.archivedAt=0)}return await vt(r,Qe,t.map(l=>{const d=a.get(l);return{id:l,data:d?.data}})),s(),o(e,a),{cancel:async()=>{for(const l of i){const d=a.get(l.id);d?.data&&(d.data=l.data)}await vt(r,Qe,t.map(l=>{const d=a.get(l);return{id:l,data:d?.data}})),s(),o(e,a)}}},hu=async({noteIds:t,notes:e,notesMap:a,db:r,updateNotes:o,sendMsgReloadNotes:s})=>{for(const c of t){const l=a.get(c);l?.data&&(l.data.archivedAt=Date.now())}return await vt(r,Qe,t.map(c=>{const l=a.get(c);return{id:c,data:l?.data}})),s(),o(e,a),{cancel:async()=>{for(const c of t){const l=a.get(c);l?.data&&(l.data.archivedAt=0)}await vt(r,Qe,t.map(c=>{const l=a.get(c);return{id:c,data:l?.data}})),s(),o(e,a)}}},pu=async({noteIds:t,notes:e,notesMap:a,db:r,updateDuplicates:o,updateNotes:s,sendMsgReloadNotes:i})=>{for(const l of t){const d=a.get(l);d?.data&&(d.data.deletedAt=Date.now())}return await vt(r,Qe,t.map(l=>{const d=a.get(l);return{id:l,data:d?.data}})),await Promise.all(t.map(async l=>{const d=a.get(l);d?.data&&await o(d.id,d.data.link?.url||"","")})),i(),s(e,a),{cancel:async()=>{for(const l of t){const d=a.get(l);d?.data&&(d.data.deletedAt=0)}await vt(r,Qe,t.map(l=>{const d=a.get(l);return{id:l,data:d?.data}})),await Promise.all(t.map(async l=>{const d=a.get(l);d?.data&&await o(d.id,"",d.data.link?.url||"")})),i(),s(e,a)}}},mu=async({tag:t,newTag:e,noteIds:a,notes:r,notesMap:o,tagsMap:s,db:i,updateNotes:c,updateTagsMap:l,sendMsgReloadNotes:d})=>{const u=[],f=[];for(const g of a){const w=o.get(g);w?.data&&(u.push({id:g,data:je(w.data)}),f.push({id:g,data:{...w.data,tags:w.data.tags.map(_=>_!==t?_:e),versionId:jn(),history:[...w.data.history||[],{versionId:w.data.versionId,link:je(w.data.link),text:w.data.text,tags:w.data.tags,updatedAt:Date.now()}]}}))}for(const g of f){const w=o.get(g.id);w?.data&&(w.data=g.data)}const h=s.has(e);return await Promise.all([(async()=>{if(!h){const g=s.get(t)?.pinned||!1;s.set(e,{name:e,pinned:g}),await rn(i,Rt,e,{pinned:g})}})(),vt(i,Qe,f.map(g=>({id:g.id,data:g.data})))]),d(),c(r,o),l(s),{cancel:async()=>{for(const g of u){const w=o.get(g.id);w?.data&&(w.data=g.data)}await Promise.all([(async()=>{h||(s.delete(e),await bs(i,Rt,e))})(),vt(i,Qe,u.map(g=>({id:g.id,data:g.data})))]),d(),c(r,o),l(s)}}},_u=async({noteIds:t,notes:e,notesMap:a,db:r,updateDuplicates:o,updateNotes:s,sendMsgReloadNotes:i})=>{const c=[];for(const d of t){const u=a.get(d);u?.data&&(c.push({id:d,data:je(u.data)}),u.data.deletedAt=0)}return await vt(r,Qe,t.map(d=>{const u=a.get(d);return{id:d,data:u?.data}})),await Promise.all(t.map(async d=>{const u=a.get(d);u?.data&&await o(u.id,"",u.data.link?.url||"")})),i(),s(e,a),{cancel:async()=>{for(const d of c){const u=a.get(d.id);u?.data&&(u.data=d.data)}await vt(r,Qe,t.map(d=>{const u=a.get(d);return{id:d,data:u?.data}})),await Promise.all(t.map(async d=>{const u=a.get(d);u?.data&&await o(u.id,u.data.link?.url||"","")})),i(),s(e,a)}}},$s=()=>()=>new Map,ei=()=>()=>[],ti=()=>()=>new Map,ni=()=>new Map,wu=()=>new Set,yu=()=>{const{getDB:t}=ys(),e=So(),a=T(t),r=e.createChannel(),o=720*60*60*1e3;let s=A(!1),i=A(et($s())),c=A(et(ei())),l=A(et(ti())),d=A(et(ni()));const u=(S,j)=>{v(c,()=>S),v(l,()=>j)},f=S=>{v(i,()=>S)},h=()=>n(s),m=()=>n(c)().some(S=>S.data&&!S.data.deletedAt&&!S.data.archivedAt),g=()=>n(c)().some(S=>S.data&&S.data.deletedAt),w=()=>n(c)().some(S=>S.data&&S.data.archivedAt&&!S.data.deletedAt),_=(S,j)=>{n(d).has(S)||n(d).set(S,wu()),n(d).get(S)?.add(j)},x=(S,j)=>{n(d).has(S)&&(n(d).get(S)?.delete(j),n(d).get(S)?.size===0&&n(d).delete(S))},K=S=>{if(!S)return!1;const j=n(l)().get(S);if(!j||!j.data?.link?.url)return!1;const F=n(d).get(j.data.link.url),L=[];return F?.forEach(M=>{if(M===S)return;const ae=n(l)().get(M);(j.data?.archivedAt||0)==(ae?.data?.archivedAt||0)&&(j.data?.deletedAt||0)==(ae?.data?.deletedAt||0)&&L.push(M)}),L.length>0},C=S=>{const j=n(d).get(S);return j?[...j].map(L=>({id:L})):[]},N=S=>{const j=n(c)(),F=n(l)(),L=F.get(S.id);L?L.data=S.data:(j.push(S),F.set(S.id,S)),v(c,()=>j),v(l,()=>F)},O=S=>{const j=n(c)(),F=n(l)(),L=F.get(S);F.has(S)&&F.delete(S),L&&(L.data=void 0),v(c,()=>j),v(l,()=>F)},U=S=>{const j=n(c)(),F=n(l)();for(const L of S){const M=F.get(L);F.has(L)&&F.delete(L),M&&(M.data=void 0)}v(c,()=>j),v(l,()=>F)},B=()=>{v(c,ei(),!0),v(d,ni(),!0),v(i,$s(),!0),v(l,ti(),!0)},X=()=>n(c),Q=()=>n(l),R=S=>{const j=n(i)();for(const F of S)j.get(F)||j.set(F,{name:F});v(i,()=>j)},$=()=>{r.postMessage({type:"reloadNotes"})},Z=async()=>{const[S,j]=await Promise.all([Zs(n(a),Qe),Zs(n(a),Rt).then(be=>be.reduce((Be,Oe)=>Be.set(Oe.id,Oe.data),new Map))]),F=[],L=[],M=new Map,ae=new Map;for(const be of S)be.data.deletedAt&&Date.now()-be.data.deletedAt>o?F.push(be.id):(L.push(be),M.set(be.id,be),be.data.link?.url&&!be.data.deletedAt&&(ae.has(be.data.link.url)?ae.get(be.data.link.url)?.add(be.id):ae.set(be.data.link.url,new Set([be.id]))));const Ce=lu(L),Se=[],Te=new Map(j);[...Ce.values()].forEach(be=>{Te.set(be,{name:be,pinned:j.get(be)?.pinned||!1}),j.has(be)||Se.push(be)});const ye=[];[...j.keys()].forEach(be=>{Ce.has(be)||ye.push(be)}),await wr(n(a),Qe,F),await wr(n(a),Rt,ye),await vt(n(a),Rt,Se.map(be=>({id:be,data:{pinned:Te.get(be)?.pinned||!1}}))),v(c,()=>L),v(l,()=>M),v(i,()=>Te),v(d,ae,!0),v(s,!0)},q=async(S,j,F)=>{j!==F&&(j&&x(j,S),F&&_(F,S))},b=async S=>{const j=n(i)(),F=S.data.tags.filter(M=>!j.has(M))||[],L=te(S.id);return await rn(n(a),Qe,S.id,{...S.data}),!L&&!S.data.deletedAt||L?.data.deletedAt&&!S.data.deletedAt?await q(S.id,"",S.data.link?.url||""):!L?.data.deletedAt&&S.data.deletedAt?await q(S.id,L?.data.link?.url||"",""):!L?.data.deletedAt&&!S.data.deletedAt&&await q(S.id,L?.data?.link?.url||"",S.data.link?.url||""),F.length>0&&(await vt(n(a),Rt,F.map(M=>({id:M,data:{pinned:!1}}))||[]),R(F)),N(S),r.postMessage({type:"putNote",data:{id:S.id}}),S.id},re=async({link:S,text:j,tags:F,pinned:L})=>{const M={id:jn(),data:{link:je(S),text:j,tags:je(F),versionId:jn(),history:[],createdAt:Date.now(),updatedAt:Date.now(),pinned:L}};return await b(M),M.id},D=async(S,{link:j,text:F,tags:L})=>{const M=te(S);if(!M||!M.data)return;const ae={id:S,data:{...M.data,link:je(j),text:F,tags:je(L),updatedAt:Date.now()}};await b(ae)},V=async(S,{link:j,text:F,tags:L})=>{const M=te(S);if(!M||!M.data)return;const ae={versionId:M.data.versionId,link:je(M.data.link),text:M.data.text,tags:je(M.data.tags),updatedAt:M.data.updatedAt},Ce=[...(M.data.history||[]).slice(-9),ae],Se={id:S,data:{...M.data,versionId:jn(),link:j,text:F,tags:L,updatedAt:Date.now(),history:Ce}};return await b(Se),{versionId:Se.data.versionId,link:je(Se.data.link),text:Se.data.text,tags:je(Se.data.tags),updatedAt:Se.data.updatedAt}},ve=async S=>{const j=te(S);if(!j||!j.data)return;const L=(ae=>{const Ce=`${j.data.link?.url||""}||${j.data.link?.title||""}||${j.data.text}||${j.data.tags.join(",")}`,Se=new Set([Ce]),Te=[];for(const ye of ae){const be=`${ye.link?.url||""}||${ye.link?.title||""}||${ye.text}||${ye.tags.join(",")}`;Se.has(be)||(Se.add(be),Te.push(ye))}return Te})([...j.data.history||[]]),M={id:S,data:{...j.data,history:L}};await b(M)},W=async(S,j)=>{const F=te(S);if(!F||!F.data)return;const L=F.data.history?.find?.(ae=>ae.versionId===j);if(!L)return;const M={id:S,data:{...F.data,versionId:L.versionId,link:je(L.link),text:L.text,tags:je(L.tags),updatedAt:L.updatedAt,history:F.data.history?.filter?.(ae=>ae.versionId!==j)||[]}};await b(M)},ce=async S=>{const F=n(l)().get(S);!F||!F.data||(await q(F.id,F.data.link?.url||"",""),O(S),await bs(n(a),Qe,S),r.postMessage({type:"deleteNote",data:{id:S}}))},ie=async()=>{await Wa(n(a),Qe),await Wa(n(a),Rt),B(),r.postMessage({type:"clearNotes"})},te=S=>n(l)().get(S),ee=async(S,j)=>{const L=n(l)().get(S);if(!L||!L.data)return;const M={id:S,data:{...L.data,pinned:j}};b(M)},z=async S=>{const F=n(l)().get(S);if(!F||!F.data)return;const L={id:S,data:{...F.data,archivedAt:Date.now()}};await b(L)},G=async({noteIds:S})=>pu({noteIds:S,notes:n(c)(),notesMap:n(l)(),sendMsgReloadNotes:$,db:n(a),updateDuplicates:q,updateNotes:u}),Y=async({noteIds:S})=>hu({noteIds:S,notes:n(c)(),notesMap:n(l)(),sendMsgReloadNotes:$,db:n(a),updateNotes:u}),ne=async({noteIds:S})=>gu({noteIds:S,notes:n(c)(),notesMap:n(l)(),db:n(a),updateNotes:u,sendMsgReloadNotes:$}),ue=async({noteIds:S})=>_u({noteIds:S,notes:n(c)(),notesMap:n(l)(),db:n(a),updateDuplicates:q,updateNotes:u,sendMsgReloadNotes:$}),Ee=async S=>{const F=n(l)().get(S);if(!F||!F.data)return;const L={id:S,data:{...F.data,deletedAt:0}};await b(L)},He=async S=>{const F=n(l)().get(S);if(!F||!F.data)return;const L={id:S,data:{...F.data,archivedAt:0}};await b(L)},nt=async(S,j)=>{const F=n(i)();F.set(S,{name:S,pinned:j}),await rn(n(a),Rt,S,{pinned:j}),r.postMessage({type:"pinTag",data:{tag:S,pinned:j}}),v(i,()=>F)},_e=async({noteIds:S})=>{const j=n(i)(),F=n(c)(),L=S.map(M=>n(l)().get(M)).filter(M=>!!M);U(S),await wr(n(a),Qe,S),await Promise.all(L.map(async M=>{M?.data&&await q(M.id,M.data.link?.url||"","")})),$(),v(c,()=>F),v(i,()=>j)},Fe=async S=>fu({newNotes:S,notesMap:n(l)(),db:n(a),init:Z,sendMsgReloadNotes:$}),J=async()=>{const S=[];n(c)().forEach(F=>{F&&F.data&&F.data.deletedAt&&S.push(F.id)}),await wr(n(a),Qe,S),await Z(),r.postMessage({type:"emptyBin"})},se=async(S,j)=>uu({tag:S,noteIds:j,notes:n(c)(),notesMap:n(l)(),db:n(a),updateNotes:u,sendMsgReloadNotes:$}),Pe=async(S,j,F)=>mu({tag:S,newTag:j,noteIds:F,notes:n(c)(),notesMap:n(l)(),tagsMap:n(i)(),db:n(a),updateNotes:u,updateTagsMap:f,sendMsgReloadNotes:$}),xe=async(S,j)=>cu({newTag:S,noteIds:j,notes:n(c)(),notesMap:n(l)(),tagsMap:n(i)(),db:n(a),updateNotes:u,updateTagsMap:f,sendMsgReloadNotes:$}),pe=async(S,j,F)=>du({prevTags:S,newTags:j,noteIds:F,notes:n(c)(),notesMap:n(l)(),tagsMap:n(i)(),db:n(a),updateNotes:u,updateTagsMap:f,sendMsgReloadNotes:$}),oe=async S=>{const j=JSON.parse(S.data),F=j?.msg;if(j.tabId&&j.tabId===e.tabId){F.type==="exit"&&(B(),await Wa(n(a),Qe),await Wa(n(a),Rt));return}if(F.type==="putNote"){const M=F.data.id;if(!M)return;const ae=await lo(n(a),Qe,M);if(!ae)return;N({id:M,data:ae})}else if(F.type==="deleteNote"){const L=F.data.id;if(!L)return;O(L)}else if(F.type==="pinTag"){const L=F.data.tag,M=F.data.pinned,ae=n(i)();ae.set(L,{name:L,pinned:M}),v(i,()=>ae)}else F.type==="clearNotes"?B():F.type==="reloadNotes"||F.type==="emptyBin"?Z():F.type==="exit"&&B()};return we(()=>(r.addEventListener(oe),()=>{r.removeEventListener(oe)})),{isInitedNotes:h,createNote:re,updateNote:D,deleteNote:ce,saveNote:V,zipNoteHistory:ve,revertNote:W,pinNote:ee,moveNoteToBin:S=>vu(n(l)(),S,b),moveNoteToArchive:z,getGetNotes:X,getGetNotesMap:Q,importNotes:Fe,clearNotes:ie,getNoteById:te,getGetMapTags:()=>n(i),pinTag:nt,restoreNoteFromBin:Ee,moveNoteFromArchive:He,checkNotes:m,checkNotesInBin:g,checkNotesInArchive:w,emptyBin:J,moveNotesToBin:G,moveNotesToArchive:Y,moveNotesFromArchive:ne,deleteNotes:_e,restoreNotesFromBin:ue,deleteTag:se,renameTag:Pe,addTag:xe,changeTags:pe,checkDuplicatesExist:K,getDuplicateNotesIdsByUrl:C,initNotes:Z}};function bu(t,e){ge(e,!0),$d(yu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const ml={};function Su(t){ot(ml,t)}function fr(){const t=rt(ml);if(!t)throw new Error("No SearchStoreContext found");return t}const _l={};function ku(t){ot(_l,t)}function Pt(){const t=rt(_l);if(!t)throw new Error("No SearchParamsContext found");return t}const Cu=()=>{let t=A(et(new URLSearchParams(window.location.search)));const e=c=>{const l=window.location.pathname;v(t,c,!0),window.history.replaceState(null,"",`${l}${c.size>0?`?${c.toString()}`:""}`)};return{get:()=>n(t),replace:c=>{const l=new URLSearchParams(c);e(l)},set:(c,l)=>{const d=new URLSearchParams(n(t));d.set(c,l),e(d)},delete:c=>{const l=new URLSearchParams(n(t));l.delete(c),e(l)},getHref:(c=n(t))=>{const l=new URLSearchParams(c);return`${window.location.pathname}${l.toString().length>0?`?${l.toString()}`:""}`},clear:()=>{e(new URLSearchParams)}}};function xu(t,e){ge(e,!0),ku(Cu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const Tu=()=>{const t=Pt(),e="search",a=T(()=>t.get().get(e)||""),r=T(()=>n(a));return{get:()=>n(r),set:i=>{i===""?t.delete(e):t.set(e,i)}}};function Eu(t,e){ge(e,!0),Su(Tu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const wl={};function Nu(t){ot(wl,t)}function qn(){const t=rt(wl);if(!t)throw new Error("No SettingsStoreContext found");return t}const Pu=()=>{const t=Pt(),e="viewMode",r=et((()=>{const $=new URLSearchParams(window.location.search).get(e)||"tab";return $==="popup"||$==="window"||$==="tab"||$==="sidebar"?$:"tab"})());we(()=>{t.delete(e)});let o=A(!1),s=A(et({showFavicon:!0,iconForSavedPages:!1,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:i}=ys(),c=So(),l=c.createChannel(),d=T(i),u=async()=>{const R=await lo(n(d),En,"default");R&&v(s,R,!0)},f=async()=>{await u(),v(o,!0)},h=()=>{l.postMessage({type:"updateSettings"})},m=async R=>{const $=JSON.parse(R.data),Z=$?.msg;if($.tabId&&$.tabId===c.tabId){Z.type==="exit"&&(v(s,{showFavicon:!0,iconForSavedPages:!1,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),Wa(n(d),En));return}Z.type==="updateSettings"?u():Z.type==="exit"&&v(s,{showFavicon:!0,iconForSavedPages:!1,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},g=()=>n(s).recordMode,w=()=>n(s).showFavicon,_=()=>n(s).iconForSavedPages,x=async R=>{n(s).showFavicon=R,await rn(n(d),En,"default",pa(n(s))),h()},K=async R=>{n(s).iconForSavedPages=R,await rn(n(d),En,"default",pa(n(s))),h()},C=async R=>{n(s).recordMode=R,await rn(n(d),En,"default",pa(n(s))),h()},N=async R=>{n(s).tags.prev=R,await rn(n(d),En,"default",pa(n(s))),h()},O=()=>n(s).tags.prev||[],U=async R=>{n(s).tags.llm=R,await rn(n(d),En,"default",pa(n(s))),h()},B=()=>n(s).tags.llm,X=()=>n(s).tags.pageData,Q=async R=>{n(s).tags.pageData=R,await rn(n(d),En,"default",pa(n(s))),h()};return we(()=>(f(),l.addEventListener(m),()=>{l.removeEventListener(m)})),{getFaviconEnabled:w,getRecordMode:g,setRecordMode:C,setFaviconShown:x,isInitedSettings:()=>n(o),getViewMode:()=>r,setLlmTagsEnabled:U,getLlmTagsEnabled:B,setPrevTags:N,getPrevTags:O,getPageDataForTagsEnabled:X,setPageDataForTagsEnabled:Q,getIconForSavedPagesEnabled:_,setIconForSavedPagesEnabled:K}};function Au(t,e){ge(e,!0),Nu(Pu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const yl={};function Du(t){ot(yl,t)}function Ot(){const t=rt(yl);if(!t)throw new Error("No DialogPagesContext found");return t}const Ht="dialog-pages",Iu=()=>{const t=Pt(),e=T(()=>t.get()),a=T(()=>n(e).get(Ht)||""),r=T(()=>n(a).split(",").map(m=>decodeURIComponent(m)).filter(m=>m!=="")),o=()=>n(r),s=m=>{if(m.length===0){t.delete(Ht);return}t.set(Ht,m.map(g=>encodeURIComponent(g)).join(","))},i=m=>{t.set(Ht,[...n(r),m].map(g=>encodeURIComponent(g)).join(","))};return{set:s,get:o,push:i,pop:()=>{const m=n(r)[n(r).length-1];return n(r).length<=1?(t.delete(Ht),m):(t.set(Ht,n(r).slice(0,-1).map(g=>encodeURIComponent(g)).join(",")),m)},replace:m=>{t.set(Ht,[...n(r).slice(0,-1),m].map(g=>encodeURIComponent(g)).join(","))},has:m=>n(r).find(g=>{const[w]=g.split("?");return w===m})!==void 0,clear:()=>{t.delete(Ht)},createHref:m=>{const g=new URLSearchParams(n(e).toString());return g.set(Ht,[...o(),m].map(w=>encodeURIComponent(w)).join(",")),`${window.location.pathname}?${g.toString()}`},createHandleClick:m=>g=>{g.preventDefault(),i(m)}}};function Mu(t,e){ge(e,!0),Du(Iu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}var me=(t=>(t.NewNote="new-note",t.Note="note",t.Settings="settings",t.ImportData="import-data",t.ExportData="export-data",t.Account="account",t.Sync="sync",t.AccountSetup="account-setup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="access-keys",t.ConfirmAccessKey="confirm-access-key",t.Subscription="subscription",t.Exit="exit",t.NotFound="not-found",t.About="about",t.Install="install",t.InstallSuccess="install-success",t.Extension="extension",t.AddNotes="add-notes",t))(me||{});const ai={settings:"Settings","import-data":"Import","export-data":"Export",account:"Account",sync:"Sync","account-setup":"",auth:"Auth",signin:"Sign in",signup:"Sign up","confirm-access-key":"Confirm access key","access-keys":"Access keys",subscription:"Subscription",exit:"Exit","not-found":"",about:"About",install:"Install app","install-success":"Install success",extension:"Extension"},Lu=()=>{Ot();const t=Pt(),e=qn(),a=kt();fr(),e.getViewMode();let r=A(!1);const o=i=>{const c=new URLSearchParams(i),l=c.get(Ht),d=decodeURIComponent(l?.split(",").pop()||""),u=new URLSearchParams(d.split("?")[1]||"").get("id");return d.startsWith(me.NewNote)&&u&&(i=c.toString().replace(me.NewNote,`${me.Note}`)),i},s=async()=>{let c=t.get().toString();c=o(c),t.replace(c),v(r,!0)};return we(async()=>{await a.initNotes(),s()}),we(()=>{}),{isInited:()=>n(r)}};function Ru(t,e){ge(e,!0);const{isInited:a}=Lu();Zd({isInited:a});var r=fe(),o=E(r);Ae(o,()=>e.children??Ue),p(t,r),he()}const bl={};function Fu(t){ot(bl,t)}function Ss(){const t=rt(bl);if(!t)throw new Error("No AccountStoreContext found");return t}const Ou=()=>{let t=A(void 0);const{getDB:e}=ys(),a=So(),r=T(e),o=a.createChannel(),s=async()=>{const g=await lo(n(r),_r,"default");v(t,g,!0)},i=g=>rn(n(r),_r,"default",g),c=async g=>{const w=await lo(n(r),_r,"default");w!==void 0&&v(t,w,!0),g(w)},l=async g=>{const w=JSON.parse(g.data);if(w.tabId&&w.tabId===a.tabId)return;const _=w?.msg;_.type==="initLocalAccount"?v(t,null):_.type==="initCloudAccount"?s():_.type==="disconnectCloudAccount"?v(t,null):_.type==="exit"?v(t,void 0):_.type==="updateAccount"&&s()};return we(()=>(o.addEventListener(l),()=>{o.removeEventListener(l)})),{init:c,getAccount:()=>n(t),initLocalAccount:async()=>{v(t,null),await i(null),o.postMessage({type:"initLocalAccount"})},initCloudAccount:async g=>{const w={encryptedClientKey:g.encryptedClientKey||"",subscriptionExpires:g.subscriptionExpires||-1,lastSync:-1};await i(w),v(t,w,!0),o.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{v(t,null),await i(null),o.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async g=>{if(!n(t))throw new Error("No account to update subscription for");const w={...n(t),subscriptionExpires:g};await i(w),o.postMessage({type:"updateAccount"})},exitAccount:async()=>{v(t,void 0),o.postMessage({type:"exit"}),await Wa(n(r),_r)}}};function zu(t,e){ge(e,!0),Fu(Ou());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const Sl={},Na=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function Bu(t){ot(Sl,t)}function Cn(){const t=rt(Sl);if(!t)throw new Error("No AnimationSettingsContext found");return t}const ju=()=>{let t=A(et({working:!1,swipingRatio:0,isSwiping:!1,duration:.2}));return{get:()=>n(t),set:e=>{v(t,{...n(t),...e},!0)},reset:()=>{v(t,{...n(t),swipingRatio:0,duration:.2},!0)}}};function Hu(t,e){ge(e,!0),Bu(ju());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const kl={};function Uu(t){ot(kl,t)}function Vt(){const t=rt(kl);if(!t)throw new Error("No DialogContext found");return t}const Wu=()=>{let t=A(0),e=A(!1),a=A(!0),r=A(!1),o=A(!1);return{checkExistedDialog:()=>n(t)>0,dialogInc:()=>{v(t,n(t)+1)},dialogDec:()=>{v(t,n(t)-1)},blockDialog:x=>{v(e,x,!0)},checkBlockedDialog:()=>n(e),setClosableDialog:x=>{v(a,x,!0)},checkClosableDialog:()=>n(a),checkLeftStart:()=>n(r),checkLeftEnd:()=>n(o),setLeftStart:x=>{v(r,x,!0)},setLeftEnd:x=>{v(o,x,!0)},getCountDialog:()=>n(t)}};function Vu(t,e){ge(e,!0),Uu(Wu());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}var qu=k("<a><!></a>"),Ku=k("<button><!></button>");function Tt(t,e){let a=Ne(e,"type",3,"standard"),r=Ne(e,"typeButton",3,"button"),o=Ne(e,"element",3,"button"),s=Ne(e,"href",3,""),i=Ne(e,"fullWidth",3,!1),c=Ne(e,"withoutMinWidth",3,!1);var l=fe(),d=E(l);{var u=h=>{var m=qu();m.__click=function(...w){e.onClick?.apply(this,w)};var g=y(m);Ae(g,()=>e.children??Ue),ke(()=>{tt(m,"target",e.target),tt(m,"rel",e.rel),tt(m,"href",s()),Ge(m,1,Xe({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:c(),g:e.size==="small"}),"p-1iz5xf9")}),p(h,m)},f=h=>{var m=Ku();m.__click=function(...w){e.onClick?.apply(this,w)};var g=y(m);Ae(g,()=>e.children??Ue),ke(()=>{tt(m,"type",r()),Ge(m,1,Xe({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:c(),g:e.size==="small"}),"p-1iz5xf9")}),p(h,m)};H(d,h=>{o()==="a"?h(u):h(f,!1)})}p(t,l)}st(["click"]);var Gu=k('<h1 class="p-1n0ziuh"><!></h1>');function Yu(t,e){var a=Gu(),r=y(a);Ae(r,()=>e.children),p(t,a)}var Xu=k('<!> <div class="b p-193tby9"><!> <!></div>',1),Ju=k('<div class="a p-193tby9"><!></div>');function Zu(t,e){ge(e,!0);const{blockDialog:a,setLeftEnd:r}=Vt(),o=Ot(),s=Ss(),i=Pt(),c=Cn(),l=()=>{o.push(me.Auth)},d=async()=>{c.set({duration:0,swipingRatio:-25,working:!0}),requestAnimationFrame(()=>{c.reset(),s.initLocalAccount(),a(!1),r(!0),i.replace("")})};var u=Ju(),f=y(u);{var h=m=>{var g=Xu(),w=E(g);Yu(w,{children:(C,N)=>{var O=Me("Welcome");p(C,O)}});var _=P(w,2),x=y(_);Tt(x,{onClick:l,fullWidth:!0,children:(C,N)=>{var O=Me("Cloud account");p(C,O)},$$slots:{default:!0}});var K=P(x,2);Tt(K,{onClick:d,fullWidth:!0,type:"secondary",children:(C,N)=>{var O=Me("Local account");p(C,O)},$$slots:{default:!0}}),p(m,g)};H(f,m=>{m(h)})}p(t,u),he()}const Zo=t=>{try{new URL(t)}catch{return!1}return!0},Cl={};function Qu(t){ot(Cl,t)}function ko(){const t=rt(Cl);if(!t)throw new Error("No MetaTagsSelectionStoreContext found");return t}var Ze=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(Ze||{});const ha="meta-tags",$u=()=>{const t=Pt(),e=T(()=>t.get()),a=T(()=>n(e).get(ha)||""),r=T(()=>new Set(n(a).split(",").map(d=>decodeURIComponent(d)).filter(d=>d!=="")));return{getAll:()=>n(r),add:d=>{n(r).has(d)||t.set(ha,[...n(r),d].map(u=>encodeURIComponent(u)).join(","))},remove:d=>{n(r).has(d)&&n(r).size===1?t.delete(ha):n(r).has(d)&&t.set(ha,[...n(r)].filter(u=>u!==d).map(u=>encodeURIComponent(u)).join(","))},clear:()=>{t.delete(ha)},set:d=>{d.size===0?t.delete(ha):t.set(ha,[...d].map(u=>encodeURIComponent(u)).join(","))}}};function ef(t,e){ge(e,!0);const a=$u();Qu(a);var r=fe(),o=E(r);Ae(o,()=>e.children??Ue),p(t,r),he()}const Qo=(t,e,a,r)=>{if(t.has(Ze.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const c of i?.data?.tags||[])o.includes(c)||o.push(c);continue}if(i.data&&s.every(c=>i.data?.tags.includes(c)))for(const c of i.data.tags||[])!e.has(c)&&!o.includes(c)&&o.push(c)}return o},xl={};function tf(t){ot(xl,t)}function Kn(){const t=rt(xl);if(!t)throw new Error("No TagsSelectionStoreContext found");return t}const nf=()=>{const t=Pt(),e=T(()=>t.get()),a="tags",r=T(()=>n(e).get(a)||""),o=T(()=>new Set(n(r).split(",").map(u=>decodeURIComponent(u)).filter(u=>u!=="")));return{get:()=>n(o),add:u=>{n(o).has(u)||t.set(a,[...n(o),u].map(f=>encodeURIComponent(f)).join(","))},remove:u=>{n(o).has(u)&&n(o).size===1?t.delete(a):n(o).has(u)&&t.set(a,[...n(o)].filter(f=>f!==u).map(f=>encodeURIComponent(f)).join(","))},clear:()=>{t.delete(a)},set:u=>{u.size===0?t.delete(a):t.set(a,[...u].map(f=>encodeURIComponent(f)).join(","))}}};function af(t,e){ge(e,!0),tf(nf());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}var rf=Dd('<svg class="p-1yv1ibq"><use></use></svg>');function de(t,e){let a=Ne(e,"name",8,"");var r=rf(),o=y(r);ke(()=>tt(o,"href",`#icon-${a()??""}`)),p(t,r)}var of=k('<div class="b p-1pt17hy"> </div>'),sf=k('<div class="a p-1pt17hy"><input/> <!></div>');function xr(t,e){ge(e,!0);let a=Ne(e,"value",15,""),r=Ne(e,"error",3,""),o=Ne(e,"ref",15,null);var s=sf(),i=y(s);i.__input=function(...u){e.onInput?.apply(this,u)};let c;Ke(i,u=>o(u),()=>o());var l=P(i,2);{var d=u=>{var f=of(),h=y(f);ke(()=>at(h,r())),p(u,f)};H(l,u=>{r()&&u(d)})}ke(()=>{tt(i,"placeholder",e.placeholder),c=Ge(i,1,"p-1pt17hy",null,c,{error:!!r()})}),Wt("blur",i,function(...u){e.onBlur?.apply(this,u)}),Wt("focus",i,function(...u){e.onFocus?.apply(this,u)}),dl(i,a),p(t,s),he()}st(["input"]);var lf=k('<div><!> <div class="a p-y3zt6o"></div></div>');function Da(t,e){ge(e,!0);let a=A(!1);we(()=>{const s=setTimeout(()=>{v(a,!0)},200);return()=>{clearTimeout(s)}});var r=lf(),o=y(r);Ae(o,()=>e.children??Ue),ke(()=>Ge(r,1,Xe({b:!0,c:n(a)}),"p-y3zt6o")),p(t,r),he()}var cf=k("<button><!></button>");function Jn(t,e){ge(e,!0);let a=Ne(e,"type",3,"button"),r=!1,o=A(null);Le(()=>{e.onRef&&e.onRef(n(o))});const s=u=>{(u.key==="Enter"||u.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},c=u=>{(u.pointerType==="mouse"&&u.button===0||u.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(u)};var l=cf();l.__keydown=s,l.__click=i,l.__pointerdown=c,l.__touchstart=function(...u){e.onTouchStart?.apply(this,u)};var d=y(l);Ae(d,()=>e.children??Ue),Ke(l,u=>v(o,u),()=>n(o)),ke(()=>{tt(l,"type",a()),l.disabled=e.disabled,Ge(l,1,Xe({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty",e:e.disabled}),"p-12kakje")}),p(t,l),he()}st(["keydown","click","pointerdown","touchstart"]);var df=k('<span class="a p-lxk90o"><!></span>');function ct(t,e){var a=df(),r=y(a);Ae(r,()=>e.children),p(t,a)}var uf=k('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),ff=k('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),vf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),hf=k("<div><!></div>"),pf=k('<form class="c p-r3if1j"><div class="d p-r3if1j"><!></div> <button type="button" class="e p-r3if1j">Done</button></form>'),mf=k('<div class="a"><div class="b p-r3if1j"><!> <!> <!> <!> <!> <!></div> <!></div>');function Tl(t,e){ge(e,!0);let a=Ne(e,"shownTagInput",15),r=A(null),o=A(""),s=A(null);const i=kt(),c=Kn(),l=T(()=>i.isInitedNotes()),d=()=>n(l)?e.mode==="exit"?Qo(new Set,new Set(e.selectedTags),i.getGetNotes()()||[]):[...i.getGetMapTags()().keys()]:[];let f=T(()=>{const D=c.get(),V=new Set(Qo(new Set,new Set(e.selectedTags.length>0?e.selectedTags:D),i.getGetNotes()()||[]));return d().filter(W=>e.selectedTags.some(ce=>W===ce)?!1:n(o)===""||W.toLowerCase().indexOf(n(o).toLowerCase())===0).sort((W,ce)=>D.has(W)&&D.has(ce)?W.localeCompare(ce):D.has(W)?-1:D.has(ce)?1:V.has(W)&&V.has(ce)?W.localeCompare(ce):V.has(W)?-1:V.has(ce)?1:0)});const h=D=>{if(!e.selectedTags.includes(D)){if(e.mode!=="exit"||n(f).includes(D)){e.onChangeTags([...e.selectedTags,D]),v(o,"");return}n(r)?.focus()}},m=D=>{const V=e.selectedTags.filter(ve=>ve!==D);e.onRejectedTag&&e.onRejectedTag(D),V.length===0?e.onChangeTags([]):e.onChangeTags(V)},g=D=>{D.preventDefault(),n(o)!==""?h(n(o)):a(!1)};Le(()=>{n(r)&&a()&&n(r).focus(),a()||v(o,"")});const w=D=>{D.preventDefault()},_=D=>{D.preventDefault(),D.stopPropagation(),D.stopImmediatePropagation()};var x=mf(),K=y(x),C=y(K);Bn(C,17,()=>e.selectedTags,D=>D+"-tags_selected",(D,V)=>{Jn(D,{onPointerDown:w,onTouchStart:_,onClick:()=>{m(n(V))},type:"button",style:"selected",children:(ve,W)=>{var ce=Me();ke(()=>at(ce,n(V))),p(ve,ce)},$$slots:{default:!0}})});var N=P(C,2);{var O=D=>{var V=fe(),ve=E(V);Bn(ve,17,()=>n(f).filter(W=>W.toLowerCase()!==n(o).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),W=>W+"-tags_suggested",(W,ce)=>{Jn(W,{onPointerDown:w,onTouchStart:_,onClick:()=>{h(n(ce))},children:(ie,te)=>{var ee=Me();ke(()=>at(ee,n(ce))),p(ie,ee)},$$slots:{default:!0}})}),p(D,V)};H(N,D=>{a()&&D(O)})}var U=P(N,2);{var B=D=>{Jn(D,{onPointerDown:w,onTouchStart:_,onClick:()=>{h(n(o)),v(o,"")},children:(V,ve)=>{var W=Me();ke(()=>at(W,n(o))),p(V,W)},$$slots:{default:!0}})};H(U,D=>{n(o)!==""&&(e.mode!=="exit"||n(f).find(V=>V.toLowerCase()===n(o).toLowerCase()))&&D(B)})}var X=P(U,2);{var Q=D=>{Jn(D,{mode:"empty",onPointerDown:w,onTouchStart:_,onClick:()=>{a(!0)},children:(V,ve)=>{var W=uf(),ce=y(W);le(ce,()=>({"--size":"12px"})),de(ce.lastChild,{name:"plus"});var ie=P(ce,2);ct(ie,{children:(te,ee)=>{var z=Me("add tag");p(te,z)}}),p(V,W)},$$slots:{default:!0}})};H(X,D=>{a()||D(Q)})}var R=P(X,2);{var $=D=>{Jn(D,{mode:"empty",onPointerDown:w,onTouchStart:_,get onClick(){return e.onUsePreviousTags},children:(V,ve)=>{var W=ff(),ce=y(W);le(ce,()=>({"--size":"12px"})),de(ce.lastChild,{name:"back"});var ie=P(ce,2);ct(ie,{children:(te,ee)=>{var z=Me("use previous tags");p(te,z)}}),p(V,W)},$$slots:{default:!0}})};H(R,D=>{e.previousTagsEnabled&&e.onUsePreviousTags&&D($)})}var Z=P(R,2);{var q=D=>{Jn(D,{mode:"empty",onPointerDown:w,onTouchStart:_,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:(V,ve)=>{var W=hf(),ce=y(W);{var ie=ee=>{var z=vf(),G=E(z);le(G,()=>({"--size":"12px"})),Da(G.lastChild,{}),p(ee,z)},te=ee=>{var z=gf(),G=E(z);le(G,()=>({"--size":"12px","--rotate":"180deg"})),de(G.lastChild,{name:"stars"});var Y=P(G,2);ct(Y,{children:(ne,ue)=>{var Ee=Me("gen tags");p(ne,Ee)}}),p(ee,z)};H(ce,ee=>{e.generatingTags?ee(ie):ee(te,!1)})}p(V,W)},$$slots:{default:!0}})};H(Z,D=>{e.genTagsEnabled&&e.onGenTags&&D(q)})}var b=P(K,2);{var re=D=>{var V=pf(),ve=y(V),W=y(ve);xr(W,{placeholder:"tag",get ref(){return n(r)},set ref(ie){v(r,ie,!0)},get value(){return n(o)},set value(ie){v(o,ie,!0)}});var ce=P(ve,2);ce.__pointerdown=w,ce.__touchstart=_,ce.__click=()=>{n(r)?.blur(),n(o)!==""&&h(n(o)),a(!1),v(o,"")},Wt("submit",V,g),p(D,V)};H(b,D=>{a()&&D(re)})}Ke(x,D=>v(s,D),()=>n(s)),p(t,x),he()}st(["pointerdown","touchstart","click"]);const _f=t=>{let e="",a=!0;function r(o){for(let s=0;s<o.length;s++){const i=o[s];if(i.nodeName==="BR"){e+=`
`,a=!0;continue}i.nodeName==="DIV"&&a===!1&&(e+=`
`),a=!1,i.nodeType===3&&i.textContent&&(e+=i.textContent),r(i.childNodes)}}return r(t),e===`
`&&(e=e.slice(0,-1)),e};function wf(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const Un=wf(),yf=()=>{const t=navigator.userAgent;return/android/i.test(t)},Wn=yf(),Nm=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},Tr=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))},bf=()=>{const t=()=>{const a=new Set(["script","style","noscript","iframe","svg","canvas","meta","link","input","button","form"]),r=l=>{if(l.childNodes.length===0)return!1;for(const d of l.childNodes)if(d.nodeType===Node.TEXT_NODE&&d.textContent?.trim())return!0;return!1},o=Array.from({length:10},()=>({priority:0,text:""})),s=(l,d)=>({main:l.main||d.tagName.toLowerCase()==="main",article:l.article||d.tagName.toLowerCase()==="article",h1:l.h1||d.tagName.toLowerCase()==="h1",h2:l.h2||d.tagName.toLowerCase()==="h2",h3:l.h3||d.tagName.toLowerCase()==="h3"}),i=l=>{let d=0;return l.main&&(d+=1e3),l.article&&(d+=1e4),l.h1&&(d+=10),l.h2&&(d+=5),l.h3&&(d+=1),d},c=(l=document.body,d={main:!1,article:!1,h1:!1,h2:!1,h3:!1})=>{for(const u of l.childNodes)if(u.nodeType===Node.ELEMENT_NODE){if(a.has(u.tagName.toLowerCase()))continue;if(r(u)){const f=u.textContent;if(!f)continue;for(let h=0;h<o.length&&!o[h].text.includes(f||"");h++)if(f&&i(s(d,u))+f.length>o[h].priority){o.splice(h,0,{priority:i(s(d,u))+f.length,text:f.trim()}),o.pop();break}}else c(u,s(d,u))}};return c(),o};return{title:document.title||"",desctiption:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",topTextContents:t()}},Sf=async()=>await hl().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),kf=async()=>typeof LanguageModel>"u"?"unavailable":await hl().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),Cf=t=>new Promise(e=>{Qs().tabs.query({active:!0,currentWindow:!0},async a=>{const r=a[0];if(!r||!r.id){e(void 0);return}if(r.url!==t){e(void 0);return}const s=(await Qs().scripting.executeScript({target:{tabId:r.id},world:"MAIN",func:bf}))[0]?.result;e(s)})}),xf=async({llmSession:t,rejectedTags:e,accessPageData:a,text:r,link:o,tags:s})=>{const i=a&&o?.url?await Cf(o.url):void 0,c={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},l=`
			Page information:
			Title: ${o?.title||"N/A"}.
			URL: ${o?.url||"N/A"}.
			Description: ${i?.desctiption||"N/A"}.
			Note content: ${r||"N/A"}.
			Dont return tags: ${[...e.length>0?e:[],...s.length>0?s:[]].join(", ")||"N/A"}.
			Page contents: ${i?.topTextContents?i.topTextContents.slice(0,5).map(({priority:f,text:h})=>`priority: ${f}; text: ${h}

`).join(""):"N/A"}.
		`.slice(0,5e3),d=await t.prompt(l,{responseConstraint:c});return Array.from(new Set([...s,...(JSON.parse(d)?.tags||[]).map(f=>f.trim().toLowerCase()).filter(f=>f!=="")]))};var Tf=k('<div class="a p-1hg9kpf"></div>'),Ef=k('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function El(t,e){ge(e,!0);const a=d=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(d).host}.ico`}catch{return""}};let r=A(!1),o=T(()=>a(e.url));var s=fe(),i=E(s);{var c=d=>{var u=Tf();p(d,u)},l=d=>{var u=Ef();ke(f=>tt(u,"src",f),[()=>a(e.url)]),Wt("error",u,()=>{v(r,!0)}),p(d,u)};H(i,d=>{n(r)||!n(o)?d(c):d(l,!1)})}p(t,s),he()}var Nf=k('<a target="_blank" rel="noopener noreferrer"><!> <!></a>'),Pf=k("<button><!> <!></button>");function Qt(t,e){ge(e,!0);let a=Ne(e,"tabindex",3,0),r=Ne(e,"onclick",3,()=>{}),o=Ne(e,"ref",15),s=Ne(e,"disabled",3,!1);var i=fe(),c=E(i);{var l=u=>{var f=Nf();f.__click=function(...g){r()?.apply(this,g)};var h=y(f);Ae(h,()=>e.children);var m=P(h,2);ct(m,{children:(g,w)=>{var _=Me();ke(()=>at(_,e.title)),p(g,_)}}),Ke(f,g=>o(g),()=>o()),ke(()=>{tt(f,"href",e.href),tt(f,"tabindex",s()?-1:a()),Ge(f,1,Xe({a:!0,b:s()}),"p-62et9t")}),p(u,f)},d=u=>{var f=fe(),h=E(f);{var m=g=>{var w=Pf();w.__click=function(...K){r()?.apply(this,K)};var _=y(w);Ae(_,()=>e.children);var x=P(_,2);ct(x,{children:(K,C)=>{var N=Me();ke(()=>at(N,e.title)),p(K,N)}}),Ke(w,K=>o(K),()=>o()),ke(()=>{tt(w,"tabindex",s()?-1:a()),Ge(w,1,Xe({a:!0,b:s()}),"p-62et9t"),w.disabled=s()}),p(g,w)};H(h,g=>{e.elem==="button"&&g(m)},!0)}p(u,f)};H(c,u=>{e.elem==="a"?u(l):u(d,!1)})}p(t,i),he()}st(["click"]);const Nl=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),ft=t=>{const e=Nl(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let xt=A(""),Tn=A(null),Va=A(null),Pn=A(null),Xn=A(et([])),Jr=A(null),Zn=null;function Ye(t,e){v(xt,""),Zn=null,v(Va,null),v(Pn,null),setTimeout(()=>{v(xt,t,!0),e?.onFinish&&v(Va,e.onFinish,!0),e?.cancel&&(v(Pn,e.cancel.onCancel,!0),Zn=e.cancel.nextFocusRef)},16)}var Af=k('<button type="button" class="c p-146w2pd">undo</button>'),Df=k('<div class="a p-146w2pd"><div class="b p-146w2pd"><span> </span> <!></div></div>'),If=k("<div><!></div>");function Co(t,e){ge(e,!0);let a=Ne(e,"ref",15,null);const r=jn();Le(()=>{a(n(Tn))}),we(()=>(v(Xn,[...n(Xn),r],!0),()=>{const d=n(Xn).indexOf(r);d!==-1&&v(Xn,n(Xn).filter((u,f)=>f!==d),!0)}));const o=d=>{if(d.key==="Tab"&&d.shiftKey){if(Zn&&n(xt)){d.preventDefault();const{prev:u}=ft(Zn);u?.focus(),v(xt,"")}}else if(d.key==="Tab"&&!d.shiftKey)Zn&&n(xt)&&(d.preventDefault(),v(xt,""),Zn?.focus());else if(d.key==="Escape"&&n(xt)){if(d.preventDefault(),Zn){const{prev:u}=ft(Zn);u?.focus()}v(xt,"")}};we(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)})),Le(()=>{n(xt);const d=n(Pn)?2e3:800;n(xt)&&(n(Tn)?.getBoundingClientRect(),n(Tn)?.style.setProperty("opacity","1"));const u=setTimeout(()=>{n(Tn)?.style.removeProperty("opacity")},d),f=setTimeout(()=>{v(xt,""),n(Va)&&n(Va)(),v(Va,null),v(Pn,null),n(Tn)?.style.removeProperty("opacity")},d+400);return()=>{clearTimeout(u),clearTimeout(f)}});const s=d=>{d.preventDefault(),n(Pn)&&(v(Va,null),n(Pn)(),v(Pn,null)),v(xt,""),n(Tn)?.style.removeProperty("opacity")};Le(()=>{n(xt)&&n(Pn)&&n(Jr)&&setTimeout(()=>{n(Jr)?.focus()},151)}),Le(()=>{n(Xn),ht(()=>{v(xt,""),n(Tn)?.style.removeProperty("opacity")})});var i=If(),c=y(i);{var l=d=>{var u=Df(),f=y(u),h=y(f),m=y(h),g=P(h,2);{var w=_=>{var x=Af();x.__click=s,Ke(x,K=>v(Jr,K),()=>n(Jr)),p(_,x)};H(g,_=>{n(Pn)&&_(w)})}Ke(f,_=>v(Tn,_),()=>n(Tn)),ke(()=>at(m,n(xt))),p(d,u)};H(c,d=>{n(xt)&&n(Xn)[n(Xn).length-1]===r&&d(l)})}p(t,i),he()}st(["click"]);var Mf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Lf=k('<form class="b p-10m9vsg"><!> <!> <div class="c p-10m9vsg"><div class="d p-10m9vsg"><button type="button" class="p-10m9vsg">Cancel</button> <button type="submit" class="p-10m9vsg">Done</button></div> <!></div></form>'),Rf=k('<div class="f p-10m9vsg"><!></div>'),Ff=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Of=k('<div class="e p-10m9vsg"><div><!> <a class="g p-10m9vsg" target="_blank" rel="noopener noreferrer"> </a> <div><!></div></div></div>'),zf=k('<div class="a p-10m9vsg"><!></div>');function Bf(t,e){ge(e,!0);let a=Ne(e,"shownUrlInput",15);const r=qn();let o=T(()=>r.getFaviconEnabled()),s=A(null),i=A(null),c=A(null),l=A(et(e.url)),d=A(et(e.title)),u=A(null);const f=C=>{v(l,C.target.value||"",!0)},h=C=>{v(d,C.target.value||"",!0)};Le(()=>{a()&&n(s)?.focus()});const m=()=>{e.url&&(navigator.clipboard.writeText(e.url),Ye("Copied link"))},g=()=>{v(d,""),v(l,""),e.onDeleteUrl(),a(!1)};var w=zf(),_=y(w);{var x=C=>{var N=Lf(),O=y(N);xr(O,{get value(){return n(l)},onInput:f,placeholder:"url",get ref(){return n(s)},set ref(Z){v(s,Z,!0)}});var U=P(O,2);xr(U,{get value(){return n(d)},onInput:h,placeholder:"title",get ref(){return n(i)},set ref(Z){v(i,Z,!0)}});var B=P(U,2),X=y(B),Q=y(X);Q.__click=()=>{v(l,e.url,!0),v(d,e.title,!0),a(!1)};var R=P(X,2);{var $=Z=>{Qt(Z,{title:"delete link",elem:"button",onclick:g,children:(q,b)=>{var re=Mf(),D=E(re);le(D,()=>({"--size":"20px"})),de(D.lastChild,{name:"bin"}),p(q,re)},$$slots:{default:!0}})};H(R,Z=>{(e.url||e.title)&&Z($)})}Wt("submit",N,Z=>{if(Z.preventDefault(),document.activeElement===n(s)){n(i)?.focus();return}let q=n(l).trim();q!==""&&/^[[a-zA-Z]+?:\/\//.test(q)===!1&&(q="https://"+q,v(l,q,!0)),e.onChangeUrl(q,n(d)),a(!1)}),p(C,N)},K=C=>{var N=fe(),O=E(N);{var U=B=>{var X=Of(),Q=y(X);Ge(Q,1,Xe({h:!0}),"p-10m9vsg");var R=y(Q);{var $=D=>{var V=Rf(),ve=y(V);El(ve,{get url(){return e.url}}),p(D,V)};H(R,D=>{n(o)&&D($)})}var Z=P(R,2),q=y(Z),b=P(Z,2);Ge(b,1,Xe({i:!0}),"p-10m9vsg");var re=y(b);Qt(re,{title:"copy link",elem:"button",onclick:m,children:(D,V)=>{var ve=Ff(),W=E(ve);le(W,()=>({"--size":"20px"})),de(W.lastChild,{name:"copy"}),p(D,ve)},$$slots:{default:!0}}),Ke(Q,D=>v(u,D),()=>n(u)),ke(()=>{tt(Z,"href",e.url),at(q,e.title||"unknown")}),p(B,X)};H(O,B=>{e.url&&B(U)},!0)}p(C,N)};H(_,C=>{a()?C(x):C(K,!1)})}Ke(w,C=>v(c,C),()=>n(c)),p(t,w),he()}st(["click"]);const Pl={};function jf(t){ot(Pl,t)}function fa(){const t=rt(Pl);if(!t)throw new Error("No MobileSizeContext found");return t}const Hf=()=>{const t=()=>window.matchMedia("(max-width: 767px)").matches;let e=A(et(t()));const a=Cn(),r=pl(()=>{a.set({working:!0})},16),o=()=>{a.get().working&&(a.set({working:!1}),r()),requestAnimationFrame(()=>{v(e,t(),!0)})},s=()=>n(e);return we(()=>(window.addEventListener("resize",o),()=>window.removeEventListener("resize",o))),{check:s}};function Uf(t,e){ge(e,!0),jf(Hf());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}function ks(t,e){ge(e,!0);let a=Ne(e,"notificationRef",11,null);we(()=>{const r=o=>{o.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==o.target&&!e.dialogInner.contains(o.target)&&a()!==o.target&&!a()?.contains(o.target)&&e.onClose()};return document.addEventListener("mousedown",r,{capture:!0}),()=>{document.removeEventListener("mousedown",r,{capture:!0})}}),he()}let Ha=A(et([]));var Wf=k("<dialog><div><!></div></dialog> <!>",1);function Or(t,e){ge(e,!0);const a=jn(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;we(()=>(v(Ha,[...n(Ha),a],!0),()=>{const C=n(Ha).indexOf(a);C!==-1&&v(Ha,n(Ha).filter((N,O)=>O!==C),!0)}));let o=Ne(e,"onClosed",3,()=>{}),s=Ne(e,"blocked",3,!1),i=A(null),c=A(null),l=A(!1),{dialogInc:d,dialogDec:u}=Vt();const f=()=>{const C=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(C),o()()},{once:!0}),v(l,!1)};Le(()=>{e.startClose&&f()}),we(()=>{n(i)?.showModal(),n(i)?.getClientRects(),v(l,!0);const C=N=>{N?.preventDefault(),s()||f()};return n(i)?.addEventListener("cancel",C),n(i)?.addEventListener("close",C),()=>{n(i)?.removeEventListener("cancel",C),n(i)?.removeEventListener("close",C)}}),we(()=>(d(),()=>{u()})),we(()=>{const C=N=>{N.key==="Escape"&&s()&&N.preventDefault()};return window.addEventListener("keydown",C),()=>{window.removeEventListener("keydown",C)}});function h(){setTimeout(()=>{if(!n(i)||!n(c))return;const C=window.visualViewport;if(C)if(C.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},100)}we(()=>(h(),window.visualViewport?.addEventListener("resize",h),window.visualViewport?.addEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h),()=>{window.visualViewport?.removeEventListener("resize",h),window.visualViewport?.removeEventListener("scroll",h),document.addEventListener("focusin",h),document.addEventListener("focusout",h)}));var m=Wf(),g=E(m),w=y(g),_=y(w);Ae(_,()=>e.children),Ke(w,C=>v(c,C),()=>n(c)),Ke(g,C=>v(i,C),()=>n(i));var x=P(g,2);{var K=C=>{ks(C,{get dialog(){return n(i)},get dialogInner(){return n(c)},onClose:f})};H(x,C=>{n(i)&&n(c)&&!s()&&C(K)})}ke(()=>{Ge(g,1,Xe({a:!0,b:n(l),c:n(Ha).length>1}),"p-1x14yml"),Ge(w,1,Xe({d:!0,b:n(l)}),"p-1x14yml")}),p(t,m),he()}var Vf=k("<div><!></div>");function qf(t,e){ge(e,!0);let a=A(!1),r=A(null),o=null;const s=()=>{const f=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(f),e.onClosed()},{once:!0}),v(a,!1)},i=f=>{f.target!==n(r)&&!n(r)?.contains(f.target)&&s()},c=f=>{f.target!==n(r)&&!n(r)?.contains(f.target)&&s()},l=f=>{if(f.key==="Escape"&&(f.preventDefault(),s()),f.key==="ArrowUp"||f.key==="ArrowDown"){if(!n(r))return;f.preventDefault(),f.stopPropagation(),f.stopImmediatePropagation();const h=Nl(n(r));if(o){const m=h.indexOf(o),g=h[m-1],w=h[m+1];f.key==="ArrowUp"&&g?(g.focus(),o=g):f.key==="ArrowDown"&&w&&(w.focus(),o=w)}else f.key==="ArrowUp"?(h[h.length-1].focus(),o=h[h.length-1]):f.key==="ArrowDown"&&(h[0].focus(),o=h[0])}};we(()=>{n(r)?.getClientRects(),v(a,!0);const f=setTimeout(()=>{document.addEventListener("focusin",i),document.addEventListener("click",c),document.addEventListener("keydown",l,{capture:!0})},0);return()=>{clearTimeout(f),document.removeEventListener("focusin",i),document.removeEventListener("click",c),document.removeEventListener("keydown",l,{capture:!0})}}),Le(()=>{e.startClose&&s()});var d=Vf(),u=y(d);Ae(u,()=>e.children),Ke(d,f=>v(r,f),()=>n(r)),ke(()=>Ge(d,1,Xe({a:!0,b:n(a)}),"p-159ibkc")),p(t,d),he()}var Kf=k("<ul><!></ul>"),Gf=k("<ul><!></ul>");function zr(t,e){ge(e,!0);let a=Ne(e,"ref",15);var r=fe(),o=E(r);{var s=c=>{Or(c,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(l,d)=>{var u=Kf(),f=y(u);Ae(f,()=>e.children),Ke(u,h=>a(h),()=>a()),ke(()=>Ge(u,1,Xe({a:!0,b:e.isMobile}),"p-6pddb9")),p(l,u)},$$slots:{default:!0}})},i=c=>{qf(c,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(l,d)=>{var u=Gf(),f=y(u);Ae(f,()=>e.children),Ke(u,h=>a(h),()=>a()),ke(()=>Ge(u,1,Xe({a:!0,b:e.isMobile}),"p-6pddb9")),p(l,u)},$$slots:{default:!0}})};H(o,c=>{e.isMobile?c(s):c(i,!1)})}p(t,r),he()}var Yf=k("<button><!></button>"),Xf=k("<a><!></a>");function Ie(t,e){let a=Ne(e,"dangerous",3,!1),r=Ne(e,"type",3,"button"),o=Ne(e,"href",3,"");var s=fe(),i=E(s);{var c=d=>{var u=Yf();u.__click=function(...h){e.onClick?.apply(this,h)},u.__keydown=function(...h){e.onKeydown?.apply(this,h)};var f=y(u);Ae(f,()=>e.children??Ue),ke(()=>Ge(u,1,Xe({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")),p(d,u)},l=d=>{var u=Xf();u.__click=function(...h){e.onClick?.apply(this,h)},u.__keydown=function(...h){e.onKeydown?.apply(this,h)};var f=y(u);Ae(f,()=>e.children??Ue),ke(()=>{tt(u,"href",o()),Ge(u,1,Xe({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")}),p(d,u)};H(i,d=>{r()==="button"?d(c):d(l,!1)})}p(t,s)}st(["click","keydown"]);var Jf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Add link',1),Zf=k('<li class="p-1ljon4s"><!></li>'),Qf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Edit link',1),$f=k('<li class="p-1ljon4s"><!></li>'),ev=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),tv=k('<li class="p-1ljon4s"><!></li>'),nv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),av=k('<li class="p-1ljon4s"><!></li>'),rv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),ov=k('<li class="p-1ljon4s"><!></li>'),sv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Make copy',1),iv=k('<li class="p-1ljon4s"><!></li>'),lv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),cv=k('<li class="p-1ljon4s"><!></li>'),dv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),uv=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),fv=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),vv=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),gv=k(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),hv=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),pv=k("<!> <!> <!> <!> <!> <!> <!>",1),mv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function ri(t,e){ge(e,!0);const a=kt(),r=Ot(),o=fr(),s=fa();let i=Ne(e,"mode",3,"notes"),c=Ne(e,"shownMenu",15),l=A(!1),d=A(!1),u=A(!1),f=A(!1),h=A(!1),m=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const g=async()=>{requestAnimationFrame(()=>{r.clear(),setTimeout(()=>{a.moveNoteToBin(e.noteId),Ye("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a.restoreNoteFromBin(e.noteId),r.push(`${me.Note}?id=${e.noteId}`)}}})},300)})},w=async()=>{a.moveNoteToArchive(e.noteId),Ye("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a.moveNoteFromArchive(e.noteId)}}})},_=async()=>{a.moveNoteFromArchive(e.noteId),Ye("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a.moveNoteToArchive(e.noteId)}}})},x=()=>{a.restoreNoteFromBin(e.noteId),Ye("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a.moveNoteToBin(e.noteId)}}})},K=()=>{n(d)?(v(d,!1),g()):n(h)?(v(h,!1),x()):n(u)?(v(u,!1),w()):n(f)&&(v(f,!1),_()),c(!1),v(l,!1)},C=()=>{let q="";e.link?.url&&(q+=e.link.url+`
`),e.text&&(q+=`
`+e.text+`
`),navigator.clipboard.writeText(q),Ye("Copied"),v(l,!0)},N=async()=>{v(l,!0),requestAnimationFrame(()=>{r.clear(),setTimeout(()=>{a.deleteNote(e.noteId)},100)})},O=()=>{if(navigator.share){const q={};let b="";e.link?.url&&(b+=e.link.url+`
`),e.text&&(b+=`
`+e.text+`
`),q.text=b,navigator.share(q).catch(re=>{re.name})}v(l,!0)},U=()=>{if(navigator.share){const q={};e.link?.url&&(q.url=e.link.url),e.link?.title&&(q.title=e.link.title),navigator.share(q).catch(b=>{b.name})}v(l,!0)},B=async()=>{v(l,!0);const q=e.noteId,b=await a.createNote({link:je(e.link),text:e.text||"",tags:e.tags?je(e.tags):[],pinned:!1});r.replace(`${me.Note}?id=${b}`),Ye("copy made",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{r.replace(`${me.Note}?id=${q}`),setTimeout(()=>{a.deleteNote(b)})}}})},X=()=>{v(l,!0),e.link?.url&&(r.clear(),o?.set(e.link?.url+"$"))};let Q=!1;var R=fe(),$=E(R);{var Z=q=>{var b=mv(),re=E(b);{let D=T(()=>`calc(100% - ${s.check()?"0px":"16px"})`),V=T(()=>s.check()?"auto":"10px"),ve=T(()=>s.check()?"10px":"auto");le(re,()=>({"--bottom":"auto","--top":n(D),"--left":n(V),"--right":n(ve)})),zr(re.lastChild,{get startClose(){return n(l)},onClosed:K,isMobile:Q,children:(W,ce)=>{var ie=pv(),te=E(ie);{var ee=pe=>{var oe=Zf(),S=y(oe);Ie(S,{onClick:j=>{e.onAddLinkClick(j),v(l,!0)},dialogMode:Q,children:(j,F)=>{var L=Jf(),M=E(L);le(M,()=>({"--size":"20px"})),de(M.lastChild,{name:"add"}),p(j,L)},$$slots:{default:!0}}),p(pe,oe)},z=pe=>{var oe=$f(),S=y(oe);Ie(S,{onClick:j=>{e.onEditLinkClick(j),v(l,!0)},dialogMode:Q,children:(j,F)=>{var L=Qf(),M=E(L);le(M,()=>({"--size":"20px","--scale":"0.9"})),de(M.lastChild,{name:"pen"}),p(j,L)},$$slots:{default:!0}}),p(pe,oe)};H(te,pe=>{e.link?.url?pe(z,!1):pe(ee)})}var G=P(te,2);{var Y=pe=>{var oe=tv(),S=y(oe);Ie(S,{onClick:C,dialogMode:Q,children:(j,F)=>{var L=ev(),M=E(L);le(M,()=>({"--size":"20px"})),de(M.lastChild,{name:"copy"}),p(j,L)},$$slots:{default:!0}}),p(pe,oe)};H(G,pe=>{e.text&&pe(Y)})}var ne=P(G,2);{var ue=pe=>{var oe=av(),S=y(oe);Ie(S,{onClick:U,dialogMode:Q,children:(j,F)=>{var L=nv(),M=E(L);{let ae=T(()=>e.text?"":"share");le(M,()=>({"--size":"20px"})),de(M.lastChild,{get name(){return n(ae)}})}p(j,L)},$$slots:{default:!0}}),p(pe,oe)};H(ne,pe=>{m&&e.link?.url&&pe(ue)})}var Ee=P(ne,2);{var He=pe=>{var oe=ov(),S=y(oe);Ie(S,{onClick:O,dialogMode:Q,children:(j,F)=>{var L=rv(),M=E(L);le(M,()=>({"--size":"20px"})),de(M.lastChild,{name:"share"}),p(j,L)},$$slots:{default:!0}}),p(pe,oe)};H(Ee,pe=>{m&&e.text&&pe(He)})}var nt=P(Ee,2);{var _e=pe=>{var oe=iv(),S=y(oe);Ie(S,{onClick:B,dialogMode:Q,children:(j,F)=>{var L=sv(),M=E(L);le(M,()=>({"--size":"20px","--scale":"0.8"})),de(M.lastChild,{name:"note"}),p(j,L)},$$slots:{default:!0}}),p(pe,oe)};H(nt,pe=>{e.formMode==="edit"&&(e.text||e.link?.url)&&pe(_e)})}var Fe=P(nt,2);{var J=pe=>{var oe=cv(),S=y(oe);Ie(S,{onClick:X,dialogMode:Q,children:(j,F)=>{var L=lv(),M=E(L);le(M,()=>({"--size":"20px"})),de(M.lastChild,{name:""}),p(j,L)},$$slots:{default:!0}}),p(pe,oe)};H(Fe,pe=>{e.link?.url&&a.checkDuplicatesExist(e.noteId)&&pe(J)})}var se=P(Fe,2);{var Pe=pe=>{var oe=fe(),S=E(oe);{var j=F=>{var L=fv(),M=E(L),ae=y(M);Ie(ae,{onClick:()=>{v(u,i()==="notes"),v(f,i()==="archive"),v(l,!0)},dialogMode:Q,children:(Te,ye)=>{var be=dv(),Be=E(be);{let At=T(()=>i()==="archive"?"archive-cancel":"archive");le(Be,()=>({"--size":"20px","--scale":"0.9"})),de(Be.lastChild,{get name(){return n(At)}})}var Oe=P(Be);ke(()=>at(Oe,` ${i()==="archive"?"Unarchive":"Archive"}`)),p(Te,be)},$$slots:{default:!0}});var Ce=P(M,2),Se=y(Ce);Ie(Se,{onClick:()=>{v(d,!0),v(l,!0)},dialogMode:Q,children:(Te,ye)=>{var be=uv(),Be=E(be),Oe=y(Be);le(Oe,()=>({"--size":"20px"})),de(Oe.lastChild,{name:"bin"}),p(Te,be)},$$slots:{default:!0}}),p(F,L)};H(S,F=>{(e.text||e.link?.url)&&F(j)})}p(pe,oe)},xe=pe=>{var oe=hv(),S=E(oe),j=y(S);Ie(j,{onClick:()=>{v(h,!0),v(l,!0)},dialogMode:Q,children:(M,ae)=>{var Ce=vv(),Se=E(Ce),Te=y(Se);le(Te,()=>({"--size":"20px"})),de(Te.lastChild,{name:"bin-cancel"}),p(M,Ce)},$$slots:{default:!0}});var F=P(S,2),L=y(F);Ie(L,{onClick:N,dialogMode:Q,dangerous:!0,children:(M,ae)=>{var Ce=gv(),Se=E(Ce),Te=y(Se);le(Te,()=>({"--size":"20px"})),de(Te.lastChild,{name:"bin"}),p(M,Ce)},$$slots:{default:!0}}),p(pe,oe)};H(se,pe=>{i()==="notes"||i()==="archive"?pe(Pe):pe(xe,!1)})}p(W,ie)},$$slots:{default:!0}})}p(q,b)};H($,q=>{c()&&q(Z)})}p(t,R),he()}var _v=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),wv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),yv=k("<!> <!> <!> <!>",1),bv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Sv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),kv=k("<!> <!> <!>",1),Cv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),xv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Tv=k('<div class="a p-5sjfv5"><div class="b p-5sjfv5"><!></div> <div class="c p-5sjfv5"><!> <!></div></div>');function Ev(t,e){ge(e,!0);const a=fa();Pt(),qn();let r=A(!1);const o=()=>!e.deletedAt&&!e.archivedAt?"notes":e.archivedAt?"archive":"bin";var s=Tv(),i=y(s),c=y(i);{var l=m=>{var g=yv(),w=E(g);{let C=T(()=>e.pinned?"unpin":"pin");Qt(w,{get title(){return n(C)},elem:"button",onclick:()=>{e.onPinnedChange(!e.pinned)},children:(N,O)=>{var U=_v(),B=E(U);{let X=T(()=>e.pinned?"pin-cancel":"pin");le(B,()=>({"--size":"20px"})),de(B.lastChild,{get name(){return n(X)}})}p(N,U)},$$slots:{default:!0}})}var _=P(w,2);Qt(_,{title:"menu",elem:"button",onclick:()=>{v(r,!0)},children:(C,N)=>{var O=wv(),U=E(O);le(U,()=>({"--size":"20px","--rotate":"90deg"})),de(U.lastChild,{name:"menu"}),p(C,O)},$$slots:{default:!0}});var x=P(_,2);{let C=T(o);ri(x,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(C)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(r)},set shownMenu(N){v(r,N,!0)}})}var K=P(x,2);H(K,C=>{}),p(m,g)},d=m=>{var g=kv(),w=E(g);Qt(w,{title:"menu",elem:"button",onclick:()=>{v(r,!0)},children:(K,C)=>{var N=bv(),O=E(N);le(O,()=>({"--size":"24px","--rotate":"90deg"})),de(O.lastChild,{name:"menu"}),p(K,N)},$$slots:{default:!0}});var _=P(w,2);{let K=T(o);ri(_,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(K)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(r)},set shownMenu(C){v(r,C,!0)}})}var x=P(_,2);{let K=T(()=>e.pinned?"unpin":"pin");Qt(x,{get title(){return n(K)},elem:"button",onclick:()=>{e.onPinnedChange(!e.pinned)},children:(C,N)=>{var O=Sv(),U=E(O);{let B=T(()=>e.pinned?"pin-cancel":"pin");le(U,()=>({"--size":"24px"})),de(U.lastChild,{get name(){return n(B)}})}p(C,O)},$$slots:{default:!0}})}p(m,g)};H(c,m=>{a.check()?m(l):m(d,!1)})}var u=P(i,2),f=y(u);{let m=T(()=>!e.canPrev);Qt(f,{title:"previous",elem:"button",get disabled(){return n(m)},onclick:g=>{g.preventDefault(),e.onPrev&&e.onPrev()},children:(g,w)=>{var _=Cv(),x=E(_);le(x,()=>({"--size":"20px"})),de(x.lastChild,{name:"prev"}),p(g,_)},$$slots:{default:!0}})}var h=P(f,2);{let m=T(()=>!e.canNext);Qt(h,{title:"next",elem:"button",get disabled(){return n(m)},onclick:g=>{g.preventDefault(),e.onNext&&e.onNext()},children:(g,w)=>{var _=xv(),x=E(_);le(x,()=>({"--size":"20px"})),de(x.lastChild,{name:"next"}),p(g,_)},$$slots:{default:!0}})}p(t,s),he()}var Nv=k('<div class="e p-lklx2e">Note</div>'),Pv=k("<span> </span>"),Av=k('<div class="i p-lklx2e"><!></div>'),Dv=k('<!> <!> <div class="a p-lklx2e"><div class="b"><div class="c"><div class="d p-lklx2e"><!> <div class="f p-lklx2e" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"></div></div></div></div> <div class="g h p-lklx2e"><!> <div class="j p-lklx2e"><!></div></div></div>',1);function Iv(t,e){ge(e,!0);const a=qn(),r=Ot();let o=A(null),s=A(!1),i=A(!1),c=A(et(new Set)),l=A(""),d=A(!1);const u=ie=>{const te=_f(ie.currentTarget.childNodes);e.onChangeText(te),v(l,te,!0)},f=ie=>{ie.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(s)&&(v(s,!1),ie.preventDefault(),ie.stopPropagation()),n(i)&&(v(i,!1),ie.preventDefault(),ie.stopPropagation()))};we(()=>(document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)));const h=(ie,te)=>{e.onChangeLink({url:ie,title:te})},m=()=>{e.onChangeLink(void 0)},g=a.getPrevTags(),w=()=>{e.onChangeTags([...new Set([...e.tags,...g])])};Le(()=>{n(o)&&n(l)!==e.text&&(n(o).textContent=e.text,v(l,e.text,!0))}),we(()=>{if(n(o)){if((Un||Wn)&&(e.mode==="edit"||navigator.userActivation.isActive===!1))return;n(o).focus();const ie=document.createRange();ie.selectNodeContents(n(o)),ie.collapse(!1);const te=window.getSelection();te?.removeAllRanges(),te?.addRange(ie)}});let _=A("unknown");we(()=>{(async()=>v(_,await kf(),!0))()});let x=T(()=>a.getLlmTagsEnabled()),K=null;const C=async()=>K||(K=await Sf(),K),N=async()=>{if(n(_)==="downloadable"||n(_)==="downloading"){r.push(me.Extension);return}v(d,!0);const ie=await C(),te=await xf({llmSession:ie,text:e.text,link:e.link,accessPageData:a.getPageDataForTagsEnabled(),rejectedTags:Array.from(n(c)),tags:e.tags});e.onChangeTags([...new Set([...e.tags,...te])]),v(d,!1)};we(()=>{const ie=te=>{if(!n(o)||document.activeElement!==n(o)||(te.preventDefault(),!te.clipboardData))return;const ee=te.clipboardData.getData("text/plain");e.onChangeText(ee);const z=window.getSelection();if(z&&z.rangeCount>0){const G=z.getRangeAt(0);G.deleteContents(),G.insertNode(document.createTextNode(ee)),G.collapse(!1),z.removeAllRanges(),z.addRange(G)}};return document.addEventListener("paste",ie),()=>{document.removeEventListener("paste",ie)}});var O=Dv(),U=E(O);Ev(U,{get noteId(){return e.noteId},get link(){return e.link},get pinned(){return e.pinned},get onPinnedChange(){return e.onPinnedChange},get text(){return e.text},get tags(){return e.tags},get deletedAt(){return e.deletedAt},get archivedAt(){return e.archivedAt},onAddLinkClick:()=>{v(i,!0)},onEditLinkClick:()=>{v(i,!0)},get canNext(){return e.canNext},get canPrev(){return e.canPrev},get onNext(){return e.onNext},get onPrev(){return e.onPrev},get formMode(){return e.mode}});var B=P(U,2);{var X=ie=>{{let te=T(()=>e.link?.url||""),ee=T(()=>e.link?.title||"");Bf(ie,{get url(){return n(te)},get title(){return n(ee)},onChangeUrl:h,onDeleteUrl:m,get shownUrlInput(){return n(i)},set shownUrlInput(z){v(i,z,!0)}})}};H(B,ie=>{(n(i)||e.link?.url)&&ie(X)})}var Q=P(B,2),R=y(Q),$=y(R),Z=y($),q=y(Z);{var b=ie=>{var te=Nv();p(ie,te)};H(q,ie=>{e.text||ie(b)})}var re=P(q,2);re.__input=u,Ke(re,ie=>v(o,ie),()=>n(o));var D=P(R,2),V=y(D);{var ve=ie=>{var te=Av(),ee=y(te);{var z=G=>{var Y=Pv(),ne=y(Y);ke(ue=>at(ne,`updated: ${ue??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),p(G,Y)};H(ee,G=>{e.updatedAt&&G(z)})}p(ie,te)};H(V,ie=>{e.mode==="edit"&&ie(ve)})}var W=P(V,2),ce=y(W);{let ie=T(()=>n(x)&&n(_)!=="unknown"&&n(_)!=="unavailable"),te=T(()=>e.mode==="add"&&g.length>0);Tl(ce,{get selectedTags(){return e.tags},onRejectedTag:ee=>{v(c,new Set([...n(c),ee]),!0)},get onChangeTags(){return e.onChangeTags},get genTagsEnabled(){return n(ie)},onGenTags:N,get generatingTags(){return n(d)},onUsePreviousTags:w,get previousTagsEnabled(){return n(te)},get shownTagInput(){return n(s)},set shownTagInput(ee){v(s,ee,!0)}})}p(t,O),he()}st(["input"]);function Mv(t,e){ge(e,!0);const a=kt(),r=qn(),o=Pt(),s=Ot();let i=A("loading"),c=A("idle"),l=A(""),d=A(!1),u=A(void 0),f=A(""),h=A(et([])),m=A(-1),g=A(et([])),w=A("unknown"),_=A(null);const x=()=>{n(g).push({link:pa(n(u)),text:n(f),tags:n(h).slice(),updatedAt:Date.now()}),v(m,0),(n(u)?.title||n(u)?.url||n(f)||n(h).length>0)&&v(_,{link:n(u),text:n(f),tags:n(h).slice()},!0),v(i,"finish")},K=async()=>{{const W=o.get(),ce=W.get("url"),ie=W.get("title"),te=W.get("text");ce&&v(u,{url:ce,title:ie||""},!0),te&&(!ce&&Zo(te)?v(u,{url:te,title:ie||new URL(te).hostname},!0):v(f,te,!0)),o.delete("url"),o.delete("title"),o.delete("text"),x();return}},C=T(()=>a.isInitedNotes()&&n(i)==="finish"),N=async W=>{v(c,"loading");try{n(l)?await a.updateNote(n(l),{link:W.link,text:W.text,tags:W.tags.slice()}):(v(l,await a.createNote({link:W.link,text:W.text,tags:W.tags.slice(),pinned:n(d)}),!0),s.replace(`${me.NewNote}?id=${n(l)}`))}finally{v(c,"idle")}},O=async()=>{v(c,"loading");try{await a.deleteNote(n(l)),v(l,""),s.replace(`${me.NewNote}`)}finally{v(c,"idle")}},U=W=>{v(d,W,!0),n(l)&&a.pinNote(n(l),W)};we(()=>{K()}),we(()=>()=>{n(h).length>0&&r.setPrevTags([...n(h)])});const B=()=>{v(_,{link:n(u),text:n(f),tags:n(h).slice()},!0)},X=W=>{v(u,W,!0),v(g,n(g).slice(0,n(m)+1),!0),v(w,"unknown"),n(g).push({link:je(n(u)),text:n(f),tags:je(n(h)),updatedAt:Date.now()}),v(m,n(g).length-1),B()},Q=W=>{v(h,W,!0),v(g,n(g).slice(0,n(m)+1),!0),v(w,"unknown"),n(g).push({link:je(n(u)),text:n(f),tags:je(n(h)),updatedAt:Date.now()}),v(m,n(g).length-1),B()},R=W=>{v(f,W,!0),v(g,n(g).slice(0,n(m)+1),!0),n(w)!=="text"?(n(g).push({link:je(n(u)),text:n(f),tags:je(n(h)),updatedAt:Date.now()}),v(m,n(g).length-1)):(n(g)[n(m)].text=n(f),n(g)[n(m)].updatedAt=Date.now()),v(w,"text"),B()};let $=T(()=>n(m)>0),Z=T(()=>n(m)<n(g).length-1);const q=()=>{if(n(m)<=0)return;v(m,n(m)-1);const W=n(g)[n(m)];v(u,je(W.link),!0),v(f,W.text,!0),v(h,je(W.tags),!0),v(w,"unknown"),B()},b=()=>{if(n(m)>=n(g).length-1)return;v(m,n(m)+1);const W=n(g)[n(m)];v(u,je(W.link),!0),v(f,W.text,!0),v(h,je(W.tags),!0),v(w,"unknown"),B()};let re=T(()=>a.getGetNotesMap());Le(()=>{if(!n(C)||n(c)==="loading"||!n(l))return;const W=n(re)().get(n(l));ht(()=>{W?.data&&(W.data.pinned!==n(d)&&v(d,!!W.data.pinned),W.data.text!==n(f)&&R(W.data.text),(W.data.link?.url!==n(u)?.url||W.data.link?.title!==n(u)?.title)&&X(je(W.data.link)),JSON.stringify(W.data.tags)!==JSON.stringify(n(h))&&Q(je(W.data.tags)))})}),Le(()=>{n(c)!=="loading"&&n(_)&&ht(()=>{n(_)&&(n(l)&&!n(_)?.link?.title&&!n(_)?.link?.url&&!n(_)?.text&&n(_)?.tags.length===0?O():N(n(_)),v(_,null))})});var D=fe(),V=E(D);{var ve=W=>{{let ce=T(()=>a.getNoteById(n(l))?.data.deletedAt),ie=T(()=>a.getNoteById(n(l))?.data.archivedAt);Iv(W,{get deletedAt(){return n(ce)},get archivedAt(){return n(ie)},get noteId(){return n(l)},get canNext(){return n(Z)},get canPrev(){return n($)},onPrev:q,onNext:b,mode:"add",get link(){return n(u)},onChangeLink:X,get text(){return n(f)},onChangeText:R,get tags(){return n(h)},onChangeTags:Q,get pinned(){return n(d)},onPinnedChange:U})}};H(V,W=>{n(C)&&W(ve)})}p(t,D),he()}var Lv=k('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function Rv(t,e){ge(e,!1);const a=Pt(),r=i=>{i.preventDefault(),a.replace("")};ws();var o=Lv(),s=P(y(o),2);{let i=Lr(()=>a.getHref(""));Tt(s,{element:"a",get href(){return n(i)},onClick:r,children:(c,l)=>{var d=Me("close");p(c,d)},$$slots:{default:!0}})}p(t,o),he()}const Al={};function Fv(t){ot(Al,t)}function Cs(){const t=rt(Al);if(!t)throw new Error("No DialogPageHeightContext found");return t}const Ov=()=>{let t=A(200);return{set:r=>{v(t,r,!0)},get:()=>n(t)}};function zv(t,e){ge(e,!0),Fv(Ov());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const Bv=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};we(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),we(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var jv=k('<button class="c d p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Hv=k('<div class="e p-phkj9l"> </div>'),Uv=k('<button class="c f p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Wv=k('<dialog><div><div class="a p-phkj9l"><div class="b p-phkj9l"><div><!></div> <!> <div><!></div></div></div> <div class="g p-phkj9l"><!></div></div> <!></dialog> <!>',1);function Vv(t,e){ge(e,!0);let a=Ne(e,"blockedDialog",3,!1),r=Ne(e,"hiddenDialog",3,!1),o=Ne(e,"isDesktopAnimationOff",3,!1),s=A(null),i=A(null),c=A(!1),l=A(null);Bv({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const d=Cn();let u=T(()=>d.get());Le(()=>{e.stateDialog==="closing"&&(n(u).working?n(i)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const f=Cs(),h=T(()=>f.get());we(()=>{setTimeout(()=>{v(c,!0),d.set({working:!0})},100)});var m=Wv(),g=E(m),w=y(g),_=y(w),x=y(_),K=y(x),C=y(K);{var N=b=>{var re=jv();re.__click=()=>{e.onStartBack()};var D=y(re);le(D,()=>({"--size":"24px"})),de(D.lastChild,{name:"back"});var V=P(D,2);ct(V,{children:(ve,W)=>{var ce=Me("back");p(ve,ce)}}),p(b,re)};H(C,b=>{(!(a()||r())||a())&&e.onStartBack&&b(N)})}var O=P(K,2);{var U=b=>{var re=Hv(),D=y(re);ke(()=>at(D,e.title)),p(b,re)};H(O,b=>{e.title&&b(U)})}var B=P(O,2),X=y(B);{var Q=b=>{var re=Uv();re.__click=()=>{e.onStartClose()};var D=y(re);le(D,()=>({"--size":"24px"})),de(D.lastChild,{name:"close"});var V=P(D,2);ct(V,{children:(ve,W)=>{var ce=Me("close");p(ve,ce)}}),p(b,re)};H(X,b=>{a()||r()||b(Q)})}var R=P(_,2),$=y(R);Ae($,()=>e.children),Ke(w,b=>v(i,b),()=>n(i));var Z=P(w,2);Co(Z,{get ref(){return n(l)},set ref(b){v(l,b,!0)}}),Ke(g,b=>v(s,b),()=>n(s));var q=P(g,2);ks(q,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose},get notificationRef(){return n(l)},set notificationRef(b){v(l,b,!0)}}),ke(()=>{Ge(g,1,Xe({h:!0,i:e.stateDialog==="open",j:n(c),k:n(u).working,l:o(),m:r()}),"p-phkj9l"),or(w,`height: ${n(h)+74}px`),Ge(w,1,Xe({n:!0,i:e.stateDialog==="open",j:n(c),k:n(u).working,l:o()}),"p-phkj9l")}),p(t,m),he()}st(["click"]);const qv=({onStartClose:t,onClosed:e})=>{let a=A("close");return{get state(){return n(a)},set state(i){v(a,i,!0)},handleStartClose:(i=!1)=>{i||(v(a,"closing"),t?.())},handleOpen:()=>{v(a,"open")},handleClose:()=>{v(a,"close"),e?.()}}};function Kv(t,e){ge(e,!0);let a=Ne(e,"blockedDialog",3,!1),r=Ne(e,"hiddenDialog",3,!1),o=Ne(e,"onStartClose",3,()=>{}),s=Ne(e,"onClosed",3,()=>{}),i=qv({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:c,dialogInc:l}=Vt();we(()=>(l(),()=>{c()})),Le(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const d=m=>{m.key==="Escape"&&a()&&(m.preventDefault(),m.stopPropagation())};we(()=>(document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}));var u=fe(),f=E(u);{var h=m=>{Vv(m,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(g,w)=>{var _=fe(),x=E(_);Ae(x,()=>e.children),p(g,_)},$$slots:{default:!0}})};H(f,m=>{i.state!=="close"&&m(h)})}p(t,u),he()}const Dl={};function Gv(t){ot(Dl,t)}function xs(){const t=rt(Dl);if(!t)throw new Error("No ScrollingContext found");return t}const Yv=()=>{let t=A(!1);const e=()=>n(t),a=pl(()=>{v(t,!1)},100);return{isScrolling:e,enable:()=>{v(t,!0),a()}}};function Xv(t,e){ge(e,!0),Gv(Yv());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const Hn=200,Jv=t=>t<.5?2*t*t:-1+(4-2*t)*t,Il=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,Jv(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},Ml={};function Zv(t){ot(Ml,t)}function Qv(){const t=rt(Ml);if(!t)throw new Error("No KeyboardContext found");return t}const $v=()=>{const t=et({value:!1}),e=()=>t.value,a=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";return we(()=>{const r=()=>{setTimeout(()=>{a()?t.value=!0:t.value=!1},0)};return r(),document.addEventListener("focusin",r),document.addEventListener("focusout",r),()=>{document.removeEventListener("focusin",r),document.removeEventListener("focusout",r)}}),{isVisible:e}};function eg(t,e){ge(e,!0),Zv($v());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}const tg=t=>{const a=Qv();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},c=f=>({x:f.clientX,y:f.clientY,time:performance.now()}),l=f=>{r=[c(f.touches[0])],o=!0},d=f=>{if(!o||s)return;r.push(c(f.touches[0]));const h=performance.now()-150;r=r.filter(B=>B.time>=h);const m=r.at(-1),g=r[0];if(!m||!g)return;const w=g.x,_=g.y,x=m.x,K=m.y,C=x-w,N=K-_,O=Math.abs(C)>Math.abs(N),U=Math.abs(C)>3;O&&U&&!a.isVisible()&&(s=!0,f.preventDefault(),t([...r]),i())},u=()=>{i()};we(()=>(document.addEventListener("touchstart",l,{passive:!0}),document.addEventListener("touchmove",d,{passive:!1}),document.addEventListener("touchend",u,{passive:!0}),document.addEventListener("touchcancel",u,{passive:!0}),()=>{document.removeEventListener("touchstart",l),document.removeEventListener("touchmove",d),document.removeEventListener("touchend",u),document.removeEventListener("touchcancel",u)}))},oi=5,si=.6,ia=.3;function Ll(t,e){ge(e,!0);let a=[],r=0,o=!1,s=0,i=0,c=0,l=0,d=0,u=null,f=null;const h=()=>{a=[],r=0,o=!1,s=0,i=0,c=0,l=0,d=0,u!==null&&(cancelAnimationFrame(u),u=null),f&&(clearTimeout(f),f=null)},m=()=>{e.onCancel(),h()},g=()=>{f&&clearTimeout(f),f=setTimeout(m,5e3)};tg(async U=>{if(!o)try{const B=U.at(-1);if(!B)throw new Error("No points available for swipe initialization");const X=await e.onInit();if(!X)return;s=X.initialPosition,i=X.currentPosition,c=X.minPosition,l=X.maxPosition,d=X.width,r=B.x,a=U,o=!0,g()}catch{h()}});const _=U=>Math.max(c,Math.min(l,U)),x=()=>{if(u=null,!o){h();return}const U=a.at(-1),B=a[0];if(!U||!B)return;let X=U.x-r;r=U.x;const Q=_(i+X);Q!==i&&(i=Q,e.onUpdate({initialPosition:s,newPosition:Q,width:d,minPosition:c,maxPosition:l}))},K=U=>{if(!o){h();return}a.push({x:U.touches[0].clientX,y:U.touches[0].clientY,time:performance.now()});const B=performance.now()-150;a=a.filter($=>$.time>=B),u===null&&(u=requestAnimationFrame(x)),g();const X=U.touches[0].clientX-a[0].x,Q=U.touches[0].clientY-a[0].y;Math.abs(X)>Math.abs(Q)&&U.cancelable&&U.preventDefault()},C=U=>{const B=Math.abs(U);if(B>=si)return oi;if(B>=ia){const X=(B-ia)/(si-ia);return e.baseActionThreshold-X*(e.baseActionThreshold-oi)}else return e.baseActionThreshold},N=U=>{if(!o){h();return}let B=0;a.push({x:U.changedTouches[0].clientX,y:U.changedTouches[0].clientY,time:performance.now()}),x(),u!==null&&(cancelAnimationFrame(u),u=null);const X=a[0],Q=a[a.length-1],R=Q.x-X.x,$=Q.time-X.time;$>0&&(B=R/$);const Z=C(B);e.onFinish({swipeVelocity:B,currentPosition:i,minPosition:c,maxPosition:l,initialPosition:s,width:d,actionThreshold:Z}),h()},O=()=>{m()};we(()=>(document.addEventListener("touchmove",K,{passive:!1}),document.addEventListener("touchend",N,{passive:!0}),document.addEventListener("touchcancel",O,{passive:!0}),()=>{document.removeEventListener("touchmove",K),document.removeEventListener("touchend",N),document.removeEventListener("touchcancel",O),u!==null&&cancelAnimationFrame(u),f&&clearTimeout(f)})),he()}function ng(t,e){ge(e,!0);const a=Cn();let r=Ne(e,"animationRef",7),o=Ne(e,"dialog",7);Ll(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let d=0,u=0,f=()=>1;if(r().current){r().current.pause();let m=Number(r().current.currentTime);Tr()&&(m=Number(m)+50,r().current.currentTime=Math.min(Math.max(Hn-1,m),m));const g=r().current.effect?.getComputedTiming().progress||0;f=()=>g,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(m=>requestAnimationFrame(m)),u=1-f();const h=u*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-u)*.1}`),a.set({swipingRatio:Math.abs(1-u)*25,isSwiping:!0,duration:0}),o().style.transform=`translate3d(${h}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:d,currentPosition:h,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:d,width:u})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-d/u)*.1}`),o().style.transform=`translate3d(${d}px, 0, 0)`,a.set({swipingRatio:Math.abs(1-d/u)*25}))},onFinish:({swipeVelocity:d,currentPosition:u,width:f,actionThreshold:h,initialPosition:m})=>{if(a.set({isSwiping:!1}),!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const g=()=>Math.abs(m+u)/f*100;let w=null;if(d<=-ia?w="open":d>=ia?w="close":w=Math.abs(g())>h?"close":"open",r().progress=Il(g()/100),w==="close"){const _=(1-(r().progress||0))*Hn/1e3;a.set({duration:_}),o().style.setProperty("--transition-timing-dialog",`${_}s`),a.set({swipingRatio:0}),e.onClose()}else{const _=(r().progress||1)*Hn/1e3;a.set({duration:_}),o().style.setProperty("--transition-timing-dialog",`${_}s`),a.set({swipingRatio:25}),e.onOpen()}}}),he()}var ag=k('<div class="d p-8xr118"> </div>'),rg=k('<button class="e f p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),og=k('<a class="e g p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),sg=k('<div><div class="a p-8xr118"><div class="b p-8xr118"><div class="c p-8xr118"><!> <!> <!></div></div></div> <!> <!></div>'),ig=k("<dialog><!></dialog> <!>",1);function lg(t,e){ge(e,!0);const{isScrolling:a,enable:r}=xs();let o=A(null),s=A(null),i={};const c=Cn(),{checkLeftEnd:l,checkLeftStart:d,setLeftEnd:u,setLeftStart:f,getCountDialog:h}=Vt(),m=T(d),g=T(l);let w=T(()=>c.get().working);const _=()=>{e.dialogState!=="opened"&&e.onStartOpening()},x=()=>{requestAnimationFrame(()=>{e.onClose()})},K=()=>{e.onSwipe()},C=Z=>{Z.preventDefault(),x()};we(()=>(n(o)?.addEventListener("close",x),n(o)?.addEventListener("cancel",C),()=>{n(o)?.removeEventListener("close",x),n(o)?.removeEventListener("cancel",C)})),Le(()=>{h()>0&&ht(()=>{c.set({swipingRatio:25})})}),Le(()=>{e.dialogState==="opening"?ht(()=>{requestAnimationFrame(()=>{if(!n(o))return;const Z=(i.progress||1)*Hn,q=n(o).style.transform||`translate3d(${n(m)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const b=n(o)?.animate([{transform:q},{transform:"translate3d(0, 0, 0)"}],{duration:Z,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=b,b&&(b.onfinish=()=>{e.onOpened(),c.set({swipingRatio:25}),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),c.set({duration:Na().duration}),b.cancel(),i.current=void 0,i.progress=void 0,n(m)&&f(!1)})})}):e.dialogState==="closing"&&ht(async()=>{c.get().working||(c.set({working:!0}),await new Promise(Z=>requestAnimationFrame(Z))),requestAnimationFrame(()=>{if(!n(o))return;c.set({swipingRatio:0});const Z=(1-(i.progress||0))*Hn,q=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const b=n(o)?.animate([{transform:q},{transform:`translate3d(${n(g)?"-100%":"100%"}, 0, 0)`}],{duration:Z,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=b,b&&(b.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),c.set({duration:Na().duration}),b.cancel(),i.current=void 0,i.progress=void 0,n(g)&&u(!1)})})})});const N=()=>{r()},O=T(a);we(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),Tr()&&n(o).getBoundingClientRect(),!n(w)){e.onOpened();return}e.onStartOpening()}});var U=ig(),B=E(U),X=y(B);{var Q=Z=>{var q=sg(),b=y(q),re=y(b),D=y(re),V=y(D);{var ve=Y=>{var ne=ag(),ue=y(ne);ke(()=>at(ue,e.title)),p(Y,ne)};H(V,Y=>{e.title&&Y(ve)})}var W=P(V,2);{var ce=Y=>{var ne=rg();ne.__click=x;var ue=y(ne);le(ue,()=>({"--size":"28px"})),de(ue.lastChild,{name:"back"});var Ee=P(ue,2);ct(Ee,{children:(He,nt)=>{var _e=Me("back");p(He,_e)}}),p(Y,ne)};H(W,Y=>{e.blocked||Y(ce)})}var ie=P(W,2);{var te=Y=>{var ne=og();ne.__click=function(...He){e.onOpenWindow?.apply(this,He)};var ue=y(ne);le(ue,()=>({"--scale":"0.7","--size":"28px"})),de(ue.lastChild,{name:"open-window"});var Ee=P(ue,2);ct(Ee,{children:(He,nt)=>{var _e=Me("open window");p(He,_e)}}),ke(()=>tt(ne,"href",e.openWindowHref)),p(Y,ne)};H(ie,Y=>{e.onOpenWindow&&Y(te)})}var ee=P(b,2);Ae(ee,()=>e.children);var z=P(ee,2);{var G=Y=>{Co(Y,{})};H(z,Y=>{e.dialogState==="opened"&&Y(G)})}Ke(q,Y=>v(s,Y),()=>n(s)),ke(()=>Ge(q,1,Xe({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-8xr118")),Wt("scroll",q,N),p(Z,q)};H(X,Z=>{e.dialogState!=="preOpening"&&Z(Q)})}Ke(B,Z=>v(o,Z),()=>n(o));var R=P(B,2);{var $=Z=>{ng(Z,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:_,onClose:x,onSwipe:K,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};H(R,Z=>{n(s)&&!n(O)&&!e.blocked&&!e.hidden&&Z($)})}ke(()=>Ge(B,1,Xe({h:!0,i:n(w),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(m),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-8xr118")),p(t,U),he()}st(["click"]);function cg(t,e){ge(e,!0);let a=Ne(e,"hidden",3,!1),r=Ne(e,"onClosed",3,()=>{}),o=A(0);we(()=>{const x=()=>{v(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",x),x(),()=>{window.removeEventListener("resize",x)}});const{dialogDec:s,dialogInc:i}=Vt(),c=Cn();we(()=>(i(),()=>{s()}));let l=A("closed");const d=()=>{v(l,"opening")},u=()=>{v(l,"swiping")},f=()=>{v(l,"opened")},h=()=>{e.onClose(),v(l,"closing")},m=()=>{v(l,"closed"),r()()};Le(()=>{e.shown&&n(l)==="closed"?v(l,"preOpening"):!e.shown&&n(l)==="opened"&&v(l,"closing")}),Le(()=>{n(l)==="closed"?ht(()=>{c.set({swipingRatio:0,duration:Na().duration})}):(n(l)==="opened"||n(l)==="opening")&&ht(()=>{c.set({swipingRatio:25,duration:Na().duration})})});var g=fe(),w=E(g);{var _=x=>{lg(x,{get dialogWidth(){return n(o)},get dialogState(){return n(l)},get title(){return e.title},onStartOpening:d,onOpened:f,onClose:h,onClosed:m,onSwipe:u,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(K,C)=>{var N=fe(),O=E(N);Ae(O,()=>e.children),p(K,N)},$$slots:{default:!0}})};H(w,x=>{n(l)!=="closed"&&x(_)})}p(t,g),he()}const Rl={};function dg(t){ot(Rl,t)}function Br(){const t=rt(Rl);if(!t)throw new Error("No SidebarContext found");return t}var ug=k('<div class="a p-11shdp8"><!></div>');function gt(t,e){ge(e,!0);const a=Cs();let r=A(null);we(()=>{n(r);const i=new ResizeObserver(c=>{for(let l of c){const d=l.contentRect.height;a.set(d)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=ug(),s=y(o);Ae(s,()=>e.children),Ke(o,i=>v(r,i),()=>n(r)),p(t,o),he()}const fg="modulepreload",vg=function(t){return"/"+t},ii={},pt=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let l=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");o=l(a.map(d=>{if(d=vg(d),d in ii)return;ii[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":fg,u||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((m,g)=>{h.addEventListener("load",m),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return o.then(i=>{for(const c of i||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};var gg=k('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function hg(t){var e=gg(),a=P(y(e),2);Tt(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=Me("Reload");p(r,s)},$$slots:{default:!0}}),p(t,e)}var pg=k('<div class="p-uzefkz"><!></div>');function mg(t,e){ge(e,!0);let a=A(!1);const r=Cs(),o=T(()=>r.get());we(()=>{const l=setTimeout(()=>{v(a,!0)},250);return()=>{clearTimeout(l)}});var s=pg(),i=y(s);{var c=l=>{Da(l,{})};H(i,l=>{n(a)&&l(c)})}ke(()=>or(s,`min-height: ${n(o)??""}px;`)),p(t,s),he()}function Ct(t,e){ge(e,!0);const a={},r=Object.assign({"../../pages/about/page.svelte":()=>pt(()=>import("./aDgnYCfnY.js"),__vite__mapDeps([0,1])),"../../pages/access-keys/page.svelte":()=>pt(()=>import("./ays5xQXqF.js"),__vite__mapDeps([2,3,4,5])),"../../pages/account/page.svelte":()=>pt(()=>import("./aCYJjaWal.js"),__vite__mapDeps([6,3,7])),"../../pages/add-notes/page.svelte":()=>pt(()=>import("./aDjsWEsBj.js"),[]),"../../pages/auth/page.svelte":()=>pt(()=>import("./aCX5WfDvF.js"),__vite__mapDeps([8,9])),"../../pages/confirm-access-key/page.svelte":()=>pt(()=>import("./aB8F5tlht.js"),__vite__mapDeps([10,3,4,11])),"../../pages/exit/page.svelte":()=>pt(()=>import("./aDXxo9PBJ.js"),__vite__mapDeps([12,13])),"../../pages/export-data/page.svelte":()=>pt(()=>import("./aDAnbn2kO.js"),__vite__mapDeps([14,15,16,17,18,19])),"../../pages/extension/page.svelte":()=>pt(()=>import("./aCdZ96SLM.js"),__vite__mapDeps([20,15,16,21])),"../../pages/import-data/page.svelte":()=>pt(()=>import("./agAN_g5qO.js"),__vite__mapDeps([22,17,18,23])),"../../pages/install-success/page.svelte":()=>pt(()=>import("./aEr-7mI7t.js"),__vite__mapDeps([24,25])),"../../pages/install/page.svelte":()=>pt(()=>import("./aC3V1N5Nb.js"),__vite__mapDeps([26,27])),"../../pages/note/page.svelte":()=>pt(()=>import("./aBattIXcC.js"),__vite__mapDeps([28,29])),"../../pages/settings/page.svelte":()=>pt(()=>import("./aBpLx_8XO.js"),__vite__mapDeps([30,15,16,17,18,31])),"../../pages/signin/page.svelte":()=>pt(()=>import("./aCsyAmorL.js"),__vite__mapDeps([32,3,4,33])),"../../pages/signup/page.svelte":()=>pt(()=>import("./aBz-97OBh.js"),__vite__mapDeps([34,3,4,33])),"../../pages/subscription/page.svelte":()=>pt(()=>import("./atfCB4r7e.js"),__vite__mapDeps([35,36])),"../../pages/sync/page.svelte":()=>pt(()=>import("./aBYo95QHi.js"),__vite__mapDeps([37,38]))}),o=async c=>{const l=`../../pages/${c}/page.svelte`;if(!a[c]){if(r[l]){const d=r[l]();return a[c]={promise:d},a[c].module=await d,a[c].module}throw new Error(`Page ${c} not found`)}return a[c].module||await a[c].promise};var s=fe(),i=E(s);Fd(i,()=>o(e.page),c=>{mg(c,{})},(c,l)=>{const d=T(()=>n(l).default);var u=fe(),f=E(u);jd(f,()=>n(d),(h,m)=>{m(h,{get params(){return e.params},get hidden(){return e.hidden}})}),p(c,u)},c=>{hg(c)}),p(t,s),he()}const Fl={};function _g(t){ot(Fl,t)}function Ol(){const t=rt(Fl);if(!t)throw new Error("No FeedOrderStoreContext found");return t}const wg=()=>{const t=Pt(),e="feed-order",a=T(()=>t.get().get(e)||"newest"),r=T(()=>n(a)),o=["newest","oldest","AtoZ","ZtoA","updatedNewest"];return{get:()=>n(r),set:c=>{c==="newest"||!o.includes(c)?t.delete(e):t.set(e,c)}}};function yg(t,e){ge(e,!0);const a=wg();_g(a);var r=fe(),o=E(r);Ae(o,()=>e.children??Ue),p(t,r),he()}const zl={};function bg(t){ot(zl,t)}function vr(){const t=rt(zl);if(!t)throw new Error("No FeedContext found");return t}const Sg=()=>{const{getGetNotes:t}=kt(),e=Kn(),a=ko(),r=fr(),o=T(()=>e.get()),s=T(()=>a.getAll()),i=T(()=>r.get());let c=A(0),l=[],d=A(0);const u=T(()=>n(s).has(Ze.ARCHIVED)),f=T(()=>n(s).has(Ze.BIN));return Le(()=>{const w=t()()||[],_=[],x=Array.from(n(o).values());for(let K=w.length-1;K>=0;K--){if(!w[K]||!w[K].data)continue;const C=w[K];if(!n(u)&&!n(f)&&(C?.data.deletedAt||C?.data.archivedAt)||n(u)&&(C?.data.deletedAt||!C?.data.archivedAt)||n(f)&&!C?.data.deletedAt)continue;const N=n(i).toLowerCase()||"";if(n(i)){if(N.endsWith("$")){const O=N.slice(0,-1);if(!(C.data.link?.title.toLowerCase()===O||C.data.link?.url.toLowerCase()===O||C.data.text.toLowerCase()===O||C.data.tags.map(U=>U.toLowerCase()).includes(O)))continue}else if(!(C.data.link?.title.toLowerCase().includes(N)||C.data.link?.url.toLowerCase().includes(N)||C.data.text.toLowerCase().includes(N)||C.data.tags.map(O=>O.toLowerCase()).join(" ").includes(N)))continue}if(n(s).has(Ze.INBOX)){if(C.data.tags.length>0)continue}else if(n(o).size&&x.some(O=>!C.data.tags.includes(O)))continue;_.push(C)}v(c,_.length,!0),l=_,v(d,Date.now(),!0)}),{getFiltredNotesLength:()=>n(c),getFiltredNotes:()=>(n(d),l),getUpdatedFiltredNotesTimestamp:()=>n(d)}};function kg(t,e){ge(e,!0);const{getFiltredNotesLength:a,getFiltredNotes:r,getUpdatedFiltredNotesTimestamp:o}=Sg();bg({getFiltredNotesLength:a,getFiltredNotes:r,getUpdatedFiltredNotesTimestamp:o});var s=fe(),i=E(s);Ae(i,()=>e.children??Ue),p(t,s),he()}const Bl={};function Cg(t){ot(Bl,t)}function va(){const t=rt(Bl);if(!t)throw new Error("No NotesSelectionStoreContext found");return t}var xg=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Tg=["difference","intersection","symmetricDifference","union"],li=!1,er,an,ea,go,sr,jl,Hl;const ho=class ho extends Set{constructor(a){super();De(this,sr);De(this,er,new Map);De(this,an,A(0));De(this,ea,A(0));De(this,go,zn||-1);if(a){for(var r of a)super.add(r);I(this,ea).v=super.size}li||ut(this,sr,Hl).call(this)}has(a){var r=super.has(a),o=I(this,er),s=o.get(a);if(s===void 0){if(!r)return n(I(this,an)),!1;s=ut(this,sr,jl).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),v(I(this,ea),super.size),sa(I(this,an))),this}delete(a){var r=super.delete(a),o=I(this,er),s=o.get(a);return s!==void 0&&(o.delete(a),v(s,!1)),r&&(v(I(this,ea),super.size),sa(I(this,an))),r}clear(){if(super.size!==0){super.clear();var a=I(this,er);for(var r of a.values())v(r,!1);a.clear(),v(I(this,ea),0),sa(I(this,an))}}keys(){return this.values()}values(){return n(I(this,an)),super.values()}entries(){return n(I(this,an)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(I(this,ea))}};er=new WeakMap,an=new WeakMap,ea=new WeakMap,go=new WeakMap,sr=new WeakSet,jl=function(a){return zn===I(this,go)?A(a):yn(a)},Hl=function(){li=!0;var a=ho.prototype,r=Set.prototype;for(const o of xg)a[o]=function(...s){return n(I(this,an)),r[o].apply(this,s)};for(const o of Tg)a[o]=function(...s){n(I(this,an));var i=r[o].apply(this,s);return new ho(i)}};let $o=ho;const Eg=()=>{const t=new $o;let e=A(!1);const a=()=>t,r=c=>{t.clear(),c.forEach(l=>t.add(l))},o=c=>{t.add(c)},s=c=>{t.delete(c)},i=()=>{t.clear()};return{get:a,set:r,add:o,remove:s,clear:i,isEnabled:()=>n(e),enable:()=>v(e,!0),disable:()=>{v(e,!1),i()}}};function Ng(t,e){ge(e,!0),Cg(Eg());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}let es=A(!1),Zr=A(!1),ts=A(""),ns=A("Cancel"),as=A("Confirm"),rs,no=A(void 0),os,ss=A("dangerous");function Ka(t){v(es,!0),v(ts,t.title,!0),t.buttonCancelTitle&&v(ns,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&v(as,t.buttonConfirmTitle,!0),rs=t.onConfirm,v(no,t.onCancel,!0),os=t.onClosed,t.type?v(ss,t.type,!0):v(ss,"dangerous")}var Pg=k('<span class="b p-1jg69ok"> </span> <div class="c p-1jg69ok"><!> <!></div>',1),Ag=k('<div class="a p-1jg69ok"><!></div>');function Dg(t,e){ge(e,!0);let a=A(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{v(a,!0)},250)};we(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(no)?.(),v(Zr,!0)},c=async()=>{s(),await rs?.(),v(Zr,!0),o=!0},l=()=>{clearTimeout(r),v(a,!1),v(es,!1),v(Zr,!1),v(ts,""),v(ns,"Cancel"),v(as,"Confirm"),v(no,void 0),rs=void 0,os&&os(o),o=!1};var d=fe(),u=E(d);{var f=h=>{Or(h,{get blocked(){return n(a)},get startClose(){return n(Zr)},onClosed:l,children:(m,g)=>{var w=Ag(),_=y(w);{var x=C=>{Da(C,{})},K=C=>{var N=Pg(),O=E(N),U=y(O),B=P(O,2),X=y(B);{var Q=$=>{Tt($,{size:"small",onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Z,q)=>{var b=Me();ke(()=>at(b,n(ns))),p(Z,b)},$$slots:{default:!0}})};H(X,$=>{n(no)&&$(Q)})}var R=P(X,2);Tt(R,{size:"small",onClick:c,fullWidth:!0,withoutMinWidth:!0,get type(){return n(ss)},children:($,Z)=>{var q=Me();ke(()=>at(q,n(as))),p($,q)},$$slots:{default:!0}}),ke(()=>at(U,n(ts))),p(C,N)};H(_,C=>{n(a)?C(x):C(K,!1)})}p(m,w)},$$slots:{default:!0}})};H(u,h=>{n(es)&&h(f)})}p(t,d),he()}var Ig=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Mg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),Lg=k('<li class="p-1ljon4s"><!></li>'),Rg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),Fg=k('<li class="p-1ljon4s"><!></li>'),Og=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),zg=k('<li class="p-1ljon4s"><!></li>'),Bg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),jg=k('<li class="p-1ljon4s"><!></li>'),Hg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),Ug=k('<li class="p-1ljon4s"><!></li>'),Wg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),Vg=k('<li class="p-1ljon4s"><!></li>'),qg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Kg=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),Gg=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Yg=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),Xg=k(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Jg=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Zg=k('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!> <!>',1),Qg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function $g(t,e){ge(e,!0);const a=fa(),r=Ot();let o=Ne(e,"mode",3,"notes"),s=Ne(e,"shownMenu",15);const i=kt(),c=va();let l=A(!1),d=A(!1),u=A(!1),f=A(!1),h=A(!1),m=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const g=async()=>{i.moveNoteToBin(e.noteId),Ye("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i.restoreNoteFromBin(e.noteId)}}})},w=async()=>{i.moveNoteToArchive(e.noteId),Ye("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i.moveNoteFromArchive(e.noteId)}}})},_=async()=>{i.moveNoteFromArchive(e.noteId),Ye("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i.moveNoteToArchive(e.noteId)}}})},x=()=>{i.restoreNoteFromBin(e.noteId),Ye("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i.moveNoteToBin(e.noteId)}}})},K=()=>{e.noteData.pinned?(i.pinNote(e.noteId,!1),Ye("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i.pinNote(e.noteId,!0)}}})):(i.pinNote(e.noteId,!0),Ye("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i.pinNote(e.noteId,!1)}}})),v(l,!0)},C=()=>{n(d)?(v(d,!1),g()):n(h)?(v(h,!1),x()):n(u)?(v(u,!1),w()):n(f)&&(v(f,!1),_()),s(!1),v(l,!1)},N=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),Ye("Copied link"),v(l,!0))},O=()=>{let D="";e.noteData.link?.url&&(D+=e.noteData.link.url+`
`),e.noteData.text&&(D+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(D),Ye("Copied"),v(l,!0)},U=()=>{v(l,!0),Ka({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await i.deleteNote(e.noteId)},onCancel:async()=>{}})},B=()=>{if(navigator.share){const D={};let V="";e.noteData.link?.url&&(V+=e.noteData.link.url+`
`),e.noteData.text&&(V+=`
`+e.noteData.text+`
`),D.text=V,navigator.share(D).catch(ve=>{ve.name})}v(l,!0)},X=()=>{if(navigator.share){const D={};e.noteData.link?.url&&(D.url=e.noteData.link.url),e.noteData.link?.title&&(D.title=e.noteData.link.title),navigator.share(D).catch(V=>{V.name})}v(l,!0)},Q=()=>{v(l,!0),e.noteData.link?.url&&(r.clear(),e.onFindDuplicates(e.noteData.link?.url))};let R=Un||Wn,$=T(()=>a.check()),Z=T(()=>c.isEnabled()&&c.get().has(e.noteId));var q=fe(),b=E(q);{var re=D=>{var V=Qg(),ve=E(V);le(ve,()=>({"--bottom":e.showMenuUp?"calc(100%)":"auto","--top":e.showMenuUp?"auto":"calc(100%)","--right":"10px"})),zr(ve.lastChild,{get startClose(){return n(l)},onClosed:C,get isMobile(){return R},children:(W,ce)=>{var ie=Zg(),te=E(ie),ee=y(te);Ie(ee,{onClick:K,get dialogMode(){return R},children:(oe,S)=>{var j=Ig(),F=E(j);{let M=T(()=>e.noteData.pinned?"pin-cancel":"pin");le(F,()=>({"--size":"20px"})),de(F.lastChild,{get name(){return n(M)}})}var L=P(F);ke(()=>at(L,` ${e.noteData.pinned?"Unpin":"Pin"}`)),p(oe,j)},$$slots:{default:!0}});var z=P(te,2);{var G=oe=>{var S=Lg(),j=y(S);Ie(j,{onClick:O,get dialogMode(){return R},children:(F,L)=>{var M=Mg(),ae=E(M);le(ae,()=>({"--size":"20px"})),de(ae.lastChild,{name:"copy"}),p(F,M)},$$slots:{default:!0}}),p(oe,S)};H(z,oe=>{e.noteData.text&&oe(G)})}var Y=P(z,2);{var ne=oe=>{var S=Fg(),j=y(S);Ie(j,{onClick:N,get dialogMode(){return R},children:(F,L)=>{var M=Rg(),ae=E(M);le(ae,()=>({"--size":"20px"})),de(ae.lastChild,{name:"copy"}),p(F,M)},$$slots:{default:!0}}),p(oe,S)};H(Y,oe=>{n($)&&e.noteData.link?.url&&oe(ne)})}var ue=P(Y,2);{var Ee=oe=>{var S=zg(),j=y(S);Ie(j,{onClick:B,get dialogMode(){return R},children:(F,L)=>{var M=Og(),ae=E(M);le(ae,()=>({"--size":"20px"})),de(ae.lastChild,{name:"share"}),p(F,M)},$$slots:{default:!0}}),p(oe,S)};H(ue,oe=>{m&&e.noteData.text&&oe(Ee)})}var He=P(ue,2);{var nt=oe=>{var S=jg(),j=y(S);Ie(j,{onClick:X,get dialogMode(){return R},children:(F,L)=>{var M=Bg(),ae=E(M);{let Ce=T(()=>e.noteData.text?"":"share");le(ae,()=>({"--size":"20px"})),de(ae.lastChild,{get name(){return n(Ce)}})}p(F,M)},$$slots:{default:!0}}),p(oe,S)};H(He,oe=>{m&&e.noteData.link?.url&&oe(nt)})}var _e=P(He,2);{var Fe=oe=>{var S=Ug(),j=y(S);Ie(j,{onClick:()=>{v(l,!0),c.isEnabled()||c.enable(),c.add(e.noteId)},get dialogMode(){return R},children:(F,L)=>{var M=Hg(),ae=E(M);le(ae,()=>({"--size":"20px"})),de(ae.lastChild,{name:"check"}),p(F,M)},$$slots:{default:!0}}),p(oe,S)};H(_e,oe=>{n(Z)||oe(Fe)})}var J=P(_e,2);{var se=oe=>{var S=Vg(),j=y(S);Ie(j,{onClick:Q,get dialogMode(){return R},children:(F,L)=>{var M=Wg(),ae=E(M);le(ae,()=>({"--size":"20px"})),de(ae.lastChild,{name:""}),p(F,M)},$$slots:{default:!0}}),p(oe,S)};H(J,oe=>{e.noteData.link?.url&&i.checkDuplicatesExist(e.noteId)&&oe(se)})}var Pe=P(J,2);{var xe=oe=>{var S=Gg(),j=E(S),F=y(j);Ie(F,{onClick:()=>{v(u,o()==="notes"),v(f,o()==="archive"),v(l,!0)},get dialogMode(){return R},children:(ae,Ce)=>{var Se=qg(),Te=E(Se);{let be=T(()=>o()==="archive"?"archive-cancel":"archive");le(Te,()=>({"--size":"20px","--scale":"0.9"})),de(Te.lastChild,{get name(){return n(be)}})}var ye=P(Te);ke(()=>at(ye,` ${o()==="archive"?"Unarchive":"Archive"}`)),p(ae,Se)},$$slots:{default:!0}});var L=P(j,2),M=y(L);Ie(M,{onClick:()=>{v(d,!0),v(l,!0)},get dialogMode(){return R},children:(ae,Ce)=>{var Se=Kg(),Te=E(Se),ye=y(Te);le(ye,()=>({"--size":"20px"})),de(ye.lastChild,{name:"bin"}),p(ae,Se)},$$slots:{default:!0}}),p(oe,S)},pe=oe=>{var S=Jg(),j=E(S),F=y(j);Ie(F,{onClick:()=>{v(h,!0),v(l,!0)},get dialogMode(){return R},children:(ae,Ce)=>{var Se=Yg(),Te=E(Se),ye=y(Te);le(ye,()=>({"--size":"20px"})),de(ye.lastChild,{name:"bin-cancel"}),p(ae,Se)},$$slots:{default:!0}});var L=P(j,2),M=y(L);Ie(M,{onClick:U,get dialogMode(){return R},dangerous:!0,children:(ae,Ce)=>{var Se=Xg(),Te=E(Se),ye=y(Te);le(ye,()=>({"--size":"20px"})),de(ye.lastChild,{name:"bin"}),p(ae,Se)},$$slots:{default:!0}}),p(oe,S)};H(Pe,oe=>{o()==="notes"||o()==="archive"?oe(xe):oe(pe,!1)})}p(W,ie)},$$slots:{default:!0}}),p(D,V)};H(b,D=>{s()&&D(re)})}p(t,q),he()}let xo=A(!1),To=A(!1),_n=A(void 0),co={};const eh=()=>{Un||Wn||v(To,!0)},th=()=>{v(To,!1)},is=()=>{Un||Wn||v(xo,!0)},nh=()=>{v(xo,!1)},ah=()=>n(To),Ul=()=>n(xo),vn=t=>{Un||Wn||v(_n,t,!0)},ao=()=>n(_n),ci=()=>{const t=co[n(_n)||""]?.next;if(t)return v(_n,t,!0),t},di=()=>{const t=co[n(_n)||""]?.prev;if(t)return v(_n,t,!0),t};var rh=k('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),oh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),sh=k('<div class="b p-rxwzp0"><!></div>'),ih=k('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),lh=k('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),ch=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),dh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),uh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),fh=k("<!> <!>",1),vh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gh=k("<li><!> <!> <!> <div><!> <!> <!></div> <!></li>");function hh(t,e){ge(e,!0);const a=Ot(),r=Pt(),o=qn(),s=va();let i=Ne(e,"mode",3,"notes"),c="unknown";Le(()=>(co[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete co[e.noteId]}));let l=A(!1),d=A(!1),u=T(()=>o.getFaviconEnabled()),f=T(()=>o.getRecordMode()),h=A(null),m=A(null),g=A(null);const w=fa(),_=()=>{v(l,!0)},x=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),Ye("Copied link"))};Le(()=>{n(_n)===e.noteId?v(d,!0):v(d,!1)});const K=ee=>{ee.preventDefault(),a.push(`${me.Note}?id=${encodeURIComponent(e.noteId)}`)},C=T(()=>e.noteData.link?.url||"");let N=T(()=>n(l)&&n(h)?ft(n(h)).next:null);const O=ee=>{ee?s.add(e.noteId):s.remove(e.noteId)},U=()=>{const ee=new URLSearchParams(r.get());return ee.set(Ht,`${me.Note}?id=${encodeURIComponent(e.noteId)}`),r.getHref(ee)};let B=T(()=>s.isEnabled()&&s.get().has(e.noteId));we(()=>{const ee=z=>{if(c="keyboard",n(_n)===e.noteId&&(z.key==="Enter"&&n(To)&&(n(f)==="note"?(z.preventDefault(),setTimeout(()=>{a.push(`${me.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(f)==="bookmark"&&n(C)&&window.open(n(C),"_blank","noopener")),z.key==="Tab"&&n(xo)&&(nh(),n(g)))){const G=ft(n(g));z.shiftKey?G.prev?.focus():G?.next?.focus()}};return document.addEventListener("keydown",ee),()=>{document.removeEventListener("keydown",ee)}});var X=gh();X.__focusin=()=>{c==="keyboard"&&v(_n,e.noteId,!0)};var Q=y(X);{var R=ee=>{var z=rh(),G=y(z);le(G,()=>({"--size":"18px"})),de(G.lastChild,{name:"pin"}),p(ee,z)};H(Q,ee=>{e.noteData.pinned&&ee(R)})}var $=P(Q,2);{var Z=ee=>{var z=sh(),G=y(z);{var Y=ue=>{El(ue,{get url(){return n(C)}})},ne=ue=>{var Ee=oh(),He=E(Ee);le(He,()=>({"--size":"16px"})),de(He.lastChild,{name:"note"}),p(ue,Ee)};H(G,ue=>{n(C)?ue(Y):ue(ne,!1)})}p(ee,z)};H($,ee=>{n(u)&&ee(Z)})}var q=P($,2);{var b=ee=>{var z=ih();z.__keydown=Y=>{Y.key==="Enter"&&(c="keyboard")},z.__mousedown=()=>{c="mouse"},z.__click=Y=>{c==="mouse"&&vn(void 0),Y.preventDefault(),s.isEnabled()?O(!n(B)):K(Y)};var G=y(z);Ke(z,Y=>v(g,Y),()=>n(g)),ke((Y,ne)=>{tt(z,"tabindex",e.focusHidden?-1:0),tt(z,"href",Y),at(G,ne)},[U,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Wt("focus",z,()=>{}),p(ee,z)},re=ee=>{var z=lh();z.__keydown=Y=>{Y.key==="Enter"&&(c="keyboard")},z.__mousedown=()=>{c="mouse"},z.__click=Y=>{s.isEnabled()&&(Y.preventDefault(),O(!n(B)))};var G=y(z);Ke(z,Y=>v(g,Y),()=>n(g)),ke(Y=>{tt(z,"tabindex",e.focusHidden?-1:0),tt(z,"href",n(C)),at(G,Y)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Wt("focus",z,()=>{}),p(ee,z)};H(q,ee=>{n(f)==="note"||!n(C)?ee(b):ee(re,!1)})}var D=P(q,2),V=y(D);{var ve=ee=>{{let z=T(U),G=T(()=>e.focusHidden?-1:0);Qt(ee,{title:"edit",elem:"a",get href(){return n(z)},get tabindex(){return n(G)},onclick:K,children:(Y,ne)=>{var ue=ch(),Ee=E(ue);le(Ee,()=>({"--size":"18px"})),de(Ee.lastChild,{name:"pen"}),p(Y,ue)},$$slots:{default:!0}})}};H(V,ee=>{(n(f)==="bookmark"||s.isEnabled())&&ee(ve)})}var W=P(V,2);{var ce=ee=>{var z=fh(),G=E(z);{var Y=Ee=>{{let He=T(()=>e.focusHidden?-1:0),nt=T(()=>e.noteData.link?.title||"unknown");Qt(Ee,{elem:"a",get href(){return n(C)},get tabindex(){return n(He)},get title(){return n(nt)},children:(_e,Fe)=>{var J=dh(),se=E(J);le(se,()=>({"--size":"18px"})),de(se.lastChild,{name:"open"}),p(_e,J)},$$slots:{default:!0}})}};H(G,Ee=>{(n(f)==="note"||s.isEnabled())&&Ee(Y)})}var ne=P(G,2);{var ue=Ee=>{{let He=T(()=>e.focusHidden?-1:0);Qt(Ee,{elem:"button",onclick:x,get tabindex(){return n(He)},title:"copy link",children:(nt,_e)=>{var Fe=uh(),J=E(Fe);le(J,()=>({"--size":"20px"})),de(J.lastChild,{name:"copy"}),p(nt,Fe)},$$slots:{default:!0}})}};H(ne,Ee=>{w.check()||Ee(ue)})}p(ee,z)};H(W,ee=>{n(C)&&ee(ce)})}var ie=P(W,2);{let ee=T(()=>e.focusHidden?-1:0);Qt(ie,{title:"show menu",elem:"button",get tabindex(){return n(ee)},onclick:_,get ref(){return n(h)},set ref(z){v(h,z,!0)},children:(z,G)=>{var Y=vh(),ne=E(Y);le(ne,()=>({"--size":"18px","--rotate":"90deg"})),de(ne.lastChild,{name:"menu"}),p(z,Y)},$$slots:{default:!0}})}var te=P(D,2);$g(te,{get onFindDuplicates(){return e.onFindDuplicates},get nextFocusRef(){return n(N)},get mode(){return i()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(l)},set shownMenu(ee){v(l,ee,!0)}}),Ke(X,ee=>v(m,ee),()=>n(m)),ke(()=>{Ge(X,1,Xe({d:!0,e:n(d),f:n(B)||n(_n)===e.noteId}),"p-rxwzp0"),Ge(D,1,Xe({g:!0,h:n(d)}),"p-rxwzp0")}),p(t,X),he()}st(["focusin","keydown","mousedown","click"]);const Wl={};function ph(t){ot(Wl,t)}function Eo(){const t=rt(Wl);if(!t)throw new Error("No ScrollContainerContext found");return t}const mh=()=>{let t=A(null);return{set:r=>{v(t,r,!0)},get:()=>n(t)}};function _h(t,e){ge(e,!0),ph(mh());var a=fe(),r=E(a);Ae(r,()=>e.children??Ue),p(t,a),he()}var ir,Vl,ql;class wh{constructor(e){De(this,ir);Nt(this,"data");Nt(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),ut(this,ir,Vl).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,ut(this,ir,ql).call(this)),e}isEmpty(){return this.data.length===0}}ir=new WeakSet,Vl=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},ql=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class yh{constructor(e,a){Nt(this,"heap");Nt(this,"done");Nt(this,"cache",[]);this.heap=new wh(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var bh=k("<span>Back to notes</span>"),Sh=k('<div class="c p-130fajz">No notes in bin</div> <div class="d p-130fajz"><!></div>',1),kh=k("<span>Back to notes</span>"),Ch=k('<div class="c p-130fajz">No notes in archive</div> <div class="d p-130fajz"><!></div>',1),xh=k('<p class="f">No notes in bin</p>'),Th=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),Eh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Nh=k('<div class="g p-130fajz"><div class="d p-130fajz"><!></div> <div>or</div> <div class="d p-130fajz"><!></div></div>'),Ph=k('<div class="e p-130fajz"><!></div>'),Ah=k('<div class="h"><div class="c p-130fajz">No notes found</div></div>'),Dh=k('<div class="i p-130fajz"><ul class="p-130fajz"></ul></div>'),Ih=k('<div class="a p-130fajz"><div class="b p-130fajz"><!></div></div>');function Mh(t,e){ge(e,!0);const{getCountDialog:a}=Vt(),r=Eo(),o=Ot(),s=Kn(),i=Ol(),c=kt(),l=ko(),d=Pt(),{getFiltredNotesLength:u,getFiltredNotes:f,getUpdatedFiltredNotesTimestamp:h}=vr(),m=fr();let g="keyboard",w=T(()=>l.getAll()),_=T(u),x=T(f),K=T(h),C=T(()=>c.isInitedNotes()),N=54,O=A(0),U=A(0),B=A(0),X=A(null),Q=T(()=>r.get());const R=J=>{m?.set(J+"$")};let $=null,Z=null,q=T(()=>n(w).has(Ze.ARCHIVED)?"archive":n(w).has(Ze.BIN)?"bin":"notes");const b=T(()=>s.get()),re=T(()=>i.get());Le(()=>{n(b),n(re),n(Q)?.scrollTo(0,0)});const{enable:D}=xs(),V=()=>{D(),$||($=requestAnimationFrame(()=>{const J=n(Q)?.scrollTop||0;v(B,J,!0);const se=Math.ceil(n(O)/N);v(U,Math.floor(J/(N*se))*(N*se)),$=null}))},ve=()=>{Z||(Z=requestAnimationFrame(()=>{v(O,window.innerHeight-180||0,!0);const J=n(Q)?.scrollTop||0;v(B,J,!0);const se=Math.ceil(n(O)/N);v(U,Math.floor(J/(N*se))*(N*se)),Z=null}))};we(()=>{const J=se=>{if(!(!ah()&&ao()===void 0)&&!(a()>0)&&(se.key==="ArrowDown"||se.key==="ArrowUp")){if(se.preventDefault(),se.key==="ArrowDown"){const Pe=ao(),xe=n(te).findIndex(S=>S.id===Pe),pe=Y(),oe=ne();if(!Pe||xe===-1)vn(pe?.id);else if(xe<=oe.index&&xe>=pe.index)ci()&&xe!==-1&&G(xe+1)&&n(Q)&&(n(Q).scrollTop=Math.floor(n(Q).scrollTop/N)*N+N);else if(xe>oe.index&&!G(xe-1)&&G(xe)){n(Q)&&(n(Q).scrollTop=Math.ceil(n(Q).scrollTop/N)*N+N);const S=ci();vn(S)}else vn(pe?.id)}else if(se.key==="ArrowUp"){const Pe=ao(),xe=n(te).findIndex(S=>S.id===Pe),pe=Y(),oe=ne();if(!Pe||xe===-1)vn(oe?.id);else if(xe<=oe.index&&xe>=pe.index)di()&&xe!==-1&&G(xe-1)&&n(Q)&&(n(Q).scrollTop=Math.ceil(n(Q).scrollTop/N)*N-N);else if(xe<pe.index&&!G(xe+1)&&G(xe)){n(Q)&&(n(Q).scrollTop=n(z)+xe*N-N);const S=di();vn(S)}else vn(oe?.id)}Ul()||is()}};return document.addEventListener("keydown",J),()=>{document.removeEventListener("keydown",J)}}),we(()=>{ve(),V()});const W=()=>{V()};Le(()=>{(m?.get()||"")!==""&&g==="keyboard"&&(vn(Y().id),is())}),Le(()=>(n(Q)?.addEventListener("scroll",W),window.addEventListener("resize",ve),()=>{n(Q)?.removeEventListener("scroll",W),window.removeEventListener("resize",ve)})),Le(()=>{n(re),n(K),v(X,new yh(n(x),(J,se)=>{if(!J||!se||!J.data||!se.data)return 0;if(J.data.pinned&&!se.data.pinned)return-1;if(!J.data.pinned&&se.data.pinned)return 1;if(J.data.pinned&&se.data.pinned){if(J.data.pinned<se.data.pinned)return 1;if(J.data.pinned>se.data.pinned)return-1}const Pe=(xe,pe)=>xe.data.text||pe.data.text?(xe.data.text||"").localeCompare(pe.data.text||""):(xe.data.link?.title||"").localeCompare(pe.data.link?.title||"");switch(n(re)){case"newest":return J.data.createdAt<se.data.createdAt?1:J.data.createdAt>se.data.createdAt?-1:Pe(J,se);case"oldest":return J.data.createdAt>se.data.createdAt?1:J.data.createdAt<se.data.createdAt?-1:Pe(J,se);case"AtoZ":return Pe(J,se);case"ZtoA":return Pe(se,J);case"updatedNewest":return J.data.updatedAt<se.data.updatedAt?1:J.data.updatedAt>se.data.updatedAt?-1:Pe(J,se);default:return 0}}),!0)});const ce=T(()=>n(_)*N);let te=T(()=>{n(K);const J=Math.ceil(n(O)/N);let se=Math.floor(n(U)/N);return se=se-Math.min(se,J),n(X)?.get(se,se+J*3)||[]}),ee=T(()=>N*Math.ceil(n(O)/N));const z=T(()=>n(U)-Math.min(n(U),n(ee))),G=J=>J*N<n(B)-n(z)-N/2||J*N>n(B)-n(z)+Math.floor(n(O)/N)*N,Y=()=>{for(let J=0;J<n(te).length;J++)if(!G(J))return{index:J,id:n(te)[J].id};return{index:-1,id:void 0}},ne=()=>{for(let J=n(te).length-1;J>=0;J--)if(!G(J))return{index:J,id:n(te)[J].id};return{index:-1,id:void 0}};we(()=>{document.addEventListener("mousemove",()=>{g="mouse"}),document.addEventListener("keydown",()=>{g="keyboard"})});const ue=J=>{const se=J*N,Pe=n(B)-n(z);return Pe+Math.floor(n(O)/N)*N-se<N*5&&se-Pe>N*5};var Ee=Ih(),He=y(Ee),nt=y(He);{var _e=J=>{Da(J,{})},Fe=J=>{var se=fe(),Pe=E(se);{var xe=oe=>{var S=Sh(),j=P(E(S),2),F=y(j);{let L=T(()=>d.getHref(""));Tt(F,{element:"a",get href(){return n(L)},onClick:M=>{M.preventDefault(),d.replace("")},children:(M,ae)=>{var Ce=bh();p(M,Ce)},$$slots:{default:!0}})}p(oe,S)},pe=oe=>{var S=fe(),j=E(S);{var F=M=>{var ae=Ch(),Ce=P(E(ae),2),Se=y(Ce);{let Te=T(()=>d.getHref(""));Tt(Se,{element:"a",get href(){return n(Te)},onClick:ye=>{ye.preventDefault(),d.replace("")},children:(ye,be)=>{var Be=kh();p(ye,Be)},$$slots:{default:!0}})}p(M,ae)},L=M=>{var ae=fe(),Ce=E(ae);{var Se=ye=>{var be=Ph(),Be=y(be);{var Oe=Ve=>{var it=xh();p(Ve,it)},At=Ve=>{var it=Nh(),dt=y(it),Je=y(dt);{let Dt=T(()=>o.createHref(me.NewNote)),ga=T(()=>o.createHandleClick(me.NewNote));Tt(Je,{element:"a",get href(){return n(Dt)},get onClick(){return n(ga)},children:(Kt,un)=>{var fn=Th(),xn=E(fn);le(xn,()=>({"--size":"18px","--color":"#b0b0b0"})),de(xn.lastChild,{name:"plus"}),p(Kt,fn)},$$slots:{default:!0}})}var qt=P(dt,4),Et=y(qt);{let Dt=T(()=>o.createHref(me.ImportData)),ga=T(()=>o.createHandleClick(me.ImportData));Tt(Et,{element:"a",get href(){return n(Dt)},get onClick(){return n(ga)},children:(Kt,un)=>{var fn=Eh(),xn=E(fn);le(xn,()=>({"--size":"18px","--color":"#b0b0b0"})),de(xn.lastChild,{name:"import"}),p(Kt,fn)},$$slots:{default:!0}})}p(Ve,it)};H(Be,Ve=>{n(q)==="bin"?Ve(Oe):Ve(At,!1)})}p(ye,be)},Te=ye=>{var be=fe(),Be=E(be);{var Oe=Ve=>{var it=Ah();p(Ve,it)},At=Ve=>{var it=Dh(),dt=y(it);Bn(dt,23,()=>n(te),Je=>Je.data,(Je,qt,Et)=>{var Dt=fe(),ga=E(Dt);{var Kt=un=>{{let fn=T(()=>n(te)[n(Et)+1]?.id),xn=T(()=>n(te)[n(Et)-1]?.id),No=T(()=>G(n(Et))),Gn=T(()=>ue(n(Et)));hh(un,{onFindDuplicates:R,get nextNoteId(){return n(fn)},get prevNoteId(){return n(xn)},get mode(){return n(q)},get focusHidden(){return n(No)},get showMenuUp(){return n(Gn)},get noteId(){return n(qt).id},get noteData(){return n(qt).data}})}};H(ga,un=>{n(qt).data&&un(Kt)})}p(Je,Dt)}),ke(Je=>{or(it,Je),or(dt,`transform: translateY(${n(z)??""}px);`)},[()=>`--minHeight: ${Math.max((n(ce)>n(O),n(ce)),0)}px`]),p(Ve,it)};H(Be,Ve=>{n(te).length===0?Ve(Oe):Ve(At,!1)},!0)}p(ye,be)};H(Ce,ye=>{!c.checkNotesInBin()&&!c.checkNotesInArchive()&&!c.checkNotes()?ye(Se):ye(Te,!1)},!0)}p(M,ae)};H(j,M=>{n(q)==="archive"&&!c.checkNotesInArchive()?M(F):M(L,!1)},!0)}p(oe,S)};H(Pe,oe=>{n(q)==="bin"&&!c.checkNotesInBin()?oe(xe):oe(pe,!1)},!0)}p(J,se)};H(nt,J=>{n(C)?J(Fe,!1):J(_e)})}p(t,Ee),he()}var Lh=k('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Rh(t){var e=Lh(),a=P(E(e),2),r=y(a);Mh(r,{}),p(t,e)}var Fh=k("<!> <!>",1);function Oh(t,e){ge(e,!0);const a=(q,b=Ue,re=Ue,D)=>{let V=Lr(()=>kc(D?.(),!1));var ve=fe(),W=E(ve);{var ce=te=>{gt(te,{children:(ee,z)=>{Ct(ee,{get hidden(){return n(V)},get page(){return me.Settings}})},$$slots:{default:!0}})},ie=te=>{var ee=fe(),z=E(ee);{var G=ne=>{gt(ne,{children:(ue,Ee)=>{Mv(ue,{})},$$slots:{default:!0}})},Y=ne=>{var ue=fe(),Ee=E(ue);{var He=_e=>{gt(_e,{children:(Fe,J)=>{Ct(Fe,{get params(){return re()},get hidden(){return n(V)},get page(){return me.Note}})},$$slots:{default:!0}})},nt=_e=>{var Fe=fe(),J=E(Fe);{var se=xe=>{gt(xe,{children:(pe,oe)=>{Ct(pe,{get hidden(){return n(V)},get page(){return me.ImportData}})},$$slots:{default:!0}})},Pe=xe=>{var pe=fe(),oe=E(pe);{var S=F=>{gt(F,{children:(L,M)=>{Ct(L,{get hidden(){return n(V)},get page(){return me.ExportData}})},$$slots:{default:!0}})},j=F=>{var L=fe(),M=E(L);{var ae=Se=>{gt(Se,{children:(Te,ye)=>{Zu(Te,{})},$$slots:{default:!0}})},Ce=Se=>{var Te=fe(),ye=E(Te);{var be=Oe=>{gt(Oe,{children:(At,Ve)=>{Ct(At,{get hidden(){return n(V)},get page(){return me.Install}})},$$slots:{default:!0}})},Be=Oe=>{var At=fe(),Ve=E(At);{var it=Je=>{gt(Je,{children:(qt,Et)=>{Ct(qt,{get hidden(){return n(V)},get page(){return me.InstallSuccess}})},$$slots:{default:!0}})},dt=Je=>{var qt=fe(),Et=E(qt);{var Dt=Kt=>{gt(Kt,{children:(un,fn)=>{Ct(un,{get hidden(){return n(V)},get page(){return me.Auth}})},$$slots:{default:!0}})},ga=Kt=>{var un=fe(),fn=E(un);{var xn=Gn=>{gt(Gn,{children:(jr,Es)=>{Ct(jr,{get hidden(){return n(V)},get page(){return me.Signup}})},$$slots:{default:!0}})},No=Gn=>{var jr=fe(),Es=E(jr);{var Gl=Ia=>{gt(Ia,{children:(Hr,Ns)=>{Ct(Hr,{get hidden(){return n(V)},get page(){return me.Signin}})},$$slots:{default:!0}})},Yl=Ia=>{var Hr=fe(),Ns=E(Hr);{var Xl=Ma=>{gt(Ma,{children:(Ur,Ps)=>{Ct(Ur,{get hidden(){return n(V)},get page(){return me.AccessKeys}})},$$slots:{default:!0}})},Jl=Ma=>{var Ur=fe(),Ps=E(Ur);{var Zl=La=>{gt(La,{children:(Wr,As)=>{Ct(Wr,{get hidden(){return n(V)},get page(){return me.Account}})},$$slots:{default:!0}})},Ql=La=>{var Wr=fe(),As=E(Wr);{var $l=Ra=>{gt(Ra,{children:(Vr,Ds)=>{Ct(Vr,{get hidden(){return n(V)},get page(){return me.ConfirmAccessKey}})},$$slots:{default:!0}})},ec=Ra=>{var Vr=fe(),Ds=E(Vr);{var tc=Fa=>{gt(Fa,{children:(qr,Is)=>{Ct(qr,{get hidden(){return n(V)},get page(){return me.Exit}})},$$slots:{default:!0}})},nc=Fa=>{var qr=fe(),Is=E(qr);{var ac=Po=>{var Ms=fe(),rc=E(Ms);{var oc=Ao=>{var Ls=fe(),sc=E(Ls);{var ic=Oa=>{gt(Oa,{children:(Kr,Rs)=>{Ct(Kr,{get hidden(){return n(V)},get page(){return me.Sync}})},$$slots:{default:!0}})},lc=Oa=>{var Kr=fe(),Rs=E(Kr);{var cc=za=>{gt(za,{children:(Gr,Fs)=>{Ct(Gr,{get hidden(){return n(V)},get page(){return me.Subscription}})},$$slots:{default:!0}})},dc=za=>{var Gr=fe(),Fs=E(Gr);{var uc=Ba=>{gt(Ba,{children:(Do,vc)=>{Ct(Do,{get hidden(){return n(V)},get page(){return me.About}})},$$slots:{default:!0}})},fc=Ba=>{gt(Ba,{children:(Do,vc)=>{Rv(Do,{})},$$slots:{default:!0}})};H(Fs,Ba=>{b()===me.About?Ba(uc):Ba(fc,!1)},!0)}p(za,Gr)};H(Rs,za=>{b()===me.Subscription?za(cc):za(dc,!1)},!0)}p(Oa,Kr)};H(sc,Oa=>{b()===me.Sync?Oa(ic):Oa(lc,!1)},!0)}p(Ao,Ls)};H(rc,Ao=>{b(),me.AddNotes,Ao(oc,!1)},!0)}p(Po,Ms)};H(Is,Po=>{b(),me.Extension,Po(ac,!1)},!0)}p(Fa,qr)};H(Ds,Fa=>{b()===me.Exit?Fa(tc):Fa(nc,!1)},!0)}p(Ra,Vr)};H(As,Ra=>{b()===me.ConfirmAccessKey?Ra($l):Ra(ec,!1)},!0)}p(La,Wr)};H(Ps,La=>{b()===me.Account?La(Zl):La(Ql,!1)},!0)}p(Ma,Ur)};H(Ns,Ma=>{b()===me.AccessKeys?Ma(Xl):Ma(Jl,!1)},!0)}p(Ia,Hr)};H(Es,Ia=>{b()===me.Signin?Ia(Gl):Ia(Yl,!1)},!0)}p(Gn,jr)};H(fn,Gn=>{b()===me.Signup?Gn(xn):Gn(No,!1)},!0)}p(Kt,un)};H(Et,Kt=>{b()===me.Auth?Kt(Dt):Kt(ga,!1)},!0)}p(Je,qt)};H(Ve,Je=>{b()===me.InstallSuccess?Je(it):Je(dt,!1)},!0)}p(Oe,At)};H(ye,Oe=>{b()===me.Install?Oe(be):Oe(Be,!1)},!0)}p(Se,Te)};H(M,Se=>{b()===me.AccountSetup?Se(ae):Se(Ce,!1)},!0)}p(F,L)};H(oe,F=>{b()===me.ExportData?F(S):F(j,!1)},!0)}p(xe,pe)};H(J,xe=>{b()===me.ImportData?xe(se):xe(Pe,!1)},!0)}p(_e,Fe)};H(Ee,_e=>{b()===me.Note?_e(He):_e(nt,!1)},!0)}p(ne,ue)};H(z,ne=>{b()===me.NewNote?ne(G):ne(Y,!1)},!0)}p(te,ee)};H(W,te=>{b()===me.Settings?te(ce):te(ie,!1)})}p(q,ve)};let r=T(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:o,checkClosableDialog:s}=Vt(),{sidebarClose:i,getSidebarState:c}=Br(),l=Cn();qn();const d=T(o),u=T(s),f=Ss();let h=T(()=>f.getAccount()!==void 0);const m=fa();let g=A(et([]));const w=T(()=>m.check()),_=Ot();let x=T(()=>_.get());const{checkLeftStart:K}=Vt();let C=T(K);Le(()=>{n(x).length>0&&c()!=="closed"&&setTimeout(()=>{i()},0)});const N=()=>{_.pop()},O=()=>{_.clear()};we(()=>{n(x).length===0&&l.set({working:!0})}),Le(()=>{n(x),n(w),ht(()=>{if(n(w))n(x).length>=n(g).length||n(C)?v(g,n(x).map(q=>({page:q,shown:!0})),!0):v(g,n(g).map((q,b)=>({page:q.page,shown:b<n(x).length})),!0);else if(n(x).length>=n(g).length)v(g,n(x).map(q=>({page:q,shown:!0})),!0);else{if(n(x).length===0){v(g,[{page:n(g)[n(g).length-1].page,shown:!1}],!0);return}v(g,n(x).map(q=>({page:q,shown:!0})),!0)}})});const U=()=>{v(g,n(x).map(q=>({page:q,shown:!0})),!0)};var B=Fh(),X=E(B);{var Q=q=>{Rh(q)};H(X,q=>{n(h)&&q(Q)})}var R=P(X,2);{var $=q=>{var b=fe(),re=E(b);Bn(re,19,()=>n(g),D=>D.page.split("?")[0],(D,V,ve)=>{const W=T(()=>n(V).page.split("?")[1]),ce=T(()=>n(V).page.split("?")[0]),ie=T(()=>n(ve)!==n(g).length-1&&!!n(g)[n(ve)+1]?.shown),te=T(()=>n(ve)===0);{let ee=T(()=>ai[n(ce)]||""),z=T(()=>n(d)||n(te)&&!n(u)),G=T(()=>({...n(ce)!==me.NewNote&&n(ce)!==me.Note?n(r):{}}));cg(D,Jo({get shown(){return n(V).shown},get title(){return n(ee)},get hidden(){return n(ie)},get blocked(){return n(z)},onClose:N,onClosed:U},()=>n(G),{children:(Y,ne)=>{a(Y,()=>n(ce),()=>n(W),()=>n(ie))},$$slots:{default:!0}}))}}),p(q,b)},Z=q=>{var b=fe(),re=E(b);{var D=V=>{const ve=T(()=>n(g)[n(g).length-1].page.split("?")[1]),W=T(()=>n(g)[n(g).length-1].page.split("?")[0]),ce=T(()=>n(g)[n(g).length-1].shown),ie=T(()=>n(g).length===1);{let te=T(()=>ai[n(W)]||""),ee=T(()=>n(d)||!n(u)),z=T(()=>n(d)||n(ie)?void 0:N);Kv(V,{get shownDialog(){return n(ce)},get title(){return n(te)},get blockedDialog(){return n(ee)},hiddenDialog:!1,get onStartBack(){return n(z)},onStartClose:O,onClosed:U,children:(G,Y)=>{a(G,()=>n(W),()=>n(ve))},$$slots:{default:!0}})}};H(re,V=>{n(g).length>0&&V(D)},!0)}p(q,b)};H(R,q=>{m.check()?q($):q(Z,!1)})}p(t,B),he()}var zh=k('<div class="b p-z67y1l">Rename <!> for selected notes</div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Bh=k('<form class="a p-z67y1l"><!></form>');function jh(t,e){ge(e,!0);let a=A(!1),r=A(!1),o,s=!1,i=A(null),c=A(et(e.tag)),l=e.nextFocusRef;const d=kt(),u=Kn(),f=va();we(()=>(n(i)&&n(i).focus(),()=>{o&&clearTimeout(o)}));const h=()=>{o=setTimeout(()=>{v(r,!0)},250)},m=()=>{v(a,!0)},g=async()=>{if(n(c).trim()===e.tag){m();return}if(n(c).trim()!=="")try{h();const x=u.get(),K=[...x].map(B=>B===e.tag?n(c).trim():B),C=new Set(f.get()),N=e.getFiltredNotes(),O=C.size?[...C]:N.map(B=>B.id),{cancel:U}=await d.renameTag(e.tag,n(c).trim(),O);f.clear(),u.set(new Set(K)),Ye("Tag renamed",{cancel:{nextFocusRef:l,onCancel:async()=>{await U(),u.set(x),f.set(C),setTimeout(()=>{const{prev:B}=ft(l);B?.focus()},16)}}}),s=!0}finally{v(a,!0)}},w=()=>{e.onClosed?.(s)},_=x=>{x.preventDefault(),g()};Or(t,{get blocked(){return n(r)},get startClose(){return n(a)},onClosed:w,children:(x,K)=>{var C=Bh(),N=y(C);{var O=B=>{Da(B,{})},U=B=>{var X=zh(),Q=E(X),R=P(y(Q));Jn(R,{size:"small",disabled:!0,children:(re,D)=>{var V=Me();ke(()=>at(V,e.tag)),p(re,V)},$$slots:{default:!0}});var $=P(Q,2);xr($,{placeholder:"Enter new tag name",get ref(){return n(i)},set ref(re){v(i,re,!0)},get value(){return n(c)},set value(re){v(c,re,!0)}});var Z=P($,2),q=y(Z);Tt(q,{size:"small",onClick:m,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(re,D)=>{var V=Me("Cancel");p(re,V)},$$slots:{default:!0}});var b=P(q,2);Tt(b,{size:"small",onClick:g,fullWidth:!0,withoutMinWidth:!0,children:(re,D)=>{var V=Me("OK");p(re,V)},$$slots:{default:!0}}),p(B,X)};H(N,B=>{n(r)?B(O):B(U,!1)})}Wt("submit",C,_),p(x,C)},$$slots:{default:!0}}),he()}let ta=A(!1),ma=A(!1),Bt=A(""),_a=A(0),yr=A(0),br=A(0),ro,uo=()=>({bottom:0,right:0,height:0}),Gt=A(null),ls=A(null);function Hh(t){if(n(ta)){v(ma,!0),n(Bt)!==t.tag&&(ro=()=>{const a=t.getRect();v(ta,!0),v(Bt,t.tag,!0),v(_a,a.bottom,!0),v(yr,a.right,!0),v(br,a.height,!0),uo=t.getRect,v(Gt,t.focusRef,!0)});return}const e=t.getRect();v(ta,!0),v(Bt,t.tag,!0),v(_a,e.bottom,!0),v(yr,e.right,!0),v(br,e.height,!0),uo=t.getRect,v(Gt,t.focusRef,!0)}const Uh=()=>n(ta),Wh=()=>n(ls);var Vh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),qh=k('<li class="p-16hbyw2"><!></li>'),Kh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),Gh=k('<li class="p-16hbyw2"><!></li>'),Yh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),Xh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),Jh=k('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),Zh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Qh=k("<!> <!>",1);function $h(t,e){ge(e,!0);const a=Eo(),r=fa(),o=Kn();let s=A(!1);const i=kt(),c=va();Le(()=>{n(ta),ht(()=>{v(s,i.getGetMapTags()().get(n(Bt))?.pinned||!1,!0)})});let l=A(!1);const d=()=>{i.pinTag(n(Bt),!0),v(ma,!0);let R=n(Gt),$=ft(R)?.next;Ye("Tag pinned",{cancel:{nextFocusRef:$,onCancel:async()=>{i.pinTag(n(Bt),!1),setTimeout(()=>{const{prev:Z}=ft($);Z?.focus()},16)}}})},u=()=>{i.pinTag(n(Bt),!1),v(ma,!0);let R=n(Gt),$=ft(R)?.next;Ye("Tag unpinned",{cancel:{nextFocusRef:$,onCancel:async()=>{i.pinTag(n(Bt),!0),setTimeout(()=>{const{prev:Z}=ft($);Z?.focus()},16)}}})},f=()=>{v(ta,!1),v(ma,!1),v(_a,0),v(yr,0),v(br,0),uo=()=>({bottom:0,right:0,height:0}),v(Gt,null),ro&&setTimeout(()=>{ro?.(),ro=void 0})};let h=T(()=>window.innerHeight-n(_a)<100?n(_a)-n(br)-98+"px":n(_a)+5+"px"),m=T(()=>a.get());const g=R=>{R.key==="Tab"&&R.shiftKey&&(R.preventDefault(),n(Gt)?.focus())},w=R=>{R.key==="Tab"&&!R.shiftKey&&n(Gt)&&(R.preventDefault(),ft(n(Gt))?.next?.focus())};we(()=>{const R=$=>{$.key==="Escape"&&n(ta)&&n(Gt)?.focus()};return window.addEventListener("keydown",R),()=>{window.removeEventListener("keydown",R)}});const _=()=>{v(ma,!0);let R=n(Gt),$=ft(R)?.next;Ka({title:`Are you sure to delete "${n(Bt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const Z=Array.from(n(C)),q=new Set(c.get()),b=e.getFiltredNotes(),re=q.size?[...q]:b.map(V=>V.id);n(C).has(n(Bt))&&(q.size===0||b.length===q.size)&&o.remove(n(Bt)),c.clear();const{cancel:D}=await i.deleteTag(n(Bt),re);Ye("Tag deleted",{cancel:{nextFocusRef:$,onCancel:async()=>{await D(),o.set(new Set(Z)),c.set(q),setTimeout(()=>{const{prev:V}=ft($);V?.focus()},16)}}})},onCancel:async()=>{},onClosed:Z=>{setTimeout(()=>{Z||R?.focus()},16)}})};let x=()=>{};const K=()=>{v(ma,!0),v(l,!0);let R=n(Gt);x=()=>{v(l,!1),setTimeout(()=>{R?.focus()},16)}};Le(()=>{const R=()=>{const $=uo();v(_a,$.bottom,!0),v(yr,$.right,!0),v(br,$.height,!0)};return n(m)?.addEventListener("scroll",R),window.addEventListener("resize",R),()=>{n(m)?.removeEventListener("scroll",R),window.removeEventListener("resize",R)}});let C=T(()=>o.get()),N=T(()=>r.check());var O=Qh(),U=E(O);{var B=R=>{var $=Zh(),Z=E($);le(Z,()=>({"--left":n(yr)-36+"px","--top":n(h),"--transform-origin":"top left"})),zr(Z.lastChild,{get startClose(){return n(ma)},onClosed:f,get isMobile(){return n(N)},get ref(){return n(ls)},set ref(q){v(ls,q,!0)},children:(q,b)=>{var re=Jh(),D=E(re);{var V=ee=>{var z=qh(),G=y(z);Ie(G,{onClick:d,onKeydown:g,get dialogMode(){return n(N)},children:(Y,ne)=>{var ue=Vh(),Ee=E(ue);le(Ee,()=>({"--size":"20px"})),de(Ee.lastChild,{name:"pin"}),p(Y,ue)},$$slots:{default:!0}}),p(ee,z)},ve=ee=>{var z=Gh(),G=y(z);Ie(G,{onClick:u,onKeydown:g,get dialogMode(){return n(N)},children:(Y,ne)=>{var ue=Kh(),Ee=E(ue);le(Ee,()=>({"--size":"20px"})),de(Ee.lastChild,{name:"pin-cancel"}),p(Y,ue)},$$slots:{default:!0}}),p(ee,z)};H(D,ee=>{n(s)?ee(ve,!1):ee(V)})}var W=P(D,2),ce=y(W);Ie(ce,{onClick:K,get dialogMode(){return n(N)},children:(ee,z)=>{var G=Yh(),Y=E(G);le(Y,()=>({"--size":"20px","--scale":"0.9"})),de(Y.lastChild,{name:"pen"}),p(ee,G)},$$slots:{default:!0}});var ie=P(W,2),te=y(ie);Ie(te,{onClick:_,onKeydown:w,get dialogMode(){return n(N)},children:(ee,z)=>{var G=Xh(),Y=E(G);le(Y,()=>({"--size":"20px"})),de(Y.lastChild,{name:"bin"}),p(ee,G)},$$slots:{default:!0}}),p(q,re)},$$slots:{default:!0}}),p(R,$)};H(U,R=>{n(ta)&&R(B)})}var X=P(U,2);{var Q=R=>{{let $=T(()=>ft(n(Gt))?.next||null);jh(R,{get getFiltredNotes(){return e.getFiltredNotes},get tag(){return n(Bt)},get nextFocusRef(){return n($)},onClosed:Z=>{x(Z)}})}};H(X,R=>{n(l)&&R(Q)})}p(t,O),he()}const ep=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Pm=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},Am=async()=>"getInstalledRelatedApps"in navigator?(await navigator?.getInstalledRelatedApps?.())?.some(e=>e.platform==="webapp")??!1:!1,Dm=()=>window.installPrompt;async function Im(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{}}function tp(t,e){ge(e,!1);let a=0;we(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),ws(),he()}var np=k('<li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li>',1),ap=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),rp=k('<div class="a p-108u1na"><button><!> <!></button> <!></div>');function op(t,e){ge(e,!0);let a=A(!1),r=A(!1);const o=Ol();let s=Un||Wn,i=T(()=>o.get());const c=()=>{n(a)||v(a,!0)},l=_=>{v(r,!0),o.set(_)},d=()=>{v(a,!1),v(r,!1)};we(()=>{const _=x=>{x.key==="Escape"&&v(r,!0)};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)});var u=rp(),f=y(u);f.__click=c,Ge(f,1,Xe({b:!0,c:!0}),"p-108u1na");var h=y(f);de(h,{name:"filter"});var m=P(h,2);ct(m,{children:(_,x)=>{var K=Me("show feed order menu");p(_,K)}});var g=P(f,2);{var w=_=>{var x=ap(),K=E(x);le(K,()=>({"--right":"0px","--top":"44px"})),zr(K.lastChild,{get startClose(){return n(r)},onClosed:d,get isMobile(){return s},children:(C,N)=>{var O=np(),U=E(O),B=y(U);{let D=T(()=>n(i)==="newest");Ie(B,{get active(){return n(D)},get dialogMode(){return s},onClick:()=>l("newest"),children:(V,ve)=>{var W=Me("Newest");p(V,W)},$$slots:{default:!0}})}var X=P(U,2),Q=y(X);{let D=T(()=>n(i)==="oldest");Ie(Q,{get active(){return n(D)},get dialogMode(){return s},onClick:()=>l("oldest"),children:(V,ve)=>{var W=Me("Oldest");p(V,W)},$$slots:{default:!0}})}var R=P(X,2),$=y(R);{let D=T(()=>n(i)==="AtoZ");Ie($,{get active(){return n(D)},get dialogMode(){return s},onClick:()=>l("AtoZ"),children:(V,ve)=>{var W=Me("A to Z");p(V,W)},$$slots:{default:!0}})}var Z=P(R,2),q=y(Z);{let D=T(()=>n(i)==="ZtoA");Ie(q,{get active(){return n(D)},get dialogMode(){return s},onClick:()=>l("ZtoA"),children:(V,ve)=>{var W=Me("Z to A");p(V,W)},$$slots:{default:!0}})}var b=P(Z,2),re=y(b);{let D=T(()=>n(i)==="updatedNewest");Ie(re,{get active(){return n(D)},get dialogMode(){return s},onClick:()=>l("updatedNewest"),children:(V,ve)=>{var W=Me("Updated");p(V,W)},$$slots:{default:!0}})}p(C,O)},$$slots:{default:!0}}),p(_,x)};H(g,_=>{n(a)&&_(w)})}p(t,u),he()}st(["click"]);const Er=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,c=a.ctrlKey,l=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!c&&!!t.shift==!!l){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var sp=k('<button class="b p-3z9gmw"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),ip=k('<div class="a p-3z9gmw"><input class="p-3z9gmw"/> <!></div>');function lp(t,e){ge(e,!0);let a=Ne(e,"value",15,""),r=Ne(e,"ref",15,null);const o=d=>{d.key==="Escape"&&(d.stopPropagation(),r()&&(e.onEscape?.(),r().blur()))};we(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=ip(),i=y(s);i.__input=d=>e.onChange?.(d.target?.value||""),Ke(i,d=>r(d),()=>r());var c=P(i,2);{var l=d=>{var u=sp();u.__click=()=>{a(""),e.onChange?.("")};var f=y(u);le(f,()=>({"--size":"20px"})),de(f.lastChild,{name:"close"});var h=P(f,2);ct(h,{children:(m,g)=>{var w=Me("Clear");p(m,w)}}),p(d,u)};H(c,d=>{a()&&d(l)})}ke(()=>tt(i,"placeholder",e.placeholder)),Wt("focus",i,function(...d){e.onFocus?.apply(this,d)}),Wt("blur",i,function(...d){e.onBlur?.apply(this,d)}),dl(i,a),p(t,s),he()}st(["input","click"]);var cp=k('<div class="a p-19o27u"><a class="b p-19o27u"><span class="c p-19o27u"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-19o27u"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function dp(t,e){ge(e,!1);const a=Ot(),{checkExistedDialog:r}=Vt(),o=()=>{a.get().length===0&&!r()&&a.push(me.NewNote)};we(()=>Er({key:"n",action:o})),ws();var s=cp(),i=y(s),c=T(()=>a.createHandleClick(me.NewNote));i.__click=function(...m){n(c)?.apply(this,m)};var l=y(i),d=y(l);le(d,()=>({"--size":"28px","--color":"#b0b0b0"})),de(d.lastChild,{name:"add"});var u=P(d,2);ct(u,{children:(m,g)=>{var w=Me("Add note");p(m,w)}});var f=P(l,2),h=y(f);le(h,()=>({"--size":"16px","--color":"#b0b0b0"})),de(h.lastChild,{name:"plus"}),ke(m=>tt(i,"href",m),[()=>a.createHref(me.NewNote)]),p(t,s),he()}st(["click"]);var up=k('<button class="a p-1cnj0y3"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function Kl(t,e){ge(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Br(),s=Ot(),{checkExistedDialog:i}=Vt();let c=T(()=>s.get().length>0||i());const l=h=>{if(h.preventDefault(),n(c))return;const m=r();m==="closed"?a():m==="opened"&&o()};var d=up();d.__click=l;var u=y(d);le(u,()=>({"--size":"28px"})),de(u.lastChild,{name:"sidebarMenu"});var f=P(u,2);ct(f,{children:(h,m)=>{var g=Me("Menu");p(h,g)}}),p(t,d),he()}st(["click"]);var fp=k('<button class="a p-tddkdb"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function vp(t,e){ge(e,!0);let a=Ne(e,"ref",15);var r=fp();r.__click=function(...i){e.onClick?.apply(this,i)};var o=y(r);le(o,()=>({"--rotate":"-90deg"})),de(o.lastChild,{name:"menu"});var s=P(o,2);ct(s,{children:(i,c)=>{var l=Me();ke(()=>at(l,e.title)),p(i,l)}}),Ke(r,i=>a(i),()=>a()),p(t,r),he()}st(["click"]);var gp=k('<div class="b p-z67y1l">Add tag for selected notes</div> <!> <div class="c p-z67y1l"><!> <!></div>',1),hp=k('<form class="a p-z67y1l"><!></form>');function pp(t,e){ge(e,!0);const a=kt(),r=Kn(),o=va(),{getFiltredNotes:s}=vr();let i=A(!1),c=A(!1),l,d=!1,u=A(null),f=A(""),h=e.nextFocusRef;we(()=>(n(u)&&n(u).focus(),()=>{l&&clearTimeout(l)}));const m=()=>{l=setTimeout(()=>{v(c,!0)},250)},g=()=>{v(i,!0)},w=async()=>{if(r.get().has(n(f).trim())){g();return}if(n(f).trim()!=="")try{m();const C=new Set(o.get()),N=C.size?[...C]:s().map(U=>U.id),{cancel:O}=await a.addTag(n(f).trim(),N);Ye("Tag added",{cancel:{nextFocusRef:h,onCancel:async()=>{await O(),setTimeout(()=>{const{prev:U}=ft(h);U?.focus()},16)}}}),d=!0}finally{v(i,!0)}},_=()=>{e.onClosed?.(d)},x=K=>{K.preventDefault(),w()};Or(t,{get blocked(){return n(c)},get startClose(){return n(i)},onClosed:_,children:(K,C)=>{var N=hp(),O=y(N);{var U=X=>{Da(X,{})},B=X=>{var Q=gp(),R=P(E(Q),2);xr(R,{placeholder:"Enter new tag name",get ref(){return n(u)},set ref(b){v(u,b,!0)},get value(){return n(f)},set value(b){v(f,b,!0)}});var $=P(R,2),Z=y($);Tt(Z,{size:"small",onClick:g,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(b,re)=>{var D=Me("Cancel");p(b,D)},$$slots:{default:!0}});var q=P(Z,2);Tt(q,{size:"small",onClick:w,fullWidth:!0,withoutMinWidth:!0,children:(b,re)=>{var D=Me("OK");p(b,D)},$$slots:{default:!0}}),p(X,Q)};H(O,X=>{n(c)?X(U):X(B,!1)})}Wt("submit",N,x),p(K,N)},$$slots:{default:!0}}),he()}var mp=k('<div class="c p-z67y1l"><!> <!></div>'),_p=k('<div class="b p-z67y1l">Change tags for selected notes</div> <!> <!>',1),wp=k('<form class="a p-z67y1l"><!></form>');function yp(t,e){ge(e,!0);const a=kt(),r=Kn(),o=va(),{getFiltredNotes:s}=vr();let i=A(!1),c=A(!1),l,d=!1,u=A(!1),f=e.nextFocusRef,m=(()=>{const U=[...r.get()],B=o.get();if(B.size===0)return U;const X=Array.from(B);let Q=new Set(a.getNoteById(X[0])?.data.tags||[]);for(let R=1;R<X.length;R++){const $=new Set(a.getNoteById(X[R])?.data.tags||[]),Z=new Set([]);$.forEach(q=>{Q.has(q)&&Z.add(q)}),Q=Z}return Array.from(Q)})(),g=A(et(m));we(()=>()=>{l&&clearTimeout(l)});const w=()=>{l=setTimeout(()=>{v(c,!0)},250)},_=()=>{v(i,!0)},x=async()=>{const U=m,B=new Set(o.get()),X=B.size?[...B]:s().map(Q=>Q.id);try{w();const{cancel:Q}=await a.changeTags([...U],n(g),X);Ye("Tags changed",{cancel:{nextFocusRef:f,onCancel:async()=>{await Q(),setTimeout(()=>{const{prev:R}=ft(f);R?.focus()},16)}}}),d=!0}finally{v(i,!0)}},K=U=>{U.key==="Escape"&&n(u)&&(v(u,!1),U.preventDefault(),U.stopPropagation())};we(()=>(document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)));const C=()=>{e.onClosed?.(d)},N=U=>{v(g,U,!0)},O=U=>{U.preventDefault(),x()};Or(t,{get blocked(){return n(c)},get startClose(){return n(i)},onClosed:C,children:(U,B)=>{var X=wp(),Q=y(X);{var R=Z=>{Da(Z,{})},$=Z=>{var q=_p(),b=P(E(q),2);Tl(b,{get selectedTags(){return n(g)},onChangeTags:N,get shownTagInput(){return n(u)},set shownTagInput(V){v(u,V,!0)}});var re=P(b,2);{var D=V=>{var ve=mp(),W=y(ve);Tt(W,{size:"small",onClick:_,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(ie,te)=>{var ee=Me("Cancel");p(ie,ee)},$$slots:{default:!0}});var ce=P(W,2);Tt(ce,{size:"small",onClick:x,fullWidth:!0,withoutMinWidth:!0,children:(ie,te)=>{var ee=Me("OK");p(ie,ee)},$$slots:{default:!0}}),p(V,ve)};H(re,V=>{n(u)||V(D)})}p(Z,q)};H(Q,Z=>{n(c)?Z(R):Z($,!1)})}Wt("submit",X,O),p(U,X)},$$slots:{default:!0}}),he()}var bp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),Sp=k('<li class="p-66dk2x"><!></li>'),kp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),Cp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),xp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Tp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),Ep=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),Np=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Pp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),Ap=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),Dp=k('<li class="p-66dk2x"><!></li>'),Ip=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),Mp=k('<li class="p-66dk2x"><!></li>'),Lp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),Rp=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <li class="p-66dk2x"><!></li>',1),Fp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),Op=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),zp=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),Bp=k('<!> <!> <li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <!> <!>',1),jp=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Hp=k('<div class="a p-66dk2x"><!></div> <!> <!> <!>',1);function Up(t,e){ge(e,!0);const a=Kn(),r=kt(),{getFiltredNotes:o}=vr(),s=va();let i=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),c=T(()=>a.get()),l=A(!1),d=A(!1),u=A(!1),f=A(!1),h=A(null),m=A(null);const g=()=>{n(l)||v(l,!0)},w=()=>{v(l,!1),v(d,!1)};Le(()=>{!n(l)&&!n(u)&&!n(f)&&v(h,ft(n(m)).next,!0)}),we(()=>{const z=G=>{G.key==="Escape"&&n(l)&&n(m)?.focus()};return window.addEventListener("keydown",z),()=>{window.removeEventListener("keydown",z)}});let _=()=>{};const x=()=>{v(d,!0),v(u,!0);let z=n(m);_=()=>{v(u,!1),setTimeout(()=>{z?.focus()},16)}};let K=()=>{};const C=()=>{v(d,!0),v(f,!0);let z=n(m);K=()=>{v(f,!1),setTimeout(()=>{z?.focus()},16)}},N=async()=>{const z=Array.from(n(c)),G=new Set(s.get()),Y=G.size?[...G]:o().map(ue=>ue.id),{cancel:ne}=await r.moveNotesToBin({noteIds:Y});a.clear(),s.clear(),Ye("Notes moved to bin",{cancel:{nextFocusRef:n(h),onCancel:async()=>{await ne(),a.set(new Set(z)),s.set(G),setTimeout(()=>{const{prev:ue}=ft(n(h));ue?.focus()},16)}}}),v(d,!0)},O=async()=>{const z=Array.from(n(c)),G=new Set(s.get()),Y=G.size?[...G]:o().map(ue=>ue.id),{cancel:ne}=await r.moveNotesToArchive({noteIds:Y});a.clear(),s.clear(),Ye("Notes moved to archive",{cancel:{nextFocusRef:n(h),onCancel:async()=>{await ne(),a.set(new Set(z)),s.set(G),setTimeout(()=>{const{prev:ue}=ft(n(h));ue?.focus()},16)}}}),v(d,!0)},U=async()=>{const z=Array.from(n(c)),G=new Set(s.get()),Y=G.size?[...G]:o().map(ue=>ue.id),{cancel:ne}=await r.moveNotesFromArchive({noteIds:Y});a.clear(),s.clear(),Ye("Notes moved from archive",{cancel:{nextFocusRef:n(h),onCancel:async()=>{await ne(),a.set(new Set(z)),s.set(G),setTimeout(()=>{const{prev:ue}=ft(n(h));ue?.focus()},16)}}}),v(d,!0)},B=async()=>{const z=Array.from(n(c)),G=new Set(s.get()),Y=G.size?[...G]:o().map(ue=>ue.id),{cancel:ne}=await r.restoreNotesFromBin({noteIds:Y});a.clear(),s.clear(),Ye("Notes restored",{cancel:{nextFocusRef:n(h),onCancel:async()=>{await ne(),a.set(new Set(z)),s.set(G),setTimeout(()=>{const{prev:ue}=ft(n(h));ue?.focus()},16)}}}),v(d,!0)},X=()=>{const z=new Set(s.get()),G=z.size?[...z]:o().map(Y=>Y.id);v(d,!0),Ka({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{v(d,!0),a.clear(),s.clear(),await r.deleteNotes({noteIds:G})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(m)?.focus()},16)}})},Q=()=>{const z=o(),G=Array.from(s.get()),Y=[];for(const ue of z)ue.data&&ue.data?.link&&Zo(ue.data?.link.url)&&(G.includes(ue.id)||G.length===0)&&Y.push(ue.data?.link.url);const ne=()=>{for(const ue of Y)if(!window.open(ue,"_blank")){Ka({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(m)?.focus()},16)}});break}};Y.length<=10?ne():Ka({title:`Are you sure to open ${Y.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{ne()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(m)?.focus()},16)}}),v(d,!0)},R=()=>{const z=o(),G=Array.from(s.get());let Y="";for(const ne of z)ne.data&&ne.data?.link&&Zo(ne.data?.link.url)&&(G.includes(ne.id)||G.length===0)&&(Y+=ne.data?.link.url+`
`);navigator.clipboard.writeText(Y),Ye("Copied links"),v(d,!0)},$=()=>{const z=o(),G=Array.from(s.get());let Y="";for(const ne of z)ne.data&&(G.includes(ne.id)||G.length===0)&&(ne.data?.link?.url&&(Y+=ne.data?.link.url+`
`),ne.data?.text&&(Y+=`
`+ne.data?.text+`
`),Y+=`---------------------

`);navigator.clipboard.writeText(Y),Ye("Copied notes"),v(d,!0)},Z=()=>{const z=o(),G=Array.from(s.get());let Y="";for(const ne of z)ne.data&&(G.includes(ne.id)||G.length===0)&&ne.data?.link?.url&&(Y+=ne.data?.link.url+`

`);navigator.share({text:Y}).catch(ne=>{ne.name}),v(d,!0)},q=()=>{const z=o(),G=Array.from(s.get());let Y="";for(const ne of z)ne.data&&(G.includes(ne.id)||G.length===0)&&(ne.data?.link?.url&&(Y+=ne.data?.link.url+`
`),ne.data?.text&&(Y+=`
`+ne.data?.text+`
`),Y+=`---------------------

`);navigator.share({text:Y}).catch(ne=>{ne.name}),v(d,!0)};let b=Un||Wn;var re=Hp(),D=E(re),V=y(D);vp(V,{title:"notes menu",onClick:g,get ref(){return n(m)},set ref(z){v(m,z,!0)}});var ve=P(D,2);{var W=z=>{var G=jp(),Y=E(G);le(Y,()=>({"--right":"0","--top":"44px"})),zr(Y.lastChild,{get startClose(){return n(d)},onClosed:w,get isMobile(){return b},children:(ne,ue)=>{var Ee=Bp(),He=E(Ee);{var nt=L=>{var M=Sp(),ae=y(M);Ie(ae,{onClick:Q,get dialogMode(){return b},children:(Ce,Se)=>{var Te=bp(),ye=E(Te);le(ye,()=>({"--size":"20px","--scale":"0.9"})),de(ye.lastChild,{name:"open"}),p(Ce,Te)},$$slots:{default:!0}}),p(L,M)};H(He,L=>{Un||Wn||L(nt)})}var _e=P(He,2);H(_e,L=>{});var Fe=P(_e,2),J=y(Fe);Ie(J,{onClick:$,get dialogMode(){return b},children:(L,M)=>{var ae=kp(),Ce=E(ae);le(Ce,()=>({"--size":"20px"})),de(Ce.lastChild,{name:"copy"}),p(L,ae)},$$slots:{default:!0}});var se=P(Fe,2),Pe=y(se);Ie(Pe,{onClick:R,get dialogMode(){return b},children:(L,M)=>{var ae=Cp(),Ce=E(ae);le(Ce,()=>({"--size":"20px"})),de(Ce.lastChild,{name:""}),p(L,ae)},$$slots:{default:!0}});var xe=P(se,2);{var pe=L=>{var M=Ep(),ae=E(M),Ce=y(ae);Ie(Ce,{onClick:q,get dialogMode(){return b},children:(ye,be)=>{var Be=xp(),Oe=E(Be);le(Oe,()=>({"--size":"20px"})),de(Oe.lastChild,{name:"share"}),p(ye,Be)},$$slots:{default:!0}});var Se=P(ae,2),Te=y(Se);Ie(Te,{onClick:Z,get dialogMode(){return b},children:(ye,be)=>{var Be=Tp(),Oe=E(Be);le(Oe,()=>({"--size":"20px"})),de(Oe.lastChild,{name:""}),p(ye,Be)},$$slots:{default:!0}}),p(L,M)};H(xe,L=>{i&&L(pe)})}var oe=P(xe,2);{var S=L=>{var M=Rp(),ae=E(M),Ce=y(ae);Ie(Ce,{onClick:x,get dialogMode(){return b},children:(Ve,it)=>{var dt=Np(),Je=E(dt);le(Je,()=>({"--size":"20px"})),de(Je.lastChild,{name:"add"}),p(Ve,dt)},$$slots:{default:!0}});var Se=P(ae,2),Te=y(Se);Ie(Te,{onClick:C,get dialogMode(){return b},children:(Ve,it)=>{var dt=Pp(),Je=E(dt);le(Je,()=>({"--size":"20px"})),de(Je.lastChild,{name:""}),p(Ve,dt)},$$slots:{default:!0}});var ye=P(Se,2);{var be=Ve=>{var it=Dp(),dt=y(it);Ie(dt,{onClick:O,get dialogMode(){return b},children:(Je,qt)=>{var Et=Ap(),Dt=E(Et);le(Dt,()=>({"--size":"20px","--scale":"0.9"})),de(Dt.lastChild,{name:"archive"}),p(Je,Et)},$$slots:{default:!0}}),p(Ve,it)},Be=Ve=>{var it=Mp(),dt=y(it);Ie(dt,{onClick:U,get dialogMode(){return b},children:(Je,qt)=>{var Et=Ip(),Dt=E(Et);le(Dt,()=>({"--size":"20px","--scale":"0.9"})),de(Dt.lastChild,{name:"archive-cancel"}),p(Je,Et)},$$slots:{default:!0}}),p(Ve,it)};H(ye,Ve=>{e.mode==="notes"?Ve(be):Ve(Be,!1)})}var Oe=P(ye,2),At=y(Oe);Ie(At,{onClick:N,get dialogMode(){return b},children:(Ve,it)=>{var dt=Lp(),Je=E(dt);le(Je,()=>({"--size":"20px"})),de(Je.lastChild,{name:"bin"}),p(Ve,dt)},$$slots:{default:!0}}),p(L,M)};H(oe,L=>{(e.mode==="notes"||e.mode==="archive")&&L(S)})}var j=P(oe,2);{var F=L=>{var M=zp(),ae=E(M),Ce=y(ae);Ie(Ce,{onClick:B,get dialogMode(){return b},children:(ye,be)=>{var Be=Fp(),Oe=E(Be);le(Oe,()=>({"--size":"20px"})),de(Oe.lastChild,{name:"bin-cancel"}),p(ye,Be)},$$slots:{default:!0}});var Se=P(ae,2),Te=y(Se);Ie(Te,{onClick:X,get dialogMode(){return b},dangerous:!0,children:(ye,be)=>{var Be=Op(),Oe=E(Be);le(Oe,()=>({"--size":"20px"})),de(Oe.lastChild,{name:"bin"}),p(ye,Be)},$$slots:{default:!0}}),p(L,M)};H(j,L=>{e.mode==="bin"&&L(F)})}p(ne,Ee)},$$slots:{default:!0}}),p(z,G)};H(ve,z=>{n(l)&&z(W)})}var ce=P(ve,2);{var ie=z=>{pp(z,{get nextFocusRef(){return n(h)},onClosed:G=>{_(G)}})};H(ce,z=>{n(u)&&z(ie)})}var te=P(ce,2);{var ee=z=>{yp(z,{get nextFocusRef(){return n(h)},onClosed:G=>{K(G)}})};H(te,z=>{n(f)&&z(ee)})}p(t,re),he()}function Wp(t,e){ge(e,!0);const a=Cn();let r=Ne(e,"animationRef",7),o=Ne(e,"dialog",7);Ll(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const d=-e.dialogWidth*.7,u=0;let f=e.sidebarState==="closed"?d:u,h=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let w=()=>1;if(r().current){r().current.pause();let _=Number(r().current.currentTime);Tr()&&(_=Number(_)+50,r().current.currentTime=Math.min(Math.max(Hn-1,_),_));const x=r().current.effect?.getComputedTiming().progress||0;w=()=>x,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(_=>requestAnimationFrame(_)),h=Math.abs(1-w())}h=e.sidebarState==="closed"?h:1-h,o().style.setProperty("--backdrop-bg",`${h*.1}`),o()&&!o().open&&(o().showModal(),Tr()&&o().getBoundingClientRect()),a.set({isSwiping:!0,duration:0,swipingRatio:h*-25});const m=h*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let g=e.sidebarState==="closed"?d:u;return e.sidebarState==="opened"||e.sidebarState==="closed"||(g=m),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:f,currentPosition:g,minPosition:d,maxPosition:u,width:e.dialogWidth}},onCancel:()=>{a.set({isSwiping:!1}),e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:d,width:u})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const f=1-Math.abs(d/u)/7*10;o().style.transform=`translate3d(${d}px, 0, 0)`,a.set({swipingRatio:f*-25}),o().style.setProperty("--backdrop-bg",`${f*.1}`)},onFinish:({swipeVelocity:d,currentPosition:u,initialPosition:f,width:h,actionThreshold:m})=>{if(a.set({isSwiping:!1}),!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let g="close";const w=Math.abs(u-f)/h*100/7*10;if(w===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(w===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?g=Math.abs(w)>m||d>ia?"open":"close":e.sidebarState==="swipingClose"&&(g=Math.abs(w)>m&&d<=ia||d<-ia?"close":"open");let _=Il(Math.abs(w)/100);e.sidebarState==="swipingClose"&&g==="close"&&(_=1-_);const K=(g==="open"?1-_:_)*Hn/1e3;a.set({duration:K}),o().style.setProperty("--transition-timing-dialog",`${K}s`),o().style.setProperty("--backdrop-bg",`${g==="open"?.1:0}`),g==="open"?e.onOpen():g==="close"&&e.onClose()}}),he()}var Vp=k("<dialog><div><!> <!></div></dialog> <!> <!>",1);function qp(t,e){ge(e,!0);const{getSidebarState:a,setSidebarState:r}=Br();let o=A(0);we(()=>{const b=()=>{v(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",b),b(),()=>{window.removeEventListener("resize",b)}});const s=Cn(),{isScrolling:i}=xs();let c=A(null),l=A(null),d={},u=T(a);const f=()=>{e.blocked||r("closing")},h=b=>{r(b==="open"?"swipingOpen":"swipingClose")},m=()=>{r("opened")},g=()=>{r("preOpening")},w=()=>{n(c)?.close(),r("closed")},_=b=>{b.preventDefault(),f()};we(()=>(n(c)?.addEventListener("close",w),n(c)?.addEventListener("cancel",_),()=>{n(c)?.removeEventListener("close",w),n(c)?.removeEventListener("cancel",_)}));const x=T(i);let K=T(()=>s.get().working);const C=b=>{b?(r("opened"),s.set({swipingRatio:-25})):(r("closed"),s.set({swipingRatio:0}),n(c)?.close()),n(c)&&(n(c).style.removeProperty("--transition-timing-dialog"),n(c).style.removeProperty("--backdrop-bg")),s.set({duration:Na().duration})};Le(()=>{n(u)==="opening"?ht(()=>{s.set({working:!0}),requestAnimationFrame(()=>{if(!n(c))return;s.set({swipingRatio:-25}),n(c).style.removeProperty("--backdrop-bg");const b=n(c).style.transform||"translate3d(-100%, 0, 0)";n(c).style.transform="";const re=n(c)?.animate([{transform:b},{transform:"translate3d(0, 0, 0)"}],{duration:s.get().duration*1e3||Hn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});d.current=re,re&&(re.onfinish=()=>{m(),s.set({swipingRatio:-25}),n(c)&&(n(c).style.removeProperty("--transition-timing-dialog"),n(c).style.removeProperty("--backdrop-bg")),s.set({duration:Na().duration}),re.cancel(),d.current=void 0})})}):n(u)==="closing"&&ht(()=>{requestAnimationFrame(()=>{if(!n(c))return;s.set({swipingRatio:0}),n(c).style.removeProperty("--backdrop-bg");const b=n(c).style.transform||"translate3d(0, 0, 0)";n(c).style.transform="";const re=n(c)?.animate([{transform:b},{transform:"translate3d(-100%, 0, 0)"}],{duration:s.get().duration*1e3||Hn,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});d.current=re,re&&(re.onfinish=()=>{w(),n(c)&&(n(c).style.removeProperty("--transition-timing-dialog"),n(c).style.removeProperty("--backdrop-bg")),s.set({duration:Na().duration}),re.cancel(),d.current=void 0})})})}),Le(()=>{n(u)==="preOpening"&&(n(c)?.open||(n(c)?.showModal(),Tr()&&n(c)?.getBoundingClientRect()),r("opening"))}),we(()=>{n(u)==="opened"&&r("preOpening")});var N=Vp(),O=E(N),U=y(O),B=y(U);Ae(B,()=>e.children);var X=P(B,2);{var Q=b=>{Co(b,{})};H(X,b=>{n(u)==="opened"&&b(Q)})}Ke(U,b=>v(l,b),()=>n(l)),Ke(O,b=>v(c,b),()=>n(c));var R=P(O,2);{var $=b=>{ks(b,{get dialog(){return n(c)},get dialogInner(){return n(l)},onClose:f})};H(R,b=>{n(l)&&n(u)==="opened"&&!e.blocked&&b($)})}var Z=P(R,2);{var q=b=>{Wp(b,{onCancelSwipe:C,onOpen:g,onClose:f,onSwipe:h,get dialogWidth(){return n(o)},get animationRef(){return d},get dialog(){return n(c)},get sidebarState(){return n(u)}})};H(Z,b=>{!n(x)&&!e.blocked&&b(q)})}ke(()=>{Ge(O,1,Xe({a:!0,b:n(K),c:n(u)==="opened"||n(u)==="opening"||n(u)==="closing"||n(u)==="swipingClose",d:n(u)==="opened"||n(u)==="opening"||n(u)==="swipingOpen"}),"p-1gucilc"),Ge(U,1,Xe({e:!0,f:n(u)==="swipingOpen",g:n(u)!=="opened"}),"p-1gucilc")}),p(t,N),he()}var Kp=k('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),Gp=k('<button><span class="b p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),Yp=k("<!> <span> </span> <!>",1),Xp=k('<div class="a p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function Sr(t,e){ge(e,!0);let a=kt(),r=A(null),o=T(Uh);const s=()=>{if(n(r)){const f=n(r).getBoundingClientRect();return{bottom:f.bottom,right:f.right,height:f.height}}return{bottom:0,right:0,height:0}},i=f=>{f.stopPropagation(),f.preventDefault(),Hh({tag:e.tag,getRect:s,focusRef:n(r)})},c=f=>{f.key==="Tab"&&!f.shiftKey&&n(o)&&(f.preventDefault(),Wh()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let l=T(()=>a.getGetMapTags()().get(e.tag)?.pinned||!1);var d=Xp(),u=y(d);le(u,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),Jn(u.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(f,h)=>{var m=Yp(),g=E(m);{var w=N=>{var O=Kp(),U=y(O);le(U,()=>({"--size":"18px"})),de(U.lastChild,{name:"pin"}),p(N,O)};H(g,N=>{n(l)&&N(w)})}var _=P(g,2),x=y(_),K=P(_,2);{var C=N=>{var O=Gp();O.__click=i,O.__keydown=c;var U=y(O),B=y(U);le(B,()=>({"--size":"16px"})),de(B.lastChild,{name:"menu"});var X=P(B,2);ct(X,{children:(Q,R)=>{var $=Me("Tag options");p(Q,$)}}),Ke(O,Q=>v(r,Q),()=>n(r)),ke(()=>Ge(O,1,Xe({c:!0,d:e.type==="selected"}),"p-9jjlcl")),p(N,O)};H(K,N=>{e.hideMenu||N(C)})}ke(()=>at(x,e.tag)),p(f,m)},$$slots:{default:!0}}),p(t,d),he()}st(["click","keydown"]);var Jp=k('<div class="b c p-32813r"><div class="d p-32813r"><button class="e p-32813r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),Zp=k('<div class="a p-32813r"><!></div>');function ui(t,e){ge(e,!0);let a=A(null);const r=l=>{v(a,l,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};Le(()=>{n(a)&&n(a).focus()});var s=Zp(),i=y(s);{var c=l=>{var d=Jp(),u=y(d),f=y(u);f.__click=o;var h=y(f);le(h,()=>({"--size":"20px"})),de(h.lastChild,{name:"close"});var m=P(h,2);ct(m,{children:(_,x)=>{var K=Me("Clear");p(_,K)}});var g=P(u,2);Bn(g,19,()=>e.metaTags,_=>"meta_"+_,(_,x,K)=>{{let C=T(()=>n(K)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);Sr(_,{hideMenu:!0,type:"selected",get tag(){return n(x)},onClick:()=>{e.handleMetaTagClick(n(x))},get onRef(){return n(C)}})}});var w=P(g,2);Bn(w,18,()=>e.selectedTags,_=>_,(_,x,K)=>{{let C=T(()=>n(K)===e.selectedTags.size-1?r:void 0);Sr(_,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return x},onClick:()=>{e.handleSelectedTagClick(x)},get onRef(){return n(C)}})}}),p(l,d)};H(i,l=>{e.selectedTags.size+e.metaTags.size>0&&l(c)})}p(t,s),he()}st(["click"]);var Qp=k('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function fi(t,e){ge(e,!0);let a=Ne(e,"mobile",3,!1);const r=kt();let s=T(()=>{const m=r.getGetMapTags()();return[...e.tags].sort((g,w)=>m.get(g)?.pinned?-1:m.get(w)?.pinned?1:g.localeCompare(w))}),i=T(()=>n(s).filter(m=>r.getGetMapTags()().get(m)?.pinned)),c=T(()=>n(s).filter(m=>!r.getGetMapTags()().get(m)?.pinned));var l=Qp(),d=y(l),u=y(d);Bn(u,16,()=>n(i),m=>m,(m,g)=>{Sr(m,{get hideMenu(){return e.hideTagMenu},get tag(){return g},onClick:()=>{e.handleTagClick(g)}})});var f=P(u,2);Bn(f,17,()=>e.metaTags,m=>"meta"+m,(m,g)=>{Sr(m,{hideMenu:!0,get tag(){return n(g)},onClick:()=>{e.handleMetaTagClick(n(g))}})});var h=P(f,2);Bn(h,16,()=>n(c),m=>m,(m,g)=>{Sr(m,{get hideMenu(){return e.hideTagMenu},get tag(){return g},onClick:()=>{e.handleTagClick(g)}})}),ke(()=>Ge(d,1,Xe({b:!0,c:a()}),"p-lawyrs")),p(t,l),he()}var $p=k('<div class="a p-17kjh8i"><div class="b p-17kjh8i"><!> <div class="c p-17kjh8i"><a class="d p-17kjh8i"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-17kjh8i"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <!></div> <!>',1),em=k('<div class="e p-17kjh8i"><div class="f p-17kjh8i"><div class="a p-17kjh8i"><!></div> <!></div></div>');function tm(t,e){ge(e,!0);const a=fa(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Br(),i=Ot(),c=fr(),l=Kn(),d=ko();let u=T(()=>l.get()),f=T(()=>d.getAll());const h=kt(),m=T(()=>h.getGetNotes()),g=b=>{l.add(b)},w=b=>{d.add(b)},_=b=>{l.remove(b)},x=b=>{d.remove(b)};let K=T(()=>n(u).size===0&&!n(f).has(Ze.INBOX)&&(n(m)()||[]).some(b=>(!n(f).has(Ze.ARCHIVED)&&!n(f).has(Ze.BIN)&&b?.data&&!b.data.deletedAt&&!b.data.archivedAt||n(f).has(Ze.ARCHIVED)&&b?.data&&!b.data.deletedAt&&b.data.archivedAt||n(f).has(Ze.BIN)&&b?.data&&b.data.deletedAt)&&b?.data?.tags.length===0)),C=T(()=>Qo(n(f),n(u),n(m)()||[],b=>!(b?.data&&(b.data.deletedAt||b.data.archivedAt)&&!n(f).has(Ze.ARCHIVED)&&!n(f).has(Ze.BIN)||b?.data&&(b.data.deletedAt||!b.data.archivedAt)&&n(f).has(Ze.ARCHIVED)||b?.data&&!b.data.deletedAt&&n(f).has(Ze.BIN)))),N=T(()=>n(C).filter(b=>c.get()===""||b.toLowerCase().indexOf(c.get().toLowerCase())!==-1)),O=T(()=>a.check());const{checkExistedDialog:U}=Vt();let B=T(()=>i.get().length>0||U());const X=()=>{if(n(O)){if(n(B))return;o()==="opened"?r():o()==="closed"&&s()}};we(()=>Er({key:"b",meta:!0,action:X})),we(()=>Er({key:"b",ctrl:!0,action:X}));let Q=T(()=>[...n(K)&&n(f).size===0?[Ze.INBOX]:[],...n(f).size===0?[...h.checkNotesInArchive()&&n(u).size===0?[Ze.ARCHIVED]:[],...h.checkNotesInBin()&&n(u).size===0?[Ze.BIN]:[]]:[]].filter(b=>c.get()===""||b.toLowerCase().indexOf(c.get().toLowerCase())!==-1).sort((b,re)=>b===Ze.INBOX?-1:re===Ze.INBOX?1:b.localeCompare(re)));var R=fe(),$=E(R);{var Z=b=>{qp(b,{get blocked(){return n(B)},children:(re,D)=>{var V=$p(),ve=E(V),W=y(ve),ce=y(W);Kl(ce,{});var ie=P(ce,2),te=y(ie),ee=T(()=>i.createHandleClick(me.Settings));te.__click=function(..._e){n(ee)?.apply(this,_e)};var z=y(te);le(z,()=>({"--size":"24px"})),de(z.lastChild,{name:"settings"});var G=P(z,2);ct(G,{children:(_e,Fe)=>{var J=Me("Settings");p(_e,J)}});var Y=P(te,2),ne=T(()=>i.createHandleClick(me.Sync));Y.__click=function(..._e){n(ne)?.apply(this,_e)};var ue=y(Y);le(ue,()=>({"--size":"24px"})),de(ue.lastChild,{name:"sync"});var Ee=P(ue,2);ct(Ee,{children:(_e,Fe)=>{var J=Me("Sync");p(_e,J)}});var He=P(W,2);{let _e=T(()=>n(f).has(Ze.BIN));ui(He,{clearTags:()=>l.clear(),clearMetaTags:()=>d.clear(),get hideTagMenu(){return n(_e)},handleMetaTagClick:x,get metaTags(){return n(f)},get selectedTags(){return n(u)},handleSelectedTagClick:_})}var nt=P(ve,2);{let _e=T(()=>n(f).has(Ze.BIN));fi(nt,{get hideTagMenu(){return n(_e)},get metaTags(){return n(Q)},get tags(){return n(N)},handleMetaTagClick:w,handleTagClick:g,mobile:!0})}ke((_e,Fe)=>{tt(te,"href",_e),tt(Y,"href",Fe)},[()=>i.createHref(me.Settings),()=>i.createHref(me.Sync)]),p(re,V)},$$slots:{default:!0}})},q=b=>{var re=em(),D=y(re),V=y(D),ve=y(V);{let ce=T(()=>n(f).has(Ze.BIN));ui(ve,{get metaTags(){return n(f)},clearTags:()=>l.clear(),clearMetaTags:()=>d.clear(),get hideTagMenu(){return n(ce)},get selectedTags(){return n(u)},handleMetaTagClick:x,handleSelectedTagClick:_})}var W=P(V,2);{let ce=T(()=>n(f).has(Ze.BIN));fi(W,{get metaTags(){return n(Q)},get hideTagMenu(){return n(ce)},get tags(){return n(N)},handleMetaTagClick:w,handleTagClick:g})}p(b,re)};H($,b=>{n(O)?b(Z):b(q,!1)})}p(t,R),he()}st(["click"]);var nm=k('<div class="g e p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),am=k('<div class="g p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),rm=k('<a class="i j p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),om=k('<div class="h p-12ns0yc"><!> <!></div>'),sm=k('<!> <div class="q p-12ns0yc"><!></div>',1),im=k('<button class="u p-12ns0yc">All</button>'),lm=k('<button class="u p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),cm=k('<div class="s p-12ns0yc"><div class="t p-12ns0yc"><!> <span> </span> <!></div> <button class="u v p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),dm=k('<div class="a p-12ns0yc"><div class="b p-12ns0yc"><div class="c p-12ns0yc"><a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-12ns0yc"><!></div> <div class="f p-12ns0yc"><!></div></div> <div class="k p-12ns0yc"><div class="l p-12ns0yc"><!></div> <div class="m p-12ns0yc"><div class="n p-12ns0yc"><div class="o p-12ns0yc"><!></div> <div class="p p-12ns0yc"><!></div></div> <div class="r p-12ns0yc"><!></div></div></div></div>');function um(t,e){ge(e,!0);const a=fr(),r=Eo();let o=T(()=>r.get());const s=kt(),i=Pt(),c=Ot(),{checkExistedDialog:l}=Vt(),d=va(),u=fa(),{getFiltredNotes:f}=vr(),h=ko();qn();let m=T(()=>h.getAll()),g=A(null);const w=T(()=>s.checkNotesInBin());let x=T(()=>{const J=f()||[],se=d.get();return J.every(Pe=>se.has(Pe.id))});const K=()=>{Ka({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await s.emptyBin(),i.replace("")},onCancel:async()=>{}})};let C=T(()=>c.get().length===0);Le(()=>{n(C)});const N=()=>{c.get().length===0&&!l()&&n(g)?.focus()};we(()=>Er({key:"k",meta:!0,action:N})),we(()=>Er({key:"k",ctrl:!0,action:N})),we(()=>{}),Le(()=>{const J=f()||[];ht(()=>{const se=d.get();d.set(new Set(J.filter(Pe=>se.has(Pe.id)).map(Pe=>Pe.id)))})});let O=T(()=>n(m).has(Ze.ARCHIVED)?"archive":n(m).has(Ze.BIN)?"bin":"notes");we(()=>{n(g)&&n(g).addEventListener("keydown",J=>{J.key==="Tab"&&ao()&&J.preventDefault()})}),Le(()=>{Ul()&&setTimeout(()=>{n(g)?.focus(),n(g)?.setSelectionRange(n(g).value.length,n(g).value.length)},0)}),we(()=>{});var U=dm(),B=y(U),X=y(B),Q=y(X),R=T(()=>c.createHandleClick(me.Settings));Q.__click=function(...J){n(R)?.apply(this,J)};var $=y(Q);le($,()=>({"--rotate":"30deg","--size":"20px"})),de($.lastChild,{name:"settings"});var Z=P(Q,2),q=T(()=>c.createHandleClick(me.Sync));Z.__click=function(...J){n(q)?.apply(this,J)};var b=y(Z);le(b,()=>({"--size":"20px"})),de(b.lastChild,{name:"sync"});var re=P(X,2),D=y(re);Kl(D,{});var V=P(re,2),ve=y(V);{var W=J=>{var se=fe(),Pe=E(se);{var xe=pe=>{var oe=fe(),S=E(oe);{var j=L=>{var M=nm(),ae=y(M);ae.__click=K;var Ce=y(ae);le(Ce,()=>({"--scale":"1.2","--size":"20px"})),de(Ce.lastChild,{name:"clear"});var Se=P(Ce);ct(Se,{children:(Te,ye)=>{var be=Me("Empty bin");p(Te,be)}}),p(L,M)},F=L=>{var M=am(),ae=y(M);ae.__click=K;var Ce=y(ae);le(Ce,()=>({"--scale":"0.9","--size":"20px"})),de(Ce.lastChild,{name:"clear"}),p(L,M)};H(S,L=>{u.check()?L(j):L(F,!1)})}p(pe,oe)};H(Pe,pe=>{n(w)&&pe(xe)})}p(J,se)},ce=J=>{var se=fe(),Pe=E(se);{var xe=pe=>{var oe=om(),S=y(oe);{var j=L=>{var M=rm();M.__click=function(...Se){e.onOpenWindow?.apply(this,Se)};var ae=y(M);le(ae,()=>({"--scale":"0.7","--size":"26px"})),de(ae.lastChild,{name:"open-window"});var Ce=P(ae,2);ct(Ce,{children:(Se,Te)=>{var ye=Me("open window");p(Se,ye)}}),ke(()=>tt(M,"href",e.openWindowHref)),p(L,M)};H(S,L=>{e.onOpenWindow&&L(j)})}var F=P(S,2);dp(F,{}),p(pe,oe)};H(Pe,pe=>{n(O)==="notes"&&pe(xe)},!0)}p(J,se)};H(ve,J=>{n(O)==="bin"?J(W):J(ce,!1)})}var ie=P(B,2),te=y(ie),ee=y(te);tm(ee,{});var z=P(te,2),G=y(z),Y=y(G),ne=y(Y);{let J=T(()=>a?.get()||"");lp(ne,{placeholder:"Search",onFocus:()=>{Un||Wn||(eh(),is(),n(g)?.setSelectionRange(n(g).value.length,n(g).value.length))},onBlur:()=>{th()},get value(){return n(J)},onChange:se=>{vn(void 0),n(o)&&n(o).scrollTo({top:0}),a?.set(se)},onEscape:()=>{vn(void 0)},get ref(){return n(g)},set ref(se){v(g,se,!0)}})}var ue=P(Y,2),Ee=y(ue);{var He=J=>{var se=sm(),Pe=E(se);op(Pe,{});var xe=P(Pe,2),pe=y(xe);Up(pe,{get mode(){return n(O)}}),p(J,se)};H(Ee,J=>{(n(O)==="notes"&&s.checkNotes()||n(O)==="bin"&&s.checkNotesInBin()||n(O)==="archive"&&s.checkNotesInArchive())&&J(He)})}var nt=P(G,2),_e=y(nt);{var Fe=J=>{var se=fe(),Pe=E(se);{var xe=pe=>{var oe=cm(),S=y(oe),j=y(S);{var F=ye=>{var be=im();be.__click=Be=>{Be.preventDefault();const Oe=f()||[];d.set(new Set(Oe.map(At=>At.id)))},p(ye,be)};H(j,ye=>{n(x)||ye(F)})}var L=P(j,2),M=y(L),ae=P(L,2);{var Ce=ye=>{var be=lm();be.__click=Oe=>{Oe.preventDefault(),d.clear()};var Be=y(be);le(Be,()=>({"--size":"16px"})),de(Be.lastChild,{name:"close"}),p(ye,be)};H(ae,ye=>{d.get().size>0&&ye(Ce)})}var Se=P(S,2);Se.__click=ye=>{ye.preventDefault(),d.disable()};var Te=y(Se);le(Te,()=>({"--size":"16px"})),de(Te.lastChild,{name:"close"}),ke(ye=>at(M,`Selected ${ye??""}`),[()=>d.get().size]),p(pe,oe)};H(Pe,pe=>{d.isEnabled()&&pe(xe)})}p(J,se)};H(_e,J=>{(n(O)==="notes"&&s.checkNotes()||n(O)==="bin"&&s.checkNotesInBin()||n(O)==="archive"&&s.checkNotesInArchive())&&J(Fe)})}ke((J,se)=>{tt(Q,"href",J),tt(Z,"href",se)},[()=>c.createHref(me.Settings),()=>c.createHref(me.Sync)]),p(t,U),he()}st(["click"]);var fm=k('<div><button class="d p-bn1wva"><!> <span class="e p-bn1wva"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),vm=k('<!> <!> <!> <!> <main><div class="a p-bn1wva"><div class="b p-bn1wva"><!></div></div> <div class="c p-bn1wva"><!></div></main> <!>',1);function gm(t,e){ge(e,!0);const a=Pt(),r=Eo(),o=Ss(),s=kt(),i=qn(),{isInited:c}=Qd(),l=Ot(),d=So(),u=d.createChannel(),{getSidebarState:f}=Br(),{setClosableDialog:h}=Vt(),{getFiltredNotes:m}=vr(),g=()=>{ep()?a.replace(`${Ht}=${me.AccountSetup}`):a.replace(`${Ht}=${me.Install}`)};we(()=>{o.init(Fe=>{Fe===void 0?g():(l.has(me.AccountSetup)&&a.replace(""),Fe?v(C,Fe):v(C,null))});const _e=async Fe=>{const J=JSON.parse(Fe.data);if(J.tabId&&J.tabId===d.tabId)return;const se=J?.msg;se.type==="initLocalAccount"||se.type==="initCloudAccount"||se.type==="updateAccount"||se.type==="disconnectCloudAccount"?a.replace(""):se.type==="exit"&&g()};return u.addEventListener(_e),()=>u.removeEventListener(_e)});const w=Cn();let _=A(!1),x=0,K=T(()=>l.get().length>0),C=T(()=>o.getAccount()),N=T(()=>s.isInitedNotes()),O=T(()=>i.isInitedSettings()),U=T(c),B=A(null);const X=()=>{n(B)&&n(B).scrollTo({top:0})};Le(()=>{h(n(C)!==void 0)}),Le(()=>{r.set(n(B))});const Q=()=>{if(n(B)){const _e=n(B).scrollTop||0;_e===0?v(_,!1):!n(_)&&x>_e?v(_,!0):n(_)&&x+50<_e&&v(_,!1),x=_e}},R=()=>{Q()};Le(()=>(n(B)?.addEventListener("scroll",R),window.addEventListener("resize",R),()=>{n(B)?.removeEventListener("scroll",R),window.removeEventListener("resize",R)}));const $=T(f);let Z=T(()=>w.get());const q=()=>{const _e=new URLSearchParams(a.get());return a.getHref(_e)},b=async _e=>{_e.preventDefault()},re=T(()=>i.getViewMode()),D=T(()=>n(re)==="popup"?{onOpenWindow:b,openWindowHref:q()}:{});var V=vm(),ve=E(V);tp(ve,{});var W=P(ve,2);Dg(W,{});var ce=P(W,2);Co(ce,{});var ie=P(ce,2);$h(ie,{get getFiltredNotes(){return m}});var te=P(ie,2),ee=y(te),z=y(ee),G=y(z);{var Y=_e=>{um(_e,Jo(()=>n(D)))};H(G,_e=>{n(N)&&n(U)&&n(O)&&n(C)!==void 0&&_e(Y)})}var ne=P(ee,2),ue=y(ne);{var Ee=_e=>{Oh(_e,Jo(()=>n(D)))};H(ue,_e=>{n(N)&&n(O)&&n(U)&&_e(Ee)})}Ke(te,_e=>v(B,_e),()=>n(B));var He=P(te,2);{var nt=_e=>{var Fe=fm(),J=y(Fe);J.__click=X;var se=y(J);ct(se,{children:(pe,oe)=>{var S=Me("top");p(pe,S)}});var Pe=P(se,2),xe=y(Pe);le(xe,()=>({"--rotate":"90deg","--size":"28px"})),de(xe.lastChild,{name:"back"}),ke(()=>{or(Fe,`--swiping-ratio: ${n(Z).swipingRatio}; --transition-timing-default: ${n(Z).duration}s;`),Ge(Fe,1,Xe({i:!0,g:n(Z).working&&!n(Z).isSwiping,j:n(K)||n($)!=="closed"}),"p-bn1wva")}),p(_e,Fe)};H(He,_e=>{n(_)&&_e(nt)})}ke(()=>{or(te,`--swiping-ratio: ${n(Z).swipingRatio}; --transition-timing-default: ${n(Z).duration}s;`),Ge(te,1,Xe({f:!0,g:n(Z).working&&!n(Z).isSwiping,h:n($)!=="closed"}),"p-bn1wva")}),p(t,V),he()}st(["click"]);const hm=[_r,En,Qe,Rt,iu,su];function pm(){return new Promise((t,e)=>{const a=indexedDB.open(ru,ou);_t(a,"upgradeneeded",()=>{const r=a.result;for(const o of hm)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),_t(a,da,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),_t(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),_t(a,ua,()=>{e()})})}function mm(t,e){ge(e,!0);let a=A(null);we(()=>{pm().then(c=>{v(a,c,!0)}).catch(c=>{})}),au({getDB:()=>n(a)});var o=fe(),s=E(o);{var i=c=>{var l=fe(),d=E(l);Ae(d,()=>e.children??Ue),p(c,l)};H(s,c=>{n(a)&&c(i)})}p(t,o),he()}function _m(t,e){ge(e,!0);let a=A("closed");dg({sidebarOpen:()=>{v(a,"preOpening")},sidebarClose:()=>{v(a,"closing")},getSidebarState:()=>n(a),setSidebarState:d=>{v(a,d,!0)}});var c=fe(),l=E(c);Ae(l,()=>e.children??Ue),p(t,c),he()}function wm(t,e){mm(t,{children:(a,r)=>{nu(a,{children:(o,s)=>{Hu(o,{children:(i,c)=>{Xv(i,{children:(l,d)=>{Uf(l,{children:(u,f)=>{Vu(u,{children:(h,m)=>{_h(h,{children:(g,w)=>{zv(g,{children:(_,x)=>{eg(_,{children:(K,C)=>{xu(K,{children:(N,O)=>{Mu(N,{children:(U,B)=>{_m(U,{children:(X,Q)=>{var R=fe(),$=E(R);Ae($,()=>e.children??Ue),p(X,R)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function ym(t,e){wm(t,{children:(a,r)=>{Eu(a,{children:(o,s)=>{yg(o,{children:(i,c)=>{ef(i,{children:(l,d)=>{af(l,{children:(u,f)=>{Ng(u,{children:(h,m)=>{Au(h,{children:(g,w)=>{zu(g,{children:(_,x)=>{bu(_,{children:(K,C)=>{kg(K,{children:(N,O)=>{Ru(N,{children:(U,B)=>{var X=fe(),Q=E(X);Ae(Q,()=>e.children??Ue),p(U,X)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}function bm(t){ym(t,{children:(e,a)=>{gm(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||Id(bm,{target:document.getElementById("app")});export{Ht as $,Me as A,Tt as B,Pt as C,Ss as D,kt as E,ws as F,xr as G,Yu as H,de as I,Wt as J,fa as K,Da as L,qn as M,Qs as N,hl as O,me as P,Em as Q,jn as R,Ke as S,Tl as T,Am as U,ct as V,Dm as W,Pm as X,Nm as Y,wf as Z,yf as _,A as a,Tr as a0,ht as a1,je as a2,Iv as a3,So as a4,xm as a5,Tm as a6,ep as a7,Cm as a8,Ne as a9,or as aa,Im as ab,y as b,le as c,P as d,p as e,k as f,n as g,he as h,H as i,E as j,at as k,Bn as l,tt as m,Ge as n,we as o,ge as p,Xe as q,st as r,v as s,ke as t,T as u,Ot as v,Vt as w,et as x,Le as y,fe as z};
