import{G as _e,p as ce,J as me,f as E,e as Te,l as y,s as g,t as ne,b as q,g as e,K as be,M as Ee,m as De,c as u,d as l,N as ke,j as de,w as ve,D as ye,n as xe,q as Oe,O as Le,h as H,r as Ce,u as we,o as le,i as C,k as f,a as Ae,I as $e,v as ee,x as W,B as ae,y as te,L as Re}from"./aDmoIl8vv.js";import{N as Ie}from"./aH1vcnSUP.js";import{S as ie}from"./aCNOKxzCY.js";import"./aCJjUmBCW.js";const Se=D=>{const s=Math.floor(Date.now()/1e3),t={};D.forEach(a=>{if(!a)return;const o=a.data.tags||["Imported"];if(o.length===0){t.ROOT||(t.ROOT=[]),t.ROOT.push(a);return}o.forEach(r=>{t[r]||(t[r]=[]),t[r].push(a)})});let i=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(t).forEach(a=>{a!=="ROOT"&&a!=="other"&&(i+=`
    <DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}">${a}</H3>
    <DL><p>`,t[a].forEach(o=>{const r=o.data.name.replace(/"/g,"&quot;");i+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||s}">${r}</A>`}),i+=`
    </DL><p>`)}),t.ROOT&&t.ROOT.forEach(a=>{const o=a.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${a.data.url}" ADD_DATE="${Math.floor(a.data.createdAt/1e3)||s}">${o}</A>`}),i+=`
</DL><p>`,t.other&&t.other.forEach(a=>{const o=a.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${a.data.url}" ADD_DATE="${Math.floor(a.data.createdAt/1e3)||s}">${o}</A>`}),i+="</DL><p>",i},He=async(D,s="")=>{const t=`${s}.json`,i=JSON.stringify({notes:D}),a=new Blob([i],{type:"application/json"}),o=URL.createObjectURL(a),r=document.createElement("a");r.href=o,r.download=t,document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(o)},0)},Me=(D,s,t)=>{s(D.target.value),t.onChange(s())};var je=E('<input class="c d p-1qofubb" type="radio"/> <label class="e p-1qofubb"> </label>',1),Pe=E('<div class="a p-1qofubb"><fieldset class="b p-1qofubb"><!> <div class="f p-1qofubb"><div class="g p-1qofubb"></div></div></fieldset></div>');function Be(D,s){const t=_e();ce(s,!0);let i=me(s,"value",7);const a=`switcher-${t}`;var o=Pe(),r=u(o),w=u(r);Te(w,17,()=>s.items,k=>k.title,(k,h)=>{var R=je(),x=y(R);x.__change=[Me,i,s];var M=g(x,2),K=u(M);ne(()=>{q(x,"id",`${e(h).title}-${t}`),q(x,"name",a),be(x,e(h).value),Ee(x,e(h).value===i()),q(x,"aria-label",e(h).title),q(M,"for",`${e(h).title}-${t}`),q(M,"title",e(h).title),q(M,"aria-label",e(h).title),De(K,e(h).title)}),l(k,R)});var _=g(w,2),$=u(_);ne(k=>ke($,k),[()=>`transform: translateX(${s.items.findIndex(k=>k.value===i())*100}%)`]),l(D,o),de()}ve(["change"]);const Fe=(D,s,t,i,a)=>{f(s,!e(s)),f(t,!1),f(i,!1),f(a,[],!0)};var Ne=E('<p class="c h p-12aanne">Exclude history</p> <div class="i p-12aanne"><!></div>',1),qe=E('<p class="c h p-12aanne">Exclude other tags</p> <div class="i p-12aanne"><!></div>',1),Ue=E('<!> <!> <p class="c h p-12aanne">Filter tags:</p> <!>',1),ze=E('<div class="j p-12aanne"><!></div>'),We=E('<div class="b p-12aanne"><h4 class="c p-12aanne">Export data</h4> <div class="d p-12aanne"><!> <p class="e p-12aanne"><!></p></div></div> <div><div class="f p-12aanne"><button class="g p-12aanne"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),Ge=E('<div class="b p-12aanne"><p class="c p-12aanne">Exporting data...</p> <!></div>'),Je=E('<div class="b p-12aanne"><p class="c k p-12aanne">Something went wrong</p></div> <div class="j p-12aanne"><!></div>',1),Ke=E('<div class="b p-12aanne"><p class="c p-12aanne">Data exported successfully!</p></div> <div class="j p-12aanne"><!></div>',1),Qe=E('<div class="a p-12aanne"><!></div>');function ea(D,s){ce(s,!0);const{getGetNotes:t}=ye(),{clearDialogPages:i}=xe(),{blockDialog:a}=Oe(),{checkMobileSize:o}=Le();let r=H("idle"),w=H("sync"),_=H(Ce([])),$=H(!1),k=H(!1),h=H(!1),R=H(!1);const x=()=>{i()};we(()=>{a(e(r)==="loading")}),le(()=>()=>{a(!1)});const M=async()=>{f(r,"loading"),setTimeout(async()=>{let m=(t()()||[]).filter(d=>d.data).filter(d=>e(_).length===0?!0:e(_).every(v=>d.data.tags.includes(v)));if(e(R)&&(m=m.map(d=>{const v={...d};return v.data={...v.data,history:[]},v})),e(h)&&(m=m.map(d=>{const v={...d};return v.data={...v.data,tags:v.data.tags.filter(T=>e(_).includes(T)),history:v.data.history.map(T=>({...T,tags:T.tags.filter(p=>e(_).includes(p))}))},v})),e(w)==="sync")await He(m,[...e(_),"notes"].join("_")).finally(async()=>{await new Promise(d=>setTimeout(d,500)),f(r,"success")});else try{const d=Se(m),v=new Blob([d],{type:"text/html"}),T=URL.createObjectURL(v),p=document.createElement("a");p.href=T,p.download=`${[...e(_),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(T),f(r,"success")}catch{f(r,"error")}},0)},K=c=>{f(_,c,!0)},re=c=>{c.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e($)&&f($,!1),document.activeElement.blur(),c.preventDefault(),c.stopPropagation())},ue=c=>{f(h,c,!0)},pe=c=>{f(R,c,!0)};le(()=>(document.addEventListener("keydown",re),()=>document.removeEventListener("keydown",re)));var se=Qe(),fe=u(se);{var ge=c=>{var m=We(),d=y(m),v=g(u(d),2),T=u(v);Be(T,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(w)},onChange:n=>{f(w,n,!0)}});var p=g(T,2),I=u(p);{var U=n=>{var b=W("App format for sync or backup");l(n,b)},Q=n=>{var b=W("Browser bookmarks format (exports only bookmarks, not notes)");l(n,b)};C(I,n=>{e(w)==="sync"?n(U):n(Q,!1)})}var V=g(d,2),O=u(V),A=u(O);A.__click=[Fe,k,R,h,_];var j=u(A);Ae(j,()=>({"--rotate":"30deg","--size":"20px"})),$e(j.lastChild,{name:"settings"});var P=g(O,2);{var S=n=>{var b=Ue(),F=y(b);{var J=L=>{var z=Ne(),Y=g(y(z),2),Z=u(Y);ie(Z,{get checked(){return e(R)},onChange:pe}),l(L,z)};C(F,L=>{e(w)==="sync"&&L(J)})}var N=g(F,2);{var oe=L=>{var z=qe(),Y=g(y(z),2),Z=u(Y);ie(Z,{get checked(){return e(h)},onChange:ue}),l(L,z)};C(N,L=>{e(_).length>0&&L(oe)})}var X=g(N,4);Ie(X,{mode:"exit",get selectedTags(){return e(_)},onChangeTags:K,get shownTagInput(){return e($)},set shownTagInput(L){f($,L,!0)}}),l(n,b)};C(P,n=>{e(k)&&n(S)})}var B=g(P,2);{var G=n=>{var b=ze(),F=u(b);{let J=te(o);ae(F,{get fullWidth(){return e(J)},onClick:M,children:(N,oe)=>{var X=W("Export");l(N,X)},$$slots:{default:!0}})}l(n,b)};C(B,n=>{e($)||n(G)})}l(c,m)},he=c=>{var m=ee(),d=y(m);{var v=p=>{var I=Ge(),U=g(u(I),2);Re(U,{}),l(p,I)},T=p=>{var I=ee(),U=y(I);{var Q=O=>{var A=Je(),j=g(y(A),2),P=u(j);{let S=te(o);ae(P,{get fullWidth(){return e(S)},onClick:()=>{f(r,"idle")},children:(B,G)=>{var n=W("Try Again");l(B,n)},$$slots:{default:!0}})}l(O,A)},V=O=>{var A=ee(),j=y(A);{var P=S=>{var B=Ke(),G=g(y(B),2),n=u(G);{let b=te(o);ae(n,{get fullWidth(){return e(b)},onClick:x,children:(F,J)=>{var N=W("Close");l(F,N)},$$slots:{default:!0}})}l(S,B)};C(j,S=>{e(r)==="success"&&S(P)},!0)}l(O,A)};C(U,O=>{e(r)==="error"?O(Q):O(V,!1)},!0)}l(p,I)};C(d,p=>{e(r)==="loading"?p(v):p(T,!1)},!0)}l(c,m)};C(fe,c=>{e(r)==="idle"?c(ge):c(he,!1)})}l(D,se),de()}ve(["click"]);export{ea as default};
