import{p as $,M as j,o as q,f as c,j as m,g as l,b as B,c as _,s as b,i as r,m as F,a as u,n as x,B as H,z as J,y as C,A as K,L as N,t as Q,q as R}from"./aCPBLQN8C.js";import{S as U}from"./aEnIjitR9.js";const V=(p,L,h={})=>{let n=null,s=[];return(...y)=>{s=y,!n&&(p(...s),n=setTimeout(()=>{if(n=null,h.trailing){p(...s);return}},L))}};var W=c("<p>Local llm model is not downloaded. Download to enable tag generation. (model size 1.5â€“2.4 GB)</p> <!>",1),X=c("<!> <p> </p>",1),Y=c("<p>Local LLM is unavailable on this platform.</p>"),Z=c('<div class="b p-7f8x00"><p class="c p-7f8x00">Local AI tags</p> <div class="d"><!></div></div>'),aa=c('<div class="a p-7f8x00"><!> <!></div>');function oa(p,L){$(L,!0);const{getGenerateTagsEnabled:h,setGenerateTagsEnabled:n}=j();let s=K(h);const y=a=>{n(a),E()};let t=B("unavailable"),M=B(0);const I=V(a=>{u(M,a,!0)},100,{trailing:!0}),E=async()=>{if(typeof LanguageModel>"u"){u(t,"unavailable");return}u(t,await LanguageModel.availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),!0),l(t)==="downloading"&&T()},T=async()=>{u(t,"downloading");try{await LanguageModel.create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],monitor(a){a.addEventListener("downloadprogress",e=>{if(e.loaded===1){u(t,"available");return}else I(Math.floor(e.loaded*100))})}})}catch{return}};q(()=>{E()});var k=aa(),A=_(k);{var S=a=>{var e=W(),i=b(x(e),2);H(i,{onClick:T,children:(d,G)=>{var o=J("Download");r(d,o)},$$slots:{default:!0}}),r(a,e)},z=a=>{var e=C(),i=x(e);{var d=o=>{var v=X(),f=x(v);N(f,{});var w=b(f,2),g=_(w);Q(()=>R(g,`downloading llm... ${l(M)??""}%`)),r(o,v)},G=o=>{var v=C(),f=x(v);{var w=g=>{var P=Y();r(g,P)};m(f,g=>{l(t)==="unavailable"&&g(w)},!0)}r(o,v)};m(i,o=>{l(t)==="downloading"?o(d):o(G,!1)},!0)}r(a,e)};m(A,a=>{l(t)==="downloadable"?a(S):a(z,!1)})}var D=b(A,2);{var O=a=>{var e=Z(),i=b(_(e),2),d=_(i);U(d,{get checked(){return l(s)},onChange:y}),r(a,e)};m(D,a=>{l(t)==="available"&&a(O)})}r(p,k),F()}export{oa as default};
