import{F as pe,p as oe,G as ge,f as D,e as me,l as w,J as te,K as ae,s as g,t as re,b as P,g as e,M as he,N as _e,m as ke,c as d,d as n,O as Te,j as le,w as ne,D as be,n as Ee,q as De,Q as ye,h as j,r as xe,u as we,o as se,i as C,k as h,a as Oe,I as Ce,v as X,x as q,B as Y,y as Z,L as Le}from"./CCTl85eR.js";import{N as Ae}from"./BoHhJ_Kh.js";import{S as $e}from"./IBuy-fqz.js";import"./Cbu1hgRI.js";const Se=_=>{const r=Math.floor(Date.now()/1e3),s={};_.forEach(t=>{if(!t)return;const o=t.data.tags||["Imported"];if(o.length===0){s.ROOT||(s.ROOT=[]),s.ROOT.push(t);return}o.forEach(a=>{s[a]||(s[a]=[]),s[a].push(t)})});let i=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(s).forEach(t=>{t!=="ROOT"&&t!=="other"&&(i+=`
    <DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}">${t}</H3>
    <DL><p>`,s[t].forEach(o=>{const a=o.data.name.replace(/"/g,"&quot;");i+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||r}">${a}</A>`}),i+=`
    </DL><p>`)}),s.ROOT&&s.ROOT.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||r}">${o}</A>`}),i+=`
</DL><p>`,s.other&&s.other.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||r}">${o}</A>`}),i+="</DL><p>",i},Re=async(_,r="")=>{const s=`${r}.json`,i=JSON.stringify({notes:_}),t=new Blob([i],{type:"application/json"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=s,document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(o)},0)},Ie=(_,r,s)=>{r(_.target.value),s.onChange(r())};var He=D('<input type="radio"/> <label> </label>',1),Me=D('<div class="wrapper svelte-yu87bd"><fieldset class="switcher svelte-yu87bd"><!> <div class="wrapSwitcherStatus svelte-yu87bd"><div class="switcherStatus svelte-yu87bd"></div></div></fieldset></div>');function Be(_,r){const s=pe();oe(r,!0);let i=ge(r,"value",7);const t=`switcher-${s}`;var o=Me(),a=d(o),L=d(a);me(L,17,()=>r.items,T=>T.title,(T,f)=>{var z=He(),b=w(z);te(b,1,ae(["vh","input"]),"svelte-yu87bd"),b.__change=[Ie,i,r];var $=g(b,2);te($,1,ae(["switcherButton"]),"svelte-yu87bd");var W=d($);re(()=>{P(b,"id",`${e(f).title}-${s}`),P(b,"name",t),he(b,e(f).value),_e(b,e(f).value===i()),P(b,"aria-label",e(f).title),P($,"for",`${e(f).title}-${s}`),P($,"title",e(f).title),P($,"aria-label",e(f).title),ke(W,e(f).title)}),n(T,z)});var k=g(L,2),A=d(k);re(T=>Te(A,T),[()=>`transform: translateX(${r.items.findIndex(T=>T.value===i())*100}%)`]),n(_,o),le()}ne(["change"]);var Fe=(_,r)=>h(r,!e(r)),Pe=D('<p class="message message__tags svelte-1rr554k">Exclude other tags</p> <div class="exclude-switcher svelte-1rr554k"><!></div>',1),je=D('<!> <p class="message message__tags svelte-1rr554k">Filter tags:</p> <!>',1),Ne=D('<div class="buttonContainer svelte-1rr554k"><!></div>'),Ue=D('<div class="top svelte-1rr554k"><h4 class="message svelte-1rr554k">Export data</h4> <div class="format-switcher svelte-1rr554k"><!> <p class="format-description svelte-1rr554k"><!></p></div></div> <div><div class="settings svelte-1rr554k"><button class="link svelte-1rr554k"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),qe=D('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Exporting data...</p> <!></div>'),ze=D('<div class="top svelte-1rr554k"><p class="message error svelte-1rr554k">Something went wrong</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),We=D('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Data exported successfully!</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),Ge=D('<div class="block svelte-1rr554k"><!></div>');function Xe(_,r){oe(r,!0);const{getGetNotes:s}=be(),{clearStackPages:i}=Ee(),{blockDialog:t}=De(),{checkMobileSize:o}=ye();let a=j("idle"),L=j("sync"),k=j(xe([])),A=j(!1),T=j(!1),f=j(!1);const z=()=>{i()};we(()=>{t(e(a)==="loading")}),se(()=>()=>{t(!1)});const b=async()=>{h(a,"loading"),setTimeout(async()=>{let E=(s()()||[]).filter(c=>c.data).filter(c=>e(k).length===0?!0:e(k).every(p=>c.data.tags.includes(p)));if(e(f)&&(E=E.map(c=>{const p={...c};return p.data={...p.data,tags:p.data.tags.filter(y=>e(k).includes(y))},p})),e(L)==="sync")await Re(E,[...e(k),"notes"].join("_")).finally(async()=>{await new Promise(c=>setTimeout(c,500)),h(a,"success")});else try{const c=Se(E),p=new Blob([c],{type:"text/html"}),y=URL.createObjectURL(p),u=document.createElement("a");u.href=y,u.download=`${[...e(k),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(y),h(a,"success")}catch(c){console.error("Error exporting as HTML:",c),h(a,"error")}},0)},$=v=>{h(k,v,!0)},W=v=>{v.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(A)&&h(A,!1),document.activeElement.blur(),v.preventDefault(),v.stopPropagation())},ie=v=>{h(f,v,!0)};se(()=>(document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)));var ee=Ge(),ce=d(ee);{var de=v=>{var E=Ue(),c=w(E),p=g(d(c),2),y=d(p);Be(y,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(L)},onChange:l=>{h(L,l,!0)}});var u=g(y,2),S=d(u);{var N=l=>{var m=q("App format for sync or backup");n(l,m)},K=l=>{var m=q("Browser bookmarks format (exports only bookmarks, not notes)");n(l,m)};C(S,l=>{e(L)==="sync"?l(N):l(K,!1)})}var V=g(c,2),x=d(V),O=d(x);O.__click=[Fe,T];var I=d(O);Oe(I,()=>({"--rotate":"30deg","--size":"20px"})),Ce(I.lastChild,{name:"settings"});var H=g(x,2);{var R=l=>{var m=je(),B=w(m);{var J=F=>{var Q=Pe(),ue=g(w(Q),2),fe=d(ue);$e(fe,{get checked(){return e(f)},onChange:ie}),n(F,Q)};C(B,F=>{e(k).length>0&&F(J)})}var U=g(B,4);Ae(U,{mode:"exit",get selectedTags(){return e(k)},onChangeTags:$,get shownTagInput(){return e(A)},set shownTagInput(F){h(A,F,!0)}}),n(l,m)};C(H,l=>{e(T)&&l(R)})}var M=g(H,2);{var G=l=>{var m=Ne(),B=d(m);{let J=Z(o);Y(B,{get fullWidth(){return e(J)},onClick:b,children:(U,F)=>{var Q=q("Export");n(U,Q)},$$slots:{default:!0}})}n(l,m)};C(M,l=>{e(A)||l(G)})}n(v,E)},ve=v=>{var E=X(),c=w(E);{var p=u=>{var S=qe(),N=g(d(S),2);Le(N,{}),n(u,S)},y=u=>{var S=X(),N=w(S);{var K=x=>{var O=ze(),I=g(w(O),2),H=d(I);{let R=Z(o);Y(H,{get fullWidth(){return e(R)},onClick:()=>{h(a,"idle")},children:(M,G)=>{var l=q("Try Again");n(M,l)},$$slots:{default:!0}})}n(x,O)},V=x=>{var O=X(),I=w(O);{var H=R=>{var M=We(),G=g(w(M),2),l=d(G);{let m=Z(o);Y(l,{get fullWidth(){return e(m)},onClick:z,children:(B,J)=>{var U=q("Close");n(B,U)},$$slots:{default:!0}})}n(R,M)};C(I,R=>{e(a)==="success"&&R(H)},!0)}n(x,O)};C(N,x=>{e(a)==="error"?x(K):x(V,!1)},!0)}n(u,S)};C(c,u=>{e(a)==="loading"?u(p):u(y,!1)},!0)}n(v,E)};C(ce,v=>{e(a)==="idle"?v(de):v(ve,!1)})}n(_,ee),le()}ne(["click"]);export{Xe as default};
