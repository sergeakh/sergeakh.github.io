import{p as j,M as q,o as F,f as m,s as p,c,g as o,A as H,j as y,b as B,i as n,m as J,a as g,n as f,B as K,z as N,y as C,L as Q,t as R,q as U}from"./a012cnrGi.js";import{S as V}from"./aC5iGw93m.js";const W=(v,_,x={})=>{let l=null,s=[];return(...b)=>{s=b,!l&&(v(...s),l=setTimeout(()=>{if(l=null,x.trailing){v(...s);return}},_))}};var X=m("<p>Local llm model is not downloaded. Download to enable tag generation. (model size 1.5â€“2.4 GB)</p> <!>",1),Y=m("<!> <p> </p>",1),Z=m("<p>Local LLM is unavailable on this platform.</p>"),ee=m('<div class="a p-7f8x00"><div class="b p-7f8x00"><p class="c p-7f8x00">Local AI tags</p> <div class="d"><!></div></div> <!></div>');function re(v,_){j(_,!0);const{getGenerateTagsEnabled:x,setGenerateTagsEnabled:l}=q();let s=H(x);const b=e=>{l(e),E()};let a=B("unknown"),M=B(0);const I=W(e=>{g(M,e,!0)},100,{trailing:!0}),E=async()=>{if(typeof LanguageModel>"u"){g(a,"unavailable");return}g(a,await LanguageModel.availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),!0),o(a)==="downloading"&&k()},k=async()=>{g(a,"downloading");try{await LanguageModel.create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],monitor(e){e.addEventListener("downloadprogress",t=>{if(t.loaded===1){g(a,"available");return}else I(Math.floor(t.loaded*100))})}})}catch{return}};F(()=>{E()});var T=ee(),A=c(T),S=p(c(A),2),z=c(S);V(z,{get checked(){return o(s)},onChange:b});var D=p(A,2);{var O=e=>{var t=X(),h=p(f(t),2);K(h,{onClick:k,children:(L,G)=>{var r=N("Download");n(L,r)},$$slots:{default:!0}}),n(e,t)},P=e=>{var t=C(),h=f(t);{var L=r=>{var i=Y(),u=f(i);Q(u,{});var w=p(u,2),d=c(w);R(()=>U(d,`downloading llm... ${o(M)??""}%`)),n(r,i)},G=r=>{var i=C(),u=f(i);{var w=d=>{var $=Z();n(d,$)};y(u,d=>{o(a)==="unavailable"&&d(w)},!0)}n(r,i)};y(h,r=>{o(a)==="downloading"?r(L):r(G,!1)},!0)}n(e,t)};y(D,e=>{o(a)==="downloadable"?e(O):e(P,!1)})}n(v,T),J()}export{re as default};
