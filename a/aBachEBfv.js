import{_ as _e,$ as ge,a0 as he,p as ae,a1 as K,K as ce,y as fe,n as I,j,i as c,m as se,f as h,d as X,a2 as me,a3 as le,I as W,g as r,A as Y,a,b as y,c as i,s as x,X as be,w as ee,x as we,O as te,F as oe,k as ie,l as de,a4 as ue,t as ne,h as ye,q as re,r as pe,a5 as Ce,a6 as xe,o as ve,N as ke}from"./aDVJRJgX9.js";const Me=[];function He(t,e=!1,u=!1){return Q(t,new Map,"",Me,null,u)}function Q(t,e,u,g,m=null,b=!1){if(typeof t=="object"&&t!==null){var w=e.get(t);if(w!==void 0)return w;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(_e(t)){var s=Array(t.length);e.set(t,s),m!==null&&e.set(m,s);for(var d=0;d<t.length;d+=1){var E=t[d];d in t&&(s[d]=Q(E,e,u,g,null,b))}return s}if(ge(t)===he){s={},e.set(t,s),m!==null&&e.set(m,s);for(var k in t)s[k]=Q(t[k],e,u,g,null,b);return s}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!b)return Q(t.toJSON(),e,u,g,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}var Ne=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Edit',1),Ee=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),Ie=h('<li class="p-1jbq6g9"><!></li> <li class="p-1jbq6g9"><!></li>',1),Te=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function qe(t,e){ae(e,!0);let u=K(e,"shownMenu",15),g=y(!1),m=y(!1),b=y(!1);const{checkMobileSize:w}=ce(),s=async()=>{e.onEdit()},d=()=>{r(m)?(a(m,!1),s()):r(b)&&(a(b,!1),e.onDelete()),u(!1),a(g,!1)};let E=Y(w);var k=fe(),T=I(k);{var H=A=>{var O=Te(),z=I(O);X(z,()=>({"--top":"90%","--right":"0px"})),me(z.lastChild,{get startClose(){return r(g)},onClosed:d,children:(q,Z)=>{var F=Ie(),B=I(F),f=i(B);le(f,{onClick:()=>{a(m,!0),a(g,!0)},get dialogMode(){return r(E)},children:(C,L)=>{var v=Ne(),p=I(v);X(p,()=>({"--size":"20px"})),W(p.lastChild,{name:"pen"}),c(C,v)},$$slots:{default:!0}});var N=x(B,2),U=i(N);le(U,{onClick:()=>{a(b,!0),a(g,!0)},get dialogMode(){return r(E)},children:(C,L)=>{var v=Ee(),p=I(v);X(p,()=>({"--size":"20px"})),W(p.lastChild,{name:"bin"}),c(C,v)},$$slots:{default:!0}}),c(q,F)},$$slots:{default:!0}}),c(A,O)};j(T,A=>{u()&&A(H)})}c(t,k),se()}var Ue=h('<div class="b p-ptbuqy"><!> <!> <div class="c p-ptbuqy"><button class="p-ptbuqy">Cancel</button> <button class="p-ptbuqy">Done</button></div></div>'),De=h('<div class="e p-ptbuqy"><!></div>'),Se=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Ae=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ze=h('<div class="d p-ptbuqy"><div><!> <a class="f p-ptbuqy" target="_blank" rel="noopener noreferrer"> </a> <div><!> <!></div> <!></div></div>'),Fe=h('<div class="g p-ptbuqy"><button class="h p-ptbuqy">Add link</button></div>'),Le=h('<div class="a p-ptbuqy"><!></div>');function Re(t,e){ae(e,!0);let u=K(e,"shownUrlInput",15);const{getFaviconEnabled:g}=be();let m=Y(g),b=y(null),w=y(null),s=y(ee(e.url)),d=y(ee(e.title)),E=y(null),k=y(null),T=y(!1);const H=f=>{a(s,f.target.value||"",!0)},A=f=>{a(d,f.target.value||"",!0)};we(()=>{u()&&r(b)?.focus()});const O=()=>{a(T,!0)},z=()=>{e.url&&(navigator.clipboard.writeText(e.url),Ce("copied"))};var q=Le(),Z=i(q);{var F=f=>{var N=Ue(),U=i(N);oe(U,{get value(){return r(s)},onInput:H,placeholder:"url",get ref(){return r(b)},set ref(_){a(b,_,!0)}});var C=x(U,2);oe(C,{get value(){return r(d)},onInput:A,placeholder:"title"});var L=x(C,2),v=i(L);v.__click=()=>{a(s,e.url,!0),a(d,e.title,!0),u(!1)};var p=x(v,2);p.__click=()=>{let _=r(s).trim();_!==""&&/^[[a-zA-Z]+?:\/\//.test(_)===!1&&(_="https://"+_,a(s,_,!0)),e.onChangeUrl(_,r(d)),u(!1)},c(f,N)},B=f=>{var N=fe(),U=I(N);{var C=v=>{var p=ze(),_=i(p);ie(_,1,de({i:!0}),"p-ptbuqy");var G=i(_);{var $=l=>{var V=De(),P=i(V);xe(P,{get url(){return e.url}}),c(l,V)};j(G,l=>{r(m)&&l($)})}var n=x(G,2),o=i(n),M=x(n,2);ie(M,1,de({j:!0}),"p-ptbuqy");var R=i(M);ue(R,{title:"copy link",elem:"button",onclick:z,children:(l,V)=>{var P=Se(),J=I(P);X(J,()=>({"--size":"20px"})),W(J.lastChild,{name:"copy"}),c(l,P)},$$slots:{default:!0}});var D=x(R,2);ue(D,{title:"show menu",elem:"button",onclick:O,get ref(){return r(k)},set ref(l){a(k,l,!0)},children:(l,V)=>{var P=Ae(),J=I(P);X(J,()=>({"--size":"18px","--rotate":"90deg"})),W(J.lastChild,{name:"menu"}),c(l,P)},$$slots:{default:!0}});var S=x(M,2);qe(S,{onDelete:()=>{a(d,""),a(s,""),e.onDeleteUrl()},onEdit:()=>{u(!0)},get shownMenu(){return r(T)},set shownMenu(l){a(T,l,!0)}}),te(_,l=>a(E,l),()=>r(E)),ne(()=>{ye(n,"href",e.url),re(o,e.title||"unknown")}),c(v,p)},L=v=>{var p=Fe(),_=i(p);_.__click=()=>{u(!0)},c(v,p)};j(U,v=>{e.url?v(C):v(L,!1)})}c(f,N)};j(Z,f=>{u()?f(F):f(B,!1)})}te(q,f=>a(w,f),()=>r(w)),c(t,q),se()}pe(["click"]);var Pe=h('<div class="e p-vlmfrv">Note</div>'),je=h("<span> </span>"),Oe=h('<div class="i p-vlmfrv"><!></div>'),Be=h('<!> <div class="a p-vlmfrv"><div class="b"><div class="c"><div class="d p-vlmfrv"><!> <div class="f p-vlmfrv" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"> </div></div></div></div> <div class="g h p-vlmfrv"><!> <div class="j p-vlmfrv"><!></div></div></div>',1);function Je(t,e){ae(e,!0);const{checkMobileSize:u}=ce();let g=K(e,"link",15,void 0),m=K(e,"text",15,""),b=K(e,"tags",31,()=>ee([])),w=y(null),s=y(!1),d=y(!1);const E=n=>{let o="",M=!0;function R(D){for(let S=0;S<D.length;S++){const l=D[S];if(l.nodeName==="BR"){o+=`
`,M=!0;continue}l.nodeName==="DIV"&&M===!1&&(o+=`
`),M=!1,l.nodeType===3&&l.textContent&&(o+=l.textContent),R(l.childNodes)}}R(n.currentTarget.childNodes),o===`
`&&(o=o.slice(0,-1)),m(o)},k=n=>{n.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(r(s)&&(a(s,!1),n.preventDefault(),n.stopPropagation()),r(d)&&(a(d,!1),n.preventDefault(),n.stopPropagation()))};ve(()=>(u(),document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)));const T=(n,o)=>{g({url:n,title:o})},H=()=>{g(void 0)},A=n=>{b(n)},O=m();ve(()=>{if(r(w)&&e.mode==="add"){r(w).focus();const n=document.createRange();n.selectNodeContents(r(w)),n.collapse(!1);const o=window.getSelection();o?.removeAllRanges(),o?.addRange(n)}});var z=Be(),q=I(z);{let n=Y(()=>g()?.url||""),o=Y(()=>g()?.title||"");Re(q,{get url(){return r(n)},get title(){return r(o)},onChangeUrl:T,onDeleteUrl:H,get shownUrlInput(){return r(d)},set shownUrlInput(M){a(d,M,!0)}})}var Z=x(q,2),F=i(Z),B=i(F),f=i(B),N=i(f);{var U=n=>{var o=Pe();c(n,o)};j(N,n=>{m()||n(U)})}var C=x(N,2);C.__input=E;var L=i(C);te(C,n=>a(w,n),()=>r(w));var v=x(F,2),p=i(v);{var _=n=>{var o=Oe(),M=i(o);{var R=D=>{var S=je(),l=i(S);ne(V=>re(l,`updated: ${V??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),c(D,S)};j(M,D=>{e.updatedAt&&D(R)})}c(n,o)};j(p,n=>{e.mode==="edit"&&n(_)})}var G=x(p,2),$=i(G);ke($,{get selectedTags(){return b()},onChangeTags:A,get shownTagInput(){return r(s)},set shownTagInput(n){a(s,n,!0)}}),ne(()=>re(L,O)),c(t,z),se()}pe(["input"]);export{Je as N,He as s};
