import{p as K,M as N,o as R,f as g,j as m,g as r,b as B,c as d,s as v,A as F,i as n,m as W,a as _,O as I,n as L,B as X,z as Y,y as O,Q as Z,L as V,t as aa,q as ea}from"./aBzlb8lPG.js";import{S}from"./av57ylxoS.js";const ta=(b,w,y={})=>{let u=null,o=null;return(...p)=>{o=p,!u&&(b(...o),o=null,u=setTimeout(()=>{if(u=null,y.trailing&&o){b(...o);return}},w))}};var ra=g('<div class="b p-7f8x00"><p class="c p-7f8x00">Local AI tags</p> <div class="d"><!></div></div>'),na=g('<div class="b p-7f8x00"><p class="c p-7f8x00">Use page data for improving ai tags</p> <div class="d"><!></div></div>'),sa=g("<p>Local llm model is not downloaded. Download to enable tag generation. (model size 1.5â€“2.4 GB)</p> <!>",1),oa=g("<!> <p> </p>",1),la=g("<p>Local LLM is unavailable on this platform.</p>"),ia=g('<div class="a p-7f8x00"><!> <!> <!></div>');function ga(b,w){K(w,!0);const{getLlmTagsEnabled:y,setLlmTagsEnabled:u,getPageDataForTagsEnabled:o,setPageDataForTagsEnabled:p}=N();let E=F(y);const $=a=>{u(a),T()};let t=B("unknown"),M=B(0);const q=ta(a=>{_(M,a,!0)},100,{trailing:!0}),T=async()=>{if(typeof LanguageModel>"u"){_(t,"unavailable");return}_(t,await I().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),!0),r(t)==="downloading"&&C()},C=async()=>{_(t,"downloading");try{await I().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],monitor(a){a.addEventListener("downloadprogress",e=>{if(e.loaded===1){_(t,"available");return}else q(Math.floor(e.loaded*100))})}})}catch(a){console.error("Error loading local LLM:",a);return}},z=a=>{if(!a){p(!1);return}Z().permissions.request({permissions:["scripting"],origins:["<all_urls>"]},e=>{p(e?a:!1)})};R(()=>{T()});var D=ia(),P=d(D);{var G=a=>{var e=ra(),l=v(d(e),2),i=d(l);S(i,{get checked(){return r(E)},onChange:$}),n(a,e)};m(P,a=>{r(t)!=="unavailable"&&r(t)!=="unknown"&&a(G)})}var A=v(P,2);{var j=a=>{var e=na(),l=v(d(e),2),i=d(l);{let x=F(o);S(i,{get checked(){return r(x)},onChange:z})}n(a,e)};m(A,a=>{r(t)!=="unavailable"&&r(t)!=="unknown"&&r(E)&&a(j)})}var Q=v(A,2);{var U=a=>{var e=sa(),l=v(L(e),2);X(l,{onClick:C,children:(i,x)=>{var s=Y("Download");n(i,s)},$$slots:{default:!0}}),n(a,e)},H=a=>{var e=O(),l=L(e);{var i=s=>{var c=oa(),h=L(c);V(h,{});var k=v(h,2),f=d(k);aa(()=>ea(f,`downloading llm... ${r(M)??""}%`)),n(s,c)},x=s=>{var c=O(),h=L(c);{var k=f=>{var J=la();n(f,J)};m(h,f=>{r(t)==="unavailable"&&f(k)},!0)}n(s,c)};m(l,s=>{r(t)==="downloading"?s(i):s(x,!1)},!0)}n(a,e)};m(Q,a=>{r(t)==="downloadable"?a(U):a(H,!1)})}n(b,D),W()}export{ga as default};
