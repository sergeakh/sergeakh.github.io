import{p as h,D as w,h as d,r as I,u as S,g as t,y as v,k as a,j as C}from"./aPaHtHcX5.js";import{N as J}from"./aCvNtv2hF.js";import"./aCa23awyZ.js";import"./aC-INMPKG.js";function B(u,g){h(g,!0);const{isInitedNotes:f,createNote:m,updateNote:N,deleteNote:y,getNoteById:p}=w();let r=d("idle"),s=d(""),i=d(""),l=d(""),n=d(""),o=d(I([]));const c=v(f),x=async()=>{if(t(i)||t(l)||t(n)||t(o).length>0){if(t(s)){const e=p(t(s));if(!e?.data)return;if((e.data.url!==t(i)||e.data.name!==t(l)||e.data.text!==t(n)||JSON.stringify(e.data.tags)!==JSON.stringify(t(o)))&&t(r)==="idle"){a(r,"loading");try{await N(t(s),{url:t(i),name:t(l),text:t(n),tags:t(o).slice()})}finally{a(r,"idle")}}}else if(t(r)==="idle"){a(r,"loading");try{a(s,await m({url:t(i),name:t(l),text:t(n),tags:t(o).slice()}),!0)}finally{a(r,"idle")}}}else if(t(s)&&t(r)==="idle"){a(r,"loading");try{await y(t(s)),a(s,"")}finally{a(r,"idle")}}};S(()=>{t(c)&&t(r)!=="loading"&&x()}),J(u,{mode:"add",get url(){return t(i)},set url(e){a(i,e,!0)},get name(){return t(l)},set name(e){a(l,e,!0)},get text(){return t(n)},set text(e){a(n,e,!0)},get tags(){return t(o)},set tags(e){a(o,e,!0)}}),C()}export{B as default};
