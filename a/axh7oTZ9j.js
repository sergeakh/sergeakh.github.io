import{a0 as _e,a1 as ge,a2 as he,p as ae,a3 as Z,N as ce,y as fe,n as I,j,i as c,m as se,f as h,d as G,a4 as me,a5 as le,I as X,g as r,A as Y,a,b as y,c as i,s as x,Z as be,w as ee,x as we,R as te,J as oe,k as ie,l as de,a6 as ue,t as ne,h as ye,q as re,r as pe,a7 as Ce,a8 as xe,o as ve,O as ke}from"./aB5r0CFx2.js";const Me=[];function Ve(t,e=!1,u=!1){return W(t,new Map,"",Me,null,u)}function W(t,e,u,g,m=null,b=!1){if(typeof t=="object"&&t!==null){var w=e.get(t);if(w!==void 0)return w;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(_e(t)){var s=Array(t.length);e.set(t,s),m!==null&&e.set(m,s);for(var d=0;d<t.length;d+=1){var E=t[d];d in t&&(s[d]=W(E,e,u,g,null,b))}return s}if(ge(t)===he){s={},e.set(t,s),m!==null&&e.set(m,s);for(var k in t)s[k]=W(t[k],e,u,g,null,b);return s}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!b)return W(t.toJSON(),e,u,g,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}var Ne=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Edit',1),Ee=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),Ie=h('<li class="p-1jbq6g9"><!></li> <li class="p-1jbq6g9"><!></li>',1),Te=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function qe(t,e){ae(e,!0);let u=Z(e,"shownMenu",15),g=y(!1),m=y(!1),b=y(!1);const{checkMobileSize:w}=ce(),s=async()=>{e.onEdit()},d=()=>{r(m)?(a(m,!1),s()):r(b)&&(a(b,!1),e.onDelete()),u(!1),a(g,!1)};let E=Y(w);var k=fe(),T=I(k);{var V=A=>{var O=Te(),R=I(O);G(R,()=>({"--top":"90%","--right":"0px"})),me(R.lastChild,{get startClose(){return r(g)},onClosed:d,children:(q,K)=>{var z=Ie(),B=I(z),f=i(B);le(f,{onClick:()=>{a(m,!0),a(g,!0)},get dialogMode(){return r(E)},children:(C,L)=>{var v=Ne(),p=I(v);G(p,()=>({"--size":"20px"})),X(p.lastChild,{name:"pen"}),c(C,v)},$$slots:{default:!0}});var N=x(B,2),U=i(N);le(U,{onClick:()=>{a(b,!0),a(g,!0)},get dialogMode(){return r(E)},children:(C,L)=>{var v=Ee(),p=I(v);G(p,()=>({"--size":"20px"})),X(p.lastChild,{name:"bin"}),c(C,v)},$$slots:{default:!0}}),c(q,z)},$$slots:{default:!0}}),c(A,O)};j(T,A=>{u()&&A(V)})}c(t,k),se()}var Ue=h('<div class="b p-ptbuqy"><!> <!> <div class="c p-ptbuqy"><button class="p-ptbuqy">Cancel</button> <button class="p-ptbuqy">Done</button></div></div>'),De=h('<div class="e p-ptbuqy"><!></div>'),Se=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Ae=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Re=h('<div class="d p-ptbuqy"><div><!> <a class="f p-ptbuqy" target="_blank" rel="noopener noreferrer"> </a> <div><!> <!></div> <!></div></div>'),ze=h('<div class="g p-ptbuqy"><button class="h p-ptbuqy">Add link</button></div>'),Le=h('<div class="a p-ptbuqy"><!></div>');function Fe(t,e){ae(e,!0);let u=Z(e,"shownUrlInput",15);const{getFaviconEnabled:g}=be();let m=Y(g),b=y(null),w=y(null),s=y(ee(e.url)),d=y(ee(e.title)),E=y(null),k=y(null),T=y(!1);const V=f=>{a(s,f.target.value||"",!0)},A=f=>{a(d,f.target.value||"",!0)};we(()=>{u()&&r(b)?.focus()});const O=()=>{a(T,!0)},R=()=>{e.url&&(navigator.clipboard.writeText(e.url),Ce("copied"))};var q=Le(),K=i(q);{var z=f=>{var N=Ue(),U=i(N);oe(U,{get value(){return r(s)},onInput:V,placeholder:"url",get ref(){return r(b)},set ref(_){a(b,_,!0)}});var C=x(U,2);oe(C,{get value(){return r(d)},onInput:A,placeholder:"title"});var L=x(C,2),v=i(L);v.__click=()=>{a(s,e.url,!0),a(d,e.title,!0),u(!1)};var p=x(v,2);p.__click=()=>{let _=r(s).trim();_!==""&&/^[[a-zA-Z]+?:\/\//.test(_)===!1&&(_="https://"+_,a(s,_,!0)),e.onChangeUrl(_,r(d)),u(!1)},c(f,N)},B=f=>{var N=fe(),U=I(N);{var C=v=>{var p=Re(),_=i(p);ie(_,1,de({i:!0}),"p-ptbuqy");var Q=i(_);{var $=l=>{var J=De(),P=i(J);xe(P,{get url(){return e.url}}),c(l,J)};j(Q,l=>{r(m)&&l($)})}var n=x(Q,2),o=i(n),M=x(n,2);ie(M,1,de({j:!0}),"p-ptbuqy");var F=i(M);ue(F,{title:"copy link",elem:"button",onclick:R,children:(l,J)=>{var P=Se(),H=I(P);G(H,()=>({"--size":"20px"})),X(H.lastChild,{name:"copy"}),c(l,P)},$$slots:{default:!0}});var D=x(F,2);ue(D,{title:"show menu",elem:"button",onclick:O,get ref(){return r(k)},set ref(l){a(k,l,!0)},children:(l,J)=>{var P=Ae(),H=I(P);G(H,()=>({"--size":"18px","--rotate":"90deg"})),X(H.lastChild,{name:"menu"}),c(l,P)},$$slots:{default:!0}});var S=x(M,2);qe(S,{onDelete:()=>{a(d,""),a(s,""),e.onDeleteUrl()},onEdit:()=>{u(!0)},get shownMenu(){return r(T)},set shownMenu(l){a(T,l,!0)}}),te(_,l=>a(E,l),()=>r(E)),ne(()=>{ye(n,"href",e.url),re(o,e.title||"unknown")}),c(v,p)},L=v=>{var p=ze(),_=i(p);_.__click=()=>{u(!0)},c(v,p)};j(U,v=>{e.url?v(C):v(L,!1)})}c(f,N)};j(K,f=>{u()?f(z):f(B,!1)})}te(q,f=>a(w,f),()=>r(w)),c(t,q),se()}pe(["click"]);var Pe=h('<div class="e p-vlmfrv">Note</div>'),je=h("<span> </span>"),Oe=h('<div class="i p-vlmfrv"><!></div>'),Be=h('<!> <div class="a p-vlmfrv"><div class="b"><div class="c"><div class="d p-vlmfrv"><!> <div class="f p-vlmfrv" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"> </div></div></div></div> <div class="g h p-vlmfrv"><!> <div class="j p-vlmfrv"><!></div></div></div>',1);function He(t,e){ae(e,!0);const{checkMobileSize:u}=ce();let g=Z(e,"link",15,void 0),m=Z(e,"text",15,""),b=Z(e,"tags",31,()=>ee([])),w=y(null),s=y(!1),d=y(!1);const E=n=>{let o="",M=!0;function F(D){for(let S=0;S<D.length;S++){const l=D[S];if(l.nodeName==="BR"){o+=`
`,M=!0;continue}l.nodeName==="DIV"&&M===!1&&(o+=`
`),M=!1,l.nodeType===3&&l.textContent&&(o+=l.textContent),F(l.childNodes)}}F(n.currentTarget.childNodes),o===`
`&&(o=o.slice(0,-1)),m(o)},k=n=>{n.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(r(s)&&(a(s,!1),n.preventDefault(),n.stopPropagation()),r(d)&&(a(d,!1),n.preventDefault(),n.stopPropagation()))};ve(()=>(u(),document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)));const T=(n,o)=>{g({url:n,title:o})},V=()=>{g(void 0)},A=n=>{b(n)},O=m();ve(()=>{if(r(w)){r(w).focus();const n=document.createRange();n.selectNodeContents(r(w)),n.collapse(!1);const o=window.getSelection();o?.removeAllRanges(),o?.addRange(n)}});var R=Be(),q=I(R);{let n=Y(()=>g()?.url||""),o=Y(()=>g()?.title||"");Fe(q,{get url(){return r(n)},get title(){return r(o)},onChangeUrl:T,onDeleteUrl:V,get shownUrlInput(){return r(d)},set shownUrlInput(M){a(d,M,!0)}})}var K=x(q,2),z=i(K),B=i(z),f=i(B),N=i(f);{var U=n=>{var o=Pe();c(n,o)};j(N,n=>{m()||n(U)})}var C=x(N,2);C.__input=E;var L=i(C);te(C,n=>a(w,n),()=>r(w));var v=x(z,2),p=i(v);{var _=n=>{var o=Oe(),M=i(o);{var F=D=>{var S=je(),l=i(S);ne(J=>re(l,`updated: ${J??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),c(D,S)};j(M,D=>{e.updatedAt&&D(F)})}c(n,o)};j(p,n=>{e.mode==="edit"&&n(_)})}var Q=x(p,2),$=i(Q);ke($,{get selectedTags(){return b()},onChangeTags:A,get shownTagInput(){return r(s)},set shownTagInput(n){a(s,n,!0)}}),ne(()=>re(L,O)),c(t,R),se()}pe(["input"]);export{He as N,Ve as s};
