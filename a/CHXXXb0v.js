import{p as H,C as J,G as K,u as P,g as t,j as w,l as r,o as Q,f as M,e as G,U as g,c as m,s as d,m as T,y as _,S as V,d as y,n as X,q as Y,r as Z,D as $,v as ee}from"./Dp1GyMqO.js";import{I as te}from"./EEzvZiDp.js";var ae=(L,s,h,k)=>{t(s)!==""&&h(t(s)),k(!1),r(s,"")},se=M('<form class="formNewTag svelte-1dwadiy"><div class="inputWrapper svelte-1dwadiy"><!></div> <button type="button" class="buttonDone svelte-1dwadiy">Done</button></form>'),ne=M('<div class="block"><div class="tags svelte-1dwadiy"><!> <!> <!> <!></div> <!></div>');function ie(L,s){H(s,!0);const{isInitedNotes:h,getGetMapTags:k}=J();let o=w(null),a=w(""),u=w(null);const O=_(h);let l=K(s,"shownTagInput",15);const f=e=>{s.selectedTags.includes(e)||(r(a,""),s.onChangeTags([...s.selectedTags,e]),t(o)?.focus())},R=e=>{const n=s.selectedTags.filter(i=>i!==e);n.length===0?s.onChangeTags([]):s.onChangeTags(n)};let N=_(()=>t(O)?[...k()().keys()].filter(e=>!s.selectedTags.some(n=>e===n)&&e!=="inbox"):[]),p=_(()=>t(N).find(e=>e.toLowerCase()===t(a).toLowerCase())||s.selectedTags.includes(t(a))),j=_(()=>t(N).filter(e=>t(a)===""?!0:e.toLowerCase().indexOf(t(a).toLowerCase())===0).slice(0,t(p)||t(a)===""?3:2));const q=e=>{e.preventDefault(),t(a)!==""?(f(t(a)),r(a,"")):l(!1)};P(()=>{t(o)&&l()&&t(o).focus(),l()||r(a,"")});const x=e=>{e.target&&t(u)&&!t(u).contains(e.target)&&(l(!1),r(a,""))};Q(()=>(document.addEventListener("click",x,{capture:!0}),()=>{document.removeEventListener("click",x,{capture:!0})}));var C=ne(),D=m(C),I=m(D);G(I,16,()=>s.selectedTags,e=>e,(e,n)=>{g(e,{get title(){return n},onClick:()=>R(n),type:"button",style:"selected"})});var S=d(I,2);{var F=e=>{var n=Y(),i=Z(n);G(i,16,()=>t(j),c=>c,(c,v)=>{g(c,{get title(){return v},onClick:()=>f(v)})}),y(e,n)};T(S,e=>{t(a)!==""&&e(F)})}var E=d(S,2);{var U=e=>{g(e,{get title(){return t(a)},onClick:()=>{f(t(a)),r(a,"")}})};T(E,e=>{!t(p)&&t(a)!==""&&e(U)})}var W=d(E,2);{var z=e=>{g(e,{onClick:()=>l(!0)})};T(W,e=>{l()||e(z)})}var A=d(D,2);{var B=e=>{var n=se(),i=m(n),c=m(i);te(c,{placeholder:"tag",get ref(){return t(o)},set ref(b){r(o,b,!0)},get value(){return t(a)},set value(b){r(a,b,!0)}});var v=d(i,2);v.__click=[ae,a,f,l],$("submit",n,q),y(e,n)};T(A,e=>{l()&&e(B)})}V(C,e=>r(u,e),()=>t(u)),y(L,C),X()}ee(["click"]);export{ie as N};
