import{F as pe,p as oe,G as ge,f as y,e as me,r as w,J as te,K as ae,s as g,t as re,b as P,g as e,M as he,N as _e,x as ke,c,d as n,O as Te,n as le,v as ne,C as be,h as Ee,i as ye,Q as De,j,k as xe,u as we,o as se,m as O,l as h,a as Ce,I as Oe,q as X,w as q,B as Y,y as Z,L as Le}from"./BL5iVsYA.js";import{N as Ae}from"./D9yh0xnD.js";import{S as $e}from"./GjzE6XPF.js";import"./DDAVkURJ.js";const Se=_=>{const r=Math.floor(Date.now()/1e3),s={};_.forEach(t=>{if(!t)return;const o=t.data.tags||["Imported"];if(o.length===0){s.ROOT||(s.ROOT=[]),s.ROOT.push(t);return}o.forEach(a=>{s[a]||(s[a]=[]),s[a].push(t)})});let i=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(s).forEach(t=>{t!=="ROOT"&&t!=="other"&&(i+=`
    <DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}">${t}</H3>
    <DL><p>`,s[t].forEach(o=>{const a=o.data.name.replace(/"/g,"&quot;");i+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||r}">${a}</A>`}),i+=`
    </DL><p>`)}),s.ROOT&&s.ROOT.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||r}">${o}</A>`}),i+=`
</DL><p>`,s.other&&s.other.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");i+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||r}">${o}</A>`}),i+="</DL><p>",i},Re=async(_,r="")=>{const s=`${r}.json`,i=JSON.stringify({notes:_}),t=new Blob([i],{type:"application/json"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=s,document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(o)},0)},Ie=(_,r,s)=>{r(_.target.value),s.onChange(r())};var He=y('<input type="radio"/> <label> </label>',1),Me=y('<div class="wrapper svelte-yu87bd"><fieldset class="switcher svelte-yu87bd"><!> <div class="wrapSwitcherStatus svelte-yu87bd"><div class="switcherStatus svelte-yu87bd"></div></div></fieldset></div>');function Be(_,r){const s=pe();oe(r,!0);let i=ge(r,"value",7);const t=`switcher-${s}`;var o=Me(),a=c(o),L=c(a);me(L,17,()=>r.items,T=>T.title,(T,f)=>{var z=He(),b=w(z);te(b,1,ae(["vh","input"]),"svelte-yu87bd"),b.__change=[Ie,i,r];var $=g(b,2);te($,1,ae(["switcherButton"]),"svelte-yu87bd");var W=c($);re(()=>{P(b,"id",`${e(f).title}-${s}`),P(b,"name",t),he(b,e(f).value),_e(b,e(f).value===i()),P(b,"aria-label",e(f).title),P($,"for",`${e(f).title}-${s}`),P($,"title",e(f).title),P($,"aria-label",e(f).title),ke(W,e(f).title)}),n(T,z)});var k=g(L,2),A=c(k);re(T=>Te(A,T),[()=>`transform: translateX(${r.items.findIndex(T=>T.value===i())*100}%)`]),n(_,o),le()}ne(["change"]);var Fe=(_,r)=>h(r,!e(r)),Pe=y('<p class="message message__tags svelte-1rr554k">Exclude other tags</p> <div class="exclude-switcher svelte-1rr554k"><!></div>',1),je=y('<!> <p class="message message__tags svelte-1rr554k">Filter tags:</p> <!>',1),Ne=y('<div class="buttonContainer svelte-1rr554k"><!></div>'),Ue=y('<div class="top svelte-1rr554k"><h4 class="message svelte-1rr554k">Export data</h4> <div class="format-switcher svelte-1rr554k"><!> <p class="format-description svelte-1rr554k"><!></p></div></div> <div><div class="settings svelte-1rr554k"><button class="link svelte-1rr554k"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),qe=y('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Exporting data...</p> <!></div>'),ze=y('<div class="top svelte-1rr554k"><p class="message error svelte-1rr554k">Something went wrong</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),We=y('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Data exported successfully!</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),Ge=y('<div class="block svelte-1rr554k"><!></div>');function Xe(_,r){oe(r,!0);const{getGetNotes:s}=be(),{clearStackPages:i}=Ee(),{blockDialog:t}=ye(),{checkMobileSize:o}=De();let a=j("idle"),L=j("sync"),k=j(xe([])),A=j(!1),T=j(!1),f=j(!1);const z=()=>{i()};we(()=>{t(e(a)==="loading")}),se(()=>()=>{t(!1)});const b=async()=>{h(a,"loading"),setTimeout(async()=>{let E=(s()()||[]).filter(v=>v.data).filter(v=>e(k).length===0?!0:e(k).every(p=>v.data.tags.includes(p)));if(e(f)&&(E=E.map(v=>{const p={...v};return p.data={...p.data,tags:p.data.tags.filter(D=>e(k).includes(D))},p})),e(L)==="sync")await Re(E,[...e(k),"notes"].join("_")).finally(async()=>{await new Promise(v=>setTimeout(v,500)),h(a,"success")});else try{const v=Se(E),p=new Blob([v],{type:"text/html"}),D=URL.createObjectURL(p),u=document.createElement("a");u.href=D,u.download=`${[...e(k),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(D),h(a,"success")}catch{h(a,"error")}},0)},$=d=>{h(k,d,!0)},W=d=>{d.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(A)&&h(A,!1),document.activeElement.blur(),d.preventDefault(),d.stopPropagation())},ie=d=>{h(f,d,!0)};se(()=>(document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)));var ee=Ge(),ce=c(ee);{var de=d=>{var E=Ue(),v=w(E),p=g(c(v),2),D=c(p);Be(D,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(L)},onChange:l=>{h(L,l,!0)}});var u=g(D,2),S=c(u);{var N=l=>{var m=q("App format for sync or backup");n(l,m)},K=l=>{var m=q("Browser bookmarks format (exports only bookmarks, not notes)");n(l,m)};O(S,l=>{e(L)==="sync"?l(N):l(K,!1)})}var V=g(v,2),x=c(V),C=c(x);C.__click=[Fe,T];var I=c(C);Ce(I,()=>({"--rotate":"30deg","--size":"20px"})),Oe(I.lastChild,{name:"settings"});var H=g(x,2);{var R=l=>{var m=je(),B=w(m);{var J=F=>{var Q=Pe(),ue=g(w(Q),2),fe=c(ue);$e(fe,{get checked(){return e(f)},onChange:ie}),n(F,Q)};O(B,F=>{e(k).length>0&&F(J)})}var U=g(B,4);Ae(U,{mode:"exit",get selectedTags(){return e(k)},onChangeTags:$,get shownTagInput(){return e(A)},set shownTagInput(F){h(A,F,!0)}}),n(l,m)};O(H,l=>{e(T)&&l(R)})}var M=g(H,2);{var G=l=>{var m=Ne(),B=c(m);{let J=Z(o);Y(B,{get fullWidth(){return e(J)},onClick:b,children:(U,F)=>{var Q=q("Export");n(U,Q)},$$slots:{default:!0}})}n(l,m)};O(M,l=>{e(A)||l(G)})}n(d,E)},ve=d=>{var E=X(),v=w(E);{var p=u=>{var S=qe(),N=g(c(S),2);Le(N,{}),n(u,S)},D=u=>{var S=X(),N=w(S);{var K=x=>{var C=ze(),I=g(w(C),2),H=c(I);{let R=Z(o);Y(H,{get fullWidth(){return e(R)},onClick:()=>{h(a,"idle")},children:(M,G)=>{var l=q("Try Again");n(M,l)},$$slots:{default:!0}})}n(x,C)},V=x=>{var C=X(),I=w(C);{var H=R=>{var M=We(),G=g(w(M),2),l=c(G);{let m=Z(o);Y(l,{get fullWidth(){return e(m)},onClick:z,children:(B,J)=>{var U=q("Close");n(B,U)},$$slots:{default:!0}})}n(R,M)};O(I,R=>{e(a)==="success"&&R(H)},!0)}n(x,C)};O(N,x=>{e(a)==="error"?x(K):x(V,!1)},!0)}n(u,S)};O(v,u=>{e(a)==="loading"?u(p):u(D,!1)},!0)}n(d,E)};O(ce,d=>{e(a)==="idle"?d(de):d(ve,!1)})}n(_,ee),le()}ne(["click"]);export{Xe as default};
