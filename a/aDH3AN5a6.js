import{G as _e,p as le,J as me,f as k,e as Te,l as O,s as f,t as re,b as N,g as e,K as be,M as Ee,m as De,c as v,d as i,N as ke,j as ie,w as ce,D as ye,n as xe,q as Oe,O as Le,h as I,r as we,u as Ae,o as oe,i as w,k as m,a as Ce,I as $e,v as X,x as z,B as Y,y as Z,L as Re}from"./aDluMktJK.js";import{N as Ie}from"./aMZqzt6Z7.js";import{S as ne}from"./aCFxum3W2.js";import"./aBUcFUk4M.js";const He=E=>{const s=Math.floor(Date.now()/1e3),r={};E.forEach(a=>{if(!a)return;const o=a.data.tags||["Imported"];if(o.length===0){r.ROOT||(r.ROOT=[]),r.ROOT.push(a);return}o.forEach(t=>{r[t]||(r[t]=[]),r[t].push(a)})});let u=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(r).forEach(a=>{a!=="ROOT"&&a!=="other"&&(u+=`
    <DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}">${a}</H3>
    <DL><p>`,r[a].forEach(o=>{const t=o.data.name.replace(/"/g,"&quot;");u+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||s}">${t}</A>`}),u+=`
    </DL><p>`)}),r.ROOT&&r.ROOT.forEach(a=>{const o=a.data.name.replace(/"/g,"&quot;");u+=`
    <DT><A HREF="${a.data.url}" ADD_DATE="${Math.floor(a.data.createdAt/1e3)||s}">${o}</A>`}),u+=`
</DL><p>`,r.other&&r.other.forEach(a=>{const o=a.data.name.replace(/"/g,"&quot;");u+=`
    <DT><A HREF="${a.data.url}" ADD_DATE="${Math.floor(a.data.createdAt/1e3)||s}">${o}</A>`}),u+="</DL><p>",u},Se=async(E,s="")=>{const r=`${s}.json`,u=JSON.stringify({notes:E}),a=new Blob([u],{type:"application/json"}),o=URL.createObjectURL(a),t=document.createElement("a");t.href=o,t.download=r,document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(o)},0)},Me=(E,s,r)=>{s(E.target.value),r.onChange(s())};var je=k('<input class="c d p-1qofubb" type="radio"/> <label class="e p-1qofubb"> </label>',1),Pe=k('<div class="a p-1qofubb"><fieldset class="b p-1qofubb"><!> <div class="f p-1qofubb"><div class="g p-1qofubb"></div></div></fieldset></div>');function Be(E,s){const r=_e();le(s,!0);let u=me(s,"value",7);const a=`switcher-${r}`;var o=Pe(),t=v(o),A=v(t);Te(A,17,()=>s.items,D=>D.title,(D,g)=>{var H=je(),y=O(H);y.__change=[Me,u,s];var S=f(y,2),J=v(S);re(()=>{N(y,"id",`${e(g).title}-${r}`),N(y,"name",a),be(y,e(g).value),Ee(y,e(g).value===u()),N(y,"aria-label",e(g).title),N(S,"for",`${e(g).title}-${r}`),N(S,"title",e(g).title),N(S,"aria-label",e(g).title),De(J,e(g).title)}),i(D,H)});var T=f(A,2),C=v(T);re(D=>ke(C,D),[()=>`transform: translateX(${s.items.findIndex(D=>D.value===u())*100}%)`]),i(E,o),ie()}ce(["change"]);var Fe=(E,s)=>m(s,!e(s)),Ne=k('<p class="c h p-12aanne">Exclude other tags</p> <div class="i p-12aanne"><!></div>',1),qe=k('<p class="c h p-12aanne">Exclude history</p> <div class="i p-12aanne"><!></div> <!> <p class="c h p-12aanne">Filter tags:</p> <!>',1),Ue=k('<div class="j p-12aanne"><!></div>'),ze=k('<div class="b p-12aanne"><h4 class="c p-12aanne">Export data</h4> <div class="d p-12aanne"><!> <p class="e p-12aanne"><!></p></div></div> <div><div class="f p-12aanne"><button class="g p-12aanne"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),We=k('<div class="b p-12aanne"><p class="c p-12aanne">Exporting data...</p> <!></div>'),Ge=k('<div class="b p-12aanne"><p class="c k p-12aanne">Something went wrong</p></div> <div class="j p-12aanne"><!></div>',1),Je=k('<div class="b p-12aanne"><p class="c p-12aanne">Data exported successfully!</p></div> <div class="j p-12aanne"><!></div>',1),Ke=k('<div class="a p-12aanne"><!></div>');function Ze(E,s){le(s,!0);const{getGetNotes:r}=ye(),{clearDialogPages:u}=xe(),{blockDialog:a}=Oe(),{checkMobileSize:o}=Le();let t=I("idle"),A=I("sync"),T=I(we([])),C=I(!1),D=I(!1),g=I(!1),H=I(!1);const y=()=>{u()};Ae(()=>{a(e(t)==="loading")}),oe(()=>()=>{a(!1)});const S=async()=>{m(t,"loading"),setTimeout(async()=>{let h=(r()()||[]).filter(l=>l.data).filter(l=>e(T).length===0?!0:e(T).every(d=>l.data.tags.includes(d)));if(e(H)&&(h=h.map(l=>{const d={...l};return d.data={...d.data,history:[]},d})),e(g)&&(h=h.map(l=>{const d={...l};return d.data={...d.data,tags:d.data.tags.filter(_=>e(T).includes(_)),history:d.data.history.map(_=>({..._,tags:_.tags.filter(p=>e(T).includes(p))}))},d})),e(A)==="sync")await Se(h,[...e(T),"notes"].join("_")).finally(async()=>{await new Promise(l=>setTimeout(l,500)),m(t,"success")});else try{const l=He(h),d=new Blob([l],{type:"text/html"}),_=URL.createObjectURL(d),p=document.createElement("a");p.href=_,p.download=`${[...e(T),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(_),m(t,"success")}catch(l){console.error("Error exporting as HTML:",l),m(t,"error")}},0)},J=c=>{m(T,c,!0)},ee=c=>{c.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(C)&&m(C,!1),document.activeElement.blur(),c.preventDefault(),c.stopPropagation())},de=c=>{m(g,c,!0)},ve=c=>{m(H,c,!0)};oe(()=>(document.addEventListener("keydown",ee),()=>document.removeEventListener("keydown",ee)));var ae=Ke(),ue=v(ae);{var pe=c=>{var h=ze(),l=O(h),d=f(v(l),2),_=v(d);Be(_,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(A)},onChange:n=>{m(A,n,!0)}});var p=f(_,2),$=v(p);{var q=n=>{var b=z("App format for sync or backup");i(n,b)},K=n=>{var b=z("Browser bookmarks format (exports only bookmarks, not notes)");i(n,b)};w($,n=>{e(A)==="sync"?n(q):n(K,!1)})}var Q=f(l,2),x=v(Q),L=v(x);L.__click=[Fe,D];var M=v(L);Ce(M,()=>({"--rotate":"30deg","--size":"20px"})),$e(M.lastChild,{name:"settings"});var j=f(x,2);{var R=n=>{var b=qe(),B=f(O(b),2),G=v(B);ne(G,{get checked(){return e(H)},onChange:ve});var F=f(B,2);{var te=U=>{var se=Ne(),ge=f(O(se),2),he=v(ge);ne(he,{get checked(){return e(g)},onChange:de}),i(U,se)};w(F,U=>{e(T).length>0&&U(te)})}var V=f(F,4);Ie(V,{mode:"exit",get selectedTags(){return e(T)},onChangeTags:J,get shownTagInput(){return e(C)},set shownTagInput(U){m(C,U,!0)}}),i(n,b)};w(j,n=>{e(D)&&n(R)})}var P=f(j,2);{var W=n=>{var b=Ue(),B=v(b);{let G=Z(o);Y(B,{get fullWidth(){return e(G)},onClick:S,children:(F,te)=>{var V=z("Export");i(F,V)},$$slots:{default:!0}})}i(n,b)};w(P,n=>{e(C)||n(W)})}i(c,h)},fe=c=>{var h=X(),l=O(h);{var d=p=>{var $=We(),q=f(v($),2);Re(q,{}),i(p,$)},_=p=>{var $=X(),q=O($);{var K=x=>{var L=Ge(),M=f(O(L),2),j=v(M);{let R=Z(o);Y(j,{get fullWidth(){return e(R)},onClick:()=>{m(t,"idle")},children:(P,W)=>{var n=z("Try Again");i(P,n)},$$slots:{default:!0}})}i(x,L)},Q=x=>{var L=X(),M=O(L);{var j=R=>{var P=Je(),W=f(O(P),2),n=v(W);{let b=Z(o);Y(n,{get fullWidth(){return e(b)},onClick:y,children:(B,G)=>{var F=z("Close");i(B,F)},$$slots:{default:!0}})}i(R,P)};w(M,R=>{e(t)==="success"&&R(j)},!0)}i(x,L)};w(q,x=>{e(t)==="error"?x(K):x(Q,!1)},!0)}i(p,$)};w(l,p=>{e(t)==="loading"?p(d):p(_,!1)},!0)}i(c,h)};w(ue,c=>{e(t)==="idle"?c(pe):c(fe,!1)})}i(E,ae),ie()}ce(["click"]);export{Ze as default};
