import{F as pe,p as oe,G as ge,f as y,e as me,l as w,J as te,K as ae,s as m,t as re,b as P,g as e,M as he,N as _e,m as ke,c as u,d as i,O as Te,j as le,w as ne,D as be,n as Ee,q as ye,Q as De,h as j,r as xe,u as we,o as se,i as C,k as _,a as Oe,I as Ce,v as X,x as q,B as Y,y as Z,L as Le}from"./C4hHpCz9.js";import{N as Ae}from"./Cw7T0KSN.js";import{S as $e}from"./_G2wi80W.js";import"./CmsNSYYP.js";const Se=k=>{const r=Math.floor(Date.now()/1e3),s={};k.forEach(t=>{if(!t)return;const o=t.data.tags||["Imported"];if(o.length===0){s.ROOT||(s.ROOT=[]),s.ROOT.push(t);return}o.forEach(a=>{s[a]||(s[a]=[]),s[a].push(t)})});let v=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(s).forEach(t=>{t!=="ROOT"&&t!=="other"&&(v+=`
    <DT><H3 ADD_DATE="${r}" LAST_MODIFIED="${r}">${t}</H3>
    <DL><p>`,s[t].forEach(o=>{const a=o.data.name.replace(/"/g,"&quot;");v+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||r}">${a}</A>`}),v+=`
    </DL><p>`)}),s.ROOT&&s.ROOT.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");v+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||r}">${o}</A>`}),v+=`
</DL><p>`,s.other&&s.other.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");v+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||r}">${o}</A>`}),v+="</DL><p>",v},Re=async(k,r="")=>{const s=`${r}.json`,v=JSON.stringify({notes:k}),t=new Blob([v],{type:"application/json"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=s,document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(o)},0)},Ie=(k,r,s)=>{r(k.target.value),s.onChange(r())};var He=y('<input type="radio"/> <label> </label>',1),Me=y('<div class="wrapper svelte-yu87bd"><fieldset class="switcher svelte-yu87bd"><!> <div class="wrapSwitcherStatus svelte-yu87bd"><div class="switcherStatus svelte-yu87bd"></div></div></fieldset></div>');function Be(k,r){const s=pe();oe(r,!0);let v=ge(r,"value",7);const t=`switcher-${s}`;var o=Me(),a=u(o),L=u(a);me(L,17,()=>r.items,T=>T.title,(T,g)=>{var z=He(),b=w(z);te(b,1,ae(["vh","input"]),"svelte-yu87bd"),b.__change=[Ie,v,r];var $=m(b,2);te($,1,ae(["switcherButton"]),"svelte-yu87bd");var W=u($);re(()=>{P(b,"id",`${e(g).title}-${s}`),P(b,"name",t),he(b,e(g).value),_e(b,e(g).value===v()),P(b,"aria-label",e(g).title),P($,"for",`${e(g).title}-${s}`),P($,"title",e(g).title),P($,"aria-label",e(g).title),ke(W,e(g).title)}),i(T,z)});var p=m(L,2),A=u(p);re(T=>Te(A,T),[()=>`transform: translateX(${r.items.findIndex(T=>T.value===v())*100}%)`]),i(k,o),le()}ne(["change"]);var Fe=(k,r)=>_(r,!e(r)),Pe=y('<p class="message message__tags svelte-1rr554k">Exclude other tags</p> <div class="exclude-switcher svelte-1rr554k"><!></div>',1),je=y('<!> <p class="message message__tags svelte-1rr554k">Filter tags:</p> <!>',1),Ne=y('<div class="buttonContainer svelte-1rr554k"><!></div>'),Ue=y('<div class="top svelte-1rr554k"><h4 class="message svelte-1rr554k">Export data</h4> <div class="format-switcher svelte-1rr554k"><!> <p class="format-description svelte-1rr554k"><!></p></div></div> <div><div class="settings svelte-1rr554k"><button class="link svelte-1rr554k"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),qe=y('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Exporting data...</p> <!></div>'),ze=y('<div class="top svelte-1rr554k"><p class="message error svelte-1rr554k">Something went wrong</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),We=y('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Data exported successfully!</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),Ge=y('<div class="block svelte-1rr554k"><!></div>');function Xe(k,r){oe(r,!0);const{getGetNotes:s}=be(),{clearStackPages:v}=Ee(),{blockDialog:t}=ye(),{checkMobileSize:o}=De();let a=j("idle"),L=j("sync"),p=j(xe([])),A=j(!1),T=j(!1),g=j(!1);const z=()=>{v()};we(()=>{t(e(a)==="loading")}),se(()=>()=>{t(!1)});const b=async()=>{_(a,"loading"),setTimeout(async()=>{let E=(s()()||[]).filter(c=>c.data).filter(c=>e(p).length===0?!0:e(p).every(d=>c.data.tags.includes(d))||e(p).every(d=>c.data.draft?.tags.includes(d)));if(e(g)&&(E=E.map(c=>{const d={...c},D=d.data.draft?{...d.data.draft,tags:(d.data.draft?.tags||[]).filter(n=>e(p).includes(n))}:void 0;return d.data={...d.data,tags:d.data.tags.filter(n=>e(p).includes(n)),draft:D},d})),e(L)==="sync")await Re(E,[...e(p),"notes"].join("_")).finally(async()=>{await new Promise(c=>setTimeout(c,500)),_(a,"success")});else try{const c=Se(E),d=new Blob([c],{type:"text/html"}),D=URL.createObjectURL(d),n=document.createElement("a");n.href=D,n.download=`${[...e(p),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(D),_(a,"success")}catch(c){console.error("Error exporting as HTML:",c),_(a,"error")}},0)},$=f=>{_(p,f,!0)},W=f=>{f.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(A)&&_(A,!1),document.activeElement.blur(),f.preventDefault(),f.stopPropagation())},ie=f=>{_(g,f,!0)};se(()=>(document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)));var ee=Ge(),ce=u(ee);{var de=f=>{var E=Ue(),c=w(E),d=m(u(c),2),D=u(d);Be(D,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(L)},onChange:l=>{_(L,l,!0)}});var n=m(D,2),S=u(n);{var N=l=>{var h=q("App format for sync or backup");i(l,h)},K=l=>{var h=q("Browser bookmarks format (exports only bookmarks, not notes)");i(l,h)};C(S,l=>{e(L)==="sync"?l(N):l(K,!1)})}var V=m(c,2),x=u(V),O=u(x);O.__click=[Fe,T];var I=u(O);Oe(I,()=>({"--rotate":"30deg","--size":"20px"})),Ce(I.lastChild,{name:"settings"});var H=m(x,2);{var R=l=>{var h=je(),B=w(h);{var J=F=>{var Q=Pe(),ue=m(w(Q),2),fe=u(ue);$e(fe,{get checked(){return e(g)},onChange:ie}),i(F,Q)};C(B,F=>{e(p).length>0&&F(J)})}var U=m(B,4);Ae(U,{mode:"exit",get selectedTags(){return e(p)},onChangeTags:$,get shownTagInput(){return e(A)},set shownTagInput(F){_(A,F,!0)}}),i(l,h)};C(H,l=>{e(T)&&l(R)})}var M=m(H,2);{var G=l=>{var h=Ne(),B=u(h);{let J=Z(o);Y(B,{get fullWidth(){return e(J)},onClick:b,children:(U,F)=>{var Q=q("Export");i(U,Q)},$$slots:{default:!0}})}i(l,h)};C(M,l=>{e(A)||l(G)})}i(f,E)},ve=f=>{var E=X(),c=w(E);{var d=n=>{var S=qe(),N=m(u(S),2);Le(N,{}),i(n,S)},D=n=>{var S=X(),N=w(S);{var K=x=>{var O=ze(),I=m(w(O),2),H=u(I);{let R=Z(o);Y(H,{get fullWidth(){return e(R)},onClick:()=>{_(a,"idle")},children:(M,G)=>{var l=q("Try Again");i(M,l)},$$slots:{default:!0}})}i(x,O)},V=x=>{var O=X(),I=w(O);{var H=R=>{var M=We(),G=m(w(M),2),l=u(G);{let h=Z(o);Y(l,{get fullWidth(){return e(h)},onClick:z,children:(B,J)=>{var U=q("Close");i(B,U)},$$slots:{default:!0}})}i(R,M)};C(I,R=>{e(a)==="success"&&R(H)},!0)}i(x,O)};C(N,x=>{e(a)==="error"?x(K):x(V,!1)},!0)}i(n,S)};C(c,n=>{e(a)==="loading"?n(d):n(D,!1)},!0)}i(f,E)};C(ce,f=>{e(a)==="idle"?f(de):f(ve,!1)})}i(k,ee),le()}ne(["click"]);export{Xe as default};
