import{G as ke,p as ce,J as Te,f as D,e as be,l as w,K as re,M as oe,s as p,t as le,b as j,g as e,N as ye,O as Ee,m as De,c as v,d as i,Q as xe,j as de,w as ve,D as we,n as Ce,q as Oe,R as Le,h as I,r as Ae,u as $e,o as ne,i as O,k as _,a as Re,I as Se,v as X,x as z,B as Y,y as Z,L as Ie}from"./aC1xpSvD-.js";import{N as He}from"./a9vnhDBJf.js";import{S as ie}from"./aDbULo4ES.js";import"./aDq3vB9Uh.js";const Me=b=>{const s=Math.floor(Date.now()/1e3),r={};b.forEach(t=>{if(!t)return;const o=t.data.tags||["Imported"];if(o.length===0){r.ROOT||(r.ROOT=[]),r.ROOT.push(t);return}o.forEach(a=>{r[a]||(r[a]=[]),r[a].push(t)})});let u=`<!DOCTYPE NETSCAPE-Note-file-1>
<!-- This is an automatically generated file.
 It will be read and overwritten.
 DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
<DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}" PERSONAL_TOOLBAR_FOLDER="true">Bookmarks bar</H3>
<DL><p>`;return Object.keys(r).forEach(t=>{t!=="ROOT"&&t!=="other"&&(u+=`
    <DT><H3 ADD_DATE="${s}" LAST_MODIFIED="${s}">${t}</H3>
    <DL><p>`,r[t].forEach(o=>{const a=o.data.name.replace(/"/g,"&quot;");u+=`
        <DT><A HREF="${o.data.url}" ADD_DATE="${Math.floor(o.data.createdAt/1e3)||s}">${a}</A>`}),u+=`
    </DL><p>`)}),r.ROOT&&r.ROOT.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");u+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||s}">${o}</A>`}),u+=`
</DL><p>`,r.other&&r.other.forEach(t=>{const o=t.data.name.replace(/"/g,"&quot;");u+=`
    <DT><A HREF="${t.data.url}" ADD_DATE="${Math.floor(t.data.createdAt/1e3)||s}">${o}</A>`}),u+="</DL><p>",u},Be=async(b,s="")=>{const r=`${s}.json`,u=JSON.stringify({notes:b}),t=new Blob([u],{type:"application/json"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=r,document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(o)},0)},Pe=(b,s,r)=>{s(b.target.value),r.onChange(s())};var Fe=D('<input type="radio"/> <label> </label>',1),Ne=D('<div class="wrapper svelte-yu87bd"><fieldset class="switcher svelte-yu87bd"><!> <div class="wrapSwitcherStatus svelte-yu87bd"><div class="switcherStatus svelte-yu87bd"></div></div></fieldset></div>');function je(b,s){const r=ke();ce(s,!0);let u=Te(s,"value",7);const t=`switcher-${r}`;var o=Ne(),a=v(o),L=v(a);be(L,17,()=>s.items,y=>y.title,(y,g)=>{var H=Fe(),E=w(H);re(E,1,oe(["vh","input"]),"svelte-yu87bd"),E.__change=[Pe,u,s];var $=p(E,2);re($,1,oe(["switcherButton"]),"svelte-yu87bd");var J=v($);le(()=>{j(E,"id",`${e(g).title}-${r}`),j(E,"name",t),ye(E,e(g).value),Ee(E,e(g).value===u()),j(E,"aria-label",e(g).title),j($,"for",`${e(g).title}-${r}`),j($,"title",e(g).title),j($,"aria-label",e(g).title),De(J,e(g).title)}),i(y,H)});var k=p(L,2),A=v(k);le(y=>xe(A,y),[()=>`transform: translateX(${s.items.findIndex(y=>y.value===u())*100}%)`]),i(b,o),de()}ve(["change"]);var Ue=(b,s)=>_(s,!e(s)),qe=D('<p class="message message__tags svelte-1rr554k">Exclude other tags</p> <div class="exclude-switcher svelte-1rr554k"><!></div>',1),ze=D('<p class="message message__tags svelte-1rr554k">Exclude history</p> <div class="exclude-switcher svelte-1rr554k"><!></div> <!> <p class="message message__tags svelte-1rr554k">Filter tags:</p> <!>',1),We=D('<div class="buttonContainer svelte-1rr554k"><!></div>'),Ge=D('<div class="top svelte-1rr554k"><h4 class="message svelte-1rr554k">Export data</h4> <div class="format-switcher svelte-1rr554k"><!> <p class="format-description svelte-1rr554k"><!></p></div></div> <div><div class="settings svelte-1rr554k"><button class="link svelte-1rr554k"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><span>Settings</span></button></div> <!> <!></div>',1),Je=D('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Exporting data...</p> <!></div>'),Qe=D('<div class="top svelte-1rr554k"><p class="message error svelte-1rr554k">Something went wrong</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),Ke=D('<div class="top svelte-1rr554k"><p class="message svelte-1rr554k">Data exported successfully!</p></div> <div class="buttonContainer svelte-1rr554k"><!></div>',1),Ve=D('<div class="block svelte-1rr554k"><!></div>');function tt(b,s){ce(s,!0);const{getGetNotes:r}=we(),{clearDialogPages:u}=Ce(),{blockDialog:t}=Oe(),{checkMobileSize:o}=Le();let a=I("idle"),L=I("sync"),k=I(Ae([])),A=I(!1),y=I(!1),g=I(!1),H=I(!1);const E=()=>{u()};$e(()=>{t(e(a)==="loading")}),ne(()=>()=>{t(!1)});const $=async()=>{_(a,"loading"),setTimeout(async()=>{let h=(r()()||[]).filter(n=>n.data).filter(n=>e(k).length===0?!0:e(k).every(d=>n.data.tags.includes(d)));if(e(H)&&(h=h.map(n=>{const d={...n};return d.data={...d.data,history:[]},d})),e(g)&&(h=h.map(n=>{const d={...n};return d.data={...d.data,tags:d.data.tags.filter(m=>e(k).includes(m)),history:d.data.history.map(m=>({...m,tags:m.tags.filter(f=>e(k).includes(f))}))},d})),e(L)==="sync")await Be(h,[...e(k),"notes"].join("_")).finally(async()=>{await new Promise(n=>setTimeout(n,500)),_(a,"success")});else try{const n=Me(h),d=new Blob([n],{type:"text/html"}),m=URL.createObjectURL(d),f=document.createElement("a");f.href=m,f.download=`${[...e(k),"bookmarks"].join("_")}bookmarks_${new Date().toLocaleDateString().replace(/\//g,"_")}.html`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(m),_(a,"success")}catch(n){console.error("Error exporting as HTML:",n),_(a,"error")}},0)},J=c=>{_(k,c,!0)},ee=c=>{c.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(A)&&_(A,!1),document.activeElement.blur(),c.preventDefault(),c.stopPropagation())},ue=c=>{_(g,c,!0)},fe=c=>{_(H,c,!0)};ne(()=>(document.addEventListener("keydown",ee),()=>document.removeEventListener("keydown",ee)));var te=Ve(),pe=v(te);{var ge=c=>{var h=Ge(),n=w(h),d=p(v(n),2),m=v(d);je(m,{items:[{title:"Sync",value:"sync"},{title:"Bookmarks",value:"bookmarks"}],get value(){return e(L)},onChange:l=>{_(L,l,!0)}});var f=p(m,2),R=v(f);{var U=l=>{var T=z("App format for sync or backup");i(l,T)},Q=l=>{var T=z("Browser bookmarks format (exports only bookmarks, not notes)");i(l,T)};O(R,l=>{e(L)==="sync"?l(U):l(Q,!1)})}var K=p(n,2),x=v(K),C=v(x);C.__click=[Ue,y];var M=v(C);Re(M,()=>({"--rotate":"30deg","--size":"20px"})),Se(M.lastChild,{name:"settings"});var B=p(x,2);{var S=l=>{var T=ze(),F=p(w(T),2),G=v(F);ie(G,{get checked(){return e(H)},onChange:fe});var N=p(F,2);{var ae=q=>{var se=qe(),me=p(w(se),2),_e=v(me);ie(_e,{get checked(){return e(g)},onChange:ue}),i(q,se)};O(N,q=>{e(k).length>0&&q(ae)})}var V=p(N,4);He(V,{mode:"exit",get selectedTags(){return e(k)},onChangeTags:J,get shownTagInput(){return e(A)},set shownTagInput(q){_(A,q,!0)}}),i(l,T)};O(B,l=>{e(y)&&l(S)})}var P=p(B,2);{var W=l=>{var T=We(),F=v(T);{let G=Z(o);Y(F,{get fullWidth(){return e(G)},onClick:$,children:(N,ae)=>{var V=z("Export");i(N,V)},$$slots:{default:!0}})}i(l,T)};O(P,l=>{e(A)||l(W)})}i(c,h)},he=c=>{var h=X(),n=w(h);{var d=f=>{var R=Je(),U=p(v(R),2);Ie(U,{}),i(f,R)},m=f=>{var R=X(),U=w(R);{var Q=x=>{var C=Qe(),M=p(w(C),2),B=v(M);{let S=Z(o);Y(B,{get fullWidth(){return e(S)},onClick:()=>{_(a,"idle")},children:(P,W)=>{var l=z("Try Again");i(P,l)},$$slots:{default:!0}})}i(x,C)},K=x=>{var C=X(),M=w(C);{var B=S=>{var P=Ke(),W=p(w(P),2),l=v(W);{let T=Z(o);Y(l,{get fullWidth(){return e(T)},onClick:E,children:(F,G)=>{var N=z("Close");i(F,N)},$$slots:{default:!0}})}i(S,P)};O(M,S=>{e(a)==="success"&&S(B)},!0)}i(x,C)};O(U,x=>{e(a)==="error"?x(Q):x(K,!1)},!0)}i(f,R)};O(n,f=>{e(a)==="loading"?f(d):f(m,!1)},!0)}i(c,h)};O(pe,c=>{e(a)==="idle"?c(ge):c(he,!1)})}i(b,te),de()}ve(["click"]);export{tt as default};
