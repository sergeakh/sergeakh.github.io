const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["a/aD-8YcqkE.js","a/aCeYg3FOS.css","a/aCdI5F8T3.js","a/a9q_jSmK4.js","a/abA9hIFUQ.js","a/aBrkJtqMH.css","a/aD_TVc_-a.js","a/aDB02xhFr.css","a/aDH7LG8g8.js","a/a54d_SC5m.css","a/aBoaAzeGE.js","a/aCpa8lgv9.js","a/afGUkjeV7.css","a/aDP7rCdoi.js","a/aiSyTfFbW.css","a/aCf5Mfyd4.js","a/af3aOGkg2.js","a/aCpd7MTd8.css","a/aMypcD0L-.js","a/aenMKNzfI.css","a/aC969LWc5.css","a/aBQuOxxoE.js","a/aCeh8XjKC.css","a/aBIYehKgB.js","a/aCBPoPn5g.css","a/aDhCG6dSi.js","a/aK1a0NeEW.css","a/aBsMXhbxL.js","a/aBem4Ctjp.css","a/aCn405ftQ.js","a/aBdnakgrk.css","a/avklwjWQm.js","a/aDzsMVVo5.css","a/aBnU4gPFj.js","a/aCH18nfIo.css","a/aDnEsNoa9.js","a/av7wFLRe1.js","a/aCb6DfA6m.css","a/aD2qv9g-e.js","a/aBlIc4kt_.css"])))=>i.map(i=>d[i]);
var xl=Object.defineProperty;var hs=t=>{throw TypeError(t)};var Tl=(t,e,a)=>e in t?xl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var jt=(t,e,a)=>Tl(t,typeof e!="symbol"?e+"":e,a),bo=(t,e,a)=>e.has(t)||hs("Cannot "+a);var V=(t,e,a)=>(bo(t,e,"read from private field"),a?a.call(t):e.get(t)),qe=(t,e,a)=>e.has(t)?hs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a),We=(t,e,a,r)=>(bo(t,e,"write to private field"),r?r.call(t,a):e.set(t,a),a),dt=(t,e,a)=>(bo(t,e,"access private method"),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const Pl=t=>{let e=localStorage.getItem("colorScheme");e!=="dark"&&e!=="light"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-color-scheme",e);const a=document.createElement("meta");a.name="theme-color",a.content=e==="dark"?"#202020":"#fff",document.head.appendChild(a),t?.(e)};Pl(t=>{const e=document.createElement("meta");e.name="apple-mobile-web-app-status-bar-style",e.content=t==="dark"?"black":"black-translucent",document.head.appendChild(e)});const El=()=>{window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.installPrompt=t})};El();const To=!1;var es=Array.isArray,Nl=Array.prototype.indexOf,ro=Array.from,Al=Object.defineProperty,ra=Object.getOwnPropertyDescriptor,Ws=Object.getOwnPropertyDescriptors,Vs=Object.prototype,Dl=Array.prototype,oo=Object.getPrototypeOf,ps=Object.isExtensible;function ir(t){return typeof t=="function"}const Je=()=>{};function Ml(t){return typeof t?.then=="function"}function Il(t){return t()}function Po(t){for(var e=0;e<t.length;e++)t[e]()}function Ks(){var t,e,a=new Promise((r,o)=>{t=r,e=o});return{promise:a,resolve:t,reject:e}}function Ll(t,e,a=!1){return t===void 0?a?e():e:t}const Nt=2,ts=4,so=8,Rl=1<<24,Gn=16,Yn=32,Da=64,io=128,vn=512,Lt=1024,qt=2048,Sn=4096,Zt=8192,Fn=16384,ns=32768,da=65536,ms=1<<17,qs=1<<18,ar=1<<19,Gs=1<<20,Rn=1<<25,Ea=32768,Eo=1<<21,as=1<<22,oa=1<<23,sa=Symbol("$state"),Ys=Symbol("legacy props"),Fl=Symbol(""),Ha=new class extends Error{constructor(){super(...arguments);jt(this,"name","StaleReactionError");jt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Xs(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ol(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function zl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Bl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function jl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Hl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ul(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Wl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Vl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Kl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function ql(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Gl=1,Yl=2,Js=4,Xl=8,Jl=16,Zl=1,Ql=2,$l=4,ec=8,tc=16,nc=1,ac=2,Pt=Symbol(),rc="http://www.w3.org/1999/xhtml";function oc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Zs(t){return t===this.v}function sc(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Qs(t){return!sc(t,this.v)}let rr=!1,ic=!1;function lc(){rr=!0}const cc=[];function ga(t,e=!1,a=!1){return Hr(t,new Map,"",cc,null,a)}function Hr(t,e,a,r,o=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(es(t)){var l=Array(t.length);e.set(t,l),o!==null&&e.set(o,l);for(var c=0;c<t.length;c+=1){var d=t[c];c in t&&(l[c]=Hr(d,e,a,r,null,s))}return l}if(oo(t)===Vs){l={},e.set(t,l),o!==null&&e.set(o,l);for(var u in t)l[u]=Hr(t[u],e,a,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return Hr(t.toJSON(),e,a,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let lt=null;function Za(t){lt=t}function gt(t){return $s().get(t)}function ht(t,e){return $s().set(t,e),e}function Ce(t,e=!1,a){lt={p:lt,i:!1,c:null,e:null,s:t,x:null,l:rr&&!e?{s:null,u:null,$:[]}:null}}function ke(t){var e=lt,a=e.e;if(a!==null){e.e=null;for(var r of a)wi(r)}return t!==void 0&&(e.x=t),e.i=!0,lt=e.p,t??{}}function or(){return!rr||lt!==null&&lt.l===null}function $s(t){return lt===null&&Xs(),lt.c??(lt.c=new Map(dc(lt)||void 0))}function dc(t){let e=t.p;for(;e!==null;){const a=e.c;if(a!==null)return a;e=e.p}return null}let _a=[];function ei(){var t=_a;_a=[],Po(t)}function Ma(t){if(_a.length===0&&!Va){var e=_a;queueMicrotask(()=>{e===_a&&ei()})}_a.push(t)}function uc(){for(;_a.length>0;)ei()}function ti(t){var e=Qe;if(e===null)return Ye.f|=oa,t;if((e.f&ns)===0){if((e.f&io)===0)throw t;e.b.error(t)}else Qa(t,e)}function Qa(t,e){for(;e!==null;){if((e.f&io)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Or=new Set;let $e=null,Ur=null,cn=null,on=[],lo=null,No=!1,Va=!1;var qa,Ga,wa,ya,kr,Ya,Xa,Et,Ao,cr,Do,ni,ai;const $r=class $r{constructor(){qe(this,Et);jt(this,"committed",!1);jt(this,"current",new Map);jt(this,"previous",new Map);qe(this,qa,new Set);qe(this,Ga,new Set);qe(this,wa,0);qe(this,ya,0);qe(this,kr,null);qe(this,Ya,new Set);qe(this,Xa,new Set);jt(this,"skipped_effects",new Set);jt(this,"is_fork",!1)}is_deferred(){return this.is_fork||V(this,ya)>0}process(e){on=[],Ur=null,this.apply();var a={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)dt(this,Et,Ao).call(this,r,a);this.is_fork||dt(this,Et,ni).call(this),this.is_deferred()?(dt(this,Et,cr).call(this,a.effects),dt(this,Et,cr).call(this,a.render_effects)):(Ur=this,$e=null,_s(a.render_effects),_s(a.effects),Ur=null,V(this,kr)?.resolve()),cn=null}capture(e,a){this.previous.has(e)||this.previous.set(e,a),(e.f&oa)===0&&(this.current.set(e,e.v),cn?.set(e,e.v))}activate(){$e=this,this.apply()}deactivate(){$e===this&&($e=null,cn=null)}flush(){if(this.activate(),on.length>0){if(oi(),$e!==null&&$e!==this)return}else V(this,wa)===0&&this.process([]);this.deactivate()}discard(){for(const e of V(this,Ga))e(this);V(this,Ga).clear()}increment(e){We(this,wa,V(this,wa)+1),e&&We(this,ya,V(this,ya)+1)}decrement(e){We(this,wa,V(this,wa)-1),e&&We(this,ya,V(this,ya)-1),this.revive()}revive(){for(const e of V(this,Ya))V(this,Xa).delete(e),Ft(e,qt),Na(e);for(const e of V(this,Xa))Ft(e,Sn),Na(e);this.flush()}oncommit(e){V(this,qa).add(e)}ondiscard(e){V(this,Ga).add(e)}settled(){return(V(this,kr)??We(this,kr,Ks())).promise}static ensure(){if($e===null){const e=$e=new $r;Or.add($e),Va||$r.enqueue(()=>{$e===e&&e.flush()})}return $e}static enqueue(e){Ma(e)}apply(){}};qa=new WeakMap,Ga=new WeakMap,wa=new WeakMap,ya=new WeakMap,kr=new WeakMap,Ya=new WeakMap,Xa=new WeakMap,Et=new WeakSet,Ao=function(e,a){e.f^=Lt;for(var r=e.first;r!==null;){var o=r.f,s=(o&(Yn|Da))!==0,i=s&&(o&Lt)!==0,l=i||(o&Zt)!==0||this.skipped_effects.has(r);if((r.f&io)!==0&&r.b?.is_pending()&&(a={parent:a,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=Lt:(o&ts)!==0?a.effects.push(r):Ar(r)&&((r.f&Gn)!==0&&V(this,Ya).add(r),wr(r));var c=r.first;if(c!==null){r=c;continue}}var d=r.parent;for(r=r.next;r===null&&d!==null;)d===a.effect&&(dt(this,Et,cr).call(this,a.effects),dt(this,Et,cr).call(this,a.render_effects),a=a.parent),r=d.next,d=d.parent}},cr=function(e){for(const a of e)(a.f&qt)!==0?V(this,Ya).add(a):(a.f&Sn)!==0&&V(this,Xa).add(a),dt(this,Et,Do).call(this,a.deps),Ft(a,Lt)},Do=function(e){if(e!==null)for(const a of e)(a.f&Nt)===0||(a.f&Ea)===0||(a.f^=Ea,dt(this,Et,Do).call(this,a.deps))},ni=function(){if(V(this,ya)===0){for(const e of V(this,qa))e();V(this,qa).clear()}V(this,wa)===0&&dt(this,Et,ai).call(this)},ai=function(){var s;if(Or.size>1){this.previous.clear();var e=cn,a=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Or){if(i===this){a=!1;continue}const l=[];for(const[d,u]of this.current){if(i.current.has(d))if(a&&u!==i.current.get(d))i.current.set(d,u);else continue;l.push(d)}if(l.length===0)continue;const c=[...i.current.keys()].filter(d=>!this.current.has(d));if(c.length>0){var o=on;on=[];const d=new Set,u=new Map;for(const v of l)si(v,c,d,u);if(on.length>0){$e=i,i.apply();for(const v of on)dt(s=i,Et,Ao).call(s,v,r);i.deactivate()}on=o}}$e=null,cn=e}this.committed=!0,Or.delete(this)};let wn=$r;function ri(t){var e=Va;Va=!0;try{for(var a;;){if(uc(),on.length===0&&($e?.flush(),on.length===0))return lo=null,a;oi()}}finally{Va=e}}function oi(){var t=Ta;No=!0;var e=null;try{var a=0;for(Yr(!0);on.length>0;){var r=wn.ensure();if(a++>1e3){var o,s;fc()}r.process(on),ia.clear()}}finally{No=!1,Yr(t),lo=null}}function fc(){try{Hl()}catch(t){Qa(t,lo)}}let Dn=null;function _s(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Fn|Zt))===0&&Ar(r)&&(Dn=new Set,wr(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Si(r):r.fn=null),Dn?.size>0)){ia.clear();for(const o of Dn){if((o.f&(Fn|Zt))!==0)continue;const s=[o];let i=o.parent;for(;i!==null;)Dn.has(i)&&(Dn.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const c=s[l];(c.f&(Fn|Zt))===0&&wr(c)}}Dn.clear()}}Dn=null}}function si(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const o of t.reactions){const s=o.f;(s&Nt)!==0?si(o,e,a,r):(s&(as|Gn))!==0&&(s&qt)===0&&ii(o,e,r)&&(Ft(o,qt),Na(o))}}function ii(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const o of t.deps){if(e.includes(o))return!0;if((o.f&Nt)!==0&&ii(o,e,a))return a.set(o,!0),!0}return a.set(t,!1),!1}function Na(t){for(var e=lo=t;e.parent!==null;){e=e.parent;var a=e.f;if(No&&e===Qe&&(a&Gn)!==0&&(a&qs)===0)return;if((a&(Da|Yn))!==0){if((a&Lt)===0)return;e.f^=Lt}}on.push(e)}function vc(t){let e=0,a=Cn(0),r;return()=>{mr()&&(n(a),uo(()=>(e===0&&(r=Ct(()=>t(()=>la(a)))),e+=1,()=>{Ma(()=>{e-=1,e===0&&(r?.(),r=void 0,la(a))})})))}}var gc=da|ar|io;function hc(t,e,a){new pc(t,e,a)}var nn,an,$o,hn,ba,pn,rn,Wt,mn,Ln,$n,Sa,ea,Ca,ta,eo,Tt,mc,_c,Mo,Wr,Vr,Io;class pc{constructor(e,a,r){qe(this,Tt);jt(this,"parent");qe(this,nn,!1);qe(this,an);qe(this,$o,null);qe(this,hn);qe(this,ba);qe(this,pn);qe(this,rn,null);qe(this,Wt,null);qe(this,mn,null);qe(this,Ln,null);qe(this,$n,null);qe(this,Sa,0);qe(this,ea,0);qe(this,Ca,!1);qe(this,ta,null);qe(this,eo,vc(()=>(We(this,ta,Cn(V(this,Sa))),()=>{We(this,ta,null)})));We(this,an,e),We(this,hn,a),We(this,ba,r),this.parent=Qe.b,We(this,nn,!!V(this,hn).pending),We(this,pn,sr(()=>{Qe.b=this;{var o=dt(this,Tt,Mo).call(this);try{We(this,rn,sn(()=>r(o)))}catch(s){this.error(s)}V(this,ea)>0?dt(this,Tt,Vr).call(this):We(this,nn,!1)}return()=>{V(this,$n)?.remove()}},gc))}is_pending(){return V(this,nn)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!V(this,hn).pending}update_pending_count(e){dt(this,Tt,Io).call(this,e),We(this,Sa,V(this,Sa)+e),V(this,ta)&&On(V(this,ta),V(this,Sa))}get_effect_pending(){return V(this,eo).call(this),n(V(this,ta))}error(e){var a=V(this,hn).onerror;let r=V(this,hn).failed;if(V(this,Ca)||!a&&!r)throw e;V(this,rn)&&(Kt(V(this,rn)),We(this,rn,null)),V(this,Wt)&&(Kt(V(this,Wt)),We(this,Wt,null)),V(this,mn)&&(Kt(V(this,mn)),We(this,mn,null));var o=!1,s=!1;const i=()=>{if(o){oc();return}o=!0,s&&ql(),wn.ensure(),We(this,Sa,0),V(this,mn)!==null&&xa(V(this,mn),()=>{We(this,mn,null)}),We(this,nn,this.has_pending_snippet()),We(this,rn,dt(this,Tt,Wr).call(this,()=>(We(this,Ca,!1),sn(()=>V(this,ba).call(this,V(this,an)))))),V(this,ea)>0?dt(this,Tt,Vr).call(this):We(this,nn,!1)};var l=Ye;try{Vt(null),s=!0,a?.(e,i),s=!1}catch(c){Qa(c,V(this,pn)&&V(this,pn).parent)}finally{Vt(l)}r&&Ma(()=>{We(this,mn,dt(this,Tt,Wr).call(this,()=>{wn.ensure(),We(this,Ca,!0);try{return sn(()=>{r(V(this,an),()=>e,()=>i)})}catch(c){return Qa(c,V(this,pn).parent),null}finally{We(this,Ca,!1)}}))})}}nn=new WeakMap,an=new WeakMap,$o=new WeakMap,hn=new WeakMap,ba=new WeakMap,pn=new WeakMap,rn=new WeakMap,Wt=new WeakMap,mn=new WeakMap,Ln=new WeakMap,$n=new WeakMap,Sa=new WeakMap,ea=new WeakMap,Ca=new WeakMap,ta=new WeakMap,eo=new WeakMap,Tt=new WeakSet,mc=function(){try{We(this,rn,sn(()=>V(this,ba).call(this,V(this,an))))}catch(e){this.error(e)}We(this,nn,!1)},_c=function(){const e=V(this,hn).pending;e&&(We(this,Wt,sn(()=>e(V(this,an)))),wn.enqueue(()=>{var a=dt(this,Tt,Mo).call(this);We(this,rn,dt(this,Tt,Wr).call(this,()=>(wn.ensure(),sn(()=>V(this,ba).call(this,a))))),V(this,ea)>0?dt(this,Tt,Vr).call(this):(xa(V(this,Wt),()=>{We(this,Wt,null)}),We(this,nn,!1))}))},Mo=function(){var e=V(this,an);return V(this,nn)&&(We(this,$n,zn()),V(this,an).before(V(this,$n)),e=V(this,$n)),e},Wr=function(e){var a=Qe,r=Ye,o=lt;kn(V(this,pn)),Vt(V(this,pn)),Za(V(this,pn).ctx);try{return e()}catch(s){return ti(s),null}finally{kn(a),Vt(r),Za(o)}},Vr=function(){const e=V(this,hn).pending;V(this,rn)!==null&&(We(this,Ln,document.createDocumentFragment()),V(this,Ln).append(V(this,$n)),xi(V(this,rn),V(this,Ln))),V(this,Wt)===null&&We(this,Wt,sn(()=>e(V(this,an))))},Io=function(e){var a;if(!this.has_pending_snippet()){this.parent&&dt(a=this.parent,Tt,Io).call(a,e);return}We(this,ea,V(this,ea)+e),V(this,ea)===0&&(We(this,nn,!1),V(this,Wt)&&xa(V(this,Wt),()=>{We(this,Wt,null)}),V(this,Ln)&&(V(this,an).before(V(this,Ln)),We(this,Ln,null)))};function wc(t,e,a,r){const o=or()?Pr:Er;if(a.length===0&&t.length===0){r(e.map(o));return}var s=$e,i=Qe,l=li();function c(){Promise.all(a.map(d=>yc(d))).then(d=>{l();try{r([...e.map(o),...d])}catch(u){(i.f&Fn)===0&&Qa(u,i)}s?.deactivate(),pr()}).catch(d=>{Qa(d,i)})}t.length>0?Promise.all(t).then(()=>{l();try{return c()}finally{s?.deactivate(),pr()}}):c()}function li(){var t=Qe,e=Ye,a=lt,r=$e;return function(s=!0){kn(t),Vt(e),Za(a),s&&r?.activate()}}function pr(){kn(null),Vt(null),Za(null)}function Pr(t){var e=Nt|qt,a=Ye!==null&&(Ye.f&Nt)!==0?Ye:null;return Qe!==null&&(Qe.f|=ar),{ctx:lt,deps:null,effects:null,equals:Zs,f:e,fn:t,reactions:null,rv:0,v:Pt,wv:0,parent:a??Qe,ac:null}}function yc(t,e){let a=Qe;a===null&&Ol();var r=a.b,o=void 0,s=Cn(Pt),i=!Ye,l=new Map;return Dc(()=>{var c=Ks();o=c.promise;try{Promise.resolve(t()).then(c.resolve,c.reject).then(()=>{d===$e&&d.committed&&d.deactivate(),pr()})}catch(h){c.reject(h),pr()}var d=$e;if(i){var u=!r.is_pending();r.update_pending_count(1),d.increment(u),l.get(d)?.reject(Ha),l.delete(d),l.set(d,c)}const v=(h,m=void 0)=>{if(d.activate(),m)m!==Ha&&(s.f|=oa,On(s,m));else{(s.f&oa)!==0&&(s.f^=oa),On(s,h);for(const[y,C]of l){if(l.delete(y),y===d)break;C.reject(Ha)}}i&&(r.update_pending_count(-1),d.decrement(u))};c.promise.then(v,h=>v(null,h||"unknown"))}),_i(()=>{for(const c of l.values())c.reject(Ha)}),new Promise(c=>{function d(u){function v(){u===o?c(s):d(o)}u.then(v,v)}d(o)})}function D(t){const e=Pr(t);return Ti(e),e}function Er(t){const e=Pr(t);return e.equals=Qs,e}function ci(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)Kt(e[a])}}function bc(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&Fn)===0?e:null;e=e.parent}return null}function rs(t){var e,a=Qe;kn(bc(t));try{t.f&=~Ea,ci(t),e=Ai(t)}finally{kn(a)}return e}function di(t){var e=rs(t);if(t.equals(e)||($e?.is_fork||(t.v=e),t.wv=Ei()),!Ia)if(cn!==null)(mr()||$e?.is_fork)&&cn.set(t,e);else{var a=(t.f&vn)===0?Sn:Lt;Ft(t,a)}}let Lo=new Set;const ia=new Map;let ui=!1;function Cn(t,e){var a={f:0,v:t,reactions:null,equals:Zs,rv:0,wv:0};return a}function L(t,e){const a=Cn(t);return Ti(a),a}function Ro(t,e=!1,a=!0){var o;const r=Cn(t);return e||(r.equals=Qs),rr&&a&&lt!==null&&lt.l!==null&&((o=lt.l).s??(o.s=[])).push(r),r}function f(t,e,a=!1){Ye!==null&&(!yn||(Ye.f&ms)!==0)&&or()&&(Ye.f&(Nt|Gn|as|ms))!==0&&!Bn?.includes(t)&&Kl();let r=a?ft(e):e;return On(t,r)}function On(t,e){if(!t.equals(e)){var a=t.v;Ia?ia.set(t,e):ia.set(t,a),t.v=e;var r=wn.ensure();r.capture(t,a),(t.f&Nt)!==0&&((t.f&qt)!==0&&rs(t),Ft(t,(t.f&vn)!==0?Lt:Sn)),t.wv=Ei(),fi(t,qt),or()&&Qe!==null&&(Qe.f&Lt)!==0&&(Qe.f&(Yn|Da))===0&&(tn===null?Lc([t]):tn.push(t)),!r.is_fork&&Lo.size>0&&!ui&&Sc()}return e}function Sc(){ui=!1;var t=Ta;Yr(!0);const e=Array.from(Lo);try{for(const a of e)(a.f&Lt)!==0&&Ft(a,Sn),Ar(a)&&wr(a)}finally{Yr(t)}Lo.clear()}function la(t){f(t,t.v+1)}function fi(t,e){var a=t.reactions;if(a!==null)for(var r=or(),o=a.length,s=0;s<o;s++){var i=a[s],l=i.f;if(!(!r&&i===Qe)){var c=(l&qt)===0;if(c&&Ft(i,e),(l&Nt)!==0){var d=i;cn?.delete(d),(l&Ea)===0&&(l&vn&&(i.f|=Ea),fi(d,Sn))}else c&&((l&Gn)!==0&&Dn!==null&&Dn.add(i),Na(i))}}}function ft(t){if(typeof t!="object"||t===null||sa in t)return t;const e=oo(t);if(e!==Vs&&e!==Dl)return t;var a=new Map,r=es(t),o=L(0),s=jn,i=l=>{if(jn===s)return l();var c=Ye,d=jn;Vt(null),Ss(s);var u=l();return Vt(c),Ss(d),u};return r&&a.set("length",L(t.length)),new Proxy(t,{defineProperty(l,c,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Wl();var u=a.get(c);return u===void 0?u=i(()=>{var v=L(d.value);return a.set(c,v),v}):f(u,d.value,!0),!0},deleteProperty(l,c){var d=a.get(c);if(d===void 0){if(c in l){const u=i(()=>L(Pt));a.set(c,u),la(o)}}else f(d,Pt),la(o);return!0},get(l,c,d){if(c===sa)return t;var u=a.get(c),v=c in l;if(u===void 0&&(!v||ra(l,c)?.writable)&&(u=i(()=>{var m=ft(v?l[c]:Pt),y=L(m);return y}),a.set(c,u)),u!==void 0){var h=n(u);return h===Pt?void 0:h}return Reflect.get(l,c,d)},getOwnPropertyDescriptor(l,c){var d=Reflect.getOwnPropertyDescriptor(l,c);if(d&&"value"in d){var u=a.get(c);u&&(d.value=n(u))}else if(d===void 0){var v=a.get(c),h=v?.v;if(v!==void 0&&h!==Pt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(l,c){if(c===sa)return!0;var d=a.get(c),u=d!==void 0&&d.v!==Pt||Reflect.has(l,c);if(d!==void 0||Qe!==null&&(!u||ra(l,c)?.writable)){d===void 0&&(d=i(()=>{var h=u?ft(l[c]):Pt,m=L(h);return m}),a.set(c,d));var v=n(d);if(v===Pt)return!1}return u},set(l,c,d,u){var v=a.get(c),h=c in l;if(r&&c==="length")for(var m=d;m<v.v;m+=1){var y=a.get(m+"");y!==void 0?f(y,Pt):m in l&&(y=i(()=>L(Pt)),a.set(m+"",y))}if(v===void 0)(!h||ra(l,c)?.writable)&&(v=i(()=>L(void 0)),f(v,ft(d)),a.set(c,v));else{h=v.v!==Pt;var C=i(()=>ft(d));f(v,C)}var p=Reflect.getOwnPropertyDescriptor(l,c);if(p?.set&&p.set.call(u,d),!h){if(r&&typeof c=="string"){var S=a.get("length"),N=Number(c);Number.isInteger(N)&&N>=S.v&&f(S,N+1)}la(o)}return!0},ownKeys(l){n(o);var c=Reflect.ownKeys(l).filter(v=>{var h=a.get(v);return h===void 0||h.v!==Pt});for(var[d,u]of a)u.v!==Pt&&!(d in l)&&c.push(d);return c},setPrototypeOf(){Vl()}})}var ws,vi,gi,hi;function Cc(){if(ws===void 0){ws=window,vi=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;gi=ra(e,"firstChild").get,hi=ra(e,"nextSibling").get,ps(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ps(a)&&(a.__t=void 0)}}function zn(t=""){return document.createTextNode(t)}function $a(t){return gi.call(t)}function Nr(t){return hi.call(t)}function b(t,e){return $a(t)}function M(t,e=!1){{var a=$a(t);return a instanceof Comment&&a.data===""?Nr(a):a}}function I(t,e=1,a=!1){let r=t;for(;e--;)r=Nr(r);return r}function kc(t){t.textContent=""}function pi(){return!1}let ys=!1;function xc(){ys||(ys=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function co(t){var e=Ye,a=Qe;Vt(null),kn(null);try{return t()}finally{Vt(e),kn(a)}}function Tc(t,e,a,r=a){t.addEventListener(e,()=>co(a));const o=t.__on_r;o?t.__on_r=()=>{o(),r(!0)}:t.__on_r=()=>r(!0),xc()}function mi(t){Qe===null&&(Ye===null&&jl(),Bl()),Ia&&zl()}function Pc(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function xn(t,e,a){var r=Qe;r!==null&&(r.f&Zt)!==0&&(t|=Zt);var o={ctx:lt,deps:null,nodes:null,f:t|qt|vn,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{wr(o),o.f|=ns}catch(l){throw Kt(o),l}else e!==null&&Na(o);var s=o;if(a&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&ar)===0&&(s=s.first,(t&Gn)!==0&&(t&da)!==0&&s!==null&&(s.f|=da)),s!==null&&(s.parent=r,r!==null&&Pc(s,r),Ye!==null&&(Ye.f&Nt)!==0&&(t&Da)===0)){var i=Ye;(i.effects??(i.effects=[])).push(s)}return o}function mr(){return Ye!==null&&!yn}function _i(t){const e=xn(so,null,!1);return Ft(e,Lt),e.teardown=t,e}function Ke(t){mi();var e=Qe.f,a=!Ye&&(e&Yn)!==0&&(e&ns)===0;if(a){var r=lt;(r.e??(r.e=[])).push(t)}else return wi(t)}function wi(t){return xn(ts|Gs,t,!1)}function Ec(t){return mi(),xn(so|Gs,t,!0)}function Nc(t){wn.ensure();const e=xn(Da|ar,t,!0);return(a={})=>new Promise(r=>{a.outro?xa(e,()=>{Kt(e),r(void 0)}):(Kt(e),r(void 0))})}function Ac(t){return xn(ts,t,!1)}function Dc(t){return xn(as|ar,t,!0)}function uo(t,e=0){return xn(so|e,t,!0)}function De(t,e=[],a=[],r=[]){wc(r,e,a,o=>{xn(so,()=>t(...o.map(n)),!0)})}function sr(t,e=0){var a=xn(Gn|e,t,!0);return a}function sn(t){return xn(Yn|ar,t,!0)}function yi(t){var e=t.teardown;if(e!==null){const a=Ia,r=Ye;bs(!0),Vt(null);try{e.call(null)}finally{bs(a),Vt(r)}}}function bi(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const o=a.ac;o!==null&&co(()=>{o.abort(Ha)});var r=a.next;(a.f&Da)!==0?a.parent=null:Kt(a,e),a=r}}function Mc(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&Yn)===0&&Kt(e),e=a}}function Kt(t,e=!0){var a=!1;(e||(t.f&qs)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Ic(t.nodes.start,t.nodes.end),a=!0),bi(t,e&&!a),Xr(t,0),Ft(t,Fn);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();yi(t);var o=t.parent;o!==null&&o.first!==null&&Si(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Ic(t,e){for(;t!==null;){var a=t===e?null:Nr(t);t.remove(),t=a}}function Si(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function xa(t,e,a=!0){var r=[];Ci(t,r,!0);var o=()=>{a&&Kt(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||o();for(var l of r)l.out(i)}else o()}function Ci(t,e,a){if((t.f&Zt)===0){t.f^=Zt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||a)&&e.push(l);for(var o=t.first;o!==null;){var s=o.next,i=(o.f&da)!==0||(o.f&Yn)!==0&&(t.f&Gn)!==0;Ci(o,e,i?a:!1),o=s}}}function os(t){ki(t,!0)}function ki(t,e){if((t.f&Zt)!==0){t.f^=Zt,(t.f&Lt)===0&&(Ft(t,qt),Na(t));for(var a=t.first;a!==null;){var r=a.next,o=(a.f&da)!==0||(a.f&Yn)!==0;ki(a,o?e:!1),a=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function xi(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var o=a===r?null:Nr(a);e.append(a),a=o}}let Ta=!1;function Yr(t){Ta=t}let Ia=!1;function bs(t){Ia=t}let Ye=null,yn=!1;function Vt(t){Ye=t}let Qe=null;function kn(t){Qe=t}let Bn=null;function Ti(t){Ye!==null&&(Bn===null?Bn=[t]:Bn.push(t))}let Ht=null,Gt=0,tn=null;function Lc(t){tn=t}let Pi=1,_r=0,jn=_r;function Ss(t){jn=t}function Ei(){return++Pi}function Ar(t){var e=t.f;if((e&qt)!==0)return!0;if(e&Nt&&(t.f&=~Ea),(e&Sn)!==0){var a=t.deps;if(a!==null)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(Ar(s)&&di(s),s.wv>t.wv)return!0}(e&vn)!==0&&cn===null&&Ft(t,Lt)}return!1}function Ni(t,e,a=!0){var r=t.reactions;if(r!==null&&!Bn?.includes(t))for(var o=0;o<r.length;o++){var s=r[o];(s.f&Nt)!==0?Ni(s,e,!1):e===s&&(a?Ft(s,qt):(s.f&Lt)!==0&&Ft(s,Sn),Na(s))}}function Ai(t){var y;var e=Ht,a=Gt,r=tn,o=Ye,s=Bn,i=lt,l=yn,c=jn,d=t.f;Ht=null,Gt=0,tn=null,Ye=(d&(Yn|Da))===0?t:null,Bn=null,Za(t.ctx),yn=!1,jn=++_r,t.ac!==null&&(co(()=>{t.ac.abort(Ha)}),t.ac=null);try{t.f|=Eo;var u=t.fn,v=u(),h=t.deps;if(Ht!==null){var m;if(Xr(t,Gt),h!==null&&Gt>0)for(h.length=Gt+Ht.length,m=0;m<Ht.length;m++)h[Gt+m]=Ht[m];else t.deps=h=Ht;if(mr()&&(t.f&vn)!==0)for(m=Gt;m<h.length;m++)((y=h[m]).reactions??(y.reactions=[])).push(t)}else h!==null&&Gt<h.length&&(Xr(t,Gt),h.length=Gt);if(or()&&tn!==null&&!yn&&h!==null&&(t.f&(Nt|Sn|qt))===0)for(m=0;m<tn.length;m++)Ni(tn[m],t);return o!==null&&o!==t&&(_r++,tn!==null&&(r===null?r=tn:r.push(...tn))),(t.f&oa)!==0&&(t.f^=oa),v}catch(C){return ti(C)}finally{t.f^=Eo,Ht=e,Gt=a,tn=r,Ye=o,Bn=s,Za(i),yn=l,jn=c}}function Rc(t,e){let a=e.reactions;if(a!==null){var r=Nl.call(a,t);if(r!==-1){var o=a.length-1;o===0?a=e.reactions=null:(a[r]=a[o],a.pop())}}a===null&&(e.f&Nt)!==0&&(Ht===null||!Ht.includes(e))&&(Ft(e,Sn),(e.f&vn)!==0&&(e.f^=vn,e.f&=~Ea),ci(e),Xr(e,0))}function Xr(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)Rc(t,a[r])}function wr(t){var e=t.f;if((e&Fn)===0){Ft(t,Lt);var a=Qe,r=Ta;Qe=t,Ta=!0;try{(e&(Gn|Rl))!==0?Mc(t):bi(t),yi(t);var o=Ai(t);t.teardown=typeof o=="function"?o:null,t.wv=Pi;var s;To&&ic&&(t.f&qt)!==0&&t.deps}finally{Ta=r,Qe=a}}}async function Fc(){await Promise.resolve(),ri()}function n(t){var e=t.f,a=(e&Nt)!==0;if(Ye!==null&&!yn){var r=Qe!==null&&(Qe.f&Fn)!==0;if(!r&&!Bn?.includes(t)){var o=Ye.deps;if((Ye.f&Eo)!==0)t.rv<_r&&(t.rv=_r,Ht===null&&o!==null&&o[Gt]===t?Gt++:Ht===null?Ht=[t]:Ht.includes(t)||Ht.push(t));else{(Ye.deps??(Ye.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[Ye]:s.includes(Ye)||s.push(Ye)}}}if(Ia){if(ia.has(t))return ia.get(t);if(a){var i=t,l=i.v;return((i.f&Lt)===0&&i.reactions!==null||Mi(i))&&(l=rs(i)),ia.set(i,l),l}}else a&&(!cn?.has(t)||$e?.is_fork&&!mr())&&(i=t,Ar(i)&&di(i),Ta&&mr()&&(i.f&vn)===0&&Di(i));if(cn?.has(t))return cn.get(t);if((t.f&oa)!==0)throw t.v;return t.v}function Di(t){if(t.deps!==null){t.f^=vn;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&vn)===0&&Di(e)}}function Mi(t){if(t.v===Pt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ia.has(e)||(e.f&Nt)!==0&&Mi(e))return!0;return!1}function Ct(t){var e=yn;try{return yn=!0,t()}finally{yn=e}}const Oc=-7169;function Ft(t,e){t.f=t.f&Oc|e}function zc(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(sa in t)Fo(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&sa in a&&Fo(a)}}}function Fo(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Fo(t[r],e)}catch{}const a=oo(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Ws(a);for(let o in r){const s=r[o].get;if(s)try{s.call(t)}catch{}}}}}const Bc=["touchstart","touchmove"];function jc(t){return Bc.includes(t)}const Ii=new Set,Oo=new Set;function Hc(t,e,a,r={}){function o(s){if(r.capture||dr.call(e,s),!s.cancelBubble)return co(()=>a?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Ma(()=>{e.addEventListener(t,o,r)}):e.addEventListener(t,o,r),o}function Qt(t,e,a,r,o){var s={capture:r,passive:o},i=Hc(t,e,a,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&_i(()=>{e.removeEventListener(t,i,s)})}function mt(t){for(var e=0;e<t.length;e++)Ii.add(t[e]);for(var a of Oo)a(t)}let Cs=null;function dr(t){var e=this,a=e.ownerDocument,r=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;Cs=t;var i=0,l=Cs===t&&t.__root;if(l){var c=o.indexOf(l);if(c!==-1&&(e===document||e===window)){t.__root=e;return}var d=o.indexOf(e);if(d===-1)return;c<=d&&(i=c)}if(s=o[i]||t.target,s!==e){Al(t,"currentTarget",{configurable:!0,get(){return s||a}});var u=Ye,v=Qe;Vt(null),kn(null);try{for(var h,m=[];s!==null;){var y=s.assignedSlot||s.parentNode||s.host||null;try{var C=s["__"+r];C!=null&&(!s.disabled||t.target===s)&&C.call(s,t)}catch(p){h?m.push(p):h=p}if(t.cancelBubble||y===e||y===null)break;s=y}if(h){for(let p of m)queueMicrotask(()=>{throw p});throw h}}finally{t.__root=e,delete t.currentTarget,Vt(u),kn(v)}}}function Li(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function yr(t,e){var a=Qe;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function k(t,e){var a=(e&nc)!==0,r=(e&ac)!==0,o,s=!t.startsWith("<!>");return()=>{o===void 0&&(o=Li(s?t:"<!>"+t),a||(o=$a(o)));var i=r||vi?document.importNode(o,!0):o.cloneNode(!0);if(a){var l=$a(i),c=i.lastChild;yr(l,c)}else yr(i,i);return i}}function Uc(t,e,a="svg"){var r=!t.startsWith("<!>"),o=`<${a}>${r?t:"<!>"+t}</${a}>`,s;return()=>{if(!s){var i=Li(o),l=$a(i);s=$a(l)}var c=s.cloneNode(!0);return yr(c,c),c}}function Wc(t,e){return Uc(t,e,"svg")}function Ve(t=""){{var e=zn(t+"");return yr(e,e),e}}function be(){var t=document.createDocumentFragment(),e=document.createComment(""),a=zn();return t.append(e,a),yr(e,a),t}function g(t,e){t!==null&&t.before(e)}function ip(){var t;return(t=window.__svelte??(window.__svelte={})).uid??(t.uid=1),`c${window.__svelte.uid++}`}function vt(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Vc(t,e){return Kc(t,e)}const Ba=new Map;function Kc(t,{target:e,anchor:a,props:r={},events:o,context:s,intro:i=!0}){Cc();var l=new Set,c=v=>{for(var h=0;h<v.length;h++){var m=v[h];if(!l.has(m)){l.add(m);var y=jc(m);e.addEventListener(m,dr,{passive:y});var C=Ba.get(m);C===void 0?(document.addEventListener(m,dr,{passive:y}),Ba.set(m,1)):Ba.set(m,C+1)}}};c(ro(Ii)),Oo.add(c);var d=void 0,u=Nc(()=>{var v=a??e.appendChild(zn());return hc(v,{pending:()=>{}},h=>{if(s){Ce({});var m=lt;m.c=s}o&&(r.$$events=o),d=t(h,r)||{},s&&ke()}),()=>{for(var h of l){e.removeEventListener(h,dr);var m=Ba.get(h);--m===0?(document.removeEventListener(h,dr),Ba.delete(h)):Ba.set(h,m)}Oo.delete(c),v!==a&&v.parentNode?.removeChild(v)}});return qc.set(d,u),d}let qc=new WeakMap;var dn,_n,Xt,ka,xr,Tr,to;class fo{constructor(e,a=!0){jt(this,"anchor");qe(this,dn,new Map);qe(this,_n,new Map);qe(this,Xt,new Map);qe(this,ka,new Set);qe(this,xr,!0);qe(this,Tr,()=>{var e=$e;if(V(this,dn).has(e)){var a=V(this,dn).get(e),r=V(this,_n).get(a);if(r)os(r),V(this,ka).delete(a);else{var o=V(this,Xt).get(a);o&&(V(this,_n).set(a,o.effect),V(this,Xt).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[s,i]of V(this,dn)){if(V(this,dn).delete(s),s===e)break;const l=V(this,Xt).get(i);l&&(Kt(l.effect),V(this,Xt).delete(i))}for(const[s,i]of V(this,_n)){if(s===a||V(this,ka).has(s))continue;const l=()=>{if(Array.from(V(this,dn).values()).includes(s)){var d=document.createDocumentFragment();xi(i,d),d.append(zn()),V(this,Xt).set(s,{effect:i,fragment:d})}else Kt(i);V(this,ka).delete(s),V(this,_n).delete(s)};V(this,xr)||!r?(V(this,ka).add(s),xa(i,l,!1)):l()}}});qe(this,to,e=>{V(this,dn).delete(e);const a=Array.from(V(this,dn).values());for(const[r,o]of V(this,Xt))a.includes(r)||(Kt(o.effect),V(this,Xt).delete(r))});this.anchor=e,We(this,xr,a)}ensure(e,a){var r=$e,o=pi();if(a&&!V(this,_n).has(e)&&!V(this,Xt).has(e))if(o){var s=document.createDocumentFragment(),i=zn();s.append(i),V(this,Xt).set(e,{effect:sn(()=>a(i)),fragment:s})}else V(this,_n).set(e,sn(()=>a(this.anchor)));if(V(this,dn).set(r,e),o){for(const[l,c]of V(this,_n))l===e?r.skipped_effects.delete(c):r.skipped_effects.add(c);for(const[l,c]of V(this,Xt))l===e?r.skipped_effects.delete(c.effect):r.skipped_effects.add(c.effect);r.oncommit(V(this,Tr)),r.ondiscard(V(this,to))}else V(this,Tr).call(this)}}dn=new WeakMap,_n=new WeakMap,Xt=new WeakMap,ka=new WeakMap,xr=new WeakMap,Tr=new WeakMap,to=new WeakMap;const Gc=0,So=1;function Yc(t,e,a,r,o){var s=or(),i=Pt,l=s?Cn(i):Ro(i,!1,!1),c=s?Cn(i):Ro(i,!1,!1),d=new fo(t);sr(()=>{var u=e(),v=!1;if(Ml(u)){var h=li(),m=!1;const y=C=>{if(!v){m=!0,h(!1),wn.ensure();try{C()}finally{pr(),Va||ri()}}};u.then(C=>{y(()=>{On(l,C),d.ensure(So,r&&(p=>r(p,l)))})},C=>{y(()=>{if(On(c,C),d.ensure(So,o&&(p=>o(p,c))),!o)throw c.v})}),Ma(()=>{m||y(()=>{d.ensure(Gc,a)})})}else On(l,u),d.ensure(So,r&&(y=>r(y,l)));return()=>{v=!0}})}function W(t,e,a=!1){var r=new fo(t),o=a?da:0;function s(i,l){r.ensure(i,l)}sr(()=>{var i=!1;e((l,c=!0)=>{i=!0,s(c,l)}),i||s(!1,null)},o)}function he(t,e){uo(()=>{var a=e();for(var r in a){var o=a[r];o?t.style.setProperty(r,o):t.style.removeProperty(r)}})}function Xc(t,e,a){for(var r=[],o=e.length,s,i=e.length,l=0;l<o;l++){let v=e[l];xa(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var h=t.outrogroups;zo(ro(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var c=r.length===0&&a!==null;if(c){var d=a,u=d.parentNode;kc(u),u.append(d),t.items.clear()}zo(e,!c)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function zo(t,e=!0){for(var a=0;a<t.length;a++)Kt(t[a],e)}var ks;function Hn(t,e,a,r,o,s=null){var i=t,l=new Map,c=(e&Js)!==0;if(c){var d=t;i=d.appendChild(zn())}var u=null,v=Er(()=>{var S=a();return es(S)?S:S==null?[]:ro(S)}),h,m=!0;function y(){p.fallback=u,Jc(p,h,i,e,r),u!==null&&(h.length===0?(u.f&Rn)===0?os(u):(u.f^=Rn,ur(u,null,i)):xa(u,()=>{u=null}))}var C=sr(()=>{h=n(v);for(var S=h.length,N=new Set,w=$e,_=pi(),A=0;A<S;A+=1){var B=h[A],K=r(B,A),O=m?null:l.get(K);O?(O.v&&On(O.v,B),O.i&&On(O.i,A),_&&w.skipped_effects.delete(O.e)):(O=Zc(l,m?i:ks??(ks=zn()),B,K,A,o,e,a),m||(O.e.f|=Rn),l.set(K,O)),N.add(K)}if(S===0&&s&&!u&&(m?u=sn(()=>s(i)):(u=sn(()=>s(ks??(ks=zn()))),u.f|=Rn)),!m)if(_){for(const[j,le]of l)N.has(j)||w.skipped_effects.add(le.e);w.oncommit(y),w.ondiscard(()=>{})}else y();n(v)}),p={effect:C,items:l,outrogroups:null,fallback:u};m=!1}function Jc(t,e,a,r,o){var s=(r&Xl)!==0,i=e.length,l=t.items,c=t.effect.first,d,u=null,v,h=[],m=[],y,C,p,S;if(s)for(S=0;S<i;S+=1)y=e[S],C=o(y,S),p=l.get(C).e,(p.f&Rn)===0&&(p.nodes?.a?.measure(),(v??(v=new Set)).add(p));for(S=0;S<i;S+=1){if(y=e[S],C=o(y,S),p=l.get(C).e,t.outrogroups!==null)for(const le of t.outrogroups)le.pending.delete(p),le.done.delete(p);if((p.f&Rn)!==0)if(p.f^=Rn,p===c)ur(p,null,a);else{var N=u?u.next:c;p===t.effect.last&&(t.effect.last=p.prev),p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),Jn(t,u,p),Jn(t,p,N),ur(p,N,a),u=p,h=[],m=[],c=u.next;continue}if((p.f&Zt)!==0&&(os(p),s&&(p.nodes?.a?.unfix(),(v??(v=new Set)).delete(p))),p!==c){if(d!==void 0&&d.has(p)){if(h.length<m.length){var w=m[0],_;u=w.prev;var A=h[0],B=h[h.length-1];for(_=0;_<h.length;_+=1)ur(h[_],w,a);for(_=0;_<m.length;_+=1)d.delete(m[_]);Jn(t,A.prev,B.next),Jn(t,u,A),Jn(t,B,w),c=w,u=B,S-=1,h=[],m=[]}else d.delete(p),ur(p,c,a),Jn(t,p.prev,p.next),Jn(t,p,u===null?t.effect.first:u.next),Jn(t,u,p),u=p;continue}for(h=[],m=[];c!==null&&c!==p;)(d??(d=new Set)).add(c),m.push(c),c=c.next;if(c===null)continue}(p.f&Rn)===0&&h.push(p),u=p,c=p.next}if(t.outrogroups!==null){for(const le of t.outrogroups)le.pending.size===0&&(zo(ro(le.done)),t.outrogroups?.delete(le));t.outrogroups.size===0&&(t.outrogroups=null)}if(c!==null||d!==void 0){var K=[];if(d!==void 0)for(p of d)(p.f&Zt)===0&&K.push(p);for(;c!==null;)(c.f&Zt)===0&&c!==t.fallback&&K.push(c),c=c.next;var O=K.length;if(O>0){var j=(r&Js)!==0&&i===0?a:null;if(s){for(S=0;S<O;S+=1)K[S].nodes?.a?.measure();for(S=0;S<O;S+=1)K[S].nodes?.a?.fix()}Xc(t,K,j)}}s&&Ma(()=>{if(v!==void 0)for(p of v)p.nodes?.a?.apply()})}function Zc(t,e,a,r,o,s,i,l){var c=(i&Gl)!==0?(i&Jl)===0?Ro(a,!1,!1):Cn(a):null,d=(i&Yl)!==0?Cn(o):null;return{v:c,i:d,e:sn(()=>(s(e,c??a,d??o,l),()=>{t.delete(r)}))}}function ur(t,e,a){if(t.nodes)for(var r=t.nodes.start,o=t.nodes.end,s=e&&(e.f&Rn)===0?e.nodes.start:a;r!==null;){var i=Nr(r);if(s.before(r),r===o)return;r=i}}function Jn(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function je(t,e,...a){var r=new fo(t);sr(()=>{const o=e()??null;r.ensure(o,o&&(s=>o(s,...a)))},da)}function Qc(t,e,a){var r=new fo(t);sr(()=>{var o=e()??null;r.ensure(o,o&&(s=>a(s,o)))},da)}function Ri(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(a=Ri(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function $c(){for(var t,e,a=0,r="",o=arguments.length;a<o;a++)(t=arguments[a])&&(e=Ri(t))&&(r&&(r+=" "),r+=e);return r}function at(t){return typeof t=="object"?$c(t):t??""}const xs=[...` 	
\r\fÂ \v\uFEFF`];function ed(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var o in a)if(a[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||xs.includes(r[i-1]))&&(l===r.length||xs.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function td(t,e){return t==null?null:String(t)}function tt(t,e,a,r,o,s){var i=t.__className;if(i!==a||i===void 0){var l=ed(a,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=a}else if(s&&o!==s)for(var c in s){var d=!!s[c];(o==null||d!==!!o[c])&&t.classList.toggle(c,d)}return s}function er(t,e,a,r){var o=t.__style;if(o!==e){var s=td(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const nd=Symbol("is custom element"),ad=Symbol("is html");function lp(t,e){var a=ss(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function cp(t,e){var a=ss(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function ut(t,e,a,r){var o=ss(t);o[e]!==(o[e]=a)&&(e==="loading"&&(t[Fl]=a),a==null?t.removeAttribute(e):typeof a!="string"&&rd(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function ss(t){return t.__attributes??(t.__attributes={[nd]:t.nodeName.includes("-"),[ad]:t.namespaceURI===rc})}var Ts=new Map;function rd(t){var e=t.getAttribute("is")||t.nodeName,a=Ts.get(e);if(a)return a;Ts.set(e,a=[]);for(var r,o=t,s=Element.prototype;s!==o;){r=Ws(o);for(var i in r)r[i].set&&a.push(i);o=oo(o)}return a}function Fi(t,e,a=e){var r=new WeakSet;Tc(t,"input",async o=>{var s=o?t.defaultValue:t.value;if(s=Co(t)?ko(s):s,a(s),$e!==null&&r.add($e),await Fc(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,c=t.value.length;if(t.value=s??"",l!==null){var d=t.value.length;i===l&&l===c&&d>c?(t.selectionStart=d,t.selectionEnd=d):(t.selectionStart=i,t.selectionEnd=Math.min(l,d))}}}),Ct(e)==null&&t.value&&(a(Co(t)?ko(t.value):t.value),$e!==null&&r.add($e)),uo(()=>{var o=e();if(t===document.activeElement){var s=Ur??$e;if(r.has(s))return}Co(t)&&o===ko(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function Co(t){var e=t.type;return e==="number"||e==="range"}function ko(t){return t===""?null:+t}function Ps(t,e){return t===e||t?.[sa]===e}function et(t={},e,a,r){return Ac(()=>{var o,s;return uo(()=>{o=s,s=[],Ct(()=>{t!==a(...s)&&(e(t,...s),o&&Ps(a(...o),t)&&e(null,...o))})}),()=>{Ma(()=>{s&&Ps(a(...s),t)&&e(null,...s)})}}),t}function is(t=!1){const e=lt,a=e.l.u;if(!a)return;let r=()=>zc(e.s);if(t){let o=0,s={};const i=Pr(()=>{let l=!1;const c=e.s;for(const d in c)c[d]!==s[d]&&(s[d]=c[d],l=!0);return l&&o++,o});r=()=>n(i)}a.b.length&&Ec(()=>{Es(e,r),Po(a.b)}),Ke(()=>{const o=Ct(()=>a.m.map(Il));return()=>{for(const s of o)typeof s=="function"&&s()}}),a.a.length&&Ke(()=>{Es(e,r),Po(a.a)})}function Es(t,e){if(t.l.s)for(const a of t.l.s)n(a);e()}let zr=!1;function od(t){var e=zr;try{return zr=!1,[t(),zr]}finally{zr=e}}const sd={get(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(ir(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,a){let r=t.props.length;for(;r--;){let o=t.props[r];ir(o)&&(o=o());const s=ra(o,e);if(s&&s.set)return s.set(a),!0}return!1},getOwnPropertyDescriptor(t,e){let a=t.props.length;for(;a--;){let r=t.props[a];if(ir(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=ra(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(t,e){if(e===sa||e===Ys)return!1;for(let a of t.props)if(ir(a)&&(a=a()),a!=null&&e in a)return!0;return!1},ownKeys(t){const e=[];for(let a of t.props)if(ir(a)&&(a=a()),!!a){for(const r in a)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(a))e.includes(r)||e.push(r)}return e}};function Bo(...t){return new Proxy({props:t},sd)}function Fe(t,e,a,r){var o=!rr||(a&Ql)!==0,s=(a&ec)!==0,i=(a&tc)!==0,l=r,c=!0,d=()=>(c&&(c=!1,l=i?Ct(r):r),l),u;if(s){var v=sa in t||Ys in t;u=ra(t,e)?.set??(v&&e in t?w=>t[e]=w:void 0)}var h,m=!1;s?[h,m]=od(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=d(),u&&(o&&Ul(),u(h)));var y;if(o?y=()=>{var w=t[e];return w===void 0?d():(c=!0,w)}:y=()=>{var w=t[e];return w!==void 0&&(l=void 0),w===void 0?l:w},o&&(a&$l)===0)return y;if(u){var C=t.$$legacy;return(function(w,_){return arguments.length>0?((!o||!_||C||m)&&u(_?y():w),w):y()})}var p=!1,S=((a&Zl)!==0?Pr:Er)(()=>(p=!1,y()));s&&n(S);var N=Qe;return(function(w,_){if(arguments.length>0){const A=_?n(S):o&&s?ft(w):w;return f(S,A),p=!0,l!==void 0&&(l=A),w}return Ia&&p||(N.f&Fn)!==0?S.v:n(S)})}function Pe(t){lt===null&&Xs(),rr&&lt.l!==null?id(lt).m.push(t):Ke(()=>{const e=Ct(t);if(typeof e=="function")return e})}function id(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const ld="5";var Us;typeof window<"u"&&((Us=window.__svelte??(window.__svelte={})).v??(Us.v=new Set)).add(ld);lc();const Oi={};function cd(t){ht(Oi,t)}function Aa(){const t=gt(Oi);if(!t)throw new Error("No FeedSearchContext found");return t}const zi={};function dd(t){ht(zi,t)}function zt(){const t=gt(zi);if(!t)throw new Error("No SearchParamsContext found");return t}function ud(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=zt(),s="feedSearch",i=D(()=>o().get(s)||""),l=D(()=>n(i));cd({getFeedSearch:()=>n(l),setFeedSearch:u=>{u===""?r(s):a(s,u)}});var c=be(),d=M(c);je(d,()=>e.children??Je),g(t,c),ke()}const Bi={};function fd(t){ht(Bi,t)}function vd(){const t=gt(Bi);if(!t)throw new Error("No TagsSearchContext found");return t}function gd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=zt(),s="tagsSearch",i=D(()=>o().get(s)||""),l=D(()=>n(i));fd({getTagsSearch:()=>n(l),setTagsSearch:u=>{u===""?r(s):a(s,u)}});var c=be(),d=M(c);je(d,()=>e.children??Je),g(t,c),ke()}const ji={};function hd(t){ht(ji,t)}function Hi(){const t=gt(ji);if(!t)throw new Error("No FeedOrderContext found");return t}function pd(t,e){Ce(e,!0);const{setSearchParam:a,deleteSearchParam:r,getSearchParams:o}=zt(),s="feedOrder",i=D(()=>o().get(s)||"newest"),l=D(()=>n(i));let c=["newest","oldest","AtoZ","ZtoA","updatedNewest"];hd({getFeedOrder:()=>n(l),setFeedOrder:v=>{v==="newest"||!c.includes(v)?r(s):a(s,v)}});var d=be(),u=M(d);je(u,()=>e.children??Je),g(t,d),ke()}const Ui={};function md(t){ht(Ui,t)}function Dr(){const t=gt(Ui);if(!t)throw new Error("No SidebarContext found");return t}function _d(t,e){Ce(e,!0);let a=L("closed");md({sidebarOpen:()=>{f(a,"preOpening")},sidebarClose:()=>{f(a,"closing")},getSidebarState:()=>n(a),setSidebarState:d=>{f(a,d,!0)}});var l=be(),c=M(l);je(c,()=>e.children??Je),g(t,l),ke()}const Wi={};function wd(t){ht(Wi,t)}function Xn(){const t=gt(Wi);if(!t)throw new Error("No SelectedTagsContext found");return t}function yd(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=zt(),s=D(a),i="selectedTags";let l=D(()=>n(s).get(i)||""),c=D(()=>new Set(n(l).split(",").map(p=>decodeURIComponent(p)).filter(p=>p!=="")));wd({getSelectedTags:()=>n(c),addTag:p=>{n(c).has(p)||r(i,[...n(c),p].map(S=>encodeURIComponent(S)).join(","))},removeTag:p=>{n(c).has(p)&&n(c).size===1?o(i):n(c).has(p)&&r(i,[...n(c)].filter(S=>S!==p).map(S=>encodeURIComponent(S)).join(","))},clearTags:()=>{o(i)},setSelectedTags:p=>{p.size===0?o(i):r(i,[...p].map(S=>encodeURIComponent(S)).join(","))}});var y=be(),C=M(y);je(C,()=>e.children??Je),g(t,y),ke()}const Vi={};function bd(t){ht(Vi,t)}function ua(){const t=gt(Vi);if(!t)throw new Error("No SelectedNotesContext found");return t}var Sd=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Cd=["difference","intersection","symmetricDifference","union"],Ns=!1,Ja,un,na,no,tr,Ki,qi;const ao=class ao extends Set{constructor(a){super();qe(this,tr);qe(this,Ja,new Map);qe(this,un,L(0));qe(this,na,L(0));qe(this,no,jn||-1);if(a){for(var r of a)super.add(r);V(this,na).v=super.size}Ns||dt(this,tr,qi).call(this)}has(a){var r=super.has(a),o=V(this,Ja),s=o.get(a);if(s===void 0){if(!r)return n(V(this,un)),!1;s=dt(this,tr,Ki).call(this,!0),o.set(a,s)}return n(s),r}add(a){return super.has(a)||(super.add(a),f(V(this,na),super.size),la(V(this,un))),this}delete(a){var r=super.delete(a),o=V(this,Ja),s=o.get(a);return s!==void 0&&(o.delete(a),f(s,!1)),r&&(f(V(this,na),super.size),la(V(this,un))),r}clear(){if(super.size!==0){super.clear();var a=V(this,Ja);for(var r of a.values())f(r,!1);a.clear(),f(V(this,na),0),la(V(this,un))}}keys(){return this.values()}values(){return n(V(this,un)),super.values()}entries(){return n(V(this,un)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return n(V(this,na))}};Ja=new WeakMap,un=new WeakMap,na=new WeakMap,no=new WeakMap,tr=new WeakSet,Ki=function(a){return jn===V(this,no)?L(a):Cn(a)},qi=function(){Ns=!0;var a=ao.prototype,r=Set.prototype;for(const o of Sd)a[o]=function(...s){return n(V(this,un)),r[o].apply(this,s)};for(const o of Cd)a[o]=function(...s){n(V(this,un));var i=r[o].apply(this,s);return new ao(i)}};let jo=ao;function kd(t,e){Ce(e,!0);let a=new jo,r=L("single");const o=()=>a,s=m=>{a.clear(),m.forEach(y=>a.add(y))},i=m=>{a.add(m)},l=m=>{a.delete(m)},c=()=>{a.clear()};bd({getSelectedNotes:o,setSelectedNotes:s,addNote:i,removeNote:l,clearNotes:c,getMode:()=>n(r),changeMode:m=>{f(r,m,!0),m==="single"&&c()}});var v=be(),h=M(v);je(h,()=>e.children??Je),g(t,v),ke()}const Gi={};function xd(t){ht(Gi,t)}function ls(){const t=gt(Gi);if(!t)throw new Error("No LocalDBContext found");return t}const Yi={};function Td(t){ht(Yi,t)}function Wn(){const t=gt(Yi);if(!t)throw new Error("No SettingsContext found");return t}const Xi={};function Pd(t){ht(Xi,t)}function vo(){const t=gt(Xi);if(!t)throw new Error("No BroadcastContext found");return t}const Ed="AppStorage",Nd=1,fr="account",An="settings",rt="notes",Ut="tags",Ad="urls",Dd="syncLog",fa="success",Vn="error",xt=(t,e,a)=>{t?.addEventListener(e,a)},As=(t,e)=>new Promise((a,r)=>{const s=t?.transaction(e,"readonly")?.objectStore(e).getAll();xt(s,fa,()=>{const i=s?.result||[];a(i)}),xt(s,Vn,i=>{r(i)})}),Jr=(t,e,a)=>new Promise((r,o)=>{const i=t?.transaction(e,"readonly")?.objectStore(e).get(a);xt(i,fa,()=>{const l=i?.result?.data;r(l)}),xt(i,Vn,l=>{o(l)})}),fn=(t,e,a,r)=>new Promise((o,s)=>{const c=t?.transaction(e,"readwrite")?.objectStore(e)?.put({id:a,data:r});xt(c,fa,()=>{o()}),xt(c,Vn,d=>{s(d)})}),yt=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.put(s);return new Promise((l,c)=>{xt(i,fa,()=>{l()}),xt(i,Vn,d=>{c(d)})})}))},xo=(t,e,a)=>new Promise((r,o)=>{const l=t?.transaction(e,"readwrite")?.objectStore(e)?.delete(a);xt(l,fa,()=>{r()}),xt(l,Vn,c=>{o(c)})}),lr=async(t,e,a)=>{const o=t?.transaction(e,"readwrite")?.objectStore(e);await Promise.all(a.map(s=>{const i=o?.delete(s);return new Promise((l,c)=>{xt(i,fa,()=>{l()}),xt(i,Vn,d=>{c(d)})})}))},Ua=(t,e)=>new Promise((a,r)=>{const i=t?.transaction(e,"readwrite")?.objectStore(e)?.clear();xt(i,fa,()=>{a()}),xt(i,Vn,l=>{r(l)})}),Ds=()=>chrome,Ji=()=>LanguageModel;function Md(t,e){Ce(e,!0);const{deleteSearchParam:a}=zt(),r="viewMode";let s=ft((()=>{const oe=new URLSearchParams(window.location.search).get(r)||"tab";return oe==="popup"||oe==="window"||oe==="tab"||oe==="sidebar"?oe:"tab"})());Pe(()=>{a(r)});let i=L(!1),l=L(ft({showFavicon:!0,iconForSavedPages:!1,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}}));const{getDB:c}=ls(),{createBroadcastChannel:d,tabId:u}=vo(),v=d(),h=D(c),m=async()=>{const F=await Jr(n(h),An,"default");F&&f(l,F,!0)},y=async()=>{await m(),f(i,!0)},C=()=>{v.postMessage({type:"updateSettings"})},p=async F=>{const oe=JSON.parse(F.data),G=oe;if(oe.tabId&&oe.tabId===u){G.type==="exit"&&(f(l,{showFavicon:!0,iconForSavedPages:!1,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0),Ua(n(h),An));return}G.type==="updateSettings"?m():G.type==="exit"&&f(l,{showFavicon:!0,iconForSavedPages:!1,recordMode:"note",tags:{llm:!0,pageData:!1,prev:[]}},!0)},S=()=>n(l).recordMode,N=()=>n(l).showFavicon,w=()=>n(l).iconForSavedPages,_=async F=>{n(l).showFavicon=F,await fn(n(h),An,"default",ga(n(l))),C()},A=async F=>{n(l).iconForSavedPages=F,await fn(n(h),An,"default",ga(n(l))),C()},B=async F=>{n(l).recordMode=F,await fn(n(h),An,"default",ga(n(l))),C()},K=async F=>{n(l).tags.prev=F,await fn(n(h),An,"default",ga(n(l))),C()},O=()=>n(l).tags.prev||[],j=async F=>{n(l).tags.llm=F,await fn(n(h),An,"default",ga(n(l))),C()},le=()=>n(l).tags.llm,ce=()=>n(l).tags.pageData,Q=async F=>{n(l).tags.pageData=F,await fn(n(h),An,"default",ga(n(l))),C()};Pe(()=>(y(),v.addEventListener(p),()=>{v.removeEventListener(p)})),Td({getFaviconEnabled:N,getRecordMode:S,setRecordMode:B,setFaviconShown:_,isInitedSettings:()=>n(i),getViewMode:()=>s,setLlmTagsEnabled:j,getLlmTagsEnabled:le,setPrevTags:K,getPrevTags:O,getPageDataForTagsEnabled:ce,setPageDataForTagsEnabled:Q,getIconForSavedPagesEnabled:w,setIconForSavedPagesEnabled:A});var $=be(),Y=M($);je(Y,()=>e.children??Je),g(t,$),ke()}const Zi={};function Id(t){ht(Zi,t)}function cs(){const t=gt(Zi);if(!t)throw new Error("No AccountContext found");return t}function Ld(t,e){Ce(e,!0);let a=L(void 0);const{getDB:r}=ls(),{createBroadcastChannel:o,tabId:s}=vo(),i=D(r),l=o(),c=async()=>{const w=await Jr(n(i),fr,"default");f(a,w,!0)},d=w=>fn(n(i),fr,"default",w),u=async w=>{const _=await Jr(n(i),fr,"default");_!==void 0&&f(a,_,!0),w(_)},v=async w=>{const _=JSON.parse(w.data);if(_.tabId&&_.tabId===s)return;const A=_;A.type==="initLocalAccount"?f(a,null):A.type==="initCloudAccount"?c():A.type==="disconnectCloudAccount"?f(a,null):A.type==="exit"?f(a,void 0):A.type==="updateAccount"&&c()};Pe(()=>(l.addEventListener(v),()=>{l.removeEventListener(v)})),Id({init:u,getAccount:()=>n(a),initLocalAccount:async()=>{f(a,null),await d(null),l.postMessage({type:"initLocalAccount"})},initCloudAccount:async w=>{const _={encryptedClientKey:w.encryptedClientKey||"",subscriptionExpires:w.subscriptionExpires||-1,lastSync:-1};await d(_),f(a,_,!0),l.postMessage({type:"initCloudAccount"})},disconnectCloudAccount:async()=>{f(a,null),await d(null),l.postMessage({type:"disconnectCloudAccount"})},updateSubscription:async w=>{if(!n(a))throw new Error("No account to update subscription for");const _={...n(a),subscriptionExpires:w};await d(_),l.postMessage({type:"updateAccount"})},exitApp:async()=>{f(a,void 0),l.postMessage({type:"exit"}),await Ua(n(i),fr)}});var S=be(),N=M(S);je(N,()=>e.children??Je),g(t,S),ke()}const Qi={};function Rd(t){ht(Qi,t)}function At(){const t=gt(Qi);if(!t)throw new Error("No NotesContext found");return t}const Mn=()=>crypto.randomUUID(),Fd=t=>{const e=new Set;for(const a of t||[])for(const r of a?.data.tags||[])e.add(r);return e},$i=(t,e)=>{let a=null;return()=>{a&&clearTimeout(a),a=setTimeout(()=>{a=null,t()},e)}};async function dp(){if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{console.error("")}}const Xe=t=>t===null||typeof t!="object"?t:JSON.parse(JSON.stringify(t));function Od(t,e){Ce(e,!0);const{getDB:a}=ls(),{createBroadcastChannel:r,tabId:o}=vo(),s=D(a),i=r(),l=720*60*60*1e3;let c=L(!1),d=L(()=>new Map),u=L(()=>[]),v=L(()=>new Map),h=L(ft(new Map));const m=()=>n(c),y=()=>n(u)().some(P=>P.data&&!P.data.deletedAt&&!P.data.archivedAt),C=()=>n(u)().some(P=>P.data&&P.data.deletedAt),p=()=>n(u)().some(P=>P.data&&P.data.archivedAt&&!P.data.deletedAt),S=(P,E)=>{n(h).has(P)||n(h).set(P,new Set),n(h).get(P)?.add(E)},N=(P,E)=>{n(h).has(P)&&(n(h).get(P)?.delete(E),n(h).get(P)?.size===0&&n(h).delete(P))},w=P=>{if(!P)return!1;const E=n(v)().get(P);if(!E||!E.data?.link?.url)return!1;const x=n(h).get(E.data.link.url),R=[];return x?.forEach(z=>{if(z===P)return;const T=n(v)().get(z);(E.data?.archivedAt||0)==(T?.data?.archivedAt||0)&&(E.data?.deletedAt||0)==(T?.data?.deletedAt||0)&&R.push(z)}),R.length>0},_=P=>{const E=n(h).get(P);return E?[...E].map(R=>({id:R})):[]},A=P=>{const E=n(u)(),x=n(v)(),R=x.get(P.id);R?R.data=P.data:(E.push(P),x.set(P.id,P)),f(u,()=>E),f(v,()=>x)},B=P=>{const E=n(u)(),x=n(v)(),R=x.get(P);x.has(P)&&x.delete(P),R&&(R.data=void 0),f(u,()=>E),f(v,()=>x)},K=P=>{const E=n(u)(),x=n(v)();for(const R of P){const z=x.get(R);x.has(R)&&x.delete(R),z&&(z.data=void 0)}f(u,()=>E),f(v,()=>x)},O=()=>{f(u,()=>[]),f(h,new Map,!0),f(d,()=>new Map),f(v,()=>new Map)},j=()=>n(u),le=()=>n(v),ce=P=>{const E=n(d)();for(const x of P)E.get(x)||E.set(x,{name:x});f(d,()=>E)},Q=()=>{i.postMessage({type:"reloadNotes"})},$=async()=>{const[P,E]=await Promise.all([As(n(s),rt),As(n(s),Ut).then(U=>U.reduce((ne,Ne)=>ne.set(Ne.id,Ne.data),new Map))]),x=[],R=[],z=new Map,T=new Map;for(const U of P)U.data.deletedAt&&Date.now()-U.data.deletedAt>l?x.push(U.id):(R.push(U),z.set(U.id,U),U.data.link?.url&&!U.data.deletedAt&&(T.has(U.data.link.url)?T.get(U.data.link.url)?.add(U.id):T.set(U.data.link.url,new Set([U.id]))));const J=Fd(R),q=[],Z=new Map(E);[...J.values()].forEach(U=>{Z.set(U,{name:U,pinned:E.get(U)?.pinned||!1}),E.has(U)||q.push(U)});const re=[];[...E.keys()].forEach(U=>{J.has(U)||re.push(U)}),await lr(n(s),rt,x),await lr(n(s),Ut,re),await yt(n(s),Ut,q.map(U=>({id:U,data:{pinned:Z.get(U)?.pinned||!1}}))),f(u,()=>R),f(v,()=>z),f(d,()=>Z),f(h,T,!0),f(c,!0)},Y=async(P,E,x)=>{E!==x&&(E&&N(E,P),x&&S(x,P))},F=async P=>{const E=n(d)(),x=P.data.tags.filter(z=>!E.has(z))||[],R=ee(P.id);return await fn(n(s),rt,P.id,{...P.data}),!R&&!P.data.deletedAt||R?.data.deletedAt&&!P.data.deletedAt?await Y(P.id,"",P.data.link?.url||""):!R?.data.deletedAt&&P.data.deletedAt?await Y(P.id,R?.data.link?.url||"",""):!R?.data.deletedAt&&!P.data.deletedAt&&await Y(P.id,R?.data?.link?.url||"",P.data.link?.url||""),x.length>0&&(await yt(n(s),Ut,x.map(z=>({id:z,data:{pinned:!1}}))||[]),ce(x)),A(P),i.postMessage({type:"putNote",data:{id:P.id}}),P.id},oe=async({link:P,text:E,tags:x,pinned:R})=>{const z={id:Mn(),data:{link:Xe(P),text:E,tags:Xe(x),versionId:Mn(),history:[],createdAt:Date.now(),updatedAt:Date.now(),pinned:R}};return await F(z),z.id},G=async(P,{link:E,text:x,tags:R})=>{const z=ee(P);if(!z||!z.data)return;const T={id:P,data:{...z.data,link:Xe(E),text:x,tags:Xe(R),updatedAt:Date.now()}};await F(T)},H=async(P,{link:E,text:x,tags:R})=>{const z=ee(P);if(!z||!z.data)return;const T={versionId:z.data.versionId,link:Xe(z.data.link),text:z.data.text,tags:Xe(z.data.tags),updatedAt:z.data.updatedAt},J=[...(z.data.history||[]).slice(-9),T],q={id:P,data:{...z.data,versionId:Mn(),link:E,text:x,tags:R,updatedAt:Date.now(),history:J}};return await F(q),{versionId:q.data.versionId,link:Xe(q.data.link),text:q.data.text,tags:Xe(q.data.tags),updatedAt:q.data.updatedAt}},te=async P=>{const E=ee(P);if(!E||!E.data)return;const R=(T=>{const J=`${E.data.link?.url||""}||${E.data.link?.title||""}||${E.data.text}||${E.data.tags.join(",")}`,q=new Set([J]),Z=[];for(const re of T){const U=`${re.link?.url||""}||${re.link?.title||""}||${re.text}||${re.tags.join(",")}`;q.has(U)||(q.add(U),Z.push(re))}return Z})([...E.data.history||[]]),z={id:P,data:{...E.data,history:R}};await F(z)},ge=async(P,E)=>{const x=ee(P);if(!x||!x.data)return;const R=x.data.history?.find?.(T=>T.versionId===E);if(!R)return;const z={id:P,data:{...x.data,versionId:R.versionId,link:Xe(R.link),text:R.text,tags:Xe(R.tags),updatedAt:R.updatedAt,history:x.data.history?.filter?.(T=>T.versionId!==E)||[]}};await F(z)},se=async P=>{const x=n(v)().get(P);!x||!x.data||(console.log("Note data:",x.data),await Y(x.id,x.data.link?.url||"",""),B(P),await xo(n(s),rt,P),i.postMessage({type:"deleteNote",data:{id:P}}))},ue=async()=>{await Ua(n(s),rt),await Ua(n(s),Ut),O(),i.postMessage({type:"clearNotes"})},ee=P=>n(v)().get(P),we=async(P,E)=>{const R=n(v)().get(P);if(!R||!R.data)return;const z={id:P,data:{...R.data,pinned:E}};F(z)},fe=async P=>{const x=n(v)().get(P);if(!x||!x.data)return;const R={id:P,data:{...x.data,deletedAt:Date.now()}};await F(R)},me=async P=>{const x=n(v)().get(P);if(!x||!x.data)return;const R={id:P,data:{...x.data,archivedAt:Date.now()}};await F(R)},X=async({noteIds:P})=>{const E=n(v)(),x=n(u)();for(const z of P){const T=E.get(z);T?.data&&(T.data.deletedAt=Date.now())}return await yt(n(s),rt,P.map(z=>{const T=E.get(z);return{id:z,data:T?.data}})),await Promise.all(P.map(async z=>{const T=E.get(z);T?.data&&await Y(T.id,T.data.link?.url||"","")})),Q(),f(v,()=>E),f(u,()=>x),{cancel:async()=>{for(const z of P){const T=E.get(z);T?.data&&(T.data.deletedAt=0)}await yt(n(s),rt,P.map(z=>{const T=E.get(z);return{id:z,data:T?.data}})),await Promise.all(P.map(async z=>{const T=E.get(z);T?.data&&await Y(T.id,"",T.data.link?.url||"")})),Q(),f(v,()=>E),f(u,()=>x)}}},ie=async({noteIds:P})=>{const E=n(v)(),x=n(u)();for(const z of P){const T=E.get(z);T?.data&&(T.data.archivedAt=Date.now())}return await yt(n(s),rt,P.map(z=>{const T=E.get(z);return{id:z,data:T?.data}})),Q(),f(v,()=>E),f(u,()=>x),{cancel:async()=>{for(const z of P){const T=E.get(z);T?.data&&(T.data.archivedAt=0)}await yt(n(s),rt,P.map(z=>{const T=E.get(z);return{id:z,data:T?.data}})),Q(),f(v,()=>E),f(u,()=>x)}}},de=async({noteIds:P})=>{const E=n(v)(),x=n(u)(),R=[];for(const T of P){const J=E.get(T);J?.data&&(R.push({id:T,data:Xe(J.data)}),J.data.archivedAt=0)}return await yt(n(s),rt,P.map(T=>{const J=E.get(T);return{id:T,data:J?.data}})),Q(),f(v,()=>E),f(u,()=>x),{cancel:async()=>{for(const T of R){const J=E.get(T.id);J?.data&&(J.data=T.data)}await yt(n(s),rt,P.map(T=>{const J=E.get(T);return{id:T,data:J?.data}})),Q(),f(v,()=>E),f(u,()=>x)}}},Ae=async({noteIds:P})=>{const E=n(v)(),x=n(u)(),R=[];for(const T of P){const J=E.get(T);J?.data&&(R.push({id:T,data:Xe(J.data)}),J.data.deletedAt=0)}return await yt(n(s),rt,P.map(T=>{const J=E.get(T);return{id:T,data:J?.data}})),await Promise.all(P.map(async T=>{const J=E.get(T);J?.data&&await Y(J.id,"",J.data.link?.url||"")})),Q(),f(v,()=>E),f(u,()=>x),{cancel:async()=>{for(const T of R){const J=E.get(T.id);J?.data&&(J.data=T.data)}await yt(n(s),rt,P.map(T=>{const J=E.get(T);return{id:T,data:J?.data}})),await Promise.all(P.map(async T=>{const J=E.get(T);J?.data&&await Y(J.id,J.data.link?.url||"","")})),Q(),f(v,()=>E),f(u,()=>x)}}},Ee=async P=>{const x=n(v)().get(P);if(!x||!x.data)return;const R={id:P,data:{...x.data,deletedAt:0}};await F(R)},pe=async P=>{const x=n(v)().get(P);if(!x||!x.data)return;const R={id:P,data:{...x.data,archivedAt:0}};await F(R)},ae=async(P,E)=>{const x=n(d)();x.set(P,{name:P,pinned:E}),await fn(n(s),Ut,P,{pinned:E}),i.postMessage({type:"pinTag",data:{tag:P,pinned:E}}),f(d,()=>x)},xe=async({noteIds:P})=>{const E=n(d)(),x=n(u)(),R=P.map(z=>n(v)().get(z)).filter(z=>!!z);K(P),await lr(n(s),rt,P),await Promise.all(R.map(async z=>{z?.data&&await Y(z.id,z.data.link?.url||"","")})),Q(),f(u,()=>x),f(d,()=>E)},ye=async P=>{const E=n(v)(),x={};P.forEach(R=>{const z=E.get(R.id),T=[];if(z&&z.data){let J=0,q=0;for(;J<R.data.history.length&&q<z.data.history.length;){const Z=R.data.history[J],re=z.data.history[q];Z.versionId===re.versionId?(Z.updatedAt>re.updatedAt?T.push(Z):T.push(re),J+=1,q+=1):Z.updatedAt<re.updatedAt?(T.push(Z),J+=1):Z.updatedAt>re.updatedAt?(T.push(re),q+=1):(T.push(re),J+=1,q+=1)}z.data.updatedAt>R.data.updatedAt?x[z.id]={id:z.id,data:{...z.data,history:T}}:x[R.id]={id:R.id,data:{...R.data,history:T}}}else x[R.id]=R}),await yt(n(s),rt,Object.values(x)),await $(),Q()},Me=async()=>{const P=[];n(u)().forEach(x=>{x&&x.data&&x.data.deletedAt&&P.push(x.id)}),await lr(n(s),rt,P),await $(),i.postMessage({type:"emptyBin"})},Re=async(P,E)=>{const x=n(v)(),R=n(u)(),z=[],T=[];for(const q of E){const Z=x.get(q);Z?.data&&(z.push({id:q,data:Xe(Z.data)}),T.push({id:q,data:{...Z.data,tags:Z.data.tags.filter(re=>re!==P),versionId:Mn(),history:[...Z.data.history||[],{versionId:Z.data.versionId,link:Xe(Z.data.link),text:Z.data.text,tags:Z.data.tags,updatedAt:Date.now()}]}}))}for(const q of T){const Z=x.get(q.id);Z?.data&&(Z.data=q.data)}return await yt(n(s),rt,T.map(q=>({id:q.id,data:q.data}))),Q(),f(v,()=>x),f(u,()=>R),{cancel:async()=>{for(const q of z){const Z=x.get(q.id);Z?.data&&(Z.data=q.data)}await yt(n(s),rt,z.map(q=>({id:q.id,data:q.data}))),Q(),f(v,()=>x),f(u,()=>R)}}},ve=async(P,E,x)=>{const R=n(v)(),z=n(u)(),T=n(d)(),J=[],q=[];for(const U of x){const ne=R.get(U);ne?.data&&(J.push({id:U,data:Xe(ne.data)}),q.push({id:U,data:{...ne.data,tags:ne.data.tags.map(Ne=>Ne!==P?Ne:E),versionId:Mn(),history:[...ne.data.history||[],{versionId:ne.data.versionId,link:Xe(ne.data.link),text:ne.data.text,tags:ne.data.tags,updatedAt:Date.now()}]}}))}for(const U of q){const ne=R.get(U.id);ne?.data&&(ne.data=U.data)}const Z=T.has(E);return await Promise.all([(async()=>{if(!Z){const U=T.get(P)?.pinned||!1;T.set(E,{name:E,pinned:U}),await fn(n(s),Ut,E,{pinned:U})}})(),yt(n(s),rt,q.map(U=>({id:U.id,data:U.data})))]),Q(),f(v,()=>R),f(u,()=>z),f(d,()=>T),{cancel:async()=>{for(const U of J){const ne=R.get(U.id);ne?.data&&(ne.data=U.data)}await Promise.all([(async()=>{Z||(T.delete(E),await xo(n(s),Ut,E))})(),yt(n(s),rt,J.map(U=>({id:U.id,data:U.data})))]),Q(),f(v,()=>R),f(u,()=>z),f(d,()=>T)}}},Se=async(P,E)=>{const x=n(v)(),R=n(u)(),z=n(d)(),T=[],J=[];for(const re of E){const U=x.get(re);U?.data&&(T.push({id:re,data:Xe(U.data)}),J.push({id:re,data:{...U.data,tags:[...new Set([...U.data.tags,P])],versionId:Mn(),history:[...U.data.history||[],{versionId:U.data.versionId,link:Xe(U.data.link),text:U.data.text,tags:U.data.tags,updatedAt:Date.now()}]}}))}for(const re of J){const U=x.get(re.id);U?.data&&(U.data=re.data)}const q=z.has(P);return await Promise.all([(async()=>{q||(z.set(P,{name:P,pinned:!1}),await fn(n(s),Ut,P,{pinned:!1}))})(),yt(n(s),rt,J.map(re=>({id:re.id,data:re.data})))]),Q(),f(v,()=>x),f(u,()=>R),f(d,()=>z),{cancel:async()=>{for(const re of T){const U=x.get(re.id);U?.data&&(U.data=re.data)}await Promise.all([(async()=>{q||(z.delete(P),await xo(n(s),Ut,P))})(),yt(n(s),rt,T.map(re=>({id:re.id,data:re.data})))]),Q(),f(v,()=>x),f(u,()=>R),f(d,()=>z)}}},Oe=async(P,E,x)=>{const R=n(v)(),z=n(u)(),T=n(d)(),J=[],q=[];for(const ne of x){const Ne=R.get(ne);Ne?.data&&(J.push({id:ne,data:Xe(Ne.data)}),q.push({id:ne,data:{...Ne.data,tags:[...new Set([...Ne.data.tags.filter(ze=>!P.includes(ze)),...E])],versionId:Mn(),history:[...Ne.data.history||[],{versionId:Ne.data.versionId,link:Xe(Ne.data.link),text:Ne.data.text,tags:Ne.data.tags,updatedAt:Date.now()}]}}))}for(const ne of q){const Ne=R.get(ne.id);Ne?.data&&(Ne.data=ne.data)}const Z=n(d)(),re=E.filter(ne=>!Z.has(ne));return await Promise.all([(async()=>{if(re.length>0)return yt(n(s),Ut,re.map(ne=>({id:ne,data:{pinned:!1}})))})(),yt(n(s),rt,q.map(ne=>({id:ne.id,data:ne.data})))]),Q(),f(v,()=>R),f(u,()=>z),f(d,()=>T),{cancel:async()=>{for(const ne of J){const Ne=R.get(ne.id);Ne?.data&&(Ne.data=ne.data)}await Promise.all([(async()=>{if(re.length>0){for(const ne of re)T.delete(ne);return lr(n(s),Ut,re)}})(),yt(n(s),rt,J.map(ne=>({id:ne.id,data:ne.data})))]),Q(),f(v,()=>R),f(u,()=>z),f(d,()=>T)}}},Be=async P=>{const E=JSON.parse(P.data),x=E;if(E.tabId&&E.tabId===o){x.type==="exit"&&(O(),await Ua(n(s),rt),await Ua(n(s),Ut));return}if(x.type==="putNote"){const z=x.data.id;if(!z)return;const T=await Jr(n(s),rt,z);if(!T)return;A({id:z,data:T})}else if(x.type==="deleteNote"){const R=x.data.id;if(!R)return;B(R)}else if(x.type==="pinTag"){const R=x.data.tag,z=x.data.pinned,T=n(d)();T.set(R,{name:R,pinned:z}),f(d,()=>T)}else x.type==="clearNotes"?O():x.type==="reloadNotes"||x.type==="emptyBin"?$():x.type==="exit"&&O()};Pe(()=>(i.addEventListener(Be),()=>{i.removeEventListener(Be)})),Rd({isInitedNotes:m,createNote:oe,updateNote:G,deleteNote:se,saveNote:H,zipNoteHistory:te,revertNote:ge,pinNote:we,moveNoteToBin:fe,moveNoteToArchive:me,getGetNotes:j,getGetMapNotes:le,importNotes:ye,clearNotes:ue,getNoteById:ee,getGetMapTags:()=>n(d),pinTag:ae,restoreNoteFromBin:Ee,moveNoteFromArchive:pe,checkNotes:y,checkNotesInBin:C,checkNotesInArchive:p,emptyBin:Me,moveNotesToBin:X,moveNotesToArchive:ie,moveNotesFromArchive:de,deleteNotes:xe,restoreNotesFromBin:Ae,deleteTag:Re,renameTag:ve,addTag:Se,changeTags:Oe,checkDuplicatesExist:w,getDuplicateNotesIdsByUrl:_,initNotes:$});var Ze=be(),Ge=M(Ze);je(Ge,()=>e.children??Je),g(t,Ze),ke()}const el={};function zd(t){ht(el,t)}function La(){const t=gt(el);if(!t)throw new Error("No FeedContext found");return t}const tl={};var ot=(t=>(t.INBOX="inbox",t.ARCHIVED="archive",t.BIN="bin",t))(ot||{});function Bd(t){ht(tl,t)}function go(){const t=gt(tl);if(!t)throw new Error("No SelectedMetaTagsContext found");return t}function jd(t,e){Ce(e,!0);const a=Aa(),{getSelectedTags:r}=Xn(),{getSelectedMetaTags:o}=go(),{getGetNotes:s}=At();let i=D(r),l=D(o),c=L(0),d=[],u=L(0),v=D(()=>n(l).has(ot.ARCHIVED)),h=D(()=>n(l).has(ot.BIN));Ke(()=>{const C=s()()||[],p=[],S=Array.from(n(i).values());for(let N=C.length-1;N>=0;N--){if(!C[N]||!C[N].data)continue;const w=C[N];if(!n(v)&&!n(h)&&(w?.data.deletedAt||w?.data.archivedAt)||n(v)&&(w?.data.deletedAt||!w?.data.archivedAt)||n(h)&&!w?.data.deletedAt)continue;const _=a?.getFeedSearch().toLowerCase()||"";if(a){if(_.endsWith("$")){const A=_.slice(0,-1);if(!(w.data.link?.title.toLowerCase()===A||w.data.link?.url.toLowerCase()===A||w.data.text.toLowerCase()===A||w.data.tags.map(B=>B.toLowerCase()).includes(A)))continue}else if(!(w.data.link?.title.toLowerCase().includes(_)||w.data.link?.url.toLowerCase().includes(_)||w.data.text.toLowerCase().includes(_)||w.data.tags.map(A=>A.toLowerCase()).join(" ").includes(_)))continue}if(n(l).has(ot.INBOX)){if(w.data.tags.length>0)continue}else if(n(i).size&&S.some(A=>!w.data.tags.includes(A)))continue;p.push(w)}f(c,p.length,!0),d=p,f(u,Date.now(),!0)}),zd({getFiltredNotesLength:()=>n(c),getFiltredNotes:()=>(n(u),d),getUpdatedFiltredNotesTimestamp:()=>n(u)});var m=be(),y=M(m);je(y,()=>e.children??Je),g(t,m),ke()}function Hd(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=zt(),s=D(a),i="selectedMetaTags";let l=D(()=>n(s).get(i)||""),c=D(()=>new Set(n(l).split(",").map(p=>decodeURIComponent(p)).filter(p=>p!=="")));Bd({getSelectedMetaTags:()=>n(c),addMetaTag:p=>{n(c).has(p)||r(i,[...n(c),p].map(S=>encodeURIComponent(S)).join(","))},removeMetaTag:p=>{n(c).has(p)&&n(c).size===1?o(i):n(c).has(p)&&r(i,[...n(c)].filter(S=>S!==p).map(S=>encodeURIComponent(S)).join(","))},clearSelectedMetaTags:()=>{o(i)},setSelectedMetaTags:p=>{p.size===0?o(i):r(i,[...p].map(S=>encodeURIComponent(S)).join(","))}});var y=be(),C=M(y);je(C,()=>e.children??Je),g(t,y),ke()}const nl={};function Ud(t){ht(nl,t)}function Wd(){const t=gt(nl);if(!t)throw new Error("No StartContext found");return t}var Te=(t=>(t.NewNote="newNote",t.Note="note",t.Settings="settings",t.ImportData="importData",t.ExportData="exportData",t.Account="account",t.Sync="sync",t.AccountSetup="accountSetup",t.Auth="auth",t.Signin="signin",t.Signup="signup",t.AccessKeys="accessKeys",t.ConfirmAccessKey="confirmAccessKey",t.Subscription="subscription",t.Exit="exit",t.NotFound="notFound",t.About="about",t.Install="install",t.InstallSuccess="installSuccess",t.Extension="extension",t))(Te||{});const Ms={settings:"Settings",importData:"Import",exportData:"Export",account:"Account",sync:"Sync",accountSetup:"",auth:"Auth",signin:"Sign in",signup:"Sign up",confirmAccessKey:"Confirm access key",accessKeys:"Access keys",subscription:"Subscription",exit:"Exit",notFound:"",about:"About",install:"Install app",installSuccess:"Install success",extension:"Extension"},Jt="dialogPages",al={};function Vd(t){ht(al,t)}function Ot(){const t=gt(al);if(!t)throw new Error("No DialogPagesContext found");return t}function Kd(t,e){Ce(e,!0);const{clearDialogPages:a,replaceDialogPage:r}=Ot(),{replaceSearchParams:o,getSearchParams:s}=zt(),{getViewMode:i}=Wn(),{initNotes:l,getDuplicateNotesIdsByUrl:c}=At(),{setFeedSearch:d}=Aa();i();let u=L(!1);const v=C=>{const p=new URLSearchParams(C),S=p.get(Jt),N=decodeURIComponent(S?.split(",").pop()||""),w=new URLSearchParams(N.split("?")[1]||"").get("id");return N.startsWith(Te.NewNote)&&w&&(C=p.toString().replace(Te.NewNote,`${Te.Note}`)),C},h=async()=>{let p=s().toString();p=v(p),o(p),console.log("Extension started with search params:",p),f(u,!0)};Pe(async()=>{await l(),h()}),Pe(()=>{}),Ud({isInited:()=>n(u)});var m=be(),y=M(m);je(y,()=>e.children??Je),g(t,m),ke()}const rl={},Pa=()=>({working:!1,swipingRatio:0,isSwiping:!1,duration:.2});function qd(t){ht(rl,t)}function Tn(){const t=gt(rl);if(!t)throw new Error("No AnimationSettingsContext found");return t}function Gd(t,e){Ce(e,!0);let a=L(ft({working:!1,swipingRatio:0,isSwiping:!1,duration:.2}));qd({getAnimationSettings:()=>n(a),setAnimationSettings:s=>{f(a,{...n(a),...s},!0)},resetAnimationSettings:()=>{f(a,{...n(a),swipingRatio:0,duration:.2},!0)}});var r=be(),o=M(r);je(o,()=>e.children??Je),g(t,r),ke()}const ol={};function Yd(t){ht(ol,t)}function ds(){const t=gt(ol);if(!t)throw new Error("No ScrollingContext found");return t}function Xd(t,e){Ce(e,!0);let a=L(!1);const r=()=>n(a),o=$i(()=>{f(a,!1)},100);Yd({isScrolling:r,enable:()=>{f(a,!0),o()}});var i=be(),l=M(i);je(l,()=>e.children??Je),g(t,i),ke()}const sl={};function Jd(t){ht(sl,t)}function va(){const t=gt(sl);if(!t)throw new Error("No MobileSizeContext found");return t}function Zd(t,e){Ce(e,!0);const a=()=>window.matchMedia("(max-width: 767px)").matches;let r=L(ft(a())),{setAnimationSettings:o,getAnimationSettings:s}=Tn();const i=$i(()=>{o({working:!0})},16),l=()=>{s().working&&(o({working:!1}),i()),requestAnimationFrame(()=>{f(r,a(),!0)})};Jd({checkMobileSize:()=>n(r)}),Pe(()=>(window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)));var d=be(),u=M(d);je(u,()=>e.children??Je),g(t,d),ke()}const il={};function Qd(t){ht(il,t)}function $t(){const t=gt(il);if(!t)throw new Error("No DialogContext found");return t}function $d(t,e){Ce(e,!0);let a=L(0),r=L(!1),o=L(!0),s=L(!1),i=L(!1);Qd({checkExistedDialog:()=>n(a)>0,dialogInc:()=>{f(a,n(a)+1)},dialogDec:()=>{f(a,n(a)-1)},blockDialog:A=>{f(r,A,!0)},checkBlockedDialog:()=>n(r),setClosableDialog:A=>{f(o,A,!0)},checkClosableDialog:()=>n(o),checkLeftStart:()=>n(s),checkLeftEnd:()=>n(i),setLeftStart:A=>{f(s,A,!0)},setLeftEnd:A=>{f(i,A,!0)},getCountDialog:()=>n(a)});var w=be(),_=M(w);je(_,()=>e.children??Je),g(t,w),ke()}const ll={};function eu(t){ht(ll,t)}function Mr(){const t=gt(ll);if(!t)throw new Error("No ScrollContainerContext found");return t}function tu(t,e){Ce(e,!0);let a=L(null);eu({setScrollContainer:l=>{f(a,l,!0)},getScrollContainer:()=>n(a)});var s=be(),i=M(s);je(i,()=>e.children??Je),g(t,s),ke()}const cl={};function nu(t){ht(cl,t)}function us(){const t=gt(cl);if(!t)throw new Error("No DialogPageHeightContext found");return t}function au(t,e){Ce(e,!0);let a=L(200);nu({setDialogPageHeight:l=>{f(a,l,!0)},getDialogPageHeight:()=>n(a)});var s=be(),i=M(s);je(i,()=>e.children??Je),g(t,s),ke()}const ru=[fr,An,rt,Ut,Dd,Ad];function ou(){return new Promise((t,e)=>{const a=indexedDB.open(Ed,Nd);xt(a,"upgradeneeded",()=>{const r=a.result;for(const o of ru)r.objectStoreNames.contains(o)||r.createObjectStore(o,{keyPath:"id"})}),xt(a,fa,()=>{const r=a.result;t(r),r.onversionchange=function(){r?.close(),alert("app outdated, please reload the page")}}),xt(a,"blocked",()=>{e(),alert("app outdated, please reload the page")}),xt(a,Vn,()=>{e(),console.error(Vn,a.error)})})}function su(t,e){Ce(e,!0);let a=L(null);Pe(()=>{ou().then(l=>{f(a,l,!0)}).catch(l=>{console.error("Failed to initialize LocalDB:",l)})}),xd({getDB:()=>n(a)});var o=be(),s=M(o);{var i=l=>{var c=be(),d=M(c);je(d,()=>e.children??Je),g(l,c)};W(s,l=>{n(a)&&l(i)})}g(t,o),ke()}function iu(t,e){Ce(e,!0);const{getSearchParams:a,setSearchParam:r,deleteSearchParam:o}=zt(),s=D(a);let i=D(()=>n(s).get(Jt)||""),l=D(()=>n(i).split(",").map(w=>decodeURIComponent(w)).filter(w=>w!==""));const c=()=>n(l),d=w=>{if(w.length===0){o(Jt);return}r(Jt,w.map(_=>encodeURIComponent(_)).join(","))},u=w=>{r(Jt,[...n(l),w].map(_=>encodeURIComponent(_)).join(","))};Vd({setDialogPages:d,getDialogPages:c,pushDialogPage:u,popDialogPage:()=>{const w=n(l)[n(l).length-1];return n(l).length<=1?(o(Jt),w):(r(Jt,n(l).slice(0,-1).map(_=>encodeURIComponent(_)).join(",")),w)},replaceDialogPage:w=>{r(Jt,[...n(l).slice(0,-1),w].map(_=>encodeURIComponent(_)).join(","))},hasDialogPage:w=>n(l).find(_=>{const[A]=_.split("?");return A===w})!==void 0,clearDialogPages:()=>{o(Jt)},createDialogPageHref:w=>{const _=new URLSearchParams(n(s).toString());return _.set(Jt,[...c(),w].map(A=>encodeURIComponent(A)).join(",")),`${window.location.pathname}?${_.toString()}`},createHandleClickDialogPage:w=>_=>{_.preventDefault(),u(w)}});var S=be(),N=M(S);je(N,()=>e.children??Je),g(t,S),ke()}function lu(t,e){Ce(e,!0);let a=L(ft(new URLSearchParams(window.location.search)));const r=v=>{const h=window.location.pathname;f(a,v,!0),window.history.replaceState(null,"",`${h}${v.size>0?`?${v.toString()}`:""}`)};dd({getSearchParams:()=>n(a),replaceSearchParams:v=>{const h=new URLSearchParams(v);r(h)},setSearchParam:(v,h)=>{const m=new URLSearchParams(n(a));m.set(v,h),r(m)},deleteSearchParam:v=>{const h=new URLSearchParams(n(a));h.delete(v),r(h)},getHref:(v=n(a))=>{const h=new URLSearchParams(v);return`${window.location.pathname}${h.toString().length>0?`?${h.toString()}`:""}`},clearSearchParams:()=>{r(new URLSearchParams)}});var d=be(),u=M(d);je(u,()=>e.children??Je),g(t,d),ke()}const dl={};function cu(t){ht(dl,t)}function du(){const t=gt(dl);if(!t)throw new Error("No KeyboardVisibleContext found");return t}function uu(t,e){Ce(e,!0);let a=ft({value:!1});const r=()=>a.value,o=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement||document.activeElement?.getAttribute("contenteditable")==="true";Pe(()=>{const l=()=>{setTimeout(()=>{o()?a.value=!0:a.value=!1},0)};return l(),document.addEventListener("focusin",l),document.addEventListener("focusout",l),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",l)}}),cu({getIsKeyboardVisible:r});var s=be(),i=M(s);je(i,()=>e.children??Je),g(t,s),ke()}function fu(t,e){Ce(e,!0);const a=crypto.randomUUID(),r=(i,l)=>{i.postMessage(JSON.stringify({...l,tabId:a}))};Pd({tabId:a,createBroadcastChannel:()=>{const i=new BroadcastChannel("app");return{postMessage:l=>r(i,l),addEventListener:l=>{i.addEventListener("message",l)},removeEventListener:l=>{i.removeEventListener("message",l)}}}});var o=be(),s=M(o);je(s,()=>e.children??Je),g(t,o),ke()}function vu(t,e){su(t,{children:(a,r)=>{fu(a,{children:(o,s)=>{Gd(o,{children:(i,l)=>{Xd(i,{children:(c,d)=>{Zd(c,{children:(u,v)=>{$d(u,{children:(h,m)=>{tu(h,{children:(y,C)=>{au(y,{children:(p,S)=>{uu(p,{children:(N,w)=>{lu(N,{children:(_,A)=>{iu(_,{children:(B,K)=>{var O=be(),j=M(O);je(j,()=>e.children??Je),g(B,O)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}function gu(t,e){vu(t,{children:(a,r)=>{gd(a,{children:(o,s)=>{ud(o,{children:(i,l)=>{pd(i,{children:(c,d)=>{_d(c,{children:(u,v)=>{Hd(u,{children:(h,m)=>{yd(h,{children:(y,C)=>{kd(y,{children:(p,S)=>{Md(p,{children:(N,w)=>{Ld(N,{children:(_,A)=>{Od(_,{children:(B,K)=>{jd(B,{children:(O,j)=>{Kd(O,{children:(le,ce)=>{var Q=be(),$=M(Q);je($,()=>e.children??Je),g(le,Q)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}})}const ul=(t=document.body)=>Array.from(t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(r=>r instanceof HTMLElement?r instanceof HTMLButtonElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement?!r.disabled&&r.offsetParent!==null:r.offsetParent!==null:!1),bt=t=>{const e=ul(),a=e.indexOf(t);if(a===-1)return{next:null,prev:null};const r=e[a+1],o=e[a-1];return{next:r,prev:o}};let It=L(""),Nn=L(null),Wa=L(null),In=L(null),Zn=L(ft([])),Br=L(null),Qn=null;function nt(t,e){f(It,""),Qn=null,f(Wa,null),f(In,null),setTimeout(()=>{f(It,t,!0),e?.onFinish&&f(Wa,e.onFinish,!0),e?.cancel&&(f(In,e.cancel.onCancel,!0),Qn=e.cancel.nextFocusRef)},16)}var hu=k('<button type="button" class="c p-146w2pd">undo</button>'),pu=k('<div class="a p-146w2pd"><div class="b p-146w2pd"><span> </span> <!></div></div>'),mu=k("<div><!></div>");function ho(t,e){Ce(e,!0);let a=Fe(e,"ref",15,null);const r=Mn();Ke(()=>{a(n(Nn))}),Pe(()=>(f(Zn,[...n(Zn),r],!0),()=>{const d=n(Zn).indexOf(r);d!==-1&&f(Zn,n(Zn).filter((u,v)=>v!==d),!0)}));const o=d=>{if(d.key==="Tab"&&d.shiftKey){if(Qn&&n(It)){d.preventDefault();const{prev:u}=bt(Qn);u?.focus(),f(It,"")}}else if(d.key==="Tab"&&!d.shiftKey)Qn&&n(It)&&(d.preventDefault(),f(It,""),Qn?.focus());else if(d.key==="Escape"&&n(It)){if(d.preventDefault(),Qn){const{prev:u}=bt(Qn);u?.focus()}f(It,"")}};Pe(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)})),Ke(()=>{n(It);const d=n(In)?2e3:800;n(It)&&(n(Nn)?.getBoundingClientRect(),n(Nn)?.style.setProperty("opacity","1"));const u=setTimeout(()=>{n(Nn)?.style.removeProperty("opacity")},d),v=setTimeout(()=>{f(It,""),n(Wa)&&n(Wa)(),f(Wa,null),f(In,null),n(Nn)?.style.removeProperty("opacity")},d+400);return()=>{clearTimeout(u),clearTimeout(v)}});const s=d=>{d.preventDefault(),n(In)&&(f(Wa,null),n(In)(),f(In,null)),f(It,""),n(Nn)?.style.removeProperty("opacity")};Ke(()=>{n(It)&&n(In)&&n(Br)&&setTimeout(()=>{n(Br)?.focus()},151)}),Ke(()=>{n(Zn),Ct(()=>{f(It,""),n(Nn)?.style.removeProperty("opacity")})});var i=mu(),l=b(i);{var c=d=>{var u=pu(),v=b(u),h=b(v),m=b(h),y=I(h,2);{var C=p=>{var S=hu();S.__click=s,et(S,N=>f(Br,N),()=>n(Br)),g(p,S)};W(y,p=>{n(In)&&p(C)})}et(v,p=>f(Nn,p),()=>n(Nn)),De(()=>vt(m,n(It))),g(d,u)};W(l,d=>{n(It)&&n(Zn)[n(Zn).length-1]===r&&d(c)})}g(t,i),ke()}mt(["click"]);var _u=k('<span class="a p-lxk90o"><!></span>');function wt(t,e){var a=_u(),r=b(a);je(r,()=>e.children),g(t,a)}var wu=Wc('<svg class="p-1yv1ibq"><use></use></svg>');function _e(t,e){let a=Fe(e,"name",8,"");var r=wu(),o=b(r);De(()=>ut(o,"href",`#icon-${a()??""}`)),g(t,r)}var yu=k('<button class="a p-1cnj0y3"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function fl(t,e){Ce(e,!0);const{sidebarOpen:a,getSidebarState:r,sidebarClose:o}=Dr(),{getDialogPages:s}=Ot(),{checkExistedDialog:i}=$t();let l=D(()=>s().length>0||i());const c=h=>{if(h.preventDefault(),n(l))return;const m=r();m==="closed"?a():m==="opened"&&o()};var d=yu();d.__click=c;var u=b(d);he(u,()=>({"--size":"28px"})),_e(u.lastChild,{name:"sidebarMenu"});var v=I(u,2);wt(v,{children:(h,m)=>{var y=Ve("Menu");g(h,y)}}),g(t,d),ke()}mt(["click"]);var bu=k('<button class="b p-3z9gmw"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Su=k('<div class="a p-3z9gmw"><input class="p-3z9gmw"/> <!></div>');function Ho(t,e){Ce(e,!0);let a=Fe(e,"value",15,""),r=Fe(e,"ref",15,null);const o=d=>{d.key==="Escape"&&(d.stopPropagation(),r()&&(e.onEscape?.(),r().blur()))};Pe(()=>(r()?.addEventListener("keydown",o),()=>{r()?.removeEventListener("keydown",o)}));var s=Su(),i=b(s);i.__input=d=>e.onChange?.(d.target?.value||""),et(i,d=>r(d),()=>r());var l=I(i,2);{var c=d=>{var u=bu();u.__click=()=>{a(""),e.onChange?.("")};var v=b(u);he(v,()=>({"--size":"20px"})),_e(v.lastChild,{name:"close"});var h=I(v,2);wt(h,{children:(m,y)=>{var C=Ve("Clear");g(m,C)}}),g(d,u)};W(l,d=>{a()&&d(c)})}De(()=>ut(i,"placeholder",e.placeholder)),Qt("focus",i,function(...d){e.onFocus?.apply(this,d)}),Qt("blur",i,function(...d){e.onBlur?.apply(this,d)}),Fi(i,a),g(t,s),ke()}mt(["input","click"]);function fs(t,e){Ce(e,!0);let a=Fe(e,"notificationRef",11,null);Pe(()=>{const r=o=>{o.target&&e.dialog?.open&&e.dialogInner&&e.dialogInner!==o.target&&!e.dialogInner.contains(o.target)&&a()!==o.target&&!a()?.contains(o.target)&&e.onClose()};return document.addEventListener("mousedown",r,{capture:!0}),()=>{document.removeEventListener("mousedown",r,{capture:!0})}}),ke()}function Cu(){const t=navigator.userAgent,e=/iPad|iPhone|iPod/.test(t);return e?!!e:!1}const Kn=Cu(),ku=()=>{const t=navigator.userAgent;return/android/i.test(t)},qn=ku(),up=()=>{const t=navigator.userAgent;return/chrome|crios/i.test(t)&&!/edg|edgios|edga|brave/i.test(t)&&!navigator.brave},fp=()=>{const t="serviceWorker"in navigator,e="onbeforeinstallprompt"in window;return t&&e},br=()=>{const t=navigator.userAgent;return!!(/Safari/.test(t)&&!/Chrome/.test(t)&&!/CriOS/.test(t)&&!/FxiOS/.test(t))};let ja=L(ft([]));var xu=k("<dialog><div><!></div></dialog> <!>",1);function Ir(t,e){Ce(e,!0);const a=Mn(),r=()=>document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement;Pe(()=>(f(ja,[...n(ja),a],!0),()=>{const _=n(ja).indexOf(a);_!==-1&&f(ja,n(ja).filter((A,B)=>B!==_),!0)}));let o=Fe(e,"onClosed",3,()=>{}),s=Fe(e,"blocked",3,!1),i=L(null),l=L(null),c=L(!1),{dialogInc:d,dialogDec:u}=$t();const{getScrollContainer:v}=Mr(),h=()=>{const _=setTimeout(()=>{o()()},150);n(i)?.addEventListener("transitionend",()=>{clearTimeout(_),o()()},{once:!0}),f(c,!1)};Ke(()=>{e.startClose&&h()}),Pe(()=>{n(i)?.showModal(),n(i)?.getClientRects(),f(c,!0);const _=A=>{A?.preventDefault(),s()||h()};return n(i)?.addEventListener("cancel",_),n(i)?.addEventListener("close",_),()=>{n(i)?.removeEventListener("cancel",_),n(i)?.removeEventListener("close",_)}}),Pe(()=>(d(),()=>{u()})),Pe(()=>{const _=A=>{A.key==="Escape"&&s()&&A.preventDefault()};return window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}});function m(){setTimeout(()=>{if(!n(i)||!n(l))return;const _=window.visualViewport;if(_)if(_.height===window.innerHeight||r()===!1){n(i).style.marginBottom="",n(i).style.transform="",n(i).style.transition="";return}else n(i).style.transition="none",n(i).style.transform=`translateY(-${window.innerHeight/2}px)`,n(i).style.marginBottom="0px"},100)}Pe(()=>(m(),window.visualViewport?.addEventListener("resize",m),window.visualViewport?.addEventListener("scroll",m),document.addEventListener("focusin",m),document.addEventListener("focusout",m),()=>{window.visualViewport?.removeEventListener("resize",m),window.visualViewport?.removeEventListener("scroll",m),document.addEventListener("focusin",m),document.addEventListener("focusout",m)}));var y=xu(),C=M(y),p=b(C),S=b(p);je(S,()=>e.children),et(p,_=>f(l,_),()=>n(l)),et(C,_=>f(i,_),()=>n(i));var N=I(C,2);{var w=_=>{fs(_,{get dialog(){return n(i)},get dialogInner(){return n(l)},onClose:h})};W(N,_=>{n(i)&&n(l)&&!s()&&_(w)})}De(()=>{tt(C,1,at({a:!0,b:n(c),c:n(ja).length>1}),"p-1x14yml"),tt(p,1,at({d:!0,b:n(c)}),"p-1x14yml")}),g(t,y),ke()}var Tu=k("<div><!></div>");function Pu(t,e){Ce(e,!0);let a=L(!1),r=L(null),o=null;const s=()=>{const v=setTimeout(()=>{e.onClosed()},150);n(r)?.addEventListener("transitionend",()=>{clearTimeout(v),e.onClosed()},{once:!0}),f(a,!1)},i=v=>{v.target!==n(r)&&!n(r)?.contains(v.target)&&s()},l=v=>{v.target!==n(r)&&!n(r)?.contains(v.target)&&s()},c=v=>{if(v.key==="Escape"&&(v.preventDefault(),s()),v.key==="ArrowUp"||v.key==="ArrowDown"){if(!n(r))return;v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation();const h=ul(n(r));if(o){const m=h.indexOf(o),y=h[m-1],C=h[m+1];v.key==="ArrowUp"&&y?(y.focus(),o=y):v.key==="ArrowDown"&&C&&(C.focus(),o=C)}else v.key==="ArrowUp"?(h[h.length-1].focus(),o=h[h.length-1]):v.key==="ArrowDown"&&(h[0].focus(),o=h[0])}};Pe(()=>{n(r)?.getClientRects(),f(a,!0);const v=setTimeout(()=>{document.addEventListener("focusin",i),document.addEventListener("click",l),document.addEventListener("keydown",c,{capture:!0})},0);return()=>{clearTimeout(v),document.removeEventListener("focusin",i),document.removeEventListener("click",l),document.removeEventListener("keydown",c,{capture:!0})}}),Ke(()=>{e.startClose&&s()});var d=Tu(),u=b(d);je(u,()=>e.children),et(d,v=>f(r,v),()=>n(r)),De(()=>tt(d,1,at({a:!0,b:n(a)}),"p-159ibkc")),g(t,d),ke()}var Eu=k("<ul><!></ul>"),Nu=k("<ul><!></ul>");function Lr(t,e){Ce(e,!0);let a=Fe(e,"ref",15);var r=be(),o=M(r);{var s=l=>{Ir(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(c,d)=>{var u=Eu(),v=b(u);je(v,()=>e.children),et(u,h=>a(h),()=>a()),De(()=>tt(u,1,at({a:!0,b:e.isMobile}),"p-6pddb9")),g(c,u)},$$slots:{default:!0}})},i=l=>{Pu(l,{get startClose(){return e.startClose},get onClosed(){return e.onClosed},children:(c,d)=>{var u=Nu(),v=b(u);je(v,()=>e.children),et(u,h=>a(h),()=>a()),De(()=>tt(u,1,at({a:!0,b:e.isMobile}),"p-6pddb9")),g(c,u)},$$slots:{default:!0}})};W(o,l=>{e.isMobile?l(s):l(i,!1)})}g(t,r),ke()}var Au=k("<button><!></button>"),Du=k("<a><!></a>");function Ue(t,e){let a=Fe(e,"dangerous",3,!1),r=Fe(e,"type",3,"button"),o=Fe(e,"href",3,"");var s=be(),i=M(s);{var l=d=>{var u=Au();u.__click=function(...h){e.onClick?.apply(this,h)},u.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=b(u);je(v,()=>e.children??Je),De(()=>tt(u,1,at({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")),g(d,u)},c=d=>{var u=Du();u.__click=function(...h){e.onClick?.apply(this,h)},u.__keydown=function(...h){e.onKeydown?.apply(this,h)};var v=b(u);je(v,()=>e.children??Je),De(()=>{ut(u,"href",o()),tt(u,1,at({a:!0,b:e.dialogMode,c:a(),d:e.active}),"p-1xchqhv")}),g(d,u)};W(i,d=>{r()==="button"?d(l):d(c,!1)})}g(t,s)}mt(["click","keydown"]);var Mu=k('<li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li> <li class="p-108u1na"><!></li>',1),Iu=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Lu=k('<div class="a p-108u1na"><button><!> <!></button> <!></div>');function Ru(t,e){Ce(e,!0);let a=L(!1),r=L(!1);const{getFeedOrder:o,setFeedOrder:s}=Hi();let i=Kn||qn,l=D(o);const c=()=>{n(a)||f(a,!0)},d=S=>{f(r,!0),s(S)},u=()=>{f(a,!1),f(r,!1)};Pe(()=>{const S=N=>{N.key==="Escape"&&f(r,!0)};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)});var v=Lu(),h=b(v);h.__click=c,tt(h,1,at({b:!0,c:!0}),"p-108u1na");var m=b(h);_e(m,{name:"filter"});var y=I(m,2);wt(y,{children:(S,N)=>{var w=Ve("show feed order menu");g(S,w)}});var C=I(h,2);{var p=S=>{var N=Iu(),w=M(N);he(w,()=>({"--right":"0px","--top":"44px"})),Lr(w.lastChild,{get startClose(){return n(r)},onClosed:u,get isMobile(){return i},children:(_,A)=>{var B=Mu(),K=M(B),O=b(K);{let G=D(()=>n(l)==="newest");Ue(O,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>d("newest"),children:(H,te)=>{var ge=Ve("Newest");g(H,ge)},$$slots:{default:!0}})}var j=I(K,2),le=b(j);{let G=D(()=>n(l)==="oldest");Ue(le,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>d("oldest"),children:(H,te)=>{var ge=Ve("Oldest");g(H,ge)},$$slots:{default:!0}})}var ce=I(j,2),Q=b(ce);{let G=D(()=>n(l)==="AtoZ");Ue(Q,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>d("AtoZ"),children:(H,te)=>{var ge=Ve("A to Z");g(H,ge)},$$slots:{default:!0}})}var $=I(ce,2),Y=b($);{let G=D(()=>n(l)==="ZtoA");Ue(Y,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>d("ZtoA"),children:(H,te)=>{var ge=Ve("Z to A");g(H,ge)},$$slots:{default:!0}})}var F=I($,2),oe=b(F);{let G=D(()=>n(l)==="updatedNewest");Ue(oe,{get active(){return n(G)},get dialogMode(){return i},onClick:()=>d("updatedNewest"),children:(H,te)=>{var ge=Ve("Updated");g(H,ge)},$$slots:{default:!0}})}g(_,B)},$$slots:{default:!0}}),g(S,N)};W(C,S=>{n(a)&&S(p)})}g(t,v),ke()}mt(["click"]);var Fu=k('<div><!> <div class="a p-y3zt6o"></div></div>');function Ra(t,e){Ce(e,!0);let a=L(!1);Pe(()=>{const s=setTimeout(()=>{f(a,!0)},200);return()=>{clearTimeout(s)}});var r=Fu(),o=b(r);je(o,()=>e.children??Je),De(()=>tt(r,1,at({b:!0,c:n(a)}),"p-y3zt6o")),g(t,r),ke()}var Ou=k("<a><!></a>"),zu=k("<button><!></button>");function Rt(t,e){let a=Fe(e,"type",3,"standard"),r=Fe(e,"typeButton",3,"button"),o=Fe(e,"element",3,"button"),s=Fe(e,"href",3,""),i=Fe(e,"fullWidth",3,!1),l=Fe(e,"withoutMinWidth",3,!1);var c=be(),d=M(c);{var u=h=>{var m=Ou();m.__click=function(...C){e.onClick?.apply(this,C)};var y=b(m);je(y,()=>e.children??Je),De(()=>{ut(m,"target",e.target),ut(m,"rel",e.rel),ut(m,"href",s()),tt(m,1,at({a:!0,b:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,m)},v=h=>{var m=zu();m.__click=function(...C){e.onClick?.apply(this,C)};var y=b(m);je(y,()=>e.children??Je),De(()=>{ut(m,"type",r()),tt(m,1,at({a:!0,c:a()==="dangerous",d:a()==="secondary",e:i(),f:l(),g:e.size==="small"}),"p-1iz5xf9")}),g(h,m)};W(d,h=>{o()==="a"?h(u):h(v,!1)})}g(t,c)}mt(["click"]);let Uo=L(!1),jr=L(!1),Wo=L(""),Vo=L("Cancel"),Ko=L("Confirm"),qo,Kr=L(void 0),Go,Yo=L("dangerous");function Ka(t){f(Uo,!0),f(Wo,t.title,!0),t.buttonCancelTitle&&f(Vo,t.buttonCancelTitle,!0),t.buttonConfirmTitle&&f(Ko,t.buttonConfirmTitle,!0),qo=t.onConfirm,f(Kr,t.onCancel,!0),Go=t.onClosed,t.type?f(Yo,t.type,!0):f(Yo,"dangerous")}var Bu=k('<span class="b p-1jg69ok"> </span> <div class="c p-1jg69ok"><!> <!></div>',1),ju=k('<div class="a p-1jg69ok"><!></div>');function Hu(t,e){Ce(e,!0);let a=L(!1),r,o=!1;const s=()=>{r=setTimeout(()=>{f(a,!0)},250)};Pe(()=>()=>{r&&clearTimeout(r)});const i=async()=>{s(),await n(Kr)?.(),f(jr,!0)},l=async()=>{s(),await qo?.(),f(jr,!0),o=!0},c=()=>{clearTimeout(r),f(a,!1),f(Uo,!1),f(jr,!1),f(Wo,""),f(Vo,"Cancel"),f(Ko,"Confirm"),f(Kr,void 0),qo=void 0,Go&&Go(o),o=!1};var d=be(),u=M(d);{var v=h=>{Ir(h,{get blocked(){return n(a)},get startClose(){return n(jr)},onClosed:c,children:(m,y)=>{var C=ju(),p=b(C);{var S=w=>{Ra(w,{})},N=w=>{var _=Bu(),A=M(_),B=b(A),K=I(A,2),O=b(K);{var j=ce=>{Rt(ce,{size:"small",onClick:i,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Q,$)=>{var Y=Ve();De(()=>vt(Y,n(Vo))),g(Q,Y)},$$slots:{default:!0}})};W(O,ce=>{n(Kr)&&ce(j)})}var le=I(O,2);Rt(le,{size:"small",onClick:l,fullWidth:!0,withoutMinWidth:!0,get type(){return n(Yo)},children:(ce,Q)=>{var $=Ve();De(()=>vt($,n(Ko))),g(ce,$)},$$slots:{default:!0}}),De(()=>vt(B,n(Wo))),g(w,_)};W(p,w=>{n(a)?w(S):w(N,!1)})}g(m,C)},$$slots:{default:!0}})};W(u,h=>{n(Uo)&&h(v)})}g(t,d),ke()}const Sr=t=>{const e=a=>{const r=a.target,o=r?.tagName;if(o==="INPUT"||o==="TEXTAREA"||r?.isContentEditable)return;const s=a.key.toLowerCase(),i=a.metaKey,l=a.ctrlKey,c=a.shiftKey;if(s===t.key&&!!t.meta==!!i&&!!t.ctrl==!!l&&!!t.shift==!!c){a.preventDefault(),t.action();return}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}};var Uu=k('<div class="a p-6qmscy"><a class="b p-6qmscy"><span class="c p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span> <span class="d p-6qmscy"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add note</span></span></a></div>');function Wu(t,e){Ce(e,!1);const{createDialogPageHref:a,createHandleClickDialogPage:r,getDialogPages:o,pushDialogPage:s}=Ot(),{checkExistedDialog:i}=$t(),l=()=>{o.length===0&&!i()&&s(Te.NewNote)};Pe(()=>Sr({key:"n",action:l})),is();var c=Uu(),d=b(c),u=D(()=>r(Te.NewNote));d.__click=function(...p){n(u)?.apply(this,p)};var v=b(d),h=b(v);he(h,()=>({"--size":"28px","--color":"#b0b0b0"})),_e(h.lastChild,{name:"add"});var m=I(h,2);wt(m,{children:(p,S)=>{var N=Ve("Add note");g(p,N)}});var y=I(v,2),C=b(y);he(C,()=>({"--size":"16px","--color":"#b0b0b0"})),_e(C.lastChild,{name:"plus"}),De(p=>ut(d,"href",p),[()=>a(Te.NewNote)]),g(t,c),ke()}mt(["click"]);var Vu=k("<button><!></button>");function ha(t,e){Ce(e,!0);let a=Fe(e,"type",3,"button"),r=!1,o=L(null);Ke(()=>{e.onRef&&e.onRef(n(o))});const s=u=>{(u.key==="Enter"||u.key===" ")&&(r=!0)},i=()=>{e.onClick&&(e.onClick?.(r),r&&(r=!1))},l=u=>{(u.pointerType==="mouse"&&u.button===0||u.pointerType==="touch")&&e.onPointerDown&&e.onPointerDown?.(u)};var c=Vu();c.__keydown=s,c.__click=i,c.__pointerdown=l,c.__touchstart=function(...u){e.onTouchStart?.apply(this,u)};var d=b(c);je(d,()=>e.children??Je),et(c,u=>f(o,u),()=>n(o)),De(()=>{ut(c,"type",a()),c.disabled=e.disabled,tt(c,1,at({a:!0,b:e.style==="selected",c:e.size==="small",d:e.mode==="empty"}),"p-19nhjik")}),g(t,c),ke()}mt(["keydown","click","pointerdown","touchstart"]);var Ku=k('<div class="b p-1pt17hy"> </div>'),qu=k('<div class="a p-1pt17hy"><input/> <!></div>');function Cr(t,e){Ce(e,!0);let a=Fe(e,"value",15,""),r=Fe(e,"error",3,""),o=Fe(e,"ref",15,null);var s=qu(),i=b(s);i.__input=function(...u){e.onInput?.apply(this,u)};let l;et(i,u=>o(u),()=>o());var c=I(i,2);{var d=u=>{var v=Ku(),h=b(v);De(()=>vt(h,r())),g(u,v)};W(c,u=>{r()&&u(d)})}De(()=>{ut(i,"placeholder",e.placeholder),l=tt(i,1,"p-1pt17hy",null,l,{error:!!r()})}),Qt("blur",i,function(...u){e.onBlur?.apply(this,u)}),Qt("focus",i,function(...u){e.onFocus?.apply(this,u)}),Fi(i,a),g(t,s),ke()}mt(["input"]);var Gu=k('<div class="b p-z67y1l"> </div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Yu=k('<form class="a p-z67y1l"><!></form>');function Xu(t,e){Ce(e,!0);const{renameTag:a}=At(),{getSelectedTags:r,setSelectedTags:o}=Xn(),{getSelectedNotes:s,setSelectedNotes:i,clearNotes:l}=ua(),{getFiltredNotes:c}=La();let d=L(!1),u=L(!1),v,h=!1,m=L(null),y=L(ft(e.tag)),C=e.nextFocusRef;Pe(()=>(n(m)&&n(m).focus(),()=>{v&&clearTimeout(v)}));const p=()=>{v=setTimeout(()=>{f(u,!0)},250)},S=()=>{f(d,!0)},N=async()=>{if(n(y).trim()===e.tag){S();return}if(n(y).trim()!=="")try{p();const A=r(),B=[...A].map(ce=>ce===e.tag?n(y).trim():ce),K=new Set(s()),O=c(),j=K.size?[...K]:O.map(ce=>ce.id),{cancel:le}=await a(e.tag,n(y).trim(),j);l(),o(new Set(B)),nt("Tag renamed",{cancel:{nextFocusRef:C,onCancel:async()=>{await le(),o(A),i(K),setTimeout(()=>{const{prev:ce}=bt(C);ce?.focus()},16)}}}),h=!0}finally{f(d,!0)}},w=()=>{e.onClosed?.(h)},_=A=>{A.preventDefault(),N()};Ir(t,{get blocked(){return n(u)},get startClose(){return n(d)},onClosed:w,children:(A,B)=>{var K=Yu(),O=b(K);{var j=ce=>{Ra(ce,{})},le=ce=>{var Q=Gu(),$=M(Q),Y=b($),F=I($,2);Cr(F,{placeholder:"Enter new tag name",get ref(){return n(m)},set ref(te){f(m,te,!0)},get value(){return n(y)},set value(te){f(y,te,!0)}});var oe=I(F,2),G=b(oe);Rt(G,{size:"small",onClick:S,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(te,ge)=>{var se=Ve("Cancel");g(te,se)},$$slots:{default:!0}});var H=I(G,2);Rt(H,{size:"small",onClick:N,fullWidth:!0,withoutMinWidth:!0,children:(te,ge)=>{var se=Ve("OK");g(te,se)},$$slots:{default:!0}}),De(()=>vt(Y,`Rename "${e.tag??""}" for selected notes`)),g(ce,Q)};W(O,ce=>{n(u)?ce(j):ce(le,!1)})}Qt("submit",K,_),g(A,K)},$$slots:{default:!0}}),ke()}let aa=L(!1),pa=L(!1),Yt=L(""),ma=L(0),vr=L(0),gr=L(0),qr,Zr=()=>({bottom:0,right:0,height:0}),en=L(null),Xo=L(null);function Ju(t){if(n(aa)){f(pa,!0),n(Yt)!==t.tag&&(qr=()=>{const a=t.getRect();f(aa,!0),f(Yt,t.tag,!0),f(ma,a.bottom,!0),f(vr,a.right,!0),f(gr,a.height,!0),Zr=t.getRect,f(en,t.focusRef,!0)});return}const e=t.getRect();f(aa,!0),f(Yt,t.tag,!0),f(ma,e.bottom,!0),f(vr,e.right,!0),f(gr,e.height,!0),Zr=t.getRect,f(en,t.focusRef,!0)}const Zu=()=>n(aa),Qu=()=>n(Xo);var $u=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Pin',1),ef=k('<li class="p-16hbyw2"><!></li>'),tf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Unpin',1),nf=k('<li class="p-16hbyw2"><!></li>'),af=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Rename',1),rf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete',1),of=k('<!> <li class="p-16hbyw2"><!></li> <li class="p-16hbyw2"><!></li>',1),sf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),lf=k("<!> <!>",1);function cf(t,e){Ce(e,!0);const{getScrollContainer:a}=Mr(),{pinTag:r,getGetMapTags:o,deleteTag:s}=At(),{checkMobileSize:i}=va(),{getSelectedTags:l,removeTag:c,setSelectedTags:d}=Xn(),{getSelectedNotes:u,setSelectedNotes:v,clearNotes:h}=ua(),{getFiltredNotes:m}=La();let y=L(!1);Ke(()=>{n(aa),Ct(()=>{f(y,o()().get(n(Yt))?.pinned||!1,!0)})});let C=L(!1);const p=()=>{r(n(Yt),!0),f(pa,!0);let G=n(en),H=bt(G)?.next;nt("Tag pinned",{cancel:{nextFocusRef:H,onCancel:async()=>{r(n(Yt),!1),setTimeout(()=>{const{prev:te}=bt(H);te?.focus()},16)}}})},S=()=>{r(n(Yt),!1),f(pa,!0);let G=n(en),H=bt(G)?.next;nt("Tag unpinned",{cancel:{nextFocusRef:H,onCancel:async()=>{r(n(Yt),!0),setTimeout(()=>{const{prev:te}=bt(H);te?.focus()},16)}}})},N=()=>{f(aa,!1),f(pa,!1),f(ma,0),f(vr,0),f(gr,0),Zr=()=>({bottom:0,right:0,height:0}),f(en,null),qr&&setTimeout(()=>{qr?.(),qr=void 0})};let w=D(()=>window.innerHeight-n(ma)<100?n(ma)-n(gr)-98+"px":n(ma)+5+"px"),_=D(a);const A=G=>{G.key==="Tab"&&G.shiftKey&&(G.preventDefault(),n(en)?.focus())},B=G=>{G.key==="Tab"&&!G.shiftKey&&n(en)&&(G.preventDefault(),bt(n(en))?.next?.focus())};Pe(()=>{const G=H=>{H.key==="Escape"&&n(aa)&&n(en)?.focus()};return window.addEventListener("keydown",G),()=>{window.removeEventListener("keydown",G)}});const K=()=>{f(pa,!0);let G=n(en),H=bt(G)?.next;Ka({title:`Are you sure to delete "${n(Yt)}" from selected notes?`,buttonConfirmTitle:"Delete",onConfirm:async()=>{const te=Array.from(n(le)),ge=new Set(u()),se=m(),ue=ge.size?[...ge]:se.map(we=>we.id);n(le).has(n(Yt))&&(ge.size===0||se.length===ge.size)&&c(n(Yt)),h();const{cancel:ee}=await s(n(Yt),ue);nt("Tag deleted",{cancel:{nextFocusRef:H,onCancel:async()=>{await ee(),d(new Set(te)),v(new Set(ge)),setTimeout(()=>{const{prev:we}=bt(H);we?.focus()},16)}}})},onCancel:async()=>{},onClosed:te=>{setTimeout(()=>{te||G?.focus()},16)}})};let O=()=>{};const j=()=>{f(pa,!0),f(C,!0);let G=n(en);O=()=>{f(C,!1),setTimeout(()=>{G?.focus()},16)}};Ke(()=>{const G=()=>{const H=Zr();f(ma,H.bottom,!0),f(vr,H.right,!0),f(gr,H.height,!0)};return n(_)?.addEventListener("scroll",G),window.addEventListener("resize",G),()=>{n(_)?.removeEventListener("scroll",G),window.removeEventListener("resize",G)}});let le=D(l),ce=D(i);var Q=lf(),$=M(Q);{var Y=G=>{var H=sf(),te=M(H);he(te,()=>({"--left":n(vr)-36+"px","--top":n(w),"--transform-origin":"top left"})),Lr(te.lastChild,{get startClose(){return n(pa)},onClosed:N,get isMobile(){return n(ce)},get ref(){return n(Xo)},set ref(ge){f(Xo,ge,!0)},children:(ge,se)=>{var ue=of(),ee=M(ue);{var we=Ae=>{var Ee=ef(),pe=b(Ee);Ue(pe,{onClick:p,onKeydown:A,get dialogMode(){return n(ce)},children:(ae,xe)=>{var ye=$u(),Me=M(ye);he(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:"pin"}),g(ae,ye)},$$slots:{default:!0}}),g(Ae,Ee)},fe=Ae=>{var Ee=nf(),pe=b(Ee);Ue(pe,{onClick:S,onKeydown:A,get dialogMode(){return n(ce)},children:(ae,xe)=>{var ye=tf(),Me=M(ye);he(Me,()=>({"--size":"20px"})),_e(Me.lastChild,{name:"pin-cancel"}),g(ae,ye)},$$slots:{default:!0}}),g(Ae,Ee)};W(ee,Ae=>{n(y)?Ae(fe,!1):Ae(we)})}var me=I(ee,2),X=b(me);Ue(X,{onClick:j,get dialogMode(){return n(ce)},children:(Ae,Ee)=>{var pe=af(),ae=M(pe);he(ae,()=>({"--size":"20px","--scale":"0.9"})),_e(ae.lastChild,{name:"pen"}),g(Ae,pe)},$$slots:{default:!0}});var ie=I(me,2),de=b(ie);Ue(de,{onClick:K,onKeydown:B,get dialogMode(){return n(ce)},children:(Ae,Ee)=>{var pe=rf(),ae=M(pe);he(ae,()=>({"--size":"20px"})),_e(ae.lastChild,{name:"bin"}),g(Ae,pe)},$$slots:{default:!0}}),g(ge,ue)},$$slots:{default:!0}}),g(G,H)};W($,G=>{n(aa)&&G(Y)})}var F=I($,2);{var oe=G=>{{let H=D(()=>bt(n(en))?.next||null);Xu(G,{get tag(){return n(Yt)},get nextFocusRef(){return n(H)},onClosed:te=>{O(te)}})}};W(F,G=>{n(C)&&G(oe)})}g(t,Q),ke()}var df=k('<span><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>'),uf=k('<button><span class="b p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></span></button>'),ff=k("<!> <span> </span> <!>",1),vf=k('<div class="a p-9jjlcl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function hr(t,e){Ce(e,!0);let{getGetMapTags:a}=At(),r=L(null),o=D(Zu);const s=()=>{if(n(r)){const v=n(r).getBoundingClientRect();return{bottom:v.bottom,right:v.right,height:v.height}}return{bottom:0,right:0,height:0}},i=v=>{v.stopPropagation(),v.preventDefault(),Ju({tag:e.tag,getRect:s,focusRef:n(r)})},l=v=>{v.key==="Tab"&&!v.shiftKey&&n(o)&&(v.preventDefault(),Qu()?.querySelectorAll('button, [tabindex="0"]')[0]?.focus())};let c=D(()=>a()().get(e.tag)?.pinned||!1);var d=vf(),u=b(d);he(u,()=>({"--paddingRight":e.hideMenu?void 0:"30px"})),ha(u.lastChild,{get style(){return e.type},get onRef(){return e.onRef},get onClick(){return e.onClick},children:(v,h)=>{var m=ff(),y=M(m);{var C=_=>{var A=df(),B=b(A);he(B,()=>({"--size":"18px"})),_e(B.lastChild,{name:"pin"}),g(_,A)};W(y,_=>{n(c)&&_(C)})}var p=I(y,2),S=b(p),N=I(p,2);{var w=_=>{var A=uf();A.__click=i,A.__keydown=l;var B=b(A),K=b(B);he(K,()=>({"--size":"16px"})),_e(K.lastChild,{name:"menu"});var O=I(K,2);wt(O,{children:(j,le)=>{var ce=Ve("Tag options");g(j,ce)}}),et(A,j=>f(r,j),()=>n(r)),De(()=>tt(A,1,at({c:!0,d:e.type==="selected"}),"p-9jjlcl")),g(_,A)};W(N,_=>{e.hideMenu||_(w)})}De(()=>vt(S,e.tag)),g(v,m)},$$slots:{default:!0}}),g(t,d),ke()}mt(["click","keydown"]);var gf=k('<div class="a p-lawyrs"><div><!> <!> <!></div></div>');function Is(t,e){Ce(e,!0);let a=Fe(e,"mobile",3,!1);const{getGetMapTags:r}=At();let s=D(()=>{const m=r()();return[...e.tags].sort((y,C)=>m.get(y)?.pinned?-1:m.get(C)?.pinned?1:y.localeCompare(C))}),i=D(()=>n(s).filter(m=>r()().get(m)?.pinned)),l=D(()=>n(s).filter(m=>!r()().get(m)?.pinned));var c=gf(),d=b(c),u=b(d);Hn(u,16,()=>n(i),m=>m,(m,y)=>{hr(m,{get hideMenu(){return e.hideTagMenu},get tag(){return y},onClick:()=>{e.handleTagClick(y)}})});var v=I(u,2);Hn(v,17,()=>e.metaTags,m=>"meta"+m,(m,y)=>{hr(m,{hideMenu:!0,get tag(){return n(y)},onClick:()=>{e.handleMetaTagClick(n(y))}})});var h=I(v,2);Hn(h,16,()=>n(l),m=>m,(m,y)=>{hr(m,{get hideMenu(){return e.hideTagMenu},get tag(){return y},onClick:()=>{e.handleTagClick(y)}})}),De(()=>tt(d,1,at({b:!0,c:a()}),"p-lawyrs")),g(t,c),ke()}var hf=k('<div class="b c p-32813r"><div class="d p-32813r"><button class="e p-32813r"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button></div> <!> <!></div>'),pf=k('<div class="a p-32813r"><!></div>');function Ls(t,e){Ce(e,!0);let a=L(null);const r=c=>{f(a,c,!0)},o=()=>{e.clearTags(),e.clearMetaTags()};Ke(()=>{n(a)&&n(a).focus()});var s=pf(),i=b(s);{var l=c=>{var d=hf(),u=b(d),v=b(u);v.__click=o;var h=b(v);he(h,()=>({"--size":"20px"})),_e(h.lastChild,{name:"close"});var m=I(h,2);wt(m,{children:(p,S)=>{var N=Ve("Clear");g(p,N)}});var y=I(u,2);Hn(y,19,()=>e.metaTags,p=>"meta_"+p,(p,S,N)=>{{let w=D(()=>n(N)===e.metaTags.size-1&&e.selectedTags.size===0?r:void 0);hr(p,{hideMenu:!0,type:"selected",get tag(){return n(S)},onClick:()=>{e.handleMetaTagClick(n(S))},get onRef(){return n(w)}})}});var C=I(y,2);Hn(C,18,()=>e.selectedTags,p=>p,(p,S,N)=>{{let w=D(()=>n(N)===e.selectedTags.size-1?r:void 0);hr(p,{get hideMenu(){return e.hideTagMenu},type:"selected",get tag(){return S},onClick:()=>{e.handleSelectedTagClick(S)},get onRef(){return n(w)}})}}),g(c,d)};W(i,c=>{e.selectedTags.size+e.metaTags.size>0&&c(l)})}g(t,s),ke()}mt(["click"]);const Jo=(t,e,a,r)=>{if(t.has(ot.INBOX))return[];const o=[],s=Array.from(e.values());for(const i of a)if(i.data&&!(r&&!r(i))){if(e.size===0){for(const l of i?.data?.tags||[])o.includes(l)||o.push(l);continue}if(i.data&&s.every(l=>i.data?.tags.includes(l)))for(const l of i.data.tags||[])!e.has(l)&&!o.includes(l)&&o.push(l)}return o},Un=200,mf=t=>t<.5?2*t*t:-1+(4-2*t)*t,vl=t=>{let e=0,a=1,r=0;const o=100;let s=0;const i=1e-4;for(;a-e>i&&(r=(e+a)/2,mf(r)<t?e=r:a=r,s++,!(s>o)););return(e+a)/2},_f=t=>{const{getIsKeyboardVisible:a}=du();let r=[],o=!1,s=!1;const i=()=>{r=[],o=!1,s=!1},l=v=>({x:v.clientX,y:v.clientY,time:performance.now()}),c=v=>{r=[l(v.touches[0])],o=!0},d=v=>{if(!o||s)return;r.push(l(v.touches[0]));const h=performance.now()-150;r=r.filter(K=>K.time>=h);const m=r.at(-1),y=r[0];if(!m||!y)return;const C=y.x,p=y.y,S=m.x,N=m.y,w=S-C,_=N-p,A=Math.abs(w)>Math.abs(_),B=Math.abs(w)>3;A&&B&&!a()&&(s=!0,v.preventDefault(),t([...r]),i())},u=()=>{i()};Pe(()=>(document.addEventListener("touchstart",c,{passive:!0}),document.addEventListener("touchmove",d,{passive:!1}),document.addEventListener("touchend",u,{passive:!0}),document.addEventListener("touchcancel",u,{passive:!0}),()=>{document.removeEventListener("touchstart",c),document.removeEventListener("touchmove",d),document.removeEventListener("touchend",u),document.removeEventListener("touchcancel",u)}))},Rs=5,Fs=.6,ca=.3;function gl(t,e){Ce(e,!0);let a=[],r=0,o=!1,s=0,i=0,l=0,c=0,d=0,u=null,v=null;const h=()=>{a=[],r=0,o=!1,s=0,i=0,l=0,c=0,d=0,u!==null&&(cancelAnimationFrame(u),u=null),v&&(clearTimeout(v),v=null)},m=()=>{e.onCancel(),h()},y=()=>{v&&clearTimeout(v),v=setTimeout(m,5e3)};_f(async B=>{if(!o)try{const K=B.at(-1);if(!K)throw new Error("No points available for swipe initialization");const O=await e.onInit();if(!O)return;s=O.initialPosition,i=O.currentPosition,l=O.minPosition,c=O.maxPosition,d=O.width,r=K.x,a=B,o=!0,y()}catch(K){console.error("Error during swipe initialization:",K),h()}});const p=B=>Math.max(l,Math.min(c,B)),S=()=>{if(u=null,!o){h();return}const B=a.at(-1),K=a[0];if(!B||!K)return;let O=B.x-r;r=B.x;const j=p(i+O);j!==i&&(i=j,e.onUpdate({initialPosition:s,newPosition:j,width:d,minPosition:l,maxPosition:c}))},N=B=>{if(!o){h();return}a.push({x:B.touches[0].clientX,y:B.touches[0].clientY,time:performance.now()});const K=performance.now()-150;a=a.filter(ce=>ce.time>=K),u===null&&(u=requestAnimationFrame(S)),y();const O=B.touches[0].clientX-a[0].x,j=B.touches[0].clientY-a[0].y;Math.abs(O)>Math.abs(j)&&B.cancelable&&B.preventDefault()},w=B=>{const K=Math.abs(B);if(K>=Fs)return Rs;if(K>=ca){const O=(K-ca)/(Fs-ca);return e.baseActionThreshold-O*(e.baseActionThreshold-Rs)}else return e.baseActionThreshold},_=B=>{if(!o){h();return}let K=0;a.push({x:B.changedTouches[0].clientX,y:B.changedTouches[0].clientY,time:performance.now()}),S(),u!==null&&(cancelAnimationFrame(u),u=null);const O=a[0],j=a[a.length-1],le=j.x-O.x,ce=j.time-O.time;ce>0&&(K=le/ce);const Q=w(K);e.onFinish({swipeVelocity:K,currentPosition:i,minPosition:l,maxPosition:c,initialPosition:s,width:d,actionThreshold:Q}),h()},A=()=>{m()};Pe(()=>(document.addEventListener("touchmove",N,{passive:!1}),document.addEventListener("touchend",_,{passive:!0}),document.addEventListener("touchcancel",A,{passive:!0}),()=>{document.removeEventListener("touchmove",N),document.removeEventListener("touchend",_),document.removeEventListener("touchcancel",A),u!==null&&cancelAnimationFrame(u),v&&clearTimeout(v)})),ke()}function wf(t,e){Ce(e,!0);const{setAnimationSettings:a}=Tn();let r=Fe(e,"animationRef",7),o=Fe(e,"dialog",7);gl(t,{baseActionThreshold:50,onInit:async()=>{if(!o())throw new Error("Dialog is not defined");if(!(e.sidebarState==="opened"||e.sidebarState==="closed"))return;const d=-e.dialogWidth*.7,u=0;let v=e.sidebarState==="closed"?d:u,h=e.sidebarState==="closed"?0:1;if(e.sidebarState==="opened"){let C=()=>1;if(r().current){r().current.pause();let p=Number(r().current.currentTime);br()&&(p=Number(p)+50,r().current.currentTime=Math.min(Math.max(Un-1,p),p));const S=r().current.effect?.getComputedTiming().progress||0;C=()=>S,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(p=>requestAnimationFrame(p)),h=Math.abs(1-C())}h=e.sidebarState==="closed"?h:1-h,o().style.setProperty("--backdrop-bg",`${h*.1}`),o()&&!o().open&&(o().showModal(),br()&&o().getBoundingClientRect()),a({isSwiping:!0,duration:0,swipingRatio:h*-25});const m=h*e.dialogWidth;o().style.setProperty("--transition-timing-dialog","0s");let y=e.sidebarState==="closed"?d:u;return e.sidebarState==="opened"||e.sidebarState==="closed"||(y=m),e.onSwipe(e.sidebarState==="closed"?"open":"close"),{initialPosition:v,currentPosition:y,minPosition:d,maxPosition:u,width:e.dialogWidth}},onCancel:()=>{a({isSwiping:!1}),e.onCancelSwipe(e.sidebarState==="swipingOpen"||e.sidebarState==="opened"||e.sidebarState==="opening")},onUpdate:({newPosition:d,width:u})=>{if(!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;const v=1-Math.abs(d/u)/7*10;o().style.transform=`translate3d(${d}px, 0, 0)`,a({swipingRatio:v*-25}),o().style.setProperty("--backdrop-bg",`${v*.1}`)},onFinish:({swipeVelocity:d,currentPosition:u,initialPosition:v,width:h,actionThreshold:m})=>{if(a({isSwiping:!1}),!o())throw new Error("Dialog is not defined");if(e.sidebarState!=="swipingOpen"&&e.sidebarState!=="swipingClose")return;let y="close";const C=Math.abs(u-v)/h*100/7*10;if(C===0&&e.sidebarState==="swipingOpen"){e.onCancelSwipe(!1);return}if(C===0&&e.sidebarState==="swipingClose"){e.onCancelSwipe(!0);return}e.sidebarState==="swipingOpen"?y=Math.abs(C)>m||d>ca?"open":"close":e.sidebarState==="swipingClose"&&(y=Math.abs(C)>m&&d<=ca||d<-ca?"close":"open");let p=vl(Math.abs(C)/100);e.sidebarState==="swipingClose"&&y==="close"&&(p=1-p);const N=(y==="open"?1-p:p)*Un/1e3;a({duration:N}),o().style.setProperty("--transition-timing-dialog",`${N}s`),o().style.setProperty("--backdrop-bg",`${y==="open"?.1:0}`),y==="open"?e.onOpen():y==="close"&&e.onClose()}}),ke()}var yf=k("<dialog><div><!> <!></div></dialog> <!> <!>",1);function bf(t,e){Ce(e,!0);const{getSidebarState:a,setSidebarState:r}=Dr();let o=L(0);Pe(()=>{const F=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",F),F(),()=>{window.removeEventListener("resize",F)}});const{setAnimationSettings:s,getAnimationSettings:i}=Tn(),{isScrolling:l}=ds();let c=L(null),d=L(null),u={},v=D(a);const h=()=>{e.blocked||r("closing")},m=F=>{r(F==="open"?"swipingOpen":"swipingClose")},y=()=>{r("opened")},C=()=>{r("preOpening")},p=()=>{n(c)?.close(),r("closed")},S=F=>{F.preventDefault(),h()};Pe(()=>(n(c)?.addEventListener("close",p),n(c)?.addEventListener("cancel",S),()=>{n(c)?.removeEventListener("close",p),n(c)?.removeEventListener("cancel",S)}));const N=D(l);let w=D(()=>i().working);const _=F=>{F?(r("opened"),s({swipingRatio:-25})):(r("closed"),s({swipingRatio:0}),n(c)?.close()),n(c)&&(n(c).style.removeProperty("--transition-timing-dialog"),n(c).style.removeProperty("--backdrop-bg")),s({duration:Pa().duration})};Ke(()=>{n(v)==="opening"?Ct(()=>{s({working:!0}),requestAnimationFrame(()=>{if(!n(c))return;s({swipingRatio:-25}),n(c).style.removeProperty("--backdrop-bg");const F=n(c).style.transform||"translate3d(-100%, 0, 0)";n(c).style.transform="";const oe=n(c)?.animate([{transform:F},{transform:"translate3d(0, 0, 0)"}],{duration:i().duration*1e3||Un,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});u.current=oe,oe&&(oe.onfinish=()=>{y(),s({swipingRatio:-25}),n(c)&&(n(c).style.removeProperty("--transition-timing-dialog"),n(c).style.removeProperty("--backdrop-bg")),s({duration:Pa().duration}),oe.cancel(),u.current=void 0})})}):n(v)==="closing"&&Ct(()=>{requestAnimationFrame(()=>{if(!n(c))return;s({swipingRatio:0}),n(c).style.removeProperty("--backdrop-bg");const F=n(c).style.transform||"translate3d(0, 0, 0)";n(c).style.transform="";const oe=n(c)?.animate([{transform:F},{transform:"translate3d(-100%, 0, 0)"}],{duration:i().duration*1e3||Un,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});u.current=oe,oe&&(oe.onfinish=()=>{p(),n(c)&&(n(c).style.removeProperty("--transition-timing-dialog"),n(c).style.removeProperty("--backdrop-bg")),s({duration:Pa().duration}),oe.cancel(),u.current=void 0})})})}),Ke(()=>{n(v)==="preOpening"&&(n(c)?.open||(n(c)?.showModal(),br()&&n(c)?.getBoundingClientRect()),r("opening"))}),Pe(()=>{n(v)==="opened"&&r("preOpening")});var A=yf(),B=M(A),K=b(B),O=b(K);je(O,()=>e.children);var j=I(O,2);{var le=F=>{ho(F,{})};W(j,F=>{n(v)==="opened"&&F(le)})}et(K,F=>f(d,F),()=>n(d)),et(B,F=>f(c,F),()=>n(c));var ce=I(B,2);{var Q=F=>{fs(F,{get dialog(){return n(c)},get dialogInner(){return n(d)},onClose:h})};W(ce,F=>{n(d)&&n(v)==="opened"&&!e.blocked&&F(Q)})}var $=I(ce,2);{var Y=F=>{wf(F,{onCancelSwipe:_,onOpen:C,onClose:h,onSwipe:m,get dialogWidth(){return n(o)},get animationRef(){return u},get dialog(){return n(c)},get sidebarState(){return n(v)}})};W($,F=>{!n(N)&&!e.blocked&&F(Y)})}De(()=>{tt(B,1,at({a:!0,b:n(w),c:n(v)==="opened"||n(v)==="opening"||n(v)==="closing"||n(v)==="swipingClose",d:n(v)==="opened"||n(v)==="opening"||n(v)==="swipingOpen"}),"p-1gucilc"),tt(K,1,at({e:!0,f:n(v)==="swipingOpen",g:n(v)!=="opened"}),"p-1gucilc")}),g(t,A),ke()}var Sf=k('<div class="a p-1lsyiiu"><div class="b p-1lsyiiu"><!> <div class="c p-1lsyiiu"><a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a> <a class="d p-1lsyiiu"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a></div></div> <div class="e p-1lsyiiu"><!></div> <!></div> <!>',1),Cf=k('<div class="f p-1lsyiiu"><div class="e p-1lsyiiu"><!></div> <div class="g p-1lsyiiu"><div class="a p-1lsyiiu"><!></div> <!></div></div>');function kf(t,e){Ce(e,!0);const{checkMobileSize:a}=va(),{sidebarClose:r,getSidebarState:o,sidebarOpen:s}=Dr(),{getDialogPages:i,createDialogPageHref:l,createHandleClickDialogPage:c}=Ot(),{getTagsSearch:d,setTagsSearch:u}=vd(),{getSelectedTags:v,addTag:h,removeTag:m,clearTags:y}=Xn(),{getSelectedMetaTags:C,addMetaTag:p,removeMetaTag:S,clearSelectedMetaTags:N}=go();let w=D(v),_=D(C);const{getGetNotes:A,checkNotesInArchive:B,checkNotesInBin:K}=At(),O=D(A),j=fe=>{h(fe)},le=fe=>{p(fe)},ce=fe=>{m(fe)},Q=fe=>{S(fe)};let $=D(()=>n(w).size===0&&!n(_).has(ot.INBOX)&&(n(O)()||[]).some(fe=>(!n(_).has(ot.ARCHIVED)&&!n(_).has(ot.BIN)&&fe?.data&&!fe.data.deletedAt&&!fe.data.archivedAt||n(_).has(ot.ARCHIVED)&&fe?.data&&!fe.data.deletedAt&&fe.data.archivedAt||n(_).has(ot.BIN)&&fe?.data&&fe.data.deletedAt)&&fe?.data?.tags.length===0)),Y=D(()=>Jo(n(_),n(w),n(O)()||[],fe=>!(fe?.data&&(fe.data.deletedAt||fe.data.archivedAt)&&!n(_).has(ot.ARCHIVED)&&!n(_).has(ot.BIN)||fe?.data&&(fe.data.deletedAt||!fe.data.archivedAt)&&n(_).has(ot.ARCHIVED)||fe?.data&&!fe.data.deletedAt&&n(_).has(ot.BIN)))),F=D(()=>n(Y).filter(fe=>d()===""||fe.toLowerCase().indexOf(d().toLowerCase())!==-1)),oe=D(a);const{checkExistedDialog:G}=$t();let H=D(()=>i().length>0||G());const te=()=>{if(n(oe)){if(n(H))return;o()==="opened"?r():o()==="closed"&&s()}};Pe(()=>Sr({key:"b",meta:!0,action:te})),Pe(()=>Sr({key:"b",ctrl:!0,action:te}));let ge=D(()=>[...n($)&&n(_).size===0?[ot.INBOX]:[],...n(_).size===0?[...B()&&n(w).size===0?[ot.ARCHIVED]:[],...K()&&n(w).size===0?[ot.BIN]:[]]:[]].filter(fe=>d()===""||fe.toLowerCase().indexOf(d().toLowerCase())!==-1).sort((fe,me)=>fe===ot.INBOX?-1:me===ot.INBOX?1:fe.localeCompare(me)));var se=be(),ue=M(se);{var ee=fe=>{bf(fe,{get blocked(){return n(H)},children:(me,X)=>{var ie=Sf(),de=M(ie),Ae=b(de),Ee=b(Ae);fl(Ee,{});var pe=I(Ee,2),ae=b(pe),xe=D(()=>c(Te.Settings));ae.__click=function(...E){n(xe)?.apply(this,E)};var ye=b(ae);he(ye,()=>({"--size":"24px"})),_e(ye.lastChild,{name:"settings"});var Me=I(ye,2);wt(Me,{children:(E,x)=>{var R=Ve("Settings");g(E,R)}});var Re=I(ae,2),ve=D(()=>c(Te.Sync));Re.__click=function(...E){n(ve)?.apply(this,E)};var Se=b(Re);he(Se,()=>({"--size":"24px"})),_e(Se.lastChild,{name:"sync"});var Oe=I(Se,2);wt(Oe,{children:(E,x)=>{var R=Ve("Sync");g(E,R)}});var Be=I(Ae,2),Ze=b(Be);{let E=D(d);Ho(Ze,{placeholder:"Search tag",get value(){return n(E)},onChange:x=>{u(x)}})}var Ge=I(Be,2);{let E=D(()=>n(_).has(ot.BIN));Ls(Ge,{get clearTags(){return y},get clearMetaTags(){return N},get hideTagMenu(){return n(E)},handleMetaTagClick:Q,get metaTags(){return n(_)},get selectedTags(){return n(w)},handleSelectedTagClick:ce})}var P=I(de,2);{let E=D(()=>n(_).has(ot.BIN));Is(P,{get hideTagMenu(){return n(E)},get metaTags(){return n(ge)},get tags(){return n(F)},handleMetaTagClick:le,handleTagClick:j,mobile:!0})}De((E,x)=>{ut(ae,"href",E),ut(Re,"href",x)},[()=>l(Te.Settings),()=>l(Te.Sync)]),g(me,ie)},$$slots:{default:!0}})},we=fe=>{var me=Cf(),X=b(me),ie=b(X);{let ae=D(d);Ho(ie,{placeholder:"Search tag",get value(){return n(ae)},onChange:xe=>{u(xe)}})}var de=I(X,2),Ae=b(de),Ee=b(Ae);{let ae=D(()=>n(_).has(ot.BIN));Ls(Ee,{get metaTags(){return n(_)},get clearTags(){return y},get clearMetaTags(){return N},get hideTagMenu(){return n(ae)},get selectedTags(){return n(w)},handleMetaTagClick:Q,handleSelectedTagClick:ce})}var pe=I(Ae,2);{let ae=D(()=>n(_).has(ot.BIN));Is(pe,{get metaTags(){return n(ge)},get hideTagMenu(){return n(ae)},get tags(){return n(F)},handleMetaTagClick:le,handleTagClick:j})}g(fe,me)};W(ue,fe=>{n(oe)?fe(ee):fe(we,!1)})}g(t,se),ke()}mt(["click"]);var xf=k('<button class="a p-tddkdb"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>');function Tf(t,e){Ce(e,!0);let a=Fe(e,"ref",15);var r=xf();r.__click=function(...i){e.onClick?.apply(this,i)};var o=b(r);he(o,()=>({"--rotate":"-90deg"})),_e(o.lastChild,{name:"menu"});var s=I(o,2);wt(s,{children:(i,l)=>{var c=Ve();De(()=>vt(c,e.title)),g(i,c)}}),et(r,i=>a(i),()=>a()),g(t,r),ke()}mt(["click"]);const Zo=t=>{try{new URL(t)}catch{return!1}return!0};var Pf=k('<div class="b p-z67y1l">Add tag for selected notes</div> <!> <div class="c p-z67y1l"><!> <!></div>',1),Ef=k('<form class="a p-z67y1l"><!></form>');function Nf(t,e){Ce(e,!0);const{addTag:a}=At(),{getSelectedTags:r}=Xn(),{getSelectedNotes:o}=ua(),{getFiltredNotes:s}=La();let i=L(!1),l=L(!1),c,d=!1,u=L(null),v=L(""),h=e.nextFocusRef;Pe(()=>(n(u)&&n(u).focus(),()=>{c&&clearTimeout(c)}));const m=()=>{c=setTimeout(()=>{f(l,!0)},250)},y=()=>{f(i,!0)},C=async()=>{if(r().has(n(v).trim())){y();return}if(n(v).trim()!=="")try{m();const w=new Set(o()),_=w.size?[...w]:s().map(B=>B.id),{cancel:A}=await a(n(v).trim(),_);nt("Tag added",{cancel:{nextFocusRef:h,onCancel:async()=>{await A(),setTimeout(()=>{const{prev:B}=bt(h);B?.focus()},16)}}}),d=!0}finally{f(i,!0)}},p=()=>{e.onClosed?.(d)},S=N=>{N.preventDefault(),C()};Ir(t,{get blocked(){return n(l)},get startClose(){return n(i)},onClosed:p,children:(N,w)=>{var _=Ef(),A=b(_);{var B=O=>{Ra(O,{})},K=O=>{var j=Pf(),le=I(M(j),2);Cr(le,{placeholder:"Enter new tag name",get ref(){return n(u)},set ref(Y){f(u,Y,!0)},get value(){return n(v)},set value(Y){f(v,Y,!0)}});var ce=I(le,2),Q=b(ce);Rt(Q,{size:"small",onClick:y,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(Y,F)=>{var oe=Ve("Cancel");g(Y,oe)},$$slots:{default:!0}});var $=I(Q,2);Rt($,{size:"small",onClick:C,fullWidth:!0,withoutMinWidth:!0,children:(Y,F)=>{var oe=Ve("OK");g(Y,oe)},$$slots:{default:!0}}),g(O,j)};W(A,O=>{n(l)?O(B):O(K,!1)})}Qt("submit",_,S),g(N,_)},$$slots:{default:!0}}),ke()}var Af=k('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Df=k('<div><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></div>'),Mf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),If=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),Lf=k("<div><!></div>"),Rf=k('<form class="c p-r3if1j"><div class="d p-r3if1j"><!></div> <button type="button" class="e p-r3if1j">Done</button></form>'),Ff=k('<div class="a"><div class="b p-r3if1j"><!> <!> <!> <!> <!> <!></div> <!></div>');function hl(t,e){Ce(e,!0);const{isInitedNotes:a,getGetMapTags:r,getGetNotes:o}=At(),{getSelectedTags:s}=Xn();let i=L(null),l=L(""),c=L(null);const d=D(a);let u=Fe(e,"shownTagInput",15);const v=()=>n(d)?e.mode==="exit"?Jo(new Set,new Set(e.selectedTags),o()()||[]):[...r()().keys()]:[];let m=D(()=>{const H=s(),te=new Set(Jo(new Set,new Set(e.selectedTags.length>0?e.selectedTags:H),o()()||[]));return v().filter(se=>e.selectedTags.some(ue=>se===ue)?!1:n(l)===""||se.toLowerCase().indexOf(n(l).toLowerCase())===0).sort((se,ue)=>H.has(se)&&H.has(ue)?se.localeCompare(ue):H.has(se)?-1:H.has(ue)?1:te.has(se)&&te.has(ue)?se.localeCompare(ue):te.has(se)?-1:te.has(ue)?1:0)});const y=H=>{if(!e.selectedTags.includes(H)){if(e.mode!=="exit"||n(m).includes(H)){e.onChangeTags([...e.selectedTags,H]),f(l,"");return}n(i)?.focus()}},C=H=>{const te=e.selectedTags.filter(ge=>ge!==H);e.onRejectedTag&&e.onRejectedTag(H),te.length===0?e.onChangeTags([]):e.onChangeTags(te)},p=H=>{H.preventDefault(),n(l)!==""?y(n(l)):u(!1)};Ke(()=>{n(i)&&u()&&n(i).focus(),u()||f(l,"")});const S=H=>{H.preventDefault()},N=H=>{H.preventDefault(),H.stopPropagation(),H.stopImmediatePropagation()};var w=Ff(),_=b(w),A=b(_);Hn(A,17,()=>e.selectedTags,H=>H+"-tags_selected",(H,te)=>{ha(H,{onPointerDown:S,onTouchStart:N,onClick:()=>{C(n(te))},type:"button",style:"selected",children:(ge,se)=>{var ue=Ve();De(()=>vt(ue,n(te))),g(ge,ue)},$$slots:{default:!0}})});var B=I(A,2);{var K=H=>{var te=be(),ge=M(te);Hn(ge,17,()=>n(m).filter(se=>se.toLowerCase()!==n(l).toLowerCase()).slice(0,Math.max(3,3-e.selectedTags.length)),se=>se+"-tags_suggested",(se,ue)=>{ha(se,{onPointerDown:S,onTouchStart:N,onClick:()=>{y(n(ue))},children:(ee,we)=>{var fe=Ve();De(()=>vt(fe,n(ue))),g(ee,fe)},$$slots:{default:!0}})}),g(H,te)};W(B,H=>{u()&&H(K)})}var O=I(B,2);{var j=H=>{ha(H,{onPointerDown:S,onTouchStart:N,onClick:()=>{y(n(l)),f(l,"")},children:(te,ge)=>{var se=Ve();De(()=>vt(se,n(l))),g(te,se)},$$slots:{default:!0}})};W(O,H=>{n(l)!==""&&(e.mode!=="exit"||n(m).find(te=>te.toLowerCase()===n(l).toLowerCase()))&&H(j)})}var le=I(O,2);{var ce=H=>{ha(H,{mode:"empty",onPointerDown:S,onTouchStart:N,onClick:()=>{u(!0)},children:(te,ge)=>{var se=Af(),ue=b(se);he(ue,()=>({"--size":"12px"})),_e(ue.lastChild,{name:"plus"});var ee=I(ue,2);wt(ee,{children:(we,fe)=>{var me=Ve("add tag");g(we,me)}}),g(te,se)},$$slots:{default:!0}})};W(le,H=>{u()||H(ce)})}var Q=I(le,2);{var $=H=>{ha(H,{mode:"empty",onPointerDown:S,onTouchStart:N,get onClick(){return e.onUsePreviousTags},children:(te,ge)=>{var se=Df(),ue=b(se);he(ue,()=>({"--size":"12px"})),_e(ue.lastChild,{name:"back"});var ee=I(ue,2);wt(ee,{children:(we,fe)=>{var me=Ve("use previous tags");g(we,me)}}),g(te,se)},$$slots:{default:!0}})};W(Q,H=>{e.previousTagsEnabled&&e.onUsePreviousTags&&H($)})}var Y=I(Q,2);{var F=H=>{ha(H,{mode:"empty",onPointerDown:S,onTouchStart:N,get onClick(){return e.onGenTags},get disabled(){return e.generatingTags},children:(te,ge)=>{var se=Lf(),ue=b(se);{var ee=fe=>{var me=Mf(),X=M(me);he(X,()=>({"--size":"12px"})),Ra(X.lastChild,{}),g(fe,me)},we=fe=>{var me=If(),X=M(me);he(X,()=>({"--size":"12px","--rotate":"180deg"})),_e(X.lastChild,{name:"stars"});var ie=I(X,2);wt(ie,{children:(de,Ae)=>{var Ee=Ve("gen tags");g(de,Ee)}}),g(fe,me)};W(ue,fe=>{e.generatingTags?fe(ee):fe(we,!1)})}g(te,se)},$$slots:{default:!0}})};W(Y,H=>{e.genTagsEnabled&&e.onGenTags&&H(F)})}var oe=I(_,2);{var G=H=>{var te=Rf(),ge=b(te),se=b(ge);Cr(se,{placeholder:"tag",get ref(){return n(i)},set ref(ee){f(i,ee,!0)},get value(){return n(l)},set value(ee){f(l,ee,!0)}});var ue=I(ge,2);ue.__pointerdown=S,ue.__touchstart=N,ue.__click=()=>{n(i)?.blur(),n(l)!==""&&y(n(l)),u(!1),f(l,"")},Qt("submit",te,p),g(H,te)};W(oe,H=>{u()&&H(G)})}et(w,H=>f(c,H),()=>n(c)),g(t,w),ke()}mt(["pointerdown","touchstart","click"]);var Of=k('<div class="c p-z67y1l"><!> <!></div>'),zf=k('<div class="b p-z67y1l">Change tags for selected notes</div> <!> <!>',1),Bf=k('<form class="a p-z67y1l"><!></form>');function jf(t,e){Ce(e,!0);const{changeTags:a,getNoteById:r}=At(),{getSelectedTags:o}=Xn(),{getSelectedNotes:s}=ua(),{getFiltredNotes:i}=La();let l=L(!1),c=L(!1),d,u=!1,v=L(!1),h=e.nextFocusRef,y=(()=>{const K=[...o()],O=s();if(O.size===0)return K;const j=Array.from(O);let le=new Set(r(j[0])?.data.tags||[]);for(let ce=1;ce<j.length;ce++){const Q=new Set(r(j[ce])?.data.tags||[]),$=new Set([]);Q.forEach(Y=>{le.has(Y)&&$.add(Y)}),le=$}return Array.from(le)})(),C=L(ft(y));Pe(()=>()=>{d&&clearTimeout(d)});const p=()=>{d=setTimeout(()=>{f(c,!0)},250)},S=()=>{f(l,!0)},N=async()=>{const K=y,O=new Set(s()),j=O.size?[...O]:i().map(le=>le.id);try{p();const{cancel:le}=await a([...K],n(C),j);nt("Tags changed",{cancel:{nextFocusRef:h,onCancel:async()=>{await le(),setTimeout(()=>{const{prev:ce}=bt(h);ce?.focus()},16)}}}),u=!0}finally{f(l,!0)}},w=K=>{K.key==="Escape"&&n(v)&&(f(v,!1),K.preventDefault(),K.stopPropagation())};Pe(()=>(document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)));const _=()=>{e.onClosed?.(u)},A=K=>{f(C,K,!0)},B=K=>{K.preventDefault(),N()};Ir(t,{get blocked(){return n(c)},get startClose(){return n(l)},onClosed:_,children:(K,O)=>{var j=Bf(),le=b(j);{var ce=$=>{Ra($,{})},Q=$=>{var Y=zf(),F=I(M(Y),2);hl(F,{get selectedTags(){return n(C)},onChangeTags:A,get shownTagInput(){return n(v)},set shownTagInput(H){f(v,H,!0)}});var oe=I(F,2);{var G=H=>{var te=Of(),ge=b(te);Rt(ge,{size:"small",onClick:S,fullWidth:!0,withoutMinWidth:!0,type:"secondary",children:(ue,ee)=>{var we=Ve("Cancel");g(ue,we)},$$slots:{default:!0}});var se=I(ge,2);Rt(se,{size:"small",onClick:N,fullWidth:!0,withoutMinWidth:!0,children:(ue,ee)=>{var we=Ve("OK");g(ue,we)},$$slots:{default:!0}}),g(H,te)};W(oe,H=>{n(v)||H(G)})}g($,Y)};W(le,$=>{n(c)?$(ce):$(Q,!1)})}Qt("submit",j,B),g(K,j)},$$slots:{default:!0}}),ke()}var Hf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Open links',1),Uf=k('<li class="p-66dk2x"><!></li>'),Wf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy',1),Vf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Copy links',1),Kf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),qf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share links',1),Gf=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),Yf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Add tag',1),Xf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Change tags',1),Jf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Archive',1),Zf=k('<li class="p-66dk2x"><!></li>'),Qf=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move from Archive',1),$f=k('<li class="p-66dk2x"><!></li>'),ev=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Move to Bin',1),tv=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <li class="p-66dk2x"><!></li>',1),nv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Restore',1),av=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Delete notes',1),rv=k('<li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li>',1),ov=k('<!> <!> <li class="p-66dk2x"><!></li> <li class="p-66dk2x"><!></li> <!> <!> <!>',1),sv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),iv=k('<div class="a p-66dk2x"><!></div> <!> <!> <!>',1);function lv(t,e){Ce(e,!0);const{getSelectedTags:a,setSelectedTags:r,clearTags:o}=Xn(),{moveNotesToBin:s,moveNotesToArchive:i,moveNotesFromArchive:l,restoreNotesFromBin:c,deleteNotes:d}=At(),{getFiltredNotes:u}=La(),{getSelectedNotes:v,setSelectedNotes:h,clearNotes:m}=ua();let y=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"}),C=D(a),p=L(!1),S=L(!1),N=L(!1),w=L(!1),_=L(null),A=L(null);const B=()=>{n(p)||f(p,!0)},K=()=>{f(p,!1),f(S,!1)};Ke(()=>{!n(p)&&!n(N)&&!n(w)&&f(_,bt(n(A)).next,!0)}),Pe(()=>{const pe=ae=>{ae.key==="Escape"&&n(p)&&n(A)?.focus()};return window.addEventListener("keydown",pe),()=>{window.removeEventListener("keydown",pe)}});let O=()=>{};const j=()=>{f(S,!0),f(N,!0);let pe=n(A);O=()=>{f(N,!1),setTimeout(()=>{pe?.focus()},16)}};let le=()=>{};const ce=()=>{f(S,!0),f(w,!0);let pe=n(A);le=()=>{f(w,!1),setTimeout(()=>{pe?.focus()},16)}},Q=async()=>{const pe=Array.from(n(C)),ae=new Set(v()),xe=ae.size?[...ae]:u().map(Me=>Me.id),{cancel:ye}=await s({noteIds:xe});o(),m(),nt("Notes moved to bin",{cancel:{nextFocusRef:n(_),onCancel:async()=>{await ye(),r(new Set(pe)),h(ae),setTimeout(()=>{const{prev:Me}=bt(n(_));Me?.focus()},16)}}}),f(S,!0)},$=async()=>{const pe=Array.from(n(C)),ae=new Set(v()),xe=ae.size?[...ae]:u().map(Me=>Me.id),{cancel:ye}=await i({noteIds:xe});o(),m(),nt("Notes moved to archive",{cancel:{nextFocusRef:n(_),onCancel:async()=>{await ye(),r(new Set(pe)),h(ae),setTimeout(()=>{const{prev:Me}=bt(n(_));Me?.focus()},16)}}}),f(S,!0)},Y=async()=>{const pe=Array.from(n(C)),ae=new Set(v()),xe=ae.size?[...ae]:u().map(Me=>Me.id),{cancel:ye}=await l({noteIds:xe});o(),m(),nt("Notes moved from archive",{cancel:{nextFocusRef:n(_),onCancel:async()=>{await ye(),r(new Set(pe)),h(ae),setTimeout(()=>{const{prev:Me}=bt(n(_));Me?.focus()},16)}}}),f(S,!0)},F=async()=>{const pe=Array.from(n(C)),ae=new Set(v()),xe=ae.size?[...ae]:u().map(Me=>Me.id),{cancel:ye}=await c({noteIds:xe});o(),m(),nt("Notes restored",{cancel:{nextFocusRef:n(_),onCancel:async()=>{await ye(),r(new Set(pe)),h(ae),setTimeout(()=>{const{prev:Me}=bt(n(_));Me?.focus()},16)}}}),f(S,!0)},oe=()=>{const pe=new Set(v()),ae=pe.size?[...pe]:u().map(xe=>xe.id);f(S,!0),Ka({title:"Are you sure you want to delete notes?",buttonConfirmTitle:"Delete",onConfirm:async()=>{f(S,!0),o(),m(),await d({noteIds:ae})},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(A)?.focus()},16)}})},G=()=>{const pe=u(),ae=Array.from(v()),xe=[];for(const Me of pe)Me.data&&Me.data?.link&&Zo(Me.data?.link.url)&&(ae.includes(Me.id)||ae.length===0)&&xe.push(Me.data?.link.url);const ye=()=>{for(const Me of xe)if(!window.open(Me,"_blank")){Ka({title:"Pop-up blocked! Please allow pop-ups",buttonConfirmTitle:"OK",type:"standard",onConfirm:async()=>{},onClosed:async()=>{setTimeout(()=>{n(A)?.focus()},16)}});break}};xe.length<=10?ye():Ka({title:`Are you sure to open ${xe.length} links?`,buttonConfirmTitle:"Open",type:"standard",onConfirm:async()=>{ye()},onCancel:async()=>{},onClosed:async()=>{setTimeout(()=>{n(A)?.focus()},16)}}),f(S,!0)},H=()=>{const pe=u(),ae=Array.from(v());let xe="";for(const ye of pe)ye.data&&ye.data?.link&&Zo(ye.data?.link.url)&&(ae.includes(ye.id)||ae.length===0)&&(xe+=ye.data?.link.url+`
`);navigator.clipboard.writeText(xe),nt("Copied links"),f(S,!0)},te=()=>{const pe=u(),ae=Array.from(v());let xe="";for(const ye of pe)ye.data&&(ae.includes(ye.id)||ae.length===0)&&(ye.data?.link?.url&&(xe+=ye.data?.link.url+`
`),ye.data?.text&&(xe+=`
`+ye.data?.text+`
`),xe+=`---------------------

`);navigator.clipboard.writeText(xe),nt("Copied notes"),f(S,!0)},ge=()=>{const pe=u(),ae=Array.from(v());let xe="";for(const ye of pe)ye.data&&(ae.includes(ye.id)||ae.length===0)&&ye.data?.link?.url&&(xe+=ye.data?.link.url+`

`);navigator.share({text:xe}).catch(ye=>{ye.name!=="AbortError"&&console.error("Error sharing",ye)}),f(S,!0)},se=()=>{const pe=u(),ae=Array.from(v());let xe="";for(const ye of pe)ye.data&&(ae.includes(ye.id)||ae.length===0)&&(ye.data?.link?.url&&(xe+=ye.data?.link.url+`
`),ye.data?.text&&(xe+=`
`+ye.data?.text+`
`),xe+=`---------------------

`);navigator.share({text:xe}).catch(ye=>{ye.name!=="AbortError"&&console.error("Error sharing",ye)}),f(S,!0)};let ue=Kn||qn;var ee=iv(),we=M(ee),fe=b(we);Tf(fe,{title:"notes menu",onClick:B,get ref(){return n(A)},set ref(pe){f(A,pe,!0)}});var me=I(we,2);{var X=pe=>{var ae=sv(),xe=M(ae);he(xe,()=>({"--right":"0","--top":"44px"})),Lr(xe.lastChild,{get startClose(){return n(S)},onClosed:K,get isMobile(){return ue},children:(ye,Me)=>{var Re=ov(),ve=M(Re);{var Se=q=>{var Z=Uf(),re=b(Z);Ue(re,{onClick:G,get dialogMode(){return ue},children:(U,ne)=>{var Ne=Hf(),ze=M(Ne);he(ze,()=>({"--size":"20px","--scale":"0.9"})),_e(ze.lastChild,{name:"open"}),g(U,Ne)},$$slots:{default:!0}}),g(q,Z)};W(ve,q=>{Kn||qn||q(Se)})}var Oe=I(ve,2);W(Oe,q=>{});var Be=I(Oe,2),Ze=b(Be);Ue(Ze,{onClick:te,get dialogMode(){return ue},children:(q,Z)=>{var re=Wf(),U=M(re);he(U,()=>({"--size":"20px"})),_e(U.lastChild,{name:"copy"}),g(q,re)},$$slots:{default:!0}});var Ge=I(Be,2),P=b(Ge);Ue(P,{onClick:H,get dialogMode(){return ue},children:(q,Z)=>{var re=Vf(),U=M(re);he(U,()=>({"--size":"20px"})),_e(U.lastChild,{name:""}),g(q,re)},$$slots:{default:!0}});var E=I(Ge,2);{var x=q=>{var Z=Gf(),re=M(Z),U=b(re);Ue(U,{onClick:se,get dialogMode(){return ue},children:(ze,Le)=>{var Ie=Kf(),He=M(Ie);he(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"share"}),g(ze,Ie)},$$slots:{default:!0}});var ne=I(re,2),Ne=b(ne);Ue(Ne,{onClick:ge,get dialogMode(){return ue},children:(ze,Le)=>{var Ie=qf(),He=M(Ie);he(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:""}),g(ze,Ie)},$$slots:{default:!0}}),g(q,Z)};W(E,q=>{y&&q(x)})}var R=I(E,2);{var z=q=>{var Z=tv(),re=M(Z),U=b(re);Ue(U,{onClick:j,get dialogMode(){return ue},children:(ct,st)=>{var it=Yf(),_t=M(it);he(_t,()=>({"--size":"20px"})),_e(_t.lastChild,{name:"add"}),g(ct,it)},$$slots:{default:!0}});var ne=I(re,2),Ne=b(ne);Ue(Ne,{onClick:ce,get dialogMode(){return ue},children:(ct,st)=>{var it=Xf(),_t=M(it);he(_t,()=>({"--size":"20px"})),_e(_t.lastChild,{name:""}),g(ct,it)},$$slots:{default:!0}});var ze=I(ne,2);{var Le=ct=>{var st=Zf(),it=b(st);Ue(it,{onClick:$,get dialogMode(){return ue},children:(_t,Pn)=>{var Bt=Jf(),Dt=M(Bt);he(Dt,()=>({"--size":"20px","--scale":"0.9"})),_e(Dt.lastChild,{name:"archive"}),g(_t,Bt)},$$slots:{default:!0}}),g(ct,st)},Ie=ct=>{var st=$f(),it=b(st);Ue(it,{onClick:Y,get dialogMode(){return ue},children:(_t,Pn)=>{var Bt=Qf(),Dt=M(Bt);he(Dt,()=>({"--size":"20px","--scale":"0.9"})),_e(Dt.lastChild,{name:"archive-cancel"}),g(_t,Bt)},$$slots:{default:!0}}),g(ct,st)};W(ze,ct=>{e.mode==="notes"?ct(Le):ct(Ie,!1)})}var He=I(ze,2),pt=b(He);Ue(pt,{onClick:Q,get dialogMode(){return ue},children:(ct,st)=>{var it=ev(),_t=M(it);he(_t,()=>({"--size":"20px"})),_e(_t.lastChild,{name:"bin"}),g(ct,it)},$$slots:{default:!0}}),g(q,Z)};W(R,q=>{(e.mode==="notes"||e.mode==="archive")&&q(z)})}var T=I(R,2);{var J=q=>{var Z=rv(),re=M(Z),U=b(re);Ue(U,{onClick:F,get dialogMode(){return ue},children:(ze,Le)=>{var Ie=nv(),He=M(Ie);he(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"bin-cancel"}),g(ze,Ie)},$$slots:{default:!0}});var ne=I(re,2),Ne=b(ne);Ue(Ne,{onClick:oe,get dialogMode(){return ue},dangerous:!0,children:(ze,Le)=>{var Ie=av(),He=M(Ie);he(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"bin"}),g(ze,Ie)},$$slots:{default:!0}}),g(q,Z)};W(T,q=>{e.mode==="bin"&&q(J)})}g(ye,Re)},$$slots:{default:!0}}),g(pe,ae)};W(me,pe=>{n(p)&&pe(X)})}var ie=I(me,2);{var de=pe=>{Nf(pe,{get nextFocusRef(){return n(_)},onClosed:ae=>{O(ae)}})};W(ie,pe=>{n(N)&&pe(de)})}var Ae=I(ie,2);{var Ee=pe=>{jf(pe,{get nextFocusRef(){return n(_)},onClosed:ae=>{le(ae)}})};W(Ae,pe=>{n(w)&&pe(Ee)})}g(t,ee),ke()}var cv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),dv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),uv=k('<li class="p-1ljon4s"><!></li>'),fv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy link',1),vv=k('<li class="p-1ljon4s"><!></li>'),gv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),hv=k('<li class="p-1ljon4s"><!></li>'),pv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),mv=k('<li class="p-1ljon4s"><!></li>'),_v=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Select',1),wv=k('<li class="p-1ljon4s"><!></li>'),yv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),bv=k('<li class="p-1ljon4s"><!></li>'),Sv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Cv=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),kv=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),xv=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),Tv=k(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Pv=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Ev=k('<li class="p-1ljon4s"><!></li> <!> <!> <!> <!> <!> <!> <!>',1),Nv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Av(t,e){Ce(e,!0);const{checkMobileSize:a}=va(),{getMode:r,getSelectedNotes:o,changeMode:s,addNote:i}=ua(),{clearDialogPages:l}=Ot(),{setFeedSearch:c}=Aa(),{moveNoteToBin:d,moveNoteFromArchive:u,moveNoteToArchive:v,deleteNote:h,pinNote:m,restoreNoteFromBin:y,checkDuplicatesExist:C}=At();let p=Fe(e,"mode",3,"notes"),S=Fe(e,"shownMenu",15),N=L(!1),w=L(!1),_=L(!1),A=L(!1),B=L(!1),K=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const O=async()=>{d(e.noteId),nt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{y(e.noteId)}}})},j=async()=>{v(e.noteId),nt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{u(e.noteId)}}})},le=async()=>{u(e.noteId),nt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{v(e.noteId)}}})},ce=()=>{y(e.noteId),nt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{d(e.noteId)}}})},Q=()=>{e.noteData.pinned?(m(e.noteId,!1),nt("unpinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{m(e.noteId,!0)}}})):(m(e.noteId,!0),nt("pinned",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{m(e.noteId,!1)}}})),f(N,!0)},$=()=>{n(w)?(f(w,!1),O()):n(B)?(f(B,!1),ce()):n(_)?(f(_,!1),j()):n(A)&&(f(A,!1),le()),S(!1),f(N,!1)},Y=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link?.url),nt("Copied link"),f(N,!0))},F=()=>{let me="";e.noteData.link?.url&&(me+=e.noteData.link.url+`
`),e.noteData.text&&(me+=`
`+e.noteData.text+`
`),navigator.clipboard.writeText(me),nt("Copied"),f(N,!0)},oe=()=>{f(N,!0),Ka({title:"Are you sure you want to delete this note?",buttonConfirmTitle:"Delete",onConfirm:async()=>{await h(e.noteId)},onCancel:async()=>{}})},G=()=>{if(navigator.share){const me={};let X="";e.noteData.link?.url&&(X+=e.noteData.link.url+`
`),e.noteData.text&&(X+=`
`+e.noteData.text+`
`),me.text=X,navigator.share(me).catch(ie=>{ie.name!=="AbortError"&&console.error("Error sharing",ie)})}f(N,!0)},H=()=>{if(navigator.share){const me={};e.noteData.link?.url&&(me.url=e.noteData.link.url),e.noteData.link?.title&&(me.title=e.noteData.link.title),navigator.share(me).catch(X=>{X.name!=="AbortError"&&console.error("Error sharing",X)})}f(N,!0)},te=()=>{f(N,!0),e.noteData.link?.url&&(l(),c(e.noteData.link?.url+"$"))};let ge=Kn||qn,se=D(a),ue=D(()=>r()==="multiple"&&o().has(e.noteId));var ee=be(),we=M(ee);{var fe=me=>{var X=Nv(),ie=M(X);he(ie,()=>({"--bottom":e.showMenuUp?"calc(100%)":"auto","--top":e.showMenuUp?"auto":"calc(100%)","--right":"10px"})),Lr(ie.lastChild,{get startClose(){return n(N)},onClosed:$,get isMobile(){return ge},children:(de,Ae)=>{var Ee=Ev(),pe=M(Ee),ae=b(pe);Ue(ae,{onClick:Q,get dialogMode(){return ge},children:(T,J)=>{var q=cv(),Z=M(q);{let U=D(()=>e.noteData.pinned?"pin-cancel":"pin");he(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{get name(){return n(U)}})}var re=I(Z);De(()=>vt(re,` ${e.noteData.pinned?"Unpin":"Pin"}`)),g(T,q)},$$slots:{default:!0}});var xe=I(pe,2);{var ye=T=>{var J=uv(),q=b(J);Ue(q,{onClick:F,get dialogMode(){return ge},children:(Z,re)=>{var U=dv(),ne=M(U);he(ne,()=>({"--size":"20px"})),_e(ne.lastChild,{name:"copy"}),g(Z,U)},$$slots:{default:!0}}),g(T,J)};W(xe,T=>{e.noteData.text&&T(ye)})}var Me=I(xe,2);{var Re=T=>{var J=vv(),q=b(J);Ue(q,{onClick:Y,get dialogMode(){return ge},children:(Z,re)=>{var U=fv(),ne=M(U);he(ne,()=>({"--size":"20px"})),_e(ne.lastChild,{name:"copy"}),g(Z,U)},$$slots:{default:!0}}),g(T,J)};W(Me,T=>{n(se)&&e.noteData.link?.url&&T(Re)})}var ve=I(Me,2);{var Se=T=>{var J=hv(),q=b(J);Ue(q,{onClick:G,get dialogMode(){return ge},children:(Z,re)=>{var U=gv(),ne=M(U);he(ne,()=>({"--size":"20px"})),_e(ne.lastChild,{name:"share"}),g(Z,U)},$$slots:{default:!0}}),g(T,J)};W(ve,T=>{K&&e.noteData.text&&T(Se)})}var Oe=I(ve,2);{var Be=T=>{var J=mv(),q=b(J);Ue(q,{onClick:H,get dialogMode(){return ge},children:(Z,re)=>{var U=pv(),ne=M(U);{let Ne=D(()=>e.noteData.text?"":"share");he(ne,()=>({"--size":"20px"})),_e(ne.lastChild,{get name(){return n(Ne)}})}g(Z,U)},$$slots:{default:!0}}),g(T,J)};W(Oe,T=>{K&&e.noteData.link?.url&&T(Be)})}var Ze=I(Oe,2);{var Ge=T=>{var J=wv(),q=b(J);Ue(q,{onClick:()=>{f(N,!0),r()!=="multiple"&&s("multiple"),i(e.noteId)},get dialogMode(){return ge},children:(Z,re)=>{var U=_v(),ne=M(U);he(ne,()=>({"--size":"20px"})),_e(ne.lastChild,{name:"check"}),g(Z,U)},$$slots:{default:!0}}),g(T,J)};W(Ze,T=>{n(ue)||T(Ge)})}var P=I(Ze,2);{var E=T=>{var J=bv(),q=b(J);Ue(q,{onClick:te,get dialogMode(){return ge},children:(Z,re)=>{var U=yv(),ne=M(U);he(ne,()=>({"--size":"20px"})),_e(ne.lastChild,{name:""}),g(Z,U)},$$slots:{default:!0}}),g(T,J)};W(P,T=>{e.noteData.link?.url&&C(e.noteId)&&T(E)})}var x=I(P,2);{var R=T=>{var J=kv(),q=M(J),Z=b(q);Ue(Z,{onClick:()=>{f(_,p()==="notes"),f(A,p()==="archive"),f(N,!0)},get dialogMode(){return ge},children:(ne,Ne)=>{var ze=Sv(),Le=M(ze);{let He=D(()=>p()==="archive"?"archive-cancel":"archive");he(Le,()=>({"--size":"20px","--scale":"0.9"})),_e(Le.lastChild,{get name(){return n(He)}})}var Ie=I(Le);De(()=>vt(Ie,` ${p()==="archive"?"Unarchive":"Archive"}`)),g(ne,ze)},$$slots:{default:!0}});var re=I(q,2),U=b(re);Ue(U,{onClick:()=>{f(w,!0),f(N,!0)},get dialogMode(){return ge},children:(ne,Ne)=>{var ze=Cv(),Le=M(ze),Ie=b(Le);he(Ie,()=>({"--size":"20px"})),_e(Ie.lastChild,{name:"bin"}),g(ne,ze)},$$slots:{default:!0}}),g(T,J)},z=T=>{var J=Pv(),q=M(J),Z=b(q);Ue(Z,{onClick:()=>{f(B,!0),f(N,!0)},get dialogMode(){return ge},children:(ne,Ne)=>{var ze=xv(),Le=M(ze),Ie=b(Le);he(Ie,()=>({"--size":"20px"})),_e(Ie.lastChild,{name:"bin-cancel"}),g(ne,ze)},$$slots:{default:!0}});var re=I(q,2),U=b(re);Ue(U,{onClick:oe,get dialogMode(){return ge},dangerous:!0,children:(ne,Ne)=>{var ze=Tv(),Le=M(ze),Ie=b(Le);he(Ie,()=>({"--size":"20px"})),_e(Ie.lastChild,{name:"bin"}),g(ne,ze)},$$slots:{default:!0}}),g(T,J)};W(x,T=>{p()==="notes"||p()==="archive"?T(R):T(z,!1)})}g(de,Ee)},$$slots:{default:!0}}),g(me,X)};W(we,me=>{S()&&me(fe)})}g(t,ee),ke()}var Dv=k('<div class="a p-1hg9kpf"></div>'),Mv=k('<img loading="lazy" height="16" width="16" alt="" referrerpolicy="no-referrer"/>');function pl(t,e){Ce(e,!0);const a=d=>{try{return`https://icons.duckduckgo.com/ip3/${new URL(d).host}.ico`}catch{return""}};let r=L(!1),o=D(()=>a(e.url));var s=be(),i=M(s);{var l=d=>{var u=Dv();g(d,u)},c=d=>{var u=Mv();De(v=>ut(u,"src",v),[()=>a(e.url)]),Qt("error",u,()=>{f(r,!0)}),g(d,u)};W(i,d=>{n(r)||!n(o)?d(l):d(c,!1)})}g(t,s),ke()}var Iv=k('<a target="_blank" rel="noopener noreferrer"><!> <!></a>'),Lv=k("<button><!> <!></button>");function ln(t,e){Ce(e,!0);let a=Fe(e,"tabindex",3,0),r=Fe(e,"onclick",3,()=>{}),o=Fe(e,"ref",15),s=Fe(e,"disabled",3,!1);var i=be(),l=M(i);{var c=u=>{var v=Iv();v.__click=function(...y){r()?.apply(this,y)};var h=b(v);je(h,()=>e.children);var m=I(h,2);wt(m,{children:(y,C)=>{var p=Ve();De(()=>vt(p,e.title)),g(y,p)}}),et(v,y=>o(y),()=>o()),De(()=>{ut(v,"href",e.href),ut(v,"tabindex",s()?-1:a()),tt(v,1,at({a:!0,b:s()}),"p-62et9t")}),g(u,v)},d=u=>{var v=be(),h=M(v);{var m=y=>{var C=Lv();C.__click=function(...N){r()?.apply(this,N)};var p=b(C);je(p,()=>e.children);var S=I(p,2);wt(S,{children:(N,w)=>{var _=Ve();De(()=>vt(_,e.title)),g(N,_)}}),et(C,N=>o(N),()=>o()),De(()=>{ut(C,"tabindex",s()?-1:a()),tt(C,1,at({a:!0,b:s()}),"p-62et9t"),C.disabled=s()}),g(y,C)};W(h,y=>{e.elem==="button"&&y(m)},!0)}g(u,v)};W(l,u=>{e.elem==="a"?u(c):u(d,!1)})}g(t,i),ke()}mt(["click"]);let po=L(!1),mo=L(!1),bn=L(void 0),Qr={};const Rv=()=>{Kn||qn||f(mo,!0)},Fv=()=>{f(mo,!1)},Qo=()=>{Kn||qn||f(po,!0)},Ov=()=>{f(po,!1)},zv=()=>n(mo),ml=()=>n(po),gn=t=>{Kn||qn||f(bn,t,!0)},Gr=()=>n(bn),Os=()=>{const t=Qr[n(bn)||""]?.next;if(t)return f(bn,t,!0),t},zs=()=>{const t=Qr[n(bn)||""]?.prev;if(t)return f(bn,t,!0),t};var Bv=k('<div class="a p-rxwzp0"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),jv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Hv=k('<div class="b p-rxwzp0"><!></div>'),Uv=k('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Wv=k('<a class="c p-rxwzp0" target="_blank" rel="noopener noreferrer"> </a>'),Vv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Kv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),qv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Gv=k("<!> <!>",1),Yv=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Xv=k("<li><!> <!> <!> <div><!> <!> <!></div> <!></li>");function Jv(t,e){Ce(e,!0);const{pushDialogPage:a}=Ot(),{getFaviconEnabled:r,getRecordMode:o}=Wn(),{getMode:s,getSelectedNotes:i,addNote:l,removeNote:c}=ua(),{getSearchParams:d,getHref:u}=zt();let v=Fe(e,"mode",3,"notes"),h="unknown";Ke(()=>(Qr[e.noteId]={next:e.nextNoteId,prev:e.prevNoteId},()=>{delete Qr[e.noteId]}));let m=L(!1),y=L(!1),C=D(r),p=D(o),S=L(null),N=L(null),w=L(null);const{checkMobileSize:_}=va(),A=()=>{f(m,!0)},B=()=>{e.noteData.link?.url&&(navigator.clipboard.writeText(e.noteData.link.url),nt("Copied link"))};Ke(()=>{n(bn)===e.noteId?f(y,!0):f(y,!1)});const K=ie=>{ie.preventDefault(),a(`${Te.Note}?id=${encodeURIComponent(e.noteId)}`)},O=D(()=>e.noteData.link?.url||"");let j=D(()=>n(m)&&n(S)?bt(n(S)).next:null);const le=ie=>{ie?l(e.noteId):c(e.noteId)},ce=()=>{const ie=new URLSearchParams(d());return ie.set(Jt,`${Te.Note}?id=${encodeURIComponent(e.noteId)}`),u(ie)};let Q=D(()=>s()==="multiple"&&i().has(e.noteId));Pe(()=>{const ie=de=>{if(h="keyboard",n(bn)===e.noteId&&(de.key==="Enter"&&n(mo)&&(n(p)==="note"?(de.preventDefault(),setTimeout(()=>{a(`${Te.Note}?id=${encodeURIComponent(e.noteId)}`)},0)):n(p)==="bookmark"&&n(O)&&window.open(n(O),"_blank","noopener")),de.key==="Tab"&&n(po)&&(Ov(),n(w)))){const Ae=bt(n(w));de.shiftKey?Ae.prev?.focus():Ae?.next?.focus()}};return document.addEventListener("keydown",ie),()=>{document.removeEventListener("keydown",ie)}});var $=Xv();$.__focusin=()=>{h==="keyboard"&&f(bn,e.noteId,!0)};var Y=b($);{var F=ie=>{var de=Bv(),Ae=b(de);he(Ae,()=>({"--size":"18px"})),_e(Ae.lastChild,{name:"pin"}),g(ie,de)};W(Y,ie=>{e.noteData.pinned&&ie(F)})}var oe=I(Y,2);{var G=ie=>{var de=Hv(),Ae=b(de);{var Ee=ae=>{pl(ae,{get url(){return n(O)}})},pe=ae=>{var xe=jv(),ye=M(xe);he(ye,()=>({"--size":"16px"})),_e(ye.lastChild,{name:"note"}),g(ae,xe)};W(Ae,ae=>{n(O)?ae(Ee):ae(pe,!1)})}g(ie,de)};W(oe,ie=>{n(C)&&ie(G)})}var H=I(oe,2);{var te=ie=>{var de=Uv();de.__keydown=Ee=>{Ee.key==="Enter"&&(h="keyboard")},de.__mousedown=()=>{h="mouse"},de.__click=Ee=>{h==="mouse"&&gn(void 0),Ee.preventDefault(),s()==="multiple"?le(!n(Q)):K(Ee)};var Ae=b(de);et(de,Ee=>f(w,Ee),()=>n(w)),De((Ee,pe)=>{ut(de,"tabindex",e.focusHidden?-1:0),ut(de,"href",Ee),vt(Ae,pe)},[ce,()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Qt("focus",de,()=>{}),g(ie,de)},ge=ie=>{var de=Wv();de.__keydown=Ee=>{Ee.key==="Enter"&&(h="keyboard")},de.__mousedown=()=>{h="mouse"},de.__click=Ee=>{s()==="multiple"&&(Ee.preventDefault(),le(!n(Q)))};var Ae=b(de);et(de,Ee=>f(w,Ee),()=>n(w)),De(Ee=>{ut(de,"tabindex",e.focusHidden?-1:0),ut(de,"href",n(O)),vt(Ae,Ee)},[()=>e.noteData?.text.trim()?e.noteData?.text.split(`
`)[0]:e.noteData?.link?.title||"unknown"]),Qt("focus",de,()=>{}),g(ie,de)};W(H,ie=>{n(p)==="note"||!n(O)?ie(te):ie(ge,!1)})}var se=I(H,2),ue=b(se);{var ee=ie=>{{let de=D(ce),Ae=D(()=>e.focusHidden?-1:0);ln(ie,{title:"edit",elem:"a",get href(){return n(de)},get tabindex(){return n(Ae)},onclick:K,children:(Ee,pe)=>{var ae=Vv(),xe=M(ae);he(xe,()=>({"--size":"18px"})),_e(xe.lastChild,{name:"pen"}),g(Ee,ae)},$$slots:{default:!0}})}};W(ue,ie=>{(n(p)==="bookmark"||s()==="multiple")&&ie(ee)})}var we=I(ue,2);{var fe=ie=>{var de=Gv(),Ae=M(de);{var Ee=xe=>{{let ye=D(()=>e.focusHidden?-1:0),Me=D(()=>e.noteData.link?.title||"unknown");ln(xe,{elem:"a",get href(){return n(O)},get tabindex(){return n(ye)},get title(){return n(Me)},children:(Re,ve)=>{var Se=Kv(),Oe=M(Se);he(Oe,()=>({"--size":"18px"})),_e(Oe.lastChild,{name:"open"}),g(Re,Se)},$$slots:{default:!0}})}};W(Ae,xe=>{(n(p)==="note"||s()==="multiple")&&xe(Ee)})}var pe=I(Ae,2);{var ae=xe=>{{let ye=D(()=>e.focusHidden?-1:0);ln(xe,{elem:"button",onclick:B,get tabindex(){return n(ye)},title:"copy link",children:(Me,Re)=>{var ve=qv(),Se=M(ve);he(Se,()=>({"--size":"20px"})),_e(Se.lastChild,{name:"copy"}),g(Me,ve)},$$slots:{default:!0}})}};W(pe,xe=>{_()||xe(ae)})}g(ie,de)};W(we,ie=>{n(O)&&ie(fe)})}var me=I(we,2);{let ie=D(()=>e.focusHidden?-1:0);ln(me,{title:"show menu",elem:"button",get tabindex(){return n(ie)},onclick:A,get ref(){return n(S)},set ref(de){f(S,de,!0)},children:(de,Ae)=>{var Ee=Yv(),pe=M(Ee);he(pe,()=>({"--size":"18px","--rotate":"90deg"})),_e(pe.lastChild,{name:"menu"}),g(de,Ee)},$$slots:{default:!0}})}var X=I(se,2);Av(X,{get nextFocusRef(){return n(j)},get mode(){return v()},get noteId(){return e.noteId},get noteData(){return e.noteData},get showMenuUp(){return e.showMenuUp},get shownMenu(){return n(m)},set shownMenu(ie){f(m,ie,!0)}}),et($,ie=>f(N,ie),()=>n(N)),De(()=>{tt($,1,at({d:!0,e:n(y),f:n(Q)||n(bn)===e.noteId}),"p-rxwzp0"),tt(se,1,at({g:!0,h:n(y)}),"p-rxwzp0")}),g(t,$),ke()}mt(["focusin","keydown","mousedown","click"]);var Zv=k('<div class="g e p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper><!></button></div>'),Qv=k('<div class="g p-12ns0yc"><button class="d p-12ns0yc" type="button"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Empty bin</button></div>'),$v=k('<a class="i j p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),eg=k('<div class="h p-12ns0yc"><!> <!></div>'),tg=k('<!> <div class="q p-12ns0yc"><!></div>',1),ng=k('<button class="u p-12ns0yc">All</button>'),ag=k('<button class="u p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button>'),rg=k('<div class="s p-12ns0yc"><div class="t p-12ns0yc"><!> <span> </span> <!></div> <button class="u v p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Exit</button></div>'),og=k('<div class="a p-12ns0yc"><div class="b p-12ns0yc"><div class="c p-12ns0yc"><a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Settings</span></a> <a class="d p-12ns0yc"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Sync</span></a></div> <div class="e p-12ns0yc"><!></div> <div class="f p-12ns0yc"><!></div></div> <div class="k p-12ns0yc"><div class="l p-12ns0yc"><!></div> <div class="m p-12ns0yc"><div class="n p-12ns0yc"><div class="o p-12ns0yc"><!></div> <div class="p p-12ns0yc"><!></div></div> <div class="r p-12ns0yc"><!></div></div></div></div>');function sg(t,e){Ce(e,!0);const{getFeedSearch:a,setFeedSearch:r}=Aa(),{getScrollContainer:o}=Mr();let s=D(o);const{emptyBin:i,checkNotesInBin:l,checkNotesInArchive:c,checkNotes:d}=At(),{replaceSearchParams:u}=zt(),{createDialogPageHref:v,createHandleClickDialogPage:h,getDialogPages:m}=Ot(),{checkExistedDialog:y}=$t(),{getMode:C,clearNotes:p,setSelectedNotes:S,getSelectedNotes:N,changeMode:w}=ua(),{checkMobileSize:_}=va(),{getFiltredNotes:A}=La(),{getSelectedMetaTags:B}=go(),{getViewMode:K}=Wn();let O=D(B),j=L(null);const le=D(l);let Q=D(()=>{const E=A()||[],x=N();return E.every(R=>x.has(R.id))});const $=()=>{Ka({title:"Are you sure you want to empty the bin?",buttonConfirmTitle:"Empty",onConfirm:async()=>{await i(),u("")},onCancel:async()=>{}})};let Y=D(()=>m().length===0);Ke(()=>{n(Y)});const F=()=>{m().length===0&&!y()&&n(j)?.focus()};Pe(()=>Sr({key:"k",meta:!0,action:F})),Pe(()=>Sr({key:"k",ctrl:!0,action:F})),Pe(()=>{}),Ke(()=>{const E=A()||[];Ct(()=>{const x=N();S(new Set(E.filter(R=>x.has(R.id)).map(R=>R.id)))})});let oe=D(()=>n(O).has(ot.ARCHIVED)?"archive":n(O).has(ot.BIN)?"bin":"notes");Pe(()=>{n(j)&&n(j).addEventListener("keydown",E=>{E.key==="Tab"&&Gr()&&E.preventDefault()})}),Ke(()=>{ml()&&setTimeout(()=>{n(j)?.focus(),n(j)?.setSelectionRange(n(j).value.length,n(j).value.length)},0)}),Pe(()=>{});var G=og(),H=b(G),te=b(H),ge=b(te),se=D(()=>h(Te.Settings));ge.__click=function(...E){n(se)?.apply(this,E)};var ue=b(ge);he(ue,()=>({"--rotate":"30deg","--size":"20px"})),_e(ue.lastChild,{name:"settings"});var ee=I(ge,2),we=D(()=>h(Te.Sync));ee.__click=function(...E){n(we)?.apply(this,E)};var fe=b(ee);he(fe,()=>({"--size":"20px"})),_e(fe.lastChild,{name:"sync"});var me=I(te,2),X=b(me);fl(X,{});var ie=I(me,2),de=b(ie);{var Ae=E=>{var x=be(),R=M(x);{var z=T=>{var J=be(),q=M(J);{var Z=U=>{var ne=Zv(),Ne=b(ne);Ne.__click=$;var ze=b(Ne);he(ze,()=>({"--scale":"1.2","--size":"20px"})),_e(ze.lastChild,{name:"clear"});var Le=I(ze);wt(Le,{children:(Ie,He)=>{var pt=Ve("Empty bin");g(Ie,pt)}}),g(U,ne)},re=U=>{var ne=Qv(),Ne=b(ne);Ne.__click=$;var ze=b(Ne);he(ze,()=>({"--scale":"0.9","--size":"20px"})),_e(ze.lastChild,{name:"clear"}),g(U,ne)};W(q,U=>{_()?U(Z):U(re,!1)})}g(T,J)};W(R,T=>{n(le)&&T(z)})}g(E,x)},Ee=E=>{var x=be(),R=M(x);{var z=T=>{var J=eg(),q=b(J);{var Z=U=>{var ne=$v();ne.__click=function(...Le){e.onOpenWindow?.apply(this,Le)};var Ne=b(ne);he(Ne,()=>({"--scale":"0.7","--size":"26px"})),_e(Ne.lastChild,{name:"open-window"});var ze=I(Ne,2);wt(ze,{children:(Le,Ie)=>{var He=Ve("open window");g(Le,He)}}),De(()=>ut(ne,"href",e.openWindowHref)),g(U,ne)};W(q,U=>{e.onOpenWindow&&U(Z)})}var re=I(q,2);Wu(re,{}),g(T,J)};W(R,T=>{n(oe)==="notes"&&T(z)},!0)}g(E,x)};W(de,E=>{n(oe)==="bin"?E(Ae):E(Ee,!1)})}var pe=I(H,2),ae=b(pe),xe=b(ae);kf(xe,{});var ye=I(ae,2),Me=b(ye),Re=b(Me),ve=b(Re);{let E=D(a);Ho(ve,{placeholder:"Search",onFocus:()=>{Kn||qn||(Rv(),Qo(),n(j)?.setSelectionRange(n(j).value.length,n(j).value.length))},onBlur:()=>{Fv()},get value(){return n(E)},onChange:x=>{gn(void 0),n(s)&&n(s).scrollTo({top:0}),r(x)},onEscape:()=>{gn(void 0)},get ref(){return n(j)},set ref(x){f(j,x,!0)}})}var Se=I(Re,2),Oe=b(Se);{var Be=E=>{var x=tg(),R=M(x);Ru(R,{});var z=I(R,2),T=b(z);lv(T,{get mode(){return n(oe)}}),g(E,x)};W(Oe,E=>{(n(oe)==="notes"&&d()||n(oe)==="bin"&&l()||n(oe)==="archive"&&c())&&E(Be)})}var Ze=I(Me,2),Ge=b(Ze);{var P=E=>{var x=be(),R=M(x);{var z=T=>{var J=rg(),q=b(J),Z=b(q);{var re=He=>{var pt=ng();pt.__click=ct=>{ct.preventDefault();const st=A()||[];S(new Set(st.map(it=>it.id)))},g(He,pt)};W(Z,He=>{n(Q)||He(re)})}var U=I(Z,2),ne=b(U),Ne=I(U,2);{var ze=He=>{var pt=ag();pt.__click=st=>{st.preventDefault(),p()};var ct=b(pt);he(ct,()=>({"--size":"16px"})),_e(ct.lastChild,{name:"close"}),g(He,pt)};W(Ne,He=>{N().size>0&&He(ze)})}var Le=I(q,2);Le.__click=He=>{He.preventDefault(),w("single")};var Ie=b(Le);he(Ie,()=>({"--size":"16px"})),_e(Ie.lastChild,{name:"close"}),De(He=>vt(ne,`Selected ${He??""}`),[()=>N().size]),g(T,J)};W(R,T=>{C()==="multiple"&&T(z)})}g(E,x)};W(Ge,E=>{(n(oe)==="notes"&&d()||n(oe)==="bin"&&l()||n(oe)==="archive"&&c())&&E(P)})}De((E,x)=>{ut(ge,"href",E),ut(ee,"href",x)},[()=>v(Te.Settings),()=>v(Te.Sync)]),g(t,G),ke()}mt(["click"]);var ig=k('<div class="a p-11shdp8"><!></div>');function St(t,e){Ce(e,!0);const{setDialogPageHeight:a}=us();let r=L(null);Pe(()=>{n(r);const i=new ResizeObserver(l=>{for(let c of l){const d=c.contentRect.height;a(d)}});if(n(r))return i.observe(n(r)),()=>{n(r)&&i.unobserve(n(r)),i.disconnect()}});var o=ig(),s=b(o);je(s,()=>e.children),et(o,i=>f(r,i),()=>n(r)),g(t,o),ke()}var lg=k('<div class="p-ndasxn"><p class="p-ndasxn">Page not found</p> <!></div>');function cg(t,e){Ce(e,!1);const{replaceSearchParams:a,getHref:r}=zt(),o=l=>{l.preventDefault(),a("")};is();var s=lg(),i=I(b(s),2);{let l=Er(()=>r(""));Rt(i,{element:"a",get href(){return n(l)},onClick:o,children:(c,d)=>{var u=Ve("close");g(c,u)},$$slots:{default:!0}})}g(t,s),ke()}var dg=k('<h1 class="p-1n0ziuh"><!></h1>');function ug(t,e){var a=dg(),r=b(a);je(r,()=>e.children),g(t,a)}var fg=k('<!> <div class="b p-193tby9"><!> <!></div>',1),vg=k('<div class="a p-193tby9"><!></div>');function gg(t,e){Ce(e,!0);const{blockDialog:a,setLeftEnd:r}=$t(),{pushDialogPage:o}=Ot(),{initLocalAccount:s}=cs(),{replaceSearchParams:i}=zt(),{setAnimationSettings:l,resetAnimationSettings:c}=Tn(),d=()=>{o(Te.Auth)},u=async()=>{l({duration:0,swipingRatio:-25,working:!0}),requestAnimationFrame(()=>{c(),s(),a(!1),r(!0),i("")})};var v=vg(),h=b(v);{var m=y=>{var C=fg(),p=M(C);ug(p,{children:(_,A)=>{var B=Ve("Welcome");g(_,B)}});var S=I(p,2),N=b(S);Rt(N,{onClick:d,fullWidth:!0,children:(_,A)=>{var B=Ve("Cloud account");g(_,B)},$$slots:{default:!0}});var w=I(N,2);Rt(w,{onClick:u,fullWidth:!0,type:"secondary",children:(_,A)=>{var B=Ve("Local account");g(_,B)},$$slots:{default:!0}}),g(y,C)};W(h,y=>{y(m)})}g(t,v),ke()}var hg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),pg=k('<form class="b p-10m9vsg"><!> <!> <div class="c p-10m9vsg"><div class="d p-10m9vsg"><button type="button" class="p-10m9vsg">Cancel</button> <button type="submit" class="p-10m9vsg">Done</button></div> <!></div></form>'),mg=k('<div class="f p-10m9vsg"><!></div>'),_g=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),wg=k('<div class="e p-10m9vsg"><div><!> <a class="g p-10m9vsg" target="_blank" rel="noopener noreferrer"> </a> <div><!></div></div></div>'),yg=k('<div class="a p-10m9vsg"><!></div>');function bg(t,e){Ce(e,!0);let a=Fe(e,"shownUrlInput",15);const{getFaviconEnabled:r}=Wn();let o=D(r),s=L(null),i=L(null),l=L(null),c=L(ft(e.url)),d=L(ft(e.title)),u=L(null);const v=w=>{f(c,w.target.value||"",!0)},h=w=>{f(d,w.target.value||"",!0)};Ke(()=>{a()&&n(s)?.focus()});const m=()=>{e.url&&(navigator.clipboard.writeText(e.url),nt("Copied link"))},y=()=>{f(d,""),f(c,""),e.onDeleteUrl(),a(!1)};var C=yg(),p=b(C);{var S=w=>{var _=pg(),A=b(_);Cr(A,{get value(){return n(c)},onInput:v,placeholder:"url",get ref(){return n(s)},set ref(Q){f(s,Q,!0)}});var B=I(A,2);Cr(B,{get value(){return n(d)},onInput:h,placeholder:"title",get ref(){return n(i)},set ref(Q){f(i,Q,!0)}});var K=I(B,2),O=b(K),j=b(O);j.__click=()=>{f(c,e.url,!0),f(d,e.title,!0),a(!1)};var le=I(O,2);{var ce=Q=>{ln(Q,{title:"delete link",elem:"button",onclick:y,children:($,Y)=>{var F=hg(),oe=M(F);he(oe,()=>({"--size":"20px"})),_e(oe.lastChild,{name:"bin"}),g($,F)},$$slots:{default:!0}})};W(le,Q=>{(e.url||e.title)&&Q(ce)})}Qt("submit",_,Q=>{if(Q.preventDefault(),document.activeElement===n(s)){n(i)?.focus();return}let $=n(c).trim();$!==""&&/^[[a-zA-Z]+?:\/\//.test($)===!1&&($="https://"+$,f(c,$,!0)),e.onChangeUrl($,n(d)),a(!1)}),g(w,_)},N=w=>{var _=be(),A=M(_);{var B=K=>{var O=wg(),j=b(O);tt(j,1,at({h:!0}),"p-10m9vsg");var le=b(j);{var ce=oe=>{var G=mg(),H=b(G);pl(H,{get url(){return e.url}}),g(oe,G)};W(le,oe=>{n(o)&&oe(ce)})}var Q=I(le,2),$=b(Q),Y=I(Q,2);tt(Y,1,at({i:!0}),"p-10m9vsg");var F=b(Y);ln(F,{title:"copy link",elem:"button",onclick:m,children:(oe,G)=>{var H=_g(),te=M(H);he(te,()=>({"--size":"20px"})),_e(te.lastChild,{name:"copy"}),g(oe,H)},$$slots:{default:!0}}),et(j,oe=>f(u,oe),()=>n(u)),De(()=>{ut(Q,"href",e.url),vt($,e.title||"unknown")}),g(K,O)};W(A,K=>{e.url&&K(B)},!0)}g(w,_)};W(p,w=>{a()?w(S):w(N,!1)})}et(C,w=>f(l,w),()=>n(l)),g(t,C),ke()}mt(["click"]);const Sg=t=>{let e="",a=!0;function r(o){for(let s=0;s<o.length;s++){const i=o[s];if(i.nodeName==="BR"){e+=`
`,a=!0;continue}i.nodeName==="DIV"&&a===!1&&(e+=`
`),a=!1,i.nodeType===3&&i.textContent&&(e+=i.textContent),r(i.childNodes)}}return r(t),e===`
`&&(e=e.slice(0,-1)),e},Cg=()=>{const t=()=>{const a=new Set(["script","style","noscript","iframe","svg","canvas","meta","link","input","button","form"]),r=c=>{if(c.childNodes.length===0)return!1;for(const d of c.childNodes)if(d.nodeType===Node.TEXT_NODE&&d.textContent?.trim())return!0;return!1},o=Array.from({length:10},()=>({priority:0,text:""})),s=(c,d)=>({main:c.main||d.tagName.toLowerCase()==="main",article:c.article||d.tagName.toLowerCase()==="article",h1:c.h1||d.tagName.toLowerCase()==="h1",h2:c.h2||d.tagName.toLowerCase()==="h2",h3:c.h3||d.tagName.toLowerCase()==="h3"}),i=c=>{let d=0;return c.main&&(d+=1e3),c.article&&(d+=1e4),c.h1&&(d+=10),c.h2&&(d+=5),c.h3&&(d+=1),d},l=(c=document.body,d={main:!1,article:!1,h1:!1,h2:!1,h3:!1})=>{for(const u of c.childNodes)if(u.nodeType===Node.ELEMENT_NODE){if(a.has(u.tagName.toLowerCase()))continue;if(r(u)){const v=u.textContent;if(!v)continue;for(let h=0;h<o.length&&!o[h].text.includes(v||"");h++)if(v&&i(s(d,u))+v.length>o[h].priority){o.splice(h,0,{priority:i(s(d,u))+v.length,text:v.trim()}),o.pop();break}}else l(u,s(d,u))}};return l(),o};return{title:document.title||"",desctiption:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",topTextContents:t()}},kg=async()=>await Ji().create({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}],temperature:.2,topK:2,initialPrompts:[{role:"system",content:`
						You are a tagging assistant.
						Your task is to suggest relevant tags for bookmarks.

						Rules:
						- Use page content by priority to generate relevant tags.
						- Focus on the main topics and themes of the page and note content.
						- Prefer short, lowercase, single-word tags.
						- Use only single words for tags, no phrases, you can split into multiple tags.
						- Avoid special characters in tags.
						- All tags must be in English.
						- Add common tags related to the content like "music", "article", "video", "tutorial", "blog", etc. if relevant.
						- Return 3 to 5 tags.
						- Output ONLY a JSON array of strings.
					`}]}),xg=async()=>typeof LanguageModel>"u"?"unavailable":await Ji().availability({expectedInputs:[{type:"text",languages:["en"]}],expectedOutputs:[{type:"text",languages:["en"]}]}),Tg=t=>new Promise(e=>{Ds().tabs.query({active:!0,currentWindow:!0},async a=>{const r=a[0];if(!r||!r.id){e(void 0);return}if(r.url!==t){e(void 0);return}const s=(await Ds().scripting.executeScript({target:{tabId:r.id},world:"MAIN",func:Cg}))[0]?.result;e(s)})}),Pg=async({llmSession:t,rejectedTags:e,accessPageData:a,text:r,link:o,tags:s})=>{const i=a&&o?.url?await Tg(o.url):void 0,l={type:"object",properties:{tags:{type:"array",items:{type:"string"}}},required:["tags"]},c=`
			Page information:
			Title: ${o?.title||"N/A"}.
			URL: ${o?.url||"N/A"}.
			Description: ${i?.desctiption||"N/A"}.
			Note content: ${r||"N/A"}.
			Dont return tags: ${[...e.length>0?e:[],...s.length>0?s:[]].join(", ")||"N/A"}.
			Page contents: ${i?.topTextContents?i.topTextContents.slice(0,5).map(({priority:v,text:h})=>`priority: ${v}; text: ${h}

`).join(""):"N/A"}.
		`.slice(0,5e3),d=await t.prompt(c,{responseConstraint:l});return Array.from(new Set([...s,...(JSON.parse(d)?.tags||[]).map(v=>v.trim().toLowerCase()).filter(v=>v!=="")]))};var Eg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Add link',1),Ng=k('<li class="p-1ljon4s"><!></li>'),Ag=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Edit link',1),Dg=k('<li class="p-1ljon4s"><!></li>'),Mg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>Copy',1),Ig=k('<li class="p-1ljon4s"><!></li>'),Lg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share link',1),Rg=k('<li class="p-1ljon4s"><!></li>'),Fg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Share',1),Og=k('<li class="p-1ljon4s"><!></li>'),zg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Make copy',1),Bg=k('<li class="p-1ljon4s"><!></li>'),jg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> Duplicates',1),Hg=k('<li class="p-1ljon4s"><!></li>'),Ug=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> ',1),Wg=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete',1),Vg=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Kg=k('<span class="a p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Restore',1),qg=k(`<span class="a b p-1ljon4s"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span>Delete
					from bin`,1),Gg=k('<li class="p-1ljon4s"><!></li> <li class="p-1ljon4s"><!></li>',1),Yg=k("<!> <!> <!> <!> <!> <!> <!>",1),Xg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Bs(t,e){Ce(e,!0);const{moveNoteToBin:a,moveNoteFromArchive:r,moveNoteToArchive:o,deleteNote:s,restoreNoteFromBin:i,checkDuplicatesExist:l,createNote:c}=At(),{clearDialogPages:d,replaceDialogPage:u,pushDialogPage:v}=Ot(),{setFeedSearch:h}=Aa(),{checkMobileSize:m}=va();let y=Fe(e,"mode",3,"notes"),C=Fe(e,"shownMenu",15),p=L(!1),S=L(!1),N=L(!1),w=L(!1),_=L(!1),A=navigator?.canShare?.({url:"https://example.com",title:"example",text:"example"});const B=async()=>{requestAnimationFrame(()=>{d(),setTimeout(()=>{a(e.noteId),nt("moved to bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{i(e.noteId),v(`${Te.Note}?id=${e.noteId}`)}}})},300)})},K=async()=>{o(e.noteId),nt("moved to archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{r(e.noteId)}}})},O=async()=>{r(e.noteId),nt("moved from archive",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{o(e.noteId)}}})},j=()=>{i(e.noteId),nt("restored from bin",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{a(e.noteId)}}})},le=()=>{n(S)?(f(S,!1),B()):n(_)?(f(_,!1),j()):n(N)?(f(N,!1),K()):n(w)&&(f(w,!1),O()),C(!1),f(p,!1)},ce=()=>{let se="";e.link?.url&&(se+=e.link.url+`
`),e.text&&(se+=`
`+e.text+`
`),navigator.clipboard.writeText(se),nt("Copied"),f(p,!0)},Q=async()=>{f(p,!0),requestAnimationFrame(()=>{d(),setTimeout(()=>{s(e.noteId)},100)})},$=()=>{if(navigator.share){const se={};let ue="";e.link?.url&&(ue+=e.link.url+`
`),e.text&&(ue+=`
`+e.text+`
`),se.text=ue,navigator.share(se).catch(ee=>{ee.name!=="AbortError"&&console.error("Error sharing",ee)})}f(p,!0)},Y=()=>{if(navigator.share){const se={};e.link?.url&&(se.url=e.link.url),e.link?.title&&(se.title=e.link.title),navigator.share(se).catch(ue=>{ue.name!=="AbortError"&&console.error("Error sharing",ue)})}f(p,!0)},F=async()=>{f(p,!0);const se=e.noteId,ue=await c({link:Xe(e.link),text:e.text||"",tags:e.tags?Xe(e.tags):[]});u(`${Te.Note}?id=${ue}`),nt("copy made",{cancel:{nextFocusRef:e.nextFocusRef,onCancel:()=>{u(`${Te.Note}?id=${se}`),setTimeout(()=>{s(ue)})}}})},oe=()=>{f(p,!0),e.link?.url&&(d(),h(e.link?.url+"$"))};let G=!1;var H=be(),te=M(H);{var ge=se=>{var ue=Xg(),ee=M(ue);{let we=D(()=>`calc(100% - ${m()?"0px":"16px"})`),fe=D(()=>m()?"auto":"10px"),me=D(()=>m()?"10px":"auto");he(ee,()=>({"--bottom":"auto","--top":n(we),"--left":n(fe),"--right":n(me)})),Lr(ee.lastChild,{get startClose(){return n(p)},onClosed:le,isMobile:G,children:(X,ie)=>{var de=Yg(),Ae=M(de);{var Ee=x=>{var R=Ng(),z=b(R);Ue(z,{onClick:T=>{e.onAddLinkClick(T),f(p,!0)},dialogMode:G,children:(T,J)=>{var q=Eg(),Z=M(q);he(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{name:"add"}),g(T,q)},$$slots:{default:!0}}),g(x,R)},pe=x=>{var R=Dg(),z=b(R);Ue(z,{onClick:T=>{e.onEditLinkClick(T),f(p,!0)},dialogMode:G,children:(T,J)=>{var q=Ag(),Z=M(q);he(Z,()=>({"--size":"20px","--scale":"0.9"})),_e(Z.lastChild,{name:"pen"}),g(T,q)},$$slots:{default:!0}}),g(x,R)};W(Ae,x=>{e.link?.url?x(pe,!1):x(Ee)})}var ae=I(Ae,2);{var xe=x=>{var R=Ig(),z=b(R);Ue(z,{onClick:ce,dialogMode:G,children:(T,J)=>{var q=Mg(),Z=M(q);he(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{name:"copy"}),g(T,q)},$$slots:{default:!0}}),g(x,R)};W(ae,x=>{e.text&&x(xe)})}var ye=I(ae,2);{var Me=x=>{var R=Rg(),z=b(R);Ue(z,{onClick:Y,dialogMode:G,children:(T,J)=>{var q=Lg(),Z=M(q);{let re=D(()=>e.text?"":"share");he(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{get name(){return n(re)}})}g(T,q)},$$slots:{default:!0}}),g(x,R)};W(ye,x=>{A&&e.link?.url&&x(Me)})}var Re=I(ye,2);{var ve=x=>{var R=Og(),z=b(R);Ue(z,{onClick:$,dialogMode:G,children:(T,J)=>{var q=Fg(),Z=M(q);he(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{name:"share"}),g(T,q)},$$slots:{default:!0}}),g(x,R)};W(Re,x=>{A&&e.text&&x(ve)})}var Se=I(Re,2);{var Oe=x=>{var R=Bg(),z=b(R);Ue(z,{onClick:F,dialogMode:G,children:(T,J)=>{var q=zg(),Z=M(q);he(Z,()=>({"--size":"20px","--scale":"0.8"})),_e(Z.lastChild,{name:"note"}),g(T,q)},$$slots:{default:!0}}),g(x,R)};W(Se,x=>{e.formMode==="edit"&&(e.text||e.link?.url)&&x(Oe)})}var Be=I(Se,2);{var Ze=x=>{var R=Hg(),z=b(R);Ue(z,{onClick:oe,dialogMode:G,children:(T,J)=>{var q=jg(),Z=M(q);he(Z,()=>({"--size":"20px"})),_e(Z.lastChild,{name:""}),g(T,q)},$$slots:{default:!0}}),g(x,R)};W(Be,x=>{e.link?.url&&l(e.noteId)&&x(Ze)})}var Ge=I(Be,2);{var P=x=>{var R=be(),z=M(R);{var T=J=>{var q=Vg(),Z=M(q),re=b(Z);Ue(re,{onClick:()=>{f(N,y()==="notes"),f(w,y()==="archive"),f(p,!0)},dialogMode:G,children:(Ne,ze)=>{var Le=Ug(),Ie=M(Le);{let pt=D(()=>y()==="archive"?"archive-cancel":"archive");he(Ie,()=>({"--size":"20px","--scale":"0.9"})),_e(Ie.lastChild,{get name(){return n(pt)}})}var He=I(Ie);De(()=>vt(He,` ${y()==="archive"?"Unarchive":"Archive"}`)),g(Ne,Le)},$$slots:{default:!0}});var U=I(Z,2),ne=b(U);Ue(ne,{onClick:()=>{f(S,!0),f(p,!0)},dialogMode:G,children:(Ne,ze)=>{var Le=Wg(),Ie=M(Le),He=b(Ie);he(He,()=>({"--size":"20px"})),_e(He.lastChild,{name:"bin"}),g(Ne,Le)},$$slots:{default:!0}}),g(J,q)};W(z,J=>{(e.text||e.link?.url)&&J(T)})}g(x,R)},E=x=>{var R=Gg(),z=M(R),T=b(z);Ue(T,{onClick:()=>{f(_,!0),f(p,!0)},dialogMode:G,children:(Z,re)=>{var U=Kg(),ne=M(U),Ne=b(ne);he(Ne,()=>({"--size":"20px"})),_e(Ne.lastChild,{name:"bin-cancel"}),g(Z,U)},$$slots:{default:!0}});var J=I(z,2),q=b(J);Ue(q,{onClick:Q,dialogMode:G,dangerous:!0,children:(Z,re)=>{var U=qg(),ne=M(U),Ne=b(ne);he(Ne,()=>({"--size":"20px"})),_e(Ne.lastChild,{name:"bin"}),g(Z,U)},$$slots:{default:!0}}),g(x,R)};W(Ge,x=>{y()==="notes"||y()==="archive"?x(P):x(E,!1)})}g(X,de)},$$slots:{default:!0}})}g(se,ue)};W(te,se=>{C()&&se(ge)})}g(t,H),ke()}var Jg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Zg=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Qg=k("<!> <!> <!> <!>",1),$g=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),eh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),th=k("<!> <!> <!>",1),nh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ah=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),rh=k('<div class="a p-5sjfv5"><div class="b p-5sjfv5"><!></div> <div class="c p-5sjfv5"><!> <!></div></div>');function oh(t,e){Ce(e,!0);const{checkMobileSize:a}=va(),{getSearchParams:r,getHref:o}=zt(),{getViewMode:s}=Wn();let i=L(!1);const l=()=>!e.deletedAt&&!e.archivedAt?"notes":e.archivedAt?"archive":"bin";var c=rh(),d=b(c),u=b(d);{var v=p=>{var S=Qg(),N=M(S);{let B=D(()=>e.pinned?"unpin":"pin");ln(N,{get title(){return n(B)},elem:"button",onclick:()=>{e.onPinnedChange(!e.pinned)},children:(K,O)=>{var j=Jg(),le=M(j);{let ce=D(()=>e.pinned?"pin-cancel":"pin");he(le,()=>({"--size":"20px"})),_e(le.lastChild,{get name(){return n(ce)}})}g(K,j)},$$slots:{default:!0}})}var w=I(N,2);ln(w,{title:"menu",elem:"button",onclick:()=>{f(i,!0)},children:(B,K)=>{var O=Zg(),j=M(O);he(j,()=>({"--size":"20px","--rotate":"90deg"})),_e(j.lastChild,{name:"menu"}),g(B,O)},$$slots:{default:!0}});var _=I(w,2);{let B=D(l);Bs(_,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(B)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(i)},set shownMenu(K){f(i,K,!0)}})}var A=I(_,2);W(A,B=>{}),g(p,S)},h=p=>{var S=th(),N=M(S);ln(N,{title:"menu",elem:"button",onclick:()=>{f(i,!0)},children:(A,B)=>{var K=$g(),O=M(K);he(O,()=>({"--size":"24px","--rotate":"90deg"})),_e(O.lastChild,{name:"menu"}),g(A,K)},$$slots:{default:!0}});var w=I(N,2);{let A=D(l);Bs(w,{get onAddLinkClick(){return e.onAddLinkClick},get onEditLinkClick(){return e.onEditLinkClick},nextFocusRef:null,get mode(){return n(A)},get tags(){return e.tags},get noteId(){return e.noteId},get text(){return e.text},get link(){return e.link},get formMode(){return e.formMode},get shownMenu(){return n(i)},set shownMenu(B){f(i,B,!0)}})}var _=I(w,2);{let A=D(()=>e.pinned?"unpin":"pin");ln(_,{get title(){return n(A)},elem:"button",onclick:()=>{e.onPinnedChange(!e.pinned)},children:(B,K)=>{var O=eh(),j=M(O);{let le=D(()=>e.pinned?"pin-cancel":"pin");he(j,()=>({"--size":"24px"})),_e(j.lastChild,{get name(){return n(le)}})}g(B,O)},$$slots:{default:!0}})}g(p,S)};W(u,p=>{a()?p(v):p(h,!1)})}var m=I(d,2),y=b(m);{let p=D(()=>!e.canPrev);ln(y,{title:"previous",elem:"button",get disabled(){return n(p)},onclick:S=>{S.preventDefault(),e.onPrev&&e.onPrev()},children:(S,N)=>{var w=nh(),_=M(w);he(_,()=>({"--size":"20px"})),_e(_.lastChild,{name:"prev"}),g(S,w)},$$slots:{default:!0}})}var C=I(y,2);{let p=D(()=>!e.canNext);ln(C,{title:"next",elem:"button",get disabled(){return n(p)},onclick:S=>{S.preventDefault(),e.onNext&&e.onNext()},children:(S,N)=>{var w=ah(),_=M(w);he(_,()=>({"--size":"20px"})),_e(_.lastChild,{name:"next"}),g(S,w)},$$slots:{default:!0}})}g(t,c),ke()}var sh=k('<div class="e p-lklx2e">Note</div>'),ih=k("<span> </span>"),lh=k('<div class="i p-lklx2e"><!></div>'),ch=k('<!> <!> <div class="a p-lklx2e"><div class="b"><div class="c"><div class="d p-lklx2e"><!> <div class="f p-lklx2e" role="textbox" aria-label="note" tabindex="0" contenteditable="true" placeholder="Note"></div></div></div></div> <div class="g h p-lklx2e"><!> <div class="j p-lklx2e"><!></div></div></div>',1);function dh(t,e){Ce(e,!0);const{getLlmTagsEnabled:a,getPrevTags:r,getPageDataForTagsEnabled:o}=Wn(),{pushDialogPage:s}=Ot();let i=L(null),l=L(!1),c=L(!1),d=L(ft(new Set)),u=L(""),v=L(!1);const h=ee=>{const we=Sg(ee.currentTarget.childNodes);e.onChangeText(we),f(u,we,!0)},m=ee=>{ee.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(n(l)&&(f(l,!1),ee.preventDefault(),ee.stopPropagation()),n(c)&&(f(c,!1),ee.preventDefault(),ee.stopPropagation()))};Pe(()=>(document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)));const y=(ee,we)=>{e.onChangeLink({url:ee,title:we})},C=()=>{e.onChangeLink(void 0)},p=r(),S=()=>{e.onChangeTags([...new Set([...e.tags,...p])])};Ke(()=>{n(i)&&n(u)!==e.text&&(n(i).textContent=e.text,f(u,e.text,!0))}),Pe(()=>{if(n(i)){if((Kn||qn)&&(e.mode==="edit"||navigator.userActivation.isActive===!1))return;n(i).focus();const ee=document.createRange();ee.selectNodeContents(n(i)),ee.collapse(!1);const we=window.getSelection();we?.removeAllRanges(),we?.addRange(ee)}});let N=L("unknown");Pe(()=>{(async()=>f(N,await xg(),!0))()});let w=D(a),_=null;const A=async()=>_||(_=await kg(),_),B=async()=>{if(n(N)==="downloadable"||n(N)==="downloading"){s(Te.Extension);return}f(v,!0);const ee=await A(),we=await Pg({llmSession:ee,text:e.text,link:e.link,accessPageData:o(),rejectedTags:Array.from(n(d)),tags:e.tags});e.onChangeTags([...new Set([...e.tags,...we])]),f(v,!1)};Pe(()=>{const ee=we=>{if(!n(i)||document.activeElement!==n(i)||(we.preventDefault(),!we.clipboardData))return;const fe=we.clipboardData.getData("text/plain");e.onChangeText(fe);const me=window.getSelection();if(me&&me.rangeCount>0){const X=me.getRangeAt(0);X.deleteContents(),X.insertNode(document.createTextNode(fe)),X.collapse(!1),me.removeAllRanges(),me.addRange(X)}};return document.addEventListener("paste",ee),()=>{document.removeEventListener("paste",ee)}});var K=ch(),O=M(K);oh(O,{get noteId(){return e.noteId},get link(){return e.link},get pinned(){return e.pinned},get onPinnedChange(){return e.onPinnedChange},get text(){return e.text},get tags(){return e.tags},get deletedAt(){return e.deletedAt},get archivedAt(){return e.archivedAt},onAddLinkClick:()=>{f(c,!0)},onEditLinkClick:()=>{f(c,!0)},get canNext(){return e.canNext},get canPrev(){return e.canPrev},get onNext(){return e.onNext},get onPrev(){return e.onPrev},get formMode(){return e.mode}});var j=I(O,2);{var le=ee=>{{let we=D(()=>e.link?.url||""),fe=D(()=>e.link?.title||"");bg(ee,{get url(){return n(we)},get title(){return n(fe)},onChangeUrl:y,onDeleteUrl:C,get shownUrlInput(){return n(c)},set shownUrlInput(me){f(c,me,!0)}})}};W(j,ee=>{(n(c)||e.link?.url)&&ee(le)})}var ce=I(j,2),Q=b(ce),$=b(Q),Y=b($),F=b(Y);{var oe=ee=>{var we=sh();g(ee,we)};W(F,ee=>{e.text||ee(oe)})}var G=I(F,2);G.__input=h,et(G,ee=>f(i,ee),()=>n(i));var H=I(Q,2),te=b(H);{var ge=ee=>{var we=lh(),fe=b(we);{var me=X=>{var ie=ih(),de=b(ie);De(Ae=>vt(de,`updated: ${Ae??""}`),[()=>new Date(e.updatedAt).toLocaleString()]),g(X,ie)};W(fe,X=>{e.updatedAt&&X(me)})}g(ee,we)};W(te,ee=>{e.mode==="edit"&&ee(ge)})}var se=I(te,2),ue=b(se);{let ee=D(()=>n(w)&&n(N)!=="unknown"&&n(N)!=="unavailable"),we=D(()=>e.mode==="add"&&p.length>0);hl(ue,{get selectedTags(){return e.tags},onRejectedTag:fe=>{f(d,new Set([...n(d),fe]),!0)},get onChangeTags(){return e.onChangeTags},get genTagsEnabled(){return n(ee)},onGenTags:B,get generatingTags(){return n(v)},onUsePreviousTags:S,get previousTagsEnabled(){return n(we)},get shownTagInput(){return n(l)},set shownTagInput(fe){f(l,fe,!0)}})}g(t,K),ke()}mt(["input"]);function uh(t,e){Ce(e,!0);const{isInitedNotes:a,createNote:r,updateNote:o,deleteNote:s,getNoteById:i,getGetMapNotes:l,pinNote:c}=At(),{getViewMode:d,setPrevTags:u}=Wn(),{deleteSearchParam:v,getSearchParams:h}=zt(),{replaceDialogPage:m}=Ot();let y=L("loading"),C=L("idle"),p=L(""),S=L(!1),N=L(void 0),w=L(""),_=L(ft([])),A=L(-1),B=L(ft([])),K=L("unknown"),O=L(null);const j=()=>{n(B).push({link:ga(n(N)),text:n(w),tags:n(_).slice(),updatedAt:Date.now()}),f(A,0),(n(N)?.title||n(N)?.url||n(w)||n(_).length>0)&&f(O,{link:n(N),text:n(w),tags:n(_).slice()},!0),f(y,"finish")},le=async()=>{{const X=h().get("url"),ie=h().get("title"),de=h().get("text");X&&f(N,{url:X,title:ie||""},!0),de&&(!X&&Zo(de)?f(N,{url:de,title:ie||new URL(de).hostname},!0):f(w,de,!0)),v("url"),v("title"),v("text"),j();return}},ce=D(()=>a()&&n(y)==="finish"),Q=async X=>{f(C,"loading");try{n(p)?await o(n(p),{link:X.link,text:X.text,tags:X.tags.slice()}):(f(p,await r({link:X.link,text:X.text,tags:X.tags.slice(),pinned:n(S)}),!0),m(`${Te.NewNote}?id=${n(p)}`))}finally{f(C,"idle")}},$=async()=>{f(C,"loading");try{await s(n(p)),f(p,""),m(`${Te.NewNote}`)}finally{f(C,"idle")}},Y=X=>{f(S,X,!0),n(p)&&c(n(p),X)};Pe(()=>{le()}),Pe(()=>()=>{n(_).length>0&&u([...n(_)])});const F=()=>{f(O,{link:n(N),text:n(w),tags:n(_).slice()},!0)},oe=X=>{f(N,X,!0),f(B,n(B).slice(0,n(A)+1),!0),f(K,"unknown"),n(B).push({link:Xe(n(N)),text:n(w),tags:Xe(n(_)),updatedAt:Date.now()}),f(A,n(B).length-1),F()},G=X=>{f(_,X,!0),f(B,n(B).slice(0,n(A)+1),!0),f(K,"unknown"),n(B).push({link:Xe(n(N)),text:n(w),tags:Xe(n(_)),updatedAt:Date.now()}),f(A,n(B).length-1),F()},H=X=>{f(w,X,!0),f(B,n(B).slice(0,n(A)+1),!0),n(K)!=="text"?(n(B).push({link:Xe(n(N)),text:n(w),tags:Xe(n(_)),updatedAt:Date.now()}),f(A,n(B).length-1)):(n(B)[n(A)].text=n(w),n(B)[n(A)].updatedAt=Date.now()),f(K,"text"),F()};let te=D(()=>n(A)>0),ge=D(()=>n(A)<n(B).length-1);const se=()=>{if(n(A)<=0)return;f(A,n(A)-1);const X=n(B)[n(A)];f(N,Xe(X.link),!0),f(w,X.text,!0),f(_,Xe(X.tags),!0),f(K,"unknown"),F()},ue=()=>{if(n(A)>=n(B).length-1)return;f(A,n(A)+1);const X=n(B)[n(A)];f(N,Xe(X.link),!0),f(w,X.text,!0),f(_,Xe(X.tags),!0),f(K,"unknown"),F()};let ee=D(l);Ke(()=>{if(!n(ce)||n(C)==="loading"||!n(p))return;const X=n(ee)().get(n(p));Ct(()=>{X?.data&&(X.data.pinned!==n(S)&&f(S,!!X.data.pinned),X.data.text!==n(w)&&H(X.data.text),(X.data.link?.url!==n(N)?.url||X.data.link?.title!==n(N)?.title)&&oe(Xe(X.data.link)),JSON.stringify(X.data.tags)!==JSON.stringify(n(_))&&G(Xe(X.data.tags)))})}),Ke(()=>{n(C)!=="loading"&&n(O)&&Ct(()=>{n(O)&&(n(p)&&!n(O)?.link?.title&&!n(O)?.link?.url&&!n(O)?.text&&n(O)?.tags.length===0?$():Q(n(O)),f(O,null))})});var we=be(),fe=M(we);{var me=X=>{{let ie=D(()=>i(n(p))?.data.deletedAt),de=D(()=>i(n(p))?.data.archivedAt);dh(X,{get deletedAt(){return n(ie)},get archivedAt(){return n(de)},get noteId(){return n(p)},get canNext(){return n(ge)},get canPrev(){return n(te)},onPrev:se,onNext:ue,mode:"add",get link(){return n(N)},onChangeLink:oe,get text(){return n(w)},onChangeText:H,get tags(){return n(_)},onChangeTags:G,get pinned(){return n(S)},onPinnedChange:Y})}};W(fe,X=>{n(ce)&&X(me)})}g(t,we),ke()}const fh="modulepreload",vh=function(t){return"/"+t},js={},kt=function(e,a,r){let o=Promise.resolve();if(a&&a.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");o=c(a.map(d=>{if(d=vh(d),d in js)return;js[d]=!0;const u=d.endsWith(".css"),v=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":fh,u||(h.as="script"),h.crossOrigin="",h.href=d,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var gh=k('<div class="p-1tpcci8"><p class="p-1tpcci8">Something went wrong. Please reload the page</p> <!></div>');function hh(t){var e=gh(),a=I(b(e),2);Rt(a,{onClick:()=>location.reload(),children:(r,o)=>{var s=Ve("Reload");g(r,s)},$$slots:{default:!0}}),g(t,e)}var ph=k('<div class="p-uzefkz"><!></div>');function mh(t,e){Ce(e,!0);let a=L(!1);const{getDialogPageHeight:r}=us(),o=D(r);Pe(()=>{const c=setTimeout(()=>{f(a,!0)},250);return()=>{clearTimeout(c)}});var s=ph(),i=b(s);{var l=c=>{Ra(c,{})};W(i,c=>{n(a)&&c(l)})}De(()=>er(s,`min-height: ${n(o)??""}px;`)),g(t,s),ke()}function Mt(t,e){Ce(e,!0);const a={},r=Object.assign({"./Pages/About.svelte":()=>kt(()=>import("./aD-8YcqkE.js"),__vite__mapDeps([0,1])),"./Pages/AccessKeys.svelte":()=>kt(()=>import("./aCdI5F8T3.js"),__vite__mapDeps([2,3,4,5])),"./Pages/Account.svelte":()=>kt(()=>import("./aD_TVc_-a.js"),__vite__mapDeps([6,3,7])),"./Pages/Auth.svelte":()=>kt(()=>import("./aDH7LG8g8.js"),__vite__mapDeps([8,9])),"./Pages/ChangeTags.svelte":()=>kt(()=>import("./aCZ74dczE.js"),[]),"./Pages/ConfirmAccessKey.svelte":()=>kt(()=>import("./aBoaAzeGE.js"),__vite__mapDeps([10,4,3,11,12])),"./Pages/Exit.svelte":()=>kt(()=>import("./aDP7rCdoi.js"),__vite__mapDeps([13,14])),"./Pages/ExportData.svelte":()=>kt(()=>import("./aCf5Mfyd4.js"),__vite__mapDeps([15,16,17,18,19,20])),"./Pages/Extension.svelte":()=>kt(()=>import("./aBQuOxxoE.js"),__vite__mapDeps([21,18,19,22])),"./Pages/ImportData.svelte":()=>kt(()=>import("./aBIYehKgB.js"),__vite__mapDeps([23,24])),"./Pages/Install.svelte":()=>kt(()=>import("./aDhCG6dSi.js"),__vite__mapDeps([25,26])),"./Pages/InstallSuccess.svelte":()=>kt(()=>import("./aBsMXhbxL.js"),__vite__mapDeps([27,28])),"./Pages/Note.svelte":()=>kt(()=>import("./aCn405ftQ.js"),__vite__mapDeps([29,30])),"./Pages/Settings.svelte":()=>kt(()=>import("./avklwjWQm.js"),__vite__mapDeps([31,18,19,16,17,32])),"./Pages/Signin.svelte":()=>kt(()=>import("./aBnU4gPFj.js"),__vite__mapDeps([33,4,3,11,34])),"./Pages/Signup.svelte":()=>kt(()=>import("./aDnEsNoa9.js"),__vite__mapDeps([35,11,4,3,34])),"./Pages/Subscription.svelte":()=>kt(()=>import("./av7wFLRe1.js"),__vite__mapDeps([36,37])),"./Pages/Sync.svelte":()=>kt(()=>import("./aD2qv9g-e.js"),__vite__mapDeps([38,39]))}),o=async l=>{const c=`./Pages/${l[0].toUpperCase()+l.slice(1)}.svelte`;if(!a[l]){if(r[c]){const d=r[c]();return a[l]={promise:d},a[l].module=await d,a[l].module}throw new Error(`Page ${l} not found`)}return a[l].module||await a[l].promise};var s=be(),i=M(s);Yc(i,()=>o(e.page),l=>{mh(l,{})},(l,c)=>{const d=D(()=>n(c).default);var u=be(),v=M(u);Qc(v,()=>n(d),(h,m)=>{m(h,{get params(){return e.params},get hidden(){return e.hidden}})}),g(l,u)},l=>{hh(l)}),g(t,s),ke()}var nr,_l,wl;class _h{constructor(e){qe(this,nr);jt(this,"data");jt(this,"compare");this.data=[],this.compare=e}insert(e){this.data.push(e),dt(this,nr,_l).call(this)}extractMin(){if(this.data.length===0)return;const e=this.data[0],a=this.data.pop();return this.data.length&&a!==void 0&&(this.data[0]=a,dt(this,nr,wl).call(this)),e}isEmpty(){return this.data.length===0}}nr=new WeakSet,_l=function(){let e=this.data.length-1;const a=this.data[e];for(;e>0;){const r=Math.floor((e-1)/2);if(this.compare(a,this.data[r])>=0)break;[this.data[e],this.data[r]]=[this.data[r],this.data[e]],e=r}},wl=function(){let e=0;const a=this.data.length;for(;;){const r=2*e+1,o=2*e+2;let s=e;if(r<a&&this.compare(this.data[r],this.data[s])<0&&(s=r),o<a&&this.compare(this.data[o],this.data[s])<0&&(s=o),s===e)break;[this.data[e],this.data[s]]=[this.data[s],this.data[e]],e=s}};class wh{constructor(e,a){jt(this,"heap");jt(this,"done");jt(this,"cache",[]);this.heap=new _h(a);for(const r of e)this.heap.insert(r);this.done=!1}get(e,a){if(this.cache.length>=a)return this.cache.slice(e,a);for(;this.cache.length<=a&&!this.heap.isEmpty();){const r=this.heap.extractMin();r!==void 0&&this.cache.push(r)}return this.heap.isEmpty()&&(this.done=!0),this.cache.slice(e,a)}}var yh=k("<span>Back to notes</span>"),bh=k('<div class="c p-130fajz">No notes in bin</div> <div class="d p-130fajz"><!></div>',1),Sh=k("<span>Back to notes</span>"),Ch=k('<div class="c p-130fajz">No notes in archive</div> <div class="d p-130fajz"><!></div>',1),kh=k('<p class="f">No notes in bin</p>'),xh=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span>Add</span>',1),Th=k('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <span style="padding-left: 6px;">Import data</span>',1),Ph=k('<div class="g p-130fajz"><div class="d p-130fajz"><!></div> <div>or</div> <div class="d p-130fajz"><!></div></div>'),Eh=k('<div class="e p-130fajz"><!></div>'),Nh=k('<div class="h"><div class="c p-130fajz">No notes found</div></div>'),Ah=k('<div class="i p-130fajz"><ul class="p-130fajz"></ul></div>'),Dh=k('<div class="a p-130fajz"><div class="b p-130fajz"><!></div></div>');function Mh(t,e){Ce(e,!0);const{getCountDialog:a}=$t(),{getScrollContainer:r}=Mr(),{createHandleClickDialogPage:o,createDialogPageHref:s}=Ot(),{getSelectedTags:i}=Xn(),{getFeedOrder:l}=Hi(),{checkNotesInArchive:c,checkNotesInBin:d,checkNotes:u,isInitedNotes:v}=At(),{getSelectedMetaTags:h}=go(),{replaceSearchParams:m,getHref:y}=zt();Aa();const{getFiltredNotesLength:C,getFiltredNotes:p,getUpdatedFiltredNotesTimestamp:S}=La(),{getFeedSearch:N}=Aa();let w="keyboard",_=D(h),A=D(C),B=D(p),K=D(S),O=D(v),j=54,le=L(0),ce=L(0),Q=L(0),$=L(null),Y=D(r),F=null,oe=null,G=D(()=>n(_).has(ot.ARCHIVED)?"archive":n(_).has(ot.BIN)?"bin":"notes");const H=D(i);Ke(()=>{n(H),n(ee),n(Y)?.scrollTo(0,0)});const{enable:te}=ds(),ge=()=>{te(),F||(F=requestAnimationFrame(()=>{const ve=n(Y)?.scrollTop||0;f(Q,ve,!0);const Se=Math.ceil(n(le)/j);f(ce,Math.floor(ve/(j*Se))*(j*Se)),F=null}))},se=()=>{oe||(oe=requestAnimationFrame(()=>{f(le,window.innerHeight-180||0,!0);const ve=n(Y)?.scrollTop||0;f(Q,ve,!0);const Se=Math.ceil(n(le)/j);f(ce,Math.floor(ve/(j*Se))*(j*Se)),oe=null}))};Pe(()=>{const ve=Se=>{if(!(!zv()&&Gr()===void 0)&&!(a()>0)&&(Se.key==="ArrowDown"||Se.key==="ArrowUp")){if(Se.preventDefault(),Se.key==="ArrowDown"){const Oe=Gr(),Be=n(me).findIndex(P=>P.id===Oe),Ze=Ae(),Ge=Ee();if(!Oe||Be===-1)gn(Ze?.id);else if(Be<=Ge.index&&Be>=Ze.index)Os()&&Be!==-1&&de(Be+1)&&n(Y)&&(n(Y).scrollTop=Math.floor(n(Y).scrollTop/j)*j+j);else if(Be>Ge.index&&!de(Be-1)&&de(Be)){n(Y)&&(n(Y).scrollTop=Math.ceil(n(Y).scrollTop/j)*j+j);const P=Os();gn(P)}else gn(Ze?.id)}else if(Se.key==="ArrowUp"){const Oe=Gr(),Be=n(me).findIndex(P=>P.id===Oe),Ze=Ae(),Ge=Ee();if(!Oe||Be===-1)gn(Ge?.id);else if(Be<=Ge.index&&Be>=Ze.index)zs()&&Be!==-1&&de(Be-1)&&n(Y)&&(n(Y).scrollTop=Math.ceil(n(Y).scrollTop/j)*j-j);else if(Be<Ze.index&&!de(Be+1)&&de(Be)){n(Y)&&(n(Y).scrollTop=n(ie)+Be*j-j);const P=zs();gn(P)}else gn(Ge?.id)}ml()||Qo()}};return document.addEventListener("keydown",ve),()=>{document.removeEventListener("keydown",ve)}}),Pe(()=>{se(),ge()});const ue=()=>{ge()};Ke(()=>{N()!==""&&w==="keyboard"&&(gn(Ae().id),Qo())}),Ke(()=>(n(Y)?.addEventListener("scroll",ue),window.addEventListener("resize",se),()=>{n(Y)?.removeEventListener("scroll",ue),window.removeEventListener("resize",se)}));const ee=D(l);Ke(()=>{n(ee),n(K),f($,new wh(n(B),(ve,Se)=>{if(!ve||!Se||!ve.data||!Se.data)return 0;if(ve.data.pinned&&!Se.data.pinned)return-1;if(!ve.data.pinned&&Se.data.pinned)return 1;if(ve.data.pinned&&Se.data.pinned){if(ve.data.pinned<Se.data.pinned)return 1;if(ve.data.pinned>Se.data.pinned)return-1}const Oe=(Be,Ze)=>Be.data.text||Ze.data.text?(Be.data.text||"").localeCompare(Ze.data.text||""):(Be.data.link?.title||"").localeCompare(Ze.data.link?.title||"");switch(n(ee)){case"newest":return ve.data.createdAt<Se.data.createdAt?1:ve.data.createdAt>Se.data.createdAt?-1:Oe(ve,Se);case"oldest":return ve.data.createdAt>Se.data.createdAt?1:ve.data.createdAt<Se.data.createdAt?-1:Oe(ve,Se);case"AtoZ":return Oe(ve,Se);case"ZtoA":return Oe(Se,ve);case"updatedNewest":return ve.data.updatedAt<Se.data.updatedAt?1:ve.data.updatedAt>Se.data.updatedAt?-1:Oe(ve,Se);default:return 0}}),!0)});const we=D(()=>n(A)*j);let me=D(()=>{n(K);const ve=Math.ceil(n(le)/j);let Se=Math.floor(n(ce)/j);return Se=Se-Math.min(Se,ve),n($)?.get(Se,Se+ve*3)||[]}),X=D(()=>j*Math.ceil(n(le)/j));const ie=D(()=>n(ce)-Math.min(n(ce),n(X))),de=ve=>ve*j<n(Q)-n(ie)-j/2||ve*j>n(Q)-n(ie)+Math.floor(n(le)/j)*j,Ae=()=>{for(let ve=0;ve<n(me).length;ve++)if(!de(ve))return{index:ve,id:n(me)[ve].id};return{index:-1,id:void 0}},Ee=()=>{for(let ve=n(me).length-1;ve>=0;ve--)if(!de(ve))return{index:ve,id:n(me)[ve].id};return{index:-1,id:void 0}};Pe(()=>{document.addEventListener("mousemove",()=>{w="mouse"}),document.addEventListener("keydown",()=>{w="keyboard"})});const pe=ve=>{const Se=ve*j,Oe=n(Q)-n(ie);return Oe+Math.floor(n(le)/j)*j-Se<j*5&&Se-Oe>j*5};var ae=Dh(),xe=b(ae),ye=b(xe);{var Me=ve=>{Ra(ve,{})},Re=ve=>{var Se=be(),Oe=M(Se);{var Be=Ge=>{var P=bh(),E=I(M(P),2),x=b(E);{let R=D(()=>y(""));Rt(x,{element:"a",get href(){return n(R)},onClick:z=>{z.preventDefault(),m("")},children:(z,T)=>{var J=yh();g(z,J)},$$slots:{default:!0}})}g(Ge,P)},Ze=Ge=>{var P=be(),E=M(P);{var x=z=>{var T=Ch(),J=I(M(T),2),q=b(J);{let Z=D(()=>y(""));Rt(q,{element:"a",get href(){return n(Z)},onClick:re=>{re.preventDefault(),m("")},children:(re,U)=>{var ne=Sh();g(re,ne)},$$slots:{default:!0}})}g(z,T)},R=z=>{var T=be(),J=M(T);{var q=re=>{var U=Eh(),ne=b(U);{var Ne=Le=>{var Ie=kh();g(Le,Ie)},ze=Le=>{var Ie=Ph(),He=b(Ie),pt=b(He);{let it=D(()=>s(Te.NewNote)),_t=D(()=>o(Te.NewNote));Rt(pt,{element:"a",get href(){return n(it)},get onClick(){return n(_t)},children:(Pn,Bt)=>{var Dt=xh(),En=M(Dt);he(En,()=>({"--size":"18px","--color":"#b0b0b0"})),_e(En.lastChild,{name:"plus"}),g(Pn,Dt)},$$slots:{default:!0}})}var ct=I(He,4),st=b(ct);{let it=D(()=>s(Te.ImportData)),_t=D(()=>o(Te.ImportData));Rt(st,{element:"a",get href(){return n(it)},get onClick(){return n(_t)},children:(Pn,Bt)=>{var Dt=Th(),En=M(Dt);he(En,()=>({"--size":"18px","--color":"#b0b0b0"})),_e(En.lastChild,{name:"import"}),g(Pn,Dt)},$$slots:{default:!0}})}g(Le,Ie)};W(ne,Le=>{n(G)==="bin"?Le(Ne):Le(ze,!1)})}g(re,U)},Z=re=>{var U=be(),ne=M(U);{var Ne=Le=>{var Ie=Nh();g(Le,Ie)},ze=Le=>{var Ie=Ah(),He=b(Ie);Hn(He,23,()=>n(me),pt=>pt.data,(pt,ct,st)=>{var it=be(),_t=M(it);{var Pn=Bt=>{{let Dt=D(()=>n(me)[n(st)+1]?.id),En=D(()=>n(me)[n(st)-1]?.id),_o=D(()=>de(n(st))),wo=D(()=>pe(n(st)));Jv(Bt,{get nextNoteId(){return n(Dt)},get prevNoteId(){return n(En)},get mode(){return n(G)},get focusHidden(){return n(_o)},get showMenuUp(){return n(wo)},get noteId(){return n(ct).id},get noteData(){return n(ct).data}})}};W(_t,Bt=>{n(ct).data&&Bt(Pn)})}g(pt,it)}),De(pt=>{er(Ie,pt),er(He,`transform: translateY(${n(ie)??""}px);`)},[()=>`--minHeight: ${Math.max((n(we)>n(le),n(we)),0)}px`]),g(Le,Ie)};W(ne,Le=>{n(me).length===0?Le(Ne):Le(ze,!1)},!0)}g(re,U)};W(J,re=>{!d()&&!c()&&!u()?re(q):re(Z,!1)},!0)}g(z,T)};W(E,z=>{n(G)==="archive"&&!c()?z(x):z(R,!1)},!0)}g(Ge,P)};W(Oe,Ge=>{n(G)==="bin"&&!d()?Ge(Be):Ge(Ze,!1)},!0)}g(ve,Se)};W(ye,ve=>{n(O)?ve(Re,!1):ve(Me)})}g(t,ae),ke()}var Ih=k('<div class="a p-qboa24"></div> <div class="b p-qboa24"><!></div>',1);function Lh(t){var e=Ih(),a=I(M(e),2),r=b(a);Mh(r,{}),g(t,e)}function Rh(t,e){Ce(e,!0);const{setAnimationSettings:a}=Tn();let r=Fe(e,"animationRef",7),o=Fe(e,"dialog",7);gl(t,{baseActionThreshold:33,onInit:async()=>{if(!o())throw new Error("dialog is not defined");if(!(e.dialogState==="opened"||e.dialogState==="opening"))return;let d=0,u=0,v=()=>1;if(r().current){r().current.pause();let m=Number(r().current.currentTime);br()&&(m=Number(m)+50,r().current.currentTime=Math.min(Math.max(Un-1,m),m));const y=r().current.effect?.getComputedTiming().progress||0;v=()=>y,r().current.commitStyles(),r().current.cancel(),r().current=void 0}await new Promise(m=>requestAnimationFrame(m)),u=1-v();const h=u*e.dialogWidth;return o().style.setProperty("--backdrop-bg",`${Math.abs(1-u)*.1}`),a({swipingRatio:Math.abs(1-u)*25,isSwiping:!0,duration:0}),o().style.transform=`translate3d(${h}px, 0, 0)`,o().style.setProperty("--transition-timing-dialog","0s"),e.onSwipe(),{initialPosition:d,currentPosition:h,minPosition:0,maxPosition:e.dialogWidth,width:e.dialogWidth}},onCancel:()=>{e.onCancelSwipe()},onUpdate:({newPosition:d,width:u})=>{if(!o())throw new Error("dialog is not defined");e.dialogState==="swiping"&&(o().style.setProperty("--backdrop-bg",`${Math.abs(1-d/u)*.1}`),o().style.transform=`translate3d(${d}px, 0, 0)`,a({swipingRatio:Math.abs(1-d/u)*25}))},onFinish:({swipeVelocity:d,currentPosition:u,width:v,actionThreshold:h,initialPosition:m})=>{if(a({isSwiping:!1}),!o())throw new Error("Dialog is not defined");if(e.dialogState!=="swiping")return;const y=()=>Math.abs(m+u)/v*100;let C=null;if(d<=-ca?C="open":d>=ca?C="close":C=Math.abs(y())>h?"close":"open",r().progress=vl(y()/100),C==="close"){const p=(1-(r().progress||0))*Un/1e3;a({duration:p}),o().style.setProperty("--transition-timing-dialog",`${p}s`),a({swipingRatio:0}),e.onClose()}else{const p=(r().progress||1)*Un/1e3;a({duration:p}),o().style.setProperty("--transition-timing-dialog",`${p}s`),a({swipingRatio:25}),e.onOpen()}}}),ke()}var Fh=k('<div class="d p-8xr118"> </div>'),Oh=k('<button class="e f p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),zh=k('<a class="e g p-8xr118"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></a>'),Bh=k('<div><div class="a p-8xr118"><div class="b p-8xr118"><div class="c p-8xr118"><!> <!> <!></div></div></div> <!> <!></div>'),jh=k("<dialog><!></dialog> <!>",1);function Hh(t,e){Ce(e,!0);const{isScrolling:a,enable:r}=ds();let o=L(null),s=L(null),i={};const{setAnimationSettings:l,getAnimationSettings:c}=Tn(),{checkLeftEnd:d,checkLeftStart:u,setLeftEnd:v,setLeftStart:h,getCountDialog:m}=$t(),y=D(u),C=D(d);let p=D(()=>c().working);const S=()=>{e.dialogState!=="opened"&&e.onStartOpening()},N=()=>{requestAnimationFrame(()=>{e.onClose()})},w=()=>{e.onSwipe()},_=$=>{$.preventDefault(),N()};Pe(()=>(n(o)?.addEventListener("close",N),n(o)?.addEventListener("cancel",_),()=>{n(o)?.removeEventListener("close",N),n(o)?.removeEventListener("cancel",_)})),Ke(()=>{m()>0&&Ct(()=>{l({swipingRatio:25})})}),Ke(()=>{e.dialogState==="opening"?Ct(()=>{requestAnimationFrame(()=>{if(!n(o))return;const $=(i.progress||1)*Un,Y=n(o).style.transform||`translate3d(${n(y)?"-100%":"100%"}, 0, 0)`;n(o).style.transform="";const F=n(o)?.animate([{transform:Y},{transform:"translate3d(0, 0, 0)"}],{duration:$,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=F,F&&(F.onfinish=()=>{e.onOpened(),l({swipingRatio:25}),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l({duration:Pa().duration}),F.cancel(),i.current=void 0,i.progress=void 0,n(y)&&h(!1)})})}):e.dialogState==="closing"&&Ct(async()=>{c().working||(l({working:!0}),await new Promise($=>requestAnimationFrame($))),requestAnimationFrame(()=>{if(!n(o))return;l({swipingRatio:0});const $=(1-(i.progress||0))*Un,Y=n(o).style.transform||"translate3d(0, 0, 0)";n(o).style.transform="";const F=n(o)?.animate([{transform:Y},{transform:`translate3d(${n(C)?"-100%":"100%"}, 0, 0)`}],{duration:$,easing:"cubic-bezier(0.42, 0, 0.58, 1)",fill:"forwards"});i.current=F,F&&(F.onfinish=()=>{e.onClosed(),n(o)&&(n(o).style.removeProperty("--transition-timing-dialog"),n(o).style.removeProperty("--backdrop-bg")),l({duration:Pa().duration}),F.cancel(),i.current=void 0,i.progress=void 0,n(C)&&v(!1)})})})});const A=()=>{r()},B=D(a);Pe(()=>{if(n(o)&&!n(o).open){if(n(o).showModal(),br()&&n(o).getBoundingClientRect(),!n(p)){e.onOpened();return}e.onStartOpening()}});var K=jh(),O=M(K),j=b(O);{var le=$=>{var Y=Bh(),F=b(Y),oe=b(F),G=b(oe),H=b(G);{var te=X=>{var ie=Fh(),de=b(ie);De(()=>vt(de,e.title)),g(X,ie)};W(H,X=>{e.title&&X(te)})}var ge=I(H,2);{var se=X=>{var ie=Oh();ie.__click=N;var de=b(ie);he(de,()=>({"--size":"28px"})),_e(de.lastChild,{name:"back"});var Ae=I(de,2);wt(Ae,{children:(Ee,pe)=>{var ae=Ve("back");g(Ee,ae)}}),g(X,ie)};W(ge,X=>{e.blocked||X(se)})}var ue=I(ge,2);{var ee=X=>{var ie=zh();ie.__click=function(...Ee){e.onOpenWindow?.apply(this,Ee)};var de=b(ie);he(de,()=>({"--scale":"0.7","--size":"28px"})),_e(de.lastChild,{name:"open-window"});var Ae=I(de,2);wt(Ae,{children:(Ee,pe)=>{var ae=Ve("open window");g(Ee,ae)}}),De(()=>ut(ie,"href",e.openWindowHref)),g(X,ie)};W(ue,X=>{e.onOpenWindow&&X(ee)})}var we=I(F,2);je(we,()=>e.children);var fe=I(we,2);{var me=X=>{ho(X,{})};W(fe,X=>{e.dialogState==="opened"&&X(me)})}et(Y,X=>f(s,X),()=>n(s)),De(()=>tt(Y,1,at({o:!0,p:e.blocked||e.hidden||e.dialogState!=="opened"}),"p-8xr118")),Qt("scroll",Y,A),g($,Y)};W(j,$=>{e.dialogState!=="preOpening"&&$(le)})}et(O,$=>f(o,$),()=>n(o));var ce=I(O,2);{var Q=$=>{Rh($,{get dialogWidth(){return e.dialogWidth},onCancelSwipe:S,onClose:N,onSwipe:w,get onOpen(){return e.onStartOpening},get animationRef(){return i},get dialog(){return n(o)},get dialogState(){return e.dialogState}})};W(ce,$=>{n(s)&&!n(B)&&!e.blocked&&!e.hidden&&$(Q)})}De(()=>tt(O,1,at({h:!0,i:n(p),j:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping",k:e.hidden,l:e.dialogState==="opened",m:n(y),n:e.dialogState==="opened"||e.dialogState==="opening"||e.dialogState==="swiping"}),"p-8xr118")),g(t,K),ke()}mt(["click"]);function Uh(t,e){Ce(e,!0);let a=Fe(e,"hidden",3,!1),r=Fe(e,"onClosed",3,()=>{}),o=L(0);Pe(()=>{const S=()=>{f(o,document.body.offsetWidth,!0)};return window.addEventListener("resize",S),S(),()=>{window.removeEventListener("resize",S)}});const{dialogDec:s,dialogInc:i}=$t(),{setAnimationSettings:l}=Tn();Pe(()=>(i(),()=>{s()}));let c=L("closed");const d=()=>{f(c,"opening")},u=()=>{f(c,"swiping")},v=()=>{f(c,"opened")},h=()=>{e.onClose(),f(c,"closing")},m=()=>{f(c,"closed"),r()()};Ke(()=>{e.shown&&n(c)==="closed"?f(c,"preOpening"):!e.shown&&n(c)==="opened"&&f(c,"closing")}),Ke(()=>{n(c)==="closed"?Ct(()=>{l({swipingRatio:0,duration:Pa().duration})}):(n(c)==="opened"||n(c)==="opening")&&Ct(()=>{l({swipingRatio:25,duration:Pa().duration})})});var y=be(),C=M(y);{var p=S=>{Hh(S,{get dialogWidth(){return n(o)},get dialogState(){return n(c)},get title(){return e.title},onStartOpening:d,onOpened:v,onClose:h,onClosed:m,onSwipe:u,get openWindowHref(){return e.openWindowHref},get onOpenWindow(){return e.onOpenWindow},get hidden(){return a()},get blocked(){return e.blocked},children:(N,w)=>{var _=be(),A=M(_);je(A,()=>e.children),g(N,_)},$$slots:{default:!0}})};W(C,S=>{n(c)!=="closed"&&S(p)})}g(t,y),ke()}const Wh=({getDialog:t,onOpen:e,onStartClose:a,onClose:r})=>{const o=i=>{i.preventDefault(),a()},s=()=>{r?.()};Pe(()=>{const i=t();return i?.addEventListener("cancel",o),i?.addEventListener("close",s),()=>{i?.removeEventListener("cancel",o),i?.removeEventListener("close",s)}}),Pe(()=>{const i=t();i?.showModal(),i?.getBoundingClientRect(),e()})};var Vh=k('<button class="c d p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Kh=k('<div class="e p-phkj9l"> </div>'),qh=k('<button class="c f p-phkj9l"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!></button>'),Gh=k('<dialog><div><div class="a p-phkj9l"><div class="b p-phkj9l"><div><!></div> <!> <div><!></div></div></div> <div class="g p-phkj9l"><!></div></div> <!></dialog> <!>',1);function Yh(t,e){Ce(e,!0);let a=Fe(e,"blockedDialog",3,!1),r=Fe(e,"hiddenDialog",3,!1),o=Fe(e,"isDesktopAnimationOff",3,!1),s=L(null),i=L(null),l=L(!1),c=L(null);Wh({getDialog:()=>n(s),onOpen:()=>e.onOpen(),onStartClose:()=>e.onStartClose(),onClose:()=>e.onClose()});const{getAnimationSettings:d,setAnimationSettings:u}=Tn();let v=D(d);Ke(()=>{e.stateDialog==="closing"&&(n(v).working?n(i)?.addEventListener("transitionend",()=>{n(s)?.close()},{once:!0}):n(s)?.close())});const{getDialogPageHeight:h}=us(),m=D(h);Pe(()=>{setTimeout(()=>{f(l,!0),u({working:!0})},100)});var y=Gh(),C=M(y),p=b(C),S=b(p),N=b(S),w=b(N),_=b(w);{var A=F=>{var oe=Vh();oe.__click=()=>{e.onStartBack()};var G=b(oe);he(G,()=>({"--size":"24px"})),_e(G.lastChild,{name:"back"});var H=I(G,2);wt(H,{children:(te,ge)=>{var se=Ve("back");g(te,se)}}),g(F,oe)};W(_,F=>{(!(a()||r())||a())&&e.onStartBack&&F(A)})}var B=I(w,2);{var K=F=>{var oe=Kh(),G=b(oe);De(()=>vt(G,e.title)),g(F,oe)};W(B,F=>{e.title&&F(K)})}var O=I(B,2),j=b(O);{var le=F=>{var oe=qh();oe.__click=()=>{e.onStartClose()};var G=b(oe);he(G,()=>({"--size":"24px"})),_e(G.lastChild,{name:"close"});var H=I(G,2);wt(H,{children:(te,ge)=>{var se=Ve("close");g(te,se)}}),g(F,oe)};W(j,F=>{a()||r()||F(le)})}var ce=I(S,2),Q=b(ce);je(Q,()=>e.children),et(p,F=>f(i,F),()=>n(i));var $=I(p,2);ho($,{get ref(){return n(c)},set ref(F){f(c,F,!0)}}),et(C,F=>f(s,F),()=>n(s));var Y=I(C,2);fs(Y,{get dialog(){return n(s)},get dialogInner(){return n(i)},get onClose(){return e.onStartClose},get notificationRef(){return n(c)},set notificationRef(F){f(c,F,!0)}}),De(()=>{tt(C,1,at({h:!0,i:e.stateDialog==="open",j:n(l),k:n(v).working,l:o(),m:r()}),"p-phkj9l"),er(p,`height: ${n(m)+74}px`),tt(p,1,at({n:!0,i:e.stateDialog==="open",j:n(l),k:n(v).working,l:o()}),"p-phkj9l")}),g(t,y),ke()}mt(["click"]);const Xh=({onStartClose:t,onClosed:e})=>{let a=L("close");return{get state(){return n(a)},set state(i){f(a,i,!0)},handleStartClose:(i=!1)=>{i||(f(a,"closing"),t?.())},handleOpen:()=>{f(a,"open")},handleClose:()=>{f(a,"close"),e?.()}}};function Jh(t,e){Ce(e,!0);let a=Fe(e,"blockedDialog",3,!1),r=Fe(e,"hiddenDialog",3,!1),o=Fe(e,"onStartClose",3,()=>{}),s=Fe(e,"onClosed",3,()=>{}),i=Xh({onStartClose:()=>o()(),onClosed:()=>s()()});const{dialogDec:l,dialogInc:c}=$t();Pe(()=>(c(),()=>{l()})),Ke(()=>{i.state==="close"&&e.shownDialog?i.state="opening":i.state==="open"&&!e.shownDialog&&i.handleStartClose(a())});const d=m=>{m.key==="Escape"&&a()&&(m.preventDefault(),m.stopPropagation())};Pe(()=>(document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}));var u=be(),v=M(u);{var h=m=>{Yh(m,{get title(){return e.title},get stateDialog(){return i.state},get blockedDialog(){return a()},get hiddenDialog(){return r()},get onOpen(){return i.handleOpen},get onStartBack(){return e.onStartBack},onStartClose:()=>{i.handleStartClose(a())},get onClose(){return i.handleClose},children:(y,C)=>{var p=be(),S=M(p);je(S,()=>e.children),g(y,p)},$$slots:{default:!0}})};W(v,m=>{i.state!=="close"&&m(h)})}g(t,u),ke()}const Hs=(t,e=Je,a=Je,r)=>{let o=Er(()=>Ll(r?.(),!1));var s=be(),i=M(s);{var l=d=>{St(d,{children:(u,v)=>{Mt(u,{get hidden(){return n(o)},get page(){return Te.Settings}})},$$slots:{default:!0}})},c=d=>{var u=be(),v=M(u);{var h=y=>{St(y,{children:(C,p)=>{uh(C,{})},$$slots:{default:!0}})},m=y=>{var C=be(),p=M(C);{var S=w=>{St(w,{children:(_,A)=>{Mt(_,{get params(){return a()},get hidden(){return n(o)},get page(){return Te.Note}})},$$slots:{default:!0}})},N=w=>{var _=be(),A=M(_);{var B=O=>{St(O,{children:(j,le)=>{Mt(j,{get hidden(){return n(o)},get page(){return Te.ImportData}})},$$slots:{default:!0}})},K=O=>{var j=be(),le=M(j);{var ce=$=>{St($,{children:(Y,F)=>{Mt(Y,{get hidden(){return n(o)},get page(){return Te.ExportData}})},$$slots:{default:!0}})},Q=$=>{var Y=be(),F=M(Y);{var oe=H=>{St(H,{children:(te,ge)=>{gg(te,{})},$$slots:{default:!0}})},G=H=>{var te=be(),ge=M(te);{var se=ee=>{St(ee,{children:(we,fe)=>{Mt(we,{get hidden(){return n(o)},get page(){return Te.Install}})},$$slots:{default:!0}})},ue=ee=>{var we=be(),fe=M(we);{var me=ie=>{St(ie,{children:(de,Ae)=>{Mt(de,{get hidden(){return n(o)},get page(){return Te.InstallSuccess}})},$$slots:{default:!0}})},X=ie=>{var de=be(),Ae=M(de);{var Ee=ae=>{St(ae,{children:(xe,ye)=>{Mt(xe,{get hidden(){return n(o)},get page(){return Te.Auth}})},$$slots:{default:!0}})},pe=ae=>{var xe=be(),ye=M(xe);{var Me=ve=>{St(ve,{children:(Se,Oe)=>{Mt(Se,{get hidden(){return n(o)},get page(){return Te.Signup}})},$$slots:{default:!0}})},Re=ve=>{var Se=be(),Oe=M(Se);{var Be=Ge=>{St(Ge,{children:(P,E)=>{Mt(P,{get hidden(){return n(o)},get page(){return Te.Signin}})},$$slots:{default:!0}})},Ze=Ge=>{var P=be(),E=M(P);{var x=z=>{St(z,{children:(T,J)=>{Mt(T,{get hidden(){return n(o)},get page(){return Te.AccessKeys}})},$$slots:{default:!0}})},R=z=>{var T=be(),J=M(T);{var q=re=>{St(re,{children:(U,ne)=>{Mt(U,{get hidden(){return n(o)},get page(){return Te.Account}})},$$slots:{default:!0}})},Z=re=>{var U=be(),ne=M(U);{var Ne=Le=>{St(Le,{children:(Ie,He)=>{Mt(Ie,{get hidden(){return n(o)},get page(){return Te.ConfirmAccessKey}})},$$slots:{default:!0}})},ze=Le=>{var Ie=be(),He=M(Ie);{var pt=st=>{St(st,{children:(it,_t)=>{Mt(it,{get hidden(){return n(o)},get page(){return Te.Exit}})},$$slots:{default:!0}})},ct=st=>{var it=be(),_t=M(it);{var Pn=Bt=>{var Dt=be(),En=M(Dt);{var _o=Fa=>{St(Fa,{children:(Rr,vs)=>{Mt(Rr,{get hidden(){return n(o)},get page(){return Te.Sync}})},$$slots:{default:!0}})},wo=Fa=>{var Rr=be(),vs=M(Rr);{var yl=Oa=>{St(Oa,{children:(Fr,gs)=>{Mt(Fr,{get hidden(){return n(o)},get page(){return Te.Subscription}})},$$slots:{default:!0}})},bl=Oa=>{var Fr=be(),gs=M(Fr);{var Sl=za=>{St(za,{children:(yo,kl)=>{Mt(yo,{get hidden(){return n(o)},get page(){return Te.About}})},$$slots:{default:!0}})},Cl=za=>{St(za,{children:(yo,kl)=>{cg(yo,{})},$$slots:{default:!0}})};W(gs,za=>{e()===Te.About?za(Sl):za(Cl,!1)},!0)}g(Oa,Fr)};W(vs,Oa=>{e()===Te.Subscription?Oa(yl):Oa(bl,!1)},!0)}g(Fa,Rr)};W(En,Fa=>{e()===Te.Sync?Fa(_o):Fa(wo,!1)},!0)}g(Bt,Dt)};W(_t,Bt=>{e(),Te.Extension,Bt(Pn,!1)},!0)}g(st,it)};W(He,st=>{e()===Te.Exit?st(pt):st(ct,!1)},!0)}g(Le,Ie)};W(ne,Le=>{e()===Te.ConfirmAccessKey?Le(Ne):Le(ze,!1)},!0)}g(re,U)};W(J,re=>{e()===Te.Account?re(q):re(Z,!1)},!0)}g(z,T)};W(E,z=>{e()===Te.AccessKeys?z(x):z(R,!1)},!0)}g(Ge,P)};W(Oe,Ge=>{e()===Te.Signin?Ge(Be):Ge(Ze,!1)},!0)}g(ve,Se)};W(ye,ve=>{e()===Te.Signup?ve(Me):ve(Re,!1)},!0)}g(ae,xe)};W(Ae,ae=>{e()===Te.Auth?ae(Ee):ae(pe,!1)},!0)}g(ie,de)};W(fe,ie=>{e()===Te.InstallSuccess?ie(me):ie(X,!1)},!0)}g(ee,we)};W(ge,ee=>{e()===Te.Install?ee(se):ee(ue,!1)},!0)}g(H,te)};W(F,H=>{e()===Te.AccountSetup?H(oe):H(G,!1)},!0)}g($,Y)};W(le,$=>{e()===Te.ExportData?$(ce):$(Q,!1)},!0)}g(O,j)};W(A,O=>{e()===Te.ImportData?O(B):O(K,!1)},!0)}g(w,_)};W(p,w=>{e()===Te.Note?w(S):w(N,!1)},!0)}g(y,C)};W(v,y=>{e()===Te.NewNote?y(h):y(m,!1)},!0)}g(d,u)};W(i,d=>{e()===Te.Settings?d(l):d(c,!1)})}g(t,s)};var Zh=k("<!> <!>",1);function Qh(t,e){Ce(e,!0);let a=D(()=>({...e.openWindowHref?{openWindowHref:e.openWindowHref}:{},...e.onOpenWindow?{onOpenWindow:e.onOpenWindow}:{}}));const{checkBlockedDialog:r,checkClosableDialog:o}=$t(),{sidebarClose:s,getSidebarState:i}=Dr(),{setAnimationSettings:l}=Tn(),c=D(r),d=D(o),{getDialogPages:u}=Ot(),{getAccount:v}=cs();let h=D(u),m=D(()=>v()!==void 0);const{checkMobileSize:y}=va();let C=L(ft([]));const p=D(y),{clearDialogPages:S,popDialogPage:N}=Ot(),{checkLeftStart:w}=$t();let _=D(w);Ke(()=>{u().length>0&&i()!=="closed"&&setTimeout(()=>{s()},0)});const A=()=>{N()},B=()=>{S()};Pe(()=>{n(h).length===0&&l({working:!0})}),Ke(()=>{n(h),n(p),Ct(()=>{if(n(p))n(h).length>=n(C).length||n(_)?f(C,n(h).map(Y=>({page:Y,shown:!0})),!0):f(C,n(C).map((Y,F)=>({page:Y.page,shown:F<n(h).length})),!0);else if(n(h).length>=n(C).length)f(C,n(h).map(Y=>({page:Y,shown:!0})),!0);else{if(n(h).length===0){f(C,[{page:n(C)[n(C).length-1].page,shown:!1}],!0);return}f(C,n(h).map(Y=>({page:Y,shown:!0})),!0)}})});const K=()=>{f(C,n(h).map(Y=>({page:Y,shown:!0})),!0)};var O=Zh(),j=M(O);{var le=Y=>{Lh(Y)};W(j,Y=>{n(m)&&Y(le)})}var ce=I(j,2);{var Q=Y=>{var F=be(),oe=M(F);Hn(oe,19,()=>n(C),G=>G.page.split("?")[0],(G,H,te)=>{const ge=D(()=>n(H).page.split("?")[1]),se=D(()=>n(H).page.split("?")[0]),ue=D(()=>n(te)!==n(C).length-1&&!!n(C)[n(te)+1]?.shown),ee=D(()=>n(te)===0);{let we=D(()=>Ms[n(se)]||""),fe=D(()=>n(c)||n(ee)&&!n(d)),me=D(()=>({...n(se)!==Te.NewNote&&n(se)!==Te.Note?n(a):{}}));Uh(G,Bo({get shown(){return n(H).shown},get title(){return n(we)},get hidden(){return n(ue)},get blocked(){return n(fe)},onClose:A,onClosed:K},()=>n(me),{children:(X,ie)=>{Hs(X,()=>n(se),()=>n(ge),()=>n(ue))},$$slots:{default:!0}}))}}),g(Y,F)},$=Y=>{var F=be(),oe=M(F);{var G=H=>{const te=D(()=>n(C)[n(C).length-1].page.split("?")[1]),ge=D(()=>n(C)[n(C).length-1].page.split("?")[0]),se=D(()=>n(C)[n(C).length-1].shown),ue=D(()=>n(C).length===1);{let ee=D(()=>Ms[n(ge)]||""),we=D(()=>n(c)||!n(d)),fe=D(()=>n(c)||n(ue)?void 0:A);Jh(H,{get shownDialog(){return n(se)},get title(){return n(ee)},get blockedDialog(){return n(we)},hiddenDialog:!1,get onStartBack(){return n(fe)},onStartClose:B,onClosed:K,children:(me,X)=>{Hs(me,()=>n(ge),()=>n(te))},$$slots:{default:!0}})}};W(oe,H=>{n(C).length>0&&H(G)},!0)}g(Y,F)};W(ce,Y=>{y()?Y(Q):Y($,!1)})}g(t,O),ke()}function $h(t,e){Ce(e,!1);let a=0;Pe(()=>{document.addEventListener("touchstart",r=>{a=r.touches[0].clientX},{passive:!1}),document.addEventListener("touchmove",r=>{const s=r.touches[0].clientX-a;(a<30&&s>0||a>window.innerWidth-30&&s<0)&&r.preventDefault()},{passive:!1}),document.addEventListener("touchend",()=>{a=0}),document.addEventListener("touchcancel",()=>{a=0})}),is(),ke()}const ep=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;var tp=k('<div><button class="d p-bn1wva"><!> <span class="e p-bn1wva"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></span></button></div>'),np=k('<!> <!> <!> <!> <main><div class="a p-bn1wva"><div class="b p-bn1wva"><!></div></div> <div class="c p-bn1wva"><!></div></main> <!>',1);function ap(t,e){Ce(e,!0);const{replaceSearchParams:a,getHref:r,getSearchParams:o}=zt(),{hasDialogPage:s}=Ot(),{setScrollContainer:i}=Mr(),{getAccount:l,init:c}=cs(),{isInitedNotes:d}=At(),{isInitedSettings:u}=Wn(),{isInited:v}=Wd(),{getDialogPages:h}=Ot(),{createBroadcastChannel:m,tabId:y}=vo(),C=m(),{getSidebarState:p}=Dr(),{setClosableDialog:S}=$t(),{getViewMode:N}=Wn(),w=()=>{ep()?a(`${Jt}=${Te.AccountSetup}`):a(`${Jt}=${Te.Install}`)};Pe(()=>{c(ve=>{ve===void 0?w():(s(Te.AccountSetup)&&a(""),ve?f(O,ve):f(O,null))});const Re=async ve=>{const Se=JSON.parse(ve.data);if(Se.tabId&&Se.tabId===y)return;const Oe=Se;Oe.type==="initLocalAccount"||Oe.type==="initCloudAccount"||Oe.type==="updateAccount"||Oe.type==="disconnectCloudAccount"?a(""):Oe.type==="exit"&&w()};return C.addEventListener(Re),()=>C.removeEventListener(Re)});const{getAnimationSettings:_}=Tn();let A=L(!1),B=0,K=D(()=>h().length>0),O=D(l),j=D(d),le=D(u),ce=D(v),Q=L(null);const $=()=>{n(Q)&&n(Q).scrollTo({top:0})};Ke(()=>{S(n(O)!==void 0)}),Ke(()=>{i(n(Q))});const Y=()=>{if(n(Q)){const Re=n(Q).scrollTop||0;Re===0?f(A,!1):!n(A)&&B>Re?f(A,!0):n(A)&&B+50<Re&&f(A,!1),B=Re}},F=()=>{Y()};Ke(()=>(n(Q)?.addEventListener("scroll",F),window.addEventListener("resize",F),()=>{n(Q)?.removeEventListener("scroll",F),window.removeEventListener("resize",F)}));const oe=D(p);let G=D(_);const H=()=>{const Re=new URLSearchParams(o());return r(Re)},te=async Re=>{Re.preventDefault()},ge=D(N),se=D(()=>n(ge)==="popup"?{onOpenWindow:te,openWindowHref:H()}:{});var ue=np(),ee=M(ue);$h(ee,{});var we=I(ee,2);Hu(we,{});var fe=I(we,2);ho(fe,{});var me=I(fe,2);cf(me,{});var X=I(me,2),ie=b(X),de=b(ie),Ae=b(de);{var Ee=Re=>{sg(Re,Bo(()=>n(se)))};W(Ae,Re=>{n(j)&&n(ce)&&n(le)&&n(O)!==void 0&&Re(Ee)})}var pe=I(ie,2),ae=b(pe);{var xe=Re=>{Qh(Re,Bo(()=>n(se)))};W(ae,Re=>{n(j)&&n(le)&&n(ce)&&Re(xe)})}et(X,Re=>f(Q,Re),()=>n(Q));var ye=I(X,2);{var Me=Re=>{var ve=tp(),Se=b(ve);Se.__click=$;var Oe=b(Se);wt(Oe,{children:(Ge,P)=>{var E=Ve("top");g(Ge,E)}});var Be=I(Oe,2),Ze=b(Be);he(Ze,()=>({"--rotate":"90deg","--size":"28px"})),_e(Ze.lastChild,{name:"back"}),De(()=>{er(ve,`--swiping-ratio: ${n(G).swipingRatio}; --transition-timing-default: ${n(G).duration}s;`),tt(ve,1,at({i:!0,g:n(G).working&&!n(G).isSwiping,j:n(K)||n(oe)!=="closed"}),"p-bn1wva")}),g(Re,ve)};W(ye,Re=>{n(A)&&Re(Me)})}De(()=>{er(X,`--swiping-ratio: ${n(G).swipingRatio}; --transition-timing-default: ${n(G).duration}s;`),tt(X,1,at({f:!0,g:n(G).working&&!n(G).isSwiping,h:n(oe)!=="closed"}),"p-bn1wva")}),g(t,ue),ke()}mt(["click"]);function rp(t){gu(t,{children:(e,a)=>{ap(e,{})}})}window.addEventListener("unhandledrejection",t=>{alert("Error: "+t.reason.message)});window.isUnsupportedBrowser||Vc(rp,{target:document.getElementById("app")});export{Xe as $,D as A,Rt as B,zt as C,cs as D,is as E,Cr as F,Qt as G,ug as H,_e as I,At as J,va as K,Ra as L,Wn as M,hl as N,Ds as O,Te as P,Ji as Q,Mn as R,et as S,fp as T,up as U,wt as V,Cu as W,ku as X,Jt as Y,br as Z,Ct as _,f as a,dh as a0,vo as a1,lp as a2,cp as a3,ep as a4,ip as a5,Fe as a6,er as a7,dp as a8,L as b,b as c,he as d,Hn as e,k as f,n as g,ut as h,g as i,W as j,tt as k,at as l,ke as m,M as n,Pe as o,Ce as p,vt as q,mt as r,I as s,De as t,Ot as u,$t as v,ft as w,Ke as x,be as y,Ve as z};
