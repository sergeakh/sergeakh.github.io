import{p as A,a as I,G as T,o as U,s as S,H as v,u as $,g as f,f as h,i as y,c as u,b as o,d as j,m as g,M as J,J as L,K as M,z as O,e as _,h as d,L as z,k as F,B as G,t as H}from"./index-BaTAiCAr.js";import{g as N}from"./api-7nXQQ8YG.js";var e=(r=>(r[r.Signin=0]="Signin",r[r.SigninError=1]="SigninError",r))(e||{}),W=h('<p class="message svelte-9hh95f">signin</p> <!>',1),q=h('<p class="message svelte-9hh95f">error signin</p> <div class="buttonContainer svelte-9hh95f"><div class="buttonContainerItem svelte-9hh95f"><!></div></div>',1),P=h('<div class="content svelte-9hh95f"><!></div>');function X(r,b){A(b,!0);let n=I(T(e.Signin));const p=async()=>{g(n,e.Signin,!0);try{const a=await N(),{credentialData:t,clientKey:i}=await J({challenge:a}),l=await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(l.status!==200){g(n,e.SigninError,!0);return}const s=await l.json();if(!s.success||!s.serverKey){g(n,e.SigninError,!0);return}const c=s.serverKey;await L({clientKey:i,serverKey:new Uint8Array(M(c))}),S(!1),O()}catch{g(n,e.SigninError,!0)}};U(()=>(S(!0),v(!1),p(),()=>{v(!1)})),$(()=>{v(f(n)!==e.Signin)});var m=P(),k=u(m);{var w=a=>{var t=W(),i=_(d(t),2);z(i,{}),o(a,t)},B=a=>{var t=F(),i=d(t);{var l=s=>{var c=q(),C=_(d(c),2),E=u(C),K=u(E);G(K,{onClick:()=>p(),fullWidth:!0,children:(D,Q)=>{var x=H("try again");o(D,x)},$$slots:{default:!0}}),o(s,c)};y(i,s=>{f(n)===e.SigninError&&s(l)},!0)}o(a,t)};y(k,a=>{f(n)===e.Signin?a(w):a(B,!1)})}o(r,m),j()}export{X as default};
