import{a2 as se,p as re,a3 as oe,u as ne,g as G,h as d,d as z,o as le,f as k,j,c as y,b as o,k as ie,s as b,m as D,l as q,B as A,v as M,a4 as J,i as v,t as ce,X as de,Y as ve,H as O,L as pe,n as fe,a5 as R,G as ue}from"./index-CjUy5aUj.js";const N=(x,u,t,a=new Set,s={})=>{for(const p of x.children)if(p.tagName==="DT"){const F=p.querySelector(":scope > A"),S=p.querySelector(":scope > H3");if(F){const g=F.getAttribute("href"),w=F.textContent||"unknown";if(!g)return t;const m=u.find(_=>_.toLowerCase()==="bookmarks bar")?u.filter(_=>_.toLowerCase()!=="bookmarks bar"):["other"];if(s[g])s[g].tags=[...new Set([...s[g].tags,...m])];else{const _={id:se(),url:g,name:w,text:"",tags:m.length>0?m:[],updatedAt:Date.now(),createdAt:Date.now()};s[_.url]=_,t.push(_)}}else if(S){const g=S.textContent?.trim();if(g&&S.nextElementSibling?.tagName==="DL"){const w=[...u];w.push(g);const m=S.nextElementSibling;a.has(m)||(a.add(m),N(m,w,t,a,s))}}}else p.tagName!=="DL"&&p.children.length>0&&(a.has(p)||(a.add(p),N(p,[...u],t,a,s)));return t},ge=async x=>{const u=await x.text(),s=new DOMParser().parseFromString(u,"text/html").querySelector("DL");return s?N(s,[],[]):[]},U=async(x,u)=>{const t=x.target;!t.files||t.files.length===0||await u(t.files[0])};var me=k('<div class="mobileContainer svelte-1n1lt8i"><!></div> <input type="file" accept=".json, .html" style="display: none;"/>',1),_e=k('<div class="desktopContainer svelte-1n1lt8i"><div class="desktopButtonContainer svelte-1n1lt8i"><!></div> <div role="button" tabindex="-1"><div tabindex="-1" class="dropzone-content svelte-1n1lt8i"><p class="svelte-1n1lt8i">Drag and drop your file here</p> <p class="svelte-1n1lt8i">or</p></div> <input type="file" accept=".json, .html" style="display: none;"/></div></div>'),he=k('<p class="message svelte-1n1lt8i">Select a file to import your data</p> <!>',1),we=k('<p class="message svelte-1n1lt8i">Importing data...</p> <!>',1),De=k('<p class="message success svelte-1n1lt8i">Data imported successfully!</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),xe=k('<p class="message error svelte-1n1lt8i">Something went wrong</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),ye=k('<div class="content svelte-1n1lt8i"><!></div>');function Se(x,u){re(u,!0);let t=z("idle"),a=z(null),s=z(!1),p=z(null);const{checkMobileSize:F}=oe(),S=()=>{ue()};ne(()=>{G(d(t)==="loading")}),le(()=>(d(a)&&d(a).addEventListener("cancel",e=>{e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}),()=>{G(!1)}));const g=async e=>{const r=await e.text(),P=JSON.parse(r),L=[];if(!P.notes)throw new Error("Invalid import file format");for(const C of Object.values(P.notes))C&&L.push(C);await R(L)},w=async e=>{v(t,"loading");try{if(e.name.endsWith(".json"))await g(e);else if(e.name.endsWith(".html"))await R(await ge(e));else throw new Error("Unsupported file format. Please upload a JSON or HTML file.");await new Promise(r=>setTimeout(r,500)),v(t,"success")}catch{v(t,"error")}},m=()=>{d(a)?.click()},_=e=>{e.preventDefault(),e.stopPropagation(),v(s,!0)},X=e=>{e.preventDefault(),e.stopPropagation(),v(s,!1)},Y=e=>{e.preventDefault(),e.stopPropagation(),v(s,!0)},K=async e=>{if(e.preventDefault(),e.stopPropagation(),v(s,!1),!e.dataTransfer?.files||e.dataTransfer.files.length===0)return;const r=e.dataTransfer.files[0];if(r.type!=="application/json"&&r.type!=="text/html"){v(t,"error");return}await w(r)};var W=ye(),Q=y(W);{var V=e=>{var r=he(),P=b(D(r),2);{var L=n=>{var f=me(),h=D(f),$=y(h);A($,{onClick:m,children:(l,c)=>{var T=M("Select File");o(l,T)},$$slots:{default:!0}});var i=b(h,2);i.__change=[U,w],J(i,l=>v(a,l),()=>d(a)),o(n,f)},C=n=>{var f=_e(),h=y(f),$=y(h);A($,{onClick:m,children:(c,T)=>{var E=M("Select File");o(c,E)},$$slots:{default:!0}});var i=b(h,2),l=b(y(i),2);l.__change=[U,w],J(l,c=>v(a,c),()=>d(a)),J(i,c=>v(p,c),()=>d(p)),ce(()=>de(i,1,ve(["dropzone",{active:d(s)}]),"svelte-1n1lt8i")),O("dragenter",i,_),O("dragover",i,Y),O("dragleave",i,X),O("drop",i,K),o(n,f)};j(P,n=>{F()?n(L):n(C,!1)})}o(e,r)},Z=e=>{var r=q(),P=D(r);{var L=n=>{var f=we(),h=b(D(f),2);pe(h,{}),o(n,f)},C=n=>{var f=q(),h=D(f);{var $=l=>{var c=De(),T=b(D(c),2),E=y(T);A(E,{onClick:S,children:(I,B)=>{var H=M("close");o(I,H)},$$slots:{default:!0}}),o(l,c)},i=l=>{var c=q(),T=D(c);{var E=I=>{var B=xe(),H=b(D(B),2),ee=y(H);A(ee,{onClick:()=>{v(t,"idle")},children:(te,be)=>{var ae=M("Try Again");o(te,ae)},$$slots:{default:!0}}),o(I,B)};j(T,I=>{d(t)==="error"&&I(E)},!0)}o(l,c)};j(h,l=>{d(t)==="success"?l($):l(i,!1)},!0)}o(n,f)};j(P,n=>{d(t)==="loading"?n(L):n(C,!1)},!0)}o(e,r)};j(Q,e=>{d(t)==="idle"?e(V):e(Z,!1)})}o(x,W),ie()}fe(["change"]);export{Se as default};
