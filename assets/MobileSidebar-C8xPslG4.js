import{p as J,W as te,o as Q,k as Z,ag as ne,u as R,ah as oe,ai as L,h as e,d as W,x as X,f as ie,m as B,j as Y,c as j,a4 as z,i as U,s as G,t as ae,X as se,Y as re,aj as q,b as K,ak as le,al as ce,l as de,am as ue,an as me}from"./index-BD4lsSGV.js";function fe(V,t){J(t,!0);let a=te(t,"dialog",7);const s=3,y=50,l=5,p=.6,S=.3,O=.35,x=.95;let w=0,T=0,b=0,M=!1,h=!1,u=0,m=0,E=0;const _=()=>{w=0,T=0,M=!1,h=!1,u=0,m=0,E=0,b=0,c!==null&&(cancelAnimationFrame(c),c=null),v=null};let c=null,v=null;const C=o=>{a()&&(t.sidebarState!=="opened"&&t.sidebarState!=="closed"||(w=o.touches[0].clientX,T=o.touches[0].clientY,b=performance.now(),M=!0,h=!1))},A=o=>t.sidebarState==="closed"&&o>0||t.sidebarState==="closeSwiping"&&o>0||t.sidebarState==="opened"&&o<0||t.sidebarState==="openSwiping"&&o<0,n=()=>{if(a()){if(a().style.setProperty("--transition-timing","0s"),!a().open&&t.sidebarState==="closed")try{a().showModal(),a().offsetWidth}catch{return}t.onSwipe();try{const o=window.getComputedStyle(a()),i=o.transform||o.webkitTransform||"";if(m=a().offsetWidth,t.sidebarState==="closeSwiping"||t.sidebarState==="closed"?u=-m:(t.sidebarState==="openSwiping"||t.sidebarState==="opened")&&(u=0),i&&i!=="none")try{u=new DOMMatrix(i).m41}catch{}h=!0}catch{_()}}},f=()=>{if(!a())return;const o=-(m*.27),i=-m;let r=0;const d=window.getComputedStyle(a()),k=d.transform||d.webkitTransform||"";if(k&&k!=="none")try{r=new DOMMatrix(k).m41}catch{r=0}const H=.25*Math.min(1,Math.max(0,(r-i)/(o-i)));a().style.setProperty("--backdrop-bg",`rgba(0, 0, 0, ${H})`)},N=()=>{if(c=null,!v||!M||!a()||ne())return;const{x:o,y:i}=v;v=null;const r=o-w,d=i-T,k=Math.abs(r)>Math.abs(d),D=Math.abs(r)>s;if(!h)if(k&&D&&A(r))try{n()}catch{_();return}else return;if(!A(r))return;a().style.setProperty("--transition-timing","0s");let g=u+r*x;const H=-m,P=-(m*.27);g=Math.max(H,Math.min(P,g)),a().style.transform=`translate3d(${g}px, 0, 0)`,E=(g-u)/m*100,f()},F=o=>{if(!M)return;const i=o.touches[0].clientX,r=o.touches[0].clientY;v={x:i,y:r},c===null&&(c=requestAnimationFrame(N)),h&&Math.abs(i-w)>Math.abs(r-T)&&o.preventDefault()},$=o=>{const i=Math.abs(o);if(i>=p)return l;if(i>=S){const r=(i-S)/(p-S);return y-r*(y-l)}else return y},ee=(o,i)=>{if(Math.abs(o)>=p)return O*.5;const d=Math.abs(E)/100;return i?O*Math.max(.5,1-d):O*Math.max(.5,d)},I=o=>{if(c!==null&&(cancelAnimationFrame(c),c=null),v=null,!M||!a()){_();return}if(!h){_();return}let i=0;if(o?.changedTouches?.[0]){const g=o.changedTouches[0].clientX,P=performance.now()-b;P>0&&(i=(g-w)/P)}const r=$(i);let d=null;t.sidebarState==="closeSwiping"?d=Math.abs(E)>r||i>S?"open":"close":t.sidebarState==="openSwiping"&&(d=Math.abs(E)>r||i<-S?"close":"open");const k=t.sidebarState==="closeSwiping"&&d==="open"||t.sidebarState==="openSwiping"&&d==="close",D=ee(i,k);a().style.setProperty("--transition-timing",`${D}s`),a().offsetWidth,a().style.transform="",d==="open"?t.onOpen():d==="close"&&t.onClose(),a()?.style.removeProperty("--backdrop-bg"),_()};Q(()=>(document.addEventListener("touchstart",C,{passive:!0}),document.addEventListener("touchmove",F,{passive:!1}),document.addEventListener("touchend",I,{passive:!0}),document.addEventListener("touchcancel",I,{passive:!0}),()=>{document.removeEventListener("touchstart",C),document.removeEventListener("touchmove",F),document.removeEventListener("touchend",I),document.removeEventListener("touchcancel",I),c!==null&&cancelAnimationFrame(c)})),Z()}var he=ie('<dialog><div class="dialogInner svelte-jwdaua"><!></div></dialog> <!> <!>',1);function Se(V,t){J(t,!0);let a=350,s=W(null),y=W(null),l=X(le);R(()=>{oe().length>0&&L({type:"close"})});const p=()=>{t.blocked||L({type:"close"})},S=()=>{t.blocked||L({type:"open"})},O=()=>{L({type:"opened"})},x=()=>{L({type:"closed"})},w=()=>{L({type:"swipe"})},T=n=>{n.preventDefault(),p()};Q(()=>(e(s)?.addEventListener("close",x),e(s)?.addEventListener("cancel",T),()=>{e(s)?.removeEventListener("close",x),e(s)?.removeEventListener("cancel",T)}));const b=()=>{e(s)?.style.removeProperty("--transition-timing"),e(s)?.style.removeProperty("transform"),e(s)?.style.removeProperty("--backdrop-bg")},M=X(ce);R(()=>{if(e(l),!!e(s))switch(e(l).type){case"closeSwiping":{const n=setTimeout(()=>{p()},3e3);return()=>{clearTimeout(n)}}case"openSwiping":{const n=setTimeout(()=>{S()},3e3);return()=>{clearTimeout(n)}}case"opening":{e(s).open||e(s).showModal(),e(s).getBoundingClientRect();const n=setTimeout(()=>{b()},a+1),f=()=>{clearTimeout(n),b()};return e(s)?.addEventListener("transitionend",f,{once:!0}),O(),()=>{e(s)?.removeEventListener("transitionend",f)}}case"closing":{const n=setTimeout(()=>{e(l).type==="closing"&&x()},a+1),f=()=>{clearTimeout(n),x()};return e(s)?.addEventListener("transitionend",f,{once:!0}),()=>{e(s)?.removeEventListener("transitionend",f)}}case"closed":e(s)?.close(),b();break;case"opened":b();break}});var h=he(),u=B(h),m=j(u),E=j(m);{var _=n=>{var f=de(),N=B(f);ue(N,()=>t.children),K(n,f)};Y(E,n=>{e(l).type!=="closed"&&n(_)})}z(m,n=>U(y,n),()=>e(y)),z(u,n=>U(s,n),()=>e(s));var c=G(u,2);{var v=n=>{me(n,{get dialog(){return e(s)},get dialogInner(){return e(y)},onClose:p})};Y(c,n=>{e(l).type==="opened"&&!t.blocked&&n(v)})}var C=G(c,2);{var A=n=>{fe(n,{onClose:p,onOpen:S,onSwipe:w,get sidebarState(){return e(l).type},get dialog(){return e(s)}})};Y(C,n=>{(!e(M)&&e(l).type==="closed"||e(l).type==="opened"||e(l).type==="openSwiping"||e(l).type==="closeSwiping")&&!t.blocked&&n(A)})}ae(()=>se(u,1,re([{open:e(l).type==="opened",hidden:t.blocked,isAnimationOn:q.working&&(!q.isSwiping||!t.blocked)}]),"svelte-jwdaua")),K(V,h),Z()}export{Se as default};
