import{p as P,W as x,u as G,h as e,d as _,i as o,f as N,m as M,q as Q,a7 as F,c as k,s as m,j,x as H,b as h,k as O,l as Y,H as Z,a8 as V,a1 as ae,n as z,e as W,o as re,a4 as ne,a9 as X,B as le,v as se,t as ie,r as oe}from"./index-D6MZjhxQ.js";import{I as $}from"./Input-Bz6wPVyt.js";var ue=(p,n,s)=>{n(!1),o(s,"")},ce=N('<form class="formNewTag svelte-1v2ug4c"><!> <button type="button" class="buttonDone svelte-1v2ug4c">Done</button></form>'),ve=N('<div class="tags svelte-1v2ug4c"><!> <!> <!> <!></div> <!>',1);function de(p,n){P(n,!0);let s=_(null),r=_(""),u=x(n,"selectedTags",15),d=x(n,"shownTagInput",15);const U=t=>{u().includes(t)||(o(r,""),u([...u(),t]),e(s)?.focus())},E=t=>{const i=u().filter(g=>g!==t);i.length===0?u([]):u(i)};let D=H(()=>V()?[...(ae()()||[]).reduce((t,i)=>(i?.tags.forEach(g=>{t.has(g)||t.add(g)}),t),new Set)]:[]),I=H(()=>V()?e(D).filter(t=>!u().some(i=>t===i)&&t!=="inbox"):[]),T=H(()=>e(I).find(t=>t.toLowerCase()===e(r).toLowerCase())||u().includes(e(r))),l=H(()=>e(I).filter(t=>e(r)===""?!0:t.toLowerCase().indexOf(e(r).toLowerCase())===0).slice(0,e(T)||e(r)===""?3:2));const c=t=>{t.preventDefault(),e(r)!==""&&(U(e(r)),o(r,""))};G(()=>{e(s)&&d()&&e(s).focus(),d()||o(r,"")});var f=ve(),y=M(f),w=k(y);Q(w,16,u,t=>t,(t,i)=>{F(t,{get title(){return i},onClick:()=>E(i),type:"button",style:"selected"})});var v=m(w,2);{var b=t=>{var i=Y(),g=M(i);Q(g,16,()=>e(l),L=>L,(L,a)=>{F(L,{get title(){return a},onClick:()=>U(a)})}),h(t,i)};j(v,t=>{e(r)!==""&&t(b)})}var C=m(v,2);{var q=t=>{F(t,{get title(){return e(r)},onClick:()=>{U(e(r)),o(r,"")}})};j(C,t=>{!e(T)&&e(r)!==""&&t(q)})}var R=m(C,2);{var S=t=>{F(t,{title:"add tag",onClick:()=>d(!0)})};j(R,t=>{d()||t(S)})}var A=m(y,2);{var B=t=>{var i=ce(),g=k(i);$(g,{placeholder:"tag",get ref(){return e(s)},set ref(a){o(s,a,!0)},get value(){return e(r)},set value(a){o(r,a,!0)}});var L=m(g,2);L.__click=[ue,d,r],Z("submit",i,c),h(t,i)};j(A,t=>{d()&&t(B)})}h(p,f),O()}z(["click"]);var fe=(p,n,s,r)=>{if(n()&&e(s)){n("");return}r(!1)},ge=N('<div class="wrapper svelte-1gjqck4"><!> <div class="containerButtons svelte-1gjqck4"><button class="svelte-1gjqck4">Done</button></div></div>'),_e=(p,n)=>{n(!0)},me=(p,n)=>{n("")},he=N('<button class="button svelte-1gjqck4">Edit url</button> <button class="button svelte-1gjqck4">Delete url</button>',1),pe=(p,n)=>{n(!0)},be=N('<button class="button svelte-1gjqck4">Add url</button>'),ke=N('<div class="wrapperButtons svelte-1gjqck4"><!></div>');function Te(p,n){P(n,!0);let s=x(n,"url",15),r=x(n,"shownUrlInput",15),u=_(""),d=_(null);const U=l=>{o(u,""),s(l.target.value||"");try{new URL(s())}catch{o(u,"Invalid URL")}};G(()=>{r()&&setTimeout(()=>{e(d)?.focus()},0)});var E=Y(),D=M(E);{var I=l=>{var c=ge(),f=k(c);$(f,{get value(){return s()},get error(){return e(u)},onInput:U,placeholder:"url",get ref(){return e(d)},set ref(v){o(d,v,!0)}});var y=m(f,2),w=k(y);w.__click=[fe,s,u,r],h(l,c)},T=l=>{var c=ke(),f=k(c);{var y=v=>{var b=he(),C=M(b);C.__click=[_e,r];var q=m(C,2);q.__click=[me,s],h(v,b)},w=v=>{var b=be();b.__click=[pe,r],h(v,b)};j(f,v=>{s()?v(y):v(w,!1)})}h(l,c)};j(D,l=>{r()?l(I):l(T,!1)})}h(p,E),O()}z(["click"]);var we=N('<div class="submitWrapper svelte-1o5vg02"><!></div>'),xe=N('<div class="form svelte-1o5vg02"><div class="formFields"><!> <form><input class="inputName svelte-1o5vg02" placeholder="Name"/></form> <textarea placeholder="Note" class="svelte-1o5vg02"></textarea></div> <div class="formTagsWrapper svelte-1o5vg02"><!></div> <!></div>');function Ce(p,n){P(n,!0);let s=x(n,"initialTitle",3,""),r=x(n,"initialUrl",3,""),u=x(n,"initialDescription",3,""),d=x(n,"initialTags",19,()=>[]),U=x(n,"mode",3,"add"),E=_(W(s())),D=_(W(r())),I=_(W(u())),T=_(W(d().filter(a=>a!=="inbox"))),l=_(null),c=_(!1),f=_(!1);const y=a=>{a.preventDefault(),n.onSubmit({title:e(E).trim().slice(0,256)||"unkwown",url:e(D).trim().slice(0,2048),description:e(I).trim().slice(0,2048),tags:e(T).length>0?e(T):["inbox"]})},w=()=>{e(l)&&(e(l).style.height="auto",e(l).style.height=e(l).scrollHeight+"px")};G(()=>{e(l),w()});const v=a=>{a.preventDefault(),e(l)&&e(l).focus()},b=a=>{a.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(c)&&o(c,!1),document.activeElement.blur(),a.preventDefault(),a.stopPropagation())};re(()=>(document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)));var C=xe(),q=k(C),R=k(q);Te(R,{get shownUrlInput(){return e(f)},set shownUrlInput(a){o(f,a,!0)},get url(){return e(D)},set url(a){o(D,a,!0)}});var S=m(R,2),A=k(S),B=m(S,2);B.__input=w,ne(B,a=>o(l,a),()=>e(l));var t=m(q,2),i=k(t);de(i,{get shownTagInput(){return e(c)},set shownTagInput(a){o(c,a,!0)},get selectedTags(){return e(T)},set selectedTags(a){o(T,a,!0)}});var g=m(t,2);{var L=a=>{var J=we(),ee=k(J);le(ee,{fullWidth:!0,onClick:y,typeButton:"submit",children:(te,Ee)=>{var K=se();ie(()=>oe(K,U()==="add"?"add":"edit")),h(te,K)},$$slots:{default:!0}}),h(a,J)};j(g,a=>{!e(c)&&!e(f)&&a(L)})}Z("submit",S,v),X(A,()=>e(E),a=>o(E,a)),X(B,()=>e(I),a=>o(I,a)),h(p,C),O()}z(["input"]);export{Ce as N};
