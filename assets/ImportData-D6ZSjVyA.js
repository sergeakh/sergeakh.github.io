import{a1 as ae,p as re,u as se,b as U,g as v,s as A,o as oe,f as x,i as j,d as k,e as s,h as ne,m as b,k as w,a2 as le,j as q,B as O,v as z,a3 as J,c as p,t as ie,U as ce,W as de,H as B,L as ve,l as pe,a4 as G,G as fe}from"./index-HG9Zaxut.js";const N=(D,g,t,a=new Set,r={})=>{for(const f of D.children)if(f.tagName==="DT"){const F=f.querySelector(":scope > A"),S=f.querySelector(":scope > H3");if(F){const i=F.getAttribute("href"),y=F.textContent||"unknown";if(!i)return t;const m=g.find(_=>_.toLowerCase()==="bookmarks bar")?g.filter(_=>_.toLowerCase()!=="bookmarks bar"):["other"];if(r[i])r[i].tags=[...new Set([...r[i].tags,...m])];else{const _={id:ae(),url:i,title:y,description:"",tags:m.length>0?m:[],updatedAt:Date.now(),createdAt:Date.now()};r[_.url]=_,t.push(_)}}else if(S){const i=S.textContent?.trim();if(i&&S.nextElementSibling?.tagName==="DL"){const y=[...g];y.push(i);const m=S.nextElementSibling;a.has(m)||(a.add(m),N(m,y,t,a,r))}}}else f.tagName!=="DL"&&f.children.length>0&&(a.has(f)||(a.add(f),N(f,[...g],t,a,r)));return t},ue=async D=>{const g=await D.text(),r=new DOMParser().parseFromString(g,"text/html").querySelector("DL");return r?N(r,[],[]):[]},R=async(D,g)=>{const t=D.target;!t.files||t.files.length===0||await g(t.files[0])};var ge=x('<div class="mobileContainer svelte-1n1lt8i"><!></div> <input type="file" accept=".json, .html" style="display: none;"/>',1),me=x('<div class="desktopContainer svelte-1n1lt8i"><div class="desktopButtonContainer svelte-1n1lt8i"><!></div> <div role="button" tabindex="-1"><div tabindex="-1" class="dropzone-content svelte-1n1lt8i"><p class="svelte-1n1lt8i">Drag and drop your file here</p> <p class="svelte-1n1lt8i">or</p></div> <input type="file" accept=".json, .html" style="display: none;"/></div></div>'),_e=x('<p class="message svelte-1n1lt8i">Select a file to import your data</p> <!>',1),he=x('<p class="message svelte-1n1lt8i">Importing data...</p> <!>',1),we=x('<p class="message success svelte-1n1lt8i">Data imported successfully!</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),De=x('<p class="message error svelte-1n1lt8i">Something went wrong</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),ye=x('<div class="content svelte-1n1lt8i"><!></div>');function xe(D,g){re(g,!0);let t=A("idle"),a=A(null),r=A(!1),f=A(null);const F=()=>{fe()};se(()=>{U(v(t)==="loading")}),oe(()=>(v(a)&&v(a).addEventListener("cancel",e=>{e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}),()=>{U(!1)}));const S=async e=>{const o=await e.text(),P=JSON.parse(o),L=[];if(!P.notes)throw new Error("Invalid import file format");for(const C of Object.values(P.notes))C&&L.push(C);await G(L)},i=async e=>{p(t,"loading");try{if(e.name.endsWith(".json"))await S(e);else if(e.name.endsWith(".html"))await G(await ue(e));else throw new Error("Unsupported file format. Please upload a JSON or HTML file.");p(t,"success")}catch(o){console.error("Error processing file:",o),p(t,"error")}},y=()=>{v(a)?.click()},m=e=>{e.preventDefault(),e.stopPropagation(),p(r,!0)},_=e=>{e.preventDefault(),e.stopPropagation(),p(r,!1)},K=e=>{e.preventDefault(),e.stopPropagation(),p(r,!0)},Q=async e=>{if(e.preventDefault(),e.stopPropagation(),p(r,!1),!e.dataTransfer?.files||e.dataTransfer.files.length===0)return;const o=e.dataTransfer.files[0];if(o.type!=="application/json"&&o.type!=="text/html"){p(t,"error");return}await i(o)};var W=ye(),V=k(W);{var X=e=>{var o=_e(),P=b(w(o),2);{var L=n=>{var u=ge(),h=w(u),$=k(h);O($,{onClick:y,children:(l,d)=>{var T=z("Select File");s(l,T)},$$slots:{default:!0}});var c=b(h,2);c.__change=[R,i],J(c,l=>p(a,l),()=>v(a)),s(n,u)},C=n=>{var u=me(),h=k(u),$=k(h);O($,{onClick:y,children:(d,T)=>{var E=z("Select File");s(d,E)},$$slots:{default:!0}});var c=b(h,2),l=b(k(c),2);l.__change=[R,i],J(l,d=>p(a,d),()=>v(a)),J(c,d=>p(f,d),()=>v(f)),ie(()=>ce(c,1,de(["dropzone",{active:v(r)}]),"svelte-1n1lt8i")),B("dragenter",c,m),B("dragover",c,K),B("dragleave",c,_),B("drop",c,Q),s(n,u)};j(P,n=>{le()?n(L):n(C,!1)})}s(e,o)},Y=e=>{var o=q(),P=w(o);{var L=n=>{var u=he(),h=b(w(u),2);ve(h,{}),s(n,u)},C=n=>{var u=q(),h=w(u);{var $=l=>{var d=we(),T=b(w(d),2),E=k(T);O(E,{onClick:F,children:(I,H)=>{var M=z("close");s(I,M)},$$slots:{default:!0}}),s(l,d)},c=l=>{var d=q(),T=w(d);{var E=I=>{var H=De(),M=b(w(H),2),Z=k(M);O(Z,{onClick:()=>{p(t,"idle")},children:(ee,ke)=>{var te=z("Try Again");s(ee,te)},$$slots:{default:!0}}),s(I,H)};j(T,I=>{v(t)==="error"&&I(E)},!0)}s(l,d)};j(h,l=>{v(t)==="success"?l($):l(c,!1)},!0)}s(n,u)};j(P,n=>{v(t)==="loading"?n(L):n(C,!1)},!0)}s(e,o)};j(V,e=>{v(t)==="idle"?e(X):e(Y,!1)})}s(D,W),ne()}pe(["change"]);export{xe as default};
