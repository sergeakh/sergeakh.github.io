import{p as ce,Z as S,b,E as O,f as T,j as V,n as d,a as e,h as n,i as m,d as _,e as he,c as v,Q as U,q as se,O as le,w as oe,_ as be,$ as ne,A as xe,r as ve,v as de,K as W,a0 as x,l as ue,a1 as ke,a2 as pe,Y as Ce}from"./index-B7-fUZq5.js";import{I as j}from"./Input-BEZ7E6dz.js";import{S as Se}from"./Switcher-CxF7l-6U.js";var Te=T("<div></div>"),we=T('<form class="svelte-11hxhk8"><!> <!> <!> <div class="boxtags"><div class="sidebarFixed"><!></div> <div class="tags svelte-11hxhk8"><!> <!></div> <div class="searchWrapper svelte-11hxhk8"><!></div></div> <button class="buttonSubmit svelte-11hxhk8" type="submit"> </button></form>'),ye=T("<div></div>"),Ne=T('<form class="svelte-11hxhk8"><textarea class="note svelte-11hxhk8" placeholder="note"></textarea> <div class="boxtags"><div class="sidebarFixed"><!></div> <div class="tags svelte-11hxhk8"><!> <!></div> <div class="searchWrapper svelte-11hxhk8"><!></div></div> <button class="buttonSubmit svelte-11hxhk8" type="submit"> </button></form>'),Le=T("<!> <!>",1);function De(q,c){ce(c,!0);let G=S(c,"initialTitle",3,""),I=S(c,"initialUrl",3,""),K=S(c,"initialDescription",3,""),Q=S(c,"initialTags",19,()=>[]),w=S(c,"mode",3,"add"),r=b(""),k=b("note"),R=b(O(G())),Y=b(O(I())),Z=b(O(K())),s=b(O(Q().filter(t=>t!=="inbox")));const y=t=>{e(s).includes(t)||d(s,[...e(s),t],!0)},X=t=>{const l=e(s).filter(u=>u!==t);l.length===0?d(s,[],!0):d(s,l,!0)};let fe=U(()=>ne()?[...(xe()()||[]).reduce((t,l)=>(l?.tags.forEach(u=>{t.has(u)||t.add(u)}),t),new Set)]:[]),$=U(()=>ne()?e(fe).filter(t=>!e(s).some(l=>t===l)&&t!=="inbox"):[]),z=U(()=>e($).find(t=>t.toLowerCase()===e(r).toLowerCase())||e(s).includes(e(r))),ee=U(()=>e($).filter(t=>e(r)===""?!0:t.toLowerCase().indexOf(e(r).toLowerCase())!==-1).slice(0,e(z)||e(r)===""?3:2));const te=t=>{t.preventDefault(),c.onSubmit({title:e(R).trim().slice(0,256)||"unkwown",url:e(Y).trim().slice(0,2048),description:e(Z).trim().slice(0,2048),tags:e(s).length>0?e(s):["inbox"]})};var ae=Le(),re=V(ae);Se(re,{items:[{title:"note",value:"note"},{title:"bookmark",value:"bookmark"}],get value(){return e(k)},onChange:t=>{d(k,t,!0)}});var me=n(re,2);{var _e=t=>{var l=we(),u=v(l);j(u,{placeholder:"url",get value(){return e(Y)},set value(a){d(Y,a,!0)}});var p=n(u,2);j(p,{placeholder:"title",get value(){return e(R)},set value(a){d(R,a,!0)}});var C=n(p,2);m(C,a=>{});var N=n(C,2),L=v(N),D=v(L);{var E=a=>{var o=Te();ve(o,1,de(["tags","selectedTags"]),"svelte-11hxhk8"),W(o,20,()=>e(s),f=>f,(f,g)=>{x(f,{get title(){return g},onClick:()=>X(g),type:"button",style:"selected"})}),_(a,o)};m(D,a=>{e(s).length>0&&a(E)})}var F=n(L,2),A=v(F);{var B=a=>{var o=ue(),f=V(o);W(f,16,()=>e(ee),g=>g,(g,ie)=>{x(g,{get title(){return ie},onClick:()=>y(ie)})}),_(a,o)};m(A,a=>{e(r)!==""&&a(B)})}var H=n(A,2);{var J=a=>{x(a,{get title(){return e(r)},onClick:()=>{y(e(r)),d(r,"")}})};m(H,a=>{!e(z)&&e(r)!==""&&a(J)})}var M=n(F,2),P=v(M);j(P,{placeholder:"search tag",get value(){return e(r)},set value(a){d(r,a,!0)}});var i=n(N,2),h=v(i);se(()=>le(h,w()==="add"?"add":"edit")),oe("submit",l,te),_(t,l)},ge=t=>{var l=Ne(),u=v(l),p=n(u,2),C=v(p),N=v(C);{var L=i=>{var h=ye();ve(h,1,de(["tags","selectedTags"]),"svelte-11hxhk8"),W(h,20,()=>e(s),a=>a,(a,o)=>{x(a,{get title(){return o},onClick:()=>X(o),type:"button",style:"selected"})}),_(i,h)};m(N,i=>{e(s).length>0&&i(L)})}var D=n(C,2),E=v(D);{var F=i=>{var h=ue(),a=V(h);W(a,16,()=>e(ee),o=>o,(o,f)=>{x(o,{get title(){return f},onClick:()=>y(f)})}),_(i,h)};m(E,i=>{e(r)!==""&&i(F)})}var A=n(E,2);{var B=i=>{x(i,{get title(){return e(r)},onClick:()=>{y(e(r)),d(r,"")}})};m(A,i=>{!e(z)&&e(r)!==""&&i(B)})}var H=n(D,2),J=v(H);j(J,{placeholder:"search tag",get value(){return e(r)},set value(i){d(r,i,!0)}});var M=n(p,2),P=v(M);se(()=>le(P,w()==="add"?"add":"edit")),oe("submit",l,te),be(u,()=>e(Z),i=>d(Z,i)),_(t,l)};m(me,t=>{e(k)==="bookmark"?t(_e):t(ge,!1)})}_(q,ae),he()}function Oe(q,c){ce(c,!1);const G=()=>{Ce()},I=({title:K,url:Q,description:w,tags:r})=>{pe({title:K,url:Q,description:w,tags:r.map(k=>k.trim())}),G()};ke(),De(q,{onSubmit:I}),he()}export{Oe as default};
