import{p as K,W as T,u as M,h as e,d as v,f as G,m as O,q as A,a7 as q,c as g,s as f,j as E,x as R,b as W,k as P,l as Y,i as l,H as Q,a8 as B,a1 as Z,n as V,e as F,a4 as $,t as ee,r as te,a9 as J}from"./index-DcWtu7Wz.js";import{I as X}from"./Input-CX24POqe.js";var ae=(h,s,o)=>{l(s,!1),l(o,"")},re=G('<form class="formNewTag svelte-177ktq6"><!> <button type="button" class="buttonCancel svelte-177ktq6">Cancel</button></form>'),ie=G('<div class="tags svelte-177ktq6"><!> <!> <!> <!></div> <!>',1);function le(h,s){K(s,!0);let o=v(!1),d=v(null),a=v(""),n=T(s,"selectedTags",15);const k=t=>{n().includes(t)||(l(a,""),n([...n(),t]),e(d)?.focus())},x=t=>{const r=n().filter(c=>c!==t);r.length===0?n([]):n(r)};let b=R(()=>B()?[...(Z()()||[]).reduce((t,r)=>(r?.tags.forEach(c=>{t.has(c)||t.add(c)}),t),new Set)]:[]),_=R(()=>B()?e(b).filter(t=>!n().some(r=>t===r)&&t!=="inbox"):[]),m=R(()=>e(_).find(t=>t.toLowerCase()===e(a).toLowerCase())||n().includes(e(a))),C=R(()=>e(_).filter(t=>e(a)===""?!0:t.toLowerCase().indexOf(e(a).toLowerCase())===0).slice(0,e(m)||e(a)===""?3:2));const u=t=>{t.preventDefault(),e(a)!==""&&!e(m)&&(k(e(a)),l(a,""))};M(()=>{e(d)&&e(o)&&e(d).focus()});var L=ie(),w=O(L),D=g(w);A(D,16,n,t=>t,(t,r)=>{q(t,{get title(){return r},onClick:()=>x(r),type:"button",style:"selected"})});var N=f(D,2);{var I=t=>{var r=Y(),c=O(r);A(c,16,()=>e(C),i=>i,(i,p)=>{q(i,{get title(){return p},onClick:()=>k(p)})}),W(t,r)};E(N,t=>{e(a)!==""&&t(I)})}var y=f(N,2);{var S=t=>{q(t,{get title(){return e(a)},onClick:()=>{k(e(a)),l(a,"")}})};E(y,t=>{!e(m)&&e(a)!==""&&t(S)})}var H=f(y,2);{var z=t=>{q(t,{title:"add tag",onClick:()=>l(o,!0)})};E(H,t=>{e(o)||t(z)})}var U=f(w,2);{var j=t=>{var r=re(),c=g(r);X(c,{placeholder:"tag",get ref(){return e(d)},set ref(p){l(d,p,!0)},get value(){return e(a)},set value(p){l(a,p,!0)}});var i=f(c,2);i.__click=[ae,o,a],Q("submit",r,u),W(t,r)};E(U,t=>{e(o)&&t(j)})}W(h,L),P()}V(["click"]);const se=(h,s,o,d,a,n)=>{h.preventDefault(),s.onSubmit({title:e(o).trim().slice(0,256)||"unkwown",url:e(d).trim().slice(0,2048),description:e(a).trim().slice(0,2048),tags:e(n).length>0?e(n):["inbox"]})};var ne=G('<div class="form svelte-z2gvbh"><div class="formFields"><!> <form><input class="inputName svelte-z2gvbh" placeholder="Name"/></form> <textarea placeholder="Note" class="svelte-z2gvbh"></textarea></div> <div class="formTagsWrapper svelte-z2gvbh"><!></div> <div class="submitWrapper svelte-z2gvbh"><button class="buttonSubmit svelte-z2gvbh" type="submit"> </button></div></div>');function ce(h,s){K(s,!0);let o=T(s,"initialTitle",3,""),d=T(s,"initialUrl",3,""),a=T(s,"initialDescription",3,""),n=T(s,"initialTags",19,()=>[]),k=T(s,"mode",3,"add"),x=v(F(o())),b=v(F(d())),_=v(""),m=v(F(a())),C=v(F(n().filter(i=>i!=="inbox"))),u=v(null);const L=i=>{l(_,""),l(b,i.target.value||"",!0);try{new URL(e(b))}catch{l(_,"Invalid URL")}},w=()=>{e(u)&&(e(u).style.height="auto",e(u).style.height=e(u).scrollHeight+"px")};M(()=>{e(u),w()});const D=i=>{i.preventDefault(),e(u)&&e(u).focus()};var N=ne(),I=g(N),y=g(I);X(y,{get value(){return e(b)},get error(){return e(_)},onInput:L,placeholder:"url"});var S=f(y,2),H=g(S),z=f(S,2);z.__input=w,$(z,i=>l(u,i),()=>e(u));var U=f(I,2),j=g(U);le(j,{get selectedTags(){return e(C)},set selectedTags(i){l(C,i,!0)}});var t=f(U,2),r=g(t);r.__click=[se,s,x,b,m,C];var c=g(r);ee(()=>te(c,k()==="add"?"add":"edit")),Q("submit",S,D),J(H,()=>e(x),i=>l(x,i)),J(z,()=>e(m),i=>l(m,i)),W(h,N),P()}V(["input","click"]);export{ce as N};
