import{p as O,g as T,u as q,h as p,d as H,f as _,j as b,c,b as t,k as J,s as m,m as f,w as K,l as D,z as M,B as C,v as x,D as N,C as Q,P as R,i as h,af as U,t as V,r as X,F as Z}from"./index-DpPWH1K4.js";var tt=_('<p class="message svelte-uikrak">You need to connect to the cloud account to get an access to a subscription</p> <div class="buttonContainer svelte-uikrak"><!></div>',1),st=_('<div class="buttonContainer svelte-uikrak"><!></div>'),at=_('<p class="message svelte-uikrak"> </p>'),et=_('<h3 class="title svelte-uikrak">Subscription</h3> <!>',1),rt=_('<p class="message svelte-uikrak">error signin</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),it=_('<p class="message svelte-uikrak">Subscription updated successfully</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),ot=_('<div class="content svelte-uikrak"><!></div>');function lt(j,A){O(A,!0);let i=H("idle"),S=K(M);const{blockDialog:B}=T(),F=()=>{N("retPath","subscription"),Q(R.Auth)},G=()=>{Z()},w=async()=>{h(i,"loading");try{const o=await fetch("/api/getSubscription",{method:"POST"});if(o.status!==200){h(i,"error");return}const l=await o.json();if(!l.subscriptionExpires){h(i,"error");return}const g=l.subscriptionExpires;U(g),h(i,"success")}catch{h(i,"error")}};q(()=>{B(p(i)==="loading")});var E=ot(),W=c(E);{var Y=o=>{var l=et(),g=m(f(l),2);{var P=s=>{var e=tt(),v=m(f(e),2),u=c(v);C(u,{onClick:F,children:(n,a)=>{var r=x("Connect");t(n,r)},$$slots:{default:!0}}),t(s,e)},$=s=>{var e=D(),v=f(e);{var u=a=>{var r=st(),d=c(r);C(d,{onClick:w,children:(k,y)=>{var I=x("Get subscription");t(k,I)},$$slots:{default:!0}}),t(a,r)},n=a=>{var r=at(),d=c(r);V(k=>X(d,`Your subscription is active until ${k??""}`),[()=>new Date(p(S).subscriptionExpires).toLocaleDateString()]),t(a,r)};b(v,a=>{p(S).subscriptionExpires<Date.now()?a(u):a(n,!1)},!0)}t(s,e)};b(g,s=>{p(S)?s($,!1):s(P)})}t(o,l)},z=o=>{var l=D(),g=f(l);{var P=s=>{var e=rt(),v=m(f(e),2),u=c(v),n=c(u);C(n,{onClick:w,fullWidth:!0,children:(a,r)=>{var d=x("try again");t(a,d)},$$slots:{default:!0}}),t(s,e)},$=s=>{var e=D(),v=f(e);{var u=n=>{var a=it(),r=m(f(a),2),d=c(r),k=c(d);C(k,{onClick:G,fullWidth:!0,children:(y,I)=>{var L=x("Close");t(y,L)},$$slots:{default:!0}}),t(n,a)};b(v,n=>{p(i)==="success"&&n(u)},!0)}t(s,e)};b(g,s=>{p(i)==="error"?s(P):s($,!1)},!0)}t(o,l)};b(W,o=>{p(i)==="idle"?o(Y):o(z,!1)})}t(j,E),J()}export{lt as default};
