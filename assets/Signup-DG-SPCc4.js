import{p as j,d as k,e as L,o as O,h as n,x as R,g as d,aa as f,u as T,f as m,j as w,c as v,b as l,k as $,A as M,i as g,M as G,ab as H,K as I,G as J,ac as N,ad as V,O as W,ae as q,s as U,m as h,L as z,l as F,B as Q,v as X}from"./index-BZKyeLya.js";import{g as Y}from"./api-C5JaEwh0.js";var a=(r=>(r[r.Signup=0]="Signup",r[r.SignupError=1]="SignupError",r))(a||{}),Z=m('<p class="message svelte-9hh95f">signup</p> <!>',1),aa=m('<p class="message svelte-9hh95f">error signup</p> <div class="buttonContainer svelte-9hh95f"><div class="buttonContainerItem svelte-9hh95f"><!></div></div>',1),ea=m('<div class="content svelte-9hh95f"><!></div>');function na(r,A){j(A,!0);let S=R(M),y=k(""),s=k(L(a.Signup));const _=async()=>{g(s,a.Signup,!0);try{const e=await Y(),t=crypto.getRandomValues(new Uint8Array(32)),i=await G({challenge:e,clientKey:t}),u=await fetch("/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(u.status!==200){g(s,a.SignupError,!0);return}const o=await u.json(),c=n(S)===void 0;if(await H({clientKey:t,serverKey:new Uint8Array(I(o.serverKey))}),c)d(!1),J();else{d(!1);let p=new URLSearchParams(N.search).get("retPath")||"";p&&(g(y,p,!0),V("retPath")),W({to:n(y)}),q()}}catch{g(s,a.SignupError,!0)}};O(()=>(n(S)===void 0&&(d(!0),f(!1)),_(),()=>{f(!1)})),T(()=>{d(n(s)===a.Signup),f(n(s)!==a.Signup)});var b=ea(),B=v(b);{var P=e=>{var t=Z(),i=U(h(t),2);z(i,{}),l(e,t)},C=e=>{var t=F(),i=h(t);{var u=o=>{var c=aa(),p=U(h(c),2),x=v(p),E=v(x);Q(E,{onClick:()=>_(),fullWidth:!0,children:(D,ta)=>{var K=X("try again");l(D,K)},$$slots:{default:!0}}),l(o,c)};w(i,o=>{n(s)===a.SignupError&&o(u)},!0)}l(e,t)};w(B,e=>{n(s)===a.Signup?e(P):e(C,!1)})}l(r,b),$()}export{na as default};
