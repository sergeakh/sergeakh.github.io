import{p as a,s,a as e,o as t,g as i,x as n,b as r,a7 as o,u as l,f as c,i as v,d,e as h,h as f,A as g,c as p,w as m,a8 as u,K as y,G as w,a9 as b,aa as S,O as j,ab as C,m as K,k as P,L as x,j as O,B as k,v as A}from"./index-D_lOxY7D.js";import{g as B}from"./api-DvDg-7CF.js";var E=(a=>(a[a.t=0]="Signin",a[a.i=1]="SigninError",a))(E||{}),L=c('<p class="message svelte-9hh95f">signin</p> <!>',1),T=c('<p class="message svelte-9hh95f">error signin</p> <div class="buttonContainer svelte-9hh95f"><div class="buttonContainerItem svelte-9hh95f"><!></div></div>',1),U=c('<div class="content svelte-9hh95f"><!></div>');function $(c,$){a($,!0);let D=n(g),G=s(""),I=s(e(E.t));const J=async()=>{p(I,E.t,!0);try{const a=await B(),{o:s,l:e}=await m({challenge:a}),t=await fetch("/api/signin",{method:"POST",headers:{v:"application/json"},body:JSON.stringify(s)});if(200!==t.status)return void p(I,E.i,!0);const n=await t.json();if(!n.h)return void p(I,E.i,!0);const o=n.h,l=Boolean(void 0===i(D));if(await u({l:e,h:new Uint8Array(y(o))}),l)r(!1),w();else{r(!1);let a=new URLSearchParams(b.search).get("retPath")||"";a&&(p(G,a,!0),S("retPath")),j({to:i(G)}),C()}}catch(a){console.error("Error during sign-in:",a),p(I,E.i,!0)}};t(()=>(void 0===i(D)&&(r(!0),o(!1)),J(),()=>{o(!1)})),l(()=>{r(i(I)===E.t),o(i(I)!==E.t)});var N=U(),R=d(N),W=a=>{var s=L(),e=K(P(s),2);x(e,{}),h(a,s)},q=a=>{var s=O(),e=P(s),t=a=>{var s=T(),e=K(P(s),2),t=d(e),i=d(t);k(i,{p:()=>J(),m:!0,children:(a,s)=>{var e=A("try again");h(a,e)},u:{default:!0}}),h(a,s)};v(e,a=>{i(I)===E.i&&a(t)},!0),h(a,s)};v(R,a=>{i(I)===E.t?a(W):a(q,!1)}),h(c,N),f()}export{$ as default};
