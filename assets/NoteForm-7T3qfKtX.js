import{p as K,W as T,u as M,h as e,d as v,f as O,m as z,q as A,a7 as E,c as m,s as f,j as R,x as F,b as H,k as P,l as Y,i as l,H as Q,a8 as B,a1 as Z,n as V,e as W,a4 as $,t as ee,r as te,a9 as J}from"./index-WhMV9zYE.js";import{I as X}from"./Input-BH6A_beX.js";var ae=(g,s,o)=>{l(s,!1),l(o,"")},re=O('<form class="formNewTag svelte-1nd24os"><!> <button type="button" class="buttonCancel svelte-1nd24os">Cancel</button></form>'),ie=O('<div class="tags svelte-1nd24os"><!> <!> <!> <!></div> <!>',1);function le(g,s){K(s,!0);let o=v(!1),c=v(null),a=v(""),n=T(s,"selectedTags",15);const k=t=>{n().includes(t)||(l(a,""),n([...n(),t]),e(c)?.focus())},x=t=>{const r=n().filter(u=>u!==t);r.length===0?n([]):n(r)};let h=F(()=>B()?[...(Z()()||[]).reduce((t,r)=>(r?.tags.forEach(u=>{t.has(u)||t.add(u)}),t),new Set)]:[]),_=F(()=>B()?e(h).filter(t=>!n().some(r=>t===r)&&t!=="inbox"):[]),p=F(()=>e(_).find(t=>t.toLowerCase()===e(a).toLowerCase())||n().includes(e(a))),C=F(()=>e(_).filter(t=>e(a)===""?!0:t.toLowerCase().indexOf(e(a).toLowerCase())===0).slice(0,e(p)||e(a)===""?3:2));const d=t=>{t.preventDefault(),e(a)!==""&&(k(e(a)),l(a,""))};M(()=>{e(c)&&e(o)&&e(c).focus()});var L=ie(),w=z(L),D=m(w);A(D,16,n,t=>t,(t,r)=>{E(t,{get title(){return r},onClick:()=>x(r),type:"button",style:"selected"})});var N=f(D,2);{var I=t=>{var r=Y(),u=z(r);A(u,16,()=>e(C),i=>i,(i,b)=>{E(i,{get title(){return b},onClick:()=>k(b)})}),H(t,r)};R(N,t=>{e(a)!==""&&t(I)})}var y=f(N,2);{var S=t=>{E(t,{get title(){return e(a)},onClick:()=>{k(e(a)),l(a,"")}})};R(y,t=>{!e(p)&&e(a)!==""&&t(S)})}var q=f(y,2);{var j=t=>{E(t,{title:"add tag",onClick:()=>l(o,!0)})};R(q,t=>{e(o)||t(j)})}var U=f(w,2);{var G=t=>{var r=re(),u=m(r);X(u,{placeholder:"tag",get ref(){return e(c)},set ref(b){l(c,b,!0)},get value(){return e(a)},set value(b){l(a,b,!0)}});var i=f(u,2);i.__click=[ae,o,a],Q("submit",r,d),H(t,r)};R(U,t=>{e(o)&&t(G)})}H(g,L),P()}V(["click"]);const se=(g,s,o,c,a,n)=>{g.preventDefault(),s.onSubmit({title:e(o).trim().slice(0,256)||"unkwown",url:e(c).trim().slice(0,2048),description:e(a).trim().slice(0,2048),tags:e(n).length>0?e(n):["inbox"]})};var ne=O('<div class="form svelte-j7t5d5"><div class="formFields"><!> <form><input class="inputName svelte-j7t5d5" placeholder="Name"/></form> <textarea placeholder="Note" class="svelte-j7t5d5"></textarea></div> <div class="formTagsWrapper svelte-j7t5d5"><!></div> <div class="submitWrapper svelte-j7t5d5"><button class="buttonSubmit svelte-j7t5d5" type="submit"> </button></div></div>');function ue(g,s){K(s,!0);let o=T(s,"initialTitle",3,""),c=T(s,"initialUrl",3,""),a=T(s,"initialDescription",3,""),n=T(s,"initialTags",19,()=>[]),k=T(s,"mode",3,"add"),x=v(W(o())),h=v(W(c())),_=v(""),p=v(W(a())),C=v(W(n().filter(i=>i!=="inbox"))),d=v(null);const L=i=>{l(_,""),l(h,i.target.value||"",!0);try{new URL(e(h))}catch{l(_,"Invalid URL")}},w=()=>{e(d)&&(e(d).style.height="auto",e(d).style.height=e(d).scrollHeight+"px")};M(()=>{e(d),w()});const D=i=>{i.preventDefault(),e(d)&&e(d).focus()};var N=ne(),I=m(N),y=m(I);X(y,{get value(){return e(h)},get error(){return e(_)},onInput:L,placeholder:"url"});var S=f(y,2),q=m(S),j=f(S,2);j.__input=w,$(j,i=>l(d,i),()=>e(d));var U=f(I,2),G=m(U);le(G,{get selectedTags(){return e(C)},set selectedTags(i){l(C,i,!0)}});var t=f(U,2),r=m(t);r.__click=[se,s,x,h,p,C];var u=m(r);ee(()=>te(u,k()==="add"?"add":"edit")),Q("submit",S,D),J(q,()=>e(x),i=>l(x,i)),J(j,()=>e(p),i=>l(p,i)),H(g,N),P()}V(["input","click"]);export{ue as N};
