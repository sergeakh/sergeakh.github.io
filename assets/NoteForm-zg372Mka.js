import{p as ue,W as v,d,e as h,u as ce,h as t,f as ve,c as n,s as u,a4 as fe,i,q as z,a7 as D,j as A,x as p,t as me,r as he,H as B,a8 as J,b as K,k as pe,l as ge,m as ke,a9 as M,a1 as _e,n as be}from"./index-BU9WO4yn.js";import{I as P}from"./Input-CJKkVKSa.js";const we=(g,s,k,_,b,f)=>{g.preventDefault(),s.onSubmit({title:t(k).trim().slice(0,256)||"unkwown",url:t(_).trim().slice(0,2048),description:t(b).trim().slice(0,2048),tags:t(f).length>0?t(f):["inbox"]})};var ye=ve('<div class="form svelte-1akjkwy"><div class="formFields"><!> <form><input class="inputName svelte-1akjkwy" placeholder="Name"/></form> <textarea placeholder="Note" class="svelte-1akjkwy"></textarea></div> <div><form class="formTags svelte-1akjkwy"><div class="tags svelte-1akjkwy"><!> <!> <!></div> <div class="searchWrapper svelte-1akjkwy"><!></div></form> <div class="submitWrapper svelte-1akjkwy"><button class="buttonSubmit svelte-1akjkwy" type="submit"> </button></div></div></div>');function Ce(g,s){ue(s,!0);let k=v(s,"initialTitle",3,""),_=v(s,"initialUrl",3,""),b=v(s,"initialDescription",3,""),f=v(s,"initialTags",19,()=>[]),Q=v(s,"mode",3,"add"),a=d(""),w=d(h(k())),m=d(h(_())),y=d(""),x=d(h(b())),l=d(h(f().filter(e=>e!=="inbox"))),o=d(null);const T=e=>{t(l).includes(e)||(i(a,""),i(l,[...t(l),e],!0))},V=e=>{const r=t(l).filter(c=>c!==e);r.length===0?i(l,[],!0):i(l,r,!0)};let X=p(()=>M()?[...(_e()()||[]).reduce((e,r)=>(r?.tags.forEach(c=>{e.has(c)||e.add(c)}),e),new Set)]:[]),U=p(()=>M()?t(X).filter(e=>!t(l).some(r=>e===r)&&e!=="inbox"):[]),C=p(()=>t(U).find(e=>e.toLowerCase()===t(a).toLowerCase())||t(l).includes(t(a))),Y=p(()=>t(U).filter(e=>t(a)===""?!0:e.toLowerCase().indexOf(t(a).toLowerCase())!==-1).slice(0,t(C)||t(a)===""?3:2));const Z=e=>{i(y,""),i(m,e.target.value||"",!0);try{new URL(t(m))}catch{i(y,"Invalid URL")}},$=e=>{e.preventDefault(),t(a)!==""&&!t(C)&&(T(t(a)),i(a,""))},E=()=>{t(o)&&(t(o).style.height=t(o).scrollHeight+"px")};ce(()=>{t(o),E()});const ee=e=>{e.preventDefault(),t(o)&&t(o).focus()};var I=ye(),R=n(I),W=n(R);P(W,{get value(){return t(m)},get error(){return t(y)},onInput:Z,placeholder:"url"});var j=u(W,2),te=n(j),S=u(j,2);S.__input=E,fe(S,e=>i(o,e),()=>t(o));var ae=u(R,2),N=n(ae),F=n(N),H=n(F);z(H,16,()=>t(l),e=>e,(e,r)=>{D(e,{get title(){return r},onClick:()=>V(r),type:"button",style:"selected"})});var q=u(H,2);{var ie=e=>{var r=ge(),c=ke(r);z(c,16,()=>t(Y),L=>L,(L,O)=>{D(L,{get title(){return O},onClick:()=>T(O)})}),K(e,r)};A(q,e=>{t(a)!==""&&e(ie)})}var re=u(q,2);{var le=e=>{D(e,{get title(){return t(a)},onClick:()=>{T(t(a)),i(a,"")}})};A(re,e=>{!t(C)&&t(a)!==""&&e(le)})}var se=u(F,2),ne=n(se);P(ne,{placeholder:"tag",get value(){return t(a)},set value(e){i(a,e,!0)}});var oe=u(N,2),G=n(oe);G.__click=[we,s,w,m,x,l];var de=n(G);me(()=>he(de,Q()==="add"?"add":"edit")),B("submit",j,ee),J(te,()=>t(w),e=>i(w,e)),J(S,()=>t(x),e=>i(x,e)),B("submit",N,$),K(g,I),pe()}be(["input","click"]);export{Ce as N};
