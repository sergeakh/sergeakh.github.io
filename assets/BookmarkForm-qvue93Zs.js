import{p as ve,W as h,d as n,e as p,f as U,h as t,c as d,s as v,i as l,j as k,q as z,a7 as y,x as w,t as ue,r as ce,H as fe,b as _,k as me,l as A,m as J,a8 as K,a1 as he,a9 as _e,n as ge}from"./index-BQ1Y8JAd.js";import{I as L}from"./Input-CAtUdhi9.js";const be=(B,s)=>{l(s,!0)};var xe=U('<textarea placeholder="notes" class="svelte-1o3e5xe"></textarea>'),pe=U('<div class="wrapperNoteButton svelte-1o3e5xe"><button type="button" class="formButton svelte-1o3e5xe">add note</button></div>'),ke=U('<form class="svelte-1o3e5xe"><!> <!> <!> <div class="boxtags"><div class="sidebarFixed"><div class="tags svelte-1o3e5xe"><!> <!> <!></div></div> <div class="searchWrapper svelte-1o3e5xe"><!></div></div> <button class="buttonSubmit svelte-1o3e5xe" type="submit"> </button></form>');function Ce(B,s){ve(s,!0);let M=h(s,"initialTitle",3,""),P=h(s,"initialUrl",3,""),I=h(s,"initialDescription",3,""),Q=h(s,"initialTags",19,()=>[]),V=h(s,"mode",3,"add"),r=n(""),N=n(I()!==""),g=n(p(M())),c=n(p(P())),b=n(""),T=n(p(I())),i=n(p(Q().filter(e=>e!=="inbox")));const D=e=>{t(i).includes(e)||l(i,[...t(i),e],!0)},X=e=>{const a=t(i).filter(o=>o!==e);a.length===0?l(i,[],!0):l(i,a,!0)};let Y=w(()=>K()?[...(he()()||[]).reduce((e,a)=>(a?.tags.forEach(o=>{e.has(o)||e.add(o)}),e),new Set)]:[]),E=w(()=>K()?t(Y).filter(e=>!t(i).some(a=>e===a)&&e!=="inbox"):[]),R=w(()=>t(E).find(e=>e.toLowerCase()===t(r).toLowerCase())||t(i).includes(t(r))),Z=w(()=>t(E).filter(e=>t(r)===""?!0:e.toLowerCase().indexOf(t(r).toLowerCase())!==-1).slice(0,t(R)||t(r)===""?3:2));const $=e=>{e.preventDefault(),s.onSubmit({title:t(g).trim().slice(0,256)||"unkwown",url:t(c).trim().slice(0,2048),description:t(T).trim().slice(0,2048),tags:t(i).length>0?t(i):["inbox"]})},ee=e=>{l(b,""),l(c,e.target.value||"",!0);try{new URL(t(c))}catch{l(b,"Invalid URL")}};var C=ke(),F=d(C);L(F,{get value(){return t(c)},get error(){return t(b)},onInput:ee,placeholder:"url"});var W=v(F,2);L(W,{placeholder:"title",get value(){return t(g)},set value(e){l(g,e,!0)}});var j=v(W,2);{var te=e=>{var a=A(),o=J(a);{var f=u=>{var m=xe();_e(m,()=>t(T),S=>l(T,S)),_(u,m)},x=u=>{var m=pe(),S=d(m);S.__click=[be,N],_(u,m)};k(o,u=>{t(N)?u(f):u(x,!1)})}_(e,a)};k(j,e=>{t(c)&&t(b)===""&&t(g)&&e(te)})}var q=v(j,2),G=d(q),ae=d(G),H=d(ae);z(H,16,()=>t(i),e=>e,(e,a)=>{y(e,{get title(){return a},onClick:()=>X(a),type:"button",style:"selected"})});var O=v(H,2);{var re=e=>{var a=A(),o=J(a);z(o,16,()=>t(Z),f=>f,(f,x)=>{y(f,{get title(){return x},onClick:()=>D(x)})}),_(e,a)};k(O,e=>{t(r)!==""&&e(re)})}var ie=v(O,2);{var le=e=>{y(e,{get title(){return t(r)},onClick:()=>{D(t(r)),l(r,"")}})};k(ie,e=>{!t(R)&&t(r)!==""&&e(le)})}var se=v(G,2),oe=d(se);L(oe,{placeholder:"search tag",get value(){return t(r)},set value(e){l(r,e,!0)}});var ne=v(q,2),de=d(ne);ue(()=>ce(de,V()==="add"?"add":"edit")),fe("submit",C,$),_(B,C),me()}ge(["click"]);export{Ce as B};
