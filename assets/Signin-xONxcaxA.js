import{p as A,b as I,E as j,o as T,s as S,F as g,u as U,a as f,f as h,i as y,c as u,d as o,e as $,n as v,J as F,H as J,I as L,z as O,h as _,j as d,L as z,l as H,B as M,t as N}from"./index-D9iASQHO.js";import{g as W}from"./api-7nXQQ8YG.js";var e=(r=>(r[r.Signin=0]="Signin",r[r.SigninError=1]="SigninError",r))(e||{}),q=h('<p class="message svelte-9hh95f">signin</p> <!>',1),G=h('<p class="message svelte-9hh95f">error signin</p> <div class="buttonContainer svelte-9hh95f"><div class="buttonContainerItem svelte-9hh95f"><!></div></div>',1),P=h('<div class="content svelte-9hh95f"><!></div>');function X(r,b){A(b,!0);let n=I(j(e.Signin));const p=async()=>{v(n,e.Signin,!0);try{const a=await W(),{credentialData:t,clientKey:i}=await F({challenge:a}),l=await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(l.status!==200){v(n,e.SigninError,!0);return}const s=await l.json();if(!s.success||!s.serverKey){v(n,e.SigninError,!0);return}const c=s.serverKey;await J({clientKey:i,serverKey:new Uint8Array(L(c))}),S(!1),O()}catch{v(n,e.SigninError,!0)}};T(()=>(S(!0),g(!1),p(),()=>{g(!1)})),U(()=>{g(f(n)!==e.Signin)});var m=P(),E=u(m);{var k=a=>{var t=q(),i=_(d(t),2);z(i,{}),o(a,t)},w=a=>{var t=H(),i=d(t);{var l=s=>{var c=G(),B=_(d(c),2),C=u(B),D=u(C);M(D,{onClick:()=>p(),fullWidth:!0,children:(K,Q)=>{var x=N("try again");o(K,x)},$$slots:{default:!0}}),o(s,c)};y(i,s=>{f(n)===e.SigninError&&s(l)},!0)}o(a,t)};y(E,a=>{f(n)===e.Signin?a(k):a(w,!1)})}o(r,m),$()}export{X as default};
