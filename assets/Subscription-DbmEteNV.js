import{p as O,u as T,g as q,h as p,d as z,f as _,j as b,c,b as t,k as H,s as m,m as f,x as J,l as D,A as K,B as x,v as C,E as M,D as N,P as Q,i as h,af as R,t as U,r as V,G as X}from"./index-BL9aR03j.js";var Z=_('<p class="message svelte-uikrak">You need to connect to the cloud account to get an access to a subscription</p> <div class="buttonContainer svelte-uikrak"><!></div>',1),tt=_('<div class="buttonContainer svelte-uikrak"><!></div>'),st=_('<p class="message svelte-uikrak"> </p>'),at=_('<h3 class="title svelte-uikrak">Subscription</h3> <!>',1),et=_('<p class="message svelte-uikrak">error signin</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),rt=_('<p class="message svelte-uikrak">Subscription updated successfully</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),it=_('<div class="content svelte-uikrak"><!></div>');function nt(B,G){O(G,!0);let i=z("idle"),S=J(K);const I=()=>{M("retPath","subscription"),N(Q.Auth)},j=()=>{X()},E=async()=>{h(i,"loading");try{const o=await fetch("/api/getSubscription",{method:"POST"});if(o.status!==200){h(i,"error");return}const l=await o.json();if(!l.subscriptionExpires){h(i,"error");return}const k=l.subscriptionExpires;R(k),h(i,"success")}catch{h(i,"error")}};T(()=>{q(p(i)==="loading")});var w=it(),W=c(w);{var Y=o=>{var l=at(),k=m(f(l),2);{var P=s=>{var e=Z(),v=m(f(e),2),u=c(v);x(u,{onClick:I,children:(n,a)=>{var r=C("Connect");t(n,r)},$$slots:{default:!0}}),t(s,e)},$=s=>{var e=D(),v=f(e);{var u=a=>{var r=tt(),d=c(r);x(d,{onClick:E,children:(g,y)=>{var A=C("Get subscription");t(g,A)},$$slots:{default:!0}}),t(a,r)},n=a=>{var r=st(),d=c(r);U(g=>V(d,`Your subscription is active until ${g??""}`),[()=>new Date(p(S).subscriptionExpires).toLocaleDateString()]),t(a,r)};b(v,a=>{p(S).subscriptionExpires<Date.now()?a(u):a(n,!1)},!0)}t(s,e)};b(k,s=>{p(S)?s($,!1):s(P)})}t(o,l)},F=o=>{var l=D(),k=f(l);{var P=s=>{var e=et(),v=m(f(e),2),u=c(v),n=c(u);x(n,{onClick:E,fullWidth:!0,children:(a,r)=>{var d=C("try again");t(a,d)},$$slots:{default:!0}}),t(s,e)},$=s=>{var e=D(),v=f(e);{var u=n=>{var a=rt(),r=m(f(a),2),d=c(r),g=c(d);x(g,{onClick:j,fullWidth:!0,children:(y,A)=>{var L=C("Close");t(y,L)},$$slots:{default:!0}}),t(n,a)};b(v,n=>{p(i)==="success"&&n(u)},!0)}t(s,e)};b(k,s=>{p(i)==="error"?s(P):s($,!1)},!0)}t(o,l)};b(W,o=>{p(i)==="idle"?o(Y):o(F,!1)})}t(B,w),H()}export{nt as default};
