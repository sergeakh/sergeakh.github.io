import{p as J,S as ee,o as Q,k as Z,ag as te,ah as ne,ai as oe,u as W,aj as ie,ak as x,h as e,d as B,w as X,f as ae,m as j,j as F,c as z,a1 as U,s as G,t as se,T as re,U as le,b as q,al as ce,l as de,am as ue,an as me,i as K}from"./index-FxU32_dp.js";function fe(R,t){J(t,!0);let s=ee(t,"dialog",7);const O=3,_=50,i=5,T=.6,l=.3,S=.35,P=.95;let M=0,g=0,k=0,b=!1,u=!1,v=0,m=0,h=0;const y=()=>{M=0,g=0,b=!1,u=!1,v=0,m=0,h=0,k=0,d!==null&&(cancelAnimationFrame(d),d=null),w=null};let d=null,w=null;const C=o=>{s()&&(t.sidebarState!=="opened"&&t.sidebarState!=="closed"||(M=o.touches[0].clientX,g=o.touches[0].clientY,k=performance.now(),b=!0,u=!1))},A=o=>t.sidebarState==="closed"&&o>0||t.sidebarState==="closeSwiping"&&o>0||t.sidebarState==="opened"&&o<0||t.sidebarState==="openSwiping"&&o<0,N=()=>{if(s()){if(s().style.setProperty("--transition-timing","0s"),!s().open&&t.sidebarState==="closed")try{s().showModal(),s().offsetWidth}catch{return}t.onSwipe();try{const o=window.getComputedStyle(s()),a=o.transform||o.webkitTransform||"";if(m=s().offsetWidth,t.sidebarState==="closeSwiping"||t.sidebarState==="closed"?v=-m:(t.sidebarState==="openSwiping"||t.sidebarState==="opened")&&(v=0),a&&a!=="none")try{v=new DOMMatrix(a).m41}catch{}u=!0}catch{y()}}},V=()=>{if(!s())return;const o=-(m*.27),a=-m;let r=0;const c=window.getComputedStyle(s()),E=c.transform||c.webkitTransform||"";if(E&&E!=="none")try{r=new DOMMatrix(E).m41}catch{r=0}const H=.25*Math.min(1,Math.max(0,(r-a)/(o-a)));s().style.setProperty("--backdrop-bg",`rgba(0, 0, 0, ${H})`)},n=()=>{if(d=null,!w||!b||!s()||te())return;const{x:o,y:a}=w;w=null;const r=o-M,c=a-g,E=Math.abs(r)>Math.abs(c),D=Math.abs(r)>O;if(!u)if(E&&D&&A(r))try{N()}catch{y();return}else return;if(!A(r))return;s().style.setProperty("--transition-timing","0s");let p=v+r*P;const H=-m,L=-(m*.27);p=Math.max(H,Math.min(L,p)),s().style.transform=`translate3d(${p}px, 0, 0)`,h=(p-v)/m*100,V()},f=o=>{if(!b)return;const a=o.touches[0].clientX,r=o.touches[0].clientY;w={x:a,y:r},d===null&&(d=requestAnimationFrame(n)),u&&Math.abs(a-M)>Math.abs(r-g)&&o.preventDefault()},Y=o=>{const a=Math.abs(o);if(a>=T)return i;if(a>=l){const r=(a-l)/(T-l);return _-r*(_-i)}else return _},$=(o,a)=>{if(Math.abs(o)>=T)return S*.5;const c=Math.abs(h)/100;return a?S*Math.max(.5,1-c):S*Math.max(.5,c)},I=o=>{if(d!==null&&(cancelAnimationFrame(d),d=null),w=null,!b||!s()){y();return}if(!u){y();return}let a=0;if(o?.changedTouches?.[0]){const p=o.changedTouches[0].clientX,L=performance.now()-k;L>0&&(a=(p-M)/L)}const r=Y(a);let c=null;t.sidebarState==="closeSwiping"?c=Math.abs(h)>r||a>l?"open":"close":t.sidebarState==="openSwiping"&&(c=Math.abs(h)>r||a<-l?"close":"open");const E=t.sidebarState==="closeSwiping"&&c==="open"||t.sidebarState==="openSwiping"&&c==="close",D=$(a,E);s().style.setProperty("--transition-timing",`${D}s`),s().offsetWidth,s().style.transform="",c==="open"?t.onOpen():c==="close"&&t.onClose(),s()?.style.removeProperty("--backdrop-bg"),y()};Q(()=>(document.addEventListener("touchstart",C,{passive:!0}),document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("touchend",I,{passive:!0}),document.addEventListener("touchcancel",I,{passive:!0}),()=>{document.removeEventListener("touchstart",C),document.removeEventListener("touchmove",f),document.removeEventListener("touchend",I),document.removeEventListener("touchcancel",I),d!==null&&cancelAnimationFrame(d)})),Z()}var he=ae('<dialog><div class="dialogInner svelte-jwdaua"><!></div></dialog> <!> <!>',1);function Se(R,t){J(t,!0);let s=350;const O=ne(),{isScrolling:_}=oe();let i=B(null),T=B(null),l=X(ce);W(()=>{ie().length>0&&x({type:"close"})});const S=()=>{t.blocked||x({type:"close"})},P=()=>{t.blocked||x({type:"open"})},M=()=>{x({type:"opened"})},g=()=>{x({type:"closed"})},k=()=>{x({type:"swipe"})},b=n=>{n.preventDefault(),S()};Q(()=>(e(i)?.addEventListener("close",g),e(i)?.addEventListener("cancel",b),()=>{e(i)?.removeEventListener("close",g),e(i)?.removeEventListener("cancel",b)}));const u=()=>{e(i)?.style.removeProperty("--transition-timing"),e(i)?.style.removeProperty("transform"),e(i)?.style.removeProperty("--backdrop-bg")},v=X(_);W(()=>{if(e(l),!!e(i))switch(e(l).type){case"closeSwiping":{const n=setTimeout(()=>{S()},3e3);return()=>{clearTimeout(n)}}case"openSwiping":{const n=setTimeout(()=>{P()},3e3);return()=>{clearTimeout(n)}}case"opening":{e(i).open||e(i).showModal(),e(i).getBoundingClientRect();const n=setTimeout(()=>{u()},s+1),f=()=>{clearTimeout(n),u()};return e(i)?.addEventListener("transitionend",f,{once:!0}),M(),()=>{e(i)?.removeEventListener("transitionend",f)}}case"closing":{const n=setTimeout(()=>{e(l).type==="closing"&&g()},s+1),f=()=>{clearTimeout(n),g()};return e(i)?.addEventListener("transitionend",f,{once:!0}),()=>{e(i)?.removeEventListener("transitionend",f)}}case"closed":e(i)?.close(),u();break;case"opened":u();break}});var m=he(),h=j(m),y=z(h),d=z(y);{var w=n=>{var f=de(),Y=j(f);ue(Y,()=>t.children),q(n,f)};F(d,n=>{e(l).type!=="closed"&&n(w)})}U(y,n=>K(T,n),()=>e(T)),U(h,n=>K(i,n),()=>e(i));var C=G(h,2);{var A=n=>{me(n,{get dialog(){return e(i)},get dialogInner(){return e(T)},onClose:S})};F(C,n=>{e(l).type==="opened"&&!t.blocked&&n(A)})}var N=G(C,2);{var V=n=>{fe(n,{onClose:S,onOpen:P,onSwipe:k,get sidebarState(){return e(l).type},get dialog(){return e(i)}})};F(N,n=>{(!e(v)&&e(l).type==="closed"||e(l).type==="opened"||e(l).type==="openSwiping"||e(l).type==="closeSwiping")&&!t.blocked&&n(V)})}se(()=>re(h,1,le([{open:e(l).type==="opened",hidden:t.blocked,isAnimationOn:O.working&&(!O.isSwiping||!t.blocked)}]),"svelte-jwdaua")),q(R,m),Z()}export{Se as default};
