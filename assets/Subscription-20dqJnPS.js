import{p as T,g as q,u as z,h as p,d as H,f as _,j as b,c,b as t,k as J,s as m,m as f,x as K,l as D,A as M,B as x,v as C,E as N,D as Q,P as R,i as h,aj as U,t as V,r as X,G as Z}from"./index-Bt3jdqU-.js";var tt=_('<p class="message svelte-uikrak">You need to connect to the cloud account to get an access to a subscription</p> <div class="buttonContainer svelte-uikrak"><!></div>',1),st=_('<div class="buttonContainer svelte-uikrak"><!></div>'),at=_('<p class="message svelte-uikrak"> </p>'),et=_('<h3 class="title svelte-uikrak">Subscription</h3> <!>',1),rt=_('<p class="message svelte-uikrak">error signin</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),it=_('<p class="message svelte-uikrak">Subscription updated successfully</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),ot=_('<div class="content svelte-uikrak"><!></div>');function lt(A,G){T(G,!0);let i=H("idle"),S=K(M);const{blockDialog:I}=q(),B=()=>{N("retPath","subscription"),Q(R.Auth)},W=()=>{Z()},E=async()=>{h(i,"loading");try{const o=await fetch("/api/getSubscription",{method:"POST"});if(o.status!==200){h(i,"error");return}const l=await o.json();if(!l.subscriptionExpires){h(i,"error");return}const g=l.subscriptionExpires;U(g),h(i,"success")}catch{h(i,"error")}};z(()=>{I(p(i)==="loading")});var w=ot(),Y=c(w);{var F=o=>{var l=et(),g=m(f(l),2);{var P=s=>{var e=tt(),v=m(f(e),2),u=c(v);x(u,{onClick:B,children:(n,a)=>{var r=C("Connect");t(n,r)},$$slots:{default:!0}}),t(s,e)},$=s=>{var e=D(),v=f(e);{var u=a=>{var r=st(),d=c(r);x(d,{onClick:E,children:(k,y)=>{var j=C("Get subscription");t(k,j)},$$slots:{default:!0}}),t(a,r)},n=a=>{var r=at(),d=c(r);V(k=>X(d,`Your subscription is active until ${k??""}`),[()=>new Date(p(S).subscriptionExpires).toLocaleDateString()]),t(a,r)};b(v,a=>{p(S).subscriptionExpires<Date.now()?a(u):a(n,!1)},!0)}t(s,e)};b(g,s=>{p(S)?s($,!1):s(P)})}t(o,l)},L=o=>{var l=D(),g=f(l);{var P=s=>{var e=rt(),v=m(f(e),2),u=c(v),n=c(u);x(n,{onClick:E,fullWidth:!0,children:(a,r)=>{var d=C("try again");t(a,d)},$$slots:{default:!0}}),t(s,e)},$=s=>{var e=D(),v=f(e);{var u=n=>{var a=it(),r=m(f(a),2),d=c(r),k=c(d);x(k,{onClick:W,fullWidth:!0,children:(y,j)=>{var O=C("Close");t(y,O)},$$slots:{default:!0}}),t(n,a)};b(v,n=>{p(i)==="success"&&n(u)},!0)}t(s,e)};b(g,s=>{p(i)==="error"?s(P):s($,!1)},!0)}t(o,l)};b(Y,o=>{p(i)==="idle"?o(F):o(L,!1)})}t(A,w),J()}export{lt as default};
