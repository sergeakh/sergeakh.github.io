import{p as a,s,a as e,o as t,g as i,x as n,b as r,a7 as o,u as l,f as c,i as v,d as h,e as p,h as d,A as f,c as u,M as g,a8 as y,K as m,G as w,a9 as b,aa as S,O as j,ab as C,m as K,k as P,L as x,j as A,B as O,v as U}from"./index-D_lOxY7D.js";import{g as k}from"./api-DvDg-7CF.js";var B=(a=>(a[a.t=0]="Signup",a[a.i=1]="SignupError",a))(B||{}),L=c('<p class="message svelte-9hh95f">signup</p> <!>',1),T=c('<p class="message svelte-9hh95f">error signup</p> <div class="buttonContainer svelte-9hh95f"><div class="buttonContainerItem svelte-9hh95f"><!></div></div>',1),$=c('<div class="content svelte-9hh95f"><!></div>');function E(c,E){a(E,!0);let G=n(f),I=s(""),J=s(e(B.t));const M=async()=>{u(J,B.t,!0);try{const a=await k(),s=crypto.getRandomValues(new Uint8Array(32)),e=await g({challenge:a,o:s}),t=await fetch("/api/signup",{method:"POST",headers:{l:"application/json"},body:JSON.stringify(e)});if(200!==t.status)return void u(J,B.i,!0);const n=await t.json(),o=Boolean(void 0===i(G));if(await y({o:s,v:new Uint8Array(m(n.v))}),o)r(!1),w();else{r(!1);let a=new URLSearchParams(b.search).get("retPath")||"";a&&(u(I,a,!0),S("retPath")),j({to:i(I)}),C()}}catch{u(J,B.i,!0)}};t(()=>(void 0===i(G)&&(r(!0),o(!1)),M(),()=>{o(!1)})),l(()=>{r(i(J)===B.t),o(i(J)!==B.t)});var N=$(),R=h(N),W=a=>{var s=L(),e=K(P(s),2);x(e,{}),p(a,s)},q=a=>{var s=A(),e=P(s),t=a=>{var s=T(),e=K(P(s),2),t=h(e),i=h(t);O(i,{h:()=>M(),p:!0,children:(a,s)=>{var e=U("try again");p(a,e)},u:{default:!0}}),p(a,s)};v(e,a=>{i(J)===B.i&&a(t)},!0),p(a,s)};v(R,a=>{i(J)===B.t?a(W):a(q,!1)}),p(c,N),d()}export{E as default};
