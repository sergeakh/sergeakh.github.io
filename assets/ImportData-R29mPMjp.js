import{$ as se,p as re,g as oe,a0 as ne,u as le,h as v,d as z,o as ie,f as y,j,c as x,b as o,k as ce,s as b,m as w,l as H,B as A,v as M,a1 as J,i as p,t as de,T as ve,U as pe,G as O,L as fe,n as ue,a2 as W,F as ge}from"./index-DpPWH1K4.js";const N=(D,g,n,t=new Set,a={})=>{for(const s of D.children)if(s.tagName==="DT"){const k=s.querySelector(":scope > A"),S=s.querySelector(":scope > H3");if(k){const m=k.getAttribute("href"),P=k.textContent||"unknown";if(!m)return n;const f=g.find(_=>_.toLowerCase()==="bookmarks bar")?g.filter(_=>_.toLowerCase()!=="bookmarks bar"):["other"];if(a[m])a[m].tags=[...new Set([...a[m].tags,...f])];else{const _={id:se(),url:m,name:P,text:"",tags:f.length>0?f:[],updatedAt:Date.now(),createdAt:Date.now()};a[_.url]=_,n.push(_)}}else if(S){const m=S.textContent?.trim();if(m&&S.nextElementSibling?.tagName==="DL"){const P=[...g];P.push(m);const f=S.nextElementSibling;t.has(f)||(t.add(f),N(f,P,n,t,a))}}}else s.tagName!=="DL"&&s.children.length>0&&(t.has(s)||(t.add(s),N(s,[...g],n,t,a)));return n},me=async D=>{const g=await D.text(),a=new DOMParser().parseFromString(g,"text/html").querySelector("DL");return a?N(a,[],[]):[]},G=async(D,g)=>{const n=D.target;!n.files||n.files.length===0||await g(n.files[0])};var _e=y('<div class="mobileContainer svelte-1n1lt8i"><!></div> <input type="file" accept=".json, .html" style="display: none;"/>',1),he=y('<div class="desktopContainer svelte-1n1lt8i"><div class="desktopButtonContainer svelte-1n1lt8i"><!></div> <div role="button" tabindex="-1"><div tabindex="-1" class="dropzone-content svelte-1n1lt8i"><p class="svelte-1n1lt8i">Drag and drop your file here</p> <p class="svelte-1n1lt8i">or</p></div> <input type="file" accept=".json, .html" style="display: none;"/></div></div>'),we=y('<p class="message svelte-1n1lt8i">Select a file to import your data</p> <!>',1),De=y('<p class="message svelte-1n1lt8i">Importing data...</p> <!>',1),xe=y('<p class="message success svelte-1n1lt8i">Data imported successfully!</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),be=y('<p class="message error svelte-1n1lt8i">Something went wrong</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),ye=y('<div class="content svelte-1n1lt8i"><!></div>');function Pe(D,g){re(g,!0);const{blockDialog:n}=oe();let t=z("idle"),a=z(null),s=z(!1),k=z(null);const{checkMobileSize:S}=ne(),m=()=>{ge()};le(()=>{n(v(t)==="loading")}),ie(()=>(v(a)&&v(a).addEventListener("cancel",e=>{e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}),()=>{n(!1)}));const P=async e=>{const r=await e.text(),C=JSON.parse(r),L=[];if(!C.notes)throw new Error("Invalid import file format");for(const T of Object.values(C.notes))T&&L.push(T);await W(L)},f=async e=>{p(t,"loading");try{if(e.name.endsWith(".json"))await P(e);else if(e.name.endsWith(".html"))await W(await me(e));else throw new Error("Unsupported file format. Please upload a JSON or HTML file.");await new Promise(r=>setTimeout(r,500)),p(t,"success")}catch{p(t,"error")}},_=()=>{v(a)?.click()},R=e=>{e.preventDefault(),e.stopPropagation(),p(s,!0)},K=e=>{e.preventDefault(),e.stopPropagation(),p(s,!1)},Q=e=>{e.preventDefault(),e.stopPropagation(),p(s,!0)},V=async e=>{if(e.preventDefault(),e.stopPropagation(),p(s,!1),!e.dataTransfer?.files||e.dataTransfer.files.length===0)return;const r=e.dataTransfer.files[0];if(r.type!=="application/json"&&r.type!=="text/html"){p(t,"error");return}await f(r)};var U=ye(),X=x(U);{var Y=e=>{var r=we(),C=b(w(r),2);{var L=l=>{var u=_e(),h=w(u),$=x(h);A($,{onClick:_,children:(i,d)=>{var F=M("Select File");o(i,F)},$$slots:{default:!0}});var c=b(h,2);c.__change=[G,f],J(c,i=>p(a,i),()=>v(a)),o(l,u)},T=l=>{var u=he(),h=x(u),$=x(h);A($,{onClick:_,children:(d,F)=>{var E=M("Select File");o(d,E)},$$slots:{default:!0}});var c=b(h,2),i=b(x(c),2);i.__change=[G,f],J(i,d=>p(a,d),()=>v(a)),J(c,d=>p(k,d),()=>v(k)),de(()=>ve(c,1,pe(["dropzone",{active:v(s)}]),"svelte-1n1lt8i")),O("dragenter",c,R),O("dragover",c,Q),O("dragleave",c,K),O("drop",c,V),o(l,u)};j(C,l=>{S()?l(L):l(T,!1)})}o(e,r)},Z=e=>{var r=H(),C=w(r);{var L=l=>{var u=De(),h=b(w(u),2);fe(h,{}),o(l,u)},T=l=>{var u=H(),h=w(u);{var $=i=>{var d=xe(),F=b(w(d),2),E=x(F);A(E,{onClick:m,children:(I,q)=>{var B=M("close");o(I,B)},$$slots:{default:!0}}),o(i,d)},c=i=>{var d=H(),F=w(d);{var E=I=>{var q=be(),B=b(w(q),2),ee=x(B);A(ee,{onClick:()=>{p(t,"idle")},children:(te,ke)=>{var ae=M("Try Again");o(te,ae)},$$slots:{default:!0}}),o(I,q)};j(F,I=>{v(t)==="error"&&I(E)},!0)}o(i,d)};j(h,i=>{v(t)==="success"?i($):i(c,!1)},!0)}o(l,u)};j(C,l=>{v(t)==="loading"?l(L):l(T,!1)},!0)}o(e,r)};j(X,e=>{v(t)==="idle"?e(Y):e(Z,!1)})}o(D,U),ce()}ue(["change"]);export{Pe as default};
