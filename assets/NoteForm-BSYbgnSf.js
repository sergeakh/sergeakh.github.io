import{p as P,W as x,u as q,h as e,d as m,i as o,f as N,m as M,q as Q,a7 as F,c as k,s as g,j as S,x as H,b as h,k as G,l as Y,H as Z,a8 as V,a1 as ae,n as O,e as W,o as re,a4 as ne,a9 as X,B as le,v as se,t as ie,r as oe}from"./index-BipI2UsA.js";import{I as $}from"./Input-D12Jmd0G.js";var ue=(b,n,s)=>{n(!1),o(s,"")},ve=N('<form class="formNewTag svelte-1v2ug4c"><!> <button type="button" class="buttonDone svelte-1v2ug4c">Done</button></form>'),ce=N('<div class="tags svelte-1v2ug4c"><!> <!> <!> <!></div> <!>',1);function de(b,n){P(n,!0);let s=m(null),r=m(""),u=x(n,"selectedTags",15),d=x(n,"shownTagInput",15);const U=t=>{u().includes(t)||(o(r,""),u([...u(),t]),e(s)?.focus())},E=t=>{const i=u().filter(_=>_!==t);i.length===0?u([]):u(i)};let D=H(()=>V()?[...(ae()()||[]).reduce((t,i)=>(i?.tags.forEach(_=>{t.has(_)||t.add(_)}),t),new Set)]:[]),I=H(()=>V()?e(D).filter(t=>!u().some(i=>t===i)&&t!=="inbox"):[]),T=H(()=>e(I).find(t=>t.toLowerCase()===e(r).toLowerCase())||u().includes(e(r))),l=H(()=>e(I).filter(t=>e(r)===""?!0:t.toLowerCase().indexOf(e(r).toLowerCase())===0).slice(0,e(T)||e(r)===""?3:2));const v=t=>{t.preventDefault(),e(r)!==""&&(U(e(r)),o(r,""))};q(()=>{e(s)&&d()&&e(s).focus(),d()||o(r,"")});var f=ce(),y=M(f),w=k(y);Q(w,16,u,t=>t,(t,i)=>{F(t,{get title(){return i},onClick:()=>E(i),type:"button",style:"selected"})});var c=g(w,2);{var p=t=>{var i=Y(),_=M(i);Q(_,16,()=>e(l),L=>L,(L,a)=>{F(L,{get title(){return a},onClick:()=>U(a)})}),h(t,i)};S(c,t=>{e(r)!==""&&t(p)})}var C=g(c,2);{var z=t=>{F(t,{get title(){return e(r)},onClick:()=>{U(e(r)),o(r,"")}})};S(C,t=>{!e(T)&&e(r)!==""&&t(z)})}var R=g(C,2);{var j=t=>{F(t,{title:"add tag",onClick:()=>d(!0)})};S(R,t=>{d()||t(j)})}var A=g(y,2);{var B=t=>{var i=ve(),_=k(i);$(_,{placeholder:"tag",get ref(){return e(s)},set ref(a){o(s,a,!0)},get value(){return e(r)},set value(a){o(r,a,!0)}});var L=g(_,2);L.__click=[ue,d,r],Z("submit",i,v),h(t,i)};S(A,t=>{d()&&t(B)})}h(b,f),G()}O(["click"]);var fe=(b,n,s,r)=>{if(n()&&e(s)){n("");return}r(!1)},_e=N('<div class="wrapper svelte-5bz0sa"><!> <div class="containerButtons svelte-5bz0sa"><button class="svelte-5bz0sa">Done</button></div></div>'),me=(b,n)=>{n(!0)},ge=(b,n)=>{n("")},he=N('<button class="button svelte-5bz0sa">Edit url</button> <button class="button svelte-5bz0sa">Delete url</button>',1),be=(b,n)=>{n(!0)},pe=N('<button class="button svelte-5bz0sa">Add url</button>'),ke=N('<div class="wrapperButtons svelte-5bz0sa"><!></div>');function Te(b,n){P(n,!0);let s=x(n,"url",15),r=x(n,"shownUrlInput",15),u=m(""),d=m(null);const U=l=>{o(u,""),s(l.target.value||"");try{new URL(s())}catch{o(u,"Invalid URL")}};q(()=>{r()&&setTimeout(()=>{e(d)?.focus()},0)});var E=Y(),D=M(E);{var I=l=>{var v=_e(),f=k(v);$(f,{get value(){return s()},get error(){return e(u)},onInput:U,placeholder:"url",get ref(){return e(d)},set ref(c){o(d,c,!0)}});var y=g(f,2),w=k(y);w.__click=[fe,s,u,r],h(l,v)},T=l=>{var v=ke(),f=k(v);{var y=c=>{var p=he(),C=M(p);C.__click=[me,r];var z=g(C,2);z.__click=[ge,s],h(c,p)},w=c=>{var p=pe();p.__click=[be,r],h(c,p)};S(f,c=>{s()?c(y):c(w,!1)})}h(l,v)};S(D,l=>{r()?l(I):l(T,!1)})}h(b,E),G()}O(["click"]);var we=N('<div class="submitWrapper svelte-1jfgfhk"><!></div>'),xe=N('<div class="form svelte-1jfgfhk"><div class="formFields"><!> <form><input class="inputName svelte-1jfgfhk" placeholder="Name"/></form> <textarea placeholder="Note" class="svelte-1jfgfhk"></textarea></div> <div class="formTagsWrapper svelte-1jfgfhk"><!></div> <!></div>');function Ce(b,n){P(n,!0);let s=x(n,"initialTitle",3,""),r=x(n,"initialUrl",3,""),u=x(n,"initialDescription",3,""),d=x(n,"initialTags",19,()=>[]),U=x(n,"mode",3,"add"),E=m(W(s())),D=m(W(r())),I=m(W(u())),T=m(W(d().filter(a=>a!=="inbox"))),l=m(null),v=m(!1),f=m(!1);const y=a=>{a.preventDefault(),n.onSubmit({title:e(E).trim().slice(0,256)||"unkwown",url:e(D).trim().slice(0,2048),description:e(I).trim().slice(0,2048),tags:e(T).length>0?e(T):["inbox"]})},w=()=>{e(l)&&(e(l).style.height="auto",e(l).style.height=e(l).scrollHeight+"px")};q(()=>{e(l),w()});const c=a=>{a.preventDefault(),e(l)&&e(l).focus()},p=a=>{a.key==="Escape"&&(document.activeElement instanceof HTMLInputElement&&document.activeElement.type==="text"||document.activeElement instanceof HTMLTextAreaElement)&&(e(v)&&o(v,!1),document.activeElement.blur(),a.preventDefault(),a.stopPropagation())};re(()=>(document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)));var C=xe(),z=k(C),R=k(z);Te(R,{get shownUrlInput(){return e(f)},set shownUrlInput(a){o(f,a,!0)},get url(){return e(D)},set url(a){o(D,a,!0)}});var j=g(R,2),A=k(j),B=g(j,2);B.__input=w,ne(B,a=>o(l,a),()=>e(l));var t=g(z,2),i=k(t);de(i,{get shownTagInput(){return e(v)},set shownTagInput(a){o(v,a,!0)},get selectedTags(){return e(T)},set selectedTags(a){o(T,a,!0)}});var _=g(t,2);{var L=a=>{var J=we(),ee=k(J);le(ee,{fullWidth:!0,onClick:y,typeButton:"submit",children:(te,Ee)=>{var K=se();ie(()=>oe(K,U()==="add"?"add":"edit")),h(te,K)},$$slots:{default:!0}}),h(a,J)};S(_,a=>{!e(v)&&!e(f)&&a(L)})}Z("submit",j,c),X(A,()=>e(E),a=>o(E,a)),X(B,()=>e(I),a=>o(I,a)),h(b,C),G()}O(["input"]);export{Ce as N};
