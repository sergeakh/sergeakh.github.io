import{a1 as e,p as s,u as t,b as a,g as l,s as n,o as i,f as o,i as r,d as c,e as d,h as v,m as p,k as f,a2 as u,j as m,B as g,v as h,a3 as w,c as y,t as b,U as k,W as C,H as D,L as S,l as $,a4 as j,G as x}from"./index-D_lOxY7D.js";const L=(s,t,a,l=new Set,n={})=>{for(const i of s.children)if("DT"===i.tagName){const s=i.querySelector(":scope > A"),o=i.querySelector(":scope > H3");if(s){const l=s.getAttribute("href"),i=s.textContent||"unknown";if(!l)return a;const o=t.find(e=>"bookmarks bar"===e.toLowerCase())?t.filter(e=>"bookmarks bar"!==e.toLowerCase()):["other"];if(n[l])n[l].tags=[...new Set([...n[l].tags,...o])];else{const s={id:e(),url:l,title:i,description:"",tags:o.length>0?o:[],t:Date.now(),l:Date.now()};n[s.url]=s,a.push(s)}}else if(o){const e=o.textContent?.trim();if(e&&"DL"===o.nextElementSibling?.tagName){const s=[...t];s.push(e);const i=o.nextElementSibling;l.has(i)||(l.add(i),L(i,s,a,l,n))}}}else"DL"!==i.tagName&&i.children.length>0&&(l.has(i)||(l.add(i),L(i,[...t],a,l,n)));return a},A=async(e,s)=>{const t=e.target;t.files&&0!==t.files.length&&await s(t.files[0])};var O=o('<div class="mobileContainer svelte-1n1lt8i"><!></div> <input type="file" accept=".json, .html" style="display: none;"/>',1),E=o('<div class="desktopContainer svelte-1n1lt8i"><div class="desktopButtonContainer svelte-1n1lt8i"><!></div> <div role="button" tabindex="-1"><div tabindex="-1" class="dropzone-content svelte-1n1lt8i"><p class="svelte-1n1lt8i">Drag and drop your file here</p> <p class="svelte-1n1lt8i">or</p></div> <input type="file" accept=".json, .html" style="display: none;"/></div></div>'),H=o('<p class="message svelte-1n1lt8i">Select a file to import your data</p> <!>',1),T=o('<p class="message svelte-1n1lt8i">Importing data...</p> <!>',1),z=o('<p class="message success svelte-1n1lt8i">Data imported successfully!</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),B=o('<p class="message error svelte-1n1lt8i">Something went wrong</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),F=o('<div class="content svelte-1n1lt8i"><!></div>');function I(e,o){s(o,!0);let $=n("idle"),I=n(null),J=n(!1),M=n(null);const N=()=>{x()};t(()=>{a("loading"===l($))}),i(()=>(l(I)&&l(I).addEventListener("cancel",e=>{e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}),()=>{a(!1)}));const P=async e=>{y($,"loading");try{if(e.name.endsWith(".json"))await(async e=>{const s=await e.text(),t=JSON.parse(s),a=[];if(!t.i)throw new Error("Invalid import file format");for(const l of Object.values(t.i))l&&a.push(l);await j(a)})(e);else{if(!e.name.endsWith(".html"))throw new Error("Unsupported file format. Please upload a JSON or HTML file.");await j(await(async e=>{const s=await e.text(),t=(new DOMParser).parseFromString(s,"text/html").querySelector("DL");return t?L(t,[],[]):[]})(e))}y($,"success")}catch(s){console.error("Error processing file:",s),y($,"error")}},U=()=>{l(I)?.click()},G=e=>{e.preventDefault(),e.stopPropagation(),y(J,!0)},W=e=>{e.preventDefault(),e.stopPropagation(),y(J,!1)},q=e=>{e.preventDefault(),e.stopPropagation(),y(J,!0)},K=async e=>{if(e.preventDefault(),e.stopPropagation(),y(J,!1),!e.dataTransfer?.files||0===e.dataTransfer.files.length)return;const s=e.dataTransfer.files[0];"application/json"===s.type||"text/html"===s.type?await P(s):y($,"error")};var Q=F(),R=c(Q),V=e=>{var s=H(),t=p(f(s),2),a=e=>{var s=O(),t=f(s),a=c(t);g(a,{o:U,children:(e,s)=>{var t=h("Select File");d(e,t)},v:{default:!0}});var n=p(t,2);n.p=[A,P],w(n,e=>y(I,e),()=>l(I)),d(e,s)},n=e=>{var s=E(),t=c(s),a=c(t);g(a,{o:U,children:(e,s)=>{var t=h("Select File");d(e,t)},v:{default:!0}});var n=p(t,2),i=p(c(n),2);i.p=[A,P],w(i,e=>y(I,e),()=>l(I)),w(n,e=>y(M,e),()=>l(M)),b(()=>k(n,1,C(["dropzone",{active:l(J)}]),"svelte-1n1lt8i")),D("dragenter",n,G),D("dragover",n,q),D("dragleave",n,W),D("drop",n,K),d(e,s)};r(t,e=>{u()?e(a):e(n,!1)}),d(e,s)},X=e=>{var s=m(),t=f(s),a=e=>{var s=T(),t=p(f(s),2);S(t,{}),d(e,s)},n=e=>{var s=m(),t=f(s),a=e=>{var s=z(),t=p(f(s),2),a=c(t);g(a,{o:N,children:(e,s)=>{var t=h("close");d(e,t)},v:{default:!0}}),d(e,s)},n=e=>{var s=m(),t=f(s),a=e=>{var s=B(),t=p(f(s),2),a=c(t);g(a,{o:()=>{y($,"idle")},children:(e,s)=>{var t=h("Try Again");d(e,t)},v:{default:!0}}),d(e,s)};r(t,e=>{"error"===l($)&&e(a)},!0),d(e,s)};r(t,e=>{"success"===l($)?e(a):e(n,!1)},!0),d(e,s)};r(t,e=>{"loading"===l($)?e(a):e(n,!1)},!0),d(e,s)};r(R,e=>{"idle"===l($)?e(V):e(X,!1)}),d(e,Q),v()}$(["change"]);export{I as default};
