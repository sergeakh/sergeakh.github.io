import{p as K,C as M,A as N,g as Q,z as R,d as U,u as V,i as p,e as X,f as _,k as b,c as l,b as t,l as Z,s as m,n as f,y as tt,m as D,B as C,w as x,P as st,j as h,t as et,v as at}from"./index-CZzB_zyz.js";var rt=_('<p class="message svelte-uikrak">You need to connect to the cloud account to get an access to a subscription</p> <div class="buttonContainer svelte-uikrak"><!></div>',1),ot=_('<div class="buttonContainer svelte-uikrak"><!></div>'),it=_('<p class="message svelte-uikrak"> </p>'),nt=_('<h3 class="title svelte-uikrak">Subscription</h3> <!>',1),ct=_('<p class="message svelte-uikrak">error signin</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),lt=_('<p class="message svelte-uikrak">Subscription updated successfully</p> <div class="buttonContainer svelte-uikrak"><div class="buttonContainerItem"><!></div></div>',1),vt=_('<div class="content svelte-uikrak"><!></div>');function dt(I,j){K(j,!0);const{updateSubscription:B}=M(),{addSearchParam:G,closeDialogStack:W}=N(),{pushStackPages:Y}=Q(),{getAccount:z}=R();let o=X("idle"),S=tt(z);const{blockDialog:F}=U(),H=()=>{G("retPath","subscription"),Y(st.Auth)},L=()=>{W()},y=async()=>{h(o,"loading");try{const i=await fetch("/api/getSubscription",{method:"POST"});if(i.status!==200){h(o,"error");return}const c=await i.json();if(!c.subscriptionExpires){h(o,"error");return}const g=c.subscriptionExpires;B(g),h(o,"success")}catch{h(o,"error")}};V(()=>{F(p(o)==="loading")});var w=vt(),O=l(w);{var T=i=>{var c=nt(),g=m(f(c),2);{var P=s=>{var a=rt(),v=m(f(a),2),u=l(v);C(u,{onClick:H,children:(n,e)=>{var r=x("Connect");t(n,r)},$$slots:{default:!0}}),t(s,a)},$=s=>{var a=D(),v=f(a);{var u=e=>{var r=ot(),d=l(r);C(d,{onClick:y,children:(k,A)=>{var E=x("Get subscription");t(k,E)},$$slots:{default:!0}}),t(e,r)},n=e=>{var r=it(),d=l(r);et(k=>at(d,`Your subscription is active until ${k??""}`),[()=>new Date(p(S).subscriptionExpires).toLocaleDateString()]),t(e,r)};b(v,e=>{p(S).subscriptionExpires<Date.now()?e(u):e(n,!1)},!0)}t(s,a)};b(g,s=>{p(S)?s($,!1):s(P)})}t(i,c)},q=i=>{var c=D(),g=f(c);{var P=s=>{var a=ct(),v=m(f(a),2),u=l(v),n=l(u);C(n,{onClick:y,fullWidth:!0,children:(e,r)=>{var d=x("try again");t(e,d)},$$slots:{default:!0}}),t(s,a)},$=s=>{var a=D(),v=f(a);{var u=n=>{var e=lt(),r=m(f(e),2),d=l(r),k=l(d);C(k,{onClick:L,fullWidth:!0,children:(A,E)=>{var J=x("Close");t(A,J)},$$slots:{default:!0}}),t(n,e)};b(v,n=>{p(o)==="success"&&n(u)},!0)}t(s,a)};b(g,s=>{p(o)==="error"?s(P):s($,!1)},!0)}t(i,c)};b(O,i=>{p(o)==="idle"?i(T):i(q,!1)})}t(I,w),Z()}export{dt as default};
