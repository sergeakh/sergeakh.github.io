import{p as e,T as n,o as t,h as o,ah as a,u as i,ai as s,aj as c,g as r,s as l,x as u,f as d,k as p,i as g,d as m,a3 as h,c as f,m as w,t as v,U as M,W as S,ad as y,e as T,ak as b,al as x,j as k,ae as j,af as A}from"./index-D_lOxY7D.js";function F(i,s){e(s,!0);let c=n(s,"dialog",7);const r=.3,l=.35;let u=0,d=0,p=0,g=!1,m=!1,h=0,f=0,w=0;const v=()=>{u=0,d=0,g=!1,m=!1,h=0,f=0,w=0,p=0,null!==M&&(cancelAnimationFrame(M),M=null),S=null};let M=null,S=null;const y=e=>{c()?"opened"===s.t||"closed"===s.t?(u=e.touches[0].clientX,d=e.touches[0].clientY,p=performance.now(),g=!0,m=!1):console.warn(`Touch start: Invalid sidebar state: ${s.t}`):console.warn("Touch start: No dialog element")},T=e=>"closed"===s.t&&e>0||"closeSwiping"===s.t&&e>0||"opened"===s.t&&e<0||"openSwiping"===s.t&&e<0,b=()=>{if(M=null,!S||!g||!c()||a())return;const{x:e,y:n}=S;S=null;const t=e-u,o=n-d,i=Math.abs(t)>Math.abs(o),r=Math.abs(t)>3;if(!m){if(!(i&&r&&T(t)))return;try{(()=>{if(c()){if(c().style.setProperty("--transition-timing","0s"),!c().open&&"closed"===s.t)try{c().showModal(),c().offsetWidth}catch(e){return void console.error("Error opening dialog:",e)}s.o();try{const e=window.getComputedStyle(c()),n=e.transform||e.webkitTransform||"";if(f=c().offsetWidth,"closeSwiping"===s.t||"closed"===s.t?h=-f:"openSwiping"!==s.t&&"opened"!==s.t||(h=0),n&&"none"!==n)try{const e=new DOMMatrix(n);h=e.m41}catch{console.warn("Could not parse transform matrix, using default position")}m=!0}catch(n){console.error("Error during swipe initialization:",n),v()}}})()}catch(b){return console.error("Error initializing swipe:",b),void v()}}if(!T(t))return;c().style.setProperty("--transition-timing","0s");let l=h+.95*t;const p=-f,y=-.27*f;l=Math.max(p,Math.min(y,l)),c().style.transform=`translate3d(${l}px, 0, 0)`,w=(l-h)/f*100,(()=>{if(!c())return;const e=-.27*f,n=-f;let t=0;const o=window.getComputedStyle(c()),a=o.transform||o.webkitTransform||"";if(a&&"none"!==a)try{t=new DOMMatrix(a).m41}catch{t=0}const i=.25*Math.min(1,Math.max(0,(t-n)/(e-n)));c().style.setProperty("--backdrop-bg",`rgba(0, 0, 0, ${i})`)})()},x=e=>{if(!g)return;const n=e.touches[0].clientX,t=e.touches[0].clientY;S={x:n,y:t},null===M&&(M=requestAnimationFrame(b)),m&&Math.abs(n-u)>Math.abs(t-d)&&e.preventDefault()},k=e=>{if(null!==M&&(cancelAnimationFrame(M),M=null),S=null,!g||!c())return void v();if(!m)return void v();let n=0;if(e?.changedTouches?.[0]){const t=e.changedTouches[0].clientX,o=performance.now()-p;o>0&&(n=(t-u)/o)}const t=(e=>{const n=Math.abs(e);if(n>=.6)return 5;if(n>=r)return 50-(n-r)/.3*45;return 50})(n);let o=null;if("closeSwiping"===s.t){o=Math.abs(w)>t||n>r?"open":"close"}else if("openSwiping"===s.t){o=Math.abs(w)>t||n<-.3?"close":"open"}const a=((e,n)=>{if(Math.abs(e)>=.6)return.175;const t=Math.abs(w)/100;return n?l*Math.max(.5,1-t):l*Math.max(.5,t)})(n,"closeSwiping"===s.t&&"open"===o||"openSwiping"===s.t&&"close"===o);c().style.setProperty("--transition-timing",`${a}s`),c().offsetWidth,c().style.transform="","open"===o?s.i():"close"===o&&s.l(),c()?.style.removeProperty("--backdrop-bg"),v()};t(()=>(document.addEventListener("touchstart",y,{passive:!0}),document.addEventListener("touchmove",x,{passive:!1}),document.addEventListener("touchend",k,{passive:!0}),document.addEventListener("touchcancel",k,{passive:!0}),()=>{document.removeEventListener("touchstart",y),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",k),document.removeEventListener("touchcancel",k),null!==M&&cancelAnimationFrame(M)})),o()}var O=d('<dialog><div class="dialogInner svelte-jwdaua"><!></div></dialog> <!> <!>',1);function $(n,a){e(a,!0);let d=l(null),$=l(null),C=u(b);i(()=>{s().length>0&&c({type:"close"})});const E=()=>{a.u||c({type:"close"})},I=()=>{a.u||c({type:"open"})},z=()=>{c({type:"closed"})},D=()=>{c({type:"swipe"})},q=e=>{e.preventDefault(),E()};t(()=>(r(d)?.addEventListener("close",z),r(d)?.addEventListener("cancel",q),()=>{r(d)?.removeEventListener("close",z),r(d)?.removeEventListener("cancel",q)}));const N=()=>{r(d)?.style.removeProperty("--transition-timing"),r(d)?.style.removeProperty("transform"),r(d)?.style.removeProperty("--backdrop-bg")},U=u(x);i(()=>{if(r(C),r(d))switch(r(C).type){case"closeSwiping":{const e=setTimeout(()=>{E()},3e3);return()=>{clearTimeout(e)}}case"openSwiping":{const e=setTimeout(()=>{I()},3e3);return()=>{clearTimeout(e)}}case"opening":{r(d).open||r(d).showModal(),r(d).getBoundingClientRect();const e=setTimeout(()=>{N()},351),n=()=>{clearTimeout(e),N()};return r(d)?.addEventListener("transitionend",n,{once:!0}),c({type:"opened"}),()=>{r(d)?.removeEventListener("transitionend",n)}}case"closing":{const e=setTimeout(()=>{"closing"===r(C).type&&z()},351),n=()=>{clearTimeout(e),z()};return r(d)?.addEventListener("transitionend",n,{once:!0}),()=>{r(d)?.removeEventListener("transitionend",n)}}case"closed":r(d)?.close(),N();break;case"opened":N()}});var W=O(),B=p(W),G=m(B),H=m(G),J=e=>{var n=k(),t=p(n);j(t,()=>a.children),T(e,n)};g(H,e=>{"closed"!==r(C).type&&e(J)}),h(G,e=>f($,e),()=>r($)),h(B,e=>f(d,e),()=>r(d));var K=w(B,2),L=e=>{A(e,{get p(){return r(d)},get m(){return r($)},l:E})};g(K,e=>{"opened"!==r(C).type||a.u||e(L)});var P=w(K,2),Q=e=>{F(0,{l:E,i:I,o:D,get t(){return r(C).type},get p(){return r(d)}})};g(P,e=>{(r(U)||"closed"!==r(C).type)&&"opened"!==r(C).type&&"openSwiping"!==r(C).type&&"closeSwiping"!==r(C).type||a.u||e(Q)}),v(()=>M(B,1,S([{open:"opened"===r(C).type,hidden:a.u,h:y.v&&(!y.M||!a.u)}]),"svelte-jwdaua")),T(n,W),o()}export{$ as default};
