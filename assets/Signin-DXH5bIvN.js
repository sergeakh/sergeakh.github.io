import{p as A,a as T,P as U,o as I,s as S,Q as v,u as $,g as f,f as h,i as y,c as u,b as o,d as j,m as g,U as L,S as O,T as z,z as F,e as _,h as d,L as J,k as M,B as N,t as P}from"./index-C1vnfXtA.js";import{g as Q}from"./api-7nXQQ8YG.js";var e=(r=>(r[r.Signin=0]="Signin",r[r.SigninError=1]="SigninError",r))(e||{}),W=h('<p class="message svelte-9hh95f">signin</p> <!>',1),q=h('<p class="message svelte-9hh95f">error signin</p> <div class="buttonContainer svelte-9hh95f"><div class="buttonContainerItem svelte-9hh95f"><!></div></div>',1),G=h('<div class="content svelte-9hh95f"><!></div>');function X(r,b){A(b,!0);let n=T(U(e.Signin));const p=async()=>{g(n,e.Signin,!0);try{const a=await Q(),{credentialData:t,clientKey:i}=await L({challenge:a}),l=await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(l.status!==200){g(n,e.SigninError,!0);return}const s=await l.json();if(!s.success||!s.serverKey){g(n,e.SigninError,!0);return}const c=s.serverKey;await O({clientKey:i,serverKey:new Uint8Array(z(c))}),S(!1),F()}catch{g(n,e.SigninError,!0)}};I(()=>(S(!0),v(!1),p(),()=>{v(!1)})),$(()=>{v(f(n)!==e.Signin)});var m=G(),k=u(m);{var w=a=>{var t=W(),i=_(d(t),2);J(i),o(a,t)},B=a=>{var t=M(),i=d(t);{var l=s=>{var c=q(),C=_(d(c),2),E=u(C),D=u(E);N(D,{onClick:()=>p(),fullWidth:!0,children:(K,H)=>{var x=P("try again");o(K,x)},$$slots:{default:!0}}),o(s,c)};y(i,s=>{f(n)===e.SigninError&&s(l)},!0)}o(a,t)};y(k,a=>{f(n)===e.Signin?a(w):a(B,!1)})}o(r,m),j()}export{X as default};
