import{a2 as ae,p as re,u as se,g as G,h as v,d as A,o as oe,f as x,j,c as k,b as s,k as ne,s as b,m as w,a3 as le,l as q,B as O,v as z,a4 as J,i as p,t as ie,X as ce,Y as de,H as B,L as ve,n as pe,a5 as R,G as fe}from"./index-BQ1Y8JAd.js";const N=(D,g,t,a=new Set,r={})=>{for(const f of D.children)if(f.tagName==="DT"){const F=f.querySelector(":scope > A"),S=f.querySelector(":scope > H3");if(F){const l=F.getAttribute("href"),y=F.textContent||"unknown";if(!l)return t;const m=g.find(_=>_.toLowerCase()==="bookmarks bar")?g.filter(_=>_.toLowerCase()!=="bookmarks bar"):["other"];if(r[l])r[l].tags=[...new Set([...r[l].tags,...m])];else{const _={id:ae(),url:l,title:y,description:"",tags:m.length>0?m:[],updatedAt:Date.now(),createdAt:Date.now()};r[_.url]=_,t.push(_)}}else if(S){const l=S.textContent?.trim();if(l&&S.nextElementSibling?.tagName==="DL"){const y=[...g];y.push(l);const m=S.nextElementSibling;a.has(m)||(a.add(m),N(m,y,t,a,r))}}}else f.tagName!=="DL"&&f.children.length>0&&(a.has(f)||(a.add(f),N(f,[...g],t,a,r)));return t},ue=async D=>{const g=await D.text(),r=new DOMParser().parseFromString(g,"text/html").querySelector("DL");return r?N(r,[],[]):[]},U=async(D,g)=>{const t=D.target;!t.files||t.files.length===0||await g(t.files[0])};var ge=x('<div class="mobileContainer svelte-1n1lt8i"><!></div> <input type="file" accept=".json, .html" style="display: none;"/>',1),me=x('<div class="desktopContainer svelte-1n1lt8i"><div class="desktopButtonContainer svelte-1n1lt8i"><!></div> <div role="button" tabindex="-1"><div tabindex="-1" class="dropzone-content svelte-1n1lt8i"><p class="svelte-1n1lt8i">Drag and drop your file here</p> <p class="svelte-1n1lt8i">or</p></div> <input type="file" accept=".json, .html" style="display: none;"/></div></div>'),_e=x('<p class="message svelte-1n1lt8i">Select a file to import your data</p> <!>',1),he=x('<p class="message svelte-1n1lt8i">Importing data...</p> <!>',1),we=x('<p class="message success svelte-1n1lt8i">Data imported successfully!</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),De=x('<p class="message error svelte-1n1lt8i">Something went wrong</p> <div class="buttonContainer svelte-1n1lt8i"><!></div>',1),ye=x('<div class="content svelte-1n1lt8i"><!></div>');function xe(D,g){re(g,!0);let t=A("idle"),a=A(null),r=A(!1),f=A(null);const F=()=>{fe()};se(()=>{G(v(t)==="loading")}),oe(()=>(v(a)&&v(a).addEventListener("cancel",e=>{e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}),()=>{G(!1)}));const S=async e=>{const i=await e.text(),P=JSON.parse(i),L=[];if(!P.notes)throw new Error("Invalid import file format");for(const C of Object.values(P.notes))C&&L.push(C);await R(L)},l=async e=>{p(t,"loading");try{if(e.name.endsWith(".json"))await S(e);else if(e.name.endsWith(".html"))await R(await ue(e));else throw new Error("Unsupported file format. Please upload a JSON or HTML file.");p(t,"success")}catch{p(t,"error")}},y=()=>{v(a)?.click()},m=e=>{e.preventDefault(),e.stopPropagation(),p(r,!0)},_=e=>{e.preventDefault(),e.stopPropagation(),p(r,!1)},X=e=>{e.preventDefault(),e.stopPropagation(),p(r,!0)},Y=async e=>{if(e.preventDefault(),e.stopPropagation(),p(r,!1),!e.dataTransfer?.files||e.dataTransfer.files.length===0)return;const i=e.dataTransfer.files[0];if(i.type!=="application/json"&&i.type!=="text/html"){p(t,"error");return}await l(i)};var W=ye(),K=k(W);{var Q=e=>{var i=_e(),P=b(w(i),2);{var L=o=>{var u=ge(),h=w(u),$=k(h);O($,{onClick:y,children:(n,d)=>{var T=z("Select File");s(n,T)},$$slots:{default:!0}});var c=b(h,2);c.__change=[U,l],J(c,n=>p(a,n),()=>v(a)),s(o,u)},C=o=>{var u=me(),h=k(u),$=k(h);O($,{onClick:y,children:(d,T)=>{var E=z("Select File");s(d,E)},$$slots:{default:!0}});var c=b(h,2),n=b(k(c),2);n.__change=[U,l],J(n,d=>p(a,d),()=>v(a)),J(c,d=>p(f,d),()=>v(f)),ie(()=>ce(c,1,de(["dropzone",{active:v(r)}]),"svelte-1n1lt8i")),B("dragenter",c,m),B("dragover",c,X),B("dragleave",c,_),B("drop",c,Y),s(o,u)};j(P,o=>{le()?o(L):o(C,!1)})}s(e,i)},V=e=>{var i=q(),P=w(i);{var L=o=>{var u=he(),h=b(w(u),2);ve(h,{}),s(o,u)},C=o=>{var u=q(),h=w(u);{var $=n=>{var d=we(),T=b(w(d),2),E=k(T);O(E,{onClick:F,children:(I,H)=>{var M=z("close");s(I,M)},$$slots:{default:!0}}),s(n,d)},c=n=>{var d=q(),T=w(d);{var E=I=>{var H=De(),M=b(w(H),2),Z=k(M);O(Z,{onClick:()=>{p(t,"idle")},children:(ee,ke)=>{var te=z("Try Again");s(ee,te)},$$slots:{default:!0}}),s(I,H)};j(T,I=>{v(t)==="error"&&I(E)},!0)}s(n,d)};j(h,n=>{v(t)==="success"?n($):n(c,!1)},!0)}s(o,u)};j(P,o=>{v(t)==="loading"?o(L):o(C,!1)},!0)}s(e,i)};j(K,e=>{v(t)==="idle"?e(Q):e(V,!1)})}s(D,W),ne()}pe(["change"]);export{xe as default};
