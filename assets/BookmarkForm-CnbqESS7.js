import{p as de,W as _,s as u,a as x,f as y,g as e,d as g,m,i as b,H as ve,e as T,h as ce,c as l,k as G,x as k,t as ue,r as ge,a7 as H,a1 as me,X as fe,Y as he,n as N,a8 as C,j as _e}from"./index-Czf_bs-C.js";import{I as S}from"./Input-Df64194A.js";var be=y("<div></div>"),pe=y('<div class="boxtags"><div class="sidebarFixed"><!></div> <div class="tags svelte-1as7gim"><!> <!></div> <div class="searchWrapper svelte-1as7gim"><!></div></div> <button class="buttonSubmit svelte-1as7gim" type="submit"> </button>',1),xe=y('<form class="svelte-1as7gim"><!> <!> <!></form>');function we(O,n){de(n,!0);let X=_(n,"initialTitle",3,""),Y=_(n,"initialUrl",3,""),L=_(n,"initialDescription",3,""),q=_(n,"initialTags",19,()=>[]),z=_(n,"mode",3,"add"),r=u("");u(L()!=="");let p=u(x(X())),d=u(x(Y())),f=u(""),A=x(L()),i=u(x(q().filter(t=>t!=="inbox")));const U=t=>{e(i).includes(t)||l(i,[...e(i),t],!0)},J=t=>{const s=e(i).filter(o=>o!==t);s.length===0?l(i,[],!0):l(i,s,!0)};let K=k(()=>H()?[...(me()()||[]).reduce((t,s)=>(s?.tags.forEach(o=>{t.has(o)||t.add(o)}),t),new Set)]:[]),I=k(()=>H()?e(K).filter(t=>!e(i).some(s=>t===s)&&t!=="inbox"):[]),D=k(()=>e(I).find(t=>t.toLowerCase()===e(r).toLowerCase())||e(i).includes(e(r))),M=k(()=>e(I).filter(t=>e(r)===""?!0:t.toLowerCase().indexOf(e(r).toLowerCase())!==-1).slice(0,e(D)||e(r)===""?3:2));const P=t=>{t.preventDefault(),n.onSubmit({title:e(p).trim().slice(0,256)||"unkwown",url:e(d).trim().slice(0,2048),description:A.trim().slice(0,2048),tags:e(i).length>0?e(i):["inbox"]})},Q=t=>{l(f,""),l(d,t.target.value||"",!0);try{new URL(e(d))}catch{l(f,"Invalid URL")}};var w=xe(),E=g(w);S(E,{get value(){return e(d)},get error(){return e(f)},onInput:Q,placeholder:"url"});var R=m(E,2);{var V=t=>{S(t,{placeholder:"title",get value(){return e(p)},set value(s){l(p,s,!0)}})};b(R,t=>{e(d)&&e(f)===""&&t(V)})}var Z=m(R,2);{var $=t=>{var s=pe(),o=G(s),B=g(o),ee=g(B);{var te=a=>{var v=be();fe(v,1,he(["tags","selectedTags"]),"svelte-1as7gim"),N(v,20,()=>e(i),h=>h,(h,c)=>{C(h,{get title(){return c},onClick:()=>J(c),type:"button",style:"selected"})}),T(a,v)};b(ee,a=>{e(i).length>0&&a(te)})}var F=m(B,2),W=g(F);{var ae=a=>{var v=_e(),h=G(v);N(h,16,()=>e(M),c=>c,(c,j)=>{C(c,{get title(){return j},onClick:()=>U(j)})}),T(a,v)};b(W,a=>{e(r)!==""&&a(ae)})}var re=m(W,2);{var ie=a=>{C(a,{get title(){return e(r)},onClick:()=>{U(e(r)),l(r,"")}})};b(re,a=>{!e(D)&&e(r)!==""&&a(ie)})}var se=m(F,2),le=g(se);S(le,{placeholder:"search tag",get value(){return e(r)},set value(a){l(r,a,!0)}});var ne=m(o,2),oe=g(ne);ue(()=>ge(oe,z()==="add"?"add":"edit")),T(t,s)};b(Z,t=>{e(d)&&e(f)===""&&e(p)&&t($)})}ve("submit",w,P),T(O,w),ce()}export{we as B};
